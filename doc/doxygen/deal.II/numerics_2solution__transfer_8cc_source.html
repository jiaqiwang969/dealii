<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/numerics_2solution__transfer_8cc_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: source/numerics/solution_transfer.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_c371c8e3c4a27917e93effe7d4bd6cc8.html">numerics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">solution_transfer.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="numerics_2solution__transfer_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 1999 - 2021 by the deal.II authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="base_2memory__consumption_8h.html">deal.II/base/memory_consumption.h</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="distributed_2shared__tria_8h.html">deal.II/distributed/shared_tria.h</a>&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__accessor_8h.html">deal.II/dofs/dof_accessor.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2fe_2fe_8h.html">deal.II/fe/fe.h</a>&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__accessor_8h.html">deal.II/grid/tria_accessor.h</a>&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__iterator_8h.html">deal.II/grid/tria_iterator.h</a>&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160; </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2block__vector_8h.html">deal.II/lac/block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__block__vector_8h.html">deal.II/lac/la_parallel_block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2la__vector_8h.html">deal.II/lac/la_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2petsc__block__vector_8h.html">deal.II/lac/petsc_block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2petsc__vector_8h.html">deal.II/lac/petsc_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2trilinos__parallel__block__vector_8h.html">deal.II/lac/trilinos_parallel_block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2trilinos__vector_8h.html">deal.II/lac/trilinos_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2vector__element__access_8h.html">deal.II/lac/vector_element_access.h</a>&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="numerics_2solution__transfer_8h.html">deal.II/numerics/solution_transfer.h</a>&gt;</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#ad33057265bf051ae9972df33c54b892e">   46</a></span>&#160;<a class="code" href="classSolutionTransfer.html#ad33057265bf051ae9972df33c54b892e">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::SolutionTransfer</a>(</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp;dof)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  : dof_handler(&amp;dof, typeid(*<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a>).<a class="code" href="any__data__0_8txt.html#a14dffb89358dea145077df935372dee4">name</a>())</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  , n_dofs_old(0)</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  , prepared_for(<a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1acc6b05c836e9f74fb7ab9390ffc26f1c">none</a>)</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    (<span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim, spacedim&gt;</a> *<span class="keyword">&gt;</span>(</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       &amp;<a class="code" href="classSolutionTransfer.html#a2f6689d89a150cc75fd48eb259468d9f">dof_handler</a>-&gt;get_triangulation()) == <span class="keyword">nullptr</span>),</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You are calling the ::SolutionTransfer class &quot;</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;               <span class="stringliteral">&quot;with a DoFHandler that is built on a &quot;</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;               <span class="stringliteral">&quot;parallel::distributed::Triangulation. This will not &quot;</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;               <span class="stringliteral">&quot;work for parallel computations. You probably want to &quot;</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;               <span class="stringliteral">&quot;use the parallel::distributed::SolutionTransfer class.&quot;</span>));</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#a788a900c27e9451b861c71f2be89cebb">   65</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a788a900c27e9451b861c71f2be89cebb">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::~SolutionTransfer</a>()</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="table__0_8txt.html#a7f24305532768edc889062eefd4b28cf">clear</a>();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#a10e7257afcc5508c2d5021c5fc9a89c0">   74</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a10e7257afcc5508c2d5021c5fc9a89c0">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::clear</a>()</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;{</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  indices_on_cell.clear();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  dof_values_on_cell.clear();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  cell_map.clear();</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  prepared_for = <a class="code" href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1acc6b05c836e9f74fb7ab9390ffc26f1c">none</a>;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;}</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#ab7ceeaf8fa65f8699c7bc2e19cfec803">   87</a></span>&#160;<a class="code" href="classSolutionTransfer.html#ab7ceeaf8fa65f8699c7bc2e19cfec803">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::prepare_for_pure_refinement</a>()</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;{</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(prepared_for != pure_refinement, ExcAlreadyPrepForRef());</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(prepared_for != coarsening_and_refinement,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;         ExcAlreadyPrepForCoarseAndRef());</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="table__0_8txt.html#a7f24305532768edc889062eefd4b28cf">clear</a>();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">// We need to access dof indices on the entire domain. For</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">// parallel::shared::Triangulations, ownership of cells might change. If they</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="comment">// allow artificial cells, we need to restore the &quot;true&quot; cell owners</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <span class="comment">// temporarily.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">// We use the TemporarilyRestoreSubdomainIds class for this purpose: we save</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="comment">// the current set of subdomain ids, set subdomain ids to the &quot;true&quot; owner of</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">// each cell upon construction of the TemporarilyRestoreSubdomainIds object,</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="comment">// and later restore these flags when it is destroyed.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keyword">const</span> <a class="code" href="classinternal_1_1parallel_1_1shared_1_1TemporarilyRestoreSubdomainIds.html">internal::parallel::shared::TemporarilyRestoreSubdomainIds</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                                                                   <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    subdomain_modifier(dof_handler-&gt;get_triangulation());</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a> =</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    dof_handler-&gt;get_triangulation().n_active_cells();</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  n_dofs_old = dof_handler-&gt;n_dofs();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="comment">// efficient reallocation of indices_on_cell</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  std::vector&lt;std::vector&lt;types::global_dof_index&gt;&gt;(<a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a>)</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    .<a class="code" href="classBlockIndices.html#adbc4eb912f3af63b72c45f008c64b60b">swap</a>(indices_on_cell);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler-&gt;active_cell_iterators())</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      indices_on_cell[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].resize(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell());</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="comment">// on each cell store the indices of the</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="comment">// dofs. after refining we get the values</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="comment">// on the children by taking these</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="comment">// indices, getting the respective values</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="comment">// out of the data vectors and prolonging</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <span class="comment">// them to the children</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;      <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(indices_on_cell[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      cell_map[std::make_pair(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;level(), <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;index())] =</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <a class="code" href="structSolutionTransfer_1_1Pointerstruct.html">Pointerstruct</a>(&amp;indices_on_cell[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>], <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  prepared_for = pure_refinement;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;}</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#a0fd4ec2972f1c0e0f7f15257a67d659f">  136</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a0fd4ec2972f1c0e0f7f15257a67d659f">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::refine_interpolate</a>(</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">const</span> VectorType &amp;<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>,</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  VectorType &amp;      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(prepared_for == pure_refinement, ExcNotPrepared());</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.size() == n_dofs_old, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.size(), n_dofs_old));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>.size() == dof_handler-&gt;n_dofs(),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;         <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>.size(), dof_handler-&gt;n_dofs()));</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(&amp;<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> != &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Vectors cannot be used as input and output&quot;</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                    <span class="stringliteral">&quot; at the same time!&quot;</span>));</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// We need to access dof indices on the entire domain. For</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// parallel::shared::Triangulations, ownership of cells might change. If they</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="comment">// allow artificial cells, we need to restore the &quot;true&quot; cell owners</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">// temporarily.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="comment">// We use the TemporarilyRestoreSubdomainIds class for this purpose: we save</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="comment">// the current set of subdomain ids, set subdomain ids to the &quot;true&quot; owner of</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="comment">// each cell upon construction of the TemporarilyRestoreSubdomainIds object,</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">// and later restore these flags when it is destroyed.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <span class="keyword">const</span> <a class="code" href="classinternal_1_1parallel_1_1shared_1_1TemporarilyRestoreSubdomainIds.html">internal::parallel::shared::TemporarilyRestoreSubdomainIds</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                                                                   <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    subdomain_modifier(dof_handler-&gt;get_triangulation());</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="classVector.html">Vector&lt;typename VectorType::value_type&gt;</a> local_values(0);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <span class="keyword">typename</span> std::map&lt;std::pair&lt;unsigned int, unsigned int&gt;,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    <a class="code" href="structSolutionTransfer_1_1Pointerstruct.html">Pointerstruct</a>&gt;::const_iterator pointerstruct,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    cell_map_end = cell_map.end();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler-&gt;cell_iterators())</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      pointerstruct =</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        cell_map.find(std::make_pair(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;level(), <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;index()));</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <span class="keywordflow">if</span> (pointerstruct != cell_map_end)</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="comment">// this cell was refined or not</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="comment">// touched at all, so we can get</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// the new values by just setting</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// or interpolating to the children,</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="comment">// which is both done by one</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="comment">// function</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> this_fe_index =</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;            pointerstruct-&gt;second.active_fe_index;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a> =</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_handler().get_fe(this_fe_index).n_dofs_per_cell();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          local_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          <span class="comment">// make sure that the size of the stored indices is the same as</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          <span class="comment">// dofs_per_cell. since we store the desired fe_index, we know</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          <span class="comment">// what this size should be</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a> == (*pointerstruct-&gt;second.indices_ptr).size(),</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                 <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            local_values(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = <a class="code" href="structinternal_1_1ElementAccess.html#a18718c24b953a9f94347d1a5ce39b585">internal::ElementAccess&lt;VectorType&gt;::get</a>(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;              <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>, (*pointerstruct-&gt;second.indices_ptr)[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;          <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;set_dof_values_by_interpolation(local_values,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                                                <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>,</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                                                this_fe_index);</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;}</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;{</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00219"></a><span class="lineno"><a class="line" href="namespaceinternal.html#ab8f56d29b683a6c2fa56111d04d17a56">  219</a></span>&#160;  <a class="code" href="namespaceinternal.html#ab8f56d29b683a6c2fa56111d04d17a56">extract_interpolation_matrices</a>(const ::DoFHandler&lt;dim, spacedim&gt; &amp;dof,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                 ::<a class="code" href="classTable.html">Table</a>&lt;2, <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a>&gt; &amp;<a class="code" href="constraints__0_8txt.html#a17881d54f84f27b04fdd47dfb1949bd4">matrices</a>)</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">if</span> (dof.has_hp_capabilities() == <span class="keyword">false</span>)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    const ::hp::FECollection&lt;dim, spacedim&gt; &amp;<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a> = dof.get_fe_collection();</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="constraints__0_8txt.html#a17881d54f84f27b04fdd47dfb1949bd4">matrices</a>.reinit(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.size(), <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.size());</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> != <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <a class="code" href="constraints__0_8txt.html#a17881d54f84f27b04fdd47dfb1949bd4">matrices</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>).reinit(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="fe__q__base__0_8txt.html#af36d3d5134aa2e6fa02ba348a4c3295f">n_dofs_per_cell</a>(),</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                  <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].<a class="code" href="fe__q__base__0_8txt.html#af36d3d5134aa2e6fa02ba348a4c3295f">n_dofs_per_cell</a>());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="comment">// see if we can get the interpolation matrices for this</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            <span class="comment">// combination of elements. if not, reset the matrix sizes to zero</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="comment">// to indicate that this particular combination isn&#39;t</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            <span class="comment">// supported. this isn&#39;t an outright error right away since we may</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="comment">// never need to actually interpolate between these two elements</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;            <span class="comment">// on actual cells; we simply have to trigger an error if someone</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            <span class="comment">// actually tries</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">try</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;              {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="classFE__Q__Base.html#a07aae97288d3b0c84d5f4ad56d4d06e4">get_interpolation_matrix</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>], <a class="code" href="constraints__0_8txt.html#a17881d54f84f27b04fdd47dfb1949bd4">matrices</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>));</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;              }</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            <span class="keywordflow">catch</span> (<span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim, spacedim&gt;</a>::</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                     ExcInterpolationNotImplemented &amp;)</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;              {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="constraints__0_8txt.html#a17881d54f84f27b04fdd47dfb1949bd4">matrices</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>).reinit(0, 0);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;              }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;          }</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="namespaceinternal.html#aaf49856d27b0b4c2f44431d1537b861d">  256</a></span>&#160;  <a class="code" href="namespaceinternal.html#aaf49856d27b0b4c2f44431d1537b861d">restriction_additive</a>(<span class="keyword">const</span> <a class="code" href="classFiniteElement.html">FiniteElement&lt;dim, spacedim&gt;</a> &amp;,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                       <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="sparse__vanka__0_8txt.html#a96771f1712564cc2701caa2fdfb4965d">std::vector&lt;bool&gt;</a>&gt; &amp;)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  {}</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="namespaceinternal.html#ab12155a98cbe1b87a17ae44485ecdd13">  262</a></span>&#160;  <a class="code" href="namespaceinternal.html#aaf49856d27b0b4c2f44431d1537b861d">restriction_additive</a>(const ::hp::FECollection&lt;dim, spacedim&gt; &amp;<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                       <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="sparse__vanka__0_8txt.html#a96771f1712564cc2701caa2fdfb4965d">std::vector&lt;bool&gt;</a>&gt; &amp;restriction_is_additive)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    restriction_is_additive.resize(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.size());</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a> = 0; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.size(); ++<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        restriction_is_additive[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>].resize(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>].<a class="code" href="fe__q__base__0_8txt.html#af36d3d5134aa2e6fa02ba348a4c3295f">n_dofs_per_cell</a>());</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>].<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          restriction_is_additive[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>][<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>].restriction_is_additive(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  }</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;} <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<a class="code" href="classSolutionTransfer.html#a7043b4ee85d2c132273385fe6cc3ec1f">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::</a></div>
<div class="line"><a name="l00280"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#a7043b4ee85d2c132273385fe6cc3ec1f">  280</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a7043b4ee85d2c132273385fe6cc3ec1f">  prepare_for_coarsening_and_refinement</a>(<span class="keyword">const</span> std::vector&lt;VectorType&gt; &amp;all_in)</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;{</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(prepared_for != pure_refinement, ExcAlreadyPrepForRef());</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(prepared_for != coarsening_and_refinement,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;         ExcAlreadyPrepForCoarseAndRef());</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="table__0_8txt.html#a7f24305532768edc889062eefd4b28cf">clear</a>();</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  n_dofs_old                 = dof_handler-&gt;n_dofs();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> in_size = all_in.size();</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(in_size != 0,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The array of input vectors you pass to this &quot;</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    <span class="stringliteral">&quot;function has no elements. This is not useful.&quot;</span>));</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; in_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(all_in[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() == n_dofs_old,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(all_in[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>(), n_dofs_old));</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="comment">// We need to access dof indices on the entire domain. For</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// parallel::shared::Triangulations, ownership of cells might change. If they</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="comment">// allow artificial cells, we need to restore the &quot;true&quot; cell owners</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">// temporarily.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <span class="comment">// We use the TemporarilyRestoreSubdomainIds class for this purpose: we save</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">// the current set of subdomain ids, set subdomain ids to the &quot;true&quot; owner of</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <span class="comment">// each cell upon construction of the TemporarilyRestoreSubdomainIds object,</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">// and later restore these flags when it is destroyed.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <span class="keyword">const</span> <a class="code" href="classinternal_1_1parallel_1_1shared_1_1TemporarilyRestoreSubdomainIds.html">internal::parallel::shared::TemporarilyRestoreSubdomainIds</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                                                   <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    subdomain_modifier(dof_handler-&gt;get_triangulation());</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="comment">// first count the number</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="comment">// of cells that will be coarsened</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="comment">// and that&#39;ll stay or be refined</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cells_to_coarsen        = 0;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cells_to_stay_or_refine = 0;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;act_cell : dof_handler-&gt;active_cell_iterators())</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;      <span class="keywordflow">if</span> (act_cell-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        ++n_cells_to_coarsen;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        ++n_cells_to_stay_or_refine;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>((n_cells_to_coarsen + n_cells_to_stay_or_refine) ==</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;           dof_handler-&gt;get_triangulation().n_active_cells(),</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;         <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_coarsen_fathers = 0;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler-&gt;cell_iterators())</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_active() &amp;&amp; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;child(0)-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      ++n_coarsen_fathers;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_cells_to_coarsen &gt;= 2 * n_coarsen_fathers, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160; </div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// allocate the needed memory. initialize</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// the following arrays in an efficient</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// way, without copying much</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  std::vector&lt;std::vector&lt;types::global_dof_index&gt;&gt;(n_cells_to_stay_or_refine)</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    .<a class="code" href="classBlockIndices.html#adbc4eb912f3af63b72c45f008c64b60b">swap</a>(indices_on_cell);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  std::vector&lt;std::vector&lt;Vector&lt;typename VectorType::value_type&gt;&gt;&gt;(</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    n_coarsen_fathers,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    std::vector&lt;Vector&lt;typename VectorType::value_type&gt;&gt;(in_size))</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    .swap(dof_values_on_cell);</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <a class="code" href="classTable.html">Table&lt;2, FullMatrix&lt;double&gt;</a>&gt;   interpolation_hp;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="sparse__vanka__0_8txt.html#a96771f1712564cc2701caa2fdfb4965d">std::vector&lt;std::vector&lt;bool&gt;</a>&gt; restriction_is_additive;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="namespaceinternal.html#ab8f56d29b683a6c2fa56111d04d17a56">internal::extract_interpolation_matrices</a>(*dof_handler, interpolation_hp);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <a class="code" href="namespaceinternal.html#aaf49856d27b0b4c2f44431d1537b861d">internal::restriction_additive</a>(dof_handler-&gt;get_fe_collection(),</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                                 restriction_is_additive);</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="comment">// we need counters for</span></div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// the &#39;to_stay_or_refine&#39; cells &#39;n_sr&#39; and</span></div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// the &#39;coarsen_fathers&#39; cells &#39;n_cf&#39;,</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_sr = 0, n_cf = 0;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler-&gt;cell_iterators())</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;      <span class="comment">// CASE 1: active cell that remains as it is</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_active() &amp;&amp; !<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a> = <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell();</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;          indices_on_cell[n_sr].resize(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;          <span class="comment">// cell will not be coarsened,</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;          <span class="comment">// so we get away by storing the</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;          <span class="comment">// dof indices and later</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;          <span class="comment">// interpolating to the children</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;          <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(indices_on_cell[n_sr]);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;          cell_map[std::make_pair(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;level(), <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;index())] =</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <a class="code" href="structSolutionTransfer_1_1Pointerstruct.html">Pointerstruct</a>(&amp;indices_on_cell[n_sr], <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;          ++n_sr;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      <span class="comment">// CASE 2: cell is inactive but will become active</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;has_children() &amp;&amp; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;child(0)-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;          <span class="comment">// we will need to interpolate from the children of this cell</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;          <span class="comment">// to the current one. in the hp-context, this also means</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;          <span class="comment">// we need to figure out which finite element space to interpolate</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;          <span class="comment">// to since that is not implied by the global FE as in the non-hp-</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;          <span class="comment">// case. we choose the &#39;least dominant fe&#39; on all children from</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;          <span class="comment">// the associated FECollection.</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;          std::set&lt;unsigned int&gt; fe_indices_children;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="geometry__info__0_8txt.html#a07de0b60409c551e987416d5062d2742">child</a> : <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;child_iterators())</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            {</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;              <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a07de0b60409c551e987416d5062d2742">child</a>-&gt;is_active() &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a07de0b60409c551e987416d5062d2742">child</a>-&gt;coarsen_flag_set(),</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                     <a class="code" href="dofs__0_8txt.html#ace93ab11d5f75755b09a3368db091adc">typename ::Triangulation</a>&lt;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                       <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;::ExcInconsistentCoarseningFlags());</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;              fe_indices_children.insert(<a class="code" href="geometry__info__0_8txt.html#a07de0b60409c551e987416d5062d2742">child</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            }</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(!fe_indices_children.empty(), <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> target_fe_index =</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            dof_handler-&gt;get_fe_collection().find_dominated_fe_extended(</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;              fe_indices_children, <span class="comment">/*codim=*/</span>0);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(target_fe_index != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                 <a class="code" href="namespaceinternal_1_1hp_1_1DoFHandlerImplementation.html">internal::hp::DoFHandlerImplementation</a>::</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                   ExcNoDominatedFiniteElementOnChildren());</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a> =</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            dof_handler-&gt;<a class="code" href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">get_fe</a>(target_fe_index).n_dofs_per_cell();</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          std::vector&lt;Vector&lt;typename VectorType::value_type&gt;&gt;(</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;            in_size, <a class="code" href="classVector.html">Vector&lt;typename VectorType::value_type&gt;</a>(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>))</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;            .<a class="code" href="classBlockIndices.html#adbc4eb912f3af63b72c45f008c64b60b">swap</a>(dof_values_on_cell[n_cf]);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="comment">// store the data of each of the input vectors. get this data</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          <span class="comment">// as interpolated onto a finite element space that encompasses</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="comment">// that of all the children. note that</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          <span class="comment">// cell-&gt;get_interpolated_dof_values already does all of the</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="comment">// interpolations between spaces</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; in_size; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_interpolated_dof_values(all_in[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>],</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                              dof_values_on_cell[n_cf][<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>],</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                              target_fe_index);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;          cell_map[std::make_pair(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;level(), <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;index())] =</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            <a class="code" href="structSolutionTransfer_1_1Pointerstruct.html">Pointerstruct</a>(&amp;dof_values_on_cell[n_cf], target_fe_index);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;          ++n_cf;</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        }</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    }</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_sr == n_cells_to_stay_or_refine, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_cf == n_coarsen_fathers, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  prepared_for = coarsening_and_refinement;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;}</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160; </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<a class="code" href="classSolutionTransfer.html#a7043b4ee85d2c132273385fe6cc3ec1f">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::</a></div>
<div class="line"><a name="l00435"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#aca4b0ab2e3fa61d5345248772fee4431">  435</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a7043b4ee85d2c132273385fe6cc3ec1f">  prepare_for_coarsening_and_refinement</a>(<span class="keyword">const</span> VectorType &amp;<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;{</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  std::vector&lt;VectorType&gt; all_in(1, <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;  <a class="code" href="quadrature__point__data__0_8txt.html#a95a7819b49ed59c1fc5d3eb14b516207">prepare_for_coarsening_and_refinement</a>(all_in);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#a1171abf820e35e02304017ef3daeeaa5">  445</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a1171abf820e35e02304017ef3daeeaa5">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::interpolate</a>(</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keyword">const</span> std::vector&lt;VectorType&gt; &amp;all_in,</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  std::vector&lt;VectorType&gt; &amp;      all_out)<span class="keyword"> const</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a> = all_in.size();</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="preprocessor">#ifdef DEBUG</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(prepared_for == coarsening_and_refinement, ExcNotPrepared());</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(all_out.size() == <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(all_out.size(), <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>));</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(all_in[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() == n_dofs_old,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;           <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(all_in[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>(), n_dofs_old));</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; all_out.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(all_out[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() == dof_handler-&gt;n_dofs(),</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;           <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(all_out[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>(), dof_handler-&gt;n_dofs()));</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(&amp;all_in[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] != &amp;all_out[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>],</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;             <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Vectors cannot be used as input and output&quot;</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        <span class="stringliteral">&quot; at the same time!&quot;</span>));</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;  <span class="comment">// We need to access dof indices on the entire domain. For</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  <span class="comment">// parallel::shared::Triangulations, ownership of cells might change. If they</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <span class="comment">// allow artificial cells, we need to restore the &quot;true&quot; cell owners</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;  <span class="comment">// temporarily.</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">// We use the TemporarilyRestoreSubdomainIds class for this purpose: we save</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// the current set of subdomain ids, set subdomain ids to the &quot;true&quot; owner of</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;  <span class="comment">// each cell upon construction of the TemporarilyRestoreSubdomainIds object,</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;  <span class="comment">// and later restore these flags when it is destroyed.</span></div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;  <span class="keyword">const</span> <a class="code" href="classinternal_1_1parallel_1_1shared_1_1TemporarilyRestoreSubdomainIds.html">internal::parallel::shared::TemporarilyRestoreSubdomainIds</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                                                   <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    subdomain_modifier(dof_handler-&gt;get_triangulation());</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  <a class="code" href="classVector.html">Vector&lt;typename VectorType::value_type&gt;</a> local_values;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;  std::vector&lt;types::global_dof_index&gt;    <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keyword">typename</span> std::map&lt;std::pair&lt;unsigned int, unsigned int&gt;,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                    <a class="code" href="structSolutionTransfer_1_1Pointerstruct.html">Pointerstruct</a>&gt;::const_iterator pointerstruct,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    cell_map_end = cell_map.end();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <a class="code" href="classTable.html">Table&lt;2, FullMatrix&lt;double&gt;</a>&gt; interpolation_hp;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <a class="code" href="namespaceinternal.html#ab8f56d29b683a6c2fa56111d04d17a56">internal::extract_interpolation_matrices</a>(*dof_handler, interpolation_hp);</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;  <a class="code" href="classVector.html">Vector&lt;typename VectorType::value_type&gt;</a> tmp, tmp2;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler-&gt;cell_iterators())</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      pointerstruct =</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        cell_map.find(std::make_pair(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;level(), <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;index()));</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keywordflow">if</span> (pointerstruct != cell_map_end)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;          <span class="keyword">const</span> std::vector&lt;types::global_dof_index&gt; *<span class="keyword">const</span> indexptr =</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            pointerstruct-&gt;second.indices_ptr;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;          <span class="keyword">const</span> std::vector&lt;Vector&lt;typename VectorType::value_type&gt;&gt;</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;            *<span class="keyword">const</span> valuesptr = pointerstruct-&gt;second.dof_values_ptr;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          <span class="comment">// cell stayed as it was or was refined</span></div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          <span class="keywordflow">if</span> (indexptr)</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;              <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(valuesptr == <span class="keyword">nullptr</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_fe_index =</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                pointerstruct-&gt;second.active_fe_index;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;              <span class="comment">// get the values of each of the input data vectors on this cell</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;              <span class="comment">// and prolong it to its children</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> in_size = indexptr-&gt;size();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                  tmp.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(in_size, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; in_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    tmp(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) =</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                      <a class="code" href="structinternal_1_1ElementAccess.html#a18718c24b953a9f94347d1a5ce39b585">internal::ElementAccess&lt;VectorType&gt;::get</a>(all_in[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>],</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                                                               (*indexptr)[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                  <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;set_dof_values_by_interpolation(tmp,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                                        all_out[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>],</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                                        old_fe_index);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;            }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (valuesptr)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <span class="comment">// the children of this cell were deleted</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            {</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;              <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(!<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;has_children(), <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;              <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(indexptr == <span class="keyword">nullptr</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a> =</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell();</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;              <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>.resize(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;              <span class="comment">// get the local</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;              <span class="comment">// indices</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;              <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;              <span class="comment">// distribute the stored data to the new vectors</span></div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                  <span class="comment">// make sure that the size of the stored indices is the same</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                  <span class="comment">// as dofs_per_cell. this is kind of a test if we use the same</span></div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                  <span class="comment">// FE in the hp-case. to really do that test we would have to</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                  <span class="comment">// store the fe_index of all cells</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classVector.html">Vector&lt;typename VectorType::value_type&gt;</a> *<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> active_fe_index = <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index();</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                  <span class="keywordflow">if</span> (active_fe_index != pointerstruct-&gt;second.active_fe_index)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                    {</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> old_index =</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        pointerstruct-&gt;second.active_fe_index;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                      <span class="keyword">const</span> <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;interpolation_matrix =</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        interpolation_hp(active_fe_index, old_index);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                      <span class="comment">// The interpolation matrix might be empty when using</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                      <span class="comment">// FE_Nothing.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                      <span class="keywordflow">if</span> (interpolation_matrix.empty())</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                        tmp.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                      <span class="keywordflow">else</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                        {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                          tmp.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                          <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>((*valuesptr)[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>(),</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                          interpolation_matrix.<a class="code" href="classFullMatrix.html#a4f94aa6df67b8da6a1a31c052ff74bcd">n</a>());</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                          <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(tmp.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(), interpolation_matrix.<a class="code" href="classFullMatrix.html#ae353e09fdd66b9df250520434f9c9275">m</a>());</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                          interpolation_matrix.<a class="code" href="classFullMatrix.html#a65a409eeef6388d99ac15e2bbe8045f6">vmult</a>(tmp, (*valuesptr)[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                        }</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a> = &amp;tmp;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    }</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a> = &amp;(*valuesptr)[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>];</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a>; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                    <a class="code" href="structinternal_1_1ElementAccess.html">internal::ElementAccess&lt;VectorType&gt;::set</a>((*<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>),</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                                             <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                                                             all_out[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;            }</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;          <span class="comment">// undefined status</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;}</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00589"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#afefd5237a9dd772c9705f48472dd25de">  589</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a1171abf820e35e02304017ef3daeeaa5">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::interpolate</a>(<span class="keyword">const</span> VectorType &amp;<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>,</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                                                         VectorType &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.size() == n_dofs_old, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.size(), n_dofs_old));</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>.size() == dof_handler-&gt;n_dofs(),</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;         <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>.size(), dof_handler-&gt;n_dofs()));</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  std::vector&lt;VectorType&gt; all_in(1);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  all_in[0] = <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  std::vector&lt;VectorType&gt; all_out(1);</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  all_out[0] = <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a>;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <a class="code" href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">interpolate</a>(all_in, all_out);</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a> = all_out[0];</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;}</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;std::size_t</div>
<div class="line"><a name="l00608"></a><span class="lineno"><a class="line" href="classSolutionTransfer.html#a34844f66f382c6d0ac423b4815299de5">  608</a></span>&#160;<a class="code" href="classSolutionTransfer.html#a34844f66f382c6d0ac423b4815299de5">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::memory_consumption</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="comment">// at the moment we do not include the memory</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="comment">// consumption of the cell_map as we have no</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// real idea about memory consumption of a</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="comment">// std::map</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="namespaceMemoryConsumption.html#a8e4965ba9955f1523ca5f3d80ade65db">MemoryConsumption::memory_consumption</a>(dof_handler) +</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;          <a class="code" href="namespaceMemoryConsumption.html#a8e4965ba9955f1523ca5f3d80ade65db">MemoryConsumption::memory_consumption</a>(n_dofs_old) +</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;          <span class="keyword">sizeof</span>(prepared_for) +</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;          <a class="code" href="namespaceMemoryConsumption.html#a8e4965ba9955f1523ca5f3d80ade65db">MemoryConsumption::memory_consumption</a>(indices_on_cell) +</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <a class="code" href="namespaceMemoryConsumption.html#a8e4965ba9955f1523ca5f3d80ade65db">MemoryConsumption::memory_consumption</a>(dof_values_on_cell));</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; </div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorType, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;std::size_t</div>
<div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="structSolutionTransfer_1_1Pointerstruct.html#a67f534db62d8d357f76483e4d12aa7f4">  625</a></span>&#160;<a class="code" href="structSolutionTransfer_1_1Pointerstruct.html#a67f534db62d8d357f76483e4d12aa7f4">SolutionTransfer&lt;dim, VectorType, spacedim&gt;::Pointerstruct::memory_consumption</a>()<span class="keyword"></span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="keyword">  const</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(*this);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;}</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160; </div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment">/*-------------- Explicit Instantiations -------------------------------*/</span></div>
<div class="line"><a name="l00633"></a><span class="lineno"><a class="line" href="numerics_2solution__transfer_8cc.html#a0b51f3ab18bbe95a551cb39fd1f18ceb">  633</a></span>&#160;<span class="preprocessor">#define SPLIT_INSTANTIATIONS_COUNT 4</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="preprocessor">#ifndef SPLIT_INSTANTIATIONS_INDEX</span></div>
<div class="line"><a name="l00635"></a><span class="lineno"><a class="line" href="numerics_2solution__transfer_8cc.html#ac91f81592cb244d000bcc4745b4960f4">  635</a></span>&#160;<span class="preprocessor">#  define SPLIT_INSTANTIATIONS_INDEX 0</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="preprocessor">#include &quot;solution_transfer.inst&quot;</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a2f6689d89a150cc75fd48eb259468d9f"><div class="ttname"><a href="classSolutionTransfer.html#a2f6689d89a150cc75fd48eb259468d9f">SolutionTransfer::dof_handler</a></div><div class="ttdeci">SmartPointer&lt; const DoFHandler&lt; dim, spacedim &gt;, SolutionTransfer&lt; dim, VectorType, spacedim &gt; &gt; dof_handler</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8h_source.html#l00423">solution_transfer.h:423</a></div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a17881d54f84f27b04fdd47dfb1949bd4"><div class="ttname"><a href="constraints__0_8txt.html#a17881d54f84f27b04fdd47dfb1949bd4">matrices</a></div><div class="ttdeci">this holds in if the matrix is actually distributed across a cluster of computers If you want to use PETSc Trilinos matrices</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00069">constraints_0.txt:69</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1hp_1_1DoFHandlerImplementation_html"><div class="ttname"><a href="namespaceinternal_1_1hp_1_1DoFHandlerImplementation.html">internal::hp::DoFHandlerImplementation</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l01695">dof_handler.h:1695</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ad207fe81a5be05e18534713c2677da7b"><div class="ttname"><a href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data error input in integration This is because in these one typically needs access not only to[2.x.39] locally owned dofs but also to[2.x.40] locally active dofs and sometimes to[2.x.41] locally relevant dofs</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="aclassFullMatrix_html_a65a409eeef6388d99ac15e2bbe8045f6"><div class="ttname"><a href="classFullMatrix.html#a65a409eeef6388d99ac15e2bbe8045f6">FullMatrix::vmult</a></div><div class="ttdeci">void vmult(Vector&lt; number2 &gt; &amp;w, const Vector&lt; number2 &gt; &amp;v, const bool adding=false) const</div></div>
<div class="ttc" id="agrid_2tria__iterator_8h_html"><div class="ttname"><a href="grid_2tria__iterator_8h.html">tria_iterator.h</a></div></div>
<div class="ttc" id="astructinternal_1_1ElementAccess_html_a18718c24b953a9f94347d1a5ce39b585"><div class="ttname"><a href="structinternal_1_1ElementAccess.html#a18718c24b953a9f94347d1a5ce39b585">internal::ElementAccess::get</a></div><div class="ttdeci">static VectorType::value_type get(const VectorType &amp;V, const types::global_dof_index i)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2vector__element__access_8h_source.html#l00073">vector_element_access.h:73</a></div></div>
<div class="ttc" id="agrid_2tria_8h_html"><div class="ttname"><a href="grid_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="anamespaceFETools_html_ad29759cb8c51f8d369a371f63be8dde0"><div class="ttname"><a href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">FETools::interpolate</a></div><div class="ttdeci">void interpolate(const DoFHandler&lt; dim, spacedim &gt; &amp;dof1, const InVector &amp;u1, const DoFHandler&lt; dim, spacedim &gt; &amp;dof2, OutVector &amp;u2)</div></div>
<div class="ttc" id="aclassinternal_1_1parallel_1_1shared_1_1TemporarilyRestoreSubdomainIds_html"><div class="ttname"><a href="classinternal_1_1parallel_1_1shared_1_1TemporarilyRestoreSubdomainIds.html">internal::parallel::shared::TemporarilyRestoreSubdomainIds</a></div><div class="ttdef"><b>Definition:</b> <a href="distributed_2shared__tria_8h_source.html#l00487">shared_tria.h:487</a></div></div>
<div class="ttc" id="aclassFullMatrix_html_ae353e09fdd66b9df250520434f9c9275"><div class="ttname"><a href="classFullMatrix.html#ae353e09fdd66b9df250520434f9c9275">FullMatrix::m</a></div><div class="ttdeci">size_type m() const</div></div>
<div class="ttc" id="aany__data__0_8txt_html_a14dffb89358dea145077df935372dee4"><div class="ttname"><a href="any__data__0_8txt.html#a14dffb89358dea145077df935372dee4">name</a></div><div class="ttdeci">*Store any amount of any type of data accessible by an identifier string try to convert it to&lt; tt &gt; type&lt;/tt &gt; and return it This function throws an exception if either the name does not exist or if the conversion fails If such an exception is not desired use try to convert it to&lt; tt &gt; type&lt;/tt &gt; and return it This function throws an exception if either the name does not exist or if the conversion fails If such an exception is not desired use this function equals it forces read only access to the data In it throws an exception if the object is not found or cannot be converted to type If such an exception is not desired use the logic of access becomes fairly complicated the standard read function may depending on whether it was const a pointer or a regular pointer This function fixes the logic and ascertains that the object does not become by accident **Perform the same action as but do not throw an exception if the pointer does not exist Return a null pointer instead ***This function tries to find the name in the list and return a pointer to the associated object If either the name is not found or the object cannot be converted to the return a null pointer is returned **Access to stored data object by index ***Try to find the object and return its index in the list Throw an exception if the object has not been found ***Try to find the object and return its index in the list returns[2.x.10] if the name was not found **Exception indicating that a function expected a vector to have a certain name</div><div class="ttdef"><b>Definition:</b> <a href="any__data__0_8txt_source.html#l00030">any_data_0.txt:30</a></div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a0fd4ec2972f1c0e0f7f15257a67d659f"><div class="ttname"><a href="classSolutionTransfer.html#a0fd4ec2972f1c0e0f7f15257a67d659f">SolutionTransfer::refine_interpolate</a></div><div class="ttdeci">void refine_interpolate(const VectorType &amp;in, VectorType &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00136">solution_transfer.cc:136</a></div></div>
<div class="ttc" id="astructSolutionTransfer_1_1Pointerstruct_html"><div class="ttname"><a href="structSolutionTransfer_1_1Pointerstruct.html">SolutionTransfer::Pointerstruct</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8h_source.html#l00483">solution_transfer.h:483</a></div></div>
<div class="ttc" id="aclassFullMatrix_html_a4f94aa6df67b8da6a1a31c052ff74bcd"><div class="ttname"><a href="classFullMatrix.html#a4f94aa6df67b8da6a1a31c052ff74bcd">FullMatrix::n</a></div><div class="ttdeci">size_type n() const</div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a34844f66f382c6d0ac423b4815299de5"><div class="ttname"><a href="classSolutionTransfer.html#a34844f66f382c6d0ac423b4815299de5">SolutionTransfer::memory_consumption</a></div><div class="ttdeci">std::size_t memory_consumption() const</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00608">solution_transfer.cc:608</a></div></div>
<div class="ttc" id="agroup__Vectors_html_ga81dcfa5c77bdd426603386c0844149ae"><div class="ttname"><a href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">Vector::size</a></div><div class="ttdeci">size_type size() const</div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a7043b4ee85d2c132273385fe6cc3ec1f"><div class="ttname"><a href="classSolutionTransfer.html#a7043b4ee85d2c132273385fe6cc3ec1f">SolutionTransfer::prepare_for_coarsening_and_refinement</a></div><div class="ttdeci">void prepare_for_coarsening_and_refinement(const std::vector&lt; VectorType &gt; &amp;all_in)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00280">solution_transfer.cc:280</a></div></div>
<div class="ttc" id="aclassTable_html"><div class="ttname"><a href="classTable.html">Table</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2array__view_8h_source.html#l00033">array_view.h:33</a></div></div>
<div class="ttc" id="alac_2la__parallel__vector_8h_html"><div class="ttname"><a href="lac_2la__parallel__vector_8h.html">la_parallel_vector.h</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1TriangulationImplementation_html_a3344398031a9e10cb9eef0784f8da1be"><div class="ttname"><a href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">internal::TriangulationImplementation::n_active_cells</a></div><div class="ttdeci">unsigned int n_active_cells(const internal::TriangulationImplementation::NumberCache&lt; 1 &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l12595">tria.cc:12595</a></div></div>
<div class="ttc" id="aclassVector_html_ac4a4dbef7dd65ef8ad35ae56b57d7c05"><div class="ttname"><a href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">Vector::reinit</a></div><div class="ttdeci">virtual void reinit(const size_type N, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="anumerical__algorithms__0_8txt_html_a852a1e245dd2de4943eeb66beeaf65b1"><div class="ttname"><a href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a></div><div class="ttdeci">****This module groups a diverse set of classes that generally implement some sort of numerical algorithm on top all the basic and finite element classes in the library They are generally unconnected to each other *Some of the like KellyErrorEstimator and act on solutions already and compute derived quantities in the first two or help transferring a set of vectors from one mesh to another *The namespaces and VectorTools provide an assortment of such as creating a Laplace projecting or interpolating a function onto the present finite element etc The difference to the functions in the DoFTools and FETools functions is that they work on the DoFTools functions only act on a given DoFHandler object without reference to a data vector</div><div class="ttdef"><b>Definition:</b> <a href="numerical__algorithms__0_8txt_source.html#l00008">numerical_algorithms_0.txt:8</a></div></div>
<div class="ttc" id="alac_2vector__element__access_8h_html"><div class="ttname"><a href="lac_2vector__element__access_8h.html">vector_element_access.h</a></div></div>
<div class="ttc" id="anumerics_2solution__transfer_8h_html"><div class="ttname"><a href="numerics_2solution__transfer_8h.html">solution_transfer.h</a></div></div>
<div class="ttc" id="alac_2trilinos__vector_8h_html"><div class="ttname"><a href="lac_2trilinos__vector_8h.html">trilinos_vector.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="aclassFE__Q__Base_html_a07aae97288d3b0c84d5f4ad56d4d06e4"><div class="ttname"><a href="classFE__Q__Base.html#a07aae97288d3b0c84d5f4ad56d4d06e4">FE_Q_Base::get_interpolation_matrix</a></div><div class="ttdeci">virtual void get_interpolation_matrix(const FiniteElement&lt; dim, spacedim &gt; &amp;source, FullMatrix&lt; double &gt; &amp;matrix) const override</div><div class="ttdef"><b>Definition:</b> <a href="fe__q__base_8cc_source.html#l00511">fe_q_base.cc:511</a></div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a788a900c27e9451b861c71f2be89cebb"><div class="ttname"><a href="classSolutionTransfer.html#a788a900c27e9451b861c71f2be89cebb">SolutionTransfer::~SolutionTransfer</a></div><div class="ttdeci">~SolutionTransfer()</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00065">solution_transfer.cc:65</a></div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a30a552b07accf65da90f851e25d14d1c"><div class="ttname"><a href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div><div class="ttdeci">3, where it offers following possibilities:a face(quad) being refined in x- or y-direction(in the face-intern coordinate system) separately,([2.x.79] or([2.x.80] which corresponds to([2.x.81]). Additionally, it offers the possibilities a face can have through repeated anisotropic refinement steps performed on one of the two neighboring cells. It might be possible for example, that a face(quad) is refined with[2.x.82] and afterwards the left child is again refined with[2.x.83], so that there are three active subfaces. Note, however, that only refinement cases are allowed such that each line on a face between two hexes has not more than one hanging node. Furthermore, it is not allowed that two neighboring hexes are refined such that one of the hexes refines the common face with[2.x.84] and the other hex refines that face with[2.x.85] . In fact,[2.x.86] takes care of this situation and ensures that each face of a refined cell is completely contained in a single face of neighboring cells. The following drawings explain the SubfacePossibilities and give the corresponding subface numbers:*[1.x.4] **[2.x.87] *[0.x.68] *Possible cases of faces being subdivided into subface. See documentation to the SubfacePossibilities&lt; 3 &gt; for more details on the subface possibilities. *[0.x.69] *A class that provides all possible cases a face(in the current space dimension[2.x.88] might be subdivided into subfaces. *[2.x.89] *[0.x.70] *Constructor. Take and store a value indicating a particular subface possibility in the list of possible situations specified in the base class. *[0.x.71] *Return the numeric value stored by this class. While the presence of this operator might seem dangerous, it is useful in cases where one would like to have code like&lt; code &gt;switch(subface_case)... case[2.x.90] ...&lt;/code &gt;, which can be written as&lt; code &gt;switch[2.x.91] Another application is to use an object of the current type as an index into an array dim</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00202">geometry_info_0.txt:202</a></div></div>
<div class="ttc" id="anamespaceMemoryConsumption_html_a8e4965ba9955f1523ca5f3d80ade65db"><div class="ttname"><a href="namespaceMemoryConsumption.html#a8e4965ba9955f1523ca5f3d80ade65db">MemoryConsumption::memory_consumption</a></div><div class="ttdeci">std::enable_if&lt; std::is_fundamental&lt; T &gt;::value, std::size_t &gt;::type memory_consumption(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="base_2memory__consumption_8h_source.html#l00255">memory_consumption.h:255</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2fe_2fe_8h_html"><div class="ttname"><a href="include_2deal_8II_2fe_2fe_8h.html">fe.h</a></div></div>
<div class="ttc" id="aclassparallel_1_1distributed_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="distributed_2tria_8h_source.html#l00226">tria.h:226</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_af85863b31be0cbd660acba99051e0634"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a></div><div class="ttdeci">****This module contains classes that are used in the exception mechanism of deal II **Exceptions are used in two different not in static assertions are typically used to check that parameters to functions satisfy certain that internal data structures are and similar assertions For static assertions are used to make sure that two vectors that are added together have the same number of components **everything else would not make any sense anyway *Such checks are performed by the[2.x.3] macro in several thousand places within the library several tutorial programs starting with[2.x.4] show how to do this *If static a assertion is the exception mechanism generates an exception of a type that indicates what exactly goes wrong displays appropriate information including the exact location where the problem was detected and then aborts the program **if you try to add two vectors of different there is nothing that can be done within the program to cope with the you have to go fix the program code instead There is generally not even a reason to[2.x.5] an exception object using the usual C exception mechanism because there is nothing a function higher up could do in such cases to rectify the situation and deal with it in a useful way **it s not that the program received bad data</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00015">exceptions_0.txt:15</a></div></div>
<div class="ttc" id="aclassBlockIndices_html_adbc4eb912f3af63b72c45f008c64b60b"><div class="ttname"><a href="classBlockIndices.html#adbc4eb912f3af63b72c45f008c64b60b">BlockIndices::swap</a></div><div class="ttdeci">void swap(BlockIndices &amp;u, BlockIndices &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2block__indices_8h_source.html#l00491">block_indices.h:491</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga9442b63275c9ef3fab29bc222831c49c"><div class="ttname"><a href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a></div><div class="ttdeci">#define AssertDimension(dim1, dim2)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01749">exceptions.h:1749</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a98c83a8c964d1c88f6f2493b1c2ae26f"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a98c83a8c964d1c88f6f2493b1c2ae26f">out</a></div><div class="ttdeci">and where the chemical species react with each other based on reaction coefficients that also depend nonlinearly and in complicated ways on the chemical and pressure In many the exact formulas for all of these coefficients can take several lines to write out</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="anamespaceinternal_html_ab8f56d29b683a6c2fa56111d04d17a56"><div class="ttname"><a href="namespaceinternal.html#ab8f56d29b683a6c2fa56111d04d17a56">internal::extract_interpolation_matrices</a></div><div class="ttdeci">void extract_interpolation_matrices(const ::DoFHandler&lt; dim, spacedim &gt; &amp;dof, ::Table&lt; 2, FullMatrix&lt; double &gt;&gt; &amp;matrices)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00219">solution_transfer.cc:219</a></div></div>
<div class="ttc" id="aclassFiniteElement_html"><div class="ttname"><a href="classFiniteElement.html">FiniteElement</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00910">fe.h:910</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a4874d3f2becad91b2bdda53a5539ff54"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a></div><div class="ttdeci">pow(2x+1, y)` and computing the derivatives `diff(f, x)` and `diff(f, y)`. At this point there is no assumption of what `x` and `y` represent f</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00347">automatic_and_symbolic_differentiation_0.txt:347</a></div></div>
<div class="ttc" id="anamespaceinternal_html_aaf49856d27b0b4c2f44431d1537b861d"><div class="ttname"><a href="namespaceinternal.html#aaf49856d27b0b4c2f44431d1537b861d">internal::restriction_additive</a></div><div class="ttdeci">void restriction_additive(const FiniteElement&lt; dim, spacedim &gt; &amp;, std::vector&lt; std::vector&lt; bool &gt;&gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00256">solution_transfer.cc:256</a></div></div>
<div class="ttc" id="agrid_2tria__accessor_8h_html"><div class="ttname"><a href="grid_2tria__accessor_8h.html">tria_accessor.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="adistributed_2tria_8h_html"><div class="ttname"><a href="distributed_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="afe__q__base__0_8txt_html_af36d3d5134aa2e6fa02ba348a4c3295f"><div class="ttname"><a href="fe__q__base__0_8txt.html#af36d3d5134aa2e6fa02ba348a4c3295f">n_dofs_per_cell</a></div><div class="ttdeci">*This class collects the basic methods used in FE_Q FE_Q_DG0 and FE_Q_Bubbles There is no public constructor for this class as it is not functional as a stand alone The completion of definitions is left to the derived classes ***Constructor **Return the matrix interpolating from the given finite element to the present one The size of the matrix is then[2.x.0] times&lt; tt &gt; source n_dofs_per_cell()&lt;/tt &gt;. These matrices are only available if the source element is also a[2.x.1] element. Otherwise</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_ade22ffd9fb5b07842daa504929244aa7"><div class="ttname"><a href="classFEValuesBase.html#ade22ffd9fb5b07842daa504929244aa7">FEValuesBase::get_fe</a></div><div class="ttdeci">const FiniteElement&lt; dim, spacedim &gt; &amp; get_fe() const</div></div>
<div class="ttc" id="alac_2block__vector_8h_html"><div class="ttname"><a href="lac_2block__vector_8h.html">block_vector.h</a></div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a1171abf820e35e02304017ef3daeeaa5"><div class="ttname"><a href="classSolutionTransfer.html#a1171abf820e35e02304017ef3daeeaa5">SolutionTransfer::interpolate</a></div><div class="ttdeci">void interpolate(const std::vector&lt; VectorType &gt; &amp;all_in, std::vector&lt; VectorType &gt; &amp;all_out) const</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00445">solution_transfer.cc:445</a></div></div>
<div class="ttc" id="atable__0_8txt_html_a7f24305532768edc889062eefd4b28cf"><div class="ttname"><a href="table__0_8txt.html#a7f24305532768edc889062eefd4b28cf">clear</a></div><div class="ttdeci">examples are data tables that are loaded at start up time and then used over the course of the run time of the program In such the start up cost of running this function can be amortized over and the potential memory savings from not having to store the table on each process may be substantial on machines with large core counts on which many MPI processes run on the same machine *This function only makes sense if the data type T is self i all of its information is stored in its member and if none of the member variables are pointers to other parts of the memory This is because if a type T does have pointers to other parts of then moving T into a shared memory space does not result in the other processes having access to data that the object points to with its member variable and are typically in memory areas not accessible to the other processes As a the usual use case for this function is to share arrays of simple objects such as double s or int s *After calling this objects on different MPI processes share a common state That means that certain operations become i they must be called on all participating processors at the same time In you can no longer call or clear() on one MPI process **- you have to do so on all processes at the same time</div></div>
<div class="ttc" id="aclassSolutionTransfer_html_ab7ceeaf8fa65f8699c7bc2e19cfec803"><div class="ttname"><a href="classSolutionTransfer.html#ab7ceeaf8fa65f8699c7bc2e19cfec803">SolutionTransfer::prepare_for_pure_refinement</a></div><div class="ttdeci">void prepare_for_pure_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00087">solution_transfer.cc:87</a></div></div>
<div class="ttc" id="adofs_2dof__handler_8h_html"><div class="ttname"><a href="dofs_2dof__handler_8h.html">dof_handler.h</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a8ae36952c7e0cc778b47b5371b3aeff1"><div class="ttname"><a href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a></div><div class="ttdeci">static const unsigned int invalid_unsigned_int</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00179">types.h:179</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a07de0b60409c551e987416d5062d2742"><div class="ttname"><a href="geometry__info__0_8txt.html#a07de0b60409c551e987416d5062d2742">child</a></div><div class="ttdeci">i&lt; vertices_per_face;++i)&lt;/tt &gt;, at least if[2.x.97] is an&lt; tt &gt;unsigned int&lt;/tt &gt;. *[0.x.86] *Number of lines each face has. *[0.x.87] *Number of quads on each face. *[0.x.88] *Number of lines of a cell. *[0.x.89] *Number of quadrilaterals of a cell. *[0.x.90] *Number of hexahedra of a cell. *[0.x.91] *Rearrange vertices for UCD output. For a cell being written in UCD format, each entry in this field contains the number of a vertex in&lt; tt &gt;deal.II&lt;/tt &gt; that corresponds to the UCD numbering at this location. Typical example:write a cell and arrange the vertices, such that UCD understands them. *[1.x.7] *As the vertex numbering in deal.II versions&lt;=5.1 happened to coincide with the UCD numbering, this field can also be used like a old_to_lexicographic mapping. *[0.x.92] *Rearrange vertices for OpenDX output. For a cell being written in OpenDX format, each entry in this field contains the number of a vertex in&lt; tt &gt;deal.II&lt;/tt &gt; that corresponds to the DX numbering at this location. Typical example:write a cell and arrange the vertices, such that OpenDX understands them. *[1.x.8] **[0.x.93] *This class provides dimension independent information to all topological structures that make up the unit, or[2.x.98] &quot;reference cell&quot;. This class has been superseded by the ReferenceCell class **- see there for more information.**It is the one central point in the library where information about the numbering of vertices, lines, or faces of the reference cell is collected. Consequently, the information of this class is used extensively in the geometric description of Triangulation objects, as well as in various other parts of the code. In particular, it also serves as the focus of writing code in a dimension independent way;for example, instead of writing a loop over vertices 0&lt;=v&lt; 4 in 2d, one would write it as[2.x.99] thus allowing the code to work in 3d as well without changes.*The most frequently used parts of the class are its static members like vertices_per_cell, faces_per_cell, etc. However, the class also offers information about more abstract questions like the orientation of faces, etc. The following documentation gives a textual description of many of these concepts.**[1.x.9] *From version 5.2 onwards deal.II is based on a numbering scheme that uses a lexicographic ordering(with x running fastest) wherever possible, hence trying to adopt a kind of 'canonical' ordering.*The ordering of vertices and faces(lines) in 2d is defined by ****- Vertices are numbered in lexicographic ordering ****- Faces(lines in 2d):first the two faces with normals in x- and then y-direction. For each two faces:first the face with normal in negative coordinate direction, then the one with normal in positive direction, i.e. the faces are ordered according to their normals pointing in **-, x, **-, y direction.****- The direction of a line is represented by the direction of point 0 towards point 1 and is always in one of the coordinate directions ****- Face lines in 3d are ordered, such that the induced 2d local coordinate system(x, y) implies(right hand rule) a normal in face normal direction, see N2/.*The resulting numbering of vertices and faces(lines) in 2d as well as the directions of lines is shown in the following.**[1.x.10] **Note that the orientation of lines has to be correct upon construction of a grid;however, it is automatically preserved upon refinement.*Further we define that child lines have the same direction as their parent, i.e. that&lt; tt &gt;line-&gt;child(0) -&gt;vertex(0)==line-&gt;vertex(0)&lt;/tt &gt; and&lt; tt &gt;line-&gt; child(1) -&gt; vertex(1)==line-&gt;vertex(1)&lt;/tt &gt;. This also implies, that the first sub-line(&lt; tt &gt;line-&gt;child(0)&lt;/tt &gt;) is the one at vertex(0) of the old line. *Similarly we define, that the four children of a quad are adjacent to the vertex with the same number of the old quad. *Note that information about several of these conventions can be extracted at run- or compile-time from the member functions and variables of the present class. **[1.x.11] *When explicit coordinates are required for points in a cell(e.g for quadrature formulae or the point of definition of trial functions), we define the following coordinate system for the unit cell:**[1.x.12] **Here, vertex 0 is the origin of the coordinate system, vertex 1 has coordinates&lt; tt &gt;(1, 0)&lt;/tt &gt;, vertex 2 at&lt; tt &gt;(0, 1)&lt;/tt &gt; and vertex 3 at&lt; tt &gt;(1, 1)&lt;/tt &gt;. The[2.x.100] function can be used to query this information at run-time. **[1.x.13] *By convention, we will use the following numbering conventions for vertices, lines and faces of hexahedra in three space dimensions. Before giving these conventions we declare the following sketch to be the standard way of drawing 3d pictures of hexahedra:**[1.x.14] *The left part of the picture shows the left, bottom and back face of the cube, while the right one shall be the top, right and front face. You may recover the whole cube by moving the two parts together into one. *Note again that information about several of the following conventions can be extracted at run- or compile-time from the member functions and variables of the present class. *[1.x.15] *The ordering of vertices in 3d is defined by the same rules as in the 2d case. In particular, the following is still true:****- Vertices are numbered in lexicographic ordering. *Hence, the vertices are numbered as follows **[1.x.16] **We note, that first the vertices on the bottom face(z=0) are numbered exactly the same way as are the vertices on a quadrilateral. Then the vertices on the top face(z</div></div>
<div class="ttc" id="alac_2vector_8h_html"><div class="ttname"><a href="lac_2vector_8h.html">vector.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga6060b2304b8600f5efa0d31eeda0207d"><div class="ttname"><a href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">StandardExceptions::ExcDimensionMismatch</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcDimensionMismatch(std::size_t arg1, std::size_t arg2)</div></div>
<div class="ttc" id="adofs_2dof__accessor_8h_html"><div class="ttname"><a href="dofs_2dof__accessor_8h.html">dof_accessor.h</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_ad3b9cdeadeb3bcdb52af5db70c041a6e"><div class="ttname"><a href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **Constructor Takes all data stored in MatrixFree If applied to problems with more than one finite element or more than one quadrature formula selected during construction of[2.x.343] the appropriate component can be selected by the optional arguments[2.x.344] matrix_free Data object that contains all data[2.x.345] dof_no If matrix_free was set up with multiple DoFHandler this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.346] quad_no If matrix_free was set up with multiple Quadrature this parameter selects the appropriate number of the quadrature formula[2.x.347] first_selected_component If the dof_handler selected by dof_no uses an FESystem consisting of more than one this parameter allows for selecting the component where the current evaluation routine should start Note that one evaluator does not support combining different shape functions in different components In other the same base element of a FESystem needs to be set for the components between[2.x.348] and[2.x.349][2.x.350] active_fe_index If matrix_free was set up with DoFHandler objects with[2.x.351] this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.352] active_quad_index If matrix_free was set up with[2.x.353] this parameter selects the appropriate number of the quadrature formula **Constructor Takes all data stored in MatrixFree for a given cell which allows to automatically identify the active_fe_index and active_quad_index in case of a p adaptive strategy The rest of the arguments are the same as in the constructor above **Constructor that comes with reduced functionality and works similar as FEValues The arguments are similar to the ones passed to the constructor of with the notable difference that FEEvaluation expects a one dimensional quadrature instead of a[2.x.354] dimensional one The finite element can be both scalar or vector but this method always only selects a scalar base element at a the optional argument[2.x.356] allows to specify the index of the base element to be used for evaluation Note that the internal data structures always assume that the base element is non primitive are not supported currently As known from a call to the reinit method with a[2.x.357] is necessary to make the geometry and degrees of freedom of the current class known::If the iterator includes DoFHandler the initialization allows to also read from or write to vectors in the standard way for[2.x.359] types for one cell at a time this approach is much slower than the path with MatrixFree with MPI since index translation has to be done As only one cell at a time is this method does not vectorize over several but only possibly within the element if the evaluate integrate routines are combined inside user an object of type i the underlying mapping and quadrature points do only need to be evaluated once Make sure to not pass an optional object around when you intend to use the FEEvaluation object in parallel to the given one because otherwise the intended sharing may create race conditions **Copy constructor If FEEvaluationBase was constructed from a fe</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00555">fe_evaluation_0.txt:555</a></div></div>
<div class="ttc" id="aquadrature__point__data__0_8txt_html_a95a7819b49ed59c1fc5d3eb14b516207"><div class="ttname"><a href="quadrature__point__data__0_8txt.html#a95a7819b49ed59c1fc5d3eb14b516207">prepare_for_coarsening_and_refinement</a></div><div class="ttdeci">i a property that varies discontinuously within a solid In such trying to transfer data from the quadrature points to a finite element field that is once evaluated at a different set of quadrature the quadrature rule[2.x.94] used to integrate its mass matrix and finally the quadrature rule[2.x.95] which is used to store[2.x.96][2.x.97][2.x.98] has to be scalar valued *Since this class does projection on cell by cell basis[2.x.100] is only required to be continuous within the cell **Prepare for coarsening and refinement of a triangulation[2.x.101][2.x.102] represents the cell data which should be transferred and it should be initialized for each locally owned active cell *Although CellDataStorage class allows storing on different cells different objects derived from the base class here we assume that[2.x.104] contains objects of the same more specifically they pack unpack the same data **Interpolate the data previously stored in this object before the mesh was refined or coarsened onto the quadrature points of the currently active set of cells *Before calling this function the user is expected to populate the data stored in the[2.x.106] object provided to prepare_for_coarsening_and_refinement() at new cells using[2.x.107] If that is not the case</div></div>
<div class="ttc" id="astructinternal_1_1ElementAccess_html"><div class="ttname"><a href="structinternal_1_1ElementAccess.html">internal::ElementAccess</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2vector__element__access_8h_source.html#l00030">vector_element_access.h:30</a></div></div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassSolutionTransfer_html_a10e7257afcc5508c2d5021c5fc9a89c0"><div class="ttname"><a href="classSolutionTransfer.html#a10e7257afcc5508c2d5021c5fc9a89c0">SolutionTransfer::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00074">solution_transfer.cc:74</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ad83f9d9d8b603ed71c3483de199bc7a7"><div class="ttname"><a href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a></div><div class="ttdeci">their purpose is merely to keepdeal II as uniform as possible Uniformity reduces the number of bugs weproduce because we for always assume that input arguments comebefore output arguments of a function call They also simplify reading codebecause some things become clear already by looking at the style a piece ofcode is without having to look up the exact definition of something **deal II uses[2.x.2] to normalize indentation Astyle file is provided at ***Before a you should run **on each of your files This will make sure indentation is conforming to thestyle guidelines outlined in this page *This is cumbersome and more you can just run **in whatever directory you set up the library to be compiled in</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00013">coding_conventions_0.txt:13</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="anamespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2aligned__vector_8h_source.html#l00471">aligned_vector.h:471</a></div></div>
<div class="ttc" id="abase_2memory__consumption_8h_html"><div class="ttname"><a href="base_2memory__consumption_8h.html">memory_consumption.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gaa3cbced9f1d4ae661f13018f4c980aa1acc6b05c836e9f74fb7ab9390ffc26f1c"><div class="ttname"><a href="group__Exceptions.html#gaa3cbced9f1d4ae661f13018f4c980aa1acc6b05c836e9f74fb7ab9390ffc26f1c">DataOutBase::none</a></div><div class="ttdeci">@ none</div><div class="ttdef"><b>Definition:</b> <a href="base_2data__out__base_8h_source.html#l01568">data_out_base.h:1568</a></div></div>
<div class="ttc" id="abase_2bounding__box__0_8txt_html_a448658829353774b234a6819182c72db"><div class="ttname"><a href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a></div><div class="ttdeci">*The enumerator NeighborType describes the neighboring relation between two bounding boxes ***Not in this means that the two boxes touch at one corner of the each box **Attached in this means that the two boxes touch along an edge **Mergeable e g **or one is inside the other **A class that represents a box of arbitrary dimension&lt; tt &gt; spacedim&lt;/tt &gt; and with sides parallel to the coordinate axes that is a region a bounding box is top right for useful in parallel distributed meshes to give a general description of the owners of each portion of the mesh *Taking the cross section of a BoundingBox&lt; spacedim &gt; orthogonal to a given direction gives a box in one dimension the coordinates of the cross section of BoundingBox&lt; 3 &gt; can be ordered in different ways That if we take the cross section orthogonal to the y direction we could either order a coordinate into a coordinate as[2.x.1] or as[2.x.2] This class uses the second convention corresponding to the coordinates being ordered cyclicly[2.x.3] To be if we take a cross z y *This is according to the convention set by the function *[2.x.4] **Standard constructor Creates an object that corresponds to an empty i e a degenerate box with both points being the origin **Standard constructor for non empty Number elements **Return a reference to the boundary_points **Return const a reference to the boundary_points **Test for equality **Test for inequality **Check if the current object and[2.x.5] are i e if the boxes have dimension spacedim</div><div class="ttdef"><b>Definition:</b> <a href="base_2bounding__box__0_8txt_source.html#l00070">bounding_box_0.txt:70</a></div></div>
<div class="ttc" id="alac_2la__vector_8h_html"><div class="ttname"><a href="lac_2la__vector_8h.html">la_vector.h</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_ac00ea19562c135512a6ff275a3cf0d8f"><div class="ttname"><a href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has this class generates all dim dimensional polynomials of the where the sum and[1.x.8] is less than or equal *[1.x.9] The i e for each dim dimensional polynomial in the polynomial space it gives the indices j</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00004">polynomial_space_0.txt:4</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="astructSolutionTransfer_1_1Pointerstruct_html_a67f534db62d8d357f76483e4d12aa7f4"><div class="ttname"><a href="structSolutionTransfer_1_1Pointerstruct.html#a67f534db62d8d357f76483e4d12aa7f4">SolutionTransfer::Pointerstruct::memory_consumption</a></div><div class="ttdeci">std::size_t memory_consumption() const</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00625">solution_transfer.cc:625</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a33b522422da89e5c080e7405ad49d7c7"><div class="ttname"><a href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">FiniteElementData::n_dofs_per_cell</a></div><div class="ttdeci">unsigned int n_dofs_per_cell() const</div></div>
<div class="ttc" id="alac_2la__parallel__block__vector_8h_html"><div class="ttname"><a href="lac_2la__parallel__block__vector_8h.html">la_parallel_block_vector.h</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; typename VectorType::value_type &gt;</a></div></div>
<div class="ttc" id="adofs__0_8txt_html_ace93ab11d5f75755b09a3368db091adc"><div class="ttname"><a href="dofs__0_8txt.html#ace93ab11d5f75755b09a3368db091adc">Triangulation</a></div><div class="ttdeci">and the DoF handler object provides an enumeration of the i it is provides a concrete structure of the space so that we can describe functions in this finite dimensional space by vectors of coefficients *DoFHandlers extend Triangulation offer iterators that run over all or other geometric objects that make up a triangulation These iterators are derived from the triangulation iterators and therefore offer the same but they also offer additional functions For they allow to query the indices of the degrees of freedom associated with the present cell Note that DoFHandler classes are[1.x.1] from Triangulation</div><div class="ttdef"><b>Definition:</b> <a href="dofs__0_8txt_source.html#l00008">dofs_0.txt:8</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_ae3fd76f0fcd93dcbcc9df2df2c6028fb"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of this</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="adistributed_2shared__tria_8h_html"><div class="ttname"><a href="distributed_2shared__tria_8h.html">shared_tria.h</a></div></div>
<div class="ttc" id="asparse__vanka__0_8txt_html_a96771f1712564cc2701caa2fdfb4965d"><div class="ttname"><a href="sparse__vanka__0_8txt.html#a96771f1712564cc2701caa2fdfb4965d">vector&lt; bool &gt;</a></div><div class="ttdeci">this elimination is done by the modification of the right hand and in the end these degrees of freedom do not occur in the matrix and solution vector any more at all *This system is solved and the values are updated into the destination vector the matrices are built up such that the degree of freedom associated with the Lagrange multiplier is the first one usually the upper left entry in the matrix is zero It is not clear to so it must persist longer than the Vanka object The same is true for the matrix The matrix[2.x.11] which is passed here may or may not be the same matrix for which this object shall act as preconditioner In it is conceivable that the preconditioner is build up for one matrix but is used for subsequent steps in a nonlinear process as where the matrix changes in each step slightly **Destructor Delete all allocated matrices **Parameters for SparseVanka **Constructor For the parameters see below **Constructor For the parameters see below[2.x.12] The use of this constructor is deprecated **the second and third parameters are ignored **Indices of those degrees of freedom that we shall work on **If the default constructor is used then this function needs to be called before an object of this class is used as preconditioner For more detail about possible parameters see the class documentation and the documentation of the[2.x.13] class After this function is called the preconditioner is ready to be only values for allowed indices are written to[2.x.27] so the application of this function only does what is announced in the general documentation if the given mask sets all values to zero The reason for providing the mask anyway is that in derived classes we may want to apply the preconditioner to parts of the matrix in order to parallelize the application it is important to only write to some slices of[2.x.28] in order to eliminate the dependencies of threads of each other If a null pointer is passed instead of a pointer to then it is assumed that we shall work on all degrees of freedom This is then equivalent to calling the function with a&lt; tt &gt; vector&lt; bool &gt;(n_dofs, true)&lt;/tt &gt;. The[2.x.30] of this class of course calls this function with a null pointer *[0.x.17] *Determine an estimate for the memory consumption(in bytes) of this object. *[0.x.18] *Pointer to the matrix. *[0.x.19] *Indices of those degrees of freedom that we shall work on. *[0.x.20] *Array of inverse matrices</div></div>
<div class="ttc" id="alac_2trilinos__parallel__block__vector_8h_html"><div class="ttname"><a href="lac_2trilinos__parallel__block__vector_8h.html">trilinos_parallel_block_vector.h</a></div></div>
<div class="ttc" id="aclassSolutionTransfer_html_ad33057265bf051ae9972df33c54b892e"><div class="ttname"><a href="classSolutionTransfer.html#ad33057265bf051ae9972df33c54b892e">SolutionTransfer::SolutionTransfer</a></div><div class="ttdeci">SolutionTransfer(const DoFHandler&lt; dim, spacedim &gt; &amp;dof)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8cc_source.html#l00046">solution_transfer.cc:46</a></div></div>
<div class="ttc" id="afe_2fe__values__0_8txt_html_a15ff2e0c168966d6ae13c4faabcec165"><div class="ttname"><a href="fe_2fe__values__0_8txt.html#a15ff2e0c168966d6ae13c4faabcec165">dofs_per_cell</a></div><div class="ttdeci">we have to work a bit harder to compute this information **Default constructor Creates an invalid object **Constructor for an object that represents a single scalar component of a FEValuesBase for the shape function and quadrature point selected by the arguments[2.x.27] shape_function Number of the shape function to be evaluated Note that this number runs from zero to dofs_per_cell</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values__0_8txt_source.html#l00073">fe_values_0.txt:73</a></div></div>
<div class="ttc" id="alac_2petsc__block__vector_8h_html"><div class="ttname"><a href="lac_2petsc__block__vector_8h.html">petsc_block_vector.h</a></div></div>
<div class="ttc" id="alac_2petsc__vector_8h_html"><div class="ttname"><a href="lac_2petsc__vector_8h.html">petsc_vector.h</a></div></div>
<div class="ttc" id="afunction__0_8txt_html_a4f780342f2d5d632f82cf7fd90158a66"><div class="ttname"><a href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a></div><div class="ttdeci">it defaults to i e the first component **Return all components of a vector valued function at a given point&lt; tt &gt; values&lt;/tt &gt; shall have the right size i e **Set&lt; tt &gt; values&lt;/tt &gt; to the point values of the specified component of the function at the&lt; tt &gt; points&lt;/tt &gt; It is assumed that&lt; tt &gt; values&lt;/tt &gt; already has the right size</div><div class="ttdef"><b>Definition:</b> <a href="function__0_8txt_source.html#l00052">function_0.txt:52</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
