<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step_76.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-76 tutorial program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The step-76 tutorial program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial depends on <a class="el" href="step_67.html">step-67</a>.</p>
<p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#SharedmemoryandhybridparallelizationwithMPI30">Shared-memory and hybrid parallelization with MPI-3.0</a>
      <ul>
        <li><a href="#Motivation">Motivation</a>
        <li><a href="#BasicMPI30commands">Basic MPI-3.0 commands</a>
        <li><a href="#MPI30andLinearAlgebradistributedVector">MPI-3.0 and LinearAlgebra::distributed::Vector</a>
        <li><a href="#MPI30andMatrixFree">MPI-3.0 and MatrixFree</a>
      </ul>
        <li><a href="#Cellcentricloops">Cell-centric loops</a>
      <ul>
        <li><a href="#MotivationFCLvsCCL">Motivation: FCL vs. CCL</a>
        <li><a href="#CellcentricloopsandMatrixFree">Cell-centric loops and MatrixFree</a>
      </ul>
        <li><a href="#ProvidinglambdastoMatrixFreeloops">Providing lambdas to MatrixFree loops</a>
        <li><a href="#VectorizedArrayType">VectorizedArrayType</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Parametersandutilityfunctions">Parameters and utility functions</a>
        <li><a href="#EuleroperatorusingacellcentricloopandMPI30sharedmemory">Euler operator using a cell-centric loop and MPI-3.0 shared memory</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
      <ul>
        <li><a href="#ExtensiontothecompressibleNavierStokesequations">Extension to the compressible Navier-Stokes equations</a>
        <li><a href="#BlockGaussSeidellikepreconditioners">Block Gauss-Seidel-like preconditioners</a>
    </ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
</p>
<p><br  />
</p>
<p><em> This program was contributed by Martin Kronbichler, Peter Munch, and David Schneider. Many of the features shown here have been added to deal.II during and for the development of the deal.II-based, efficient, matrix-free finite-element library for high-dimensional partial differential equations hyper.deal (see <a href="https://github.com/hyperdeal/hyperdeal">https://github.com/hyperdeal/hyperdeal</a>). For more details and for applications of the presented features in slightly different contexts (high-dimensional advection equation and Vlasov-Poisson equations) see the release paper <b>[munch2020hyperdeal]</b>.</em></p>
<p><em>This work was partly supported by the German Research Foundation (DFG) through the project "High-order discontinuous Galerkin for the exa-scale" (ExaDG) within the priority program "Software for Exascale Computing" (SPPEXA) and by the Bavarian government through the project "High-order matrix-free finite
element implementations with hybrid parallelization and improved data locality" within the KONWIHR program. </em></p>
<p><a class="anchor" id="Intro"></a> <a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p>This tutorial program solves the Euler equations of fluid dynamics, using an explicit time integrator with the matrix-free framework applied to a high-order discontinuous Galerkin discretization in space. The numerical approach used here is identical to that used in <a class="el" href="step_67.html">step-67</a>, however, we utilize different advanced <a class="el" href="classMatrixFree.html">MatrixFree</a> techniques to reach even a higher throughput.</p>
<p>The two main features of this tutorial are:</p><ul>
<li>the usage of shared-memory features from MPI-3.0 and</li>
<li>the usage of cell-centric loops, which allow to write to the global vector only once and, therefore, are ideal for the usage of shared memory.</li>
</ul>
<p>Further topics we discuss in this tutorial are the usage and benefits of the template argument VectorizedArrayType (instead of simply using <a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>) as well as the possibility to pass lambdas to <a class="el" href="classMatrixFree.html">MatrixFree</a> loops.</p>
<p>For details on the numerics, we refer to the documentation of <a class="el" href="step_67.html">step-67</a>. We concentrate here only on the key differences.</p>
<p><a class="anchor" id="SharedmemoryandhybridparallelizationwithMPI30"></a></p><h3>Shared-memory and hybrid parallelization with MPI-3.0</h3>
<p><a class="anchor" id="Motivation"></a></p><h4>Motivation</h4>
<p>There exist many shared-memory libraries that are based on threads like TBB, OpenMP, or TaskFlow. Integrating such libraries into existing MPI programs allows one to use shared memory. However, these libraries come with an overhead for the programmer, since all parallelizable code sections have to be found and transformed according to the library used, including the difficulty when some third-party numerical library, like an iterative solver package, only relies on MPI.</p>
<p>Considering a purely MPI-parallelized FEM application, one can identify that the major time and memory benefit of using shared memory would come from accessing the part of the solution vector owned by the processes on the same compute node without the need to make explicit copies and buffering them. Fur this propose, MPI-3.0 provides shared-memory features based on so-called windows, where processes can directly access the data of the neighbors on the same shared-memory domain.</p>
<p><a class="anchor" id="BasicMPI30commands"></a></p><h4>Basic MPI-3.0 commands</h4>
<p>A few relevant MPI-3.0 commands are worth discussing in detail. A new MPI communicator <code>comm_sm</code>, which consists of processes from the communicator <code>comm</code> that have access to the same shared memory, can be created via:</p>
<div class="fragment"><div class="line">MPI_Comm_split_type(comm, MPI_COMM_TYPE_SHARED, <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>, MPI_INFO_NULL, &amp;comm_sm);</div>
</div><!-- fragment --><p>The following code snippet shows the simplified allocation routines of shared memory for the value type <code>T</code> and the size <code>local_size</code>, as well as, how to query pointers to the data belonging to processes in the same shared-memory domain:</p>
<div class="fragment"><div class="line">MPI_Win          win;         <span class="comment">// window</span></div>
<div class="line"><a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a> *              data_this;   <span class="comment">// pointer to locally-owned data</span></div>
<div class="line">std::vector&lt;T *&gt; data_others; <span class="comment">// pointers to shared data</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">MPI_Info info;</div>
<div class="line">MPI_Info_create(&amp;info);</div>
<div class="line">MPI_Info_set(info, <span class="stringliteral">&quot;alloc_shared_noncontig&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">MPI_Win_allocate_shared(local_size * <span class="keyword">sizeof</span>(<a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>), <span class="keyword">sizeof</span>(<a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>), info, comm_sm, &amp;data_this, &amp;win);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">data_others.resize(size_sm);</div>
<div class="line"><span class="keywordtype">int</span> disp_unit = 0; <span class="comment">// displacement size - an output parameter we don&#39;t need right now</span></div>
<div class="line">MPI_Aint ssize = 0; <span class="comment">// window size - an output parameter we don&#39;t need right now</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; size_sm; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  MPI_Win_shared_query(win, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, &amp;ssize, &amp;disp_unit, &amp;data_others[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(data_this == data_others[rank_sm], <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Something went wrong!&quot;</span>));</div>
</div><!-- fragment --><p>Once the data is not needed anymore, the window has to be freed, which also frees the locally-owned data:</p>
<div class="fragment"><div class="line">MPI_Win_free(&amp;win);</div>
</div><!-- fragment --><p><a class="anchor" id="MPI30andLinearAlgebradistributedVector"></a></p><h4>MPI-3.0 and <a class="el" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a></h4>
<p>The commands mentioned in the last section are integrated into <a class="el" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a> and are used to allocate shared memory if an optional (second) communicator is provided to the <a class="el" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit()</a>-functions.</p>
<p>For example, a vector can be set up with a partitioner (containing the global communicator) and a sub-communicator (containing the processes on the same compute node): </p><div class="fragment"><div class="line">vec.reinit(<a class="code" href="base_2partitioner__0_8txt.html#a936b2264a337bdb80dd12b8f90f72767">partitioner</a>, comm_sm);</div>
</div><!-- fragment --><p>Locally owned values and ghost values can be processed as usual. However, now users also have read access to the values of the shared-memory neighbors via the function: </p><div class="fragment"><div class="line"><span class="keyword">const</span> std::vector&lt;ArrayView&lt;const Number&gt;&gt; &amp;</div>
<div class="line"><a class="code" href="group__Vectors.html#gad16bd935d90fe664309c52be1615bd4b">LinearAlgebra::distributed::Vector::shared_vector_data</a>() <span class="keyword">const</span>;</div>
</div><!-- fragment --><p><a class="anchor" id="MPI30andMatrixFree"></a></p><h4>MPI-3.0 and <a class="el" href="classMatrixFree.html">MatrixFree</a></h4>
<p>While <a class="el" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a> provides the option to allocate shared memory and to access the values of shared memory of neighboring processes in a coordinated way, it does not actually exploit the benefits of the usage of shared memory itself.</p>
<p>The <a class="el" href="classMatrixFree.html">MatrixFree</a> infrastructure, however, does:</p><ul>
<li>On the one hand, within the matrix-free loops <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>, <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a>, and <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>, only ghost values that need to be updated <em>are</em> updated. Ghost values from shared-memory neighbors can be accessed directly, making buffering, i.e., copying of the values into the ghost region of a vector possibly redundant. To deal with possible race conditions, necessary synchronizations are performed within <a class="el" href="classMatrixFree.html">MatrixFree</a>. In the case that values have to be buffered, values are copied directly from the neighboring shared-memory process, bypassing more expensive MPI operations based on <code>MPI_ISend</code> and <code>MPI_IRecv</code>.</li>
<li>On the other hand, classes like <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> can read directly from the shared memory, so buffering the values is indeed not necessary in certain cases.</li>
</ul>
<p>To be able to use the shared-memory capabilities of <a class="el" href="classMatrixFree.html">MatrixFree</a>, <a class="el" href="classMatrixFree.html">MatrixFree</a> has to be appropriately configured by providing the user-created sub-communicator:</p>
<div class="fragment"><div class="line"><span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">additional_data.communicator_sm = comm_sm;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler, <a class="code" href="vector__tools__constraints_8templates__0_8txt.html#a08f744320bb886a9b7b7ed04148b7ce7">constraint</a>, <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>, additional_data);</div>
</div><!-- fragment --><p><a class="anchor" id="Cellcentricloops"></a></p><h3>Cell-centric loops</h3>
<p><a class="anchor" id="MotivationFCLvsCCL"></a></p><h4>Motivation: FCL vs. CCL</h4>
<p>"Face-centric loops" (short FCL) visit cells and faces (inner and boundary ones) in separate loops. As a consequence, each entity is visited only once and fluxes between cells are evaluated only once. How to perform face-centric loops with the help of <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a> by providing three functions (one for the cell integrals, one for the inner, and one for the boundary faces) has been presented in <a class="el" href="step_59.html">step-59</a> and <a class="el" href="step_67.html">step-67</a>.</p>
<p>"Cell-centric loops" (short CCL or ECL (for element-centric loops) in the hyper.deal release paper), in contrast, process a cell and in direct succession process all its faces (i.e., visit all faces twice). Their benefit has become clear for modern CPU processor architecture in the literature <b>[KronbichlerKormann2019]</b>, although this kind of loop implies that fluxes have to be computed twice (for each side of an interior face). CCL has two primary advantages:</p><ul>
<li>On the one hand, entries in the solution vector are written exactly once back to main memory in the case of CCL, while in the case of FCL at least once despite of cache-efficient scheduling of cell and face loops-due to cache capacity misses.</li>
<li>On the other hand, since each entry of the solution vector is accessed exactly once, no synchronization between threads is needed while accessing the solution vector in the case of CCL. This absence of race conditions during writing into the destination vector makes CCL particularly suitable for shared-memory parallelization.</li>
</ul>
<p>One should also note that although fluxes are computed twice in the case of CCL, this does not automatically translate into doubling of the computation, since values already interpolated to the cell quadrature points can be interpolated to a face with a simple 1D interpolation.</p>
<p><a class="anchor" id="CellcentricloopsandMatrixFree"></a></p><h4>Cell-centric loops and <a class="el" href="classMatrixFree.html">MatrixFree</a></h4>
<p>For cell-centric loop implementations, the function <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a> can be used, to which the user can pass a function that should be performed on each cell.</p>
<p>To derive an appropriate function, which can be passed in <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>, one might, in principle, transform/merge the following three functions, which can be passed to a <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>:</p>
<div class="fragment"><div class="line">matrix_free.template loop&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <span class="comment">// operation performed on cells</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// some operations on the cell quadrature points</span></div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <span class="comment">// operation performed inner faces</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="comment">/*is_interior_face=*/</span><span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="comment">/*is_interior_face=*/</span><span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">        phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_p.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line"> </div>
<div class="line">        phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">        phi_p.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <span class="comment">// operation performed boundary faces</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="comment">/*is_interior_face=*/</span><span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line"> </div>
<div class="line">        phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src);</div>
</div><!-- fragment --><p>in the following way:</p>
<div class="fragment"><div class="line">matrix_free.template loop_cell_centric&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a>     phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="comment">/*is_interior_face=*/</span><span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="comment">/*is_interior_face=*/</span><span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// some operations on the cell quadrature points</span></div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// loop over all faces of cell</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = 0; face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_faces_by_cells_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)[0] ==</div>
<div class="line">                <a class="code" href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="comment">// internal face</span></div>
<div class="line">                phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">                phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                phi_p.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line"> </div>
<div class="line">                phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="comment">// boundary face</span></div>
<div class="line">                phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line"> </div>
<div class="line">                phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src);</div>
</div><!-- fragment --><p>It should be noted that <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> is initialized now with two numbers, the cell number and the local face number. The given example only highlights how to transform face-centric loops into cell-centric loops and is by no means efficient, since data is read and written multiple times from and to the global vector as well as computations are performed redundantly. Below, we will discuss advanced techniques that target these issues.</p>
<p>To be able to use <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>, following flags of <a class="el" href="structMatrixFree_1_1AdditionalData.html">MatrixFree::AdditionalData</a> have to be enabled:</p>
<div class="fragment"><div class="line"><span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">additional_data.hold_all_faces_to_owned_cells       = <span class="keyword">true</span>;</div>
<div class="line">additional_data.mapping_update_flags_faces_by_cells =</div>
<div class="line">  additional_data.mapping_update_flags_inner_faces |</div>
<div class="line">  additional_data.mapping_update_flags_boundary_faces;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler, <a class="code" href="vector__tools__constraints_8templates__0_8txt.html#a08f744320bb886a9b7b7ed04148b7ce7">constraint</a>, <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>, additional_data);</div>
</div><!-- fragment --><p>In particular, these flags enable that the internal data structures are set up for all faces of the cells.</p>
<p>Currently, cell-centric loops in deal.II only work for uniformly refined meshes and if no constraints are applied (which is the standard case DG is normally used).</p>
<p><a class="anchor" id="ProvidinglambdastoMatrixFreeloops"></a></p><h3>Providing lambdas to <a class="el" href="classMatrixFree.html">MatrixFree</a> loops</h3>
<p>The examples given above have already used lambdas, which have been provided to matrix-free loops. The following short examples present how to transform functions between a version where a class and a pointer to one of its methods are used and a variant where lambdas are utilized.</p>
<p>In the following code, a class and a pointer to one of its methods, which should be interpreted as cell integral, are passed to <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span></div>
<div class="line">local_apply_cell(<span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;              <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                 VectorType &amp;                                 <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                 <span class="keyword">const</span> VectorType &amp;                           src,</div>
<div class="line">                 <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;<a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// some operations on the quadrature points</span></div>
<div class="line"> </div>
<div class="line">      phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">matrix_free.<a class="code" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">cell_loop</a>(&amp;Operator::local_apply_cell, <span class="keyword">this</span>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, src);</div>
</div><!-- fragment --><p>However, it is also possible to pass an anonymous function via a lambda function with the same result:</p>
<div class="fragment"><div class="line">matrix_free.template cell_loop&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// some operations on the quadrature points</span></div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src);</div>
</div><!-- fragment --><p><a class="anchor" id="VectorizedArrayType"></a></p><h3>VectorizedArrayType</h3>
<p>The class <a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> is a key component to achieve the high node-level performance of the matrix-free algorithms in deal.II. It is a wrapper class around a short vector of \(n\) entries of type Number and maps arithmetic operations to appropriate single-instruction/multiple-data (SIMD) concepts by intrinsic functions. The length of the vector can be queried by <a class="el" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray::size()</a> and its underlying number type by <a class="el" href="classVectorizedArray.html#ad5e3061a2d2cf13c446354059e6fa8ef">VectorizedArray::value_type</a>.</p>
<p>In the default case (<code><a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></code>), the vector length is set at compile time of the library to match the highest value supported by the given processor architecture. However, also a second optional template argument can be specified as <code>VectorizedArray&lt;Number, size&gt;</code>, where <code>size</code> explicitly controls the vector length within the capabilities of a particular instruction set. A full list of supported vector lengths is presented in the following table:</p>
<table align="center" class="doxtable">
<tr>
<th>double </th><th>float </th><th>ISA  </th></tr>
<tr>
<td><code>VectorizedArray&lt;double, 1&gt;</code> </td><td><code>VectorizedArray&lt;float, 1&gt;</code> </td><td>(auto-vectorization)  </td></tr>
<tr>
<td><code>VectorizedArray&lt;double, 2&gt;</code> </td><td><code>VectorizedArray&lt;float, 4&gt;</code> </td><td>SSE2/AltiVec  </td></tr>
<tr>
<td><code>VectorizedArray&lt;double, 4&gt;</code> </td><td><code>VectorizedArray&lt;float, 8&gt;</code> </td><td>AVX/AVX2  </td></tr>
<tr>
<td><code>VectorizedArray&lt;double, 8&gt;</code> </td><td><code>VectorizedArray&lt;float, 16&gt;</code> </td><td>AVX-512  </td></tr>
</table>
<p>This allows users to select the vector length/ISA and, as a consequence, the number of cells to be processed at once in matrix-free operator evaluations, possibly reducing the pressure on the caches, an severe issue for very high degrees (and dimensions).</p>
<p>A possible further reason to reduce the number of filled lanes is to simplify debugging: instead of having to look at, e.g., 8 cells, one can concentrate on a single cell.</p>
<p>The interface of <a class="el" href="classVectorizedArray.html">VectorizedArray</a> also enables the replacement by any type with a matching interface. Specifically, this prepares deal.II for the <code>std::simd</code> class that is planned to become part of the C++23 standard. The following table compares the deal.II-specific SIMD classes and the equivalent C++23 classes:</p>
<table align="center" class="doxtable">
<tr>
<th><a class="el" href="classVectorizedArray.html">VectorizedArray</a> (deal.II) </th><th>std::simd (C++23)  </th></tr>
<tr>
<td><code><a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></code> </td><td><code>std::experimental::native_simd&lt;Number&gt;</code>  </td></tr>
<tr>
<td><code>VectorizedArray&lt;Number, size&gt;</code> </td><td><code>std::experimental::fixed_size_simd&lt;Number, size&gt;</code>  </td></tr>
</table>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Parametersandutilityfunctions"></a> </p><h3>Parameters and utility functions</h3>
<p>The same includes as in <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__accessor_8h.html">deal.II/grid/tria_accessor.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__iterator_8h.html">deal.II/grid/tria_iterator.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
</div><!-- fragment --><p>A new include for categorizing of cells according to their boundary IDs:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2tools_8h.html">deal.II/matrix_free/tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p>The same input parameters as in <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 1;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceStep37.html#a92034819b3a2b370b456b2e415e24f55">dimension</a>            = 2;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 2;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>            = 5;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 2;</div>
</div><!-- fragment --><p>This parameter specifies the size of the shared-memory group. Currently, only the values 1 and <a class="el" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a> is possible, leading to the options that the memory features can be turned off or all processes having access to the same shared-memory domain are grouped together.</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
</div><!-- fragment --><p>Here, the type of the data structure is chosen for vectorization. In the default case, <a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> is used, i.e., the highest instruction-set-architecture extension available on the given hardware with the maximum number of vector lanes is used. However, one might reduce the number of filled lanes, e.g., by writing <code>using VectorizedArrayType = VectorizedArray&lt;Number, 4&gt;</code> to only process 4 cells.</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> = <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>;</div>
</div><!-- fragment --><p>The following parameters have not changed:</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>, 1.5);</div>
</div><!-- fragment --><p>Specify max number of time steps useful for performance studies.</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
</div><!-- fragment --><p>Runge-Kutta-related functions copied from <a class="el" href="step_67.html">step-67</a> and slightly modified with the purpose to minimize global vector access:</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>,</div>
<div class="line">};</div>
<div class="line">constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">          lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">          lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">          lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">          lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line">    <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">                        rk_integrator(lsrk);</div>
<div class="line">    std::vector&lt;double&gt; ci; <span class="comment">// not used</span></div>
<div class="line">    rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">return</span> bi.size();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">  <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                         VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                         VectorType &amp;    vec_ri,</div>
<div class="line">                         VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"> </div>
<div class="line">    vec_ki.swap(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> sum_previous_bi = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 0; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0 ? 0 : sum_previous_bi + ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> - 1];</div>
<div class="line"> </div>
<div class="line">        pde_operator.perform_stage(<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                                   current_time + c_i * time_step,</div>
<div class="line">                                   bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step,</div>
<div class="line">                                   (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size() - 1 ?</div>
<div class="line">                                      0 :</div>
<div class="line">                                      ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step),</div>
<div class="line">                                   (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ki : vec_ri),</div>
<div class="line">                                   (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ri : vec_ki),</div>
<div class="line">                                   <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &gt; 0)</div>
<div class="line">          sum_previous_bi += bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> - 1];</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::vector&lt;double&gt; bi;</div>
<div class="line">  std::vector&lt;double&gt; ai;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Euler-specific utility functions from <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">};</div>
<div class="line">constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> 0:</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">          x0[0] = 5.;</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">            (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> - x0).norm_square() - 2. * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - x0[0]) * t + t * t;</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">            <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">            std::abs(1. - (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * 0.25 * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log * (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1] - x0[1]);</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - t - x0[0]);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                std::exp2(density_log * (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) +</div>
<div class="line">                     0.5 * (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u * u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">case</span> 1:</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">            <span class="keywordflow">return</span> 1.;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">            <span class="keywordflow">return</span> 0.4;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">            <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> 0.;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">        <span class="keywordflow">return</span> 0.;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * inverse_density;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">    euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] - 0.5 * rho_u_dot_u);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">    euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">        <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">  <a class="code" href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">            0.5 * <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                       <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line">                                     velocity_m.norm_square() +</div>
<div class="line">                                       <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> 0.5 * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                 0.5 * <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> * (u_m - u_p);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">            0.5 * ((velocity_m + velocity_p) * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">            0.5 * <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> *</div>
<div class="line">            (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">            <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">            <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal - avg_c);</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos - s_neg);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> inverse_s *</div>
<div class="line">                 ((s_pos * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) - s_neg * (flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)) -</div>
<div class="line">                  s_pos * s_neg * (u_m - u_p));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> {};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>General-purpose utility functions from <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType&gt;</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a></div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized,</div>
<div class="line">                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line"><a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a></div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="EuleroperatorusingacellcentricloopandMPI30sharedmemory"></a> </p><h3>Euler operator using a cell-centric loop and MPI-3.0 shared memory</h3>
<p>Euler operator from <a class="el" href="step_67.html">step-67</a> with some changes as detailed below:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keyword">class </span>EulerOperator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">  EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">  ~EulerOperator();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                           std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  perform_stage(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      cur_time,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">               <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
</div><!-- fragment --><p>Instance of SubCommunicatorWrapper containing the sub-communicator, which we need to pass to <a class="el" href="classMatrixFree.html#adb324d469b296f2a6921b41208732ddf">MatrixFree::reinit()</a> to be able to exploit MPI-3.0 shared-memory capabilities:</p>
<div class="fragment"><div class="line">  MPI_Comm subcommunicator;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">    inflow_boundaries;</div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                 subsonic_outflow_boundaries;</div>
<div class="line">  std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">  std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line">};</div>
</div><!-- fragment --><p>New constructor, which creates a sub-communicator. The user can specify the size of the sub-communicator via the global parameter group_size. If the size is set to -1, all MPI processes of a shared-memory domain are combined to a group. The specified size is decisive for the benefit of the shared-memory capabilities of <a class="el" href="classMatrixFree.html">MatrixFree</a> and, therefore, setting the <code>size</code> to <code>-1</code> is a reasonable choice. By setting, the size to <code>1</code> users explicitly disable the MPI-3.0 shared-memory features of <a class="el" href="classMatrixFree.html">MatrixFree</a> and rely completely on MPI-2.0 features, like <code>MPI_Isend</code> and <code>MPI_Irecv</code>.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">    : timer(timer)</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#if DEAL_II_MPI_VERSION_GTE(3, 0)</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == 1)</div>
<div class="line">      {</div>
<div class="line">        this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">        MPI_Comm_split_type(MPI_COMM_WORLD,</div>
<div class="line">                            MPI_COMM_TYPE_SHARED,</div>
<div class="line">                            <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>,</div>
<div class="line">                            MPI_INFO_NULL,</div>
<div class="line">                            &amp;subcommunicator);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    (void)subcommunicator;</div>
<div class="line">    (void)<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a>;</div>
<div class="line">    this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
</div><!-- fragment --><p>New destructor responsible for freeing of the sub-communicator.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  EulerOperator&lt;dim, degree, n_points_1d&gt;::~EulerOperator()</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_MPI</span></div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;subcommunicator != MPI_COMM_SELF)</div>
<div class="line">      MPI_Comm_free(&amp;subcommunicator);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
</div><!-- fragment --><p>Modified <a class="el" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit()</a> function to setup the internal data structures in <a class="el" href="classMatrixFree.html">MatrixFree</a> in a way that it is usable by the cell-centric loops and the MPI-3.0 shared-memory capabilities are used:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                  <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="structMatrixFree_1_1AdditionalData.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData</a></div>
<div class="line">    additional_data;</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">mapping_update_flags</a> =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">mapping_update_flags_inner_faces</a> =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">mapping_update_flags_boundary_faces</a> =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">tasks_parallel_scheme</a> =</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData::none</a>;</div>
</div><!-- fragment --><p>Categorize cells so that all lanes have the same boundary IDs for each face. This is strictly not necessary, however, allows to write simpler code in EulerOperator::perform_stage() without masking, since it is guaranteed that all cells grouped together (in a <a class="el" href="classVectorizedArray.html">VectorizedArray</a>) have to perform exactly the same operation also on the faces.</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceMatrixFreeTools.html#ae034b98c0db11285fae23a08ef3f197f">MatrixFreeTools::categorize_by_boundary_ids</a>(dof_handler.<a class="code" href="classDoFHandler.html#a7797f796c0be511fbc7f230ccc22532e">get_triangulation</a>(),</div>
<div class="line">                                            additional_data);</div>
</div><!-- fragment --><p>Enable MPI-3.0 shared-memory capabilities within <a class="el" href="classMatrixFree.html">MatrixFree</a> by providing the sub-communicator:</p>
<div class="fragment"><div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#afdca3541da950e50d2e8dca2de4ceb90">communicator_sm</a> = subcommunicator;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">    <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following function does an entire stage of a Runge&ndash;Kutta update and is</p><ul>
<li>alongside the slightly modified setup - the heart of this tutorial compared to <a class="el" href="step_67.html">step-67</a>.</li>
</ul>
<p>In contrast to <a class="el" href="step_67.html">step-67</a>, we are not executing the advection step (using <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>) and the inverse mass-matrix step (using <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a>) in sequence, but evaluate everything in one go inside of <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>. This function expects a single function that is executed on each locally-owned (macro) cell as parameter so that we need to loop over all faces of that cell and perform needed integration steps on our own.</p>
<p>The following function contains to a large extent copies of the following functions from <a class="el" href="step_67.html">step-67</a> so that comments related the evaluation of the weak form are skipped here:</p><ul>
<li><code>EulerDG::EulerOperator::local_apply_cell</code></li>
<li><code>EulerDG::EulerOperator::local_apply_face</code></li>
<li><code>EulerDG::EulerOperator::local_apply_boundary_face</code></li>
<li><code>EulerDG::EulerOperator::local_apply_inverse_mass_matrix</code></li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">    <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">    <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
</div><!-- fragment --><p>Run a cell-centric loop by calling <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a> and providing a lambda containing the effects of the cell, face and boundary-face integrals:</p>
<div class="fragment"><div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.template <a class="code" href="multithreading__0_8txt.html#a265e44213c5331eb7d572a97bbd8cd6c">loop_cell_centric&lt;LinearAlgebra::distributed::Vector&lt;Number&gt;</a>,</div>
<div class="line">                                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> cell_range) {</div>
<div class="line">    <span class="keyword">using</span> FECellIntegral = <a class="code" href="classFEEvaluation.html">FEEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                        <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                        n_points_1d,</div>
<div class="line">                                        <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                        <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line">    <span class="keyword">using</span> FEFaceIntegral = <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                            <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                            n_points_1d,</div>
<div class="line">                                            <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line"> </div>
<div class="line">    FECellIntegral phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    FECellIntegral phi_temp(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    FEFaceIntegral phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line">    FEFaceIntegral phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a>     constant_body_force;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">      constant_body_force =</div>
<div class="line">        evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">          *constant_function, <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">    const ::internal::EvaluatorTensorProduct&lt;</div>
<div class="line">      <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">      <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">      n_points_1d,</div>
<div class="line">      n_points_1d,</div>
<div class="line">      <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">      eval(<a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>(),</div>
<div class="line">           <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info().data[0].shape_gradients_collocation_eo,</div>
<div class="line">           <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a> <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>(phi.static_n_q_points *</div>
<div class="line">                                              phi.n_components);</div>
</div><!-- fragment --><p>Loop over all cell batches:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second;</div>
<div class="line">     ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">  {</div>
<div class="line">    phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">      phi_temp.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
</div><!-- fragment --><p>Read values from global vector and compute the values at the quadrature points:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>() &amp;&amp; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0)</div>
<div class="line">  {</div>
<div class="line">    phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0;</div>
<div class="line">         <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_dofs_per_component * (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2);</div>
<div class="line">         ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      phi_temp.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">    phi.evaluate(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Buffer the computed values at the quadrature points, since these are overridden by FEEvaluation::submit_value() in the next step, however, are needed later on for the face integrals:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_n_q_points * (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
</div><!-- fragment --><p>Apply the cell integral at the cell quadrature points. See also the function <code>EulerOperator::local_apply_cell()</code> from <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">    phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">    <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> force =</div>
<div class="line">          constant_function ?</div>
<div class="line">            constant_body_force :</div>
<div class="line">            evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">              *body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> forcing;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">        phi.submit_value(forcing, q);</div>
<div class="line">      }</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Test with the gradient of the test functions in the quadrature points. We skip the interpolation back to the support points of the element, since we first collect all contributions in the cell quadrature points and only perform the interpolation back as the final step.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keyword">auto</span> *values_ptr   = phi.begin_values();</div>
<div class="line">  <span class="keyword">auto</span> *gradient_ptr = phi.begin_gradients();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1 &amp;&amp; body_force.get() == <span class="keyword">nullptr</span>)</div>
<div class="line">        eval.template gradients&lt;0, false, false&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points * 0, values_ptr);</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1)</div>
<div class="line">        eval.template gradients&lt;0, false, true&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points * 0, values_ptr);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 2)</div>
<div class="line">        eval.template gradients&lt;1, false, true&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points * 1, values_ptr);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 3)</div>
<div class="line">        eval.template gradients&lt;2, false, true&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points * 2, values_ptr);</div>
<div class="line"> </div>
<div class="line">      values_ptr += phi.static_n_q_points;</div>
<div class="line">      gradient_ptr += phi.static_n_q_points * <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Loop over all faces of the current cell:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = 0;</div>
<div class="line">     face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell;</div>
<div class="line">     ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">  {</div>
</div><!-- fragment --><p>Determine the boundary ID of the current face. Since we have set up <a class="el" href="classMatrixFree.html">MatrixFree</a> in a way that all filled lanes have guaranteed the same boundary ID, we can select the boundary ID of the first lane.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> boundary_ids =</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_faces_by_cells_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__bdm__0_8txt.html#a29a2868f8e5db6bbcae785d183329b77">std::equal</a>(boundary_ids.begin(),</div>
<div class="line">                  boundary_ids.begin() +</div>
<div class="line">                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>),</div>
<div class="line">                  boundary_ids.begin()),</div>
<div class="line">       <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Boundary IDs of lanes differ.&quot;</span>));</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = boundary_ids[0];</div>
<div class="line"> </div>
<div class="line">phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
</div><!-- fragment --><p>Interpolate the values from the cell quadrature points to the quadrature points of the current face via a simple 1D interpolation:</p>
<div class="fragment"><div class="line"><a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                     n_points_1d - 1,</div>
<div class="line">                                     <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">  template interpolate_quadrature&lt;true, false&gt;(</div>
<div class="line">    <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">    <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>.data(),</div>
<div class="line">    phi_m.begin_values(),</div>
<div class="line">    <span class="keyword">false</span>,</div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
</div><!-- fragment --><p>Check if the face is an internal or a boundary face and select a different code path based on this information:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> == <a class="code" href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a>)</div>
<div class="line">  {</div>
</div><!-- fragment --><p>Process and internal face. The following lines of code are a copy of the function <code>EulerDG::EulerOperator::local_apply_face</code> from <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line">    phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">    phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">          euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                    phi_p.get_value(q),</div>
<div class="line">                                    phi_m.get_normal_vector(q));</div>
<div class="line">        phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  {</div>
</div><!-- fragment --><p>Process a boundary face. These following lines of code are a copy of the function <code>EulerDG::EulerOperator::local_apply_boundary_face</code> from <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi_m.get_value(q);</div>
<div class="line">      <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi_m.get_normal_vector(q);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> w_p;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">          wall_boundaries.end())</div>
<div class="line">        {</div>
<div class="line">          w_p[0] = w_m[0];</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] =</div>
<div class="line">              w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] - 2. * rho_u_dot_n * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">          w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">               inflow_boundaries.end())</div>
<div class="line">        w_p = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">          *inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">          phi_m.quadrature_point(q));</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(</div>
<div class="line">                 <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">               subsonic_outflow_boundaries.end())</div>
<div class="line">        {</div>
<div class="line">          w_p = w_m;</div>
<div class="line">          w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*subsonic_outflow_boundaries</div>
<div class="line">                                 .find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">                                 -&gt;<a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a>,</div>
<div class="line">                              phi_m.quadrature_point(q),</div>
<div class="line">                              <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">          at_outflow = <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">                      <span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                      <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0;</div>
<div class="line">             <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt; -1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">      phi_m.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Evaluate local integrals related to cell by quadrature and add into cell contribution via a simple 1D interpolation:</p>
<div class="fragment"><div class="line">  <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                       n_points_1d - 1,</div>
<div class="line">                                       <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">    template interpolate_quadrature&lt;false, true&gt;(</div>
<div class="line">      <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">      phi_m.begin_values(),</div>
<div class="line">      phi.begin_values(),</div>
<div class="line">      <span class="keyword">false</span>,</div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Apply inverse mass matrix in the cell quadrature points. See also the function <code>EulerDG::EulerOperator::local_apply_inverse_mass_matrix()</code> from <a class="el" href="step_67.html">step-67</a>:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_n_q_points; ++q)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> = <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>(1.0) / phi.JxW(q);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">      phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> * phi.static_n_q_points + q] =</div>
<div class="line">        phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> * phi.static_n_q_points + q] * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Transform values from collocation space to the original Gauss-Lobatto space:</p>
<div class="fragment"><div class="line"><a class="code" href="structinternal_1_1FEEvaluationImplBasisChange.html">internal::FEEvaluationImplBasisChange</a>&lt;</div>
<div class="line">  <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">  <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa13fcf221bed4879f9b319347525f703b">internal::EvaluatorQuantity::hessian</a>,</div>
<div class="line">  <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">  <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> + 1,</div>
<div class="line">  n_points_1d,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::do_backward(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info()</div>
<div class="line">                                      .data[0]</div>
<div class="line">                                      .inverse_shape_values_eo,</div>
<div class="line">                                    <span class="keyword">false</span>,</div>
<div class="line">                                    phi.begin_values(),</div>
<div class="line">                                    phi.begin_dof_values());</div>
</div><!-- fragment --><p>Perform Runge-Kutta update and write results back to global vectors:</p>
<div class="fragment"><div class="line">          <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">            {</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                phi.begin_dof_values()[q] = bi * phi.begin_dof_values()[q];</div>
<div class="line">              phi.distribute_local_to_global(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">              <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> != 0)</div>
<div class="line">                phi_temp.read_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keyword">const</span> <span class="keyword">auto</span> K_i = phi.begin_dof_values()[q];</div>
<div class="line"> </div>
<div class="line">                  phi.begin_dof_values()[q] =</div>
<div class="line">                    phi_temp.begin_dof_values()[q] + (ai * K_i);</div>
<div class="line"> </div>
<div class="line">                  phi_temp.begin_dof_values()[q] += bi * K_i;</div>
<div class="line">                }</div>
<div class="line">              phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">              phi_temp.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    vec_ki,</div>
<div class="line">    current_ri,</div>
<div class="line">    <span class="keyword">true</span>,</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>From here, the code of <a class="el" href="step_67.html">step-67</a> has not changed.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">    this-&gt;body_force = std::move(body_force);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                   <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                                   <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                   <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                                   <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                                 phi.quadrature_point(q)),</div>
<div class="line">                               q);</div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                 phi.begin_dof_values(),</div>
<div class="line">                                                 phi.begin_dof_values());</div>
<div class="line">        phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_errors_squared[3] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line">              phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line"> </div>
<div class="line">            local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_max = 0.;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>          inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>          convective_speed = inverse_jacobian * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> convective_limit = 0.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              convective_limit =</div>
<div class="line">                <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">              <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> * (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(inverse_jacobian) *</div>
<div class="line">                              (inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">                <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> eigenvector_norm = 0.;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  eigenvector_norm =</div>
<div class="line">                    <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">              }</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">              (jac_times_ev * jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">            local_max =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                       max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> max_transport;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    EulerProblem();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">    <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">             <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">            inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] * inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">      interpretation;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> interpretation;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::EulerProblem()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = -5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">            upper_right[0] = 10;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                           lower_left,</div>
<div class="line">                                           upper_right);</div>
<div class="line">            <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">              <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">            euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">              1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_wall_boundary(2);</div>
<div class="line">            euler_operator.set_wall_boundary(3);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">              euler_operator.set_body_force(</div>
<div class="line">                std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                  std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line"> </div>
<div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">    euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().getloc();</div>
<div class="line">    pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">    pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">      euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">      <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">      {</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">      }</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">            interpretation;</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            interpretation.push_back(</div>
<div class="line">              <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">          data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                   <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                   <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                   interpretation);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">      mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                             <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                             <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> std::string filename =</div>
<div class="line">        <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) * n_vect_number;</div>
<div class="line"> </div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">    rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">        min_vertex_distance =</div>
<div class="line">          <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">    min_vertex_distance =</div>
<div class="line">      <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">                euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">          &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    output_results(0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12 &amp;&amp; timestep_number &lt; <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a>)</div>
<div class="line">      {</div>
<div class="line">        ++timestep_number;</div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">          time_step =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">            <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">          integrator.perform_time_step(euler_operator,</div>
<div class="line">                                       <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                       time_step,</div>
<div class="line">                                       <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                       rk_register_1,</div>
<div class="line">                                       rk_register_2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> - time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">          output_results(</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    timer.<a class="code" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">print_wall_time_statistics</a>(MPI_COMM_WORLD);</div>
<div class="line">    pcout &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace Euler_DG</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>Running the program with the default settings on a machine with 40 processes produces the following output:</p>
<div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 27.648.000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 25.600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 0.000295952, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.0075, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00441179</div>
<div class="line">Time:       0, dt:   0.0003, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:  5.385<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, rho * u:  1.916<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, energy: 1.547<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-15</div>
<div class="line">+--------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed         |     17.52<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    10 |     17.52<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     17.52<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    11 |</div>
<div class="line">|                                      |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                  | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+--------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>           |         1 |  0.009594s    16 |  0.009705s |  0.009819s     8 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed  |        22 |    0.1366s     0 |    0.1367s |    0.1368s    18 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                   |         1 |     1.233s     0 |     1.233s |     1.233s    32 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total   |       100 |     8.746s    35 |     8.746s |     8.746s     0 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h |       500 |     8.742s    36 |     8.742s |     8.743s     2 |</div>
<div class="line">+--------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>and the following visual output:</p>
<table align="center" class="doxtable" style="width:85%">
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_010.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_025.png" alt="" width="100%" class="inline"/>   </td></tr>
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_050.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_100.png" alt="" width="100%" class="inline"/>   </td></tr>
</table>
<p>As a reference, the results of <a class="el" href="step_67.html">step-67</a> using FCL are:</p>
<div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 27.648.000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 25.600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 0.000295952, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.0075, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00441179</div>
<div class="line">Time:       0, dt:   0.0003, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:  5.385<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, rho * u:  1.916<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, energy: 1.547<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-15</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     13.33<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |     13.34<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     13.35<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |         1 |  0.007977s    10 |  0.008053s |  0.008161s    30 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |        22 |    0.1228s    34 |    0.2227s |    0.3845s     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |         1 |     1.255s     3 |     1.257s |     1.259s    27 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |       100 |     11.15s     0 |     11.32s |     11.42s    34 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |       500 |     8.719s    10 |     8.932s |     9.196s     0 |</div>
<div class="line">| rk_stage - inv mass + vec upd |       500 |     1.944s     0 |     2.377s |      2.55s    10 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>By the modifications shown in this tutorial, we were able to achieve a speedup of 27% for the Runge-Kutta stages.</p>
<p><a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>The algorithms are easily extendable to higher dimensions: a high-dimensional <a href="https://github.com/hyperdeal/hyperdeal/blob/a9e67b4e625ff1dde2fed93ad91cdfacfaa3acdf/include/hyper.deal/operators/advection/advection_operation.h#L219-L569">advection operator based on cell-centric loops</a> is part of the hyper.deal library. An extension of cell-centric loops to locally-refined meshes is more involved.</p>
<p><a class="anchor" id="ExtensiontothecompressibleNavierStokesequations"></a></p><h4>Extension to the compressible Navier-Stokes equations</h4>
<p>The solver presented in this tutorial program can also be extended to the compressible Navier–Stokes equations by adding viscous terms, as also suggested in <a class="el" href="step_67.html">step-67</a>. To keep as much of the performance obtained here despite the additional cost of elliptic terms, e.g. via an interior penalty method, that tutorial has proposed to switch the basis from <a class="el" href="classFE__DGQ.html">FE_DGQ</a> to <a class="el" href="classFE__DGQHermite.html">FE_DGQHermite</a> like in the <a class="el" href="step_59.html">step-59</a> tutorial program. The reasoning behind this switch is that in the case of <a class="el" href="classFE__DGQ.html">FE_DGQ</a> all values of neighboring cells (i.e., \(k+1\) layers) are needed, whilst in the case of <a class="el" href="classFE__DGQHermite.html">FE_DGQHermite</a> only 2 layers, making the latter significantly more suitable for higher degrees. The additional layers have to be, on the one hand, loaded from main memory during flux computation and, one the other hand, have to be communicated. Using the shared-memory capabilities introduced in this tutorial, the second point can be eliminated on a single compute node or its influence can be reduced in a hybrid context.</p>
<p><a class="anchor" id="BlockGaussSeidellikepreconditioners"></a></p><h4>Block Gauss-Seidel-like preconditioners</h4>
<p>Cell-centric loops could be used to create block Gauss-Seidel preconditioners that are multiplicative within one process and additive over processes. These type of preconditioners use during flux computation, in contrast to Jacobi-type preconditioners, already updated values from neighboring cells. The following pseudo-code visualizes how this could in principal be achieved:</p>
<div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;Number&gt;</a> visit_flags(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches () + <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_ghost_cell_batches ());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.template loop_cell_centric&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> cell_range) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="comment">// cell integral as usual (not shown)</span></div>
<div class="line"> </div>
<div class="line">        for (unsigned int face = 0; face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++face)</div>
<div class="line">          {</div>
<div class="line">            const auto boundary_id = data.get_faces_by_cells_boundary_id(cell, face)[0];</div>
<div class="line"> </div>
<div class="line">            if (boundary_id == numbers::internal_face_boundary_id)</div>
<div class="line">              {</div>
<div class="line">                phi_p.reinit(cell, face);</div>
<div class="line"> </div>
<div class="line">                const auto flags = phi_p.read_cell_data(visit_flags);</div>
<div class="line">                const auto all_neighbors_have_been_updated =</div>
<div class="line">                  std::min(flags.begin(),</div>
<div class="line">                           flags().begin() + data.n_active_entries_per_cell_batch(cell) == 1;</div>
<div class="line"> </div>
<div class="line">                if(all_neighbors_have_been_updated)</div>
<div class="line">                  phi_p.gather_evaluate(dst, EvaluationFlags::values);</div>
<div class="line">                else</div>
<div class="line">                  phi_p.gather_evaluate(src, EvaluationFlags::values);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// continue as usual (not shown)</span></div>
<div class="line">              }</div>
<div class="line">            else</div>
<div class="line">              {</div>
<div class="line">                <span class="comment">// boundary integral as usual (not shown)</span></div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// continue as above and apply your favorite algorithm to invert</span></div>
<div class="line">        <span class="comment">// the cell-local operator (not shown)</span></div>
<div class="line"> </div>
<div class="line">        <span class="comment">// make cells as updated</span></div>
<div class="line">        phi.set_cell_data(visit_flags, <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>(1.0));</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src,</div>
<div class="line">  <span class="keyword">true</span>,</div>
<div class="line">  <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::DataAccessOnFaces::values</a>);</div>
</div><!-- fragment --><p>For this purpose, one can exploit the cell-data vector capabilities of <a class="el" href="classMatrixFree.html">MatrixFree</a> and the range-based iteration capabilities of <a class="el" href="classVectorizedArray.html">VectorizedArray</a>.</p>
<p>Please note that in the given example we process <code>VectorizedArrayType::size()</code> number of blocks, since each lane corresponds to one block. We consider blocks as updated if all blocks processed by a vector register have been updated. In the case of Cartesian meshes this is a reasonable approach, however, for general unstructured meshes this conservative approach might lead to a decrease in the efficiency of the preconditioner. A reduction of cells processed in parallel by explicitly reducing the number of lanes used by <code>VectorizedArrayType</code> might increase the quality of the preconditioner, but with the cost that each iteration might be more expensive. This dilemma leads us to a further "possibility for extension": vectorization within an element.</p>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2020 - 2021 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Martin Kronbichler, Peter Munch, David Schneider, 2020</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__accessor_8h.html">deal.II/grid/tria_accessor.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__iterator_8h.html">deal.II/grid/tria_iterator.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2tools_8h.html">deal.II/matrix_free/tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 1;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#adc634dce0c07c9dbb94d367c8d97afd3">dimension</a>            = 2;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 2;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>            = 5;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a> + 2;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> = <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>, 1.5);</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>,</div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">        }</div>
<div class="line">      <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">        <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">                          rk_integrator(lsrk);</div>
<div class="line">      std::vector&lt;double&gt; ci; <span class="comment">// not used</span></div>
<div class="line">      rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <span class="keywordflow">return</span> bi.size();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">    <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                           VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                           VectorType &amp;    vec_ri,</div>
<div class="line">                           VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"> </div>
<div class="line">      vec_ki.swap(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> sum_previous_bi = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 0; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0 ? 0 : sum_previous_bi + ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> - 1];</div>
<div class="line"> </div>
<div class="line">          pde_operator.perform_stage(<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                                     current_time + c_i * time_step,</div>
<div class="line">                                     bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step,</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size() - 1 ?</div>
<div class="line">                                        0 :</div>
<div class="line">                                        ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step),</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ki : vec_ri),</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ri : vec_ki),</div>
<div class="line">                                     <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &gt; 0)</div>
<div class="line">            sum_previous_bi += bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> - 1];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    std::vector&lt;double&gt; bi;</div>
<div class="line">    std::vector&lt;double&gt; ai;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">      : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    {}</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="classEuler__DG_1_1ExactSolution.html#a16ae78e70f688acd015b407649997f1b">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">            x0[0] = 5.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">              (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> - x0).norm_square() - 2. * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - x0[0]) * t + t * t;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">              <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">              std::abs(1. - (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * 0.25 * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log * (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1] - x0[1]);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - t - x0[0]);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                  std::exp2(density_log * (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) +</div>
<div class="line">                       0.5 * (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u * u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> 1.;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> 0.4;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">              <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              <span class="keywordflow">return</span> 0.;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> 0.;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * inverse_density;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] - 0.5 * rho_u_dot_u);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">          <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">          <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aec42034f53f838aafe42fb93b273eb92">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">              0.5 * <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line">                                       velocity_m.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 0.5 * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                   0.5 * lambda * (u_m - u_p);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">              0.5 * ((velocity_m + velocity_p) * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">              0.5 * <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> *</div>
<div class="line">              (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal - avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos - s_neg);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> inverse_s *</div>
<div class="line">                   ((s_pos * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) - s_neg * (flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)) -</div>
<div class="line">                    s_pos * s_neg * (u_m - u_p));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keywordflow">return</span> {};</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerOperator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">    EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">    ~EulerOperator();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                             std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">      std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    perform_stage(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      cur_time,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">                 <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    MPI_Comm subcommunicator;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">      inflow_boundaries;</div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                   subsonic_outflow_boundaries;</div>
<div class="line">    std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">    std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerOperator.html#aae07d964990108d9f0b51995835e4a10">EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator</a>(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">    : timer(timer)</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#if DEAL_II_MPI_VERSION_GTE(3, 0)</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == 1)</div>
<div class="line">      {</div>
<div class="line">        this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">        MPI_Comm_split_type(MPI_COMM_WORLD,</div>
<div class="line">                            MPI_COMM_TYPE_SHARED,</div>
<div class="line">                            <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>,</div>
<div class="line">                            MPI_INFO_NULL,</div>
<div class="line">                            &amp;subcommunicator);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    (void)subcommunicator;</div>
<div class="line">    (void)<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a>;</div>
<div class="line">    this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  EulerOperator&lt;dim, degree, n_points_1d&gt;::~EulerOperator()</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_MPI</span></div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;subcommunicator != MPI_COMM_SELF)</div>
<div class="line">      MPI_Comm_free(&amp;subcommunicator);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                    <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="structMatrixFree_1_1AdditionalData.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData</a></div>
<div class="line">      additional_data;</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">mapping_update_flags</a> =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">mapping_update_flags_inner_faces</a> =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">mapping_update_flags_boundary_faces</a> =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">tasks_parallel_scheme</a> =</div>
<div class="line">      <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData::none</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceMatrixFreeTools.html#ae034b98c0db11285fae23a08ef3f197f">MatrixFreeTools::categorize_by_boundary_ids</a>(dof_handler.<a class="code" href="classDoFHandler.html#a7797f796c0be511fbc7f230ccc22532e">get_triangulation</a>(),</div>
<div class="line">                                                additional_data);</div>
<div class="line"> </div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#afdca3541da950e50d2e8dca2de4ceb90">communicator_sm</a> = subcommunicator;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.template <a class="code" href="multithreading__0_8txt.html#a265e44213c5331eb7d572a97bbd8cd6c">loop_cell_centric&lt;LinearAlgebra::distributed::Vector&lt;Number&gt;</a>,</div>
<div class="line">                                    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;(</div>
<div class="line">      [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> cell_range) {</div>
<div class="line">        <span class="keyword">using</span> FECellIntegral = <a class="code" href="classFEEvaluation.html">FEEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                            <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                            n_points_1d,</div>
<div class="line">                                            <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line">        <span class="keyword">using</span> FEFaceIntegral = <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                                n_points_1d,</div>
<div class="line">                                                <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                                <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line"> </div>
<div class="line">        FECellIntegral phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">        FECellIntegral phi_temp(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">        FEFaceIntegral phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line">        FEFaceIntegral phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a>     constant_body_force;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line">          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">          constant_body_force =</div>
<div class="line">            evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">              *constant_function, <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">        const ::internal::EvaluatorTensorProduct&lt;</div>
<div class="line">          <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">          <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">          n_points_1d,</div>
<div class="line">          n_points_1d,</div>
<div class="line">          <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">          eval(<a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>(),</div>
<div class="line">               <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info().data[0].shape_gradients_collocation_eo,</div>
<div class="line">               <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a> <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>(phi.static_n_q_points *</div>
<div class="line">                                                  phi.n_components);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second;</div>
<div class="line">             ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">          {</div>
<div class="line">            phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">              phi_temp.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>() &amp;&amp; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0)</div>
<div class="line">              {</div>
<div class="line">                phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0;</div>
<div class="line">                     <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_dofs_per_component * (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2);</div>
<div class="line">                     ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                  phi_temp.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">                phi.evaluate(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_n_q_points * (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">                phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">                <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">                  {</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> force =</div>
<div class="line">                      constant_function ?</div>
<div class="line">                        constant_body_force :</div>
<div class="line">                        evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">                          *body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">                    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> forcing;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">                    phi.submit_value(forcing, q);</div>
<div class="line">                  }</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">auto</span> *values_ptr   = phi.begin_values();</div>
<div class="line">              <span class="keyword">auto</span> *gradient_ptr = phi.begin_gradients();</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1 &amp;&amp; body_force.get() == <span class="keyword">nullptr</span>)</div>
<div class="line">                    eval.template gradients&lt;0, false, false&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 0, values_ptr);</div>
<div class="line">                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1)</div>
<div class="line">                    eval.template gradients&lt;0, false, true&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 0, values_ptr);</div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 2)</div>
<div class="line">                    eval.template gradients&lt;1, false, true&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 1, values_ptr);</div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 3)</div>
<div class="line">                    eval.template gradients&lt;2, false, true&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 2, values_ptr);</div>
<div class="line"> </div>
<div class="line">                  values_ptr += phi.static_n_q_points;</div>
<div class="line">                  gradient_ptr += phi.static_n_q_points * <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = 0;</div>
<div class="line">                 face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell;</div>
<div class="line">                 ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> boundary_ids =</div>
<div class="line">                  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_faces_by_cells_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__bdm__0_8txt.html#a29a2868f8e5db6bbcae785d183329b77">std::equal</a>(boundary_ids.begin(),</div>
<div class="line">                                  boundary_ids.begin() +</div>
<div class="line">                                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>),</div>
<div class="line">                                  boundary_ids.begin()),</div>
<div class="line">                       <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Boundary IDs of lanes differ.&quot;</span>));</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = boundary_ids[0];</div>
<div class="line"> </div>
<div class="line">                phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                     n_points_1d - 1,</div>
<div class="line">                                                     <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">                  template interpolate_quadrature&lt;true, false&gt;(</div>
<div class="line">                    <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">                    <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>.data(),</div>
<div class="line">                    phi_m.begin_values(),</div>
<div class="line">                    <span class="keyword">false</span>,</div>
<div class="line">                    <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> == <a class="code" href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a>)</div>
<div class="line">                  {</div>
<div class="line">                    phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                    phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">                      {</div>
<div class="line">                        <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">                          euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                                    phi_p.get_value(q),</div>
<div class="line">                                                    phi_m.get_normal_vector(q));</div>
<div class="line">                        phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">                      }</div>
<div class="line">                  }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                  {</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">                      {</div>
<div class="line">                        <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi_m.get_value(q);</div>
<div class="line">                        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi_m.get_normal_vector(q);</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                          rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> w_p;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                            wall_boundaries.end())</div>
<div class="line">                          {</div>
<div class="line">                            w_p[0] = w_m[0];</div>
<div class="line">                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                              w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] =</div>
<div class="line">                                w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] - 2. * rho_u_dot_n * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                            w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">                          }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                                 inflow_boundaries.end())</div>
<div class="line">                          w_p = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                            *inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                            phi_m.quadrature_point(q));</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(</div>
<div class="line">                                   <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                                 subsonic_outflow_boundaries.end())</div>
<div class="line">                          {</div>
<div class="line">                            w_p = w_m;</div>
<div class="line">                            w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] =</div>
<div class="line">                              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*subsonic_outflow_boundaries</div>
<div class="line">                                                   .find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">                                                   -&gt;<a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a>,</div>
<div class="line">                                                phi_m.quadrature_point(q),</div>
<div class="line">                                                <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">                            at_outflow = <span class="keyword">true</span>;</div>
<div class="line">                          }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                                      <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">                                        <span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                        <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                        <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0;</div>
<div class="line">                               <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">                               ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">                            {</div>
<div class="line">                              <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt; -1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                                  <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">                            }</div>
<div class="line"> </div>
<div class="line">                        phi_m.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">                      }</div>
<div class="line">                  }</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                     n_points_1d - 1,</div>
<div class="line">                                                     <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">                  template interpolate_quadrature&lt;false, true&gt;(</div>
<div class="line">                    <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">                    phi_m.begin_values(),</div>
<div class="line">                    phi.begin_values(),</div>
<div class="line">                    <span class="keyword">false</span>,</div>
<div class="line">                    <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_n_q_points; ++q)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> = <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>(1.0) / phi.JxW(q);</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">                  phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> * phi.static_n_q_points + q] =</div>
<div class="line">                    phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> * phi.static_n_q_points + q] * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>;</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="structinternal_1_1FEEvaluationImplBasisChange.html">internal::FEEvaluationImplBasisChange</a>&lt;</div>
<div class="line">              <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">              <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa13fcf221bed4879f9b319347525f703b">internal::EvaluatorQuantity::hessian</a>,</div>
<div class="line">              <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">              <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> + 1,</div>
<div class="line">              n_points_1d,</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>,</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::do_backward(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info()</div>
<div class="line">                                                  .data[0]</div>
<div class="line">                                                  .inverse_shape_values_eo,</div>
<div class="line">                                                <span class="keyword">false</span>,</div>
<div class="line">                                                phi.begin_values(),</div>
<div class="line">                                                phi.begin_dof_values());</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                  phi.begin_dof_values()[q] = bi * phi.begin_dof_values()[q];</div>
<div class="line">                phi.distribute_local_to_global(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> != 0)</div>
<div class="line">                  phi_temp.read_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                  {</div>
<div class="line">                    <span class="keyword">const</span> <span class="keyword">auto</span> K_i = phi.begin_dof_values()[q];</div>
<div class="line"> </div>
<div class="line">                    phi.begin_dof_values()[q] =</div>
<div class="line">                      phi_temp.begin_dof_values()[q] + (ai * K_i);</div>
<div class="line"> </div>
<div class="line">                    phi_temp.begin_dof_values()[q] += bi * K_i;</div>
<div class="line">                  }</div>
<div class="line">                phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">                phi_temp.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">      },</div>
<div class="line">      vec_ki,</div>
<div class="line">      current_ri,</div>
<div class="line">      <span class="keyword">true</span>,</div>
<div class="line">      <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">    this-&gt;body_force = std::move(body_force);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                   <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                                   <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                   <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                                   <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                                 phi.quadrature_point(q)),</div>
<div class="line">                               q);</div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                 phi.begin_dof_values(),</div>
<div class="line">                                                 phi.begin_dof_values());</div>
<div class="line">        phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_errors_squared[3] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line">              phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line"> </div>
<div class="line">            local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_max = 0.;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>          inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>          convective_speed = inverse_jacobian * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> convective_limit = 0.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              convective_limit =</div>
<div class="line">                <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">              <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> * (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="chunk__sparse__matrix__0_8txt.html#ad43ded305d7756c82052fec150fdf5dd">transpose</a>(inverse_jacobian) *</div>
<div class="line">                              (inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">                <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> eigenvector_norm = 0.;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  eigenvector_norm =</div>
<div class="line">                    <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">              }</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">              (jac_times_ev * jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">            local_max =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                       max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> max_transport;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span><a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a></div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor</a>()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">    <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">             <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">            inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] * inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">      interpretation;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> interpretation;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::EulerProblem</a>()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::make_grid_and_dofs</a>()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = -5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">            upper_right[0] = 10;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                           lower_left,</div>
<div class="line">                                           upper_right);</div>
<div class="line">            <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">              <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">            euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">              1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_wall_boundary(2);</div>
<div class="line">            euler_operator.set_wall_boundary(3);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">              euler_operator.set_body_force(</div>
<div class="line">                std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                  std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line"> </div>
<div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">    euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().getloc();</div>
<div class="line">    pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">    pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::output_results</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">      euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">      <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">      {</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">      }</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">            interpretation;</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            interpretation.push_back(</div>
<div class="line">              <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">          data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                   <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                   <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                   interpretation);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">      mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                             <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                             <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> std::string filename =</div>
<div class="line">        <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) * n_vect_number;</div>
<div class="line"> </div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">    rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">        min_vertex_distance =</div>
<div class="line">          <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">    min_vertex_distance =</div>
<div class="line">      <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">                euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">          &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    output_results(0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12 &amp;&amp; timestep_number &lt; <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a>)</div>
<div class="line">      {</div>
<div class="line">        ++timestep_number;</div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">          time_step =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">            <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">          integrator.perform_time_step(euler_operator,</div>
<div class="line">                                       <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                       time_step,</div>
<div class="line">                                       <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                       rk_register_1,</div>
<div class="line">                                       rk_register_2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> - time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">          output_results(</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    timer.<a class="code" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">print_wall_time_statistics</a>(MPI_COMM_WORLD);</div>
<div class="line">    pcout &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace Euler_DG</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><br  />
 This tutorial depends on <a class="el" href="step_67.html">step-67</a> .  
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a><a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#SharedmemoryandhybridparallelizationwithMPI30">Shared-memory and hybrid parallelization with MPI-3.0</a><a href="#SharedmemoryandhybridparallelizationwithMPI30">Shared-memory and hybrid parallelization with MPI-3.0</a>
      <ul>
        <li><a href="#Motivation">Motivation</a><a href="#Motivation">Motivation</a>
        <li><a href="#BasicMPI30commands">Basic MPI-3.0 commands</a><a href="#BasicMPI30commands">Basic MPI-3.0 commands</a>
        <li><a href="#MPI30andLinearAlgebradistributedVector">MPI-3.0 and LinearAlgebra::distributed::Vector</a><a href="#MPI30andLinearAlgebradistributedVector">MPI-3.0 and LinearAlgebra::distributed::Vector</a>
        <li><a href="#MPI30andMatrixFree">MPI-3.0 and MatrixFree</a><a href="#MPI30andMatrixFree">MPI-3.0 and MatrixFree</a>
      </ul>
        <li><a href="#Cellcentricloops">Cell-centric loops</a><a href="#Cellcentricloops">Cell-centric loops</a>
      <ul>
        <li><a href="#MotivationFCLvsCCL">Motivation: FCL vs. CCL</a><a href="#MotivationFCLvsCCL">Motivation: FCL vs. CCL</a>
        <li><a href="#CellcentricloopsandMatrixFree">Cell-centric loops and MatrixFree</a><a href="#CellcentricloopsandMatrixFree">Cell-centric loops and MatrixFree</a>
      </ul>
        <li><a href="#ProvidinglambdastoMatrixFreeloops">Providing lambdas to MatrixFree loops</a><a href="#ProvidinglambdastoMatrixFreeloops">Providing lambdas to MatrixFree loops</a>
        <li><a href="#VectorizedArrayType">VectorizedArrayType</a><a href="#VectorizedArrayType">VectorizedArrayType</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a><a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Parametersandutilityfunctions">Parameters and utility functions</a><a href="#Parametersandutilityfunctions">Parameters and utility functions</a>
        <li><a href="#EuleroperatorusingacellcentricloopandMPI30sharedmemory">Euler operator using a cell-centric loop and MPI-3.0 shared memory</a><a href="#EuleroperatorusingacellcentricloopandMPI30sharedmemory">Euler operator using a cell-centric loop and MPI-3.0 shared memory</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a><a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
      <ul>
        <li><a href="#ExtensiontothecompressibleNavierStokesequations">Extension to the compressible Navier-Stokes equations</a><a href="#ExtensiontothecompressibleNavierStokesequations">Extension to the compressible Navier-Stokes equations</a>
        <li><a href="#BlockGaussSeidellikepreconditioners">Block Gauss-Seidel-like preconditioners</a><a href="#BlockGaussSeidellikepreconditioners">Block Gauss-Seidel-like preconditioners</a>
    </ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a><a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 </p><pre class="fragment">&lt;br&gt;  
</pre><p> <em> This program was contributed by Martin Kronbichler, Peter Munch, and David Schneider. Many of the features shown here have been added to deal.II during and for the development of the deal.II-based, efficient, matrix-free finite-element library for high-dimensional partial differential equations hyper.deal (see <a href="https://github.com/hyperdeal/hyperdeal">https://github.com/hyperdeal/hyperdeal</a>). For more details and for applications of the presented features in slightly different contexts (high-dimensional advection equation and Vlasov-Poisson equations) see the release paper <b>[munch2020hyperdeal]</b>.</em></p>
<p><em>This work was partly supported by the German Research Foundation (DFG) through the project "High-order discontinuous Galerkin for the exa-scale" (ExaDG) within the priority program "Software for Exascale Computing" (SPPEXA) and by the Bavarian government through the project "High-order matrix-free finite
element implementations with hybrid parallelization and improved data locality" within the KONWIHR program. </em> <a class="anchor" id="Intro"></a><a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p>This tutorial program solves the Euler equations of fluid dynamics, using anexplicit time integrator with the matrix-free framework applied to ahigh-order discontinuous Galerkin discretization in space. The numericalapproach used here is identical to that used in <a class="el" href="step_67.html">step-67</a> , however, we utilizedifferent advanced <a class="el" href="classMatrixFree.html">MatrixFree</a> techniques to reach even a higher throughput. The two main features of this tutorial are:</p>
<ul>
<li>the usage of shared-memory features from MPI-3.0 and</li>
<li>the usage of cell-centric loops, which allow to write to the global vector only once and, therefore, are ideal for the usage of shared memory. Further topics we discuss in this tutorial are the usage and benefits of thetemplate argument VectorizedArrayType (instead of simply usingVectorizedArray&lt;Number&gt;) as well as the possibility to pass lambdas toMatrixFree loops. For details on the numerics, we refer to the documentation of <a class="el" href="step_67.html">step-67</a> . Weconcentrate here only on the key differences. <a class="anchor" id="SharedmemoryandhybridparallelizationwithMPI30"></a><h3>Shared-memory and hybrid parallelization with MPI-3.0</h3>
</li>
</ul>
<p><a class="anchor" id="Motivation"></a></p><h4>Motivation</h4>
<p>There exist many shared-memory libraries that are based on threads like TBB,OpenMP, or TaskFlow. Integrating such libraries into existing MPI programsallows one to use shared memory. However, these libraries come with an overheadfor the programmer, since all parallelizable code sections have to be found andtransformed according to the library used, including the difficulty when somethird-party numerical library, like an iterative solver package, only relies onMPI. Considering a purely MPI-parallelized FEM application, one can identify thatthe major time and memory benefit of using shared memory would come fromaccessing the part of the solution vector owned by the processes on the samecompute node without the need to make explicit copies and buffering them.Fur this propose, MPI-3.0 provides shared-memory features based on so-calledwindows, where processes can directly access the data of the neighbors on the sameshared-memory domain. <a class="anchor" id="BasicMPI30commands"></a></p><h4>Basic MPI-3.0 commands</h4>
<p>A few relevant MPI-3.0 commands are worth discussing in detail.A new MPI communicator <code>comm_sm</code> , which consists of processes fromthe communicator <code>comm</code> that have access to the same shared memory,can be created via: </p><div class="fragment"><div class="line">MPI_Comm_split_type(comm, MPI_COMM_TYPE_SHARED, <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>, MPI_INFO_NULL, &amp;comm_sm);</div>
</div><!-- fragment --><p>The following code snippet shows the simplified allocation routines ofshared memory for the value type <code>T</code> and the size <code>local_size</code> , as well as, how to query pointers to the data belongingto processes in the same shared-memory domain: </p><div class="fragment"><div class="line">MPI_Win          win;         <span class="comment">// window</span></div>
<div class="line"><a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>              data_this;   <span class="comment">// pointer to locally-owned data</span></div>
<div class="line">std::vector&lt;T&gt; data_others; <span class="comment">// pointers to shared data</span></div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">MPI_Info info;</div>
<div class="line">MPI_Info_create(&amp;info);</div>
<div class="line">MPI_Info_set(info, <span class="stringliteral">&quot;alloc_shared_noncontig&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>);</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">MPI_Win_allocate_shared(local_size <span class="keyword">sizeof</span>(<a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>), <span class="keyword">sizeof</span>(<a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>), info, comm_sm, &amp;data_this, &amp;win);</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">data_others.resize(size_sm);</div>
<div class="line"><span class="keywordtype">int</span> disp_unit = 0; <span class="comment">// displacement size</span></div>
<div class="line">  </div>
<div class="line">- an <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a> <a class="code" href="coding__conventions__0_8txt.html#a676390618e4d4cade021c4edeac58b65">parameter</a> we don<span class="stringliteral">&#39;t need right now</span></div>
<div class="line"><span class="stringliteral">MPI_Aint ssize = 0; // window size</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">- an output parameter we don&#39;</span>t <a class="code" href="memory__0_8txt.html#a308a0b2a49e2ae17e58937bcfde20e4e">need</a> <a class="code" href="reordering__0_8txt.html#abc892651c0b2805d80c1933e2fb51c1a">right</a> <a class="code" href="fe__abf__0_8txt.html#a16d10237466a81c6b65a05f16fc34644">now</a></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; size_sm; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  MPI_Win_shared_query(win, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, &amp;ssize, &amp;disp_unit, &amp;data_others[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line">  </div>
<div class="line"><a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(data_this == data_others[rank_sm], <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Something went wrong!&quot;</span>));</div>
</div><!-- fragment --><p>Once the data is not needed anymore, the window has to be freed, which alsofrees the locally-owned data: </p><div class="fragment"><div class="line">MPI_Win_free(&amp;win);</div>
</div><!-- fragment --><p><a class="anchor" id="MPI30andLinearAlgebradistributedVector"></a></p><h4>MPI-3.0 and <a class="el" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a></h4>
<p>The commands mentioned in the last section are integrated into <a class="el" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a> and are used to allocate shared memory ifan optional (second) communicator is provided to the <a class="el" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit()</a>-functions. For example, a vector can be set up with a partitioner (containing the globalcommunicator) and a sub-communicator (containing the processes on the samecompute node): </p><div class="fragment"><div class="line">vec.reinit(<a class="code" href="base_2partitioner__0_8txt.html#a936b2264a337bdb80dd12b8f90f72767">partitioner</a>, comm_sm);</div>
</div><!-- fragment --><p>Locally owned values and ghost values can be processed as usual. However, nowusers also have read access to the values of the shared-memory neighbors viathe function: </p><div class="fragment"><div class="line"><span class="keyword">const</span> std::vector&lt;ArrayView&lt;const Number&gt;&gt; &amp;</div>
<div class="line"><a class="code" href="group__Vectors.html#gad16bd935d90fe664309c52be1615bd4b">LinearAlgebra::distributed::Vector::shared_vector_data</a>() <span class="keyword">const</span>;</div>
</div><!-- fragment --><p><a class="anchor" id="MPI30andMatrixFree"></a></p><h4>MPI-3.0 and <a class="el" href="classMatrixFree.html">MatrixFree</a></h4>
<p>While <a class="el" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a> provides the option to allocateshared memory and to access the values of shared memory of neighboring processesin a coordinated way, it does not actually exploit the benefits of theusage of shared memory itself. The <a class="el" href="classMatrixFree.html">MatrixFree</a> infrastructure, however, does:</p>
<ul>
<li>On the one hand, within the matrix-free loops <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>, <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a>, and <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>, only ghost values that need to be updated <em> are </em> updated. Ghost values from shared-memory neighbors can be accessed directly, making buffering, i.e., copying of the values into the ghost region of a vector possibly redundant. To deal with possible race conditions, necessary synchronizations are performed within <a class="el" href="classMatrixFree.html">MatrixFree</a>. In the case that values have to be buffered, values are copied directly from the neighboring shared-memory process, bypassing more expensive MPI operations based on <code>MPI_ISend</code> and <code>MPI_IRecv</code> .</li>
<li>On the other hand, classes like <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> can read directly from the shared memory, so buffering the values is indeed not necessary in certain cases. To be able to use the shared-memory capabilities of <a class="el" href="classMatrixFree.html">MatrixFree</a>, MatrixFreehas to be appropriately configured by providing the user-created sub-communicator: <div class="fragment"><div class="line"><span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">additional_data.communicator_sm = comm_sm;</div>
<div class="line">  </div>
<div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler, <a class="code" href="vector__tools__constraints_8templates__0_8txt.html#a08f744320bb886a9b7b7ed04148b7ce7">constraint</a>, <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>, additional_data);</div>
</div><!-- fragment --></li>
</ul>
<p><a class="anchor" id="Cellcentricloops"></a></p><h3>Cell-centric loops</h3>
<p><a class="anchor" id="MotivationFCLvsCCL"></a></p><h4>Motivation: FCL vs. CCL</h4>
<p>"Face-centric loops" (short FCL) visit cells and faces (inner and boundary ones) inseparate loops. As a consequence, each entity is visited only once and fluxesbetween cells are evaluated only once. How to perform face-centric loopswith the help of <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a> by providing three functions (one forthe cell integrals, one for the inner, and one for the boundary faces) hasbeen presented in <a class="el" href="step_59.html">step-59</a> and <a class="el" href="step_67.html">step-67</a> . "Cell-centric loops" (short CCL or ECL (for element-centric loops)in the hyper.deal release paper), incontrast, process a cell and in direct succession process all itsfaces (i.e., visit all faces twice). Their benefit has become clear formodern CPU processor architecture in the literature <b>[KronbichlerKormann2019]</b> ,although this kind of loop implies that fluxes have to be computed twice (foreach side of an interior face). CCL has two primary advantages:</p>
<ul>
<li>On the one hand, entries in the solution vector are written exactly once back to main memory in the case of CCL, while in the case of FCL at least once despite of cache-efficient scheduling of cell and face loops-due to cache capacity misses.</li>
<li>On the other hand, since each entry of the solution vector is accessed exactly once, no synchronization between threads is needed while accessing the solution vector in the case of CCL. This absence of race conditions during writing into the destination vector makes CCL particularly suitable for shared-memory parallelization. One should also note that although fluxes are computed twice in the case of CCL,this does not automatically translate into doubling of the computation, sincevalues already interpolated to the cell quadrature points can be interpolatedto a face with a simple 1D interpolation. <a class="anchor" id="CellcentricloopsandMatrixFree"></a><h4>Cell-centric loops and <a class="el" href="classMatrixFree.html">MatrixFree</a></h4>
</li>
</ul>
<p>For cell-centric loop implementations, the function <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a> can be used, to which the user can pass a function that should be performed oneach cell. To derive an appropriate function, which can be passed in <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>, one might, in principle, transform/merge the following three functions, which canbe passed to a <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>: <br  />
 </p><div class="fragment"><div class="line">matrix_free.template loop&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <span class="comment">// operation performed on cells</span></div>
<div class="line">  </div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// some operations on the cell quadrature points</span></div>
<div class="line">  </div>
<div class="line">        phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <span class="comment">// operation performed inner faces</span></div>
<div class="line">  </div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,  <span class="comment">/*is_interior_face=*/</span> <span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,  <span class="comment">/*is_interior_face=*/</span> <span class="keyword">false</span>);</div>
<div class="line">  </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">        phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_p.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line">  </div>
<div class="line">        phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">        phi_p.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <span class="comment">// operation performed boundary faces</span></div>
<div class="line">  </div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,  <span class="comment">/*is_interior_face=*/</span> <span class="keyword">true</span>);</div>
<div class="line">  </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line">  </div>
<div class="line">        phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src);</div>
</div><!-- fragment --><p>in the following way: </p><div class="fragment"><div class="line">matrix_free.template loop_cell_centric&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a>     phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,  <span class="comment">/*is_interior_face=*/</span> <span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,  <span class="comment">/*is_interior_face=*/</span> <span class="keyword">false</span>);</div>
<div class="line">  </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// some operations on the cell quadrature points</span></div>
<div class="line">  </div>
<div class="line">        phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// loop over all faces of cell</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = 0; face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_faces_by_cells_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)[0] ==</div>
<div class="line">                <a class="code" href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="comment">// internal face</span></div>
<div class="line">                phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">                phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                phi_p.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">                <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line">  </div>
<div class="line">                phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="comment">// boundary face</span></div>
<div class="line">                phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                phi_m.gather_evaluate(src, face_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">                <span class="comment">// some operations on the face quadrature points</span></div>
<div class="line">  </div>
<div class="line">                phi_m.integrate_scatter(face_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src);</div>
</div><!-- fragment --><p>It should be noted that <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> is initialized now with two numbers,the cell number and the local face number. The given example onlyhighlights how to transform face-centric loops into cell-centric loops andis by no means efficient, since data is read and written multiple timesfrom and to the global vector as well as computations are performedredundantly. Below, we will discuss advanced techniques that target these issues. To be able to use <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>, following flags of <a class="el" href="structMatrixFree_1_1AdditionalData.html">MatrixFree::AdditionalData</a> have to be enabled: </p><div class="fragment"><div class="line"><span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">additional_data.hold_all_faces_to_owned_cells       = <span class="keyword">true</span>;</div>
<div class="line">additional_data.mapping_update_flags_faces_by_cells =</div>
<div class="line">  additional_data.mapping_update_flags_inner_faces |</div>
<div class="line">  additional_data.mapping_update_flags_boundary_faces;</div>
<div class="line">  </div>
<div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler, <a class="code" href="vector__tools__constraints_8templates__0_8txt.html#a08f744320bb886a9b7b7ed04148b7ce7">constraint</a>, <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>, additional_data);</div>
</div><!-- fragment --><p>In particular, these flags enable that the internal data structures are set upfor all faces of the cells. Currently, cell-centric loops in deal.II only work for uniformly refined meshesand if no constraints are applied (which is the standard case DG is normallyused).</p>
<p><a class="anchor" id="ProvidinglambdastoMatrixFreeloops"></a></p><h3>Providing lambdas to <a class="el" href="classMatrixFree.html">MatrixFree</a> loops</h3>
<p>The examples given above have already used lambdas, which have been provided tomatrix-free loops. The following short examples present how to transform functions betweena version where a class and a pointer to one of its methods are used and avariant where lambdas are utilized. In the following code, a class and a pointer to one of its methods, which shouldbe interpreted as cell integral, are passed to <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>: <br  />
 </p><div class="fragment"><div class="line"><span class="keywordtype">void</span></div>
<div class="line">local_apply_cell(<span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;              <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                 VectorType &amp;                                 <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                 <span class="keyword">const</span> VectorType &amp;                           src,</div>
<div class="line">                 <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;<a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">      <span class="comment">// some operations on the quadrature points</span></div>
<div class="line">  </div>
<div class="line">      phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><div class="fragment"><div class="line">matrix_free.<a class="code" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">cell_loop</a>(&amp;Operator::local_apply_cell, <span class="keyword">this</span>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, src);</div>
</div><!-- fragment --><p>However, it is also possible to pass an anonymous function via a lambda functionwith the same result: </p><div class="fragment"><div class="line">matrix_free.template cell_loop&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>) {</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, 1, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, cell_evaluation_flags);</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// some operations on the quadrature points</span></div>
<div class="line">  </div>
<div class="line">        phi.integrate_scatter(cell_evaluation_flags, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src);</div>
</div><!-- fragment --><p><a class="anchor" id="VectorizedArrayType"></a></p><h3>VectorizedArrayType</h3>
<p>The class <a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> is a key component to achieve the highnode-level performance of the matrix-free algorithms in deal.II.It is a wrapper class around a short vector of \(n\) entries of type Number andmaps arithmetic operations to appropriate single-instruction/multiple-data(SIMD) concepts by intrinsic functions. The length of the vector can bequeried by <a class="el" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray::size()</a> and its underlying number type by <a class="el" href="classVectorizedArray.html#ad5e3061a2d2cf13c446354059e6fa8ef">VectorizedArray::value_type</a>. <br  />
 In the default case ( <code><a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></code> ), the vector length isset at compile time of the library tomatch the highest value supported by the given processor architecture.However, also a second optional template argument can bespecified as <code>VectorizedArray&lt;Number, size&gt;</code>, where <code>size</code> explicitlycontrols the vector length within the capabilities of a particular instructionset. A full list of supported vector lengths is presented in the following table: </p><table align="center" class="doxtable">
<tr>
<th>double </th><th>float </th><th>ISA  </th></tr>
<tr>
<td><code>VectorizedArray&lt;double, 1&gt;</code> </td><td><code>VectorizedArray&lt;float, 1&gt;</code> </td><td>(auto-vectorization)  </td></tr>
<tr>
<td><code>VectorizedArray&lt;double, 2&gt;</code> </td><td><code>VectorizedArray&lt;float, 4&gt;</code> </td><td>SSE2/AltiVec  </td></tr>
<tr>
<td><code>VectorizedArray&lt;double, 4&gt;</code> </td><td><code>VectorizedArray&lt;float, 8&gt;</code> </td><td>AVX/AVX2  </td></tr>
<tr>
<td><code>VectorizedArray&lt;double, 8&gt;</code> </td><td><code>VectorizedArray&lt;float, 16&gt;</code> </td><td>AVX-512  </td></tr>
</table>
<p><br  />
 This allows users to select the vector length/ISA and, as a consequence, thenumber of cells to be processed at once in matrix-free operator evaluations,possibly reducing the pressure on the caches, an severe issue for very highdegrees (and dimensions). A possible further reason to reduce the number of filled lanesis to simplify debugging: instead of having to look at, e.g., 8cells, one can concentrate on a single cell. The interface of <a class="el" href="classVectorizedArray.html">VectorizedArray</a> also enables the replacement by any type witha matching interface. Specifically, this prepares deal.II for the <code>std::simd</code> class that is planned to become part of the C++23 standard. The following tablecompares the deal.II-specific SIMD classes and the equivalent C++23 classes:</p>
<table align="center" class="doxtable">
<tr>
<th><a class="el" href="classVectorizedArray.html">VectorizedArray</a> (deal.II) </th><th>std::simd (C++23)  </th></tr>
<tr>
<td><code><a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></code> </td><td><code>std::experimental::native_simd&lt;Number&gt;</code>  </td></tr>
<tr>
<td><code>VectorizedArray&lt;Number, size&gt;</code> </td><td><code>std::experimental::fixed_size_simd&lt;Number, size&gt;</code>  </td></tr>
</table>
<p><br  />
</p>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Parametersandutilityfunctions"></a> </p><h3>Parameters and utility functions</h3>
<p>The same includes as in <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__accessor_8h.html">deal.II/grid/tria_accessor.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__iterator_8h.html">deal.II/grid/tria_iterator.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
</div><!-- fragment --><p>A new include for categorizing of cells according to their boundary IDs:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2tools_8h.html">deal.II/matrix_free/tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p>The same input parameters as in <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 1;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceStep37.html#a92034819b3a2b370b456b2e415e24f55">dimension</a>            = 2;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 2;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>            = 5;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 2;</div>
</div><!-- fragment --><p>This parameter specifies the size of the shared-memory group. Currently, only the values 1 and <a class="el" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a> is possible, leading to the options that the memory features can be turned off or all processes having access to the same shared-memory domain are grouped together.</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
</div><!-- fragment --><p>Here, the type of the data structure is chosen for vectorization. In the default case, <a class="el" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> is used, i.e., the highest instruction-set-architecture extension available on the given hardware with the maximum number of vector lanes is used. However, one might reduce the number of filled lanes, e.g., by writing <code>using VectorizedArrayType = VectorizedArray&lt;Number, 4&gt;</code> to only process 4 cells.</p>
<div class="fragment"><div class="line"><span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> = <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>;</div>
</div><!-- fragment --><p>The following parameters have not changed:</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>, 1.5);</div>
</div><!-- fragment --><p>Specify max number of time steps useful for performance studies.</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
</div><!-- fragment --><p>Runge-Kutta-related functions copied from <a class="el" href="step_67.html">step-67</a> and slightly modified with the purpose to minimize global vector access:</p>
<div class="fragment"><div class="line">   <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>,</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>,</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>,</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>,</div>
<div class="line">   };</div>
<div class="line">   constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">   {</div>
<div class="line">   <span class="keyword">public</span>:</div>
<div class="line">     LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line">       <span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">         {</div>
<div class="line">           <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">             lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">             lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">             lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">             lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">  </div>
<div class="line">           <span class="keywordflow">default</span>:</div>
<div class="line">             <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">         }</div>
<div class="line">       <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">         <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">                           rk_integrator(lsrk);</div>
<div class="line">       std::vector&lt;double&gt; ci; <span class="comment">// not used</span></div>
<div class="line">       rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">     </span>{</div>
<div class="line">       <span class="keywordflow">return</span> bi.size();</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">     <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                            <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                            <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                            VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                            VectorType &amp;    vec_ri,</div>
<div class="line">                            VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">     </span>{</div>
<div class="line">       <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line">  </div>
<div class="line">       vec_ki.swap(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line">       <span class="keywordtype">double</span> sum_previous_bi = 0;</div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 0; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">         {</div>
<div class="line">           <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0 ? 0 : sum_previous_bi + ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a></div>
<div class="line">  </div>
<div class="line">- 1];</div>
<div class="line">  </div>
<div class="line">           pde_operator.perform_stage(<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                                      current_time + c_i time_step,</div>
<div class="line">                                      bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] time_step,</div>
<div class="line">                                      (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size()</div>
<div class="line">  </div>
<div class="line">- 1 ?</div>
<div class="line">                                         0 :</div>
<div class="line">                                         ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] time_step),</div>
<div class="line">                                      (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ki : vec_ri),</div>
<div class="line">                                      (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ri : vec_ki),</div>
<div class="line">                                      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line">           <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &gt; 0)</div>
<div class="line">             sum_previous_bi += bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a></div>
<div class="line">  </div>
<div class="line">- 1];</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">private</span>:</div>
<div class="line">     std::vector&lt;double&gt; bi;</div>
<div class="line">     std::vector&lt;double&gt; ai;</div>
<div class="line">   };</div>
</div><!-- fragment --><p>Euler-specific utility functions from <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line">   <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">   };</div>
<div class="line">   constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">   {</div>
<div class="line">   <span class="keyword">public</span>:</div>
<div class="line">     ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">       : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">     {}</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">   };</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> 0:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">             x0[0] = 5.;</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">               (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div>
<div class="line">  </div>
<div class="line">- x0).norm_square()</div>
<div class="line">  </div>
<div class="line">- 2. (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0]</div>
<div class="line">  </div>
<div class="line">- x0[0]) t + t t;</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">               <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> 2) std::exp(1.</div>
<div class="line">  </div>
<div class="line">- radius_sqr);</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">               std::abs(1.</div>
<div class="line">  </div>
<div class="line">- (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> 0.25 <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.)));</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1.</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1]</div>
<div class="line">  </div>
<div class="line">- x0[1]);</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0]</div>
<div class="line">  </div>
<div class="line">- t</div>
<div class="line">  </div>
<div class="line">- x0[0]);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">               <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">               <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> u;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">               <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">             <span class="keywordflow">else</span></div>
<div class="line">               {</div>
<div class="line">                 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                   std::exp2(density_log (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.)));</div>
<div class="line">                 <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.) +</div>
<div class="line">                        0.5 (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> u u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">               }</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> 1:</div>
<div class="line">           {</div>
<div class="line">             <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">               <span class="keywordflow">return</span> 1.;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">               <span class="keywordflow">return</span> 0.4;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">               <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">             <span class="keywordflow">else</span></div>
<div class="line">               <span class="keywordflow">return</span> 0.;</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">           <span class="keywordflow">return</span> 0.;</div>
<div class="line">       }</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] inverse_density;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">       euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.) (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]</div>
<div class="line">  </div>
<div class="line">- 0.5 rho_u_dot_u);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">       euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       {</div>
<div class="line">         <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">           <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">         <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">         <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">           <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">     <a class="code" href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">               <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">     <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">               0.5 <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                          <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> pressure_p (1. / u_p[0]),</div>
<div class="line">                                        velocity_m.norm_square() +</div>
<div class="line">                                          <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> pressure_m (1. / u_m[0])));</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">return</span> 0.5 (flux_m <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                    0.5 <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> (u_m</div>
<div class="line">  </div>
<div class="line">- u_p);</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">               0.5 ((velocity_m + velocity_p) <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">               0.5 <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">               (pressure_p (1. / u_p[0]) + pressure_m (1. / u_m[0]))));</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal</div>
<div class="line">  </div>
<div class="line">- avg_c);</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos</div>
<div class="line">  </div>
<div class="line">- s_neg);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">return</span> inverse_s</div>
<div class="line">                    ((s_pos (flux_m <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">  </div>
<div class="line">- s_neg (flux_p <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>))</div>
<div class="line">  </div>
<div class="line">-</div>
<div class="line">                     s_pos s_neg (u_m</div>
<div class="line">  </div>
<div class="line">- u_p));</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">             <span class="keywordflow">return</span> {};</div>
<div class="line">           }</div>
<div class="line">       }</div>
<div class="line">   }</div>
</div><!-- fragment --><p>General-purpose utility functions from <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType&gt;</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a></div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized,</div>
<div class="line">                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line"><a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a></div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="EuleroperatorusingacellcentricloopandMPI30sharedmemory"></a> </p><h3>Euler operator using a cell-centric loop and MPI-3.0 shared memory</h3>
<p>Euler operator from <a class="el" href="step_67.html">step-67</a> with some changes as detailed below:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keyword">class </span>EulerOperator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">  EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">  ~EulerOperator();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                           std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  perform_stage(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      cur_time,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">               <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
</div><!-- fragment --><p>Instance of SubCommunicatorWrapper containing the sub-communicator, which we need to pass to <a class="el" href="classMatrixFree.html#adb324d469b296f2a6921b41208732ddf">MatrixFree::reinit()</a> to be able to exploit MPI-3.0 shared-memory capabilities:</p>
<div class="fragment"><div class="line">  MPI_Comm subcommunicator;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">    inflow_boundaries;</div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                 subsonic_outflow_boundaries;</div>
<div class="line">  std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">  std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line">};</div>
</div><!-- fragment --><p>New constructor, which creates a sub-communicator. The user can specify the size of the sub-communicator via the global parameter group_size. If the size is set to</p>
<ul>
<li>, all MPI processes of a shared-memory domain are combined to a group. The specified size is decisive for the benefit of the shared-memory capabilities of <a class="el" href="classMatrixFree.html">MatrixFree</a> and, therefore, setting the <code>size</code> to <code>-1</code> is a reasonable choice. By setting, the size to <code>1</code> users explicitly disable the MPI-3.0 shared-memory features of <a class="el" href="classMatrixFree.html">MatrixFree</a> and rely completely on MPI-2.0 features, like <code>MPI_Isend</code> and <code>MPI_Irecv</code> .</li>
</ul>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">    : timer(timer)</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#if DEAL_II_MPI_VERSION_GTE(3, 0)</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == 1)</div>
<div class="line">      {</div>
<div class="line">        this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">        MPI_Comm_split_type(MPI_COMM_WORLD,</div>
<div class="line">                            MPI_COMM_TYPE_SHARED,</div>
<div class="line">                            <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>,</div>
<div class="line">                            MPI_INFO_NULL,</div>
<div class="line">                            &amp;subcommunicator);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    (void)subcommunicator;</div>
<div class="line">    (void)<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a>;</div>
<div class="line">    this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
</div><!-- fragment --><p>New destructor responsible for freeing of the sub-communicator.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  EulerOperator&lt;dim, degree, n_points_1d&gt;::~EulerOperator()</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_MPI</span></div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;subcommunicator != MPI_COMM_SELF)</div>
<div class="line">      MPI_Comm_free(&amp;subcommunicator);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">  }</span></div>
</div><!-- fragment --><p>Modified <a class="el" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit()</a> function to setup the internal data structures in <a class="el" href="classMatrixFree.html">MatrixFree</a> in a way that it is usable by the cell-centric loops and the MPI-3.0 shared-memory capabilities are used:</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt;&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt;&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                  <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="structMatrixFree_1_1AdditionalData.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData</a></div>
<div class="line">    additional_data;</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">mapping_update_flags</a> =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">mapping_update_flags_inner_faces</a> =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">mapping_update_flags_boundary_faces</a> =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">tasks_parallel_scheme</a> =</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData::none</a>;</div>
</div><!-- fragment --><p>Categorize cells so that all lanes have the same boundary IDs for each face. This is strictly not necessary, however, allows to write simpler code in EulerOperator::perform_stage() without masking, since it is guaranteed that all cells grouped together (in a <a class="el" href="classVectorizedArray.html">VectorizedArray</a>) have to perform exactly the same operation also on the faces.</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceMatrixFreeTools.html#ae034b98c0db11285fae23a08ef3f197f">MatrixFreeTools::categorize_by_boundary_ids</a>(dof_handler.<a class="code" href="classDoFHandler.html#a7797f796c0be511fbc7f230ccc22532e">get_triangulation</a>(),</div>
<div class="line">                                            additional_data);</div>
</div><!-- fragment --><p>Enable MPI-3.0 shared-memory capabilities within <a class="el" href="classMatrixFree.html">MatrixFree</a> by providing the sub-communicator:</p>
<div class="fragment"><div class="line">  additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#afdca3541da950e50d2e8dca2de4ceb90">communicator_sm</a> = subcommunicator;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">    <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following function does an entire stage of a Runge&ndash;Kutta update and is</p>
<ul>
<li>alongside the slightly modified setup</li>
<li>the heart of this tutorial compared to <a class="el" href="step_67.html">step-67</a> . <br  />
 In contrast to <a class="el" href="step_67.html">step-67</a> , we are not executing the advection step (using <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>) and the inverse mass-matrix step (using <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a>) in sequence, but evaluate everything in one go inside of <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a>. This function expects a single function that is executed on each locally-owned (macro) cell as parameter so that we need to loop over all faces of that cell and perform needed integration steps on our own. <br  />
 The following function contains to a large extent copies of the following functions from <a class="el" href="step_67.html">step-67</a> so that comments related the evaluation of the weak form are skipped here:</li>
<li><code>EulerDG::EulerOperator::local_apply_cell</code> <br  />
</li>
<li><code>EulerDG::EulerOperator::local_apply_face</code> <br  />
</li>
<li><code>EulerDG::EulerOperator::local_apply_boundary_face</code> <br  />
</li>
<li><code>EulerDG::EulerOperator::local_apply_inverse_mass_matrix</code> <br  />
</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">    <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">    <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
</div><!-- fragment --><p>Run a cell-centric loop by calling <a class="el" href="classMatrixFree.html#a60ebe2e71cfd7602ef9bc612d22385f8">MatrixFree::loop_cell_centric()</a> and providing a lambda containing the effects of the cell, face and boundary-face integrals:</p>
<div class="fragment"><div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.template <a class="code" href="multithreading__0_8txt.html#a265e44213c5331eb7d572a97bbd8cd6c">loop_cell_centric&lt;LinearAlgebra::distributed::Vector&lt;Number&gt;</a>,</div>
<div class="line">                                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> cell_range) {</div>
<div class="line">    <span class="keyword">using</span> FECellIntegral = <a class="code" href="classFEEvaluation.html">FEEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                        <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                        n_points_1d,</div>
<div class="line">                                        <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                        <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line">    <span class="keyword">using</span> FEFaceIntegral = <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                            <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                            n_points_1d,</div>
<div class="line">                                            <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line"> </div>
<div class="line">    FECellIntegral phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    FECellIntegral phi_temp(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">    FEFaceIntegral phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line">    FEFaceIntegral phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a>     constant_body_force;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>constant_function =</div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a><span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">      constant_body_force =</div>
<div class="line">        evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">         constant_function, <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">    const ::internal::EvaluatorTensorProduct&lt;</div>
<div class="line">      <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">      <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">      n_points_1d,</div>
<div class="line">      n_points_1d,</div>
<div class="line">      <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">      eval(<a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>(),</div>
<div class="line">           <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info().data[0].shape_gradients_collocation_eo,</div>
<div class="line">           <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a> <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>(phi.static_n_q_points</div>
<div class="line">                                              phi.n_components);</div>
</div><!-- fragment --><p>Loop over all cell batches:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second;</div>
<div class="line">     ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">  {</div>
<div class="line">    phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">      phi_temp.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
</div><!-- fragment --><p>Read values from global vector and compute the values at the quadrature points:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>() &amp;&amp; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0)</div>
<div class="line">  {</div>
<div class="line">    phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0;</div>
<div class="line">         <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_dofs_per_component (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2);</div>
<div class="line">         ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      phi_temp.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">    phi.evaluate(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  {</div>
<div class="line">    phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Buffer the computed values at the quadrature points, since these are overridden by FEEvaluation::submit_value() in the next step, however, are needed later on for the face integrals:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_n_q_points (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
</div><!-- fragment --><p>Apply the cell integral at the cell quadrature points. See also the function <code>EulerOperator::local_apply_cell()</code> from <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">    phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">    <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> force =</div>
<div class="line">          constant_function ?</div>
<div class="line">            constant_body_force :</div>
<div class="line">            evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">             body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> forcing;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">        phi.submit_value(forcing, q);</div>
<div class="line">      }</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Test with the gradient of the test functions in the quadrature points. We skip the interpolation back to the support points of the element, since we first collect all contributions in the cell quadrature points and only perform the interpolation back as the final step.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  autovalues_ptr   = phi.begin_values();</div>
<div class="line">  autogradient_ptr = phi.begin_gradients();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1 &amp;&amp; body_force.get() == <span class="keyword">nullptr</span>)</div>
<div class="line">        eval.template gradients&lt;0, false, false&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points 0, values_ptr);</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1)</div>
<div class="line">        eval.template gradients&lt;0, false, true&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points 0, values_ptr);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 2)</div>
<div class="line">        eval.template gradients&lt;1, false, true&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points 1, values_ptr);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 3)</div>
<div class="line">        eval.template gradients&lt;2, false, true&gt;(</div>
<div class="line">          gradient_ptr + phi.static_n_q_points 2, values_ptr);</div>
<div class="line"> </div>
<div class="line">      values_ptr += phi.static_n_q_points;</div>
<div class="line">      gradient_ptr += phi.static_n_q_points <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Loop over all faces of the current cell:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = 0;</div>
<div class="line">     face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell;</div>
<div class="line">     ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">  {</div>
</div><!-- fragment --><p>Determine the boundary ID of the current face. Since we have set up <a class="el" href="classMatrixFree.html">MatrixFree</a> in a way that all filled lanes have guaranteed the same boundary ID, we can select the boundary ID of the first lane.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> boundary_ids =</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_faces_by_cells_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__bdm__0_8txt.html#a29a2868f8e5db6bbcae785d183329b77">std::equal</a>(boundary_ids.begin(),</div>
<div class="line">                  boundary_ids.begin() +</div>
<div class="line">                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>),</div>
<div class="line">                  boundary_ids.begin()),</div>
<div class="line">       <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Boundary IDs of lanes differ.&quot;</span>));</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = boundary_ids[0];</div>
<div class="line"> </div>
<div class="line">phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
</div><!-- fragment --><p>Interpolate the values from the cell quadrature points to the quadrature points of the current face via a simple 1D interpolation:</p>
<div class="fragment"><div class="line">                 <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                      n_points_1d</div>
<div class="line">  </div>
<div class="line">- 1,</div>
<div class="line">                                                      <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">                   template interpolate_quadrature&lt;true, false&gt;(</div>
<div class="line">                     <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                     <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">                     <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>.data(),</div>
<div class="line">                     phi_m.begin_values(),</div>
<div class="line">                     <span class="keyword">false</span>,</div>
<div class="line">                     <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
</div><!-- fragment --><p>Check if the face is an internal or a boundary face and select a different code path based on this information:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> == <a class="code" href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a>)</div>
<div class="line">  {</div>
</div><!-- fragment --><p>Process and internal face. The following lines of code are a copy of the function <code>EulerDG::EulerOperator::local_apply_face</code> from <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line">    phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">    phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">          euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                    phi_p.get_value(q),</div>
<div class="line">                                    phi_m.get_normal_vector(q));</div>
<div class="line">        phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  {</div>
</div><!-- fragment --><p>Process a boundary face. These following lines of code are a copy of the function <code>EulerDG::EulerOperator::local_apply_boundary_face</code> from <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line">                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">                       {</div>
<div class="line">                         <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi_m.get_value(q);</div>
<div class="line">                         <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi_m.get_normal_vector(q);</div>
<div class="line">  </div>
<div class="line">                         <span class="keyword">auto</span> rho_u_dot_n = w_m[1] <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">                         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                           rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">  </div>
<div class="line">                         <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line">  </div>
<div class="line">                         <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> w_p;</div>
<div class="line">  </div>
<div class="line">                         <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                             wall_boundaries.end())</div>
<div class="line">                           {</div>
<div class="line">                             w_p[0] = w_m[0];</div>
<div class="line">                             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                               w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] =</div>
<div class="line">                                 w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]</div>
<div class="line">  </div>
<div class="line">- 2. rho_u_dot_n <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                             w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">                           }</div>
<div class="line">                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                                  inflow_boundaries.end())</div>
<div class="line">                           w_p = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                            inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                             phi_m.quadrature_point(q));</div>
<div class="line">                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(</div>
<div class="line">                                    <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                                  subsonic_outflow_boundaries.end())</div>
<div class="line">                           {</div>
<div class="line">                             w_p = w_m;</div>
<div class="line">                             w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] =</div>
<div class="line">                               <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*subsonic_outflow_boundaries</div>
<div class="line">                                                    .find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">-&gt;<a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a>,</div>
<div class="line">                                                 phi_m.quadrature_point(q),</div>
<div class="line">                                                 <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">                             at_outflow = <span class="keyword">true</span>;</div>
<div class="line">                           }</div>
<div class="line">                         <span class="keywordflow">else</span></div>
<div class="line">                           <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                                       <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">                                         <span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                         <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                         <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line">  </div>
<div class="line">                         <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">  </div>
<div class="line">                         <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">                           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0;</div>
<div class="line">                                <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">                                ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">                             {</div>
<div class="line">                               <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt;</div>
<div class="line">  </div>
<div class="line">-1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                                   <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">                             }</div>
<div class="line">  </div>
<div class="line">                         phi_m.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">                       }</div>
<div class="line">                   }</div>
</div><!-- fragment --><p>Evaluate local integrals related to cell by quadrature and add into cell contribution via a simple 1D interpolation:</p>
<div class="fragment"><div class="line">                 <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                      n_points_1d</div>
<div class="line">  </div>
<div class="line">- 1,</div>
<div class="line">                                                      <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">                   template interpolate_quadrature&lt;false, true&gt;(</div>
<div class="line">                     <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                     <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">                     phi_m.begin_values(),</div>
<div class="line">                     phi.begin_values(),</div>
<div class="line">                     <span class="keyword">false</span>,</div>
<div class="line">                     <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">               }</div>
</div><!-- fragment --><p>Apply inverse mass matrix in the cell quadrature points. See also the function <code>EulerDG::EulerOperator::local_apply_inverse_mass_matrix()</code> from <a class="el" href="step_67.html">step-67</a> :</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_n_q_points; ++q)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> = <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>(1.0) / phi.JxW(q);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">      phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> phi.static_n_q_points + q] =</div>
<div class="line">        phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> phi.static_n_q_points + q] <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p>Transform values from collocation space to the original Gauss-Lobatto space:</p>
<div class="fragment"><div class="line"><a class="code" href="structinternal_1_1FEEvaluationImplBasisChange.html">internal::FEEvaluationImplBasisChange</a>&lt;</div>
<div class="line">  <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">  <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa13fcf221bed4879f9b319347525f703b">internal::EvaluatorQuantity::hessian</a>,</div>
<div class="line">  <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">  <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> + 1,</div>
<div class="line">  n_points_1d,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::do_backward(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info()</div>
<div class="line">                                      .data[0]</div>
<div class="line">                                      .inverse_shape_values_eo,</div>
<div class="line">                                    <span class="keyword">false</span>,</div>
<div class="line">                                    phi.begin_values(),</div>
<div class="line">                                    phi.begin_dof_values());</div>
</div><!-- fragment --><p>Perform Runge-Kutta update and write results back to global vectors:</p>
<div class="fragment"><div class="line">          <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">            {</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                phi.begin_dof_values()[q] = bi phi.begin_dof_values()[q];</div>
<div class="line">              phi.distribute_local_to_global(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">              <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> != 0)</div>
<div class="line">                phi_temp.read_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keyword">const</span> <span class="keyword">auto</span> K_i = phi.begin_dof_values()[q];</div>
<div class="line"> </div>
<div class="line">                  phi.begin_dof_values()[q] =</div>
<div class="line">                    phi_temp.begin_dof_values()[q] + (ai K_i);</div>
<div class="line"> </div>
<div class="line">                  phi_temp.begin_dof_values()[q] += bi K_i;</div>
<div class="line">                }</div>
<div class="line">              phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">              phi_temp.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    },</div>
<div class="line">    vec_ki,</div>
<div class="line">    current_ri,</div>
<div class="line">    <span class="keyword">true</span>,</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>From here, the code of <a class="el" href="step_67.html">step-67</a> has not changed.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                     subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                   wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                            <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                            <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line">  </div>
<div class="line">     inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                     inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                   wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                            <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                            <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line">  </div>
<div class="line">     subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                     inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                   subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                     subsonic_outflow_boundaries.end(),</div>
<div class="line">                 <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                            <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                            <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                            <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line">  </div>
<div class="line">     wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">     std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line">  </div>
<div class="line">     this-&gt;body_force = std::move(body_force);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">       phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">     <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                    <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                                    <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                                    <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">       <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">     <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">       {</div>
<div class="line">         phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">           phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                                  phi.quadrature_point(q)),</div>
<div class="line">                                q);</div>
<div class="line">         <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                  phi.begin_dof_values(),</div>
<div class="line">                                                  phi.begin_dof_values());</div>
<div class="line">         phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">       }</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">     <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">       phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">       {</div>
<div class="line">         phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">         phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">         <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_errors_squared[3] = {};</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">               <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q))</div>
<div class="line">  </div>
<div class="line">-</div>
<div class="line">               phi.get_value(q);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line">  </div>
<div class="line">             local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">             local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">           }</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">              ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">             errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line">  </div>
<div class="line">     std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">       phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">       {</div>
<div class="line">         phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">         phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">         <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_max = 0.;</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span>          inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span>          convective_speed = inverse_jacobian <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">             <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> convective_limit = 0.;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               convective_limit =</div>
<div class="line">                 <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">  </div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">               <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">               {</div>
<div class="line">                 <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(inverse_jacobian)</div>
<div class="line">                               (inverse_jacobian <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">                 <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> eigenvector_norm = 0.;</div>
<div class="line">                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                   eigenvector_norm =</div>
<div class="line">                     <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">                 <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">               }</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">               (jac_times_ev jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">             local_max =</div>
<div class="line">               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                        max_eigenvalue speed_of_sound + convective_limit);</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">              ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">             max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> max_transport;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keyword">class </span>EulerProblem</div>
<div class="line">   {</div>
<div class="line">   <span class="keyword">public</span>:</div>
<div class="line">     EulerProblem();</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">private</span>:</div>
<div class="line">     <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line">  </div>
<div class="line"><span class="preprocessor"> #ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">     <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor"> #else</span></div>
<div class="line">     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor"> #endif</span></div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">     <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">     <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line">  </div>
<div class="line">     EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">     {</div>
<div class="line">     <span class="keyword">public</span>:</div>
<div class="line">       Postprocessor();</div>
<div class="line">  </div>
<div class="line">       <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">         <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line">  </div>
<div class="line">       <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line">  </div>
<div class="line">       <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">       get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line">  </div>
<div class="line">       <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">private</span>:</div>
<div class="line">       <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">     };</div>
<div class="line">   };</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor()</div>
<div class="line">     : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">   {}</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">     <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">              <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">     <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">              <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">       {</div>
<div class="line">         <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">           <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">  </div>
<div class="line">         <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">         <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">           computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">         computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">         computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">           computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">             inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">       }</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">     <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">     <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">       <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">   EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">       interpretation;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       interpretation.push_back(</div>
<div class="line">         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">     interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">     interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">       interpretation.push_back(</div>
<div class="line">         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> interpretation;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">       <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">     <span class="keywordflow">else</span></div>
<div class="line">       <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   EulerProblem&lt;dim&gt;::EulerProblem()</div>
<div class="line">     : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line"> #ifdef DEAL_II_WITH_P4EST</div>
<div class="line">     , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line"> #endif</div>
<div class="line">     , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">     , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">     , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">     , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">     , euler_operator(timer)</div>
<div class="line">     , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">     , time_step(0)</div>
<div class="line">   {}</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line">   {</div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> 0:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">  </div>
<div class="line">-5;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">             upper_right[0] = 10;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                            lower_left,</div>
<div class="line">                                            upper_right);</div>
<div class="line">             <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line">  </div>
<div class="line">             euler_operator.set_inflow_boundary(</div>
<div class="line">               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> 1:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">               <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line">  </div>
<div class="line">             euler_operator.set_inflow_boundary(</div>
<div class="line">               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">             euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">               1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">  </div>
<div class="line">             euler_operator.set_wall_boundary(2);</div>
<div class="line">             euler_operator.set_wall_boundary(3);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">               euler_operator.set_body_force(</div>
<div class="line">                 std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                   std::vector&lt;double&gt;({0., 0.,</div>
<div class="line">  </div>
<div class="line">-0.2})));</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line">  </div>
<div class="line">     dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line">  </div>
<div class="line">     euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">     euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line">     std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().getloc();</div>
<div class="line">     pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">     pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">           &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">           &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">           &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">           &lt;&lt; std::endl;</div>
<div class="line">     pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">       euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">     <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line">  </div>
<div class="line">     pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">           &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">           &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">           &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">           &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">           &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line">  </div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line">  </div>
<div class="line">       Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">       <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">       <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">       data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line">  </div>
<div class="line">       data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">       {</div>
<div class="line">         std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">         <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">           <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">         <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line">  </div>
<div class="line">         std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">           interpretation;</div>
<div class="line">         interpretation.push_back(</div>
<div class="line">           <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">           interpretation.push_back(</div>
<div class="line">             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">         interpretation.push_back(</div>
<div class="line">           <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">  </div>
<div class="line">         data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">       }</div>
<div class="line">       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">         {</div>
<div class="line">           <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">           euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">           <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">           std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">           <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">             <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">           <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line">  </div>
<div class="line">           std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">             interpretation;</div>
<div class="line">           interpretation.push_back(</div>
<div class="line">             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">             interpretation.push_back(</div>
<div class="line">               <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">           interpretation.push_back(</div>
<div class="line">             <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">  </div>
<div class="line">           data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                    <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                    interpretation);</div>
<div class="line">         }</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">       mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line">  </div>
<div class="line">       data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                              <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                              <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line">  </div>
<div class="line">       <span class="keyword">const</span> std::string filename =</div>
<div class="line">         <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">       data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">     }</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">   {</div>
<div class="line">     {</div>
<div class="line">       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) n_vect_number;</div>
<div class="line">  </div>
<div class="line">       pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">             &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">       pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">             &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">             &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">             &lt;&lt; std::endl;</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">     make_grid_and_dofs();</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">     rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">     rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line">     euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">     <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">         min_vertex_distance =</div>
<div class="line">           <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">     min_vertex_distance =</div>
<div class="line">       <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line">  </div>
<div class="line">     time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> integrator.n_stages() /</div>
<div class="line">                 euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">     pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">           &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">           &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">           &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">           &lt;&lt; std::endl</div>
<div class="line">           &lt;&lt; std::endl;</div>
<div class="line">  </div>
<div class="line">     output_results(0);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a></div>
<div class="line">  </div>
<div class="line">- 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12 &amp;&amp; timestep_number &lt; <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a>)</div>
<div class="line">       {</div>
<div class="line">         ++timestep_number;</div>
<div class="line">         <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">           time_step =</div>
<div class="line">             <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> integrator.n_stages() /</div>
<div class="line">             <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">               euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line">  </div>
<div class="line">         {</div>
<div class="line">           <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">           integrator.perform_time_step(euler_operator,</div>
<div class="line">                                        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                        time_step,</div>
<div class="line">                                        <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                        rk_register_1,</div>
<div class="line">                                        rk_register_2);</div>
<div class="line">         }</div>
<div class="line">  </div>
<div class="line">         <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">               <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">  </div>
<div class="line">- time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">             <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a></div>
<div class="line">  </div>
<div class="line">- 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">           output_results(</div>
<div class="line">             <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     timer.<a class="code" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">print_wall_time_statistics</a>(MPI_COMM_WORLD);</div>
<div class="line">     pcout &lt;&lt; std::endl;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> } <span class="comment">// namespace Euler_DG</span></div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv)</div>
<div class="line"> {</div>
<div class="line">   <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">   <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">  </div>
<div class="line">   <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line">  </div>
<div class="line">   <span class="keywordflow">try</span></div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">       euler_problem.run();</div>
<div class="line">     }</div>
<div class="line">   <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">     {</div>
<div class="line">       std::cerr &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                 &lt;&lt; std::endl;</div>
<div class="line">       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                 &lt;&lt; std::endl;</div>
<div class="line">  </div>
<div class="line">       <span class="keywordflow">return</span> 1;</div>
<div class="line">     }</div>
<div class="line">   <span class="keywordflow">catch</span> (...)</div>
<div class="line">     {</div>
<div class="line">       std::cerr &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                 &lt;&lt; std::endl;</div>
<div class="line">       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                 &lt;&lt; std::endl;</div>
<div class="line">       <span class="keywordflow">return</span> 1;</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">   <span class="keywordflow">return</span> 0;</div>
<div class="line"> }</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>Running the program with the default settings on a machine with 40 processesproduces the following output: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 27.648.000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 25.600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 0.000295952, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.0075, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00441179</div>
<div class="line">Time:       0, dt:   0.0003, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:  5.385<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, rho u:  1.916<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, energy: 1.547<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-15</div>
<div class="line">+--------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed         |     17.52<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    10 |     17.52<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     17.52<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    11 |</div>
<div class="line">|                                      |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                  | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+--------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>           |         1 |  0.009594s    16 |  0.009705s |  0.009819s     8 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed  |        22 |    0.1366s     0 |    0.1367s |    0.1368s    18 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                   |         1 |     1.233s     0 |     1.233s |     1.233s    32 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total   |       100 |     8.746s    35 |     8.746s |     8.746s     0 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h |       500 |     8.742s    36 |     8.742s |     8.743s     2 |</div>
<div class="line">+--------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>and the following visual output: </p><table align="center" class="doxtable" style="width:85%">
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_010.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_025.png" alt="" width="100%" class="inline"/>   </td></tr>
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_050.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_100.png" alt="" width="100%" class="inline"/>   </td></tr>
</table>
<p><br  />
 As a reference, the results of <a class="el" href="step_67.html">step-67</a> using FCL are: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 27.648.000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 25.600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 0.000295952, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.0075, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00441179</div>
<div class="line">Time:       0, dt:   0.0003, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:  5.385<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, rho u:  1.916<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, energy: 1.547<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-15</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     13.33<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |     13.34<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     13.35<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |         1 |  0.007977s    10 |  0.008053s |  0.008161s    30 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |        22 |    0.1228s    34 |    0.2227s |    0.3845s     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |         1 |     1.255s     3 |     1.257s |     1.259s    27 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |       100 |     11.15s     0 |     11.32s |     11.42s    34 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |       500 |     8.719s    10 |     8.932s |     9.196s     0 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |       500 |     1.944s     0 |     2.377s |      2.55s    10 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>By the modifications shown in this tutorial, we were able to achieve a speedup of27% for the Runge-Kutta stages. <a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>The algorithms are easily extendable to higher dimensions: a high-dimensional<a href="https://github.com/hyperdeal/hyperdeal/blob/a9e67b4e625ff1dde2fed93ad91cdfacfaa3acdf/include/hyper.deal/operators/advection/advection_operation.h#L219-L569">advection operator based on cell-centric loops</a>is part of the hyper.deal library. An extension of cell-centric loopsto locally-refined meshes is more involved. <a class="anchor" id="ExtensiontothecompressibleNavierStokesequations"></a></p><h4>Extension to the compressible Navier-Stokes equations</h4>
<p>The solver presented in this tutorial program can also be extended to thecompressible Navier–Stokes equations by adding viscous terms, as alsosuggested in <a class="el" href="step_67.html">step-67</a> . To keep as much of the performance obtained here despitethe additional cost of elliptic terms, e.g. via an interior penalty method, thattutorial has proposed to switch the basis from <a class="el" href="classFE__DGQ.html">FE_DGQ</a> to <a class="el" href="classFE__DGQHermite.html">FE_DGQHermite</a> like inthe <a class="el" href="step_59.html">step-59</a> tutorial program. The reasoning behind this switch is that in thecase of <a class="el" href="classFE__DGQ.html">FE_DGQ</a> all values of neighboring cells (i.e., \(k+1\) layers) are needed,whilst in the case of <a class="el" href="classFE__DGQHermite.html">FE_DGQHermite</a> only 2 layers, making the lattersignificantly more suitable for higher degrees. The additional layers have to be,on the one hand, loaded from main memory during flux computation and, one theother hand, have to be communicated. Using the shared-memory capabilitiesintroduced in this tutorial, the second point can be eliminated on a singlecompute node or its influence can be reduced in a hybrid context. <a class="anchor" id="BlockGaussSeidellikepreconditioners"></a></p><h4>Block Gauss-Seidel-like preconditioners</h4>
<p>Cell-centric loops could be used to create block Gauss-Seidel preconditionersthat are multiplicative within one process and additive over processes. Thesetype of preconditioners use during flux computation, in contrast to Jacobi-typepreconditioners, already updated values from neighboring cells. The followingpseudo-code visualizes how this could in principal be achieved: </p><div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;Number&gt;</a> visit_flags(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches () + <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_ghost_cell_batches ());</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line"><a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.template loop_cell_centric&lt;VectorType, VectorType&gt;(</div>
<div class="line">  [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> cell_range) {</div>
<div class="line">  </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="comment">// cell integral as usual (not shown)</span></div>
<div class="line">  </div>
<div class="line">        for (unsigned int face = 0; face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell; ++face)</div>
<div class="line">          {</div>
<div class="line">            const auto boundary_id = data.get_faces_by_cells_boundary_id(cell, face)[0];</div>
<div class="line">  </div>
<div class="line">            if (boundary_id == numbers::internal_face_boundary_id)</div>
<div class="line">              {</div>
<div class="line">                phi_p.reinit(cell, face);</div>
<div class="line">  </div>
<div class="line">                const auto flags = phi_p.read_cell_data(visit_flags);</div>
<div class="line">                const auto all_neighbors_have_been_updated =</div>
<div class="line">                  std::min(flags.begin(),</div>
<div class="line">                           flags().begin() + data.n_active_entries_per_cell_batch(cell) == 1;</div>
<div class="line">  </div>
<div class="line">                if(all_neighbors_have_been_updated)</div>
<div class="line">                  phi_p.gather_evaluate(dst, EvaluationFlags::values);</div>
<div class="line">                else</div>
<div class="line">                  phi_p.gather_evaluate(src, EvaluationFlags::values);</div>
<div class="line">  </div>
<div class="line">                <span class="comment">// continue as usual (not shown)</span></div>
<div class="line">              }</div>
<div class="line">            else</div>
<div class="line">              {</div>
<div class="line">                <span class="comment">// boundary integral as usual (not shown)</span></div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">  </div>
<div class="line">        <span class="comment">// continue as above and apply your favorite algorithm to invert</span></div>
<div class="line">        <span class="comment">// the cell-local operator (not shown)</span></div>
<div class="line">  </div>
<div class="line">        <span class="comment">// make cells as updated</span></div>
<div class="line">        phi.set_cell_data(visit_flags, <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>(1.0));</div>
<div class="line">      }</div>
<div class="line">  },</div>
<div class="line">  <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  src,</div>
<div class="line">  <span class="keyword">true</span>,</div>
<div class="line">  <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::DataAccessOnFaces::values</a>);</div>
</div><!-- fragment --><p>For this purpose, one can exploit the cell-data vector capabilities ofMatrixFree and the range-based iteration capabilities of <a class="el" href="classVectorizedArray.html">VectorizedArray</a>. Please note that in the given example we process <code>VectorizedArrayType::size()</code> number of blocks, since each lane corresponds to one block. We consider blocksas updated if all blocks processed by a vector register have been updated. Inthe case of Cartesian meshes this is a reasonable approach, however, forgeneral unstructured meshes this conservative approach might lead to a decrease in theefficiency of the preconditioner. A reduction of cells processed in parallelby explicitly reducing the number of lanes used by <code>VectorizedArrayType</code> might increase the quality of the preconditioner, but with the cost that eachiteration might be more expensive. This dilemma leads us to a further"possibility for extension": vectorization within an element.</p>
<p><a class="anchor" id="PlainProg"></a></p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2020 - 2021 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Martin Kronbichler, Peter Munch, David Schneider, 2020</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__accessor_8h.html">deal.II/grid/tria_accessor.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria__iterator_8h.html">deal.II/grid/tria_iterator.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2tools_8h.html">deal.II/matrix_free/tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 1;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#adc634dce0c07c9dbb94d367c8d97afd3">dimension</a>            = 2;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 2;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>            = 5;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a> + 2;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> = <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>, 1.5);</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a> = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>,</div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">            lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">        }</div>
<div class="line">      <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">        <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">                          rk_integrator(lsrk);</div>
<div class="line">      std::vector&lt;double&gt; ci; <span class="comment">// not used</span></div>
<div class="line">      rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <span class="keywordflow">return</span> bi.size();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">    <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                           VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                           VectorType &amp;    vec_ri,</div>
<div class="line">                           VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"> </div>
<div class="line">      vec_ki.swap(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> sum_previous_bi = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 0; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0 ? 0 : sum_previous_bi + ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> - 1];</div>
<div class="line"> </div>
<div class="line">          pde_operator.perform_stage(<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                                     current_time + c_i * time_step,</div>
<div class="line">                                     bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step,</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size() - 1 ?</div>
<div class="line">                                        0 :</div>
<div class="line">                                        ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step),</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ki : vec_ri),</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> % 2 == 0 ? vec_ri : vec_ki),</div>
<div class="line">                                     <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &gt; 0)</div>
<div class="line">            sum_previous_bi += bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> - 1];</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    std::vector&lt;double&gt; bi;</div>
<div class="line">    std::vector&lt;double&gt; ai;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">      : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    {}</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="classEuler__DG_1_1ExactSolution.html#a16ae78e70f688acd015b407649997f1b">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">            x0[0] = 5.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">              (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> - x0).norm_square() - 2. * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - x0[0]) * t + t * t;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">              <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">              std::abs(1. - (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * 0.25 * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log * (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1] - x0[1]);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - t - x0[0]);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                  std::exp2(density_log * (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) +</div>
<div class="line">                       0.5 * (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u * u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> 1.;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> 0.4;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">              <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              <span class="keywordflow">return</span> 0.;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> 0.;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * inverse_density;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] - 0.5 * rho_u_dot_u);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">          <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">          <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aec42034f53f838aafe42fb93b273eb92">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">              0.5 * <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line">                                       velocity_m.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 0.5 * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                   0.5 * lambda * (u_m - u_p);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">              0.5 * ((velocity_m + velocity_p) * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">              0.5 * <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> *</div>
<div class="line">              (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal - avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos - s_neg);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> inverse_s *</div>
<div class="line">                   ((s_pos * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) - s_neg * (flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)) -</div>
<div class="line">                    s_pos * s_neg * (u_m - u_p));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keywordflow">return</span> {};</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> VectorizedArrayType, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                  <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a> &amp;p_vectorized)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArrayType&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayType::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerOperator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">    EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">    ~EulerOperator();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                             std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">      std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    perform_stage(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      cur_time,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">                 <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    MPI_Comm subcommunicator;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">      inflow_boundaries;</div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                   subsonic_outflow_boundaries;</div>
<div class="line">    std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">    std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerOperator.html#aae07d964990108d9f0b51995835e4a10">EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator</a>(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">    : timer(timer)</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#if DEAL_II_MPI_VERSION_GTE(3, 0)</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == 1)</div>
<div class="line">      {</div>
<div class="line">        this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a> == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">        MPI_Comm_split_type(MPI_COMM_WORLD,</div>
<div class="line">                            MPI_COMM_TYPE_SHARED,</div>
<div class="line">                            <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>,</div>
<div class="line">                            MPI_INFO_NULL,</div>
<div class="line">                            &amp;subcommunicator);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    (void)subcommunicator;</div>
<div class="line">    (void)<a class="code" href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">group_size</a>;</div>
<div class="line">    this-&gt;subcommunicator = MPI_COMM_SELF;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  EulerOperator&lt;dim, degree, n_points_1d&gt;::~EulerOperator()</div>
<div class="line">  {</div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_MPI</span></div>
<div class="line">    <span class="keywordflow">if</span> (this-&gt;subcommunicator != MPI_COMM_SELF)</div>
<div class="line">      MPI_Comm_free(&amp;subcommunicator);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                    <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="structMatrixFree_1_1AdditionalData.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData</a></div>
<div class="line">      additional_data;</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">mapping_update_flags</a> =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">mapping_update_flags_inner_faces</a> =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">mapping_update_flags_boundary_faces</a> =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">tasks_parallel_scheme</a> =</div>
<div class="line">      <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::AdditionalData::none</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceMatrixFreeTools.html#ae034b98c0db11285fae23a08ef3f197f">MatrixFreeTools::categorize_by_boundary_ids</a>(dof_handler.<a class="code" href="classDoFHandler.html#a7797f796c0be511fbc7f230ccc22532e">get_triangulation</a>(),</div>
<div class="line">                                                additional_data);</div>
<div class="line"> </div>
<div class="line">    additional_data.<a class="code" href="structMatrixFree_1_1AdditionalData.html#afdca3541da950e50d2e8dca2de4ceb90">communicator_sm</a> = subcommunicator;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                                <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      bi,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      ai,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.template <a class="code" href="multithreading__0_8txt.html#a265e44213c5331eb7d572a97bbd8cd6c">loop_cell_centric&lt;LinearAlgebra::distributed::Vector&lt;Number&gt;</a>,</div>
<div class="line">                                    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;(</div>
<div class="line">      [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">auto</span> &amp;<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;src, <span class="keyword">const</span> <span class="keyword">auto</span> cell_range) {</div>
<div class="line">        <span class="keyword">using</span> FECellIntegral = <a class="code" href="classFEEvaluation.html">FEEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                            <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                            n_points_1d,</div>
<div class="line">                                            <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line">        <span class="keyword">using</span> FEFaceIntegral = <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                                n_points_1d,</div>
<div class="line">                                                <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                                <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;;</div>
<div class="line"> </div>
<div class="line">        FECellIntegral phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">        FECellIntegral phi_temp(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line">        FEFaceIntegral phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line">        FEFaceIntegral phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a>     constant_body_force;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line">          <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">          constant_body_force =</div>
<div class="line">            evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">              *constant_function, <a class="code" href="classPoint.html">Point&lt;dim, VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">        const ::internal::EvaluatorTensorProduct&lt;</div>
<div class="line">          <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">          <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">          n_points_1d,</div>
<div class="line">          n_points_1d,</div>
<div class="line">          <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">          eval(<a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>(),</div>
<div class="line">               <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info().data[0].shape_gradients_collocation_eo,</div>
<div class="line">               <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a>());</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classAlignedVector.html">AlignedVector&lt;VectorizedArrayType&gt;</a> <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>(phi.static_n_q_points *</div>
<div class="line">                                                  phi.n_components);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second;</div>
<div class="line">             ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">          {</div>
<div class="line">            phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">              phi_temp.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ai != <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>() &amp;&amp; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == 0)</div>
<div class="line">              {</div>
<div class="line">                phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0;</div>
<div class="line">                     <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_dofs_per_component * (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2);</div>
<div class="line">                     ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                  phi_temp.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_dof_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">                phi.evaluate(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; phi.static_n_q_points * (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = phi.begin_values()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">                phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">                <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">                  {</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> force =</div>
<div class="line">                      constant_function ?</div>
<div class="line">                        constant_body_force :</div>
<div class="line">                        evaluate_function&lt;dim, VectorizedArrayType, dim&gt;(</div>
<div class="line">                          *body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">                    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> forcing;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">                    phi.submit_value(forcing, q);</div>
<div class="line">                  }</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">auto</span> *values_ptr   = phi.begin_values();</div>
<div class="line">              <span class="keyword">auto</span> *gradient_ptr = phi.begin_gradients();</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1 &amp;&amp; body_force.get() == <span class="keyword">nullptr</span>)</div>
<div class="line">                    eval.template gradients&lt;0, false, false&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 0, values_ptr);</div>
<div class="line">                  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 1)</div>
<div class="line">                    eval.template gradients&lt;0, false, true&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 0, values_ptr);</div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 2)</div>
<div class="line">                    eval.template gradients&lt;1, false, true&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 1, values_ptr);</div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt;= 3)</div>
<div class="line">                    eval.template gradients&lt;2, false, true&gt;(</div>
<div class="line">                      gradient_ptr + phi.static_n_q_points * 2, values_ptr);</div>
<div class="line"> </div>
<div class="line">                  values_ptr += phi.static_n_q_points;</div>
<div class="line">                  gradient_ptr += phi.static_n_q_points * <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = 0;</div>
<div class="line">                 face &lt; GeometryInfo&lt;dim&gt;::faces_per_cell;</div>
<div class="line">                 ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> boundary_ids =</div>
<div class="line">                  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_faces_by_cells_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__bdm__0_8txt.html#a29a2868f8e5db6bbcae785d183329b77">std::equal</a>(boundary_ids.begin(),</div>
<div class="line">                                  boundary_ids.begin() +</div>
<div class="line">                                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>),</div>
<div class="line">                                  boundary_ids.begin()),</div>
<div class="line">                       <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Boundary IDs of lanes differ.&quot;</span>));</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = boundary_ids[0];</div>
<div class="line"> </div>
<div class="line">                phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                     n_points_1d - 1,</div>
<div class="line">                                                     <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">                  template interpolate_quadrature&lt;true, false&gt;(</div>
<div class="line">                    <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">                    <a class="code" href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a>.data(),</div>
<div class="line">                    phi_m.begin_values(),</div>
<div class="line">                    <span class="keyword">false</span>,</div>
<div class="line">                    <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> == <a class="code" href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a>)</div>
<div class="line">                  {</div>
<div class="line">                    phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">                    phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">                      {</div>
<div class="line">                        <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">                          euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                                    phi_p.get_value(q),</div>
<div class="line">                                                    phi_m.get_normal_vector(q));</div>
<div class="line">                        phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">                      }</div>
<div class="line">                  }</div>
<div class="line">                <span class="keywordflow">else</span></div>
<div class="line">                  {</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">                      {</div>
<div class="line">                        <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi_m.get_value(q);</div>
<div class="line">                        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi_m.get_normal_vector(q);</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                          rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">                        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArrayType&gt;</a> w_p;</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                            wall_boundaries.end())</div>
<div class="line">                          {</div>
<div class="line">                            w_p[0] = w_m[0];</div>
<div class="line">                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                              w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] =</div>
<div class="line">                                w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] - 2. * rho_u_dot_n * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                            w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">                          }</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                                 inflow_boundaries.end())</div>
<div class="line">                          w_p = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                            *inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                            phi_m.quadrature_point(q));</div>
<div class="line">                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(</div>
<div class="line">                                   <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                                 subsonic_outflow_boundaries.end())</div>
<div class="line">                          {</div>
<div class="line">                            w_p = w_m;</div>
<div class="line">                            w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] =</div>
<div class="line">                              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*subsonic_outflow_boundaries</div>
<div class="line">                                                   .find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">                                                   -&gt;<a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a>,</div>
<div class="line">                                                phi_m.quadrature_point(q),</div>
<div class="line">                                                <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">                            at_outflow = <span class="keyword">true</span>;</div>
<div class="line">                          }</div>
<div class="line">                        <span class="keywordflow">else</span></div>
<div class="line">                          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                                      <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">                                        <span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                        <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                        <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line"> </div>
<div class="line">                        <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">                          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0;</div>
<div class="line">                               <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">                               ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">                            {</div>
<div class="line">                              <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt; -1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                                  <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">                            }</div>
<div class="line"> </div>
<div class="line">                        phi_m.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">                      }</div>
<div class="line">                  }</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                     n_points_1d - 1,</div>
<div class="line">                                                     <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::</div>
<div class="line">                  template interpolate_quadrature&lt;false, true&gt;(</div>
<div class="line">                    <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info(),</div>
<div class="line">                    phi_m.begin_values(),</div>
<div class="line">                    phi.begin_values(),</div>
<div class="line">                    <span class="keyword">false</span>,</div>
<div class="line">                    <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_n_q_points; ++q)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> = <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>(1.0) / phi.JxW(q);</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> = 0; <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>)</div>
<div class="line">                  phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> * phi.static_n_q_points + q] =</div>
<div class="line">                    phi.begin_values()[<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a> * phi.static_n_q_points + q] * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>;</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="structinternal_1_1FEEvaluationImplBasisChange.html">internal::FEEvaluationImplBasisChange</a>&lt;</div>
<div class="line">              <a class="code" href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">::internal::EvaluatorVariant::evaluate_evenodd</a>,</div>
<div class="line">              <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa13fcf221bed4879f9b319347525f703b">internal::EvaluatorQuantity::hessian</a>,</div>
<div class="line">              <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">              <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> + 1,</div>
<div class="line">              n_points_1d,</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>,</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;::do_backward(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_shape_info()</div>
<div class="line">                                                  .data[0]</div>
<div class="line">                                                  .inverse_shape_values_eo,</div>
<div class="line">                                                <span class="keyword">false</span>,</div>
<div class="line">                                                phi.begin_values(),</div>
<div class="line">                                                phi.begin_dof_values());</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                  phi.begin_dof_values()[q] = bi * phi.begin_dof_values()[q];</div>
<div class="line">                phi.distribute_local_to_global(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">if</span> (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> != 0)</div>
<div class="line">                  phi_temp.read_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.static_dofs_per_cell; ++q)</div>
<div class="line">                  {</div>
<div class="line">                    <span class="keyword">const</span> <span class="keyword">auto</span> K_i = phi.begin_dof_values()[q];</div>
<div class="line"> </div>
<div class="line">                    phi.begin_dof_values()[q] =</div>
<div class="line">                      phi_temp.begin_dof_values()[q] + (ai * K_i);</div>
<div class="line"> </div>
<div class="line">                    phi_temp.begin_dof_values()[q] += bi * K_i;</div>
<div class="line">                  }</div>
<div class="line">                phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">                phi_temp.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">      },</div>
<div class="line">      vec_ki,</div>
<div class="line">      current_ri,</div>
<div class="line">      <span class="keyword">true</span>,</div>
<div class="line">      <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number, VectorizedArrayType&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">    this-&gt;body_force = std::move(body_force);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>,</div>
<div class="line">                                                   <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>,</div>
<div class="line">                                                   <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                   <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>,</div>
<div class="line">                                                   <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a>&gt;</div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                                 phi.quadrature_point(q)),</div>
<div class="line">                               q);</div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                 phi.begin_dof_values(),</div>
<div class="line">                                                 phi.begin_dof_values());</div>
<div class="line">        phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_errors_squared[3] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line">              phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line"> </div>
<div class="line">            local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number, VectorizedArrayType&gt;</a></div>
<div class="line">      phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> local_max = 0.;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>          inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>          convective_speed = inverse_jacobian * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> convective_limit = 0.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              convective_limit =</div>
<div class="line">                <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">              <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> * (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArrayType&gt;</a> <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="chunk__sparse__matrix__0_8txt.html#ad43ded305d7756c82052fec150fdf5dd">transpose</a>(inverse_jacobian) *</div>
<div class="line">                              (inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">                <a class="code" href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">VectorizedArrayType</a> eigenvector_norm = 0.;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  eigenvector_norm =</div>
<div class="line">                    <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">              }</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">              (jac_times_ev * jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">            local_max =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                       max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> max_transport;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span><a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a></div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor</a>()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">    <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">             <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">            inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] * inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">      interpretation;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> interpretation;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::EulerProblem</a>()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::make_grid_and_dofs</a>()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = -5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">            upper_right[0] = 10;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                           lower_left,</div>
<div class="line">                                           upper_right);</div>
<div class="line">            <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">              <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">            euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">              1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_wall_boundary(2);</div>
<div class="line">            euler_operator.set_wall_boundary(3);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">              euler_operator.set_body_force(</div>
<div class="line">                std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                  std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line"> </div>
<div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">    euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().getloc();</div>
<div class="line">    pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">    pcout.<a class="code" href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">get_stream</a>().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::output_results</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">      euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">      <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">      {</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">      }</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">            interpretation;</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            interpretation.push_back(</div>
<div class="line">              <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">          data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                   <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                   <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                   interpretation);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">      mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                             <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                             <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> std::string filename =</div>
<div class="line">        <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">VectorizedArrayType::size</a>();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) * n_vect_number;</div>
<div class="line"> </div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">    rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">        min_vertex_distance =</div>
<div class="line">          <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">    min_vertex_distance =</div>
<div class="line">      <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">                euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">          &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    output_results(0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12 &amp;&amp; timestep_number &lt; <a class="code" href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">max_time_steps</a>)</div>
<div class="line">      {</div>
<div class="line">        ++timestep_number;</div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">          time_step =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">            <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">          integrator.perform_time_step(euler_operator,</div>
<div class="line">                                       <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                       time_step,</div>
<div class="line">                                       <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                       rk_register_1,</div>
<div class="line">                                       rk_register_2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> - time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">          output_results(</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    timer.<a class="code" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">print_wall_time_statistics</a>(MPI_COMM_WORLD);</div>
<div class="line">    pcout &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace Euler_DG</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespaceEuler__DG_html_a2629567e63f50a5312110be969de47ea"><div class="ttname"><a href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">Euler_DG::numerical_flux_type</a></div><div class="ttdeci">constexpr EulerNumericalFlux numerical_flux_type</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00085">step-67.cc:85</a></div></div>
<div class="ttc" id="asparse__vanka__0_8txt_html_a63f572a3b5d8c173a82cee16f5858977"><div class="ttname"><a href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a></div><div class="ttdeci">this elimination is done by the modification of the right hand and in the end these degrees of freedom do not occur in the matrix and solution vector any more at all *This system is solved and the values are updated into the destination vector the matrices are built up such that the degree of freedom associated with the Lagrange multiplier is the first one usually the upper left entry in the matrix is zero It is not clear to so it must persist longer than the Vanka object The same is true for the matrix The matrix[2.x.11] which is passed here may or may not be the same matrix for which this object shall act as preconditioner In it is conceivable that the preconditioner is build up for one matrix but is used for subsequent steps in a nonlinear process as where the matrix changes in each step slightly **Destructor Delete all allocated matrices **Parameters for SparseVanka **Constructor For the parameters see below **Constructor For the parameters see below[2.x.12] The use of this constructor is deprecated **the second and third parameters are ignored **Indices of those degrees of freedom that we shall work on **If the default constructor is used then this function needs to be called before an object of this class is used as preconditioner For more detail about possible parameters see the class documentation and the documentation of the[2.x.13] class After this function is called the preconditioner is ready to be only values for allowed indices are written to[2.x.27] dst</div><div class="ttdef"><b>Definition:</b> <a href="sparse__vanka__0_8txt_source.html#l00060">sparse_vanka_0.txt:60</a></div></div>
<div class="ttc" id="aclassEuler__DG_1_1EulerProblem_html"><div class="ttname"><a href="classEuler__DG_1_1EulerProblem.html">Euler_DG::EulerProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l01041">step-67.cc:1041</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a0900f35b37ee122e73fb2c80bba9beb9"><div class="ttname"><a href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a></div><div class="ttdeci">constexpr T pow(const T base, const int iexp)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2utilities_8h_source.html#l00464">utilities.h:464</a></div></div>
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="afe_2fe__dgq_8h_html"><div class="ttname"><a href="fe_2fe__dgq_8h.html">fe_dgq.h</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out__dof__data_8h_source.html#l01096">data_out_dof_data.h:1096</a></div></div>
<div class="ttc" id="adistributed_2tria__0_8txt_html_a372359e6a4e93d0a8d5d7c53a24c5ba0"><div class="ttname"><a href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a></div><div class="ttdeci">this function joins faces in the p4est forest for periodic boundary conditions As a result each pair of faces will differ by at most one refinement level and ghost neighbors will be available across these faces The vector can be filled by the function[2.x.67] For more information on periodic boundary conditions see[2.x.68][2.x.69] and *[2.x.70] Before this function can be used the Triangulation has to be initialized and must not be refined Calling this function more than once is but not this data structure holds the connectivity between the cells of the coarse grid **A data structure that holds the part of the global triangulation **A data structure that holds some information about the ghost cells of the triangulation **Go through all p4est trees and record the relations between locally owned p4est quadrants and active deal II cells in the private member vector local_cell_relations The vector contains an active cell iterator for every locally owned p4est as well as a CellStatus flag to describe their relation The stored vector will be ordered by the occurrence of quadrants in the corresponding sc_array of the parallel_forest p4est requires this specific ordering for its transfer functions the size of this vector will be equal to the number of locally owned quadrants in the parallel_forest object These relations will be established for example in the mesh refinement but before applying these changes to this we will record how cells will change in the refinement process With this we can prepare all buffers for data transfer accordingly **Two arrays that store which p4est tree corresponds to which coarse grid cell and vice versa We need these arrays because p4est goes with the original order of coarse cells when it sets up its and then applies the Morton ordering within each tree But if coarse grid cells are badly ordered this may mean that individual parts of the forest stored on a machine may be split across coarse grid cells that are not geometrically close we apply a hierarchical preordering according to[2.x.72] to ensure that the part of the forest stored by p4est is located on geometrically close coarse grid cells **Return a pointer to the p4est tree that belongs to the given because the triangulation is not updated yet The weights are sorted in the order that p4est will encounter them while iterating over them **This method returns a bit vector of length tria i the vertices touched by the locally owned level cells for use in geometric all this class does is throw an exception **dummy settings **Constructor The argument denotes the MPI communicator to be used for the triangulation **Destructor **Return a permutation vector for the order the coarse cells are handed of to p4est For example the first element i in this vector denotes that the first cell in hierarchical ordering is the ith deal cell starting from but needs to be present for the compiler **This function is not but needs to be present for the compiler **This function is not but needs to be present for the compiler **This function is not but needs to be present for the compiler **Dummy arrays This class isn t usable but the compiler wants to see these variables at a couple places anyway **This which is only implemented for needs a stub because it is used in dof_handler_policy cc **Like this which is only implemented for needs a stub because it is used in dof_handler_policy cc **Dummy class the compiler chooses for parallel distributed triangulations if we didn t actually configure deal II with the p4est library The existence of this class allows us to refer to[2.x.75] objects throughout the library even if it is disabled Since the constructor of this class is deleted no such objects can actually be created as this would be pointless given that p4est is not available **Dummy settings to allow defining the deleted constructor **Constructor Deleted to make sure that objects of this type cannot be and persists for the lifetime of an instantiation of this class The TemporarilyMatchRefineFlags class should only be used in combination with the[2.x.77] signal At this stage</div><div class="ttdef"><b>Definition:</b> <a href="distributed_2tria__0_8txt_source.html#l00144">tria_0.txt:144</a></div></div>
<div class="ttc" id="anamespaceStep31_1_1EquationData_html_aa1e9e1a7297b10cb39c2065f86acc66f"><div class="ttname"><a href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">Step31::EquationData::density</a></div><div class="ttdeci">constexpr double density</div><div class="ttdef"><b>Definition:</b> <a href="step-31_8cc_source.html#l00075">step-31.cc:75</a></div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a9c19e2f34c53e5e4662b0fa119e2c99d"><div class="ttname"><a href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal flux</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="aclassDataPostprocessor_html"><div class="ttname"><a href="classDataPostprocessor.html">DataPostprocessor</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00477">data_postprocessor.h:477</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_aa2b5a089b26d5eb6842e77a0320440b0"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a></div><div class="ttdeci">precision How many digits to use when writing the error</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00041">parsed_convergence_table_0.txt:41</a></div></div>
<div class="ttc" id="amapping__q1__0_8txt_html_a45d517f8f46ad2c69e32a4cf382e3883"><div class="ttname"><a href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a></div><div class="ttdeci">*Implementation of a[2.x.0] linear mapping from the reference cell to a general quadrilateral hexahedron *The mapping implemented by this class maps the reference(unit) cell to a general grid cell with straight lines in[2.x.1] dimensions.(Note</div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdeci">@ update_gradients</div><div class="ttdoc">Shape function gradients.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00077">fe_update_flags.h:77</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_afec1b694405cadb2d251275096ad3563"><div class="ttname"><a href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data output</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="aclassFE__DGQ_html"><div class="ttname"><a href="classFE__DGQ.html">FE_DGQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__dgq_8h_source.html#l00105">fe_dgq.h:105</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ad207fe81a5be05e18534713c2677da7b"><div class="ttname"><a href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data error input in integration This is because in these one typically needs access not only to[2.x.39] locally owned dofs but also to[2.x.40] locally active dofs and sometimes to[2.x.41] locally relevant dofs</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_a76bc1cc7649cc416723f450d24fdd91d"><div class="ttname"><a href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">Utilities::System::get_time</a></div><div class="ttdeci">std::string get_time()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l01019">utilities.cc:1019</a></div></div>
<div class="ttc" id="ahdf5__0_8txt_html_aae153b86de45d3354cd3edd5b992435e"><div class="ttname"><a href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a></div><div class="ttdeci">*Namespace containing deal II s HDF5 interface whereas writing and reading raw data in a dataset can be done independently or double</div><div class="ttdef"><b>Definition:</b> <a href="hdf5__0_8txt_source.html#l00045">hdf5_0.txt:45</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_af35ca33203cd802325d779be7b6b41e8"><div class="ttname"><a href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a></div><div class="ttdeci">namespace are implemented the way they are More information on their implementation can be found in the[2.x.72] WorkStream paper To see the WorkStream class used in practice on tasks like the ones outlined above take a look at or[2.x.78] tutorial programs *To begin with</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00139">multithreading_0.txt:139</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a></div><div class="ttdeci">runge_kutta_method</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00277">time_stepping.h:277</a></div></div>
<div class="ttc" id="aclassTimerOutput_1_1Scope_html"><div class="ttname"><a href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2timer_8h_source.html#l00600">timer.h:600</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_a8fba07b9a84b89e6be225f5f95c3e355"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a></div><div class="ttdeci">the program is just and one can not intelligently work around that *It is sometimes useful to change the behavior of the[2.x.6] macro from aborting a program to throwing exceptions On the other exceptions are not allowed to propagate out of destructors of classes For this there is a variant of the called[2.x.7] that can be used in destructors These use cases are discussed further down below on this page **Dynamic such as whether an output file can be written to *These are things that shouldn t be checked because it is not guaranteed that a program for which the condition is satisfied in a debug mode run</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00022">exceptions_0.txt:22</a></div></div>
<div class="ttc" id="areordering__0_8txt_html_abc892651c0b2805d80c1933e2fb51c1a"><div class="ttname"><a href="reordering__0_8txt.html#abc892651c0b2805d80c1933e2fb51c1a">right</a></div><div class="ttdeci">if it is not then it aborts in linear time as well *Both algorithms are described in the paper On orienting edges of unstructured two and three dimensional R M W W L ACM Transactions on Mathematical A preprint is available as *[1.x.19] **Prior to the implementation of the algorithms described we used a branch and cut algorithm initially implemented in by Wolfgang Bangerth Although it is no longer here is how it and why it doesn t always work for large meshes since its run time can be exponential in bad cases *The first observation is that although there are problems are usually local For in the second example mentioned if we had numbered the cells in a way that neighboring cells have similar cell then the amount of backtracking needed is greatly reduced in the implementation of the the first step is to renumber the cells in a Cuthill McKee and so on this represents finding zones of cells consecutively further away from the initial cells and number them in this front marching way This already greatly improves locality of problems and consequently reduced the necessary amount of backtracking *The second point is that we can use some methods to prune the which usually lead to a valid orientation of all cells very quickly *The first such method is based on the observation that if we fail to insert one cell with number then this may not be due to cell N unless N is a direct neighbor of N The reason is for the latter cannot be the case if we fail to add cell then it is not necessary to track back to cell but we can track back to the neighbor of N with the largest cell index and which has already been added this method can fail to yield a valid path through the tree if not applied with care Consider the following initially extracted from a mesh of cells generated automatically by the program BAMG(this program usually generates meshes that are quite badly balanced, often have many **- sometimes 10 or more **- neighbors of one vertex, and exposed several problems in the initial algorithm;note also that the example is in 2d where we now have the much better algorithm described above, but the same observations also apply to 3d) we will therefore find no orientation of cell in which it can be added without violation of the consistency of the triangulation According to the rule stated we track back to the neighbor with greatest which is but since its bottom line is to th right)</div><div class="ttdef"><b>Definition:</b> <a href="reordering__0_8txt_source.html#l00125">reordering_0.txt:125</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html_a904b46a59d224ec214e4816e584cba5f"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">DataPostprocessorInputs::Vector::solution_values</a></div><div class="ttdeci">std::vector&lt;::Vector&lt; double &gt; &gt; solution_values</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00330">data_postprocessor.h:330</a></div></div>
<div class="ttc" id="aclassTimerOutput_html_ae7673798226de7731e3ecdf7c0fb7568"><div class="ttname"><a href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics</a></div><div class="ttdeci">void print_wall_time_statistics(const MPI_Comm &amp;mpi_comm, const double print_quantile=0.) const</div><div class="ttdef"><b>Definition:</b> <a href="timer_8cc_source.html#l00844">timer.cc:844</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a2e990f30e4c3b71e80e78084f073ca9b"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a></div><div class="ttdeci">****This class simplifies the construction of convergence tables reading the options for the generation of the table from a parameter file It provides a series of methods that can be used to compute the error given a reference exact solution or the difference between two numerical solutions or any other custom computation of the error given via[2.x.1] objects *An example usage of this class is given by ****The above code constructs a ParsedConvergenceTable that works for scalar and will produce an error table with and Linfty_norm norms of the error *Whenever a call to the methods the instance of this class inspects its parameters computes all norms specified by the parameter given at construction time possibly modified via a parameter file computes all extra column entries specified using the method and writes one row of the convergence table *Once you have finished with the a call to and to the the same code can be used to estimate the errors of mixed or multi physics e and one component for the pressure field and will produce an error table with H1 and L2 norm of the error in the velocity to write the table only to the file specified in the parameter file *By calling the method the following options will be defined in the given ParameterHandler and can be modified at run time through a parameter please cite ******Minimal constructor for ParsedConvergenceTable objects The number of components must match the number of components of the finite element space that is used to compute the errors If a component name is than it is interpreted as a vector and the errors of the repeated components are grouped together The size of the vector[2.x.3] must match the number of unique component names</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00035">parsed_convergence_table_0.txt:35</a></div></div>
<div class="ttc" id="agrid_2tria__iterator_8h_html"><div class="ttname"><a href="grid_2tria__iterator_8h.html">tria_iterator.h</a></div></div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="doc_2doxygen_2headers_2namespace__dealii_8h_source.html#l00026">namespace_dealii.h:26</a></div></div>
<div class="ttc" id="amatrix__free_2dof__info__0_8txt_html_afc846d40941f6f9934e92e469096f30f"><div class="ttname"><a href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a></div><div class="ttdeci">We set the granularity to **that is a number sufficiently large to minimize loop peel overhead within the this function always returns index If an index is not found in hp it returns *[2.x.2] *Populate the vector[2.x.3] with locally owned degrees of freedom stored on the cell block[2.x.4] If[2.x.5] is then the returned vector will contain indices required to resolve constraints The image below illustrates the output of this function for cell blocks zero and one with zero Dirichlet boundary conditions at the bottom of the domain Note that due to the presence of the DoFs returned by this function for the case i indices that are located on another get a temporary number by this and will later be assigned the correct index after all the ghost indices have been collected by the call to *[2.x.12] *This method assigns the correct indices to ghost indices from the temporary numbering employed by the[2.x.13] function The numbers are localized with respect to the MPI and ghosts start at the end of the locally owned range This we get direct access to all vector entries **This method reorders the way cells are gone through based on a given renumbering of the cells It also takes[2.x.14] cells together and interprets them as one cell as is needed for vectorization **Finds possible compression for the cell indices that we can apply for increased efficiency Run at the end of reorder_cells **Finds possible compression for the face indices that we can apply for increased efficiency Run at the end of reorder_cells **This function computes the connectivity of the currently stored indices in terms of connections between the individual cells and fills the structure into a sparsity pattern **In case face integrals are find out whether certain loops over the unknowns only access a subset of all the ghost dofs we keep in the main partitioner **Given[2.x.15] containing the index of cells of macro the index ordering can be improved for typical DG elements by interleaving the degrees of freedom from batches of which avoids the data transposition in[2.x.16] these more advanced features are not so there is only limited value of this function **Fills the array that defines how to zero selected ranges in the result vector within the cell filling the two member variables[2.x.17] vector_zero_range_list_index and[2.x.18] The intent of this pattern is to zero the vector entries in close temporal proximity to the first access and thus keeping the vector entries in cache **Return the memory consumption in bytes of this class **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **Prints a representation of the indices in the class to the given output stream **Enum for various storage variants of the indices This storage format is used to implement more efficient indexing schemes in case the underlying data structures allow for and to inform the access functions in[2.x.19] on which array to get the data from One example of more efficient storage is the enum value[2.x.20] which means that one can get the indices to all degrees of freedom of a cell by reading only the first index for each whereas all subsequent indices are merely an offset from the first index **This value indicates that no index compression was found and the only valid storage is to access all indices present on the possibly including constraints For a cell face of this index the data access in FEEvaluationBase is directed to the array[2.x.21] dof_indices with the index row_starts[cell_index *n_vectorization *n_components] first **This value indicates that the indices are interleaved for access with vectorized gather and scatter operation This storage variant is possible in case there are no constraints on the cell and the indices in the batch of cells are not pointing to the same global index in different slots of a vectorized the data access in FEEvaluationBase is directed to the array dof_indices_interleaved with the index row_starts[cell_index *n_vectorization *n_components] first **This value indicates that the indices within a cell are all and one can get the index to the cell by reading that single value for each of the cells in the cell batch For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **This value indicates that the indices with a cell are contiguous and interleaved for i the first DoF index on a cell to the four or eight cells in the vectorization batch come than the second DoF and so on the interleaving between cells implies that only the batches for vectorization can be accessed whereas there is a strided access for getting only some of the entries The two additional categories interleaved_contiguous_strided and interleaved_contiguous_mixed_strides are a consequence of this storage type The former is for faces where at least one of the two adjacent sides will break with the interleaved storage We then have to make a strided access as described in the next category The last category interleaved_contiguous_mixed_strides appears in the ghost see the more detailed description of that category below this is something that cannot be avoided in general once we interleave the indices between cells For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **Similar to interleaved_contiguous but for the case when the interleaved indices are only contiguous within the degrees of but not also over the components of a vectorized array This happens typically on faces with DG where the cells have interleaved_contiguous storage but the faces numbering is not the same as the cell s numbering For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **Similar to interleaved_contiguous_separate but for the case when the interleaved indices are not n_vectorization apart This happens typically within the ghost layer of DG where the remote owner has applied an interleaved storage and the current processor only sees some of the cells For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization * n_components</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2dof__info__0_8txt_source.html#l00070">dof_info_0.txt:70</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00070">fe_update_flags.h:70</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a6cf0880ba2af3a1be4aacdbbd4b90f9c"><div class="ttname"><a href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a></div><div class="ttdeci">where BaseIterator usually is one of thestandard iterators discussed above *The FilteredIterator gets an additional Predicate in its constructor and willskip all objects where this Predicate evaluates to&lt; tt &gt; false&lt;/tt &gt; Acollection of predicates already implemented can be found in the namespaceIteratorFilters ***IteratorsLoops Iterating over objects *All iterators of the same kind and iterating over thesame kind of geometrical objects traverse the mesh in the sameorder Take this code all iterators will always point to the same mesh even though&lt; tt &gt; DoFHandler&lt;/tt &gt; and&lt; tt &gt; Triangulation&lt;/tt &gt; are very different and even if the DoFHandlers are handling different finite the difference is only in the Accessor As mentioned the order in which iterators traverse the forest ofobjects is actually well but application programs should notassume any such but rather consider this an implementation detailof the library *Corresponding to above the order in which iterators traverse activeobjects is the same for all iterators in the following the difference to the previous example being that here we only consider active but theyare really rather dumb Their magic only lies in the fact that they point tosome useful in this case the Accessor For they point to anactual object that stores some data On the other the deal II when do not return a reference to an actual but returnan object that knows how to get at the data that represents cells In thisobject doesn t store itself where the vertices of a cell are or what its neighborsare it knows how to tease this sort of information from out of thearrays and tables and lists that the Triangulation class sets up to describe amesh *Accessing data that characterizes a cell is always done through the i e the expression[2.x.10] grants access to[1.x.6] attributes of this Accessor Examples of properties you can query from aniterator are ***Since dereferencing iterators yields accessor these calls are tomember etc These in turn figure out the relevant datafrom the various data structures that store this data How this is actuallydone and what data structures are used is not really of concern to authors ofapplications in deal II In by hiding the actual data structureswe are able to store data in an efficient not necessarily in a way thatmakes it easily accessible or understandable to application writers ***IteratorsTypedefs Kinds of accessors *Depending on what sort of data you want to there are different kindsof accessor and hexes that make up a triangulation</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00063">iterators_0.txt:63</a></div></div>
<div class="ttc" id="aclassLinearAlgebra_1_1distributed_1_1Vector_html"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt; Number &gt;</a></div></div>
<div class="ttc" id="astep-1_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="step-1_8cc_source.html#l00086">step-1.cc:86</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_aec42034f53f838aafe42fb93b273eb92"><div class="ttname"><a href="namespaceEuler__DG.html#aec42034f53f838aafe42fb93b273eb92">Euler_DG::operator*</a></div><div class="ttdeci">Tensor&lt; 1, n_components, Number &gt; operator*(const Tensor&lt; 1, n_components, Tensor&lt; 1, dim, Number &gt;&gt; &amp;matrix, const Tensor&lt; 1, dim, Number &gt; &amp;vector)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00308">step-67.cc:308</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a40a3b09f9a2f7ebc40dbae202ae7ee60"><div class="ttname"><a href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">Euler_DG::n_q_points_1d</a></div><div class="ttdeci">constexpr unsigned int n_q_points_1d</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00062">step-67.cc:62</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a0759c0124e216ec36f063ad051f4dba0"><div class="ttname"><a href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a></div><div class="ttdeci">it should be big enough so that we don t spend more time on scheduling sub ranges to processors but small enough that processors can be efficiently load balanced A rule of thumb appears to be that a sub range is too small if it takes less than instructions to execute it *An example of how to use these functions are vector operations like the addition in[2.x.45] where all three objects are of type we used a[1.x.23] to on the a function object that takes two arguments and returns the sum of the two This is exactly what we needed when we want to add the individual elements of vectors[2.x.46] and[2.x.47] and write the sum of the two into the elements of[2.x.48] The function object that we get here is completely known to the compiler and when it expands the loop that results from[2.x.49] will be as if we had written the loop in its obvious thereby eliminating the overhead of calling an external function there are cases where it is inefficient to call some object or function within each iteration *An example for this case is sparse matrix vector multiplication If you know how data is stored in compressed row format like in the SparseMatrix then a matrix vector product function looks like we compute the dot product of a single row of the matrix with the right hand side vector[2.x.51] and write it into the corresponding element of the[2.x.52] vector The code is made more efficient by utilizing that the elements of the[1.x.28] row follow the ones of the current i e at the beginning of the loop body we do not have to re set the pointers that point to the values and column numbers of each row *Using the[2.x.53] function we could in principle write this code as leaving one argument open and thus allowing the[2.x.56] function to consider the passed function argument as unary Also note that we need to make the source and destination vectors neither of which is what we desired notice the grainsize of a minimum of rows of a matrix that should be processed by an individual CPU core *The point is that while this is it is not since now the function object to be called on each row is not a simple[1.x.32] any there is an implicit function call including argument passing in each iteration of the loop *A more efficient way is to let TBB split the original range into sub and then call a target function not on each individual element of the but on the entire range This is facilitated by the[2.x.61] we call the[2.x.62] function on sub ranges of at least elements so that the initial setup cost can amortize *A related operation is when the loops over elements each produce a result that must then be but let s assume for a moment that it is A sequential implementation would look like this for sparse each of which compute their part of the square of the norm</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00124">multithreading_0.txt:124</a></div></div>
<div class="ttc" id="agroup__Vectors_html_gad16bd935d90fe664309c52be1615bd4b"><div class="ttname"><a href="group__Vectors.html#gad16bd935d90fe664309c52be1615bd4b">LinearAlgebra::distributed::Vector::shared_vector_data</a></div><div class="ttdeci">const std::vector&lt; ArrayView&lt; const Number &gt; &gt; &amp; shared_vector_data() const</div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="agrid_2tria_8h_html"><div class="ttname"><a href="grid_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_a5873b8f7eeaefb5e7a99005c6c93b175"><div class="ttname"><a href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a></div><div class="ttdeci">and a mapping object that provides the Jacobian as well as its determinant Dealing with all these objects would be cumbersome and error prone *On the other these three kinds of objects almost always appear and it is in fact very rare for deal II application codes to do anything with quadrature</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00019">update_flags_0.txt:19</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a2ffe4cdaef4472045fff75d609590f8a"><div class="ttname"><a href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">VectorizedArray::max</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; max(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05765">vectorization.h:5765</a></div></div>
<div class="ttc" id="ampi__remote__point__evaluation__0_8txt_html_a45c57074a631760cdab557f450e880e0"><div class="ttname"><a href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a></div><div class="ttdeci">*Helper class to access values on non matching grids *The name of the fields are chosen with the method quantities are computed at specified arbitrary positioned which receive the result and resort the result according to the points **Constructor[2.x.1] tolerance Tolerance in terms of unit cell coordinates for determining all cells around a point passed to the class during it might be necessary to adjust the tolerance in order to be able to identify a cell Floating point arithmetic implies that a point in not lie exactly on a or face[2.x.2] enforce_unique_mapping Enforce unique mapping</div><div class="ttdef"><b>Definition:</b> <a href="mpi__remote__point__evaluation__0_8txt_source.html#l00005">mpi_remote_point_evaluation_0.txt:5</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a2ef2b357f53f1fa5d8d48b585ba14746"><div class="ttname"><a href="namespaceEuler__DG.html#a2ef2b357f53f1fa5d8d48b585ba14746">Euler_DG::max_time_steps</a></div><div class="ttdeci">constexpr unsigned int max_time_steps</div><div class="ttdef"><b>Definition:</b> <a href="step-76_8cc_source.html#l00080">step-76.cc:80</a></div></div>
<div class="ttc" id="aclassMappingQGeneric_html"><div class="ttname"><a href="classMappingQGeneric.html">MappingQGeneric&lt; dim &gt;</a></div></div>
<div class="ttc" id="abase_2vectorization_8h_html_ae5c8b2cd70b2640bab8f1ee4ccb7f4cc"><div class="ttname"><a href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05727">vectorization.h:5727</a></div></div>
<div class="ttc" id="ampi__compute__index__owner__internal__0_8txt_html_a556508d4f019d698d28e912ee1ef9937"><div class="ttname"><a href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a></div><div class="ttdeci">namespace used for[2.x.0] and for *[2.x.1] *Specialization of[2.x.2] for setting up the Dictionary even if there are ranges in the IndexSet space not owned by any processes *Only for internal usage **Constructor **Implementation of *[2.x.4] *Implementation of *[2.x.5] *Implementation of *[2.x.6] *Dictionary class with basic partitioning in terms of a single interval of fixed size known to all MPI ranks for two stage index lookup **The minimum grain size for the intervals We choose to limit the smallest size an interval for the two stage lookup can have with the following two conflicting goals in we do not want intervals in the dictionary to become too short For uneven distributions of the lookup DoFs *dictionary then involves sending from one MPI rank to many other MPI ranks holding dictionary leading to an exceedingly high number of messages some ranks have to send fewer longer intervals are generally more efficient to look up On the other a range size too large leads to opposite effect of many messages that come into a particular dictionary owner in the lookup DoFs *dictionary With the current we get at most messages coming to a single MPI rank in case there is dof per MPI rank</div><div class="ttdef"><b>Definition:</b> <a href="mpi__compute__index__owner__internal__0_8txt_source.html#l00021">mpi_compute_index_owner_internal_0.txt:21</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2base_2utilities_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2utilities_8h.html">utilities.h</a></div></div>
<div class="ttc" id="abase_2time__stepping_8h_html"><div class="ttname"><a href="base_2time__stepping_8h.html">time_stepping.h</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a8402043a938d7bb8af59713a5c0cc73e"><div class="ttname"><a href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">VectorizedArray::min</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; min(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05781">vectorization.h:5781</a></div></div>
<div class="ttc" id="abase_2timer_8h_html"><div class="ttname"><a href="base_2timer_8h.html">timer.h</a></div></div>
<div class="ttc" id="ampi__consensus__algorithms__0_8txt_html_a838f363361c1440426158fdb54734a5d"><div class="ttname"><a href="mpi__consensus__algorithms__0_8txt.html#a838f363361c1440426158fdb54734a5d">buffer</a></div><div class="ttdeci">namespace for consensus algorithms designed for dynamic sparse communication patterns ***An interface to be able to use the Interface classes The main functionality of the implementations is to return a list of process ranks this process wants data from and to deal with the optional payload of the messages sent received by the ConsensusAlgorithm classes There are two kinds of users have to deal with buffers themselves The ConsensusAlgorithm classes deliver only references to empty and communicate these vectors blindly **Destructor **A vector of ranks this process wants to send a request to *This is the only method which has to be implemented since the payloads of the messages are optional **Add to the request to the process with the specified rank a payload[2.x.6] other_rank rank of the process[2.x.7] send_buffer data to be sent part of the you have to set its size **Prepare the buffer where the payload of the answer of the request to the process with the specified rank is saved in The most obvious task is to resize the buffer</div><div class="ttdef"><b>Definition:</b> <a href="mpi__consensus__algorithms__0_8txt_source.html#l00062">mpi_consensus_algorithms_0.txt:62</a></div></div>
<div class="ttc" id="aclassFunctions_1_1ConstantFunction_html"><div class="ttname"><a href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt; dim &gt;</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_aafea668ad0c451ac7a0fae0f558c36d7"><div class="ttname"><a href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a></div><div class="ttdeci">in the area occupied by these artificial cells</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00037">distributed_0.txt:37</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a5c8e274cb8e86cd8a2a29a3ee1362455"><div class="ttname"><a href="namespaceEuler__DG.html#a5c8e274cb8e86cd8a2a29a3ee1362455">Euler_DG::group_size</a></div><div class="ttdeci">constexpr unsigned int group_size</div><div class="ttdef"><b>Definition:</b> <a href="step-76_8cc_source.html#l00068">step-76.cc:68</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_abe9ea58de877eaeae1e6d493078a41c4"><div class="ttname"><a href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">Euler_DG::testcase</a></div><div class="ttdeci">constexpr unsigned int testcase</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00058">step-67.cc:58</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">Euler_DG::LowStorageRungeKuttaScheme</a></div><div class="ttdeci">LowStorageRungeKuttaScheme</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00071">step-67.cc:71</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html_a2a918d936d56f2be4cdad1b8074c3a86"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">DataPostprocessorInputs::Vector::solution_gradients</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, spacedim &gt; &gt; &gt; solution_gradients</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00347">data_postprocessor.h:347</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l02413">patterns.h:2413</a></div></div>
<div class="ttc" id="amapping__info__0_8txt_html_aaed09e22b1fee38bd2273caeedfb0e90"><div class="ttname"><a href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a></div><div class="ttdeci">*An enum to identify various types of cells and faces The most general type is what we typically compute in the FEValues context but for many geometries we can save significant storage ***The cell or face is Cartesian **The cell or face can be described with an affine mapping **The face is i the normal factor on a face is the same on all quadrature points This type is not assigned for cells **There is no special information available for compressing the representation of the object under consideration **Definition of a structure that stores all cached data related to the evaluated geometry from the mapping In order to support hp adaptivity and compressed storage length can be different for different rows it allows to jump at the data of individual rows similar to compressed row storage in sparse matrices We have two different start indices for fields with different sizes The first category of offsets are the indices for Jacobians of the transformation from unit to real second JxW and normal vectors We keep separate arrays for all these data structures because a user code might access only some of them In such a one array will be gone through in a contiguous order with access to all which makes it easy for the processor to prefetch data Having all data in a single array would require some strides in the access which is much more complicated for the processor to called which contains the quadrature weights and permutations of how to go through quadrature points in case of face data The latter comes in a vector for the support of hp with several data fields for the individual quadrature formulas ***Constructor Does nothing **Set up the lengths in the various members of this struct **Set up the lengths in the various members of this struct **Returns the memory consumption in bytes **Number of quadrature points applied on the given cell or face **Original one dimensional quadrature formula applied on the given cell or face **Quadrature formula applied on the given cell or face **Quadrature weights separated by dimension for use in specific situations **A cached vector of quadrature weights in the given number the evaluation of basis functions is not in the correct order if a face is not in the standard orientation to a given element This data structure is used to re order the data evaluated on quadrature points to represent the correct order **A class describing the layout of the sections in the[2.x.2] field and also includes some data that depends on the number of quadrature points in the hp context such as the inner quadrature formula and re indexing for faces that are not in the standard orientation **Collection of quadrature formulae applied on the given face *Only filled for since faces might be quadrilateral or triangle shaped **Stores the index offset into the arrays[2.x.4][2.x.5][2.x.6] and the second derivatives Note that affine cells have shorter fields of where the others have lengths equal to the number of quadrature points of the given cell **The storage of the Jacobian i the inverse and transposed Jacobians of the transformation from the unit to the real cell Indexed by[2.x.9] Contains two fields for access from both sides for interior but the default only the upper diagonal and diagonal part are needed The first index runs through the starting with the diagonal and then continuing row i and so on The second index is the spatial coordinate Indexed by[2.x.12] Contains two fields for access from both sides for interior but the default including a compression scheme for Cartesian cells where we do not need to store the full data on all points Indexed by *[2.x.16] *Clears all data fields except the descriptor vector **Returns the quadrature index for a given number of quadrature points If not in hp mode or if the index is not this function always returns index this function does not check whether the given degree is actually present **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **Returns the memory consumption in bytes **The class that stores all geometry dependent data related with cell interiors for use in the matrix free class ***Compute the information in the given cells and faces The cells are specified by the level and the index within the a mapping and several quadrature formulas are given **Update the information in the given cells and faces that is the result of a change in the given mapping keeping the quadrature formulas and other unknowns unchanged This call is only valid if[2.x.20] has been called before **Return the type of a given cell as detected during initialization **Clear all data fields in this class **Return the memory consumption of this class in bytes **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **The given update flags for computing the geometry on the cells **The given update flags for computing the geometry on the boundary faces **The given update flags for computing the geometry on the interior faces **The given update flags for computing the geometry on the faces for cell centric loops **Stores whether a cell is has constant transform data() or is whether it represents an affine whether it is a flat face where the normal vector is the same throughout the or is following the[2.x.21] variable for the cell types **The pointer to the underlying[2.x.22] object **The pointer to the first entry of mapping_collection **Reference cell type related to each quadrature and active quadrature index **Internal function to compute the geometry for the case the mapping is a MappingQ and a single quadrature formula per i it uses a polynomial description of the cell especially when several different quadrature formulas are and consumes less memory[2.x.23] tria The triangulation to be used for setup[2.x.24] cells The actual cells of the triangulation to be worked given as a tuple of the level and index within the level as used in the main initialization of the class ::x faces The description of the connectivity from faces to cells as filled in the MatrixFree class **Computes the information in the given called within initialize **Computes the information in the given called within initialize **Computes the information in the given called within initialize **Helper function to determine which update flags must be set in the internal functions to initialize all data as requested by the user **A helper class to extract either cell or face data from mapping info for use in FEEvaluationBase **A class that is used to compare floating point c</div><div class="ttdef"><b>Definition:</b> <a href="mapping__info__0_8txt_source.html#l00116">mapping_info_0.txt:116</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html"><div class="ttname"><a href="classVectorizedArray.html">VectorizedArray&lt; Number &gt;</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE5_ORDER4</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00314">time_stepping.h:314</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_aa5d597e6c4441d273f4100b6139a2552"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#aa5d597e6c4441d273f4100b6139a2552">MatrixFree::AdditionalData::mapping_update_flags</a></div><div class="ttdeci">UpdateFlags mapping_update_flags</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00359">matrix_free.h:359</a></div></div>
<div class="ttc" id="anamespaceStep20_1_1PrescribedSolution_html_a2ec9d2a9c0f55b8fb13bd1c83c358e38"><div class="ttname"><a href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">Step20::PrescribedSolution::beta</a></div><div class="ttdeci">constexpr double beta</div><div class="ttdef"><b>Definition:</b> <a href="step-20_8cc_source.html#l00088">step-20.cc:88</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE9_ORDER5</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00326">time_stepping.h:326</a></div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a9d0b8a34fe5ca58425aa1fcf0d6132f1"><div class="ttname"><a href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a></div><div class="ttdeci">void channel_with_cylinder(Triangulation&lt; dim &gt; &amp;tria, const double shell_region_width=0.03, const unsigned int n_shells=2, const double skewness=2.0, const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a56019d263ae45708302d5d7599f0d458"><div class="ttname"><a href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a></div><div class="ttdeci">void hyper_rectangle(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Point&lt; dim &gt; &amp;p1, const Point&lt; dim &gt; &amp;p2, const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">Euler_DG::stage_5_order_4</a></div><div class="ttdeci">@ stage_5_order_4</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00074">step-67.cc:74</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a93f65b0385560a34ec1d3c5ec5a882b8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="aclassMatrixFree_html"><div class="ttname"><a href="classMatrixFree.html">MatrixFree</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00110">matrix_free.h:110</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a87493779c9eb3cd20bfda7ba815daeb4"><div class="ttname"><a href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">Euler_DG::euler_velocity</a></div><div class="ttdeci">Tensor&lt; 1, dim, Number &gt; euler_velocity(const Tensor&lt; 1, dim+2, Number &gt; &amp;conserved_variables)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00256">step-67.cc:256</a></div></div>
<div class="ttc" id="amatrix__free__0_8txt_html_a59b5310307cc6257314a3cdb8c40ab5a"><div class="ttname"><a href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a></div><div class="ttdeci">all[1.x.0] objects are available in any case **The loop does not involve any FEFaceEvaluation access into as is the case with only boundary integrals(but no interior face integrals) or when doing mass matrices in a[2.x.47] like setup. *[0.x.47] *The loop does only involve FEFaceEvaluation access into neighbors by function values</div></div>
<div class="ttc" id="adata__postprocessor__0_8txt_html_a80e53cb52e5dbb182dd14ee528927a77"><div class="ttname"><a href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a></div><div class="ttdeci">the current data is generated on a coarser mesh for the background color corresponds to the magnitude of the gradient vector and the vector glyphs to the gradient itself It may be surprising at first to see that from each multiple vectors going in different directions But that is because the solution is only the gradient is discontinuous across and so the multiple vectors originating from each vertex simply represent the differing gradients of the solution at each adjacent cell *The output above the gradient[2.x.114] of the solution **corresponds to the temperature gradient if one interpreted[2.x.115] as solving a steady state heat transfer problem It is very small in the central part of the domain because in[2.x.116] we are solving an equation that has a coefficient[2.x.117] that is large in the central part and small on the outside This can be thought as a material that conducts heat and consequently the temperature gradient is small On the other the heat flux corresponds to the quantity[2.x.118] For the solution of that the flux should be continuous across the interface This is easily verified by the following modification of the postprocessor</div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor__0_8txt_source.html#l00138">data_postprocessor_0.txt:138</a></div></div>
<div class="ttc" id="amemory__0_8txt_html_a308a0b2a49e2ae17e58937bcfde20e4e"><div class="ttname"><a href="memory__0_8txt.html#a308a0b2a49e2ae17e58937bcfde20e4e">need</a></div><div class="ttdeci">namespace provides functions that can be used to determine the memory consumption of objects For some simple classes like the standard library containers it directly determines how much memory they need(or at least gives an estimate). For deal.II classes</div></div>
<div class="ttc" id="alac_2affine__constraints_8h_html"><div class="ttname"><a href="lac_2affine__constraints_8h.html">affine_constraints.h</a></div></div>
<div class="ttc" id="adata__postprocessor__0_8txt_html_afb21caeba7bf26aba89ce705266fedb1"><div class="ttname"><a href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a></div><div class="ttdeci">note that this is only determined by the number of components in the finite element in and not by whether the data computed by a class derived from the current one is scalar or vector valued derived classes have to implement the get_names() function</div></div>
<div class="ttc" id="aconfig_8h_html_a1d1d58e8be15e5c4285f6892e5f33136"><div class="ttname"><a href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="ttdeci">#define DEAL_II_ALWAYS_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00096">config.h:96</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ac2b339f054fd752a401e197097db8cfe"><div class="ttname"><a href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a></div><div class="ttdeci">********clusters ***deal II can use multiple machines connected via MPI to parallelize in addition to the parallelization within a shared memory machine discussed in the[2.x.4] module There are essentially two ways to utilize multiple but only a share of the global sparsity and solution vector is stored on each machine ****The mesh and DoF handler are also i e each processor stores only a share of the cells and degrees of freedom No processor has knowledge of the entire or solution</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00025">distributed_0.txt:25</a></div></div>
<div class="ttc" id="aparameter__handler__0_8txt_html_ad919e2b915d8e8226aef004c2d8399a8"><div class="ttname"><a href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">exception</a></div><div class="ttdeci">since default values may change in the process of program you cannot know the values of parameters not specified in the input file ****It is often convenient to have something happen as soon as a parameter value is read This could be a check that it is valid that a file that is listed in the parameter file exists **or to initiate something else in such as setting a variable outside the this action could also be initiated once all parameters are read via but it is sometimes[1.x.19] to do it right away *This is facilitated by the and can then do whatever they want with it **e save it somewhere outside the ParameterHandler in C one doesn t usually pass around the address of a but an action can be a function like object(taking a string as argument) that results from calling such as a[1.x.20] that has the form **[1.x.21] *and that is attached to a specific parameter. *A typical example of such an action would be as follows the content of the file equals the default value of the parameter the contents of files are never changed after declaration of a parameter a directory in this file system may not have a file called[2.x.20] in it In that the directory represents a subsection as declared and the directory s name will correspond to the name of the subsection It will then have no files in it at but it may have further directories in the code above will lead to a hierarchical representation of data that looks like this(the content of files is indicated at the right in a different font) this is only used when creating output for exceptions If non empty[2.x.35] is the ParameterHandler object will stop parsing lines after encountering[2.x.36] This is handy when adding extra data that shall be parsed manually If[2.x.37] the parameter handler will skip undefined sections and entries This is useful for partially parsing a parameter for example to obtain only the spatial dimension of the problem By default all entries and subsections are expected to be declared The function sets the value of all parameters it encounters in the input file to the provided value Parameters not explicitly listed in the input file are left at the value they previously which will be the default value provided to and for each parameter all associated actions that may previously have been set by or if an associated action throws an exception</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler__0_8txt_source.html#l00241">parameter_handler_0.txt:241</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00266">dof_handler.h:266</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_ae6473a4a541eccc34d7ed017da171b46"><div class="ttname"><a href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">Euler_DG::euler_flux</a></div><div class="ttdeci">Tensor&lt; 1, dim+2, Tensor&lt; 1, dim, Number &gt; &gt; euler_flux(const Tensor&lt; 1, dim+2, Number &gt; &amp;conserved_variables)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00285">step-67.cc:285</a></div></div>
<div class="ttc" id="abase_2partitioner__0_8txt_html_a936b2264a337bdb80dd12b8f90f72767"><div class="ttname"><a href="base_2partitioner__0_8txt.html#a936b2264a337bdb80dd12b8f90f72767">partitioner</a></div><div class="ttdeci">*This class defines a model for the partitioning of a it includes a structure for the point to point communication patterns It allows the inclusion of ghost it also stores the other processors ghost indices belonging to the current which are the indices where other processors might require information from In a these import indices form the dual of the ghost indices This information is gathered once when constructing the partitioner</div><div class="ttdef"><b>Definition:</b> <a href="base_2partitioner__0_8txt_source.html#l00002">partitioner_0.txt:2</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">Euler_DG::stage_3_order_3</a></div><div class="ttdeci">@ stage_3_order_3</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00073">step-67.cc:73</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a676390618e4d4cade021c4edeac58b65"><div class="ttname"><a href="coding__conventions__0_8txt.html#a676390618e4d4cade021c4edeac58b65">parameter</a></div><div class="ttdeci">and someone else can make a mistake while calling myfunction In either I would like to write my code in such a way thaterrors ii that the compiler can alreadyfind some of the for example because the program aborts Defensiveprogramming is then a set of strategies that make these goals more likely *[2.x.85] Over we have learned a number of techniques to this some of whichwe list all the time As the prototypical consider a trivial implementation of vector this function will get into trouble if the two vectors do not have the same size You think it is silly to call this function with vectors of different size of course it is But it happens all the or it is reset in a different etc It happens So if you are in such an unlucky it can take a long time to figure out what s going on because you are likely to just read uninitialized or maybe you are writing to memory the[2.x.89] vector doesn t actually own Neither is going to lead to immediate termination of the but you ll probably get random errors at a later time It would be much easier if the program just stopped here right away The following implementation will do exactly and otherwise prints a string containing information encoded by the second argument and aborts the program This when you write a new program that happens to call this you will learn of your error right away and have the opportunity to fix it without ever having to seriously debug anything[2.x.91] As a general whenever you implement a new think about the[1.x.16] on parameter</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00065">coding_conventions_0.txt:65</a></div></div>
<div class="ttc" id="aclassConditionalOStream_html_a1f3eaad6ae78462bf20c05fe95cb710f"><div class="ttname"><a href="classConditionalOStream.html#a1f3eaad6ae78462bf20c05fe95cb710f">ConditionalOStream::get_stream</a></div><div class="ttdeci">std::ostream &amp; get_stream() const</div><div class="ttdef"><b>Definition:</b> <a href="base_2conditional__ostream_8h_source.html#l00178">conditional_ostream.h:178</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a></div><div class="ttdeci">@ component_is_part_of_vector</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__component__interpretation_8h_source.html#l00062">data_component_interpretation.h:62</a></div></div>
<div class="ttc" id="asolver__cg__0_8txt_html_a557c71e94a2542d697ca3426b8843cd4"><div class="ttname"><a href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">sqrt</a></div><div class="ttdeci">*This class implements the preconditioned Conjugate but is used in many other tutorial programs as well Like all other solver it can work on any kind of vector and matrix as long as they satisfy certain and defaults to *[2.x.2] **This version of CG is taken from D Braess s book Finite Elements It requires a symmetric the projected matrix[2.x.4] is tri diagonal Since the projection is the eigenvalues of[2.x.5] approximate those of the original preconditioned matrix[2.x.6] In after[2.x.7] where[2.x.8] is the dimension of the original the eigenvalues of both matrices are equal even for small numbers of iteration the condition number of[2.x.9] is a good estimate for the one of *[2.x.10] After[2.x.11] steps the matrix T_m can be written in terms of the coefficients[2.x.12] and[2.x.13] as the tri diagonal matrix with diagonal elements&lt; tt &gt;&lt; tt &gt; alpha_1 beta_0&lt; tt &gt;&lt; tt &gt; sqrt(beta_{m-2&lt;/tt &gt;)/alpha_</div><div class="ttdef"><b>Definition:</b> <a href="solver__cg__0_8txt_source.html#l00011">solver_cg_0.txt:11</a></div></div>
<div class="ttc" id="alac_2la__parallel__vector_8h_html"><div class="ttname"><a href="lac_2la__parallel__vector_8h.html">la_parallel_vector.h</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_a553ca864aaf70330d9be86bc78f36d1e"><div class="ttname"><a href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">DoFHandler::distribute_dofs</a></div><div class="ttdeci">void distribute_dofs(const FiniteElement&lt; dim, spacedim &gt; &amp;fe)</div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE3_ORDER3</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00308">time_stepping.h:308</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdeci">@ update_quadrature_points</div><div class="ttdoc">Transformed quadrature points.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00116">fe_update_flags.h:116</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a2cbf5ad6b464871261dbd054bced18a8"><div class="ttname"><a href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">FiniteElementData::degree</a></div><div class="ttdeci">const unsigned int degree</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__base_8h_source.html#l00428">fe_base.h:428</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_aa326b1a098e1c037334cc05bdc2decc6"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#aa326b1a098e1c037334cc05bdc2decc6">MatrixFree::AdditionalData::mapping_update_flags_boundary_faces</a></div><div class="ttdeci">UpdateFlags mapping_update_flags_boundary_faces</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00379">matrix_free.h:379</a></div></div>
<div class="ttc" id="abase_2function_8h_html"><div class="ttname"><a href="base_2function_8h.html">function.h</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_afdca3541da950e50d2e8dca2de4ceb90"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#afdca3541da950e50d2e8dca2de4ceb90">MatrixFree::AdditionalData::communicator_sm</a></div><div class="ttdeci">MPI_Comm communicator_sm</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00527">matrix_free.h:527</a></div></div>
<div class="ttc" id="aclassTimerOutput_html"><div class="ttname"><a href="classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2timer_8h_source.html#l00591">timer.h:591</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a33468e75b7ea6d2e64b7e88c6ff1217a"><div class="ttname"><a href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a></div><div class="ttdeci">namespace are implemented the way they are More information on their implementation can be found in the[2.x.72] WorkStream paper To see the WorkStream class used in practice on tasks like the ones outlined above take a look at or[2.x.78] tutorial programs *To begin given the brief description the way the[2.x.79] function could then be written is like this(note that this is not quite the correct syntax, as will be described below) we recycle these objects after they have been used by[2.x.101] and feed them back into another instance of[2.x.102]</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00171">multithreading_0.txt:171</a></div></div>
<div class="ttc" id="afe__abf__0_8txt_html_a16d10237466a81c6b65a05f16fc34644"><div class="ttname"><a href="fe__abf__0_8txt.html#a16d10237466a81c6b65a05f16fc34644">now</a></div><div class="ttdeci">*Implementation of Arnold Boffi conforming with the space H&lt; sup &gt; div&lt;/sup &gt; These elements generate vector fields with normal components continuous between mesh cells *These elements are based on an article from Boffi and SIAM J Numer Anal pp *In this the authors demonstrate that the usual RT elements and also BDM and other proposed finite dimensional subspaces of which are implemented in this module *This class is not implemented for the codimension one the definition of the node values relies on consistently oriented faces in care should be taken on complicated meshes **The[2.x.1] interpolation operators associated with the RT element are constructed such that interpolation and computing the divergence are commuting operations We require this from interpolating arbitrary functions as well as the **On edges or the[2.x.2] node values are the moments of the normal component of the interpolated function with respect to the traces of the RT polynomials Since the normal trace of the RT space of degree[1.x.2] on an edge face is the the moments are taken with respect to this space **Higher order RT spaces have interior nodes These are moments taken with respect to the gradient of functions in[1.x.5] on the which will be computed by quadrature rules themselves The generalized support points are a set of points such that this quadrature can be performed with sufficient accuracy The points needed are those of QGauss&lt; sub &gt; k&lt;/sub &gt; on each face as well as QGauss&lt; sub &gt; k&lt;/sub &gt; in the interior of the with[2.x.5] and[2.x.6] replaced by appropriate values **This function returns[2.x.7] if the shape function[2.x.8] has non zero function values somewhere on the face[2.x.9] Right now</div><div class="ttdef"><b>Definition:</b> <a href="fe__abf__0_8txt_source.html#l00022">fe_abf_0.txt:22</a></div></div>
<div class="ttc" id="anumerical__algorithms__0_8txt_html_a852a1e245dd2de4943eeb66beeaf65b1"><div class="ttname"><a href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a></div><div class="ttdeci">****This module groups a diverse set of classes that generally implement some sort of numerical algorithm on top all the basic and finite element classes in the library They are generally unconnected to each other *Some of the like KellyErrorEstimator and act on solutions already and compute derived quantities in the first two or help transferring a set of vectors from one mesh to another *The namespaces and VectorTools provide an assortment of such as creating a Laplace projecting or interpolating a function onto the present finite element etc The difference to the functions in the DoFTools and FETools functions is that they work on the DoFTools functions only act on a given DoFHandler object without reference to a data vector</div><div class="ttdef"><b>Definition:</b> <a href="numerical__algorithms__0_8txt_source.html#l00008">numerical_algorithms_0.txt:8</a></div></div>
<div class="ttc" id="anamespacetypes_html_aaf4eb6ec214fa642dfd956f11a9cd2d7"><div class="ttname"><a href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a></div><div class="ttdeci">unsigned int boundary_id</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00117">types.h:117</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a8cac1e477eff052db622c8a9a9426ea3"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">LAPACKSupport::T</a></div><div class="ttdeci">static const char T</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00177">lapack_support.h:177</a></div></div>
<div class="ttc" id="aauto__derivative__function__0_8txt_html_af5d8dd2d035de856717fb6b5c9438dd5"><div class="ttname"><a href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a></div><div class="ttdeci">*This class automatically computes the gradient of a function by employing numerical difference quotients This only if the user function does not provide the gradient function himself *The following example of an user defined function overloads and implements only the where the latter function employs numerical difference quotients *****If the user overloads and implements also the gradient of the users gradient function is called that the usage of the also applies to the see e g respectively *Furthermore that an object of this class does[1.x.1] represent the derivative of a like that gives a directional derivative by calling the this class the AutoDerivativeFunction class can substitute the Function class as base class for user defined classes This class implements the gradient() functions for automatic computation of numerical difference quotients and serves as intermediate class between the base Function class and the user defined function class. ***[2.x.2] **[0.x.1] *Names of difference formulas. *[0.x.2] *The symmetric Euler formula of second order absolutely necessary in this case **Choose the difference formula See the enum DifferenceFormula for available choices **Takes the difference step size&lt; tt &gt; h&lt;/tt &gt; It s within the user s responsibility to choose an appropriate value here&lt; tt &gt; h&lt;/tt &gt; should be chosen taking into account the absolute value of as well as the amount of variation of the function Setting&lt; tt &gt; h</div><div class="ttdef"><b>Definition:</b> <a href="auto__derivative__function__0_8txt_source.html#l00034">auto_derivative_function_0.txt:34</a></div></div>
<div class="ttc" id="aclassMapping_html"><div class="ttname"><a href="classMapping.html">Mapping</a></div><div class="ttdoc">Abstract base class for mapping classes. This class declares the interface for the functionality to d...</div><div class="ttdef"><b>Definition:</b> <a href="fe_2mapping_8h_source.html#l00270">mapping.h:270</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html"><div class="ttname"><a href="base_2logstream_8h.html">logstream.h</a></div></div>
<div class="ttc" id="aclassPoint_html_a25d858964d15e04ff371d8738a17ea33"><div class="ttname"><a href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">Point::operator*</a></div><div class="ttdeci">Point&lt; dim, typename ProductType&lt; Number, typename EnableIfScalar&lt; OtherNumber &gt;::type &gt;::type &gt; operator*(const OtherNumber) const</div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a5abc878123b65e2a7a16e57bba0e282e"><div class="ttname"><a href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal as happens in flow problems and is handled by the[2.x.11] function or prescribed tangential as happens in electromagnetic problems and is handled by the[2.x.13] function For the former imagine for example that we are at at vertex where the normal vector has the form[2.x.14] and that and[2.x.17] components of the flow field at this vertex are associated with degrees of and Then the no normal flux condition means that we need to have the condition[2.x.18] The prescribed tangential component leads to similar constraints though there is often something on the right hand side ****If you have hanging node constraints</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html">MatrixFree::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00173">matrix_free.h:173</a></div></div>
<div class="ttc" id="anamespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="origin_2base_2event_8h_source.html#l00149">event.h:149</a></div></div>
<div class="ttc" id="amg__transfer__0_8txt_html_a6b401cd9c6154fc787311f58ab910002"><div class="ttname"><a href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a></div><div class="ttdeci">MGTransferBase is defined in mg_base h ***Implementation of transfer between the global vectors and the multigrid levels for use in the derived class MGTransferPrebuilt and other classes ***Reset the object to the state it had right after the default constructor **Transfer from a vector on the global grid to vectors defined on each of the levels separately for the active degrees of freedom In for a globally refined mesh only the finest level in[2.x.0] is filled as a plain copy of[2.x.1] All the other level objects are left untouched **Transfer from multi level vector to normal vector Copies data from active portions of an MGVector into the respective positions of a&lt; tt &gt; Vector&lt; number &gt;&lt;/tt &gt; In order to keep the result constrained degrees of freedom are set to zero **Add a multi level vector to a normal vector Works as the previous but probably not for continuous elements **If this object operates on BlockVector we need to describe how the individual vector components are mapped to the blocks of a vector For for a Stokes we have dim vector components for velocity and pressure</div><div class="ttdef"><b>Definition:</b> <a href="mg__transfer__0_8txt_source.html#l00017">mg_transfer_0.txt:17</a></div></div>
<div class="ttc" id="amatrix__free_2operators_8h_html"><div class="ttname"><a href="matrix__free_2operators_8h.html">operators.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a></div><div class="ttdeci">@ component_is_scalar</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__component__interpretation_8h_source.html#l00055">data_component_interpretation.h:55</a></div></div>
<div class="ttc" id="adof__tools__0_8txt_html_a9442956f28da0afe6f6e41e15e33d525"><div class="ttname"><a href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a></div><div class="ttdeci">namespace the creation of the sparsity pattern is done by the it needs to have a numbering of all those degrees of freedom that are on those parts of the boundary that we are interested in You can get this from the where[2.x.10] and[2.x.11] are indices into the and[2.x.12] is the global DoF number of a degree of freedom sitting on a remember that these flags are used as elements of tables of size[2.x.16] times[2.x.17] where each element indicates whether two components do or do not couple **Two components do not couple **Two components do couple **Two components couple only if their shape functions are both nonzero on a given face This flag is only used when computing integrals over faces of e in[2.x.18] Use[2.x.19] in general cases where gradients etc occur on face integrals **DoF couplings *[2.x.21] *Map a coupling table from the user friendly organization by components to the organization by blocks The return vector will be initialized to the correct length inside this function **Given a finite element and a table how the vector components of it couple with each compute and return a table that describes how the individual shape functions couple with each other **Same function as above for a collection of finite returning a collection of tables The function currently treats[2.x.22] the same as *[2.x.23] ***Sparsity pattern generation *[2.x.26] *Compute which entries of a matrix built on the given[2.x.27] may possibly be and create a sparsity pattern object that represents these nonzero locations This function computes the possible positions of non zero entries in the global system matrix by[1.x.3] which entries one would write to during the actual assembly of a matrix For the function assumes that each finite element basis function is non zero on a cell only if its degree of freedom is associated with the a an edge or a vertex of this cell As a result</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__0_8txt_source.html#l00049">dof_tools_0.txt:49</a></div></div>
<div class="ttc" id="amapping__q__cache__0_8txt_html_ad70e0fe32f41f61653b79c84cbeedbee"><div class="ttname"><a href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a></div><div class="ttdeci">*This class implements a caching strategy for objects of the MappingQ family in terms of the[2.x.0] which is used in all operations of MappingQGeneric The information of the mapping is pre computed by the[2.x.1] function *The use of this class is discussed extensively in *[2.x.2] **Constructor[2.x.3] denotes the polynomial degree of the polynomials that are used to map cells from the reference to the real cell **Copy constructor **Destructor see *[2.x.4] *Returns[2.x.5] because the preservation of vertex locations depends on the mapping handed to the where[2.x.12] is the polynomial degree of the and it must be in the order the mapping or FE_Q sort their i all[2.x.13] vertex points then the points on the and hexes according to the usual hierarchical numbering No attempt is made to validate these points except for the number of given points *If multiple threads are this function will run in invoking the function passed in several times in case[2.x.15] the user code must make sure that the typically a lambda</div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__cache__0_8txt_source.html#l00024">mapping_q_cache_0.txt:24</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a"><div class="ttname"><a href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">Euler_DG::harten_lax_vanleer</a></div><div class="ttdeci">@ harten_lax_vanleer</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00083">step-67.cc:83</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_a7797f796c0be511fbc7f230ccc22532e"><div class="ttname"><a href="classDoFHandler.html#a7797f796c0be511fbc7f230ccc22532e">DoFHandler::get_triangulation</a></div><div class="ttdeci">const Triangulation&lt; dim, spacedim &gt; &amp; get_triangulation() const</div></div>
<div class="ttc" id="anamespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2matrix__block_8h_source.html#l00656">matrix_block.h:656</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdeci">@ update_normal_vectors</div><div class="ttdoc">Normal vectors.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00132">fe_update_flags.h:132</a></div></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2tensor_8h_source.html#l00441">tensor.h:441</a></div></div>
<div class="ttc" id="aclassLinearAlgebra_1_1distributed_1_1Vector_html_ace027311492ed2f6e07fbd74d723e3a9"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">LinearAlgebra::distributed::Vector::reinit</a></div><div class="ttdeci">void reinit(const size_type size, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="aclassDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="avector__0_8txt_html_aaf255149898cc5cea8c1fa1e76fffe6f"><div class="ttname"><a href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a></div><div class="ttdeci">0 v</div><div class="ttdef"><b>Definition:</b> <a href="vector__0_8txt_source.html#l00062">vector_0.txt:62</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a30a552b07accf65da90f851e25d14d1c"><div class="ttname"><a href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div><div class="ttdeci">3, where it offers following possibilities:a face(quad) being refined in x- or y-direction(in the face-intern coordinate system) separately,([2.x.79] or([2.x.80] which corresponds to([2.x.81]). Additionally, it offers the possibilities a face can have through repeated anisotropic refinement steps performed on one of the two neighboring cells. It might be possible for example, that a face(quad) is refined with[2.x.82] and afterwards the left child is again refined with[2.x.83], so that there are three active subfaces. Note, however, that only refinement cases are allowed such that each line on a face between two hexes has not more than one hanging node. Furthermore, it is not allowed that two neighboring hexes are refined such that one of the hexes refines the common face with[2.x.84] and the other hex refines that face with[2.x.85] . In fact,[2.x.86] takes care of this situation and ensures that each face of a refined cell is completely contained in a single face of neighboring cells. The following drawings explain the SubfacePossibilities and give the corresponding subface numbers:*[1.x.4] **[2.x.87] *[0.x.68] *Possible cases of faces being subdivided into subface. See documentation to the SubfacePossibilities&lt; 3 &gt; for more details on the subface possibilities. *[0.x.69] *A class that provides all possible cases a face(in the current space dimension[2.x.88] might be subdivided into subfaces. *[2.x.89] *[0.x.70] *Constructor. Take and store a value indicating a particular subface possibility in the list of possible situations specified in the base class. *[0.x.71] *Return the numeric value stored by this class. While the presence of this operator might seem dangerous, it is useful in cases where one would like to have code like&lt; code &gt;switch(subface_case)... case[2.x.90] ...&lt;/code &gt;, which can be written as&lt; code &gt;switch[2.x.91] Another application is to use an object of the current type as an index into an array dim</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00202">geometry_info_0.txt:202</a></div></div>
<div class="ttc" id="aclassVectorizedArrayBase_html_acb35404acc1693aee6e990228924cc09"><div class="ttname"><a href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayBase&lt; VectorizedArray&lt; Number, width &gt;, 1 &gt;::size</a></div><div class="ttdeci">static constexpr std::size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l00272">vectorization.h:272</a></div></div>
<div class="ttc" id="atime__dependent__0_8txt_html_ad268335339a0d9d7af4fdc68b28d7a4a"><div class="ttname"><a href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">round</a></div><div class="ttdeci">uses the functions[2.x.41] and[2.x.42] of the TimeStepBase class through the[2.x.43] function of this class Look ahead and look back are determined by the[2.x.44] object given to the constructor **Do a postprocessing round</div><div class="ttdef"><b>Definition:</b> <a href="time__dependent__0_8txt_source.html#l00081">time_dependent_0.txt:81</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_a5c25759917955940e0b2b74a6704012c"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#a5c25759917955940e0b2b74a6704012c">MatrixFree::AdditionalData::mapping_update_flags_inner_faces</a></div><div class="ttdeci">UpdateFlags mapping_update_flags_inner_faces</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00399">matrix_free.h:399</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a69730bc7f91dd1be17fd083a66514e73"><div class="ttname"><a href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a></div><div class="ttdeci">their purpose is merely to keepdeal II as uniform as possible Uniformity reduces the number of bugs weproduce because we for always assume that input arguments comebefore output arguments of a function call They also simplify reading codebecause some things become clear already by looking at the style a piece ofcode is without having to look up the exact definition of something **deal II uses[2.x.2] to normalize indentation Astyle file is provided at ***Before a you should run **on each of your files This will make sure indentation is conforming to thestyle guidelines outlined in this page *This is cumbersome and more you can just run **in whatever directory you set up the library to be compiled to indent allsource files that have been changed recently If you want to make sure thatthe indenting is correct for all your you might want to set up apre commit hook One way to do is to copy[2.x.4] to[2.x.5] and make sure it isexecutable *If the system you are working on has more than one version of[2.x.6] degrees of freedom</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00018">coding_conventions_0.txt:18</a></div></div>
<div class="ttc" id="aclassMatrixFreeOperators_1_1CellwiseInverseMassMatrix_html"><div class="ttname"><a href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2operators_8h_source.html#l00637">operators.h:637</a></div></div>
<div class="ttc" id="aclassparallel_1_1distributed_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_af85863b31be0cbd660acba99051e0634"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a></div><div class="ttdeci">****This module contains classes that are used in the exception mechanism of deal II **Exceptions are used in two different not in static assertions are typically used to check that parameters to functions satisfy certain that internal data structures are and similar assertions For static assertions are used to make sure that two vectors that are added together have the same number of components **everything else would not make any sense anyway *Such checks are performed by the[2.x.3] macro in several thousand places within the library several tutorial programs starting with[2.x.4] show how to do this *If static a assertion is the exception mechanism generates an exception of a type that indicates what exactly goes wrong displays appropriate information including the exact location where the problem was detected and then aborts the program **if you try to add two vectors of different there is nothing that can be done within the program to cope with the you have to go fix the program code instead There is generally not even a reason to[2.x.5] an exception object using the usual C exception mechanism because there is nothing a function higher up could do in such cases to rectify the situation and deal with it in a useful way **it s not that the program received bad data</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00015">exceptions_0.txt:15</a></div></div>
<div class="ttc" id="aclassAlignedVector_html"><div class="ttname"><a href="classAlignedVector.html">AlignedVector&lt; VectorizedArrayType &gt;</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">Euler_DG::stage_9_order_5</a></div><div class="ttdeci">@ stage_9_order_5</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00076">step-67.cc:76</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga9442b63275c9ef3fab29bc222831c49c"><div class="ttname"><a href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a></div><div class="ttdeci">#define AssertDimension(dim1, dim2)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01749">exceptions.h:1749</a></div></div>
<div class="ttc" id="aA-headers_2fe__0_8txt_html_abbd000c1bb0a029706ba0d8934597f39"><div class="ttname"><a href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a></div><div class="ttdeci">****All classes related to shape functions and to access to shape functions This concerns the actual values of finite elements For the numbering of degrees of freedom refer to the module on *[2.x.1] The classes and functions of this module fall into several sub groups that are discussed in their respective sub modules listed above In the FETools class provides functions that provide information on finite elements transformations between elements etc *In the grand scheme of the pieces of this module interact with a variety of other parts of the without actually implementing a concrete element For the FiniteElement base class declares the virtual functions a derived class has to implement if it wants to describe a finite element space Likewise the FiniteElementData holds variables that describe certain values characterizing a finite element such as the number of degrees of freedom per vertex line or face *On the other classes like FE_Poly and FE_PolyTensor are higher abstractions They describe finite elements that are built atop polynomial descriptions of the shape functions on the unit cell Classes derived from them then only have to provide a description of the particular polynomial from which a finite element is built For the FE_Q class that implements the usual Lagrange elements uses the FE_Poly base class to generate a finite element by providing it with a set of Lagrange interpolation polynomials corresponding to an equidistant subdivision of interpolation points the FESystem class is used for vector valued problems There one may want to couple a number of for Navier Stokes one may want to use three Q1 elements for the three components of the velocity</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2fe__0_8txt_source.html#l00021">fe_0.txt:21</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a5bee3b4914d1729bfe7d3781c2e1ecc1"><div class="ttname"><a href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">Euler_DG::n_global_refinements</a></div><div class="ttdeci">constexpr unsigned int n_global_refinements</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00060">step-67.cc:60</a></div></div>
<div class="ttc" id="aclassFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="anamespacenumbers_html_a4e5d3fa25689151c833ba46dcc96fa5b"><div class="ttname"><a href="namespacenumbers.html#a4e5d3fa25689151c833ba46dcc96fa5b">numbers::internal_face_boundary_id</a></div><div class="ttdeci">const types::boundary_id internal_face_boundary_id</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00227">types.h:227</a></div></div>
<div class="ttc" id="afe_2fe__0_8txt_html_a754f79d53a1f0ebfe04ff6b9ff4abb8a"><div class="ttname"><a href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a></div><div class="ttdeci">we cannot already compute the gradients on a concrete cell at the time the current function is but we can at least pre compute the gradients on the reference and store it in the object returned An extensive discussion of the interaction between this function and FEValues can be found in the[2.x.376] documentation module See also the documentation of the InternalDataBase class[2.x.377] update_flags A set of UpdateFlags values that describe what kind of information the FEValues object requests the finite element to compute This set of flags may also include information that the finite element can not compute</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__0_8txt_source.html#l00547">fe_0.txt:547</a></div></div>
<div class="ttc" id="afe_2fe__system_8h_html"><div class="ttname"><a href="fe_2fe__system_8h.html">fe_system.h</a></div></div>
<div class="ttc" id="aclassEuler__DG_1_1EulerOperator_html_aae07d964990108d9f0b51995835e4a10"><div class="ttname"><a href="classEuler__DG_1_1EulerOperator.html#aae07d964990108d9f0b51995835e4a10">Euler_DG::EulerOperator::EulerOperator</a></div><div class="ttdeci">EulerOperator(TimerOutput &amp;timer_output)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00502">step-67.cc:502</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_add141cdc4d28d06d71948acb7f0c7150"><div class="ttname"><a href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a></div><div class="ttdeci">each of these vectors has[2.x.174] elements containing the values of the[2.x.175] velocities and the one pressure at a quadrature point *We can use these values to then construct other things like residuals the construct is a bit awkward we have a[2.x.176] s</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00155">vector_valued_0.txt:155</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_a2b24e414d1a0d32deea919c5e8899811"><div class="ttname"><a href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div><div class="ttdeci">([1.x.8]&lt; sub &gt;1&lt;/sub &gt;, [1.x.9]&lt; sub &gt;2&lt;/sub &gt;, [1.x.10]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt; and[1.x.11] accordingly. Then, we can write the simplified equation in coordinates as[1.x.12] We see, that this is just three copies of the bilinear form of the Laplacian, one applied to each component(this is where the formulation with the[2.x.33] is more exciting, and we want to derive a framework that applies to that one as well). We can make this weak form a system of differential equations again by choosing special test functions:first, choose[1.x.13]=([1.x.14]&lt; sub &gt;1&lt;/sub &gt;, 0, 0)&lt; sup &gt;T&lt;/sup &gt;, then[1.x.15]=(0, [1.x.16]&lt; sub &gt;2&lt;/sub &gt;, 0)&lt; sup &gt;T&lt;/sup &gt;, and finally[1.x.17]=(0, 0, [1.x.18]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt;. writing the outcomes below each other, we obtain the system[1.x.19] where we used the standard inner product notation[2.x.34] . It is important for our understanding, that we keep in mind that the latter form as a system of PDE is completely equivalent to the original definition of the bilinear form[1.x.20]([1.x.21], [1.x.22]), which does not immediately exhibit this system structure. Let us close by writing the full system of the elastic equation with symmetric gradient[1.x.23]:[1.x.24] Very formally, if we believe in operator valued matrices, we can rewrite this in the form[1.x.25]&lt; sup &gt;T&lt;/sup &gt;[1.x.26]=[1.x.27]&lt; sup &gt;T&lt;/sup &gt;[1.x.28] or[1.x.29] *[1.x.30] Now, let us consider a more complex example, the mixed Laplace equations discussed in[2.x.35] in three dimensions:[1.x.31] **Here, we have four solution components:the scalar pressure[2.x.36] and the vector-valued velocity[2.x.37] with three vector components. Note as important difference to the previous example, that the vector space[1.x.32] is not just simply a copy of three identical spaces/*A systematic way to get a weak or variational form for this and other vector problems is to first consider it as a problem where the operators and solution variables are written in vector and matrix form. For the example, this would read as follows:[1.x.33] **This makes it clear that the solution[1.x.34] *indeed has four components. We note that we could change the ordering of the solution components[2.x.38] and[2.x.39] inside[2.x.40] if we also change columns of the matrix operator.*Next, we need to think about test functions[2.x.41] . We want to multiply both sides of the equation with them, then integrate over[2.x.42] . The result should be a scalar equality. We can achieve this by choosing[2.x.43] also vector valued as[1.x.35] **It is convenient to multiply the matrix-vector equation by the test function from the left, since this way we automatically get the correct matrix later on(in the linear system, the matrix is also multiplied from the right with the solution variable, not from the left), whereas if we multiplied from the right then the matrix so assembled is the transpose of the one we really want. *With this in mind, let us multiply by[2.x.44] and integrate to get the following equation which has to hold for all test functions[2.x.45] :[1.x.36] *or equivalently:[1.x.37] ***We get the final form by integrating by part the second term:[1.x.38] **It is this form that we will later use in assembling the discrete weak form into a matrix and a right hand side vector:the form in which we have solution and test functions[2.x.46] that each consist of a number of vector components that we can extract. **[2.x.47] VVFEs[1.x.39] *Once we have settled on a bilinear form and a functional setting, we need to find a way to describe the vector-valued finite element spaces from which we draw solution and test functions. This is where the FESystem class comes in:it composes vector-valued finite element spaces from simpler ones. In the example of the elasticity problem, we need[2.x.48] copies of the same element, for instance **[1.x.40] *This will generate a vector valued space of dimension[2.x.49], where each component is a continuous bilinear element of type FE_Q. It will have[2.x.50] times as many basis functions as the corresponding FE_Q, and each of these basis functions is a basis function of FE_Q, lifted into one of the components of the vector. *For the mixed Laplacian, the situation is more complex. First, we have to settle on a pair of discrete spaces[2.x.51] . One option would be the stable Raviart-Thomas pair **[1.x.41] *The first element in this system is already a vector valued element of dimension[2.x.52], while the second is a regular scalar element. *Alternatively to using the stable Raviart-Thomas pair, we could consider a stabilized formulation for the mixed Laplacian, for instance the LDG method. There, we have the option of using the same spaces for velocity components and pressure, namely **[1.x.42] *This system just has[2.x.53] equal copies of the same discontinuous element, which not really reflects the structure of the system. Therefore, we prefer **[1.x.43] *Here, we have a system of two elements, one vector-valued and one scalar, very much like with the[2.x.54] . Indeed, in many codes, the two can be interchanged. This element also allows us easily to switch to an LDG method with lower order approximation in the velocity, namely **[1.x.44] *It must be pointed out, that this element is different from **[1.x.45] *While the constructor call is very similar to[2.x.55], the result actually resembles more[2.x.56] in that this element produces[2.x.57] independent components. A more detailed comparison of the resulting FESystem objects is below. *[1.x.46] *FESystem has a few internal variables which reflect the internal structure set up by the constructor. These can then also be used by application programs to give structure to matrix assembling and linear algebra. We give the names and values of these variables for the examples above in the following table:&lt; table border=&quot;1&quot;&gt;&lt; tr &gt;&lt; th &gt;System Element&lt;/th &gt;[2.x.58][2.x.59][2.x.60]&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.61]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.62]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.63]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.64]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.65]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt;/table &gt; *From this table, it is clear that the FESystem reflects a lot of the structure of the system of differential equations in the cases of the[2.x.66] and the[2.x.67], in that we have a vector valued and a scalar variable. On the other hand, the convoluted elements do not have this structure and we have to reconstruct it somehow when assembling systems, as described below. *At this point, it is important to note that nesting of two FESystem object can give the whole FESystem a richer structure than just concatenating them. This structure can be exploited by application programs, but is not automatically so. *[2.x.68] VVAssembling[1.x.47] The next step is to assemble the linear system. How to do this for the simple case of a scalar problem has been shown in many tutorial programs, starting with[2.x.69] . Here we will show how to do it for vector problems. Corresponding to the different characterizations of weak formulations above and the different system elements created, we have a few options which are outlined below. *The whole concept is probably best explained by showing an example illustrating how the local contribution of a cell to the weak form of above mixed Laplace equations could be assembled. *[1.x.48] This is essentially how[2.x.70] does it:**[1.x.49] **So here 's what is happening:[2.x.71][2.x.72] The first thing we do is to declare &quot;extractors&quot;(see the FEValuesExtractors namespace). These are objects that don 't do much except store which components of a vector-valued finite element constitute a single scalar component, or a tensor of rank 1(i.e. what we call a &quot;physical vector&quot;, always consisting of[2.x.73] components). Here, we declare an object that represents the velocities consisting of[2.x.74] components starting at component zero, and the extractor for the pressure, which is a scalar component at position[2.x.75] . *[2.x.76] We then do our usual loop over all cells, shape functions, and quadrature points. In the innermost loop, we compute the local contribution of a pair of shape functions to the global matrix and right hand side vector. Recall that the cell contributions to the bilinear form(i.e. neglecting boundary terms) looked as follows, based on shape functions[2.x.77] :[1.x.50] *whereas the implementation looked like this:*[1.x.51] *The similarities are pretty obvious. *[2.x.78] Essentially, what happens in above code is this:when you do[2.x.79], a so-called &quot;view&quot; is created, i.e. an object that unlike the full FEValues object represents not all components of a finite element, but only the one(s) represented by the extractor object[2.x.80] or[2.x.81] . *[2.x.82] These views can then be asked for information about these individual components. For example, when you write[2.x.83] you get the value of the pressure component of the[2.x.84] th shape function[2.x.85] at the[2.x.86] th quadrature point. Because the extractor[2.x.87] represents a scalar component, the results of the operator[2.x.88] is a scalar number. On the other hand, the call[2.x.89] would produce the value of a whole set of[2.x.90] components, which would be of type[2.x.91] . *[2.x.92] Other things that can be done with views is to ask for the gradient of a particular shape function 's components described by an extractor. For example,[2.x.93] would represent the gradient of the scalar pressure component, which is of type[2.x.94], whereas the gradient of the velocities components,[2.x.95] is a[2.x.96], i.e. a matrix[2.x.97] that consists of entries[2.x.98] . Finally, both scalar and vector views can be asked for the second derivatives(&quot;Hessians&quot;) and vector views can be asked for the symmetric gradient, defined as[2.x.99] as well as the divergence[2.x.100] .[2.x.101] Other examples of using extractors and views are shown in tutorial programs[2.x.102],[2.x.103],[2.x.104] and several other programs. ***[2.x.105] In the current context, when we talk about a vector(for example in extracting the velocity components above), we mean the word in the sense physics uses it:it has[2.x.106] components that behave in specific ways under coordinate system transformations. Examples include velocity or displacement fields. This is opposed to how mathematics uses the word &quot;vector&quot;(and how we use this word in other contexts in the library, for example in the Vector class), where it really stands for a collection of numbers. An example of this latter use of the word could be the set of concentrations of chemical species in a flame x</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00090">vector_valued_0.txt:90</a></div></div>
<div class="ttc" id="achunk__sparse__matrix__0_8txt_html_ad43ded305d7756c82052fec150fdf5dd"><div class="ttname"><a href="chunk__sparse__matrix__0_8txt.html#ad43ded305d7756c82052fec150fdf5dd">transpose</a></div><div class="ttdeci">if any of the entries should happen to be it is counted anyway **Return the number of actually nonzero elements of this matrix that this function you should be aware that it may change if you call any nonconstant function of objects which operate on it **Determine an estimate for the memory it is allowed to store zero values in non existent fields **Add&lt; tt &gt; value&lt;/tt &gt; to the it is allowed to store zero values in non existent fields **Add an array of values given by&lt; tt &gt; values&lt;/tt &gt; in the given global matrix row at columns specified by col_indices in the sparse matrix The optional parameter&lt; tt &gt; elide_zero_values&lt;/tt &gt; can be used to specify whether zero values should be added anyway or these should be filtered away and only non zero data is added The default value is&lt; tt &gt; i zero values won t be added into the matrix **Multiply the entire matrix by a fixed factor **Divide the entire matrix by a fixed factor **Symmetrize the matrix by forming the mean value between the existing matrix and its transpose</div><div class="ttdef"><b>Definition:</b> <a href="chunk__sparse__matrix__0_8txt_source.html#l00176">chunk_sparse_matrix_0.txt:176</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a55c27d06e5e51d70be744612e5cfaf45"><div class="ttname"><a href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">Euler_DG::EulerNumericalFlux</a></div><div class="ttdeci">EulerNumericalFlux</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00080">step-67.cc:80</a></div></div>
<div class="ttc" id="astructDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2data__out__base_8h_source.html#l01065">data_out_base.h:1065</a></div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="aclassEuler__DG_1_1ExactSolution_html_a16ae78e70f688acd015b407649997f1b"><div class="ttname"><a href="classEuler__DG_1_1ExactSolution.html#a16ae78e70f688acd015b407649997f1b">Euler_DG::ExactSolution::value</a></div><div class="ttdeci">virtual double value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00105">step-67.cc:105</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_adc634dce0c07c9dbb94d367c8d97afd3"><div class="ttname"><a href="namespaceEuler__DG.html#adc634dce0c07c9dbb94d367c8d97afd3">Euler_DG::dimension</a></div><div class="ttdeci">constexpr unsigned int dimension</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00059">step-67.cc:59</a></div></div>
<div class="ttc" id="agroup__CUDAWrappers_html_ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399"><div class="ttname"><a href="group__CUDAWrappers.html#ggac8e56c1f8d3d4947aa030c9d14308a3bac07e853b466b568f61e6d93aaf6f8399">CUDAWrappers::internal::evaluate_evenodd</a></div><div class="ttdeci">@ evaluate_evenodd</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2cuda__tensor__product__kernels_8h_source.html#l00046">cuda_tensor_product_kernels.h:46</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a06c22b6c094649ae4190e006e4598f54"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a></div><div class="ttdeci">in the complex step the imaginary value effectively serves this purpose The choice of the perturbation parameter determines the numerical qualities of the scheme</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00058">automatic_and_symbolic_differentiation_0.txt:58</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_ae1cc4c5ec49b9998f5dc924707c29ed4"><div class="ttname"><a href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">Euler_DG::final_time</a></div><div class="ttdeci">constexpr double final_time</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00067">step-67.cc:67</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_a03a2f48682e29e39f7bccc11a7d1c4d1"><div class="ttname"><a href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has degree[1.x.4]</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00003">polynomial_space_0.txt:3</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a96ecfde131843f52ee49d0e0c1180134"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of and gets compile time</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a></div><div class="ttdeci">@ values</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__flags_8h_source.html#l00055">evaluation_flags.h:55</a></div></div>
<div class="ttc" id="anamespaceMatrixFreeTools_html_ae034b98c0db11285fae23a08ef3f197f"><div class="ttname"><a href="namespaceMatrixFreeTools.html#ae034b98c0db11285fae23a08ef3f197f">MatrixFreeTools::categorize_by_boundary_ids</a></div><div class="ttdeci">void categorize_by_boundary_ids(const Triangulation&lt; dim &gt; &amp;tria, AdditionalData &amp;additional_data)</div></div>
<div class="ttc" id="afe__bdm__0_8txt_html_a29a2868f8e5db6bbcae785d183329b77"><div class="ttname"><a href="fe__bdm__0_8txt.html#a29a2868f8e5db6bbcae785d183329b77">equal</a></div><div class="ttdeci">*The Brezzi Douglas Marini element **The version exhibits some numerical in particular for higher order *Restriction matrices are missing *The matching pressure space for FE_BDM of order[1.x.1] is the element FE_DGP of order *[1.x.2] The BDM element of order[2.x.2] has[1.x.3] degrees of freedom on each face These are implemented as the function values in the[1.x.4] Gauss points on each face for order greater or equal</div><div class="ttdef"><b>Definition:</b> <a href="fe__bdm__0_8txt_source.html#l00008">fe_bdm_0.txt:8</a></div></div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="agrid_2tria__accessor_8h_html"><div class="ttname"><a href="grid_2tria__accessor_8h.html">tria_accessor.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="aclassDataOutInterface_html_a5df488dad82b811ceb08cb1adf9eafcd"><div class="ttname"><a href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel</a></div><div class="ttdeci">void write_vtu_in_parallel(const std::string &amp;filename, const MPI_Comm &amp;comm) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07254">data_out_base.cc:7254</a></div></div>
<div class="ttc" id="adistributed_2tria_8h_html"><div class="ttname"><a href="distributed_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints&lt; double &gt;</a></div></div>
<div class="ttc" id="aeigen__0_8txt_html_a31a872680c9082cbe8bf86c82a743059"><div class="ttname"><a href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a></div><div class="ttdeci">*Power the iteration vectors will become aligned to its eigenspace and *[2.x.1] A shift parameter allows to shift the so it is possible to compute the smallest too *Convergence of this method is known to be slow ***Declare type of container size **Standardized data struct to pipe additional data to the solver **Shift parameter This parameter allows to shift the spectrum to compute a different eigenvalue **Constructor Set the shift parameter **Constructor **Power method[2.x.2] is is the approximated eigenvalue and[2.x.4] is the corresponding eigenvector</div><div class="ttdef"><b>Definition:</b> <a href="eigen__0_8txt_source.html#l00019">eigen_0.txt:19</a></div></div>
<div class="ttc" id="astructinternal_1_1FEEvaluationImplBasisChange_html"><div class="ttname"><a href="structinternal_1_1FEEvaluationImplBasisChange.html">internal::FEEvaluationImplBasisChange</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__kernels_8h_source.html#l00851">evaluation_kernels.h:851</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a9e95f82901b9cff1c83f61cc1851e876"><div class="ttname"><a href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">Euler_DG::lsrk_scheme</a></div><div class="ttdeci">constexpr LowStorageRungeKuttaScheme lsrk_scheme</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00078">step-67.cc:78</a></div></div>
<div class="ttc" id="aclassTimeStepping_1_1LowStorageRungeKutta_html"><div class="ttname"><a href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00678">time_stepping.h:678</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdeci">@ update_JxW_values</div><div class="ttdoc">Transformed quadrature weights.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00124">fe_update_flags.h:124</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html"><div class="ttname"><a href="namespaceEuler__DG.html">Euler_DG</a></div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00054">step-67.cc:54</a></div></div>
<div class="ttc" id="abase_2conditional__ostream_8h_html"><div class="ttname"><a href="base_2conditional__ostream_8h.html">conditional_ostream.h</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a895dcd8223a0ee6f0e6a80b80e2d5982"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a></div><div class="ttdeci">unsigned int this_mpi_process(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00128">mpi.cc:128</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">Euler_DG::stage_7_order_4</a></div><div class="ttdeci">@ stage_7_order_4</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00075">step-67.cc:75</a></div></div>
<div class="ttc" id="amatrix__free_2matrix__free_8h_html"><div class="ttname"><a href="matrix__free_2matrix__free_8h.html">matrix_free.h</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a97f5a52d591176fc9a31d4a477760a4a"><div class="ttname"><a href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">Euler_DG::evaluate_function</a></div><div class="ttdeci">VectorizedArray&lt; Number &gt; evaluate_function(const Function&lt; dim &gt; &amp;function, const Point&lt; dim, VectorizedArray&lt; Number &gt;&gt; &amp;p_vectorized, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00377">step-67.cc:377</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a17955af7a4bc8771d430e622f9e732b3"><div class="ttname"><a href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a></div><div class="ttdeci">Number truncate_to_n_digits(const Number number, const unsigned int n_digits)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00581">utilities.cc:581</a></div></div>
<div class="ttc" id="afe__q__0_8txt_html_a1a8eaafa20c4d8c9ab128b62a984738c"><div class="ttname"><a href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a></div><div class="ttdeci">*Implementation of a scalar Lagrange finite element[2.x.0] that yields the finite element space of piecewise polynomials of degree[2.x.1] in each coordinate direction This class is realized using tensor product polynomials based on D Lagrange polynomials with Gauss or given support points *The standard constructor of this class takes the degree[2.x.2] of this finite element it can take a quadrature formula[2.x.3] defining the support points of the Lagrange interpolation in one coordinate direction *For more information about the&lt; tt &gt; spacedim&lt;/tt &gt; template parameter check the documentation of FiniteElement or the one of Triangulation **The constructor creates a TensorProductPolynomials object that includes the tensor product of[2.x.4] polynomials of degree[2.x.5] This[2.x.6] object provides all values and derivatives of the shape functions In case a quadrature rule is the constructor creates a TensorProductPolynomials object that includes the tensor product of[2.x.7] polynomials with the support points from *[2.x.8] Furthermore the constructor fills the[2.x.9] the[2.x.10] equidistant support points at i where one polynomial is one and all the others are zero For higher polynomial degrees</div><div class="ttdef"><b>Definition:</b> <a href="fe__q__0_8txt_source.html#l00009">fe_q_0.txt:9</a></div></div>
<div class="ttc" id="astructMatrixFree_1_1AdditionalData_html_a0bcce2facca91b925d3e1a5a00c7704b"><div class="ttname"><a href="structMatrixFree_1_1AdditionalData.html#a0bcce2facca91b925d3e1a5a00c7704b">MatrixFree::AdditionalData::tasks_parallel_scheme</a></div><div class="ttdeci">TasksParallelScheme tasks_parallel_scheme</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2matrix__free_8h_source.html#l00333">matrix_free.h:333</a></div></div>
<div class="ttc" id="adofs_2dof__handler_8h_html"><div class="ttname"><a href="dofs_2dof__handler_8h.html">dof_handler.h</a></div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_ac8b7167f13d273c0000a680958db42c5"><div class="ttname"><a href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a></div><div class="ttdeci">this property does not hold for the shape functions of Raviart Thomas which must be rotated with the cell This allows further optimization of the computations underlying assembly ***Let s say you want to compute the Laplace matrix as shown above In that you need to specify the[2.x.20] the finite element requires the computation of the inverse of the full Jacobian and not just the determinant of the and to compute the inverse of the it is also necessary to compute the Jacobian matrix first *Since these are requirements that are not important to the it is not necessary to specify this in user code given a set of update flags</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00026">update_flags_0.txt:26</a></div></div>
<div class="ttc" id="adata__out__base__0_8txt_html_a4baf3a79030f53d8ecd9bd4e5a688bbb"><div class="ttname"><a href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div><div class="ttdeci">for&lt; tt &gt;&lt; tt &gt;&lt; tt &gt; etc The actual location of these points on the patch will be computed by a multilinear transformation from the vertices given for this patch For cells at the a mapping might be used to calculate the position of the inner points In that case the coordinates are stored inside the as they cannot be easily recovered otherwise *Given these the actual data to be printed on this patch of points consists of several data sets each of which has a value at each of the patch points For example with&lt; tt &gt; each data set has to provide nine and since the patch is to be printed as a tensor its values are to be ordered i e the z coordinate runs then the y then the patches as explained above might be too restricted For one might want to draw only the outer faces of a domain in a three dimensional if one is not interested in what happens inside the objects that should be drawn are two dimensional in a three dimensional world The Patch class and associated output functions handle these cases The Patch class therefore takes two template parameters the first named&lt; tt &gt; dim&lt;/tt &gt; denoting the dimension of the while the second</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base__0_8txt_source.html#l00016">data_out_base_0.txt:16</a></div></div>
<div class="ttc" id="asparse__decomposition__0_8txt_html_aa36e69f7b51d00cbf24c899c1490950c"><div class="ttname"><a href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a></div><div class="ttdeci">Preconditioners *[2.x.1] **Abstract base class for incomplete decompositions of a sparse matrix into sparse factors This class can t be used by itself but only as the base class of derived classes that actually implement particular decompositions such as SparseILU or SparseMIC *The decomposition is stored as a sparse matrix which is why this class is derived from the SparseMatrix Since it is not a matrix in the usual the derivation is&lt; tt &gt; protected&lt;/tt &gt; rather than&lt; tt &gt; public&lt;/tt &gt; ***Sparse decompositions are frequently used with additional fill i the sparsity structure of the decomposition is denser than that of the matrix to be decomposed The i e the sparsity pattern of the decomposition is a superset of the sparsity pattern in the original matrix *Such fill in can be accomplished by various one of which is the copy constructor of the SparsityPattern class that allows the addition of side diagonals to a given sparsity structure ***While objects of this class can not be used derived classes such as SparseILU and SparseMIC can be used in the usual form as preconditioners For this each it copies the sparsity of[2.x.3] and adds a specific number of extra off diagonal entries specified by *[2.x.4] By setting[2.x.5] the sparsity is not recreated but the sparsity of the previous as for example several Newton iteration steps on the same triangulation The default is *[2.x.6] It is possible to give a user defined sparsity to[2.x.7] no sparsity is created but[2.x.8] is used to store the decomposed matrix For restrictions on the sparsity see section Fill in above ***It is enough to override the like the true or the Cholesky decomposition if that decomposition needs fine tuned diagonal strengthening on a per row it may override the but only its derived classes **Deletes all member variables Leaves the class in the state that it had directly after calling the constructor **Parameters for SparseDecomposition **Constructor For the parameters see below **times the sum of absolute row entries is added to the diagonal entries Per this value is i e the diagonal is not strengthened **By the[2.x.10] function creates its own sparsity This sparsity has the same SparsityPattern as[2.x.11] with some extra off diagonals the number of which is specified by[2.x.12] The user can give a SparsityPattern to[2.x.13] Then this sparsity is used and the[2.x.14] argument is ignored **If this flag is true the as for example several Newton iteration steps on the same triangulation **When a SparsityPattern is given to this the as well as filtering out some elements in the matrix **This function needs to be called before an object of this class is used as preconditioner For more detail about possible parameters see the class documentation and the documentation of the[2.x.17] class According to this function creates a new SparsityPattern or keeps the previous sparsity or takes the sparsity given by the user to[2.x.19] this function performs the LU decomposition After this function is called the preconditioner is ready to be determines the strengthening factor(through get_strengthen_diagonal()) sf and multiplies the diagonal entry with[2.x.28] . *[0.x.23] *In the decomposition phase</div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a15a97d9432812b335c3cd599fab65eb0"><div class="ttname"><a href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">Euler_DG::courant_number</a></div><div class="ttdeci">const double courant_number</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00070">step-67.cc:70</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ac26de0c059200523177bb1d92cc25d00"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a></div><div class="ttdeci">unsigned int n_mpi_processes(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00117">mpi.cc:117</a></div></div>
<div class="ttc" id="abase_2vectorization_8h_html"><div class="ttname"><a href="base_2vectorization_8h.html">vectorization.h</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a2c18ee2cbc27a18e5d9d4565bf6848e8"><div class="ttname"><a href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">Euler_DG::fe_degree</a></div><div class="ttdeci">constexpr unsigned int fe_degree</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00061">step-67.cc:61</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a6365596c7d2490c474cd0b7ce9722b37"><div class="ttname"><a href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a></div><div class="ttdeci">it does so for both DoFHandler and[2.x.14] objects Note that the DoFAccessor class is derived from either TriaAccessor or the DoFAccessor class comes in two flavors one accessing degrees of freedom on the level of a cell and the other accessing the active dofs of an active cell **The DoFCellAccessor class has the same purpose and relation to DoFCellAccessor as the CellAccessor has to TriaAccessor *Except to look up member you will not usually have to deal withthe actual class names listed above Rather one uses the typedefs provided bythe mesh classes Triangulation DoFHandler and[2.x.15] as wellas the function that generate such buta hexahedron there are corresponding types and calls like[2.x.34] that act on thedimension independent geometric objects and hex These calls</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00076">iterators_0.txt:76</a></div></div>
<div class="ttc" id="acuda__matrix__free__0_8txt_html_a747ffbda88fa48702c72f4b04f9c5721"><div class="ttname"><a href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a></div><div class="ttdeci">*This class collects all the data that is stored for the matrix free implementation The storage scheme is tailored towards several loops performed with the same data i e typically doing many matrix vector products or residual computations on the same mesh This class does not implement any operations involving finite element basis functions i e regarding the operation performed on the cells For these operations the class FEEvaluation is designed to use the data collected in this class This class implements a loop over all which implies that it is possible to write to vectors in parallel without having to explicitly synchronize access to these vectors and matrices This class does not implement any shape values all it does is to cache the respective data To implement finite element operations use the class[2.x.0] This class traverse the cells in a different order than the usual Triangulation class in deal II *Only float and double are supported ***Parallelization scheme parallelization over degrees of freedom or over cells **This flag is used to determine which quantities should be cached This class can cache data needed for gradient Jacobian quadrature points as well as data for only data for gradients and Jacobian determinants times quadrature JxW</div><div class="ttdef"><b>Definition:</b> <a href="cuda__matrix__free__0_8txt_source.html#l00014">cuda_matrix_free_0.txt:14</a></div></div>
<div class="ttc" id="aprecondition__block__base__0_8txt_html_aba039b811c123042272605d7c7c7c726"><div class="ttname"><a href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a></div><div class="ttdeci">*A class storing the inverse diagonal blocks for block preconditioners and block relaxation methods *This class does the book keeping for preconditioners and relaxation methods based on inverting blocks on the diagonal of a matrix It allows us to either store all diagonal blocks and their inverses or the same block for each entry and it keeps track of the choice Thus after initializing it and filling the inverse diagonal blocks correctly a derived class can use inverse() with an integer argument referring to the block number. *Additionally</div></div>
<div class="ttc" id="anamespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa13fcf221bed4879f9b319347525f703b"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa13fcf221bed4879f9b319347525f703b">internal::EvaluatorQuantity::hessian</a></div><div class="ttdeci">@ hessian</div></div>
<div class="ttc" id="amatrix__free_2fe__evaluation_8h_html"><div class="ttname"><a href="matrix__free_2fe__evaluation_8h.html">fe_evaluation.h</a></div></div>
<div class="ttc" id="aclassConditionalOStream_html"><div class="ttname"><a href="classConditionalOStream.html">ConditionalOStream</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2conditional__ostream_8h_source.html#l00083">conditional_ostream.h:83</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a8ae36952c7e0cc778b47b5371b3aeff1"><div class="ttname"><a href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a></div><div class="ttdeci">static const unsigned int invalid_unsigned_int</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00179">types.h:179</a></div></div>
<div class="ttc" id="ascalapack__0_8txt_html_ac82ea4a38e10783662981895e0a99f43"><div class="ttname"><a href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div><div class="ttdeci">*A wrapper class around ScaLAPACK parallel dense linear algebra *ScaLAPACK assumes that matrices are distributed according to the block cyclic decomposition scheme An[2.x.0] by[2.x.1] matrix is first decomposed into[2.x.2] by[2.x.3] blocks which are then uniformly distributed across the process grid with[2.x.4] processes</div><div class="ttdef"><b>Definition:</b> <a href="scalapack__0_8txt_source.html#l00002">scalapack_0.txt:2</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE7_ORDER4</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00320">time_stepping.h:320</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a9ac5275c3c74902f8a9d6e7bdb514179"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a></div><div class="ttdeci">T min(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="achunk__sparse__matrix__0_8txt_html_a59317914f0b63e3c2c7c6bd150b8ba3e"><div class="ttname"><a href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a></div><div class="ttdeci">0&lt;/tt &gt;, which sets all elements of the matrix to zero, but keep the sparsity pattern previously used. *[0.x.66] *Reinitialize the sparse matrix with the given sparsity pattern. The latter tells the matrix how many nonzero elements there need to be reserved. Regarding memory allocation, the same applies as said above. You have to make sure that the lifetime of the sparsity structure is at least as long as that of this matrix or as long as reinit(const ChunkSparsityPattern &amp;) is not called with a new sparsity structure. The elements of the matrix are set to zero by this function. *[0.x.67] *Release all memory and return to a state just like after having called the default constructor. It also forgets the sparsity pattern it was previously tied to. *[0.x.68] *[2.x.18] Information on the matrix *[0.x.69] *Return whether the object is empty. It is empty if either both dimensions are zero or no ChunkSparsityPattern is associated. *[0.x.70] *Return the dimension of the codomain(or range) space. Note that the matrix is of dimension[2.x.19] . *[0.x.71] *Return the dimension of the domain space. Note that the matrix is of dimension[2.x.20] . *[0.x.72] *Return the number of nonzero elements of this matrix. Actually, it returns the number of entries in the sparsity pattern matrix</div><div class="ttdef"><b>Definition:</b> <a href="chunk__sparse__matrix__0_8txt_source.html#l00156">chunk_sparse_matrix_0.txt:156</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_ade631a789101336840371e3b2e2851e0"><div class="ttname"><a href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a></div><div class="ttdeci">const std::string get_current_vectorization_level()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00944">utilities.cc:944</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_ad3b9cdeadeb3bcdb52af5db70c041a6e"><div class="ttname"><a href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **Constructor Takes all data stored in MatrixFree If applied to problems with more than one finite element or more than one quadrature formula selected during construction of[2.x.343] the appropriate component can be selected by the optional arguments[2.x.344] matrix_free Data object that contains all data[2.x.345] dof_no If matrix_free was set up with multiple DoFHandler this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.346] quad_no If matrix_free was set up with multiple Quadrature this parameter selects the appropriate number of the quadrature formula[2.x.347] first_selected_component If the dof_handler selected by dof_no uses an FESystem consisting of more than one this parameter allows for selecting the component where the current evaluation routine should start Note that one evaluator does not support combining different shape functions in different components In other the same base element of a FESystem needs to be set for the components between[2.x.348] and[2.x.349][2.x.350] active_fe_index If matrix_free was set up with DoFHandler objects with[2.x.351] this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.352] active_quad_index If matrix_free was set up with[2.x.353] this parameter selects the appropriate number of the quadrature formula **Constructor Takes all data stored in MatrixFree for a given cell which allows to automatically identify the active_fe_index and active_quad_index in case of a p adaptive strategy The rest of the arguments are the same as in the constructor above **Constructor that comes with reduced functionality and works similar as FEValues The arguments are similar to the ones passed to the constructor of with the notable difference that FEEvaluation expects a one dimensional quadrature instead of a[2.x.354] dimensional one The finite element can be both scalar or vector but this method always only selects a scalar base element at a the optional argument[2.x.356] allows to specify the index of the base element to be used for evaluation Note that the internal data structures always assume that the base element is non primitive are not supported currently As known from a call to the reinit method with a[2.x.357] is necessary to make the geometry and degrees of freedom of the current class known::If the iterator includes DoFHandler the initialization allows to also read from or write to vectors in the standard way for[2.x.359] types for one cell at a time this approach is much slower than the path with MatrixFree with MPI since index translation has to be done As only one cell at a time is this method does not vectorize over several but only possibly within the element if the evaluate integrate routines are combined inside user an object of type i the underlying mapping and quadrature points do only need to be evaluated once Make sure to not pass an optional object around when you intend to use the FEEvaluation object in parallel to the given one because otherwise the intended sharing may create race conditions **Copy constructor If FEEvaluationBase was constructed from a fe</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00555">fe_evaluation_0.txt:555</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a265e44213c5331eb7d572a97bbd8cd6c"><div class="ttname"><a href="multithreading__0_8txt.html#a265e44213c5331eb7d572a97bbd8cd6c">Vector&lt; Number &gt;</a></div><div class="ttdeci">it should be big enough so that we don t spend more time on scheduling sub ranges to processors but small enough that processors can be efficiently load balanced A rule of thumb appears to be that a sub range is too small if it takes less than instructions to execute it *An example of how to use these functions are vector operations like the addition in[2.x.45] where all three objects are of type Vector&lt; Number &gt;</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00093">multithreading_0.txt:93</a></div></div>
<div class="ttc" id="aglobal__dof__index__0_8txt_html_a2b84b1d42e4fde15bdf79726ce1cc907"><div class="ttname"><a href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a></div><div class="ttdeci">**deal II can be configured to use bit indices for degrees of rather than the usual unsigned integers that default to bit on most current systems This is necessary since we want to be able to solve problems with more than billion we do not want to indiscriminately replace all integers in deal II with bit since this would increase memory use in many places where we represent quantities that will most definitely not be larger than billion *The data type we define for these indices to keep the bulk of the code base free of[2.x.1] s is[2.x.2] If deal II is configured as normal</div><div class="ttdef"><b>Definition:</b> <a href="global__dof__index__0_8txt_source.html#l00004">global_dof_index_0.txt:4</a></div></div>
<div class="ttc" id="atable__handler__0_8txt_html_a61e9964f9093088848525ca172895749"><div class="ttname"><a href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a></div><div class="ttdeci">the ConvergenceTable class does something like this *To support both the TableHandler class has a property called[1.x.4] By auto fill mode is but it can be enabled by calling set_auto_fill_mode(). If auto-fill mode is enabled we use the following algorithm call it *[2.x.18] ***If[2.x.19] then we add[2.x.20] copies of the object[2.x.21] to this column is the data type of the given[2.x.23] is a numeric then[2.x.24] is[2.x.25] is the empty string *[2.x.26] ***Add the given value to this column *Padding the column with default elements makes sure that after the addition the column has as many entries as the longest other column In other if we have skipped previous invocations of then the padding will enter default values into this column *The algorithm as described will fail if you try to skip adding values for a key if adding an element for this key is the first thing you want to do for a given iteration or time step</div><div class="ttdef"><b>Definition:</b> <a href="table__handler__0_8txt_source.html#l00070">table_handler_0.txt:70</a></div></div>
<div class="ttc" id="asynchronous__iterator__0_8txt_html_a3e447fe5e17c249965365f92a0755913"><div class="ttname"><a href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a></div><div class="ttdeci">*A class that represents a set of iterators each of which are incremented by one at the same time This is typically used in calls like[2.x.0] where we have synchronous iterators marching through the containers[2.x.1] If an object of this type represents the end of a range</div><div class="ttdef"><b>Definition:</b> <a href="synchronous__iterator__0_8txt_source.html#l00002">synchronous_iterator_0.txt:2</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a286a4c601bf0caec1702358838814327"><div class="ttname"><a href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">Euler_DG::gamma</a></div><div class="ttdeci">constexpr double gamma</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00066">step-67.cc:66</a></div></div>
<div class="ttc" id="aclassFEEvaluation_html"><div class="ttname"><a href="classFEEvaluation.html">FEEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2fe__evaluation_8h_source.html#l00070">fe_evaluation.h:70</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_adad35057b6e70ae37d4abe7878683d90"><div class="ttname"><a href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per the child indices of the child cells adjacent to face</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="adata__postprocessor__0_8txt_html_abfdf708e97518fa7ad2b849b80afddc1"><div class="ttname"><a href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a></div><div class="ttdeci">is not the size of the solution then if the solution is real valued the solution_values variable below will be an array with as many entries as there are evaluation points on a and each entry is a vector of length[2.x.31] representing the[2.x.32] solution functions evaluated at a point On the other if the solution is complex then the solution_values member variable of this class will have[2.x.34] entries for each evaluation point The first[2.x.35] of these entries represent the real parts of the and the second[2.x.36] entries correspond to the imaginary parts of the solution evaluated at the evaluation point The same layout is used for the solution_gradients and solution_hessians then all the gradients Hessians of the imaginary components There is more information about the subject in the documentation of the DataPostprocessor class itself[2.x.37] provides an example of how this class is used in a complex valued situation Through the fields in the CommonInputs base class this class also makes available access to the locations of evaluations points normal and which cell data is currently being evaluated or other object The outer vector runs over the evaluation whereas the inner vector runs over the components of the finite element field for which output will be generated **An array of gradients of a vector valued solution at each of the evaluation points used to create graphical output from one or other object The outer vector runs over the evaluation whereas the inner vector runs over the components of the finite element field for which output will be generated This array is only filled if a user derived class overloads the[2.x.38] and the function a class derived from DataPostprocessorScalar DataPostprocessorVector or DataPostprocessorTensor may pass this flag to the constructor of these three classes **An array of second derivatives of a vector valued solution at each of the evaluation points used to create graphical output from one or other object The outer vector runs over the evaluation whereas the inner vector runs over the components of the finite element field for which output will be generated This array is only filled if a user derived class overloads the[2.x.40] and the function a class derived from DataPostprocessorScalar DataPostprocessorVector or DataPostprocessorTensor may pass this flag to the constructor of these three classes **This class provides an interface to compute derived quantities from a solution that can then be output in graphical formats for visualization using facilities such as the DataOut class *For which are calculated from the values of the solution and possibly the first and second derivatives of the solution Examples are the calculation of Mach numbers from velocity and density in supersonic flow or the computation of the magnitude of a complex valued solution as demonstrated in[2.x.42] the functions of this class can be overloaded to compute new quantities *A data vector and an object of a class derived from the current one can be given to the[2.x.46] in reality the object of your derived class has to live until the DataOut object is destroyed as the latter keeps a pointer to the former and will complain if the object pointed to is destroyed while the latter still has a pointer to it If both the data postprocessor and DataOut objects are variables of a then you can avoid this error by declaring the data postprocessor variable before the DataOut variable as objects are destroyed in reverse order of declaration *In order not to perform needless DataPostprocessor has to provide information which input data is needed for the calculation of the derived i e whether it needs the the first derivative and or the second derivative of the provided data DataPostprocessor objects which are used in combination with a DataOutFaces object can also ask for the normal vectors at each point The information which data is needed has to be provided via the UpdateFlags returned by virtual the function get_needed_update_flags(). It is your responsibility to use only those values which were updated in the calculation of derived quantities. The DataOut object will provide references to the requested data in the call to evaluate_scalar_field() or evaluate_vector_field()(DataOut decides which of the two functions to call depending on whether the finite element in use has only a single</div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a11c2603797ae0134d1b26bc05bf552ec"><div class="ttname"><a href="namespaceEuler__DG.html#a11c2603797ae0134d1b26bc05bf552ec">Euler_DG::VectorizedArrayType</a></div><div class="ttdeci">VectorizedArray&lt; Number &gt; VectorizedArrayType</div><div class="ttdef"><b>Definition:</b> <a href="step-76_8cc_source.html#l00072">step-76.cc:72</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">VectorTools::EvaluationFlags::min</a></div><div class="ttdeci">@ min</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00062">vector_tools_evaluate.h:62</a></div></div>
<div class="ttc" id="aclassFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2function_8h_source.html#l00140">function.h:140</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_af4e7aa3afa2e7a87c8383130df92f1f4"><div class="ttname"><a href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">Euler_DG::output_tick</a></div><div class="ttdeci">constexpr double output_tick</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00068">step-67.cc:68</a></div></div>
<div class="ttc" id="anamespaceStep37_html_a92034819b3a2b370b456b2e415e24f55"><div class="ttname"><a href="namespaceStep37.html#a92034819b3a2b370b456b2e415e24f55">Step37::dimension</a></div><div class="ttdeci">const unsigned int dimension</div><div class="ttdef"><b>Definition:</b> <a href="step-37_8cc_source.html#l00060">step-37.cc:60</a></div></div>
<div class="ttc" id="aoperator__0_8txt_html_a48b6a07d6667882c8b9555b97d3a9894"><div class="ttname"><a href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a></div><div class="ttdeci">namespace are derived from either Operator or OutputOperator depending on whether they return a value or not See the documentation of those classes for more detailed information on how to use them ***Update this documentation and the one of Operator abstract The base class of all algorithms in this library An which transforms a set of named vectors into another set of named vectors an which could be for instance a change of a different time step size or too slow convergence of Newton s which would then trigger reassembling of a matrix or similar things[1.x.0] This is probably the most prominent use for Operator</div><div class="ttdef"><b>Definition:</b> <a href="operator__0_8txt_source.html#l00007">operator_0.txt:7</a></div></div>
<div class="ttc" id="abase_2partitioner__0_8txt_html_a6d2d0fa485d1660823c59c494fb0fb31"><div class="ttname"><a href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a></div><div class="ttdeci">*This class defines a model for the partitioning of a it includes a structure for the point to point communication patterns It allows the inclusion of ghost it also stores the other processors ghost indices belonging to the current which are the indices where other processors might require information from In a these import indices form the dual of the ghost indices This information is gathered once when constructing the which obviates subsequent global communication steps when exchanging data The figure below gives an example of index space[2.x.2] being split into four parts that are each owned by one MPI the next four lines indicate which elements of the overall array each processor wants to know about **this is generally a superset of the locally owned with the difference being what are called ghost elements To understand the remaining pieces of the remember that in MPI</div><div class="ttdef"><b>Definition:</b> <a href="base_2partitioner__0_8txt_source.html#l00004">partitioner_0.txt:4</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a143bc64b6fa6ced9f11c148a2af3ff09"><div class="ttname"><a href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Euler_DG::Number</a></div><div class="ttdeci">double Number</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00064">step-67.cc:64</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a></div><div class="ttdeci">DataComponentInterpretation</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__component__interpretation_8h_source.html#l00048">data_component_interpretation.h:48</a></div></div>
<div class="ttc" id="aclassFEFaceEvaluation_html"><div class="ttname"><a href="classFEFaceEvaluation.html">FEFaceEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2fe__evaluation_8h_source.html#l03134">fe_evaluation.h:3134</a></div></div>
<div class="ttc" id="avector__tools__constraints_8templates__0_8txt_html_a08f744320bb886a9b7b7ed04148b7ce7"><div class="ttname"><a href="vector__tools__constraints_8templates__0_8txt.html#a08f744320bb886a9b7b7ed04148b7ce7">constraint</a></div><div class="ttdeci">*A structure that stores the dim DoF indices that correspond to a vector valued quantity at a single support point **Add the constraint[2.x.0] to the list of constraints is represented by the set of given DoF and[2.x.2] by the vector specified as the second argument The function does not add constraints if a degree of freedom is already constrained in the constraints object **Add the constraint[2.x.3] to the list of constraints this is a single constraint</div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__constraints_8templates__0_8txt_source.html#l00006">vector_tools_constraints.templates_0.txt:6</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed"><div class="ttname"><a href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">Euler_DG::lax_friedrichs_modified</a></div><div class="ttdeci">@ lax_friedrichs_modified</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00082">step-67.cc:82</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">VectorTools::EvaluationFlags::max</a></div><div class="ttdeci">@ max</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00056">vector_tools_evaluate.h:56</a></div></div>
<div class="ttc" id="anumerics_2data__out_8h_html"><div class="ttname"><a href="numerics_2data__out_8h.html">data_out.h</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">VectorTools::EvaluationFlags::avg</a></div><div class="ttdeci">@ avg</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00050">vector_tools_evaluate.h:50</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_aa4c22a167177d2942bb11e424ff38c6c"><div class="ttname"><a href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">Euler_DG::euler_pressure</a></div><div class="ttdeci">Number euler_pressure(const Tensor&lt; 1, dim+2, Number &gt; &amp;conserved_variables)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00270">step-67.cc:270</a></div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut&lt; dim &gt;</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="base_2numbers_8h_source.html#l00237">numbers.h:237</a></div></div>
<div class="ttc" id="agrid_2grid__refinement__0_8txt_html_a9a3fd18a091a09eb3271ac489b2ba245"><div class="ttname"><a href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a></div><div class="ttdeci">and others ******Return a pair of double values of which the first is adjusted refinement fraction of cells and the second is adjusted coarsening fraction of cells[2.x.1] current_n_cells The current cell number[2.x.2] max_n_cells The maximal number of cells If current cell number[2.x.3] is already exceeded maximal cell number[2.x.4] refinement fraction of cells will be set to zero and coarsening fraction of cells will be adjusted to reduce cell number to max_n_cells If cell number is going to be exceeded only upon then refinement and coarsening fractions are going to be adjusted with a same ratio in an attempt to reach the maximum number of cells Be aware though that through proliferation of refinement due to[2.x.5] this number is only an indicator The default value of this argument is to impose no limit on the number of cells[2.x.6] top_fraction_of_cells The requested fraction of active cells to be refined[2.x.7] bottom_fraction_of_cells The requested fraction of active cells to be coarsened *Usually you do not need to call this function explicitly Pass[2.x.9] max_n_cells to function refine_and_coarsen_fixed_number() or function refine_and_coarsen_fixed_fraction() and they will call this function if necessary. *[0.x.2] *This function provides a strategy to mark cells for refinement and coarsening with the goal of providing predictable growth in the size of the mesh by refining a given fraction of all cells. The function takes a vector of refinement[2.x.10] and two values between zero and one denoting the fractions of cells to be refined and coarsened. It flags cells for further processing by[2.x.11] according to the following greedy algorithm rfler this function computes the thresholds for refinement and coarsening such that the[2.x.33] of cells getting flagged for refinement make up for a certain fraction of the total error We explain its operation for coarsening works analogously Let[1.x.3] be the criterion of cell[1.x.4] Then the total error estimate is computed by the formula[1.x.5] If[1.x.6] is[2.x.34] then we refine the smallest subset[2.x.35] of the Triangulation[2.x.36] such that[1.x.7] The algorithm is performed by the greedy algorithm described in this time we really need to sort the array of criteria Just like the other strategy described this function only computes the threshold values and then passes over to no cells will be refined If it equals the result will be flagging for global refinement[2.x.42] bottom_fraction The fraction of the estimate coarsened If this number is no cells will be coarsened[2.x.43] max_n_cells This argument can be used to specify a maximal number of cells If this number is going to be exceeded upon then refinement and coarsening fractions are going to be adjusted in an attempt to reach the maximum number of cells Be aware though that through proliferation of refinement due to[2.x.44] this number is only an indicator The default value of this argument is to impose no limit on the number of cells[2.x.45] norm_type To determine combined errors on subsets of cells are calculated as norms of the criteria on these cells Different types of norms can be used for this from which[2.x.46] and[2.x.47] are currently supported **This function flags cells of a triangulation for refinement with the aim to reach a grid that is optimal with respect to an objective function that tries to balance reducing the error and increasing the numerical cost when the mesh is refined this function makes the assumption that if you refine a cell[2.x.48] with error indicator[2.x.49] provided by the second argument to this then the error on the but not for the usual Galerkin although it is approximately true for elliptic problems where the Greens function decays quickly and the error here is not too much affected by a too coarse mesh somewhere else With we can define the objective function this function tries to optimize Let us assume that the mesh currently has[2.x.52] cells if we refine the[2.x.53] cells with the largest errors</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement__0_8txt_source.html#l00024">grid_refinement_0.txt:24</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_a66b432045b82ed9b1c850f6407d4b1ca"><div class="ttname"><a href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if fe_degree</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00537">fe_evaluation_0.txt:537</a></div></div>
<div class="ttc" id="afunctions__0_8txt_html_af9f808a82e8c618e2e7a19dd08a9eae3"><div class="ttname"><a href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div><div class="ttdeci">****Functions are used in various places in deal for example to describe boundary coefficients in forcing or exact solutions Since closed form expressions for equations are often hard to pass along as function deal II uses the Function base class to describe these objects Essentially the interface of this base class requires derived classes to implement the ability to return the value of a function at one or a list of particular locations and function objects can then be used by algorithms like[2.x.1][2.x.2] and other functions *Some functions are needed again and and are therefore already provided in deal II This includes a function with a constant value</div><div class="ttdef"><b>Definition:</b> <a href="functions__0_8txt_source.html#l00007">functions_0.txt:7</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassDataOutInterface_html_ac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08210">data_out_base.cc:8210</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_abb931ad5a40604659a931a08336cad55"><div class="ttname"><a href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">Euler_DG::euler_numerical_flux</a></div><div class="ttdeci">Tensor&lt; 1, dim+2, Number &gt; euler_numerical_flux(const Tensor&lt; 1, dim+2, Number &gt; &amp;u_m, const Tensor&lt; 1, dim+2, Number &gt; &amp;u_p, const Tensor&lt; 1, dim, Number &gt; &amp;normal)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00320">step-67.cc:320</a></div></div>
<div class="ttc" id="aclassFESystem_html"><div class="ttname"><a href="classFESystem.html">FESystem&lt; dim &gt;</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01699">exceptions.h:1699</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a4c0a7149e1927066d2fcdb356cb90f7b"><div class="ttname"><a href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a></div><div class="ttdeci">in this it often pays off to use rather than in a program *deal II does not implement scheduling tasks to threads itself For we use the[1.x.10] for which we provide simple wrappers TBB abstracts the details of how to start or stop start tasks on individual and provides interfaces that are portable across many different systems ***MTUsing *[1.x.11] the syntax to start would be something like this for the example we would like to indicate the fact that the function call should be run on a separate task by simply prefixing the call with a as it is here *Since C does not support the creation of new we have to be a bit more creative The way chosen is to introduce a function[2.x.24] that takes as arguments the function to call as well as the arguments to the call The[2.x.25] function is overloaded to accommodate starting tasks with functions that take no</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00045">multithreading_0.txt:45</a></div></div>
<div class="ttc" id="agrid_2grid__refinement__0_8txt_html_a8bdcf8330609e043ba26a394139934f2"><div class="ttname"><a href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a></div><div class="ttdeci">and W R the function uses the observation that the error behaves like[2.x.65] with some constant[2.x.66] that depends on the dimension and the finite element degree It should **given optimal mesh refinement **not depend so much on the regularity of the as it is based on the that all singularities can be resolved by refinement Mesh refinement is then based on the idea that we want to make[2.x.67] small This corresponds to the functional[2.x.68] above *This function was originally implemented by Thomas Richter It follows a strategy described in T Parallel Multigrid Method for Adaptive Finite Elements with Application to Flow PhD University of See in particular Section</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement__0_8txt_source.html#l00029">grid_refinement_0.txt:29</a></div></div>
<div class="ttc" id="aclassDerivativeForm_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">DerivativeForm::transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="base_2derivative__form_8h_source.html#l00550">derivative_form.h:550</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00319">data_postprocessor.h:319</a></div></div>
<div class="ttc" id="anamespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00030">communication_pattern_base.h:30</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a8a90f5ba57a42a3fd4c067e00f8b8aea"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a></div><div class="ttdeci">****This class simplifies the construction of convergence tables reading the options for the generation of the table from a parameter file It provides a series of methods that can be used to compute the error given a reference exact solution or the difference between two numerical solutions or any other custom computation of the error given via[2.x.1] objects *An example usage of this class is given by ****The above code constructs a ParsedConvergenceTable that works for scalar and will produce an error table with and Linfty_norm norms of the error *Whenever a call to the methods the instance of this class inspects its parameters computes all norms specified by the parameter given at construction time possibly modified via a parameter file computes all extra column entries specified using the method and writes one row of the convergence table *Once you have finished with the a call to and to the the same code can be used to estimate the errors of mixed or multi physics e and one component for the pressure field p</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00020">parsed_convergence_table_0.txt:20</a></div></div>
<div class="ttc" id="amatrix__free_2tools_8h_html"><div class="ttname"><a href="matrix__free_2tools_8h.html">tools.h</a></div></div>
<div class="ttc" id="agrid_2grid__generator_8h_html"><div class="ttname"><a href="grid_2grid__generator_8h.html">grid_generator.h</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ad2f716b789abe53715d6659f38aa7815"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a></div><div class="ttdeci">T max(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00057">fe_update_flags.h:57</a></div></div>
<div class="ttc" id="aclassMatrixFree_html_abc204ec41ead1b5060f47ef3a5a066d7"><div class="ttname"><a href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop</a></div><div class="ttdeci">void cell_loop(const std::function&lt; void(const MatrixFree&lt; dim, Number, VectorizedArrayType &gt; &amp;, OutVector &amp;, const InVector &amp;, const std::pair&lt; unsigned int, unsigned int &gt; &amp;)&gt; &amp;cell_operation, OutVector &amp;dst, const InVector &amp;src, const bool zero_dst_vector=false) const</div></div>
<div class="ttc" id="atable__0_8txt_html_aa889bb34debce4db8c9ace2f875bdf0d"><div class="ttname"><a href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a></div><div class="ttdeci">tables that store three or more dimensional then there is nothing you can do about the size of these if your program is parallelized via then a typical first implementation would create a table object on every process and fill it on every MPI process by reading the data from a file This is inefficient from two the data stored on every process is the and while every process needs to be able to read from a it is not necessary that every process stores its own either by re creating a copy of the table in the other processes memory space if by creating copies in shared memory once for all processes located on each of the machines used by the MPI job ******Integer type used to count the number of elements in this container **Default constructor Set all dimensions to zero **Constructor Initialize the array with the given dimensions in each index component **Constructor Initialize the array with the given dimensions in each index component</div><div class="ttdef"><b>Definition:</b> <a href="table__0_8txt_source.html#l00083">table_0.txt:83</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_aa5b8d3c4b9deb0774dde5c2851e07e1e"><div class="ttname"><a href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">DoFHandler::n_dofs</a></div><div class="ttdeci">types::global_dof_index n_dofs() const</div></div>
<div class="ttc" id="afunction__0_8txt_html_a4f780342f2d5d632f82cf7fd90158a66"><div class="ttname"><a href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a></div><div class="ttdeci">it defaults to i e the first component **Return all components of a vector valued function at a given point&lt; tt &gt; values&lt;/tt &gt; shall have the right size i e **Set&lt; tt &gt; values&lt;/tt &gt; to the point values of the specified component of the function at the&lt; tt &gt; points&lt;/tt &gt; It is assumed that&lt; tt &gt; values&lt;/tt &gt; already has the right size</div><div class="ttdef"><b>Definition:</b> <a href="function__0_8txt_source.html#l00052">function_0.txt:52</a></div></div>
<div class="ttc" id="aclassUtilities_1_1MPI_1_1MPI__InitFinalize_html"><div class="ttname"><a href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2mpi_8h_source.html#l00836">mpi.h:836</a></div></div>
<div class="ttc" id="astructinternal_1_1FEFaceNormalEvaluationImpl_html"><div class="ttname"><a href="structinternal_1_1FEFaceNormalEvaluationImpl.html">internal::FEFaceNormalEvaluationImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__kernels_8h_source.html#l02251">evaluation_kernels.h:2251</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a02f5aa616d7b0799c538fe77d6c6c795"><div class="ttname"><a href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a></div><div class="ttdeci">i e</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00028">coding_conventions_0.txt:28</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
