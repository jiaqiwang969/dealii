<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/CodingConventions.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: Coding conventions used throughout deal.II</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Coding conventions used throughout deal.II </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Throughout deal.II, we strive to keep our programming style and the kind ofinterfaces we provide as consistent as possible. To this end, we have adopteda set of coding conventions that we attempt to follow wherever possible. Theyhave two parts: style issues, and something we call "defensive programming",the latter being an attempt to let our code help us find bugs. When readingthrough them, it is important to remember that styles are not god given orbetter than any other set of conventions; their purpose is merely to keepdeal.II as uniform as possible. Uniformity reduces the number of bugs weproduce because we can, for example, always assume that input arguments comebefore output arguments of a function call. They also simplify reading codebecause some things become clear already by looking at the style a piece ofcode is written, without having to look up the exact definition of something. </p><h3>Notes on deal.II indentation</h3>
<p>deal.II uses <code>clang-format</code> 6.0 to normalize indentation. Astyle file is provided at </p><div class="fragment"><div class="line">${SOURCE_DIR}/.clang-<a class="code" href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a></div>
</div><!-- fragment --><p>Before a commit, you should run </p><div class="fragment"><div class="line">clang-<a class="code" href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a></div>
<div class="line"> </div>
<div class="line">-i &lt;file&gt;</div>
</div><!-- fragment --><p> on each of your files. This will make sure indentation is conforming to thestyle guidelines outlined in this page. This is cumbersome. Consequently, and more easily, you can just run </p><div class="fragment"><div class="line">make indent</div>
</div><!-- fragment --><p> in whatever directory you set up the library to be compiled in, to indent allsource files that have been changed recently. If you want to make sure thatthe indenting is correct for all your commits, you might want to set up apre-commit hook. One way to do so, is to copy <code>${SOURCE_DIR}/contrib/git-hooks/pre-commit</code> to <code>${SOURCE_DIR}/.git/hooks/pre-commit</code> and make sure it isexecutable. If the system you are working on has more than one version of <code>clang-format</code> installed (or if it is not in the path)you should replace the above <code>make indent</code> command with </p><div class="fragment"><div class="line">make DEAL_II_CLANG_FORMAT=/path/<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a23e8d7ec9b1cf01acce4516431c61616">to</a>/clang-6.0/clang-<a class="code" href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a> indent</div>
</div><!-- fragment --><p> to point to the correct executable. </p>
<h3>Style issues</h3>
<ol>
<li>
Functions which return the number of something (number of cells, degrees of freedom, etc) should start with <code>n_*</code> . Example: <a class="el" href="classSparsityPatternBase.html#a0707927053081fd6c46dac186e63c543">SparsityPatternBase::n_nonzero_elements()</a>. </li>
<li>
Functions which set a bit or flag should start with <code>set_*</code> ; functions which clear bits or flags should be named <code>clear_*</code> . Example: <a class="el" href="classCellAccessor.html#a8c8359d5342b4ae7ae8b74fc3f4a1558">CellAccessor::set_refine_flag()</a>. </li>
<li>
Traditional logical operators should be used instead of their English equivalents (i.e., use <code>&amp;&amp;</code>, <code>||</code>, and <code>!</code> instead of <code>and</code>, <code>or</code>, and <code>not</code> ). </li>
<li>
In the implementation files, after each function, three empty lines are expected to enable better readability. One empty line occurs in functions to group blocks of code, since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions.  </li>
<li>
Whenever an integer variable can only assume nonnegative values, it is marked as unsigned. The same applies to functions that can only return positive or zero values. Example: <a class="el" href="classTriangulation.html#a5ea5c9957dbb566a562bbe2c0f3971e9">Triangulation::n_active_cells()</a>. </li>
<li>
Whenever an argument to a function will not be changed, it should be marked const, even if passed by value. Generally, we mark input parameters as const. This aids as an additional documentation tool to clarify the intent of a parameter (input, output, or both) and lets the compiler issue warnings if such a parameter is changed, which is often either involuntarily or poor style.  </li>
<li>
Whenever a function does not change any of the member variable of the embedding class/object, it should be marked as const.  </li>
<li>
Function and variable names may not consist of only one or two letters, unless the variable is a pure counting index.  </li>
<li>
Type aliases ( <code>using</code> -declarations) are preferred to <code>typedef</code> -declarations.  </li>
<li>
Use the geometry information in <a class="el" href="structGeometryInfo.html">GeometryInfo</a> to get the number of faces per cell, the number of children per cell, the child indices of the child cells adjacent to face 3, etc, rather than writing them into the code directly as <code>2*dim</code> , <code>(1&lt;&lt;dim)</code> and <code>{0,3}</code> . This reduces the possibilities for errors and enhances readability of code.  </li>
<li>
The layout of class declarations is the following: first the block of public functions, beginning with the constructors, then the destructors. If there are public member variables, these have to occur before the constructor. Public variables shall only be used if constant (in particular if they are static and constant) or unavoidable. <br  />
 After the public members, the protected and finally the private members are to be listed. The order is as above: first variables then functions. <br  />
 <a class="el" href="namespaceExceptions.html">Exceptions</a> shall be declared at the end of the public section before the non-public sections start. <br  />
 We do not use the C++11-style class member initialization for member variables that are neither <code>static const</code> nor <code>static constexpr</code> ; i.e., instead of <div class="fragment"><div class="line"><span class="keyword">class </span>Foo</div>
<div class="line">{</div>
<div class="line"> <span class="keywordtype">int</span> <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a> = 42;</div>
<div class="line"> intb = <span class="keyword">nullptr</span>;</div>
<div class="line">};</div>
</div><!-- fragment --> write <div class="fragment"><div class="line"><span class="keyword">class </span>Foo</div>
<div class="line">{</div>
<div class="line"> Foo();</div>
<div class="line"> </div>
<div class="line"> <span class="keywordtype">int</span> <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>;</div>
<div class="line"> intb;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> Foo::Foo()</div>
<div class="line">: <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>(42)</div>
<div class="line">, <a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>(<a class="code" href="fe__interface__values__0_8txt.html#a7afb86fa5db4a209b125ed3572c5579a">nullptr</a>)</div>
<div class="line">{}</div>
</div><!-- fragment -->  </li>
<li>
If a function has both input and output parameters, usually the input parameters shall precede the output parameters, unless there are good reasons to change this order. (The most common reason is trailing input parameters with default values.)  </li>
<li>
<a class="el" href="namespaceExceptions.html">Exceptions</a> are used for internal parameter checking and for consistency checks through the Assert macro. Exception handling like done by the C++ language ( <code>try/throw/catch</code> , and using the AssertThrow macro) are used to handle run time errors (like I/O failures) which must be on in any case, not only in debug mode.  </li>
<li>
Sometimes it makes sense to implement a class by using several non-member functions that are not part of the public interface and are only meant to be called in the current source file. Such free functions should be put in an internal namespace structured in the following way: <div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a></div>
<div class="line">{</div>
<div class="line"> <span class="keyword">namespace </span>ClassNameImplementation</div>
<div class="line"> {</div>
<div class="line">   <span class="comment">// free functions go here</span></div>
<div class="line"> }</div>
<div class="line">}</div>
</div><!-- fragment --> where <code>ClassName</code> is the name of the calling class. </li>
<li>
Classes, namespaces and types generally are named using uppercase letters to denote word beginnings (e.g. <a class="el" href="classTriaIterator.html">TriaIterator</a>) &mdash; sometimes called <a href="http://en.wikipedia.org/wiki/Camel_case"><em>camel case</em><em>camel case</em></a> &mdash; while functions and variables use lowercase letters and underscores to separate words. The only exception are the iterator alias in <a class="el" href="classTriangulation.html">Triangulation</a> and <a class="el" href="classDoFHandler.html">DoFHandler</a> (named cell_iterator, active_line_iterator, etc) to make the connection to the standard library container classes clear.  </li>
<li>
For classes with multiple template arguments, the dimension is usually put before the data type specifier, i.e., we use Point&lt;dim,number&gt; and not Point&lt;number,dim&gt;. </li>
<li>
There are several places in deal.II where we use forward declarations in header files. The reason for this is that we can, hopefully, improve compilation speeds by not using headers when we just need to mark a certain type as an argument to a function. The convention used in deal.II is that, if all we need is a type name, then the type may be forward declared in the header where we need it; if a function (or member function) can return a value then a declaration of that value's type should be available (by including the necessary header). For example, <code>deal.II/dofs/dof_handler.h</code> includes <code>deal.II/dofs/dof_accessor.h</code> so that one can write something like <code>dof_handler.begin_active()-&gt;is_active()</code> without explicitly including the header declaring the type of the object returned by <code><a class="el" href="iterators__0_8txt.html#ad83e6d423f9ad63243b1465081bde416">begin_active()</a></code> . </li>
<li>
Each class has to have at least 200 pages of documentation ;-)  </li>
</ol>
<h3>Instantiation of templated functions/classes</h3>
<p>The majority of classes and functions in deal.II are templated. This brings aquestion of how and where such objects are instantiated, if at all. Throughoutdeal.II we adopt the following convention: </p>
<ol>
<li>
If we can enumerate all possible template arguments (e.g., the dimensioncan only be 1, 2, or 3), then a function template goes into the <code>.cc</code> file and we explicitly instantiate all possibilities. Users will not have anyneed to ever see these function templates because they will not want toinstantiate these functions for any other template arguments anyway.  </li>
<li>
<p class="startli">If we can not enumerate all possible template arguments (e.g., vectortypes</p>
<ul>
<li>because users might want to define their own vector kinds) but atleast know a few common usage cases, then the function is put into a <code>.templates.h</code> file. We #include it into the <code>.cc</code> fileand instantiate the functions for all of the common arguments. For almost allusers, this will be just fine</li>
<li>they only use the (vector, matrix, ...) typeswe already instantiate, and for them the <code>.templates.h</code> file will notbe of any interest. It will also not slow down their compilations becausenothing they see will #include the <code>.templates.h</code> file. But users whodefine their own (vector, matrix, ...) types can instantiate the templatefunctions with their own user-defined types by including the <code>.templates.h</code> files. </li>
</ul>
</li>
<li>
Finally, if we can not assume in advance which values template argumentswill take (e.g., any class derived from <a class="el" href="classSubscriptor.html">Subscriptor</a> can be used as an argument),the definitions of functions are provided at the bottom of the headerfile with declarations. The definitions should be guarded with <code>#ifndefDOXYGEN ... #endif</code> to prevent Doxygen from picking them up.  </li>
</ol>
<p>For the first two cases, instantiation instructions are defined in <code>.inst.in</code> files. They are processed by a binary calledexpand_instantiations (built from <code>cmake/scripts/expand_instantiations.cc</code> ) and the parameters aredefined dynamically through cmake depending on your configuration (see <code>cmake/config/template-arguments.in</code> in your build directory).It is those <code>.inst</code> files that are eventually included from thecorresponding <code>.cc</code> files. </p>
<h3>Defensive programming</h3>
<p>Defensive programming is a term that we use frequently when we talk aboutwriting code while in the mindset that errors will happen. Here, errors cancome in two ways: first, I can make a mistake myself while writing afunctions; and secondly, someone else can make a mistake while calling myfunction. In either case, I would like to write my code in such a way thaterrors are (i) as unlikely as possible, (ii) that the compiler can alreadyfind some of the mistakes, and (iii) that the remaining mistakes arerelatively easy to find, for example because the program aborts. Defensiveprogramming is then a set of strategies that make these goals more likely. </p>
<p>Over time, we have learned a number of techniques to this end, some of whichwe list here: </p><ol>
<li>
<p class="startli"><em>Assert preconditions on parameters:</em> People call functions with wrong or nonsensical parameters, all the time. As the prototypical example, consider a trivial implementation of vector addition: </p><div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector</a> &amp;</div>
<div class="line">operator+=(<a class="code" href="classVector.html">Vector</a>       &amp;lhs,</div>
<div class="line">           <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;<a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>=0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>&lt;lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    lhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">  <span class="keywordflow">return</span> lhs;</div>
<div class="line">}</div>
</div><!-- fragment --><p> While correct, this function will get into trouble if the two vectors do not have the same size. You think it is silly to call this function with vectors of different size? Yes, of course it is. But it happens all the time: people forget to reinitialize a vector, or it is reset in a different function, etc. It happens. So if you are in such an unlucky case, it can take a long time to figure out what's going on because you are likely to just read uninitialized memory, or maybe you are writing to memory the <code>lhs</code> vector doesn't actually own. Neither is going to lead to immediate termination of the program, but you'll probably get random errors at a later time. It would be much easier if the program just stopped here right away. The following implementation will do exactly this: </p><div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector</a> &amp;</div>
<div class="line">operator+=(<a class="code" href="classVector.html">Vector</a>       &amp;lhs,</div>
<div class="line">           <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;<a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>() == <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.size(),</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(), <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.size());</div>
<div class="line">  <a class="code" href="instantiations__0_8txt.html#ae4e7f18fa1f0687038b552f8d14b50fd">for</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>=0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>&lt;lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    lhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">  <span class="keywordflow">return</span> lhs;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The <code>Assert</code> macro ensures that the condition is true at run time, and otherwise prints a string containing information encoded by the second argument and aborts the program. This way, when you write a new program that happens to call this function, you will learn of your error right away and have the opportunity to fix it without ever having to seriously debug anything. </p>
<p class="interli">As a general guideline, whenever you implement a new function, think about the <em>preconditions</em> on parameter, i.e. what does the function expect to be true about each of them, or their combination. Then write assertions for all of these preconditions. This may be half a dozen assertions in some cases but remember that each assertion is a potential bug already found through trivial means. </p>
<p class="endli">In a final note, let us remark that assertions are of course expensive: they may make a program 3 or 5 times slower when you link it against the debug version of the library. But if you consider your <em>overall</em> development time, the ability to find bugs quickly probably far outweighs the time you spend waiting for your program to finish. Furthermore, calls to the Assert macro are removed from the program in optimized mode (which you presumably only use once you know that everything runs just fine in debug mode. The optimized libraries are faster by a factor of 3-5 than the debug libraries, at the price that it's much harder to find bugs.  </p>
</li>
<li>
<em>Assert postconditions:</em> If a function computes something non-trivial there may be a bug in the code. To find these, use postconditions: just like you have certain knowledge about useful values for input parameters, you have knowledge about what you expect possible return values to be. For example, a function that computes the norm of a vector would expect the norm to be positive. You can write this as follows: <div class="fragment"><div class="line"><span class="keywordtype">double</span> <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>=0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>&lt;<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> += <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">}</div>
</div><!-- fragment --> This function is too simple to really justify this assertion, but imagine the computation to be lengthier and you can see how the assertion helps you ensure (or <em>hedge</em>) yourself against mistakes. Note that one could argue that the assertion should be removed once we've run the program a number of times and found that the condition never triggers. But it's better to leave it right where it is: it encodes for the future (and for readers) knowledge you have about the function; if someone comes along and replaced the implementation of the function by a more efficient algorithm, the assertion can help make sure that the function continues to do what it is supposed to do.  </li>
<li>
<em>Assert internal states:</em> In a similar vein, if you have a complex algorithm, use assertions to ensure that your mental model of what is going on matches what is indeed true. For example, assume you are writing a function that ensures that mesh sizes do not change too much locally. You may end up with a code of the following kind: <div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>=0; ...)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="base_2utilities__0_8txt.html#a065972a6fe9aa6a602ec82e81ad24464">something</a>)</div>
<div class="line">        { ... }</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">          <span class="comment">// we have a cell whose neighbor must</span></div>
<div class="line">          <span class="comment">// be at the boundary if we got here</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --> The conditions that got us into the else-branch may be complicated, and while it may be true that we believed that the only possibility we got here is that the neighbor is at the boundary, there may have been a bug in our implementation. There may also have been a bug in our thinking, or someone changes the code way above in the same function and forgets about the issue here, or a change at a completely different location in the library makes the assumption untenable. In all of these cases, the explicit statement of our assertion makes sure that these problems are easily found.  </li>
<li>
<p class="startli"><em>Initialize variables at the point of their declaration if they live on the stack:</em> Traditional C required that variables are declared at the beginning of the function even if they are only used further below. This leads to code like this that we may imagine in a 1d code: </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> foo ()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> cell_center;</div>
<div class="line">  ... <span class="comment">// something lengthy and complicated</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      cell_center = (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(0) + <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(1)) / 2;</div>
<div class="line">      ...</div>
<div class="line">    }</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><p> The problem is that if the code between the declaration and initialization is long and complicated, you can't look up on one page what the type of a variable is and what it's value may be. In fact, it may not even be quite clear that the variable is used initialized at all, or whether it is accidentally left uninitialized. </p>
<p class="interli">A better way to do this would be as follows: </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> foo ()</div>
<div class="line">{</div>
<div class="line">  ... <span class="comment">// something lengthy and complicated</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> cell_center = (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(0) + <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(1)) / 2;</div>
<div class="line">      ...</div>
<div class="line">    }</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><p> This makes it much clearer what the type of the variable is and that it is in fact only ever used when initialized. Furthermore, if someone wants to read the code to see what the variable is in fact doing, declaring and initializing it in the innermost possible scope makes this task easier: we don't have to look upwards for it beyond the declaration, and we don't have to look downward beyond the end of the current scope since this is where the variable dies. </p>
<p class="endli">As a final note, it is clear that you can only do this sort of stuff for variables that completely live on the stack without allocating memory on the heap. Within deal.II, this is only true for builtin types like <code>int, double, char</code> , etc, as well as the <a class="el" href="classPoint.html">Point</a> and <a class="el" href="classTensor.html">Tensor</a> classes. Everything else has something like a <code>std::vector</code> as a member variable, which requires memory allocation &mdash; you don't want to declare these inside loops, at least not if the loop is traversed frequently.  </p>
</li>
<li>
<em>Make variables const:</em> To pick up on the example above, note that in most cases we will never change the variable so initialized any more. In other words, if this is the case, we may as well write things as follows: <div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> foo ()</div>
<div class="line">{</div>
<div class="line">  ... <span class="comment">// something lengthy and complicated</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> cell_center = (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(0) +</div>
<div class="line">                                      <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(1)) / 2;</div>
<div class="line">      ...</div>
<div class="line">    }</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --> By marking the variable as constant we make sure that we don't accidentally change it. For example, the compiler could catch code like this: <div class="fragment"><div class="line"><span class="keywordflow">if</span> (cell_center[0] = 0)</div>
<div class="line">  ...</div>
</div><!-- fragment --> This was most likely meant to be a <code>==</code> rather than an assignment. By marking the variable as const, the compiler would have told us about this bug. Maybe equally importantly, human readers of the code need not look further down whether the value of the variable may actually be changed somewhere between declaration and use &mdash; it can't be if it is marked as const.  </li>
<li>
<em>Make input arguments of functions const:</em> The same essentially holds true as well as for function arguments: If you have no intention of changing a variable (which is typically the case for input arguments), then mark it as constant. For example, the following function should take its argument as a constant value: <div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::cell_iterator</a></div>
<div class="line"><a class="code" href="classCellAccessor.html#abacf4d5819d5f9e96d0e597cd92ce41e">CellAccessor&lt;dim&gt;::child</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> child_no)</div>
<div class="line">{</div>
<div class="line">  ...</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="base_2utilities__0_8txt.html#a065972a6fe9aa6a602ec82e81ad24464">something</a>;</div>
<div class="line">}</div>
</div><!-- fragment --> Here, the user calls <code>cell-&gt;child(3)</code> , for example. There really is no reason why the function would ever want to change the value of the <code>child_no</code> argument &mdash; so mark it as constant: this both helps the reader of the code understand that this is an input argument of the function for which we need not search below whether it is ever changed, and it helps the compiler help us finding bugs if we ever accidentally change the value. </li>
</ol>
<p>Throughout deal.II, we strive to keep our programming style and the kind of interfaces we provide as consistent as possible. To this end, we have adopted a set of coding conventions that we attempt to follow wherever possible. They have two parts: style issues, and something we call "defensive programming", the latter being an attempt to let our code help us find bugs. When reading through them, it is important to remember that styles are not god given or better than any other set of conventions; their purpose is merely to keep deal.II as uniform as possible. Uniformity reduces the number of bugs we produce because we can, for example, always assume that input arguments come before output arguments of a function call. They also simplify reading code because some things become clear already by looking at the style a piece of code is written, without having to look up the exact definition of something.</p>
<h3>Notes on deal.II indentation</h3>
<p>deal.II uses <code>clang-format</code> 6.0 to normalize indentation. A style file is provided at </p><div class="fragment"><div class="line">${SOURCE_DIR}/.clang-<a class="code" href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a></div>
</div><!-- fragment --><p>Before a commit, you should run </p><div class="fragment"><div class="line">clang-<a class="code" href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a> -i &lt;file&gt;</div>
</div><!-- fragment --><p> on each of your files. This will make sure indentation is conforming to the style guidelines outlined in this page.</p>
<p>This is cumbersome. Consequently, and more easily, you can just run </p><div class="fragment"><div class="line">make indent</div>
</div><!-- fragment --><p> in whatever directory you set up the library to be compiled in, to indent all source files that have been changed recently. If you want to make sure that the indenting is correct for all your commits, you might want to set up a pre-commit hook. One way to do so, is to copy <code>${SOURCE_DIR}/contrib/git-hooks/pre-commit</code> to <code>${SOURCE_DIR}/.git/hooks/pre-commit</code> and make sure it is executable.</p>
<p>If the system you are working on has more than one version of <code>clang-format</code> installed (or if it is not in the path) you should replace the above <code>make indent</code> command with </p><div class="fragment"><div class="line">make DEAL_II_CLANG_FORMAT=/path/<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a23e8d7ec9b1cf01acce4516431c61616">to</a>/clang-6.0/clang-<a class="code" href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a> indent</div>
</div><!-- fragment --><p> to point to the correct executable. </p>
<h3>Style issues</h3>
<ol>
<li>
<p class="startli">Functions which return the number of something (number of cells, degrees of freedom, etc) should start with <code>n_*</code>. Example: <a class="el" href="classSparsityPatternBase.html#a0707927053081fd6c46dac186e63c543">SparsityPatternBase::n_nonzero_elements()</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Functions which set a bit or flag should start with <code>set_*</code>; functions which clear bits or flags should be named <code>clear_*</code>. Example: <a class="el" href="classCellAccessor.html#a8c8359d5342b4ae7ae8b74fc3f4a1558">CellAccessor::set_refine_flag()</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Traditional logical operators should be used instead of their English equivalents (i.e., use <code>&amp;&amp;</code>, <code>||</code>, and <code>!</code> instead of <code>and</code>, <code>or</code>, and <code>not</code>).</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">In the implementation files, after each function, three empty lines are expected to enable better readability. One empty line occurs in functions to group blocks of code, since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Whenever an integer variable can only assume nonnegative values, it is marked as unsigned. The same applies to functions that can only return positive or zero values. Example: <a class="el" href="classTriangulation.html#a5ea5c9957dbb566a562bbe2c0f3971e9">Triangulation::n_active_cells()</a>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Whenever an argument to a function will not be changed, it should be marked const, even if passed by value. Generally, we mark input parameters as const. This aids as an additional documentation tool to clarify the intent of a parameter (input, output, or both) and lets the compiler issue warnings if such a parameter is changed, which is often either involuntarily or poor style.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Whenever a function does not change any of the member variable of the embedding class/object, it should be marked as const.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Function and variable names may not consist of only one or two letters, unless the variable is a pure counting index.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Type aliases (<code>using</code>-declarations) are preferred to <code>typedef</code>-declarations.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Use the geometry information in <a class="el" href="structGeometryInfo.html">GeometryInfo</a> to get the number of faces per cell, the number of children per cell, the child indices of the child cells adjacent to face 3, etc, rather than writing them into the code directly as <code>2*dim</code>, <code>(1&lt;&lt;dim)</code> and <code>{0,3}</code>. This reduces the possibilities for errors and enhances readability of code.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">The layout of class declarations is the following: first the block of public functions, beginning with the constructors, then the destructors. If there are public member variables, these have to occur before the constructor. Public variables shall only be used if constant (in particular if they are static and constant) or unavoidable. <br  />
 After the public members, the protected and finally the private members are to be listed. The order is as above: first variables then functions. <br  />
 <a class="el" href="namespaceExceptions.html">Exceptions</a> shall be declared at the end of the public section before the non-public sections start. <br  />
 We do not use the C++11-style class member initialization for member variables that are neither <code>static const</code> nor <code>static constexpr</code>; i.e., instead of </p><div class="fragment"><div class="line"><span class="keyword">class </span>Foo</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a> = 42;</div>
<div class="line">  <span class="keywordtype">int</span> *<a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a> = <span class="keyword">nullptr</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><p> write </p><div class="fragment"><div class="line"><span class="keyword">class </span>Foo</div>
<div class="line">{</div>
<div class="line">  Foo();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>;</div>
<div class="line">  <span class="keywordtype">int</span> *<a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> Foo::Foo()</div>
<div class="line">: <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>(42)</div>
<div class="line">, <a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>(<a class="code" href="fe__interface__values__0_8txt.html#a7afb86fa5db4a209b125ed3572c5579a">nullptr</a>)</div>
<div class="line">{}</div>
</div><!-- fragment --> <p class="endli"></p>
</li>
<li>
<p class="startli">If a function has both input and output parameters, usually the input parameters shall precede the output parameters, unless there are good reasons to change this order. (The most common reason is trailing input parameters with default values.) </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><a class="el" href="namespaceExceptions.html">Exceptions</a> are used for internal parameter checking and for consistency checks through the Assert macro. Exception handling like done by the C++ language (<code>try/throw/catch</code>, and using the AssertThrow macro) are used to handle run time errors (like I/O failures) which must be on in any case, not only in debug mode.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Sometimes it makes sense to implement a class by using several non-member functions that are not part of the public interface and are only meant to be called in the current source file. Such free functions should be put in an internal namespace structured in the following way: </p><div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">namespace </span>ClassNameImplementation</div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// free functions go here</span></div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p> where <code>ClassName</code> is the name of the calling class.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Classes, namespaces and types generally are named using uppercase letters to denote word beginnings (e.g. <a class="el" href="classTriaIterator.html">TriaIterator</a>) &mdash; sometimes called <a href="http://en.wikipedia.org/wiki/Camel_case"><em>camel case</em></a> &mdash; while functions and variables use lowercase letters and underscores to separate words. The only exception are the iterator alias in <a class="el" href="classTriangulation.html">Triangulation</a> and <a class="el" href="classDoFHandler.html">DoFHandler</a> (named cell_iterator, active_line_iterator, etc) to make the connection to the standard library container classes clear.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">For classes with multiple template arguments, the dimension is usually put before the data type specifier, i.e., we use Point&lt;dim,number&gt; and not Point&lt;number,dim&gt;.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">There are several places in deal.II where we use forward declarations in header files. The reason for this is that we can, hopefully, improve compilation speeds by not using headers when we just need to mark a certain type as an argument to a function. The convention used in deal.II is that, if all we need is a type name, then the type may be forward declared in the header where we need it; if a function (or member function) can return a value then a declaration of that value's type should be available (by including the necessary header). For example, <code>deal.II/dofs/dof_handler.h</code> includes <code>deal.II/dofs/dof_accessor.h</code> so that one can write something like <code>dof_handler.begin_active()-&gt;is_active()</code> without explicitly including the header declaring the type of the object returned by <code><a class="el" href="iterators__0_8txt.html#ad83e6d423f9ad63243b1465081bde416">begin_active()</a></code>.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Each class has to have at least 200 pages of documentation ;-)</p>
<p class="endli"></p>
</li>
</ol>
<h3>Instantiation of templated functions/classes</h3>
<p>The majority of classes and functions in deal.II are templated. This brings a question of how and where such objects are instantiated, if at all. Throughout deal.II we adopt the following convention:</p>
<ol>
<li>
<p class="startli">If we can enumerate all possible template arguments (e.g., the dimension can only be 1, 2, or 3), then a function template goes into the <code>.cc</code> file and we explicitly instantiate all possibilities. Users will not have any need to ever see these function templates because they will not want to instantiate these functions for any other template arguments anyway. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli">If we can not enumerate all possible template arguments (e.g., vector types &ndash; because users might want to define their own vector kinds) but at least know a few common usage cases, then the function is put into a <code>.templates.h</code> file. We #include it into the <code>.cc</code> file and instantiate the functions for all of the common arguments. For almost all users, this will be just fine &ndash; they only use the (vector, matrix, ...) types we already instantiate, and for them the <code>.templates.h</code> file will not be of any interest. It will also not slow down their compilations because nothing they see will #include the <code>.templates.h</code> file. But users who define their own (vector, matrix, ...) types can instantiate the template functions with their own user-defined types by including the <code>.templates.h</code> files.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Finally, if we can not assume in advance which values template arguments will take (e.g., any class derived from <a class="el" href="classSubscriptor.html">Subscriptor</a> can be used as an argument), the definitions of functions are provided at the bottom of the header file with declarations. The definitions should be guarded with <code>#ifndef DOXYGEN ... #endif</code> to prevent Doxygen from picking them up.</p>
<p class="endli"></p>
</li>
</ol>
<p>For the first two cases, instantiation instructions are defined in <code>.inst.in</code> files. They are processed by a binary called expand_instantiations (built from <code>cmake/scripts/expand_instantiations.cc</code>) and the parameters are defined dynamically through cmake depending on your configuration (see <code>cmake/config/template-arguments.in</code> in your build directory). It is those <code>.inst</code> files that are eventually included from the corresponding <code>.cc</code> files. </p>
<h3>Defensive programming</h3>
<p>Defensive programming is a term that we use frequently when we talk about writing code while in the mindset that errors will happen. Here, errors can come in two ways: first, I can make a mistake myself while writing a functions; and secondly, someone else can make a mistake while calling my function. In either case, I would like to write my code in such a way that errors are (i) as unlikely as possible, (ii) that the compiler can already find some of the mistakes, and (iii) that the remaining mistakes are relatively easy to find, for example because the program aborts. Defensive programming is then a set of strategies that make these goals more likely. </p>
<p>Over time, we have learned a number of techniques to this end, some of which we list here: </p><ol>
<li>
<p class="startli"><em>Assert preconditions on parameters:</em> People call functions with wrong or nonsensical parameters, all the time. As the prototypical example, consider a trivial implementation of vector addition: </p><div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector</a> &amp;</div>
<div class="line">operator+=(<a class="code" href="classVector.html">Vector</a>       &amp;lhs,</div>
<div class="line">           <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;<a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>=0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>&lt;lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    lhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">  <span class="keywordflow">return</span> lhs;</div>
<div class="line">}</div>
</div><!-- fragment --><p> While correct, this function will get into trouble if the two vectors do not have the same size. You think it is silly to call this function with vectors of different size? Yes, of course it is. But it happens all the time: people forget to reinitialize a vector, or it is reset in a different function, etc. It happens. So if you are in such an unlucky case, it can take a long time to figure out what's going on because you are likely to just read uninitialized memory, or maybe you are writing to memory the <code>lhs</code> vector doesn't actually own. Neither is going to lead to immediate termination of the program, but you'll probably get random errors at a later time. It would be much easier if the program just stopped here right away. The following implementation will do exactly this: </p><div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector</a> &amp;</div>
<div class="line">operator+=(<a class="code" href="classVector.html">Vector</a>       &amp;lhs,</div>
<div class="line">           <span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;<a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>() == <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.size(),</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(), <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.size());</div>
<div class="line">  <a class="code" href="instantiations__0_8txt.html#ae4e7f18fa1f0687038b552f8d14b50fd">for</a> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>=0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>&lt;lhs.<a class="code" href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    lhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">  <span class="keywordflow">return</span> lhs;</div>
<div class="line">}</div>
</div><!-- fragment --><p> The <code>Assert</code> macro ensures that the condition is true at run time, and otherwise prints a string containing information encoded by the second argument and aborts the program. This way, when you write a new program that happens to call this function, you will learn of your error right away and have the opportunity to fix it without ever having to seriously debug anything. </p>
<p class="interli">As a general guideline, whenever you implement a new function, think about the <em>preconditions</em> on parameter, i.e. what does the function expect to be true about each of them, or their combination. Then write assertions for all of these preconditions. This may be half a dozen assertions in some cases but remember that each assertion is a potential bug already found through trivial means. </p>
<p class="interli">In a final note, let us remark that assertions are of course expensive: they may make a program 3 or 5 times slower when you link it against the debug version of the library. But if you consider your <em>overall</em> development time, the ability to find bugs quickly probably far outweighs the time you spend waiting for your program to finish. Furthermore, calls to the Assert macro are removed from the program in optimized mode (which you presumably only use once you know that everything runs just fine in debug mode. The optimized libraries are faster by a factor of 3-5 than the debug libraries, at the price that it's much harder to find bugs. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Assert postconditions:</em> If a function computes something non-trivial there may be a bug in the code. To find these, use postconditions: just like you have certain knowledge about useful values for input parameters, you have knowledge about what you expect possible return values to be. For example, a function that computes the norm of a vector would expect the norm to be positive. You can write this as follows: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a>(<span class="keyword">const</span> <a class="code" href="classVector.html">Vector</a> &amp;<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>=0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>&lt;<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> += <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> (<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p> This function is too simple to really justify this assertion, but imagine the computation to be lengthier and you can see how the assertion helps you ensure (or <em>hedge</em>) yourself against mistakes. Note that one could argue that the assertion should be removed once we've run the program a number of times and found that the condition never triggers. But it's better to leave it right where it is: it encodes for the future (and for readers) knowledge you have about the function; if someone comes along and replaced the implementation of the function by a more efficient algorithm, the assertion can help make sure that the function continues to do what it is supposed to do. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Assert internal states:</em> In a similar vein, if you have a complex algorithm, use assertions to ensure that your mental model of what is going on matches what is indeed true. For example, assume you are writing a function that ensures that mesh sizes do not change too much locally. You may end up with a code of the following kind: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>=0; ...)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="base_2utilities__0_8txt.html#a065972a6fe9aa6a602ec82e81ad24464">something</a>)</div>
<div class="line">        { ... }</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">          <span class="comment">// we have a cell whose neighbor must</span></div>
<div class="line">          <span class="comment">// be at the boundary if we got here</span></div>
<div class="line">        }</div>
<div class="line">    }</div>
</div><!-- fragment --><p> The conditions that got us into the else-branch may be complicated, and while it may be true that we believed that the only possibility we got here is that the neighbor is at the boundary, there may have been a bug in our implementation. There may also have been a bug in our thinking, or someone changes the code way above in the same function and forgets about the issue here, or a change at a completely different location in the library makes the assumption untenable. In all of these cases, the explicit statement of our assertion makes sure that these problems are easily found. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Initialize variables at the point of their declaration if they live on the stack:</em> Traditional C required that variables are declared at the beginning of the function even if they are only used further below. This leads to code like this that we may imagine in a 1d code: </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> foo ()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> cell_center;</div>
<div class="line">  ... <span class="comment">// something lengthy and complicated</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      cell_center = (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(0) + <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(1)) / 2;</div>
<div class="line">      ...</div>
<div class="line">    }</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><p> The problem is that if the code between the declaration and initialization is long and complicated, you can't look up on one page what the type of a variable is and what it's value may be. In fact, it may not even be quite clear that the variable is used initialized at all, or whether it is accidentally left uninitialized. </p>
<p class="interli">A better way to do this would be as follows: </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> foo ()</div>
<div class="line">{</div>
<div class="line">  ... <span class="comment">// something lengthy and complicated</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> cell_center = (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(0) + <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(1)) / 2;</div>
<div class="line">      ...</div>
<div class="line">    }</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><p> This makes it much clearer what the type of the variable is and that it is in fact only ever used when initialized. Furthermore, if someone wants to read the code to see what the variable is in fact doing, declaring and initializing it in the innermost possible scope makes this task easier: we don't have to look upwards for it beyond the declaration, and we don't have to look downward beyond the end of the current scope since this is where the variable dies. </p>
<p class="interli">As a final note, it is clear that you can only do this sort of stuff for variables that completely live on the stack without allocating memory on the heap. Within deal.II, this is only true for builtin types like <code>int, double, char</code>, etc, as well as the <a class="el" href="classPoint.html">Point</a> and <a class="el" href="classTensor.html">Tensor</a> classes. Everything else has something like a <code>std::vector</code> as a member variable, which requires memory allocation &mdash; you don't want to declare these inside loops, at least not if the loop is traversed frequently. </p>
<p class="endli"></p>
</li>
<li>
<p class="startli"><em>Make variables const:</em> To pick up on the example above, note that in most cases we will never change the variable so initialized any more. In other words, if this is the case, we may as well write things as follows: </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> foo ()</div>
<div class="line">{</div>
<div class="line">  ... <span class="comment">// something lengthy and complicated</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> cell_center = (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(0) +</div>
<div class="line">                                      <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;vertex(1)) / 2;</div>
<div class="line">      ...</div>
<div class="line">    }</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><p> By marking the variable as constant we make sure that we don't accidentally change it. For example, the compiler could catch code like this: </p><div class="fragment"><div class="line"><span class="keywordflow">if</span> (cell_center[0] = 0)</div>
<div class="line">  ...</div>
</div><!-- fragment --><p> This was most likely meant to be a <code>==</code> rather than an assignment. By marking the variable as const, the compiler would have told us about this bug. Maybe equally importantly, human readers of the code need not look further down whether the value of the variable may actually be changed somewhere between declaration and use &mdash; it can't be if it is marked as const. </p>
<p class="endli"></p>
</li>
<li>
<em>Make input arguments of functions const:</em> The same essentially holds true as well as for function arguments: If you have no intention of changing a variable (which is typically the case for input arguments), then mark it as constant. For example, the following function should take its argument as a constant value: <div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::cell_iterator</a></div>
<div class="line"><a class="code" href="classCellAccessor.html#abacf4d5819d5f9e96d0e597cd92ce41e">CellAccessor&lt;dim&gt;::child</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> child_no)</div>
<div class="line">{</div>
<div class="line">  ...</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="base_2utilities__0_8txt.html#a065972a6fe9aa6a602ec82e81ad24464">something</a>;</div>
<div class="line">}</div>
</div><!-- fragment --> Here, the user calls <code>cell-&gt;child(3)</code>, for example. There really is no reason why the function would ever want to change the value of the <code>child_no</code> argument &mdash; so mark it as constant: this both helps the reader of the code understand that this is an input argument of the function for which we need not search below whether it is ever changed, and it helps the compiler help us finding bugs if we ever accidentally change the value. </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="afe__interface__values__0_8txt_html_a7afb86fa5db4a209b125ed3572c5579a"><div class="ttname"><a href="fe__interface__values__0_8txt.html#a7afb86fa5db4a209b125ed3572c5579a">nullptr</a></div><div class="ttdeci">namespace FEValuesViews **Create a view of the current FEInterfaceValues object that represents a set of[2.x.139] scalar filled in the other one will have *[2.x.141] *The FEFaceValues object for the current cell **The FEFaceValues object for the current cell if the cell is refined **The FEFaceValues object for the neighboring cell **The FEFaceValues object for the neighboring cell if the cell is refined **Pointer to internal_fe_face_values or respectively as determined in or nullptr</div><div class="ttdef"><b>Definition:</b> <a href="fe__interface__values__0_8txt_source.html#l00167">fe_interface_values_0.txt:167</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a6cf0880ba2af3a1be4aacdbbd4b90f9c"><div class="ttname"><a href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a></div><div class="ttdeci">where BaseIterator usually is one of thestandard iterators discussed above *The FilteredIterator gets an additional Predicate in its constructor and willskip all objects where this Predicate evaluates to&lt; tt &gt; false&lt;/tt &gt; Acollection of predicates already implemented can be found in the namespaceIteratorFilters ***IteratorsLoops Iterating over objects *All iterators of the same kind and iterating over thesame kind of geometrical objects traverse the mesh in the sameorder Take this code all iterators will always point to the same mesh even though&lt; tt &gt; DoFHandler&lt;/tt &gt; and&lt; tt &gt; Triangulation&lt;/tt &gt; are very different and even if the DoFHandlers are handling different finite the difference is only in the Accessor As mentioned the order in which iterators traverse the forest ofobjects is actually well but application programs should notassume any such but rather consider this an implementation detailof the library *Corresponding to above the order in which iterators traverse activeobjects is the same for all iterators in the following the difference to the previous example being that here we only consider active but theyare really rather dumb Their magic only lies in the fact that they point tosome useful in this case the Accessor For they point to anactual object that stores some data On the other the deal II when do not return a reference to an actual but returnan object that knows how to get at the data that represents cells In thisobject doesn t store itself where the vertices of a cell are or what its neighborsare it knows how to tease this sort of information from out of thearrays and tables and lists that the Triangulation class sets up to describe amesh *Accessing data that characterizes a cell is always done through the i e the expression[2.x.10] grants access to[1.x.6] attributes of this Accessor Examples of properties you can query from aniterator are ***Since dereferencing iterators yields accessor these calls are tomember etc These in turn figure out the relevant datafrom the various data structures that store this data How this is actuallydone and what data structures are used is not really of concern to authors ofapplications in deal II In by hiding the actual data structureswe are able to store data in an efficient not necessarily in a way thatmakes it easily accessible or understandable to application writers ***IteratorsTypedefs Kinds of accessors *Depending on what sort of data you want to there are different kindsof accessor and hexes that make up a triangulation</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00063">iterators_0.txt:63</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a0759c0124e216ec36f063ad051f4dba0"><div class="ttname"><a href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a></div><div class="ttdeci">it should be big enough so that we don t spend more time on scheduling sub ranges to processors but small enough that processors can be efficiently load balanced A rule of thumb appears to be that a sub range is too small if it takes less than instructions to execute it *An example of how to use these functions are vector operations like the addition in[2.x.45] where all three objects are of type we used a[1.x.23] to on the a function object that takes two arguments and returns the sum of the two This is exactly what we needed when we want to add the individual elements of vectors[2.x.46] and[2.x.47] and write the sum of the two into the elements of[2.x.48] The function object that we get here is completely known to the compiler and when it expands the loop that results from[2.x.49] will be as if we had written the loop in its obvious thereby eliminating the overhead of calling an external function there are cases where it is inefficient to call some object or function within each iteration *An example for this case is sparse matrix vector multiplication If you know how data is stored in compressed row format like in the SparseMatrix then a matrix vector product function looks like we compute the dot product of a single row of the matrix with the right hand side vector[2.x.51] and write it into the corresponding element of the[2.x.52] vector The code is made more efficient by utilizing that the elements of the[1.x.28] row follow the ones of the current i e at the beginning of the loop body we do not have to re set the pointers that point to the values and column numbers of each row *Using the[2.x.53] function we could in principle write this code as leaving one argument open and thus allowing the[2.x.56] function to consider the passed function argument as unary Also note that we need to make the source and destination vectors neither of which is what we desired notice the grainsize of a minimum of rows of a matrix that should be processed by an individual CPU core *The point is that while this is it is not since now the function object to be called on each row is not a simple[1.x.32] any there is an implicit function call including argument passing in each iteration of the loop *A more efficient way is to let TBB split the original range into sub and then call a target function not on each individual element of the but on the entire range This is facilitated by the[2.x.61] we call the[2.x.62] function on sub ranges of at least elements so that the initial setup cost can amortize *A related operation is when the loops over elements each produce a result that must then be but let s assume for a moment that it is A sequential implementation would look like this for sparse each of which compute their part of the square of the norm</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00124">multithreading_0.txt:124</a></div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l01033">tria.h:1033</a></div></div>
<div class="ttc" id="aclassCellAccessor_html_abacf4d5819d5f9e96d0e597cd92ce41e"><div class="ttname"><a href="classCellAccessor.html#abacf4d5819d5f9e96d0e597cd92ce41e">CellAccessor::child</a></div><div class="ttdeci">TriaIterator&lt; CellAccessor&lt; dim, spacedim &gt; &gt; child(const unsigned int i) const</div></div>
<div class="ttc" id="amg__0_8txt_html_a05d914308ac970c97c941a291a81ccc1"><div class="ttname"><a href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a></div><div class="ttdeci">which is a wrapper around Multigrid with the standard interface of deal II[2.x.9] Preconditioners PreconditionMG also uses the classes inheriting from for instance where it uses[2.x.10] and[2.x.11] which transfer between the global vector and the level vectors we have several auxiliary namely which stores an object on each level **See b</div><div class="ttdef"><b>Definition:</b> <a href="mg__0_8txt_source.html#l00011">mg_0.txt:11</a></div></div>
<div class="ttc" id="abase_2utilities__0_8txt_html_a065972a6fe9aa6a602ec82e81ad24464"><div class="ttname"><a href="base_2utilities__0_8txt.html#a065972a6fe9aa6a602ec82e81ad24464">something</a></div><div class="ttdeci">for each remove leading and trailing spaces The default value of the delimiter is a so that the function splits comma separated lists of strings To make data input from tables if the input string ends in a then this last delimiter is ignored For **yields the same element list of output[2.x.37] as you would get if the input had been **or **As a consequence of this a call like **yields a one element list Because of the trimming of the single element is the empty string This function can digest the case that the delimiter is a space In this it returns all words in the string Combined with the rules this implies that **yields again the element list of output[2.x.38] from above despite the presence of space at the end of the string **yields an empty list regardless of the number of spaces in the string **Specialization of usually a documentation or something</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities__0_8txt_source.html#l00063">utilities_0.txt:63</a></div></div>
<div class="ttc" id="akinsol__0_8txt_html_a6f62a16b407bb6c63e7b27a45efe9c97"><div class="ttname"><a href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a></div><div class="ttdeci">**Additional parameters that can be passed to the KINSOL class **KINSOL solution strategy KINSOL includes a Newton Krylov solver(both local and global) as well as Picard and fixed point solvers. *[0.x.3] *Standard Newton iteration. *[0.x.4] *Newton iteration with linesearch. *[0.x.5] *Fixed point iteration. *[0.x.6] *Picard iteration. *[0.x.7] *Initialization parameters for KINSOL. Global parameters the computation will be aborted and an assertion will be thrown **A function object that users may supply and that is intended to prepare the linear solver for subsequent calls to in the solution of linear systems[2.x.78] The exact nature of this system depends on the SolutionStrategy that has been selected In the cases and this function is never called The or a function within the linear solver to compute Jacobian related data that is required by the linear solver It may also preprocess that data as needed for which may involve calling a generic more build preconditioners from the assembled Jacobian In any the data so generated may then be used whenever a linear system is solved The point of this function is that but only as frequently as the solver determines that it is appropriate to perform the setup task In this Jacobian related data generated by thereby saving the effort to regenerate the Jacobian matrix and a preconditioner for it whenever possible[2.x.87] current_u Current value of[2.x.88][2.x.89] current_f Current value of[2.x.90] or[2.x.91] This function should then KINSOL does not call on the internal KINSOL convergence tests then KINSOL calls then only a fixed point iteration strategy can be used Notice that this may not or may converge very slowly A call to this function should store in dst the result of[2.x.93] applied to rhs</div><div class="ttdef"><b>Definition:</b> <a href="kinsol__0_8txt_source.html#l00517">kinsol_0.txt:517</a></div></div>
<div class="ttc" id="agroup__Vectors_html_ga81dcfa5c77bdd426603386c0844149ae"><div class="ttname"><a href="group__Vectors.html#ga81dcfa5c77bdd426603386c0844149ae">Vector::size</a></div><div class="ttdeci">size_type size() const</div></div>
<div class="ttc" id="asolver__cg__0_8txt_html_a557c71e94a2542d697ca3426b8843cd4"><div class="ttname"><a href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">sqrt</a></div><div class="ttdeci">*This class implements the preconditioned Conjugate but is used in many other tutorial programs as well Like all other solver it can work on any kind of vector and matrix as long as they satisfy certain and defaults to *[2.x.2] **This version of CG is taken from D Braess s book Finite Elements It requires a symmetric the projected matrix[2.x.4] is tri diagonal Since the projection is the eigenvalues of[2.x.5] approximate those of the original preconditioned matrix[2.x.6] In after[2.x.7] where[2.x.8] is the dimension of the original the eigenvalues of both matrices are equal even for small numbers of iteration the condition number of[2.x.9] is a good estimate for the one of *[2.x.10] After[2.x.11] steps the matrix T_m can be written in terms of the coefficients[2.x.12] and[2.x.13] as the tri diagonal matrix with diagonal elements&lt; tt &gt;&lt; tt &gt; alpha_1 beta_0&lt; tt &gt;&lt; tt &gt; sqrt(beta_{m-2&lt;/tt &gt;)/alpha_</div><div class="ttdef"><b>Definition:</b> <a href="solver__cg__0_8txt_source.html#l00011">solver_cg_0.txt:11</a></div></div>
<div class="ttc" id="afunction__tools__0_8txt_html_a1a2acf608502527a80c0aeecdc12c908"><div class="ttname"><a href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a></div><div class="ttdeci">*Estimate bounds on the value and bounds on each gradient component of a over a by approximating it by a order Taylor polynomial starting from the box center Each lower and upper bound is returned as a[2.x.1]</div><div class="ttdef"><b>Definition:</b> <a href="function__tools__0_8txt_source.html#l00002">function_tools_0.txt:2</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a23e8d7ec9b1cf01acce4516431c61616"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a23e8d7ec9b1cf01acce4516431c61616">to</a></div><div class="ttdeci">and situations where one is given a parameter dependent problem[2.x.4] and wants to form derivatives with regards to the for example to optimize an output functional with regards to[2.x.6]</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00010">automatic_and_symbolic_differentiation_0.txt:10</a></div></div>
<div class="ttc" id="avector__0_8txt_html_aaf255149898cc5cea8c1fa1e76fffe6f"><div class="ttname"><a href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a></div><div class="ttdeci">0 v</div><div class="ttdef"><b>Definition:</b> <a href="vector__0_8txt_source.html#l00062">vector_0.txt:62</a></div></div>
<div class="ttc" id="ainstantiations__0_8txt_html_ae4e7f18fa1f0687038b552f8d14b50fd"><div class="ttname"><a href="instantiations__0_8txt.html#ae4e7f18fa1f0687038b552f8d14b50fd">for</a></div><div class="ttdeci">**Instantiation of complex class and function templates is expensive both in terms of compile time and disk space Therefore we try to separate declaration and implementation of templates as far as possible and make sure that implementations are read by the compiler only when necessary *Template classes in&lt; tt &gt; deal II&lt;/tt &gt; can be grouped into three depending on the number of probable different instantiations These three groups are discussed in the following ****Inst1 Known and fixed number of instantiations *These are the classes having template parameters with very predictable values The typical prototype is we have a small number of member functions of this class are defined in a&lt; tt &gt; cc&lt;/tt &gt; file in the source directory and we instantiate the template for these known values explicitly in the source file *From an application all you actually get to see then is the declaration of the template Actual instantiations of member functions happens inside the library and is done when you compile the not when you compile your application code *For these adding instantiations for new parameters involves changing the library this is rarely of unless you are not content with computing only or ****Inst1a Available instances *If the template parameter is&lt; tt &gt; the available instances are for&lt; tt &gt;&lt;/tt &gt; if there is no other information *There are other cases of small number of template arguments is supported and instantiations are provided in the library In this includes all the linear algebra classes that are templatized on the type of the scalar underlying stored and in some cases[2.x.5] and *[2.x.6] ***Inst2 A few most of which are known *These are class templates usually having a small number of instantiations but additional instantiations may be necessary Therefore a set of instantiations for the most likely parameters is provided precompiled in the libraries but the implementation of the templates are provided in a special header file so that it is accessible in case someone wants to instantiate it for an unforeseen argument *Typical examples for this would be some of the linear algebra classes that take a vector type as template argument They would be instantiated within the library for[2.x.8]</div><div class="ttdef"><b>Definition:</b> <a href="instantiations__0_8txt_source.html#l00033">instantiations_0.txt:33</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_add141cdc4d28d06d71948acb7f0c7150"><div class="ttname"><a href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a></div><div class="ttdeci">each of these vectors has[2.x.174] elements containing the values of the[2.x.175] velocities and the one pressure at a quadrature point *We can use these values to then construct other things like residuals the construct is a bit awkward we have a[2.x.176] s</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00155">vector_valued_0.txt:155</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="agrid__out__0_8txt_html_a90eb15047a54ed6c2aaf7d46e1badd93"><div class="ttname"><a href="grid__out__0_8txt.html#a90eb15047a54ed6c2aaf7d46e1badd93">format</a></div><div class="ttdeci">they then have a template as usual ********Declaration of a name for each of the different output formats These are used by the generic output function resp Not implemented for the codimension one case **Write the triangulation in the gnuplot format In GNUPLOT format</div><div class="ttdef"><b>Definition:</b> <a href="grid__out__0_8txt_source.html#l00288">grid_out_0.txt:288</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga6060b2304b8600f5efa0d31eeda0207d"><div class="ttname"><a href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">StandardExceptions::ExcDimensionMismatch</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcDimensionMismatch(std::size_t arg1, std::size_t arg2)</div></div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_adad35057b6e70ae37d4abe7878683d90"><div class="ttname"><a href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per the child indices of the child cells adjacent to face</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="anamespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2aligned__vector_8h_source.html#l00471">aligned_vector.h:471</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2mapping__q1__eulerian_8h_source.html#l00032">mapping_q1_eulerian.h:32</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
