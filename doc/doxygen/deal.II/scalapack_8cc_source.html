<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/scalapack_8cc_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: source/lac/scalapack.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_d5c75a340e4829ceb672546587d22d54.html">lac</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">scalapack.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="scalapack_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2017 - 2020 by the deal.II authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2scalapack_8h.html">deal.II/lac/scalapack.h</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#ifdef DEAL_II_WITH_SCALAPACK</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="base_2array__view_8h.html">deal.II/base/array_view.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="base_2mpi_8h.html">deal.II/base/mpi.h</a>&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#  include &lt;deal.II/base/mpi.templates.h&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#  include &lt;deal.II/lac/scalapack.templates.h&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#  ifdef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#    include &lt;hdf5.h&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#  include &lt;memory&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#  ifdef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> number&gt;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">inline</span> hid_t</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">   39</a></span>&#160;<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<span class="keyword">const</span> <a class="code" href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a> *)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, ::<a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <span class="comment">// don&#39;t know what to put here; it does not matter</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">return</span> -1;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;}</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">inline</span> hid_t</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="scalapack_8cc.html#abdf7514b1c8a4c834ab260dde3e5e0e6">   47</a></span>&#160;<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> *)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="keywordflow">return</span> H5T_NATIVE_DOUBLE;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;}</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">inline</span> hid_t</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="scalapack_8cc.html#a99bef4947c15dcd476322eee326ab5e7">   53</a></span>&#160;<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<span class="keyword">const</span> <span class="keywordtype">float</span> *)</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;{</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">return</span> H5T_NATIVE_FLOAT;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;}</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">inline</span> hid_t</div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="scalapack_8cc.html#a70485e93a6582a254271f16945a0307d">   59</a></span>&#160;<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> *)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;{</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">return</span> H5T_NATIVE_INT;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;}</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="keyword">inline</span> hid_t</div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="scalapack_8cc.html#a5f5ddec5d1999e0c9e97d7cfaa458f0b">   65</a></span>&#160;<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> *)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="keywordflow">return</span> H5T_NATIVE_UINT;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;}</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="keyword">inline</span> hid_t</div>
<div class="line"><a name="l00071"></a><span class="lineno"><a class="line" href="scalapack_8cc.html#aba50315a1776c7e4e56ed591029f0639">   71</a></span>&#160;<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> *)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;{</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <span class="keywordflow">return</span> H5T_NATIVE_CHAR;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#  endif // DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a711503af730f169914268d2e307aa0ab">   80</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a711503af730f169914268d2e307aa0ab">ScaLAPACKMatrix&lt;NumberType&gt;::ScaLAPACKMatrix</a>(</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           n_rows_,</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           n_columns_,</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;const Utilities::MPI::ProcessGrid&gt; &amp;process_grid,</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           row_block_size_,</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           column_block_size_,</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a>                             property_)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  : uplo(<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  , <span class="comment">// for non-symmetric matrices this is not needed</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  first_process_row(0)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  , first_process_column(0)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  , submatrix_row(1)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  , submatrix_column(1)</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;{</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html#ab755a374266785648ae364b6d78f6c94">reinit</a>(n_rows_,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;         n_columns_,</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;         process_grid,</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;         row_block_size_,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;         column_block_size_,</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;         property_);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;}</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160; </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00105"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ac18a3b69bbaf7bd48147f87218a8afd4">  105</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a711503af730f169914268d2e307aa0ab">ScaLAPACKMatrix&lt;NumberType&gt;::ScaLAPACKMatrix</a>(</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>,</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;const Utilities::MPI::ProcessGrid&gt; &amp;process_grid,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           <a class="code" href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">block_size</a>,</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a>                             <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  : <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix</a>&lt;<a class="code" href="classNumberType.html">NumberType</a>&gt;(<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                                <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                                process_grid,</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                                <a class="code" href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">block_size</a>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                                <a class="code" href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">block_size</a>,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>)</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{}</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a861b3d89915ca829cb3248f5da9d8e8b">  121</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a711503af730f169914268d2e307aa0ab">ScaLAPACKMatrix&lt;NumberType&gt;::ScaLAPACKMatrix</a>(</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keyword">const</span> std::string &amp;                                       filename,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;const Utilities::MPI::ProcessGrid&gt; &amp;process_grid,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           row_block_size,</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           column_block_size)</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  : uplo(<span class="stringliteral">&#39;L&#39;</span>)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  , <span class="comment">// for non-symmetric matrices this is not needed</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  first_process_row(0)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  , first_process_column(0)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  , submatrix_row(1)</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  , submatrix_column(1)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;{</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  (void)filename;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  (void)process_grid;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  (void)<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  (void)<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">false</span>,</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <span class="stringliteral">&quot;This function is only available when deal.II is configured with HDF5&quot;</span>));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(process_grid-&gt;<a class="code" href="classUtilities_1_1MPI_1_1ProcessGrid.html#a008060e7491aa63e8038f6098b1908e4">mpi_communicator</a>));</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">// Before reading the content from disk the root process determines the</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">// dimensions of the matrix. Subsequently, memory is allocated by a call to</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">// reinit() and the matrix is loaded by a call to load().</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a> == 0)</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = 0;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">// open file in read-only mode</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      hid_t <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a> = H5Fopen(filename.c_str(), H5F_ACC_RDONLY, H5P_DEFAULT);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160; </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// get data set in file</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      hid_t dataset = H5Dopen2(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>, <span class="stringliteral">&quot;/matrix&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(dataset &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="comment">// determine file space</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      hid_t filespace = H5Dget_space(dataset);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">// get number of dimensions in data set</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordtype">int</span> <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> = H5Sget_simple_extent_ndims(filespace);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> == 2, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      hsize_t dims[2];</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sget_simple_extent_dims(filespace, dims, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="comment">// due to ScaLAPACK&#39;s column-major memory layout the dimensions are</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;      <span class="comment">// swapped</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>    = dims[1];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a> = dims[0];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;      <span class="comment">// close/release resources</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(filespace);</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Fclose(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    }</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <span class="keywordtype">int</span> ierr = MPI_Bcast(&amp;<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                       1,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                       Utilities::MPI::internal::mpi_type_id(&amp;<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                       0 <span class="comment">/*from root*/</span>,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                       process_grid-&gt;<a class="code" href="classUtilities_1_1MPI_1_1ProcessGrid.html#a008060e7491aa63e8038f6098b1908e4">mpi_communicator</a>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160; </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  ierr = MPI_Bcast(&amp;<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                   1,</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                   Utilities::MPI::internal::mpi_type_id(&amp;<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>),</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                   0 <span class="comment">/*from root*/</span>,</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                   process_grid-&gt;<a class="code" href="classUtilities_1_1MPI_1_1ProcessGrid.html#a008060e7491aa63e8038f6098b1908e4">mpi_communicator</a>);</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="comment">// the property will be overwritten by the subsequent call to load()</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html#ab755a374266785648ae364b6d78f6c94">reinit</a>(<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;         <a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;         process_grid,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;         <a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;         <a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;         <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html#a7578e1be3f70805316ec69f587ed7730">load</a>(filename.c_str());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">#  endif // DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00216"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ab755a374266785648ae364b6d78f6c94">  216</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ab755a374266785648ae364b6d78f6c94">ScaLAPACKMatrix&lt;NumberType&gt;::reinit</a>(</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           n_rows_,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           n_columns_,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;const Utilities::MPI::ProcessGrid&gt; &amp;process_grid,</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           row_block_size_,</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           column_block_size_,</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a>                             property_)</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;{</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size_ &gt; 0, <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Row block size has to be positive.&quot;</span>));</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(column_block_size_ &gt; 0,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Column block size has to be positive.&quot;</span>));</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    row_block_size_ &lt;= n_rows_,</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="stringliteral">&quot;Row block size can not be greater than the number of rows of the matrix&quot;</span>));</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    column_block_size_ &lt;= n_columns_,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="stringliteral">&quot;Column block size can not be greater than the number of columns of the matrix&quot;</span>));</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>             = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">LAPACKSupport::State::matrix</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;  <span class="keyword">property</span>          = property_;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>              = process_grid;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>            = n_rows_;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  n_columns         = n_columns_;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  row_block_size    = row_block_size_;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  column_block_size = column_block_size_;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      <span class="comment">// Get local sizes:</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      n_local_rows    = numroc_(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                             &amp;row_block_size,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                             &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                             &amp;first_process_row,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                             &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;      n_local_columns = numroc_(&amp;n_columns,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                &amp;column_block_size,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_column),</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                                &amp;first_process_column,</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns));</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <span class="comment">// LLD_A = MAX(1,NUMROC(M_A, MB_A, MYROW, RSRC_A, NPROW)), different</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <span class="comment">// between processes</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordtype">int</span> lda = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(1, n_local_rows);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      descinit_(<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                &amp;n_columns,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                &amp;row_block_size,</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                &amp;column_block_size,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                &amp;first_process_row,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                &amp;first_process_column,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;blacs_context),</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                &amp;lda,</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                &amp;info);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;descinit_&quot;</span>, info));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      this-&gt;<a class="code" href="classTransposeTable.html#a1850f8cb99a54fe25506a8ff39418aaf">TransposeTable&lt;NumberType&gt;::reinit</a>(n_local_rows, n_local_columns);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="comment">// set process-local variables to something telling:</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;      n_local_rows    = -1;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      n_local_columns = -1;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <a class="code" href="convergence__table__0_8txt.html#a37c53a384d86a02751b04a0a89820c55">std::fill</a>(<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">std::begin</a>(<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>), <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">std::end</a>(<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>), -1);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a7ab9ec110b225e4aa3b88ce83ff7bbcd">  290</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ab755a374266785648ae364b6d78f6c94">ScaLAPACKMatrix&lt;NumberType&gt;::reinit</a>(</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keyword">const</span> std::shared_ptr&lt;const Utilities::MPI::ProcessGrid&gt; &amp;process_grid,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a>                                           <a class="code" href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">block_size</a>,</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a>                             <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;{</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>, <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>, process_grid, <a class="code" href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">block_size</a>, <a class="code" href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">block_size</a>, <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;}</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ab1a0999bd5c5d5a519ae09bb1b1f6ddd">  303</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ab1a0999bd5c5d5a519ae09bb1b1f6ddd">ScaLAPACKMatrix&lt;NumberType&gt;::set_property</a>(</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keyword">const</span> <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a> property_)</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;{</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keyword">property</span> = property_;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;}</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160; </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a></div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a4dcde64aa5131d2a997b7221132cbf5d">  313</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a4dcde64aa5131d2a997b7221132cbf5d">ScaLAPACKMatrix&lt;NumberType&gt;::get_property</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;}</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160; </div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638">LAPACKSupport::State</a></div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a49f5b93c67c0f8851fd29ed89e4220cd">  322</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a49f5b93c67c0f8851fd29ed89e4220cd">ScaLAPACKMatrix&lt;NumberType&gt;::get_state</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>;</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;}</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;</div>
<div class="line"><a name="l00331"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a2d424dbb47f6c4ce6d554677c53c1570">  331</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a2d424dbb47f6c4ce6d554677c53c1570">ScaLAPACKMatrix&lt;NumberType&gt;::operator=</a>(<span class="keyword">const</span> <a class="code" href="classFullMatrix.html">FullMatrix&lt;NumberType&gt;</a> &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;{</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="comment">// FIXME: another way to copy is to use pdgeadd_ PBLAS routine.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="comment">// This routine computes the sum of two matrices B := a*A + b*B.</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="comment">// Matrices can have different distribution,in particular matrix A can</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  <span class="comment">// be owned by only one process, so we can set a=1 and b=0 to copy</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// non-distributed matrix A into distributed matrix B.</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == <span class="keywordtype">int</span>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m()), <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m()));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == <span class="keywordtype">int</span>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n()),</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;         <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n()));</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    {</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; n_local_rows; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> glob_i = global_row(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; n_local_columns; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;            {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">int</span> glob_j = global_column(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;              local_el(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)   = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(glob_i, glob_j);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;}</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a1bb57a0f97778b451507ee32233571d4">  362</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a1bb57a0f97778b451507ee32233571d4">ScaLAPACKMatrix&lt;NumberType&gt;::copy_from</a>(<span class="keyword">const</span> <a class="code" href="classLAPACKFullMatrix.html">LAPACKFullMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>)</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> * n_columns == 0)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#  ifdef DEBUG</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(rank, this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator) == rank,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;All processes have to call routine with identical rank&quot;</span>));</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(<a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>, this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator) == rank,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;All processes have to call routine with identical rank&quot;</span>));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="comment">// root process has to be active in the grid of A</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a> == <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == <span class="keywordtype">int</span>(B.<a class="code" href="classLAPACKFullMatrix.html#a9b75af632cd9b8fb02f65a684e9c4201">m</a>()), <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classLAPACKFullMatrix.html#a9b75af632cd9b8fb02f65a684e9c4201">m</a>()));</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == <span class="keywordtype">int</span>(B.<a class="code" href="classLAPACKFullMatrix.html#ab7d05c5ec71b091ea75e65c049e511ea">n</a>()), <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, B.<a class="code" href="classLAPACKFullMatrix.html#ab7d05c5ec71b091ea75e65c049e511ea">n</a>()));</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    }</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <span class="comment">// Create 1x1 grid for matrix B.</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  <span class="comment">// The underlying grid for matrix B only contains the process #rank.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  <span class="comment">// This grid will be used to copy the serial matrix B to the distributed</span></div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">// matrix using the ScaLAPACK routine pgemr2d.</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  MPI_Group group_A;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  MPI_Comm_group(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator, &amp;group_A);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>              <a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a> = 1;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="keyword">const</span> std::vector&lt;int&gt; ranks(<a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a>, <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  MPI_Group              group_B;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  MPI_Group_incl(group_A, <a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a>, <a class="code" href="base_2mpi_8h.html#a1c5369b6df31b6df6d7bcd6a46fdf566">DEAL_II_MPI_CONST_CAST</a>(ranks.data()), &amp;group_B);</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  MPI_Comm communicator_B;</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> mpi_tag = <a class="code" href="namespaceUtilities_1_1MPI_1_1internal_1_1Tags.html#a1c190e50dabbd9b60e230b843c6caa44a5cefd5f49fb86ffc193f75f2a7302fb6">Utilities::MPI::internal::Tags::scalapack_copy_from</a>;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <a class="code" href="namespaceUtilities_1_1MPI.html#af71d4b9497936fedf1398c0b6fba2ee7">Utilities::MPI::create_group</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                               group_B,</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                               mpi_tag,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                               &amp;communicator_B);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <span class="keywordtype">int</span> n_proc_rows_B = 1, n_proc_cols_B = 1;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;  <span class="keywordtype">int</span> this_process_row_B = -1, this_process_column_B = -1;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <span class="keywordtype">int</span> blacs_context_B = -1;</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <span class="keywordflow">if</span> (MPI_COMM_NULL != communicator_B)</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      <span class="comment">// Initialize Cblas context from the provided communicator</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      blacs_context_B   = Csys2blacs_handle(communicator_B);</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a> = <span class="stringliteral">&quot;Col&quot;</span>;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      Cblacs_gridinit(&amp;blacs_context_B, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>, n_proc_rows_B, n_proc_cols_B);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;      Cblacs_gridinfo(blacs_context_B,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                      &amp;n_proc_rows_B,</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                      &amp;n_proc_cols_B,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                      &amp;this_process_row_B,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                      &amp;this_process_column_B);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_proc_rows_B * n_proc_cols_B == 1, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <span class="comment">// the active process of grid B has to be process #rank of the</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      <span class="comment">// communicator attached to A</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a> == <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    }</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> mpi_process_is_active_B =</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    (this_process_row_B &gt;= 0 &amp;&amp; this_process_column_B &gt;= 0);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="comment">// create descriptor for matrix B</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;  std::vector&lt;int&gt; descriptor_B(9, -1);</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>        first_process_row_B = 0, first_process_col_B = 0;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">if</span> (mpi_process_is_active_B)</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    {</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;      <span class="comment">// Get local sizes:</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <span class="keywordtype">int</span> n_local_rows_B = numroc_(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                   &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                   &amp;this_process_row_B,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                   &amp;first_process_row_B,</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                   &amp;n_proc_rows_B);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordtype">int</span> n_local_cols_B = numroc_(&amp;n_columns,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                   &amp;n_columns,</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                                   &amp;this_process_column_B,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                                   &amp;first_process_col_B,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                   &amp;n_proc_cols_B);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_local_rows_B == <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_local_cols_B == n_columns, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      (void)n_local_cols_B;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordtype">int</span> lda  = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(1, n_local_rows_B);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;      descinit_(descriptor_B.data(),</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                &amp;n_columns,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                &amp;n_columns,</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                &amp;first_process_row_B,</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                &amp;first_process_col_B,</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                &amp;blacs_context_B,</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                &amp;lda,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                &amp;info);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;descinit_&quot;</span>, info));</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>   ii = 1;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *loc_vals_A =</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.size() &gt; 0 ? this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *loc_vals_B =</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        mpi_process_is_active_B ? &amp;(B(0, 0)) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="comment">// pgemr2d has to be called only for processes active on grid attached to</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;      <span class="comment">// matrix A</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;      pgemr2d(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;              &amp;n_columns,</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;              loc_vals_B,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;              descriptor_B.data(),</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;              loc_vals_A,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;              <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a>-&gt;descriptor,</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;              &amp;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a>-&gt;grid-&gt;blacs_context));</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;  <span class="keywordflow">if</span> (mpi_process_is_active_B)</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    Cblacs_gridexit(blacs_context_B);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  MPI_Group_free(&amp;group_A);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  MPI_Group_free(&amp;group_B);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;  <span class="keywordflow">if</span> (MPI_COMM_NULL != communicator_B)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    MPI_Comm_free(&amp;communicator_B);</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;}</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ae2c72bf2945cab1cd8050371520629ed">  496</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae2c72bf2945cab1cd8050371520629ed">ScaLAPACKMatrix&lt;NumberType&gt;::global_row</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> loc_row)<span class="keyword"> const</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_local_rows &gt;= 0 &amp;&amp; loc_row &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(n_local_rows),</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;         <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(loc_row, 0, n_local_rows));</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = loc_row + 1;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">return</span> indxl2g_(&amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>,</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                  &amp;row_block_size,</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                  &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                  &amp;first_process_row,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                  &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows)) -</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;         1;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;}</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00513"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ae10eacb6dbdb705df9683564f03ee525">  513</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae10eacb6dbdb705df9683564f03ee525">ScaLAPACKMatrix&lt;NumberType&gt;::global_column</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> loc_column)<span class="keyword"> const</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_local_columns &gt;= 0 &amp;&amp;</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;           loc_column &lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(n_local_columns),</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;         <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(loc_column, 0, n_local_columns));</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = loc_column + 1;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;  <span class="keywordflow">return</span> indxl2g_(&amp;<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>,</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                  &amp;column_block_size,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                  &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_column),</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                  &amp;first_process_column,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                  &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns)) -</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;         1;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;}</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a6fb8d24a17a4b2538fdca4397f7f68b8">  531</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">ScaLAPACKMatrix&lt;NumberType&gt;::copy_to</a>(<a class="code" href="classLAPACKFullMatrix.html">LAPACKFullMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> * n_columns == 0)</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;<span class="preprocessor">#  ifdef DEBUG</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(rank, this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator) == rank,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;All processes have to call routine with identical rank&quot;</span>));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(<a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>, this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator) == rank,</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;All processes have to call routine with identical rank&quot;</span>));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; </div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a> == <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    {</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="comment">// the process which gets the serial copy has to be in the process grid</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;is_process_active(), <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == <span class="keywordtype">int</span>(B.<a class="code" href="classLAPACKFullMatrix.html#a9b75af632cd9b8fb02f65a684e9c4201">m</a>()), <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classLAPACKFullMatrix.html#a9b75af632cd9b8fb02f65a684e9c4201">m</a>()));</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == <span class="keywordtype">int</span>(B.<a class="code" href="classLAPACKFullMatrix.html#ab7d05c5ec71b091ea75e65c049e511ea">n</a>()), <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, B.<a class="code" href="classLAPACKFullMatrix.html#ab7d05c5ec71b091ea75e65c049e511ea">n</a>()));</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    }</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// Create 1x1 grid for matrix B.</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// The underlying grid for matrix B only contains the process #rank.</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="comment">// This grid will be used to copy to the distributed matrix to the serial</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="comment">// matrix B using the ScaLAPACK routine pgemr2d.</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;  MPI_Group group_A;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  MPI_Comm_group(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator, &amp;group_A);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>              <a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a> = 1;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;  <span class="keyword">const</span> std::vector&lt;int&gt; ranks(<a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a>, <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  MPI_Group              group_B;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  MPI_Group_incl(group_A, <a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a>, <a class="code" href="base_2mpi_8h.html#a1c5369b6df31b6df6d7bcd6a46fdf566">DEAL_II_MPI_CONST_CAST</a>(ranks.data()), &amp;group_B);</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  MPI_Comm communicator_B;</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> mpi_tag = <a class="code" href="namespaceUtilities_1_1MPI_1_1internal_1_1Tags.html#a1c190e50dabbd9b60e230b843c6caa44aecb41c3aa91091dcb8fc050ab0a8b5f7">Utilities::MPI::internal::Tags::scalapack_copy_to</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;  <a class="code" href="namespaceUtilities_1_1MPI.html#af71d4b9497936fedf1398c0b6fba2ee7">Utilities::MPI::create_group</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                               group_B,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                               mpi_tag,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                               &amp;communicator_B);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;  <span class="keywordtype">int</span> n_proc_rows_B = 1, n_proc_cols_B = 1;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  <span class="keywordtype">int</span> this_process_row_B = -1, this_process_column_B = -1;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  <span class="keywordtype">int</span> blacs_context_B = -1;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;  <span class="keywordflow">if</span> (MPI_COMM_NULL != communicator_B)</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="comment">// Initialize Cblas context from the provided communicator</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      blacs_context_B   = Csys2blacs_handle(communicator_B);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a> = <span class="stringliteral">&quot;Col&quot;</span>;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      Cblacs_gridinit(&amp;blacs_context_B, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>, n_proc_rows_B, n_proc_cols_B);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      Cblacs_gridinfo(blacs_context_B,</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                      &amp;n_proc_rows_B,</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                      &amp;n_proc_cols_B,</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                      &amp;this_process_row_B,</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                      &amp;this_process_column_B);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_proc_rows_B * n_proc_cols_B == 1, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">// the active process of grid B has to be process #rank of the</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="comment">// communicator attached to A</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a> == <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> mpi_process_is_active_B =</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    (this_process_row_B &gt;= 0 &amp;&amp; this_process_column_B &gt;= 0);</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">// create descriptor for matrix B</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  std::vector&lt;int&gt; descriptor_B(9, -1);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>        first_process_row_B = 0, first_process_col_B = 0;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keywordflow">if</span> (mpi_process_is_active_B)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    {</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">// Get local sizes:</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="keywordtype">int</span> n_local_rows_B = numroc_(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                   &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                   &amp;this_process_row_B,</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                                   &amp;first_process_row_B,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                                   &amp;n_proc_rows_B);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="keywordtype">int</span> n_local_cols_B = numroc_(&amp;n_columns,</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                                   &amp;n_columns,</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                                   &amp;this_process_column_B,</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                                   &amp;first_process_col_B,</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                                   &amp;n_proc_cols_B);</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_local_rows_B == <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_local_cols_B == n_columns, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;      (void)n_local_cols_B;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      <span class="keywordtype">int</span> lda  = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(1, n_local_rows_B);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">// fill descriptor for matrix B</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      descinit_(descriptor_B.data(),</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                &amp;n_columns,</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;                &amp;n_columns,</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;                &amp;first_process_row_B,</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;                &amp;first_process_col_B,</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                &amp;blacs_context_B,</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                &amp;lda,</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                &amp;info);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;descinit_&quot;</span>, info));</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    }</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;  <span class="comment">// pgemr2d has to be called only for processes active on grid attached to</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  <span class="comment">// matrix A</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span>         ii = 1;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *loc_vals_A =</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.size() &gt; 0 ? this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *loc_vals_B = mpi_process_is_active_B ? &amp;(B(0, 0)) : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160; </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;      pgemr2d(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;              &amp;n_columns,</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;              loc_vals_A,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;              this-&gt;<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;              loc_vals_B,</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;              &amp;ii,</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;              descriptor_B.data(),</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;              &amp;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a>-&gt;grid-&gt;blacs_context));</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">if</span> (mpi_process_is_active_B)</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    Cblacs_gridexit(blacs_context_B);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;  MPI_Group_free(&amp;group_A);</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  MPI_Group_free(&amp;group_B);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keywordflow">if</span> (MPI_COMM_NULL != communicator_B)</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    MPI_Comm_free(&amp;communicator_B);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00664"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">  664</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">ScaLAPACKMatrix&lt;NumberType&gt;::copy_to</a>(<a class="code" href="classFullMatrix.html">FullMatrix&lt;NumberType&gt;</a> &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <span class="comment">// FIXME: use PDGEMR2D for copying?</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <span class="comment">// PDGEMR2D copies a submatrix of A on a submatrix of B.</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <span class="comment">// A and B can have different distributions</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">// see http://icl.cs.utk.edu/lapack-forum/viewtopic.php?t=50</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == <span class="keywordtype">int</span>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m()), <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m()));</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == <span class="keywordtype">int</span>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n()),</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;         <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n()));</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a> = 0.;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; n_local_rows; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> glob_i = global_row(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; n_local_columns; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            {</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">int</span> glob_j       = global_column(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;              <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(glob_i, glob_j) = local_el(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            }</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>, <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator, <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; </div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  <span class="comment">// we could move the following lines under the main loop above,</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  <span class="comment">// but they would be dependent on glob_i and glob_j, which</span></div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// won&#39;t make it much prettier</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::cholesky</a>)</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7a4b0582dd1e9230b5b59a6b2b698713">LAPACKSupport::lower_triangular</a>)</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.<a class="code" href="classScalarPolynomialsBase.html#a1f249ec13923bf17eac6469d92804ec8">n</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> + 1; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) = 0.;</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0">LAPACKSupport::upper_triangular</a>)</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.<a class="code" href="classScalarPolynomialsBase.html#a1f249ec13923bf17eac6469d92804ec8">n</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;            <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) = 0.;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a> &amp;&amp;</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;           <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::inverse_matrix</a>)</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    {</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;      <span class="keywordflow">if</span> (uplo == <span class="charliteral">&#39;L&#39;</span>)</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.<a class="code" href="classScalarPolynomialsBase.html#a1f249ec13923bf17eac6469d92804ec8">n</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> + 1; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;            <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (uplo == <span class="charliteral">&#39;U&#39;</span>)</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.<a class="code" href="classScalarPolynomialsBase.html#a1f249ec13923bf17eac6469d92804ec8">n</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;}</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a02ed2356018f07f75b3c951bb808bd49">  721</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">ScaLAPACKMatrix&lt;NumberType&gt;::copy_to</a>(</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;                B,</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;offset_A,</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;offset_B,</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;submatrix_size)<span class="keyword"> const</span></div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="comment">// submatrix is empty</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">if</span> (submatrix_size.first == 0 || submatrix_size.second == 0)</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// range checking for matrix A</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(offset_A.first, <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> - submatrix_size.first + 1);</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(offset_A.second, n_columns - submatrix_size.second + 1);</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="comment">// range checking for matrix B</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(offset_B.first, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a> - submatrix_size.first + 1);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(offset_B.second, B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a> - submatrix_size.second + 1);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="comment">// Currently, copying of matrices will only be supported if A and B share the</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="comment">// same MPI communicator</span></div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordtype">int</span> ierr, comparison;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  ierr = MPI_Comm_compare(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                          B.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                          &amp;comparison);</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(comparison == MPI_IDENT,</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Matrix A and B must have a common MPI Communicator&quot;</span>));</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160; </div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment">   * The routine pgemr2d requires a BLACS context resembling at least the union</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment">   * of process grids described by the BLACS contexts held by the ProcessGrids</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">   * of matrix A and B. As A and B share the same MPI communicator, there is no</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment">   * need to create a union MPI communicator to initialise the BLACS context</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordtype">int</span> union_blacs_context = Csys2blacs_handle(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>       = <span class="stringliteral">&quot;Col&quot;</span>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keywordtype">int</span>         union_n_process_rows =</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordtype">int</span> union_n_process_columns = 1;</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;  Cblacs_gridinit(&amp;union_blacs_context,</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;                  <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>,</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                  union_n_process_rows,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                  union_n_process_columns);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <span class="keywordtype">int</span> n_grid_rows_A, n_grid_columns_A, my_row_A, my_column_A;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  Cblacs_gridinfo(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;blacs_context,</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;                  &amp;n_grid_rows_A,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                  &amp;n_grid_columns_A,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                  &amp;my_row_A,</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;                  &amp;my_column_A);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160; </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  <span class="comment">// check whether process is in the BLACS context of matrix A</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> in_context_A =</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    (my_row_A &gt;= 0 &amp;&amp; my_row_A &lt; n_grid_rows_A) &amp;&amp;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    (my_column_A &gt;= 0 &amp;&amp; my_column_A &lt; n_grid_columns_A);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160; </div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;  <span class="keywordtype">int</span> n_grid_rows_B, n_grid_columns_B, my_row_B, my_column_B;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  Cblacs_gridinfo(B.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;blacs_context,</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                  &amp;n_grid_rows_B,</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                  &amp;n_grid_columns_B,</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                  &amp;my_row_B,</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                  &amp;my_column_B);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <span class="comment">// check whether process is in the BLACS context of matrix B</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> in_context_B =</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    (my_row_B &gt;= 0 &amp;&amp; my_row_B &lt; n_grid_rows_B) &amp;&amp;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    (my_column_B &gt;= 0 &amp;&amp; my_column_B &lt; n_grid_columns_B);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> n_rows_submatrix    = submatrix_size.first;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> n_columns_submatrix = submatrix_size.second;</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="comment">// due to Fortran indexing one has to be added</span></div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;  <span class="keywordtype">int</span> ia = offset_A.first + 1, ja = offset_A.second + 1;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="keywordtype">int</span> ib = offset_B.first + 1, jb = offset_B.second + 1;</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  std::array&lt;int, 9&gt; desc_A, desc_B;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *loc_vals_A = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;  <a class="code" href="classNumberType.html">NumberType</a> *      loc_vals_B = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;  <span class="comment">// Note: the function pgemr2d has to be called for all processes in the union</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;  <span class="comment">// BLACS context If the calling process is not part of the BLACS context of A,</span></div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  <span class="comment">// desc_A[1] has to be -1 and all other parameters do not have to be set If</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;  <span class="comment">// the calling process is not part of the BLACS context of B, desc_B[1] has to</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;  <span class="comment">// be -1 and all other parameters do not have to be set</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;  <span class="keywordflow">if</span> (in_context_A)</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    {</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.size() != 0)</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        loc_vals_A = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; desc_A.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;        desc_A[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = this-&gt;<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;    }</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    desc_A[1] = -1;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;  <span class="keywordflow">if</span> (in_context_B)</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    {</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">if</span> (B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() != 0)</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        loc_vals_B = B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>();</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; desc_B.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        desc_B[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = B.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    }</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    desc_B[1] = -1;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;  pgemr2d(&amp;n_rows_submatrix,</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;          &amp;n_columns_submatrix,</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;          loc_vals_A,</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;          &amp;ia,</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;          &amp;ja,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;          desc_A.data(),</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;          loc_vals_B,</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;          &amp;ib,</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;          &amp;jb,</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          desc_B.data(),</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          &amp;union_blacs_context);</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;  B.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160; </div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;  <span class="comment">// releasing the union BLACS context</span></div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;  Cblacs_gridexit(union_blacs_context);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;}</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160; </div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160; </div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00850"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a1ef7a687223ac1e36ba294a2f4b06115">  850</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">ScaLAPACKMatrix&lt;NumberType&gt;::copy_to</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;dest)<span class="keyword"> const</span></div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == dest.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, dest.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == dest.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;         <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, dest.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>));</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      this-&gt;<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>[0] == 1,</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="stringliteral">&quot;Copying of ScaLAPACK matrices only implemented for dense matrices&quot;</span>));</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  <span class="keywordflow">if</span> (dest.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      dest.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>[0] == 1,</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="stringliteral">&quot;Copying of ScaLAPACK matrices only implemented for dense matrices&quot;</span>));</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="comment">   * just in case of different process grids or block-cyclic distributions</span></div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="comment">   * inter-process communication is necessary</span></div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="comment">   * if distributed matrices have the same process grid and block sizes, local</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="comment">   * copying is enough</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> ((this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a> != dest.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>) || (row_block_size != dest.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>) ||</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;      (column_block_size != dest.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>))</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    {</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="comment">       * get the MPI communicator, which is the union of the source and</span></div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="comment">       * destination MPI communicator</span></div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;      <span class="keywordtype">int</span>       ierr = 0;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      MPI_Group group_source, group_dest, group_union;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;      ierr = MPI_Comm_group(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator, &amp;group_source);</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;      ierr = MPI_Comm_group(dest.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator, &amp;group_dest);</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;      ierr = MPI_Group_union(group_source, group_dest, &amp;group_union);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;      MPI_Comm mpi_communicator_union;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;      <span class="comment">// to create a communicator representing the union of the source</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;      <span class="comment">// and destination MPI communicator we need a communicator that</span></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;      <span class="comment">// is guaranteed to contain all desired processes -- i.e.,</span></div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;      <span class="comment">// MPI_COMM_WORLD. on the other hand, as documented in the MPI</span></div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;      <span class="comment">// standard, MPI_Comm_create_group is not collective on all</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;      <span class="comment">// processes in the first argument, but instead is collective on</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <span class="comment">// only those processes listed in the group. in other words,</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <span class="comment">// there is really no harm in passing MPI_COMM_WORLD as the</span></div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="comment">// first argument, even if the program we are currently running</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <span class="comment">// and that is calling this function only works on a subset of</span></div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <span class="comment">// processes. the same holds for the wrapper/fallback we are using here.</span></div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> mpi_tag = <a class="code" href="namespaceUtilities_1_1MPI_1_1internal_1_1Tags.html#a1c190e50dabbd9b60e230b843c6caa44a6fbc4c4e968c254b02e0361b2499ed89">Utilities::MPI::internal::Tags::scalapack_copy_to2</a>;</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      ierr              = <a class="code" href="namespaceUtilities_1_1MPI.html#af71d4b9497936fedf1398c0b6fba2ee7">Utilities::MPI::create_group</a>(MPI_COMM_WORLD,</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;                                          group_union,</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;                                          mpi_tag,</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                          &amp;mpi_communicator_union);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160; </div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="comment">       * The routine pgemr2d requires a BLACS context resembling at least the</span></div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="comment">       * union of process grids described by the BLACS contexts of matrix A and</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="comment">       * B</span></div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;      <span class="keywordtype">int</span> union_blacs_context = Csys2blacs_handle(mpi_communicator_union);</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>       = <span class="stringliteral">&quot;Col&quot;</span>;</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      <span class="keywordtype">int</span>         union_n_process_rows =</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(mpi_communicator_union);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <span class="keywordtype">int</span> union_n_process_columns = 1;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      Cblacs_gridinit(&amp;union_blacs_context,</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;                      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>,</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;                      union_n_process_rows,</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;                      union_n_process_columns);</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *loc_vals_source = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *      loc_vals_dest   = <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160; </div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active &amp;&amp; (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a>-&gt;values.size() &gt; 0))</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;        {</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.size() &gt; 0,</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                      ::<a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                        <span class="stringliteral">&quot;source: process is active but local matrix empty&quot;</span>));</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;          loc_vals_source = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        }</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;      <span class="keywordflow">if</span> (dest.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_process_is_active &amp;&amp; (dest.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0))</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            dest.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0,</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;            ::<a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;              <span class="stringliteral">&quot;destination: process is active but local matrix empty&quot;</span>));</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          loc_vals_dest = dest.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>();</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      pgemr2d(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;              &amp;n_columns,</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;              loc_vals_source,</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;              &amp;submatrix_row,</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;              &amp;submatrix_column,</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;              <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;              loc_vals_dest,</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;              &amp;dest.<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;              &amp;dest.<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;              dest.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;              &amp;union_blacs_context);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;      Cblacs_gridexit(union_blacs_context);</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;      <span class="keywordflow">if</span> (mpi_communicator_union != MPI_COMM_NULL)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;          ierr = MPI_Comm_free(&amp;mpi_communicator_union);</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;          <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;        }</div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;      ierr = MPI_Group_free(&amp;group_source);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      ierr = MPI_Group_free(&amp;group_dest);</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      ierr = MPI_Group_free(&amp;group_union);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;      <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    }</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="comment">// process is active in the process grid</span></div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    dest.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a> = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  dest.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a>    = <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>;</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  dest.<a class="code" href="classScaLAPACKMatrix.html#aae1c9ee4a7967975a161bc336d24a173">property</a> = <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;}</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00981"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ae9aa2d98bc501ca6c59b7bf72f3c0ceb">  981</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae9aa2d98bc501ca6c59b7bf72f3c0ceb">ScaLAPACKMatrix&lt;NumberType&gt;::copy_transposed</a>(</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;{</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  <a class="code" href="chunk__sparsity__pattern__0_8txt.html#a5b51102d307d0296227f3b3f5b095be4">add</a>(B, 0, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;}</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00991"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a462e4473e763e00148572e554395c448">  991</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a462e4473e763e00148572e554395c448">ScaLAPACKMatrix&lt;NumberType&gt;::add</a>(<span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a>                   <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>,</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a>                   <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a>,</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">bool</span>                         transpose_B)</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;{</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <span class="keywordflow">if</span> (transpose_B)</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;    {</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>));</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(column_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(column_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>));</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(row_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>));</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    }</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    {</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>));</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(column_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(column_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>));</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(row_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>));</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;    }</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a> == B.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>,</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The matrices A and B need to have the same process grid&quot;</span>));</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    {</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      <span class="keywordtype">char</span>        trans_b = transpose_B ? <span class="charliteral">&#39;T&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc =</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        (this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.size() &gt; 0) ? this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *B_loc =</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;        (B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0) ? B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      pgeadd(&amp;trans_b,</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;             &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;             &amp;<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a>,</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;             B_loc,</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;             &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;             &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;             B.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;             &amp;<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>,</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;             A_loc,</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>);</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    }</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;}</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01047"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a65e0a87f73838febd95208e6020fb87e"> 1047</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a462e4473e763e00148572e554395c448">ScaLAPACKMatrix&lt;NumberType&gt;::add</a>(<span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a>                   <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>,</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B)</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;{</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;  <a class="code" href="chunk__sparsity__pattern__0_8txt.html#a5b51102d307d0296227f3b3f5b095be4">add</a>(B, 1, <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;}</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01057"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a354f71241b0d44cba4f46e8410f26fcd"> 1057</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a354f71241b0d44cba4f46e8410f26fcd">ScaLAPACKMatrix&lt;NumberType&gt;::Tadd</a>(<span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a>                   <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>,</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B)</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;{</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  <a class="code" href="chunk__sparsity__pattern__0_8txt.html#a5b51102d307d0296227f3b3f5b095be4">add</a>(B, 1, <a class="code" href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;}</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160; </div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#aada5bc79adf4d2b6f7a0a586dd154553"> 1067</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#aada5bc79adf4d2b6f7a0a586dd154553">ScaLAPACKMatrix&lt;NumberType&gt;::mult</a>(<span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a>                   <a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>,</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a>                   <a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>,</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                                  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>,</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span> transpose_A,</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span> transpose_B)<span class="keyword"> const</span></div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a> == B.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>,</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The matrices A and B need to have the same process grid&quot;</span>));</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.grid == B.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>,</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The matrices B and C need to have the same process grid&quot;</span>));</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160; </div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;  <span class="comment">// see for further info:</span></div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">// https://www.ibm.com/support/knowledgecenter/SSNR5K_4.2.0/com.ibm.cluster.pessl.v4r2.pssl100.doc/am6gr_lgemm.htm</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">if</span> (!transpose_A &amp;&amp; !transpose_B)</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;n_columns == B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;n_columns, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == C.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, C.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns,</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns));</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;row_block_size == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size,</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;row_block_size, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size));</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;column_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;column_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>));</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size,</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size));</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (transpose_A &amp;&amp; !transpose_B)</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    {</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;n_columns == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_rows,</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;n_columns, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_rows));</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns,</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns));</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;column_block_size == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size,</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;column_block_size, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size));</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;row_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;row_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>));</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size,</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size));</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!transpose_A &amp;&amp; transpose_B)</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    {</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;n_columns == B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;n_columns, B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>));</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == C.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, C.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns,</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns));</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;row_block_size == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size,</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;row_block_size, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size));</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;column_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;column_block_size,</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;                                  B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>));</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size,</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size));</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  <span class="keywordflow">else</span> <span class="comment">// if (transpose_A &amp;&amp; transpose_B)</span></div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;    {</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>));</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;n_columns == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_rows,</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;n_columns, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_rows));</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns,</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_columns));</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;column_block_size == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size,</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;row_block_size, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.row_block_size));</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(this-&gt;row_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(this-&gt;column_block_size, B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>));</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a> == <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size,</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.column_block_size));</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    }</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160; </div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordtype">char</span> trans_a = transpose_A ? <span class="charliteral">&#39;T&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;      <span class="keywordtype">char</span> trans_b = transpose_B ? <span class="charliteral">&#39;T&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *A_loc =</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        (this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.size() &gt; 0) ? this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *B_loc =</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        (B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0) ? B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *C_loc = (<a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.values.size() &gt; 0) ? <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.values.data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      <span class="keywordtype">int</span>         <a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>     = <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.n_rows;</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      <span class="keywordtype">int</span>         <a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a>     = <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.<a class="code" href="group__Exceptions.html#ga2a8559dd80dc049c51ea5f56e4038a4c">n_columns</a>;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      <span class="keywordtype">int</span>         <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>     = transpose_A ? this-&gt;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> : this-&gt;n_columns;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      pgemm(&amp;trans_a,</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;            &amp;trans_b,</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;            &amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>,</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            &amp;<a class="code" href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a>,</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;            &amp;<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>,</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;            &amp;<a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>,</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;            A_loc,</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;            &amp;(this-&gt;submatrix_row),</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;            &amp;(this-&gt;submatrix_column),</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;            this-&gt;<a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;            B_loc,</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;            B.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;            &amp;<a class="code" href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a>,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;            C_loc,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;            &amp;<a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.submatrix_row,</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;            &amp;<a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.submatrix_column,</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;            <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.descriptor);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>.state = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;}</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160; </div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01184"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a8242435e8730f7cac460b1ac2310c7ed"> 1184</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a8242435e8730f7cac460b1ac2310c7ed">ScaLAPACKMatrix&lt;NumberType&gt;::mmult</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">bool</span> adding)<span class="keyword"> const</span></div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">if</span> (adding)</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    mult(1., B, 1., <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    mult(1., B, 0, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;}</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01198"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a546401290947b77277a5f1811bc97ea2"> 1198</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a546401290947b77277a5f1811bc97ea2">ScaLAPACKMatrix&lt;NumberType&gt;::Tmmult</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>,</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">bool</span> adding)<span class="keyword"> const</span></div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="keywordflow">if</span> (adding)</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    mult(1., B, 1., <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    mult(1., B, 0, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;}</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160; </div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a36438ff9295f52ed4bb385663529f6cb"> 1212</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a36438ff9295f52ed4bb385663529f6cb">ScaLAPACKMatrix&lt;NumberType&gt;::mTmult</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>,</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">bool</span> adding)<span class="keyword"> const</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;  <span class="keywordflow">if</span> (adding)</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    mult(1., B, 1., <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    mult(1., B, 0, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;}</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160; </div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#adcfc441f7e61468e505c20a2b937c46c"> 1226</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#adcfc441f7e61468e505c20a2b937c46c">ScaLAPACKMatrix&lt;NumberType&gt;::TmTmult</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>,</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">bool</span> adding)<span class="keyword"> const</span></div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;  <span class="keywordflow">if</span> (adding)</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    mult(1., B, 1., <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;    mult(1., B, 0, <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;}</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160; </div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01240"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ae4fab96dc8bf972386fa37936fe8c132"> 1240</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae4fab96dc8bf972386fa37936fe8c132">ScaLAPACKMatrix&lt;NumberType&gt;::compute_cholesky_factorization</a>()</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;{</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    n_columns == <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> &amp;&amp; <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::Property::symmetric</a>,</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="stringliteral">&quot;Cholesky factorization can be applied to symmetric matrices only.&quot;</span>));</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    {</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keywordtype">int</span>         info  = 0;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;      <span class="comment">// pdpotrf_(&amp;uplo,&amp;n_columns,A_loc,&amp;submatrix_row,&amp;submatrix_column,descriptor,&amp;info);</span></div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      ppotrf(&amp;uplo,</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;             A_loc,</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;             &amp;info);</div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;ppotrf&quot;</span>, info));</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    }</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::cholesky</a>;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;  <span class="keyword">property</span> = (uplo == <span class="charliteral">&#39;L&#39;</span> ? <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7a4b0582dd1e9230b5b59a6b2b698713">LAPACKSupport::lower_triangular</a> :</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                            <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0">LAPACKSupport::upper_triangular</a>);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;}</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01273"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#aa25b18f13ceb1f252c2526124396d180"> 1273</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#aa25b18f13ceb1f252c2526124396d180">ScaLAPACKMatrix&lt;NumberType&gt;::compute_lu_factorization</a>()</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;{</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160; </div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      <span class="keywordtype">int</span>         info  = 0;</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iarow = indxg2p_(&amp;submatrix_row,</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                                 &amp;row_block_size,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                 &amp;first_process_row,</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> mp    = numroc_(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                             &amp;row_block_size,</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;                             &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;                             &amp;iarow,</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;                             &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;      ipiv.resize(mp + row_block_size);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      pgetrf(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;             A_loc,</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;             ipiv.data(),</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;             &amp;info);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgetrf&quot;</span>, info));</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a965e8f1c07847958b77370b5074bee91">LAPACKSupport::State::lu</a>;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <span class="keyword">property</span> = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;}</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160; </div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a5f723f324b1c7c22941f33034b652eec"> 1314</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a5f723f324b1c7c22941f33034b652eec">ScaLAPACKMatrix&lt;NumberType&gt;::invert</a>()</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;{</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <span class="comment">// Check whether matrix is symmetric and save flag.</span></div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="comment">// If a Cholesky factorization has been applied previously,</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;  <span class="comment">// the original matrix was symmetric.</span></div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> is_symmetric = (<span class="keyword">property</span> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a> ||</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                             <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::State::cholesky</a>);</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="comment">// Check whether matrix is triangular and is in an unfactorized state.</span></div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> is_triangular = (<span class="keyword">property</span> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0">LAPACKSupport::upper_triangular</a> ||</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                              <span class="keyword">property</span> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7a4b0582dd1e9230b5b59a6b2b698713">LAPACKSupport::lower_triangular</a>) &amp;&amp;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;                             (<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">LAPACKSupport::State::matrix</a> ||</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                              <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::State::inverse_matrix</a>);</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;  <span class="keywordflow">if</span> (is_triangular)</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;    {</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;        {</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">char</span> uploTriangular =</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;            <span class="keyword">property</span> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0">LAPACKSupport::upper_triangular</a> ? <span class="charliteral">&#39;U&#39;</span> : <span class="charliteral">&#39;L&#39;</span>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">char</span>  diag  = <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          <span class="keywordtype">int</span>         info  = 0;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          ptrtri(&amp;uploTriangular,</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;                 &amp;diag,</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                 &amp;n_columns,</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                 A_loc,</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;                 &amp;submatrix_row,</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;                 &amp;submatrix_column,</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;                 <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                 &amp;info);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;ptrtri&quot;</span>, info));</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          <span class="comment">// The inversion is stored in the same part as the triangular matrix,</span></div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;          <span class="comment">// so we don&#39;t need to re-set the property here.</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        }</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    }</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    {</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;      <span class="comment">// Matrix is neither in Cholesky nor LU state.</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;      <span class="comment">// Compute the required factorizations based on the property of the</span></div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;      <span class="comment">// matrix.</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;      <span class="keywordflow">if</span> (!(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a965e8f1c07847958b77370b5074bee91">LAPACKSupport::State::lu</a> ||</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::State::cholesky</a>))</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;          <span class="keywordflow">if</span> (is_symmetric)</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            compute_cholesky_factorization();</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            compute_lu_factorization();</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        }</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;        {</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;          <span class="keywordtype">int</span>         info  = 0;</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160; </div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;          <span class="keywordflow">if</span> (is_symmetric)</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            {</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;              ppotri(&amp;uplo,</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;                     &amp;n_columns,</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;                     A_loc,</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;                     &amp;submatrix_row,</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;                     &amp;submatrix_column,</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;                     <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;                     &amp;info);</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;              <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0,</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;                          LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;ppotri&quot;</span>, info));</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;              <span class="keyword">property</span> = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::Property::symmetric</a>;</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;            }</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;            {</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;              <span class="keywordtype">int</span> lwork = -1, liwork = -1;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;              <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(1);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;              iwork.resize(1);</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160; </div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;              pgetri(&amp;n_columns,</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;                     A_loc,</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;                     &amp;submatrix_row,</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                     &amp;submatrix_column,</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;                     <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;                     ipiv.data(),</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;                     <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;                     &amp;lwork,</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;                     iwork.data(),</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;                     &amp;liwork,</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                     &amp;info);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160; </div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;              <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0,</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;                          LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgetri&quot;</span>, info));</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;              lwork  = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>[0]);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;              liwork = iwork[0];</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;              <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;              iwork.resize(liwork);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160; </div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;              pgetri(&amp;n_columns,</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;                     A_loc,</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                     &amp;submatrix_row,</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;                     &amp;submatrix_column,</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                     <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;                     ipiv.data(),</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;                     <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;                     &amp;lwork,</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;                     iwork.data(),</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                     &amp;liwork,</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                     &amp;info);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160; </div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;              <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0,</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                          LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgetri&quot;</span>, info));</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;            }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;        }</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    }</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::State::inverse_matrix</a>;</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;}</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160; </div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l01430"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ae0278fa22a587e65fe73102baa4e3336"> 1430</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ae0278fa22a587e65fe73102baa4e3336">ScaLAPACKMatrix&lt;NumberType&gt;::eigenpairs_symmetric_by_index</a>(</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;index_limits,</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>                                   compute_eigenvectors)</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;{</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <span class="comment">// check validity of index limits</span></div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(index_limits.first, <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(index_limits.second, <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>);</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt; idx =</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    std::make_pair(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(index_limits.first, index_limits.second),</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;                   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(index_limits.first, index_limits.second));</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; </div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;  <span class="comment">// compute all eigenvalues/eigenvectors</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <span class="keywordflow">if</span> (idx.first == 0 &amp;&amp; idx.second == <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> - 1))</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;    <span class="keywordflow">return</span> eigenpairs_symmetric(compute_eigenvectors);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    <span class="keywordflow">return</span> eigenpairs_symmetric(compute_eigenvectors, idx);</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;}</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160; </div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160; </div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l01453"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a05736f2044c74db48f53067f46ed4c75"> 1453</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a05736f2044c74db48f53067f46ed4c75">ScaLAPACKMatrix&lt;NumberType&gt;::eigenpairs_symmetric_by_value</a>(</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;  <span class="keyword">const</span> std::pair&lt;NumberType, NumberType&gt; &amp;value_limits,</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>                               compute_eigenvectors)</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;{</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(!std::isnan(value_limits.first),</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;value_limits.first is NaN&quot;</span>));</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(!std::isnan(value_limits.second),</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;value_limits.second is NaN&quot;</span>));</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160; </div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt; <a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a> =</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    std::make_pair(<a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                   <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>);</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="keywordflow">return</span> eigenpairs_symmetric(compute_eigenvectors, <a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a>, value_limits);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;}</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160; </div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160; </div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160; </div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l01473"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a84115bec54d73663a31d714e1a17c82c"> 1473</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a84115bec54d73663a31d714e1a17c82c">ScaLAPACKMatrix&lt;NumberType&gt;::eigenpairs_symmetric</a>(</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>                                   compute_eigenvectors,</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;eigenvalue_idx,</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="keyword">const</span> std::pair&lt;NumberType, NumberType&gt; &amp;    eigenvalue_limits)</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;{</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a>,</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Matrix has to be symmetric for this operation.&quot;</span>));</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160; </div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_values = (std::isnan(eigenvalue_limits.first) ||</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;                           std::isnan(eigenvalue_limits.second)) ?</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;                            <span class="keyword">false</span> :</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;                            <span class="keyword">true</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_indices =</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    ((eigenvalue_idx.first == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>) ||</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;     (eigenvalue_idx.second == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)) ?</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <span class="keyword">false</span> :</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;      <span class="keyword">true</span>;</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160; </div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    !(use_values &amp;&amp; use_indices),</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="stringliteral">&quot;Prescribing both the index and value range for the eigenvalues is ambiguous&quot;</span>));</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <span class="comment">// if computation of eigenvectors is not required use a sufficiently small</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;  <span class="comment">// distributed matrix</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  std::unique_ptr&lt;ScaLAPACKMatrix&lt;NumberType&gt;&gt; <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a> =</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    compute_eigenvectors ?</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      std::make_unique&lt;ScaLAPACKMatrix&lt;NumberType&gt;&gt;(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;                                                    <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                                                    row_block_size) :</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      std::make_unique&lt;<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a>&gt;(</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;        <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows, <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns, <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>, 1, 1);</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160; </div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;  <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;property = <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>;</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  <span class="comment">// number of eigenvalues to be returned from psyevx; upon successful exit ev</span></div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;  <span class="comment">// contains the m seclected eigenvalues in ascending order set to all</span></div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="comment">// eigenvaleus in case we will be using psyev.</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;  <span class="keywordtype">int</span>                     <a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a> = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>;</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  std::vector&lt;NumberType&gt; ev(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>);</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    {</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;      <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="comment">       * for jobz==N only eigenvalues are computed, for jobz=&#39;V&#39; also the</span></div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="comment">       * eigenvectors of the matrix are computed</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <span class="keywordtype">char</span> jobz  = compute_eigenvectors ? <span class="charliteral">&#39;V&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <span class="keywordtype">char</span> <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a> = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <span class="comment">// default value is to compute all eigenvalues and optionally eigenvectors</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;      <span class="keywordtype">bool</span>       all_eigenpairs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> vl = <a class="code" href="classNumberType.html">NumberType</a>(), vu = <a class="code" href="classNumberType.html">NumberType</a>();</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      <span class="keywordtype">int</span>        il = 1, iu = 1;</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      <span class="comment">// number of eigenvectors to be returned;</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      <span class="comment">// upon successful exit the first m=nz columns contain the selected</span></div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;      <span class="comment">// eigenvectors (only if jobz==&#39;V&#39;)</span></div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;      <span class="keywordtype">int</span>        nz     = 0;</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> abstol = <a class="code" href="classNumberType.html">NumberType</a>();</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160; </div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;      <span class="comment">// orfac decides which eigenvectors should be reorthogonalized</span></div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="comment">// see</span></div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="comment">// http://www.netlib.org/scalapack/explore-html/df/d1a/pdsyevx_8f_source.html</span></div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;      <span class="comment">// for explanation to keeps simple no reorthogonalized will be done by</span></div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;      <span class="comment">// setting orfac to 0</span></div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> orfac = 0;</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;      <span class="comment">// contains the indices of eigenvectors that failed to converge</span></div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;      std::vector&lt;int&gt; ifail;</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      <span class="comment">// This array contains indices of eigenvectors corresponding to</span></div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;      <span class="comment">// a cluster of eigenvalues that could not be reorthogonalized</span></div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;      <span class="comment">// due to insufficient workspace</span></div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;      <span class="comment">// see</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;      <span class="comment">// http://www.netlib.org/scalapack/explore-html/df/d1a/pdsyevx_8f_source.html</span></div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;      <span class="comment">// for explanation</span></div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      std::vector&lt;int&gt; iclustr;</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;      <span class="comment">// This array contains the gap between eigenvalues whose</span></div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;      <span class="comment">// eigenvectors could not be reorthogonalized.</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;      <span class="comment">// see</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;      <span class="comment">// http://www.netlib.org/scalapack/explore-html/df/d1a/pdsyevx_8f_source.html</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;      <span class="comment">// for explanation</span></div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;      std::vector&lt;NumberType&gt; gap(n_local_rows * n_local_columns);</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160; </div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="comment">// index range for eigenvalues is not specified</span></div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;      <span class="keywordflow">if</span> (!use_indices)</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;        {</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;          <span class="comment">// interval for eigenvalues is not specified and consequently all</span></div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;          <span class="comment">// eigenvalues/eigenpairs will be computed</span></div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;          <span class="keywordflow">if</span> (!use_values)</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;            {</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;              <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>          = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;              all_eigenpairs = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;            }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;            {</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;              <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>          = <span class="charliteral">&#39;V&#39;</span>;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;              all_eigenpairs = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;              vl = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(eigenvalue_limits.first, eigenvalue_limits.second);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;              vu = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvalue_limits.first, eigenvalue_limits.second);</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;            }</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        }</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        {</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;          <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>          = <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;          all_eigenpairs = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;          <span class="comment">// as Fortran starts counting/indexing from 1 unlike C/C++, where it</span></div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;          <span class="comment">// starts from 0</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;          il = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(eigenvalue_idx.first, eigenvalue_idx.second) + 1;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;          iu = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvalue_idx.first, eigenvalue_idx.second) + 1;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        }</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="comment">       * by setting lwork to -1 a workspace query for optimal length of work is</span></div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="comment">       * performed</span></div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;      <span class="keywordtype">int</span>         lwork  = -1;</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      <span class="keywordtype">int</span>         liwork = -1;</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *eigenvectors_loc =</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        (compute_eigenvectors ? <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;values.data() : <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(1);</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      iwork.resize(1);</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      <span class="keywordflow">if</span> (all_eigenpairs)</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        {</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;          psyev(&amp;jobz,</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;                &amp;uplo,</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                A_loc,</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;                &amp;submatrix_row,</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                &amp;submatrix_column,</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;                ev.data(),</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                eigenvectors_loc,</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;                &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;                &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;descriptor,</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;                <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                &amp;lwork,</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;                &amp;info);</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;psyev&quot;</span>, info));</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        }</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;        {</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;          <span class="keywordtype">char</span> cmach = compute_eigenvectors ? <span class="charliteral">&#39;U&#39;</span> : <span class="charliteral">&#39;S&#39;</span>;</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;          plamch(&amp;(this-&gt;grid-&gt;blacs_context), &amp;cmach, abstol);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;          abstol *= 2;</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          ifail.resize(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>);</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;          iclustr.resize(2 * <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows * <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns);</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;          gap.resize(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows * <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns);</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          psyevx(&amp;jobz,</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;                 &amp;<a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>,</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;                 &amp;uplo,</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;                 &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;                 A_loc,</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;                 &amp;submatrix_row,</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;                 &amp;submatrix_column,</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;                 <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;                 &amp;vl,</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                 &amp;vu,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                 &amp;il,</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;                 &amp;iu,</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;                 &amp;abstol,</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;                 &amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>,</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;                 &amp;nz,</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;                 ev.data(),</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;                 &amp;orfac,</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;                 eigenvectors_loc,</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;                 &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;                 &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;                 <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;descriptor,</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                 <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                 &amp;lwork,</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                 iwork.data(),</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;                 &amp;liwork,</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                 ifail.data(),</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                 iclustr.data(),</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                 gap.data(),</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                 &amp;info);</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;psyevx&quot;</span>, info));</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        }</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;      lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>[0]);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <span class="keywordflow">if</span> (all_eigenpairs)</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        {</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;          psyev(&amp;jobz,</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;                &amp;uplo,</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                A_loc,</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                &amp;submatrix_row,</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                &amp;submatrix_column,</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;                <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;                ev.data(),</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;                eigenvectors_loc,</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;                &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;                &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;descriptor,</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;                <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;                &amp;lwork,</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;                &amp;info);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;psyev&quot;</span>, info));</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        }</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;          liwork = iwork[0];</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(liwork &gt; 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;          iwork.resize(liwork);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160; </div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;          psyevx(&amp;jobz,</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;                 &amp;<a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>,</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;                 &amp;uplo,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;                 &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;                 A_loc,</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;                 &amp;submatrix_row,</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;                 &amp;submatrix_column,</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;                 <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;                 &amp;vl,</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;                 &amp;vu,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;                 &amp;il,</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;                 &amp;iu,</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;                 &amp;abstol,</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;                 &amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>,</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;                 &amp;nz,</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;                 ev.data(),</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;                 &amp;orfac,</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;                 eigenvectors_loc,</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;                 &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                 &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;                 <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;descriptor,</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;                 <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;                 &amp;lwork,</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;                 iwork.data(),</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                 &amp;liwork,</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                 ifail.data(),</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;                 iclustr.data(),</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;                 gap.data(),</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;                 &amp;info);</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160; </div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;psyevx&quot;</span>, info));</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        }</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <span class="comment">// if eigenvectors are queried copy eigenvectors to original matrix</span></div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="comment">// as the temporary matrix eigenvectors has identical dimensions and</span></div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      <span class="comment">// block-cyclic distribution we simply swap the local array</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <span class="keywordflow">if</span> (compute_eigenvectors)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.swap(eigenvectors-&gt;values);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160; </div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="comment">// adapt the size of ev to fit m upon return</span></div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <span class="keywordflow">while</span> (ev.size() &gt; <span class="keyword">static_cast&lt;</span><a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a><span class="keyword">&gt;</span>(<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>))</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        ev.pop_back();</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="comment">   * send number of computed eigenvalues to inactive processes</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(&amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>, 1);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="comment">   * inactive processes have to resize array of eigenvalues</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;    ev.resize(<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="comment">   * send the eigenvalues to processors not being part of the process grid</span></div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(ev.data(), ev.size());</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160; </div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="comment">   * if only eigenvalues are queried the content of the matrix will be destroyed</span></div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="comment">   * if the eigenpairs are queried matrix A on exit stores the eigenvectors in</span></div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="comment">   * the columns</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  <span class="keywordflow">if</span> (compute_eigenvectors)</div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    {</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;      <span class="keyword">property</span> = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>;</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;      <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a86885edfb652da041a42028c469d32b0">LAPACKSupport::eigenvalues</a>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    }</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0">LAPACKSupport::unusable</a>;</div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160; </div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <span class="keywordflow">return</span> ev;</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;}</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160; </div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l01763"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#acf56a3d220794a7c0e0839a1f44ff539"> 1763</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#acf56a3d220794a7c0e0839a1f44ff539">ScaLAPACKMatrix&lt;NumberType&gt;::eigenpairs_symmetric_by_index_MRRR</a>(</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;index_limits,</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>                                   compute_eigenvectors)</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;{</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <span class="comment">// Check validity of index limits.</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(index_limits.first, <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>));</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(index_limits.second, <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>));</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; idx =</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    std::make_pair(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(index_limits.first, index_limits.second),</div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(index_limits.first, index_limits.second));</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160; </div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;  <span class="comment">// Compute all eigenvalues/eigenvectors.</span></div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  <span class="keywordflow">if</span> (idx.first == 0 &amp;&amp; idx.second == <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> - 1))</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    <span class="keywordflow">return</span> eigenpairs_symmetric_MRRR(compute_eigenvectors);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">return</span> eigenpairs_symmetric_MRRR(compute_eigenvectors, idx);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;}</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160; </div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l01786"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a0a53f1e6c1fce2ca93b718f34d215ae9"> 1786</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a0a53f1e6c1fce2ca93b718f34d215ae9">ScaLAPACKMatrix&lt;NumberType&gt;::eigenpairs_symmetric_by_value_MRRR</a>(</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  <span class="keyword">const</span> std::pair&lt;NumberType, NumberType&gt; &amp;value_limits,</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>                               compute_eigenvectors)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;{</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <a class="code" href="group__Exceptions.html#ga83a07eaacbb97effd136cf5e49fa831a">AssertIsFinite</a>(value_limits.first);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  <a class="code" href="group__Exceptions.html#ga83a07eaacbb97effd136cf5e49fa831a">AssertIsFinite</a>(value_limits.second);</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; <a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a> =</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    std::make_pair(<a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;                   <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>);</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">return</span> eigenpairs_symmetric_MRRR(compute_eigenvectors, <a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a>, value_limits);</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;}</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l01804"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a56a20ea915118b8b2b149e3d4af10a5e"> 1804</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a56a20ea915118b8b2b149e3d4af10a5e">ScaLAPACKMatrix&lt;NumberType&gt;::eigenpairs_symmetric_MRRR</a>(</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>                                   compute_eigenvectors,</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;eigenvalue_idx,</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <span class="keyword">const</span> std::pair&lt;NumberType, NumberType&gt; &amp;    eigenvalue_limits)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;{</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a>,</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Matrix has to be symmetric for this operation.&quot;</span>));</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160; </div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160; </div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_values = (std::isnan(eigenvalue_limits.first) ||</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                           std::isnan(eigenvalue_limits.second)) ?</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                            <span class="keyword">false</span> :</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                            <span class="keyword">true</span>;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> use_indices =</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    ((eigenvalue_idx.first == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>) ||</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;     (eigenvalue_idx.second == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)) ?</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;      <span class="keyword">false</span> :</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;      <span class="keyword">true</span>;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160; </div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    !(use_values &amp;&amp; use_indices),</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;      <span class="stringliteral">&quot;Prescribing both the index and value range for the eigenvalues is ambiguous&quot;</span>));</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <span class="comment">// If computation of eigenvectors is not required, use a sufficiently small</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="comment">// distributed matrix.</span></div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  std::unique_ptr&lt;ScaLAPACKMatrix&lt;NumberType&gt;&gt; <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a> =</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    compute_eigenvectors ?</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;      std::make_unique&lt;ScaLAPACKMatrix&lt;NumberType&gt;&gt;(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                                                    <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                                                    row_block_size) :</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;      std::make_unique&lt;<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a>&gt;(</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows, <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns, <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>, 1, 1);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;property = <a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <span class="comment">// Number of eigenvalues to be returned from psyevr; upon successful exit ev</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;  <span class="comment">// contains the m seclected eigenvalues in ascending order.</span></div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <span class="keywordtype">int</span>                     <a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a> = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;  std::vector&lt;NumberType&gt; ev(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>);</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160; </div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;  <span class="comment">// Number of eigenvectors to be returned;</span></div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <span class="comment">// Upon successful exit the first m=nz columns contain the selected</span></div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;  <span class="comment">// eigenvectors (only if jobz==&#39;V&#39;).</span></div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <span class="keywordtype">int</span> nz = 0;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    {</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;      <span class="keywordtype">int</span> info = 0;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;<span class="comment">       * For jobz==N only eigenvalues are computed, for jobz=&#39;V&#39; also the</span></div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;<span class="comment">       * eigenvectors of the matrix are computed.</span></div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <span class="keywordtype">char</span> jobz = compute_eigenvectors ? <span class="charliteral">&#39;V&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <span class="comment">// Default value is to compute all eigenvalues and optionally</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="comment">// eigenvectors.</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;      <span class="keywordtype">char</span>       <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a> = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> vl = <a class="code" href="classNumberType.html">NumberType</a>(), vu = <a class="code" href="classNumberType.html">NumberType</a>();</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;      <span class="keywordtype">int</span>        il = 1, iu = 1;</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;      <span class="comment">// Index range for eigenvalues is not specified.</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;      <span class="keywordflow">if</span> (!use_indices)</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;        {</div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;          <span class="comment">// Interval for eigenvalues is not specified and consequently all</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;          <span class="comment">// eigenvalues/eigenpairs will be computed.</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;          <span class="keywordflow">if</span> (!use_values)</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;            {</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;              <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a> = <span class="charliteral">&#39;A&#39;</span>;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            }</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            {</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;              <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a> = <span class="charliteral">&#39;V&#39;</span>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;              vl = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(eigenvalue_limits.first, eigenvalue_limits.second);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;              vu = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvalue_limits.first, eigenvalue_limits.second);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;            }</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        }</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;          <a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a> = <span class="charliteral">&#39;I&#39;</span>;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;          <span class="comment">// As Fortran starts counting/indexing from 1 unlike C/C++, where it</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;          <span class="comment">// starts from 0.</span></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;          il = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(eigenvalue_idx.first, eigenvalue_idx.second) + 1;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;          iu = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvalue_idx.first, eigenvalue_idx.second) + 1;</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        }</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160; </div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="comment">       * By setting lwork to -1 a workspace query for optimal length of work is</span></div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="comment">       * performed.</span></div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordtype">int</span>         lwork  = -1;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;      <span class="keywordtype">int</span>         liwork = -1;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *eigenvectors_loc =</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        (compute_eigenvectors ? <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;values.data() : <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(1);</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;      iwork.resize(1);</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160; </div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;      psyevr(&amp;jobz,</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;             &amp;<a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>,</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;             &amp;uplo,</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;             &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;             A_loc,</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;             &amp;vl,</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;             &amp;vu,</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;             &amp;il,</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;             &amp;iu,</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;             &amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>,</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;             &amp;nz,</div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;             ev.data(),</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;             eigenvectors_loc,</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;             &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;             &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;             <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;descriptor,</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;             <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;             &amp;lwork,</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;             iwork.data(),</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;             &amp;liwork,</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;             &amp;info);</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160; </div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;psyevr&quot;</span>, info));</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160; </div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>[0]);</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;      liwork = iwork[0];</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      iwork.resize(liwork);</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      psyevr(&amp;jobz,</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;             &amp;<a class="code" href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a>,</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;             &amp;uplo,</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;             &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;             A_loc,</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;             &amp;vl,</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;             &amp;vu,</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;             &amp;il,</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;             &amp;iu,</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;             &amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>,</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;             &amp;nz,</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;             ev.data(),</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;             eigenvectors_loc,</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;             &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;             &amp;<a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;             <a class="code" href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">eigenvectors</a>-&gt;descriptor,</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;             <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;             &amp;lwork,</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;             iwork.data(),</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;             &amp;liwork,</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;             &amp;info);</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160; </div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;psyevr&quot;</span>, info));</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160; </div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      <span class="keywordflow">if</span> (compute_eigenvectors)</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;          <a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a> == nz,</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;          <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            <span class="stringliteral">&quot;psyevr failed to compute all eigenvectors for the selected eigenvalues&quot;</span>));</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="comment">// If eigenvectors are queried, copy eigenvectors to original matrix.</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;      <span class="comment">// As the temporary matrix eigenvectors has identical dimensions and</span></div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="comment">// block-cyclic distribution we simply swap the local array.</span></div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;      <span class="keywordflow">if</span> (compute_eigenvectors)</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.swap(eigenvectors-&gt;values);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160; </div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <span class="comment">// Adapt the size of ev to fit m upon return.</span></div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="keywordflow">while</span> (ev.size() &gt; <span class="keyword">static_cast&lt;</span><a class="code" href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">size_type</a><span class="keyword">&gt;</span>(<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>))</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        ev.pop_back();</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    }</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;<span class="comment">   * Send number of computed eigenvalues to inactive processes.</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(&amp;<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>, 1);</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="comment">   * Inactive processes have to resize array of eigenvalues.</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    ev.resize(<a class="code" href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a>);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;<span class="comment">   * Send the eigenvalues to processors not being part of the process grid.</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(ev.data(), ev.size());</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;<span class="comment">   * If only eigenvalues are queried, the content of the matrix will be</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;<span class="comment">   * destroyed. If the eigenpairs are queried, matrix A on exit stores the</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;<span class="comment">   * eigenvectors in the columns.</span></div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;  <span class="keywordflow">if</span> (compute_eigenvectors)</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    {</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      <span class="keyword">property</span> = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>;</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;      <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a86885edfb652da041a42028c469d32b0">LAPACKSupport::eigenvalues</a>;</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    }</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0">LAPACKSupport::unusable</a>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <span class="keywordflow">return</span> ev;</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;}</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160; </div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;std::vector&lt;NumberType&gt;</div>
<div class="line"><a name="l02014"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a04feb5d5c22d71a40c6912ec8f0ee2f9"> 2014</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a04feb5d5c22d71a40c6912ec8f0ee2f9">ScaLAPACKMatrix&lt;NumberType&gt;::compute_SVD</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> *<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>,</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;                                         <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> *VT)</div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;{</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == column_block_size,</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;         <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(row_block_size, column_block_size));</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> left_singluar_vectors  = (<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a> != <span class="keyword">nullptr</span>) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> right_singluar_vectors = (VT != <span class="keyword">nullptr</span>) ? <span class="keyword">true</span> : <span class="keyword">false</span>;</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  <span class="keywordflow">if</span> (left_singluar_vectors)</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    {</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;n_rows, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;n_rows));</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;n_rows == <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;n_columns,</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;n_rows, <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;n_columns));</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;row_block_size,</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(row_block_size, <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;row_block_size));</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(column_block_size == <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;column_block_size,</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(column_block_size, <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;column_block_size));</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;blacs_context == <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;grid-&gt;blacs_context,</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;blacs_context, <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;grid-&gt;blacs_context));</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    }</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;  <span class="keywordflow">if</span> (right_singluar_vectors)</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    {</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>,</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a> == VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>));</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(row_block_size, VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>));</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(column_block_size == VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(column_block_size, VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>));</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;blacs_context == VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;blacs_context,</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;blacs_context,</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;                                  VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;blacs_context));</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    }</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  std::vector&lt;NumberType&gt; sv(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, n_columns));</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    {</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;      <span class="keywordtype">char</span>        jobu   = left_singluar_vectors ? <span class="charliteral">&#39;V&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;      <span class="keywordtype">char</span>        jobvt  = right_singluar_vectors ? <span class="charliteral">&#39;V&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc  = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *U_loc  = left_singluar_vectors ? <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;values.data() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *VT_loc = right_singluar_vectors ? VT-&gt;<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;      <span class="keywordtype">int</span>         info   = 0;</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;<span class="comment">       * by setting lwork to -1 a workspace query for optimal length of work is</span></div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;<span class="comment">       * performed</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;      <span class="keywordtype">int</span> lwork = -1;</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(1);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160; </div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;      pgesvd(&amp;jobu,</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;             &amp;jobvt,</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;             &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;             A_loc,</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;             &amp;*sv.begin(),</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;             U_loc,</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;             &amp;<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;             &amp;<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;             <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;descriptor,</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;             VT_loc,</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;             &amp;VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;             &amp;VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;             VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;             <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;             &amp;lwork,</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;             &amp;info);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgesvd&quot;</span>, info));</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160; </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;      lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>[0]);</div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160; </div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;      pgesvd(&amp;jobu,</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;             &amp;jobvt,</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;             &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;             A_loc,</div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;             &amp;*sv.begin(),</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;             U_loc,</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;             &amp;<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;submatrix_row,</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;             &amp;<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;submatrix_column,</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;             <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>-&gt;descriptor,</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;             VT_loc,</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;             &amp;VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;             &amp;VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;             VT-&gt;<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;             <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;             &amp;lwork,</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;             &amp;info);</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgesvd&quot;</span>, info));</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;    }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="comment">   * send the singular values to processors not being part of the process grid</span></div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(sv.data(), sv.size());</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160; </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;  <span class="keyword">property</span> = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0">LAPACKSupport::State::unusable</a>;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;  <span class="keywordflow">return</span> sv;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;}</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160; </div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160; </div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a23f528e743bbb29f0608960eb420c102"> 2134</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a23f528e743bbb29f0608960eb420c102">ScaLAPACKMatrix&lt;NumberType&gt;::least_squares</a>(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;B,</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;                                           <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;{</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a> == B.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>,</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The matrices A and B need to have the same process grid&quot;</span>));</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;           <span class="stringliteral">&quot;Matrix B has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>)</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(n_columns == B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(n_columns, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;    }</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;    {</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> == B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>, <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, B.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>));</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    }</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160; </div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;  <span class="comment">// see</span></div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;  <span class="comment">// https://www.ibm.com/support/knowledgecenter/en/SSNR5K_4.2.0/com.ibm.cluster.pessl.v4r2.pssl100.doc/am6gr_lgels.htm</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == column_block_size,</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;           <span class="stringliteral">&quot;Use identical block sizes for rows and columns of matrix A&quot;</span>));</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a> == B.<a class="code" href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">column_block_size</a>,</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;           <span class="stringliteral">&quot;Use identical block sizes for rows and columns of matrix B&quot;</span>));</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == B.<a class="code" href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">row_block_size</a>,</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;           <span class="stringliteral">&quot;Use identical block-cyclic distribution for matrices A and B&quot;</span>));</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160; </div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;      <span class="keywordtype">char</span>        trans = <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a> ? <span class="charliteral">&#39;T&#39;</span> : <span class="charliteral">&#39;N&#39;</span>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;      <a class="code" href="classNumberType.html">NumberType</a> *B_loc = B.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>();</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;      <span class="keywordtype">int</span>         info  = 0;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;      <span class="comment">/*</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">       * by setting lwork to -1 a workspace query for optimal length of work is</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="comment">       * performed</span></div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="comment">       */</span></div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;      <span class="keywordtype">int</span> lwork = -1;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(1);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160; </div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;      pgels(&amp;trans,</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;            &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;            &amp;n_columns,</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            A_loc,</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;            &amp;submatrix_row,</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;            &amp;submatrix_column,</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;            <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            B_loc,</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;            B.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;            <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;            &amp;lwork,</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;            &amp;info);</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgels&quot;</span>, info));</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160; </div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>[0]);</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160; </div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;      pgels(&amp;trans,</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;            &amp;n_columns,</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>,</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            A_loc,</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;            &amp;submatrix_row,</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;            &amp;submatrix_column,</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            B_loc,</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">submatrix_row</a>,</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            &amp;B.<a class="code" href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">submatrix_column</a>,</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;            B.<a class="code" href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">descriptor</a>,</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;            <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            &amp;lwork,</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            &amp;info);</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pgels&quot;</span>, info));</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    }</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0">LAPACKSupport::State::unusable</a>;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;}</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160; </div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l02226"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a0a17919a2ff3b9c8dc1f76beca7f57b4"> 2226</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a0a17919a2ff3b9c8dc1f76beca7f57b4">ScaLAPACKMatrix&lt;NumberType&gt;::pseudoinverse</a>(<span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> ratio)</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;{</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a>,</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Matrix state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(row_block_size == column_block_size,</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;           <span class="stringliteral">&quot;Use identical block sizes for rows and columns of matrix A&quot;</span>));</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    ratio &gt; 0. &amp;&amp; ratio &lt; 1.,</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;      <span class="stringliteral">&quot;input parameter ratio has to be larger than zero and smaller than 1&quot;</span>));</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160; </div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;                                <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;                                <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;                                row_block_size,</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;                                row_block_size,</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;                                <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>);</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> VT(n_columns,</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;                                 n_columns,</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;                                 <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;                                 row_block_size,</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;                                 row_block_size,</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                                 <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>);</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;  std::vector&lt;NumberType&gt;     sv = this-&gt;compute_SVD(&amp;<a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>, &amp;VT);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(sv[0] &gt; <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::numeric_limits&lt;NumberType&gt;::min</a>(),</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Matrix has rank 0&quot;</span>));</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160; </div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;  <span class="comment">// Get number of singular values fulfilling the following: sv[i] &gt; sv[0] *</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  <span class="comment">// ratio Obviously, 0-th element already satisfies sv[0] &gt; sv[0] * ratio The</span></div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;  <span class="comment">// singular values in sv are ordered by descending value so we break out of</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="comment">// the loop if a singular value is smaller than sv[0] * ratio.</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>            n_sv = 1;</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;  std::vector&lt;NumberType&gt; inv_sigma;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;  inv_sigma.push_back(1 / sv[0]);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160; </div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 1; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; sv.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;    <span class="keywordflow">if</span> (sv[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] &gt; sv[0] * ratio)</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;      {</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;        ++n_sv;</div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        inv_sigma.push_back(1 / sv[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;      }</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160; </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <span class="comment">// For the matrix multiplication we use only the columns of U and rows of VT</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <span class="comment">// which are associated with singular values larger than the limit. That saves</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;  <span class="comment">// computational time for matrices with rank significantly smaller than</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <span class="comment">// min(n_rows,n_columns)</span></div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> U_R(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;                                  n_sv,</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;                                  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;                                  row_block_size,</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;                                  row_block_size,</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;                                  <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>);</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> VT_R(n_sv,</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;                                   n_columns,</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;                                   <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;                                   row_block_size,</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                                   row_block_size,</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;                                   <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>);</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <a class="code" href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">U</a>.copy_to(U_R,</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            std::make_pair(0, 0),</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            std::make_pair(0, 0),</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            std::make_pair(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, n_sv));</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  VT.<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">copy_to</a>(VT_R,</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;             std::make_pair(0, 0),</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;             std::make_pair(0, 0),</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;             std::make_pair(n_sv, n_columns));</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160; </div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  VT_R.<a class="code" href="classScaLAPACKMatrix.html#a64013567ad63bbc2cee395c1b01fdb3b">scale_rows</a>(inv_sigma);</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;  this-&gt;<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(n_columns,</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;               <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;               this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>,</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;               row_block_size,</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;               column_block_size,</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;               <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>);</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;  VT_R.<a class="code" href="classScaLAPACKMatrix.html#aada5bc79adf4d2b6f7a0a586dd154553">mult</a>(1, U_R, 0, *<span class="keyword">this</span>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::State::inverse_matrix</a>;</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;  <span class="keywordflow">return</span> n_sv;</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;}</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160; </div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160; </div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160; </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<a class="code" href="classNumberType.html">NumberType</a></div>
<div class="line"><a name="l02313"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ad8c472d23a551bbbdfbfcfee4f5bbe51"> 2313</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ad8c472d23a551bbbdfbfcfee4f5bbe51">ScaLAPACKMatrix&lt;NumberType&gt;::reciprocal_condition_number</a>(</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;  <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> a_norm)<span class="keyword"> const</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::cholesky</a>,</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;           <span class="stringliteral">&quot;Matrix has to be in Cholesky state before calling this function.&quot;</span>));</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  <a class="code" href="classNumberType.html">NumberType</a>                  rcond = 0.;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    {</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;      <span class="keywordtype">int</span> liwork = n_local_rows;</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;      iwork.resize(liwork);</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160; </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;      <span class="keywordtype">int</span>               info  = 0;</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.data();</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;      <span class="comment">// by setting lwork to -1 a workspace query for optimal length of work is</span></div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;      <span class="comment">// performed</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;      <span class="keywordtype">int</span> lwork = -1;</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(1);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;      ppocon(&amp;uplo,</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;             A_loc,</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;             &amp;a_norm,</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;             &amp;rcond,</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;             <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;             &amp;lwork,</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;             iwork.data(),</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;             &amp;liwork,</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;             &amp;info);</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pdpocon&quot;</span>, info));</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;      lwork = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespaceDifferentiation_1_1SD.html#a6545410ba18556ebf7c478b6ad9939f6">std::ceil</a>(<a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>[0]));</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;      <span class="comment">// now the actual run:</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;      ppocon(&amp;uplo,</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;             &amp;n_columns,</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;             A_loc,</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;             &amp;submatrix_row,</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;             &amp;submatrix_column,</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;             <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;             &amp;a_norm,</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;             &amp;rcond,</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;             <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data(),</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;             &amp;lwork,</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;             iwork.data(),</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;             &amp;liwork,</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;             &amp;info);</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(info == 0, LAPACKSupport::ExcErrorCode(<span class="stringliteral">&quot;pdpocon&quot;</span>, info));</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;    }</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(&amp;rcond);</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  <span class="keywordflow">return</span> rcond;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;}</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160; </div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<a class="code" href="classNumberType.html">NumberType</a></div>
<div class="line"><a name="l02375"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a9fae8f6bbe61900874e495b566059ed9"> 2375</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a9fae8f6bbe61900874e495b566059ed9">ScaLAPACKMatrix&lt;NumberType&gt;::l1_norm</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>(<span class="charliteral">&#39;O&#39;</span>);</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a>)</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <span class="keywordflow">return</span> norm_symmetric(<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;    <span class="keywordflow">return</span> norm_general(<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;}</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160; </div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<a class="code" href="classNumberType.html">NumberType</a></div>
<div class="line"><a name="l02389"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#af08bd68181f1690263ca241568a65e6e"> 2389</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#af08bd68181f1690263ca241568a65e6e">ScaLAPACKMatrix&lt;NumberType&gt;::linfty_norm</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>(<span class="charliteral">&#39;I&#39;</span>);</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160; </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a>)</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;    <span class="keywordflow">return</span> norm_symmetric(<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>);</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;    <span class="keywordflow">return</span> norm_general(<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>);</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;}</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; </div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160; </div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<a class="code" href="classNumberType.html">NumberType</a></div>
<div class="line"><a name="l02403"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a08c248dd3d7474ad88f01f361fb38763"> 2403</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a08c248dd3d7474ad88f01f361fb38763">ScaLAPACKMatrix&lt;NumberType&gt;::frobenius_norm</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>(<span class="charliteral">&#39;F&#39;</span>);</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; </div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a>)</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;    <span class="keywordflow">return</span> norm_symmetric(<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>);</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    <span class="keywordflow">return</span> norm_general(<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;}</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; </div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<a class="code" href="classNumberType.html">NumberType</a></div>
<div class="line"><a name="l02417"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a8c9e68ebdb81c95dc91a5cadc2d8d44e"> 2417</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a8c9e68ebdb81c95dc91a5cadc2d8d44e">ScaLAPACKMatrix&lt;NumberType&gt;::norm_general</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a> ||</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;           <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::inverse_matrix</a>,</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;norms can be called in matrix state only.&quot;</span>));</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;  <a class="code" href="classNumberType.html">NumberType</a>                  res = 0.;</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;    {</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iarow = indxg2p_(&amp;submatrix_row,</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                                 &amp;row_block_size,</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;                                 &amp;first_process_row,</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> iacol = indxg2p_(&amp;submatrix_column,</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                                 &amp;column_block_size,</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_column),</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                                 &amp;first_process_column,</div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns));</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> mp0   = numroc_(&amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;                              &amp;row_block_size,</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                              &amp;iarow,</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> nq0   = numroc_(&amp;n_columns,</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                              &amp;column_block_size,</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_column),</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                              &amp;iacol,</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns));</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;      <span class="comment">// type=&#39;M&#39;: compute largest absolute value</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;      <span class="comment">// type=&#39;F&#39; || type=&#39;E&#39;: compute Frobenius norm</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;      <span class="comment">// type=&#39;0&#39; || type=&#39;1&#39;: compute infinity norm</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;      <span class="keywordtype">int</span> lwork = 0; <span class="comment">// for type == &#39;M&#39; || type == &#39;F&#39; || type == &#39;E&#39;</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a> == <span class="charliteral">&#39;O&#39;</span> || <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a> == <span class="charliteral">&#39;1&#39;</span>)</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;        lwork = nq0;</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a> == <span class="charliteral">&#39;I&#39;</span>)</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;        lwork = mp0;</div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.begin();</div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;      res                     = plange(&amp;<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>,</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;                   &amp;<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;                   &amp;n_columns,</div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;                   A_loc,</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;                   &amp;submatrix_row,</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;                   &amp;submatrix_column,</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;                   <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;                   <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data());</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;    }</div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(&amp;res);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;}</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160; </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<a class="code" href="classNumberType.html">NumberType</a></div>
<div class="line"><a name="l02476"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#aa41a2ed7e7d97d1bab0742f8dd4f48b5"> 2476</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#aa41a2ed7e7d97d1bab0742f8dd4f48b5">ScaLAPACKMatrix&lt;NumberType&gt;::norm_symmetric</a>(<span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a> ||</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;           <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> == <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::inverse_matrix</a>,</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;norms can be called in matrix state only.&quot;</span>));</div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a> == <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a>,</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Matrix has to be symmetric for this operation.&quot;</span>));</div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;  std::lock_guard&lt;std::mutex&gt; lock(mutex);</div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;  <a class="code" href="classNumberType.html">NumberType</a>                  res = 0.;</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160; </div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    {</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;      <span class="comment">// int IROFFA = MOD( IA-1, MB_A )</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;      <span class="comment">// int ICOFFA = MOD( JA-1, NB_A )</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> lcm =</div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;        ilcm_(&amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows), &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns));</div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="fe__nedelec__sz__0_8txt.html#af4a7b1c52711f25dcb91bc3d69a63d18">v2</a> = lcm / (<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows);</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160; </div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> IAROW = indxg2p_(&amp;submatrix_row,</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                                 &amp;row_block_size,</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;                                 &amp;first_process_row,</div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> IACOL = indxg2p_(&amp;submatrix_column,</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                                 &amp;column_block_size,</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_column),</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                                 &amp;first_process_column,</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;                                 &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns));</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> Np0   = numroc_(&amp;n_columns <span class="comment">/*+IROFFA*/</span>,</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;                              &amp;row_block_size,</div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_row),</div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;                              &amp;IAROW,</div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_rows));</div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> Nq0   = numroc_(&amp;n_columns <span class="comment">/*+ICOFFA*/</span>,</div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;                              &amp;column_block_size,</div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;this_process_column),</div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;                              &amp;IACOL,</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;                              &amp;(<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;n_process_columns));</div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160; </div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="fe__nedelec__sz__0_8txt.html#a608cb7709f379e8a072b27b7b897d245">v1</a>  = iceil_(&amp;Np0, &amp;row_block_size);</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ldw = (n_local_rows == n_local_columns) ?</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                        0 :</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                        row_block_size * iceil_(&amp;<a class="code" href="fe__nedelec__sz__0_8txt.html#a608cb7709f379e8a072b27b7b897d245">v1</a>, &amp;<a class="code" href="fe__nedelec__sz__0_8txt.html#af4a7b1c52711f25dcb91bc3d69a63d18">v2</a>);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> lwork =</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        (<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a> == <span class="charliteral">&#39;M&#39;</span> || <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a> == <span class="charliteral">&#39;F&#39;</span> || <a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a> == <span class="charliteral">&#39;E&#39;</span>) ? 0 : 2 * Nq0 + Np0 + ldw;</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.resize(lwork);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;      <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> *A_loc = this-&gt;<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">values</a>.begin();</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;      res                     = plansy(&amp;<a class="code" href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a>,</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                   &amp;uplo,</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                   &amp;n_columns,</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;                   A_loc,</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;                   &amp;submatrix_row,</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;                   &amp;submatrix_column,</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                   <a class="code" href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a>,</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                   <a class="code" href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a>.data());</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;  <a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;send_to_inactive(&amp;res);</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  <span class="keywordflow">return</span> res;</div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;}</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160; </div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160; </div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160; </div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="preprocessor">#  ifdef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a></div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;{</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;  <span class="keyword">namespace</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  {</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    create_HDF5_state_enum_id(hid_t &amp;state_enum_id)</div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;    {</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;      <span class="comment">// create HDF5 enum type for LAPACKSupport::State</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;      <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638">LAPACKSupport::State</a> val;</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;      state_enum_id = H5Tcreate(H5T_ENUM, <span class="keyword">sizeof</span>(<a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638">LAPACKSupport::State</a>));</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;      val           = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::State::cholesky</a>;</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;      herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;cholesky&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;      val    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a86885edfb652da041a42028c469d32b0">LAPACKSupport::State::eigenvalues</a>;</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;eigenvalues&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;      val    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::State::inverse_matrix</a>;</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;inverse_matrix&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;      val    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a443dbf06df77b3d40eb1a355ae88e5ba">LAPACKSupport::State::inverse_svd</a>;</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;inverse_svd&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;      val    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a965e8f1c07847958b77370b5074bee91">LAPACKSupport::State::lu</a>;</div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;lu&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;      val    = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">LAPACKSupport::State::matrix</a>;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;matrix&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;      val    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638aef1753b142c24961b944eab49b33b1db">LAPACKSupport::State::svd</a>;</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;svd&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;      val    = <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0">LAPACKSupport::State::unusable</a>;</div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(state_enum_id, <span class="stringliteral">&quot;unusable&quot;</span>, &amp;val);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;    }</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160; </div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;    create_HDF5_property_enum_id(hid_t &amp;property_enum_id)</div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;    {</div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;      <span class="comment">// create HDF5 enum type for LAPACKSupport::Property</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;      property_enum_id = H5Tcreate(H5T_ENUM, <span class="keyword">sizeof</span>(<a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a>));</div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;      <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a> prop = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7bdd80b5e29a004e22f2aeb150e5ec51">LAPACKSupport::Property::diagonal</a>;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;      herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(property_enum_id, <span class="stringliteral">&quot;diagonal&quot;</span>, &amp;prop);</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;      prop   = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::Property::general</a>;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(property_enum_id, <span class="stringliteral">&quot;general&quot;</span>, &amp;prop);</div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;      prop   = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a2ea295a0904915804c899950757b1de2">LAPACKSupport::Property::hessenberg</a>;</div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(property_enum_id, <span class="stringliteral">&quot;hessenberg&quot;</span>, &amp;prop);</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;      prop   = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7a4b0582dd1e9230b5b59a6b2b698713">LAPACKSupport::Property::lower_triangular</a>;</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(property_enum_id, <span class="stringliteral">&quot;lower_triangular&quot;</span>, &amp;prop);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;      prop   = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::Property::symmetric</a>;</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(property_enum_id, <span class="stringliteral">&quot;symmetric&quot;</span>, &amp;prop);</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;      prop   = <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0">LAPACKSupport::Property::upper_triangular</a>;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tenum_insert(property_enum_id, <span class="stringliteral">&quot;upper_triangular&quot;</span>, &amp;prop);</div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;    }</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;  } <span class="comment">// namespace</span></div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;} <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160; </div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160; </div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l02608"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a988e7c86e7e560b2d8c815317a565371"> 2608</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a988e7c86e7e560b2d8c815317a565371">ScaLAPACKMatrix&lt;NumberType&gt;::save</a>(</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;  <span class="keyword">const</span> std::string &amp;                          filename,</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;<a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;  (void)filename;</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;  (void)<a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;HDF5 support is disabled.&quot;</span>));</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;  std::pair&lt;unsigned int, unsigned int&gt; chunks_size_ = <a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>;</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160; </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;  <span class="keywordflow">if</span> (chunks_size_.first == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a> ||</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;      chunks_size_.second == <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    {</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;      <span class="comment">// default: store the matrix in chunks of columns</span></div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;      chunks_size_.first  = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>;</div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;      chunks_size_.second = 1;</div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    }</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(chunks_size_.first &gt; 0,</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The row chunk size must be larger than 0.&quot;</span>));</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(chunks_size_.first, <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a> + 1);</div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(chunks_size_.second &gt; 0,</div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;         <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;The column chunk size must be larger than 0.&quot;</span>));</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;  <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(chunks_size_.second, n_columns + 1);</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="preprocessor">#    ifdef H5_HAVE_PARALLEL</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;  <span class="comment">// implementation for configurations equipped with a parallel file system</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;  save_parallel(filename, chunks_size_);</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160; </div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="preprocessor">#    else</span></div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;  <span class="comment">// implementation for configurations with no parallel file system</span></div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;  save_serial(filename, chunks_size_);</div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160; </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="preprocessor">#    endif</span></div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;}</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160; </div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160; </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160; </div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a86231732a54f89df92e15ec186d46e82"> 2650</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a86231732a54f89df92e15ec186d46e82">ScaLAPACKMatrix&lt;NumberType&gt;::save_serial</a>(</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;  <span class="keyword">const</span> std::string &amp;                          filename,</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;<a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;  (void)filename;</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;  (void)<a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>;</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160; </div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="comment">   * The content of the distributed matrix is copied to a matrix using a 1x1</span></div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="comment">   * process grid. Therefore, one process has all the data and can write it to a</span></div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="comment">   * file.</span></div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="comment">   * Create a 1x1 column grid which will be used to initialize</span></div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="comment">   * an effectively serial ScaLAPACK matrix to gather the contents from the</span></div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="comment">   * current object</span></div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> column_grid =</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;    std::make_shared&lt;Utilities::MPI::ProcessGrid&gt;(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;                                                  1,</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;                                                  1);</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; </div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>                   MB = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, NB = n_columns;</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> tmp(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, n_columns, column_grid, MB, NB);</div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  copy_to(tmp);</div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160; </div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="comment">// the 1x1 grid has only one process and this one writes</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="comment">// the content of the matrix to the HDF5 file</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;  <span class="keywordflow">if</span> (tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    {</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;      herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>;</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160; </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;      <span class="comment">// create a new file using default properties</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;      hid_t file_id =</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        H5Fcreate(filename.c_str(), H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT);</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160; </div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;      <span class="comment">// modify dataset creation properties, i.e. enable chunking</span></div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;      hsize_t chunk_dims[2];</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;      <span class="comment">// revert order of rows and columns as ScaLAPACK uses column-major</span></div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;      <span class="comment">// ordering</span></div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      chunk_dims[0]       = <a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>.second;</div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;      chunk_dims[1]       = <a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>.first;</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;      hid_t data_property = H5Pcreate(H5P_DATASET_CREATE);</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>              = H5Pset_chunk(data_property, 2, chunk_dims);</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160; </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;      <span class="comment">// create the data space for the dataset</span></div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;      hsize_t dims[2];</div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;      <span class="comment">// change order of rows and columns as ScaLAPACKMatrix uses column major</span></div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;      <span class="comment">// ordering</span></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;      dims[0]            = n_columns;</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;      dims[1]            = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>;</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;      hid_t dataspace_id = H5Screate_simple(2, dims, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160; </div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;      <span class="comment">// create the dataset within the file using chunk creation properties</span></div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;      hid_t type_id    = <a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>());</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;      hid_t dataset_id = H5Dcreate2(file_id,</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;                                    <span class="stringliteral">&quot;/matrix&quot;</span>,</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;                                    type_id,</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;                                    dataspace_id,</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;                                    H5P_DEFAULT,</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;                                    data_property,</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;                                    H5P_DEFAULT);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160; </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      <span class="comment">// write the dataset</span></div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dwrite(</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;        dataset_id, type_id, H5S_ALL, H5S_ALL, H5P_DEFAULT, tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>());</div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160; </div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;      <span class="comment">// create HDF5 enum type for LAPACKSupport::State and</span></div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;      <span class="comment">// LAPACKSupport::Property</span></div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;      hid_t state_enum_id, property_enum_id;</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;      internal::create_HDF5_state_enum_id(state_enum_id);</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;      internal::create_HDF5_property_enum_id(property_enum_id);</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160; </div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      <span class="comment">// create the data space for the state enum</span></div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;      hsize_t dims_state[1];</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;      dims_state[0]              = 1;</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;      hid_t state_enum_dataspace = H5Screate_simple(1, dims_state, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;      <span class="comment">// create the dataset for the state enum</span></div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;      hid_t state_enum_dataset = H5Dcreate2(file_id,</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                                            <span class="stringliteral">&quot;/state&quot;</span>,</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                                            state_enum_id,</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;                                            state_enum_dataspace,</div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;                                            H5P_DEFAULT,</div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;                                            H5P_DEFAULT,</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;                                            H5P_DEFAULT);</div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      <span class="comment">// write the dataset for the state enum</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dwrite(state_enum_dataset,</div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;                        state_enum_id,</div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;                        H5P_DEFAULT,</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;                        &amp;<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>);</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160; </div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      <span class="comment">// create the data space for the property enum</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;      hsize_t dims_property[1];</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;      dims_property[0] = 1;</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      hid_t property_enum_dataspace =</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;        H5Screate_simple(1, dims_property, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;      <span class="comment">// create the dataset for the property enum</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;      hid_t property_enum_dataset = H5Dcreate2(file_id,</div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;                                               <span class="stringliteral">&quot;/property&quot;</span>,</div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;                                               property_enum_id,</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;                                               property_enum_dataspace,</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;                                               H5P_DEFAULT,</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;                                               H5P_DEFAULT,</div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;                                               H5P_DEFAULT);</div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;      <span class="comment">// write the dataset for the property enum</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dwrite(property_enum_dataset,</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;                        property_enum_id,</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;                        H5P_DEFAULT,</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;                        &amp;<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>);</div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160; </div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;      <span class="comment">// end access to the datasets and release resources used by them</span></div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_id);</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(state_enum_dataset);</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(property_enum_dataset);</div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160; </div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <span class="comment">// terminate access to the data spaces</span></div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_id);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(state_enum_dataspace);</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(property_enum_dataspace);</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160; </div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      <span class="comment">// release enum data types</span></div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(state_enum_id);</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(property_enum_id);</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;      <span class="comment">// release the creation property</span></div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Pclose(data_property);</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160; </div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;      <span class="comment">// close the file.</span></div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Fclose(file_id);</div>
<div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;    }</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;}</div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160; </div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160; </div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160; </div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a1c9a16cb5cdeb15f4ef1a18a3415dce2"> 2807</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a1c9a16cb5cdeb15f4ef1a18a3415dce2">ScaLAPACKMatrix&lt;NumberType&gt;::save_parallel</a>(</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <span class="keyword">const</span> std::string &amp;                          filename,</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;<a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>)<span class="keyword"> const</span></div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="keyword"></span>{</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  (void)filename;</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  (void)<a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>;</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160; </div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>(</div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator));</div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  MPI_Info info = MPI_INFO_NULL;</div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="comment">   * The content of the distributed matrix is copied to a matrix using a</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="comment">   * 1xn_processes process grid. Therefore, the processes hold contiguous chunks</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="comment">   * of the matrix, which they can write to the file</span></div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="comment">   *</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="comment">   * Create a 1xn_processes column grid</span></div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> column_grid =</div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;    std::make_shared&lt;Utilities::MPI::ProcessGrid&gt;(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                                                  1,</div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                                                  n_mpi_processes);</div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160; </div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> MB = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>;</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="comment">   * If the ratio n_columns/n_mpi_processes is smaller than the column block</span></div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="comment">   * size of the original matrix, the redistribution and saving of the matrix</span></div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="comment">   * requires a significant amount of MPI communication. Therefore, it is better</span></div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="comment">   * to set a minimum value for the block size NB, causing only</span></div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="comment">   * ceil(n_columns/NB) processes being actively involved in saving the matrix.</span></div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="comment">   * Example: A 2*10^9 x 400 matrix is distributed on a 80 x 5 process grid</span></div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="comment">   * using block size 32. Instead of distributing the matrix on a 1 x 400</span></div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="comment">   * process grid with a row block size of 2*10^9 and a column block size of 1,</span></div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="comment">   * the minimum value for NB yields that only ceil(400/32)=13 processes will be</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="comment">   * writing the matrix to disk.</span></div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NB = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespaceDifferentiation_1_1SD.html#a6545410ba18556ebf7c478b6ad9939f6">std::ceil</a>(</div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;                            <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(n_columns) / <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>)),</div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                          column_block_size);</div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160; </div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> tmp(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, n_columns, column_grid, MB, NB);</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;  copy_to(tmp);</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160; </div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;  <span class="comment">// get pointer to data held by the process</span></div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;  <a class="code" href="classNumberType.html">NumberType</a> *<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a> = (tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0) ? tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160; </div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;  herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>;</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;  <span class="comment">// dataset dimensions</span></div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;  hsize_t dims[2];</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160; </div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;  <span class="comment">// set up file access property list with parallel I/O access</span></div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;  hid_t plist_id = H5Pcreate(H5P_FILE_ACCESS);</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>         = H5Pset_fapl_mpio(plist_id, tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator, info);</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="comment">// create a new file collectively and release property list identifier</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  hid_t file_id =</div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;    H5Fcreate(filename.c_str(), H5F_ACC_TRUNC, H5P_DEFAULT, plist_id);</div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Pclose(plist_id);</div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160; </div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;  <span class="comment">// As ScaLAPACK, and therefore the class ScaLAPACKMatrix, uses column-major</span></div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;  <span class="comment">// ordering but HDF5 row-major ordering, we have to reverse entries related to</span></div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;  <span class="comment">// columns and rows in the following. create the dataspace for the dataset</span></div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;  dims[0] = tmp.<a class="code" href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">n_columns</a>;</div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;  dims[1] = tmp.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>;</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160; </div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;  hid_t filespace = H5Screate_simple(2, dims, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;  <span class="comment">// create the chunked dataset with default properties and close filespace</span></div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;  hsize_t chunk_dims[2];</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  <span class="comment">// revert order of rows and columns as ScaLAPACK uses column-major ordering</span></div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;  chunk_dims[0] = <a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>.second;</div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  chunk_dims[1] = <a class="code" href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">chunk_size</a>.first;</div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  plist_id      = H5Pcreate(H5P_DATASET_CREATE);</div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  H5Pset_chunk(plist_id, 2, chunk_dims);</div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;  hid_t type_id = <a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  hid_t dset_id = H5Dcreate2(</div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    file_id, <span class="stringliteral">&quot;/matrix&quot;</span>, type_id, filespace, H5P_DEFAULT, plist_id, H5P_DEFAULT);</div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160; </div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(filespace);</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160; </div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Pclose(plist_id);</div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;  <span class="comment">// gather the number of local rows and columns from all processes</span></div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;  std::vector&lt;int&gt; proc_n_local_rows(<a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>),</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    proc_n_local_columns(<a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>);</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;  <span class="keywordtype">int</span> ierr = <a class="code" href="mpi__0_8txt.html#a0585dbdf9f181004518cc3ae72b5b65f">MPI_Allgather</a>(&amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#a2aeb43089505bb7b32477271cc76312e">n_local_rows</a>,</div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;                           1,</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;                           MPI_INT,</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;                           proc_n_local_rows.data(),</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;                           1,</div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;                           MPI_INT,</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;                           tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;  ierr = <a class="code" href="mpi__0_8txt.html#a0585dbdf9f181004518cc3ae72b5b65f">MPI_Allgather</a>(&amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#a4b34cedd3940060edbe3ce4aeec09903">n_local_columns</a>,</div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;                       1,</div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;                       MPI_INT,</div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;                       proc_n_local_columns.data(),</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;                       1,</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;                       MPI_INT,</div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;                       tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160; </div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_rank(</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator));</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160; </div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;  <span class="comment">// hyperslab selection parameters</span></div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;  <span class="comment">// each process defines dataset in memory and writes it to the hyperslab in</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;  <span class="comment">// the file</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;  hsize_t <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>[2];</div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;  <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>[0]       = tmp.<a class="code" href="classScaLAPACKMatrix.html#a4b34cedd3940060edbe3ce4aeec09903">n_local_columns</a>;</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;  <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>[1]       = tmp.<a class="code" href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">n_rows</a>;</div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;  hid_t memspace = H5Screate_simple(2, <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;  hsize_t offset[2] = {0};</div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; my_rank; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;    offset[0] += proc_n_local_columns[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160; </div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;  <span class="comment">// select hyperslab in the file.</span></div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;  filespace = H5Dget_space(dset_id);</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>    = H5Sselect_hyperslab(</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;    filespace, H5S_SELECT_SET, offset, <span class="keyword">nullptr</span>, <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160; </div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  <span class="comment">// create property list for independent dataset write</span></div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;  plist_id = H5Pcreate(H5P_DATASET_XFER);</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>   = H5Pset_dxpl_mpio(plist_id, H5FD_MPIO_INDEPENDENT);</div>
<div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160; </div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;  <span class="comment">// process with no data will not participate in writing to the file</span></div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <span class="keywordflow">if</span> (tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0)</div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;    {</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dwrite(dset_id, type_id, memspace, filespace, plist_id, <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;    }</div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  <span class="comment">// close/release sources</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dset_id);</div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(filespace);</div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(memspace);</div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Pclose(plist_id);</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Fclose(file_id);</div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160; </div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;  <span class="comment">// before writing the state and property to file wait for</span></div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;  <span class="comment">// all processes to finish writing the matrix content to the file</span></div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;  ierr = MPI_Barrier(tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; </div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;  <span class="comment">// only root process will write state and property to the file</span></div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;  <span class="keywordflow">if</span> (tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;this_mpi_process == 0)</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    {</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;      <span class="comment">// open file using default properties</span></div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;      hid_t file_id_reopen =</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;        H5Fopen(filename.c_str(), H5F_ACC_RDWR, H5P_DEFAULT);</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160; </div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;      <span class="comment">// create HDF5 enum type for LAPACKSupport::State and</span></div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;      <span class="comment">// LAPACKSupport::Property</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;      hid_t state_enum_id, property_enum_id;</div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;      internal::create_HDF5_state_enum_id(state_enum_id);</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;      internal::create_HDF5_property_enum_id(property_enum_id);</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160; </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="comment">// create the data space for the state enum</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      hsize_t dims_state[1];</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      dims_state[0]              = 1;</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;      hid_t state_enum_dataspace = H5Screate_simple(1, dims_state, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;      <span class="comment">// create the dataset for the state enum</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;      hid_t state_enum_dataset = H5Dcreate2(file_id_reopen,</div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                                            <span class="stringliteral">&quot;/state&quot;</span>,</div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                                            state_enum_id,</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                                            state_enum_dataspace,</div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                                            H5P_DEFAULT,</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                                            H5P_DEFAULT,</div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                                            H5P_DEFAULT);</div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;      <span class="comment">// write the dataset for the state enum</span></div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dwrite(state_enum_dataset,</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                        state_enum_id,</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                        H5P_DEFAULT,</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                        &amp;<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>);</div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160; </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;      <span class="comment">// create the data space for the property enum</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;      hsize_t dims_property[1];</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;      dims_property[0] = 1;</div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;      hid_t property_enum_dataspace =</div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;        H5Screate_simple(1, dims_property, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;      <span class="comment">// create the dataset for the property enum</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;      hid_t property_enum_dataset = H5Dcreate2(file_id_reopen,</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                                               <span class="stringliteral">&quot;/property&quot;</span>,</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;                                               property_enum_id,</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;                                               property_enum_dataspace,</div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;                                               H5P_DEFAULT,</div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;                                               H5P_DEFAULT,</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;                                               H5P_DEFAULT);</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;      <span class="comment">// write the dataset for the property enum</span></div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dwrite(property_enum_dataset,</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;                        property_enum_id,</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;                        H5S_ALL,</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;                        H5P_DEFAULT,</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;                        &amp;<a class="code" href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a>);</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(state_enum_dataset);</div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(property_enum_dataset);</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(state_enum_dataspace);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(property_enum_dataspace);</div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(state_enum_id);</div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(property_enum_id);</div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Fclose(file_id_reopen);</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;    }</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160; </div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;}</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160; </div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160; </div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03043"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a7578e1be3f70805316ec69f587ed7730"> 3043</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a7578e1be3f70805316ec69f587ed7730">ScaLAPACKMatrix&lt;NumberType&gt;::load</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;{</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;  (void)filename;</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;HDF5 support is disabled.&quot;</span>));</div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;<span class="preprocessor">#    ifdef H5_HAVE_PARALLEL</span></div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <span class="comment">// implementation for configurations equipped with a parallel file system</span></div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;  load_parallel(filename);</div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160; </div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;<span class="preprocessor">#    else</span></div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  <span class="comment">// implementation for configurations with no parallel file system</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  load_serial(filename);</div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;<span class="preprocessor">#    endif</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;}</div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160; </div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160; </div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#ac78850bc990c4f8de2270176a95b177a"> 3064</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#ac78850bc990c4f8de2270176a95b177a">ScaLAPACKMatrix&lt;NumberType&gt;::load_serial</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;{</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;  (void)filename;</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160; </div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;<span class="comment">   * The content of the distributed matrix is copied to a matrix using a 1x1</span></div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;<span class="comment">   * process grid. Therefore, one process has all the data and can write it to a</span></div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;<span class="comment">   * file</span></div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;  <span class="comment">// create a 1xP column grid with P being the number of MPI processes</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> one_grid =</div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    std::make_shared&lt;Utilities::MPI::ProcessGrid&gt;(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;                                                  1,</div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;                                                  1);</div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160; </div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span>                   MB = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, NB = n_columns;</div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> tmp(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, n_columns, one_grid, MB, NB);</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;  <span class="keywordtype">int</span> state_int    = -1;</div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;  <span class="keywordtype">int</span> property_int = -1;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160; </div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;  <span class="comment">// the 1x1 grid has only one process and this one reads</span></div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;  <span class="comment">// the content of the matrix from the HDF5 file</span></div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;  <span class="keywordflow">if</span> (tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;    {</div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;      herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160; </div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;      <span class="comment">// open the file in read-only mode</span></div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;      hid_t file_id = H5Fopen(filename.c_str(), H5F_ACC_RDONLY, H5P_DEFAULT);</div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160; </div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;      <span class="comment">// open the dataset in the file</span></div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;      hid_t dataset_id = H5Dopen2(file_id, <span class="stringliteral">&quot;/matrix&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160; </div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;      <span class="comment">// check the datatype of the data in the file</span></div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;      <span class="comment">// datatype of source and destination must have the same class</span></div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;      <span class="comment">// see HDF User&#39;s Guide: 6.10. Data Transfer: Datatype Conversion and</span></div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;      <span class="comment">// Selection</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;      hid_t       datatype   = H5Dget_type(dataset_id);</div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;      H5T_class_t t_class_in = H5Tget_class(datatype);</div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;      H5T_class_t t_class    = H5Tget_class(<a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>()));</div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;        t_class_in == t_class,</div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;        <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;          <span class="stringliteral">&quot;The data type of the matrix to be read does not match the archive&quot;</span>));</div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160; </div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;      <span class="comment">// get dataspace handle</span></div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;      hid_t dataspace_id = H5Dget_space(dataset_id);</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;      <span class="comment">// get number of dimensions</span></div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ndims = H5Sget_simple_extent_ndims(dataspace_id);</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ndims == 2, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;      <span class="comment">// get every dimension</span></div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;      hsize_t dims[2];</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;      H5Sget_simple_extent_dims(dataspace_id, dims, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims[0]) == n_columns,</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;          <span class="stringliteral">&quot;The number of columns of the matrix does not match the content of the archive&quot;</span>));</div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims[1]) == <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;        <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;          <span class="stringliteral">&quot;The number of rows of the matrix does not match the content of the archive&quot;</span>));</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160; </div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;      <span class="comment">// read data</span></div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dread(dataset_id,</div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;                       <a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>()),</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;                       H5S_ALL,</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;                       H5S_ALL,</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;                       H5P_DEFAULT,</div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;                       tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>());</div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160; </div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160;      <span class="comment">// create HDF5 enum type for LAPACKSupport::State and</span></div>
<div class="line"><a name="l03139"></a><span class="lineno"> 3139</span>&#160;      <span class="comment">// LAPACKSupport::Property</span></div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160;      hid_t state_enum_id, property_enum_id;</div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;      internal::create_HDF5_state_enum_id(state_enum_id);</div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160;      internal::create_HDF5_property_enum_id(property_enum_id);</div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160; </div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;      <span class="comment">// open the datasets for the state and property enum in the file</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;      hid_t       dataset_state_id = H5Dopen2(file_id, <span class="stringliteral">&quot;/state&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;      hid_t       datatype_state   = H5Dget_type(dataset_state_id);</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;      H5T_class_t t_class_state    = H5Tget_class(datatype_state);</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(t_class_state == H5T_ENUM, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160; </div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160;      hid_t dataset_property_id = H5Dopen2(file_id, <span class="stringliteral">&quot;/property&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;      hid_t datatype_property   = H5Dget_type(dataset_property_id);</div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;      H5T_class_t t_class_property = H5Tget_class(datatype_property);</div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(t_class_property == H5T_ENUM, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160; </div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;      <span class="comment">// get dataspace handles</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;      hid_t dataspace_state    = H5Dget_space(dataset_state_id);</div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;      hid_t dataspace_property = H5Dget_space(dataset_property_id);</div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;      <span class="comment">// get number of dimensions</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ndims_state = H5Sget_simple_extent_ndims(dataspace_state);</div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ndims_state == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ndims_property = H5Sget_simple_extent_ndims(dataspace_property);</div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ndims_property == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;      <span class="comment">// get every dimension</span></div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;      hsize_t dims_state[1];</div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;      H5Sget_simple_extent_dims(dataspace_state, dims_state, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims_state[0]) == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;      hsize_t dims_property[1];</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;      H5Sget_simple_extent_dims(dataspace_property, dims_property, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims_property[0]) == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160; </div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;      <span class="comment">// read data</span></div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dread(dataset_state_id,</div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;                       state_enum_id,</div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;                       H5S_ALL,</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;                       H5S_ALL,</div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;                       H5P_DEFAULT,</div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;                       &amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a>);</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      <span class="comment">// To send the state from the root process to the other processes</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      <span class="comment">// the state enum is casted to an integer, that will be broadcasted and</span></div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <span class="comment">// subsequently casted back to the enum type</span></div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;      state_int = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(tmp.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a>);</div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160; </div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dread(dataset_property_id,</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;                       property_enum_id,</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;                       H5S_ALL,</div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;                       H5S_ALL,</div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;                       H5P_DEFAULT,</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;                       &amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#aae1c9ee4a7967975a161bc336d24a173">property</a>);</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;      <span class="comment">// To send the property from the root process to the other processes</span></div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      <span class="comment">// the state enum is casted to an integer, that will be broadcasted and</span></div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <span class="comment">// subsequently casted back to the enum type</span></div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;      property_int = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(tmp.<a class="code" href="classScaLAPACKMatrix.html#aae1c9ee4a7967975a161bc336d24a173">property</a>);</div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160; </div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      <span class="comment">// terminate access to the data spaces</span></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_id);</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_state);</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_property);</div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160; </div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      <span class="comment">// release data type handles</span></div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(datatype);</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(state_enum_id);</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(property_enum_id);</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; </div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;      <span class="comment">// end access to the data sets and release resources used by them</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_state_id);</div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_id);</div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_property_id);</div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; </div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;      <span class="comment">// close the file.</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;      <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Fclose(file_id);</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    }</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;  <span class="comment">// so far only the root process has the correct state integer --&gt; broadcasting</span></div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;send_to_inactive(&amp;state_int, 1);</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;  <span class="comment">// so far only the root process has the correct property integer --&gt;</span></div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  <span class="comment">// broadcasting</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;  tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;send_to_inactive(&amp;property_int, 1);</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;  tmp.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a>    = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638">LAPACKSupport::State</a><span class="keyword">&gt;</span>(state_int);</div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;  tmp.<a class="code" href="classScaLAPACKMatrix.html#aae1c9ee4a7967975a161bc336d24a173">property</a> = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a><span class="keyword">&gt;</span>(property_int);</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160; </div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;  tmp.<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">copy_to</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160; </div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;<span class="preprocessor">#  endif // DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;}</div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160; </div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160; </div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160; </div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03242"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a9a12de09785d8b7be4f95e7a6f9fb06a"> 3242</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a9a12de09785d8b7be4f95e7a6f9fb06a">ScaLAPACKMatrix&lt;NumberType&gt;::load_parallel</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;{</div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="preprocessor">#  ifndef DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;  (void)filename;</div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;<span class="preprocessor">#    ifndef H5_HAVE_PARALLEL</span></div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;<span class="preprocessor">#    else</span></div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160; </div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>(</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator));</div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  MPI_Info info = MPI_INFO_NULL;</div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;<span class="comment">   * The content of the distributed matrix is copied to a matrix using a</span></div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;<span class="comment">   * 1xn_processes process grid. Therefore, the processes hold contiguous chunks</span></div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160;<span class="comment">   * of the matrix, which they can write to the file</span></div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="comment">// create a 1xP column grid with P being the number of MPI processes</span></div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> column_grid =</div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    std::make_shared&lt;Utilities::MPI::ProcessGrid&gt;(this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_communicator,</div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;                                                  1,</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;                                                  n_mpi_processes);</div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160; </div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> MB = <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>;</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;  <span class="comment">// for the choice of NB see explanation in save_parallel()</span></div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> NB = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespaceDifferentiation_1_1SD.html#a6545410ba18556ebf7c478b6ad9939f6">std::ceil</a>(</div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;                            <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(n_columns) / <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>)),</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;                          column_block_size);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160; </div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;  <a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> tmp(<a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>, n_columns, column_grid, MB, NB);</div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160; </div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;  <span class="comment">// get pointer to data held by the process</span></div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;  <a class="code" href="classNumberType.html">NumberType</a> *<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a> = (tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">size</a>() &gt; 0) ? tmp.<a class="code" href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">values</a>.<a class="code" href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">data</a>() : <span class="keyword">nullptr</span>;</div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160; </div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;  herr_t <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160; </div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;  <span class="comment">// set up file access property list with parallel I/O access</span></div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;  hid_t plist_id = H5Pcreate(H5P_FILE_ACCESS);</div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>         = H5Pset_fapl_mpio(plist_id, tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator, info);</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160; </div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;  <span class="comment">// open file collectively in read-only mode and release property list</span></div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;  <span class="comment">// identifier</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;  hid_t file_id = H5Fopen(filename.c_str(), H5F_ACC_RDONLY, plist_id);</div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a>        = H5Pclose(plist_id);</div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160; </div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;  <span class="comment">// open the dataset in the file collectively</span></div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;  hid_t dataset_id = H5Dopen2(file_id, <span class="stringliteral">&quot;/matrix&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160; </div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  <span class="comment">// check the datatype of the dataset in the file</span></div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;  <span class="comment">// if the classes of type of the dataset and the matrix do not match abort</span></div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  <span class="comment">// see HDF User&#39;s Guide: 6.10. Data Transfer: Datatype Conversion and</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;  <span class="comment">// Selection</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;  hid_t       datatype     = <a class="code" href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a>(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;  hid_t       datatype_inp = H5Dget_type(dataset_id);</div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;  H5T_class_t t_class_inp  = H5Tget_class(datatype_inp);</div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;  H5T_class_t t_class      = H5Tget_class(datatype);</div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    t_class_inp == t_class,</div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;      <span class="stringliteral">&quot;The data type of the matrix to be read does not match the archive&quot;</span>));</div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160; </div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  <span class="comment">// get the dimensions of the matrix stored in the file</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;  <span class="comment">// get dataspace handle</span></div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;  hid_t dataspace_id = H5Dget_space(dataset_id);</div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;  <span class="comment">// get number of dimensions</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ndims = H5Sget_simple_extent_ndims(dataspace_id);</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ndims == 2, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;  <span class="comment">// get every dimension</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;  hsize_t dims[2];</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sget_simple_extent_dims(dataspace_id, dims, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;    <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims[0]) == n_columns,</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <span class="stringliteral">&quot;The number of columns of the matrix does not match the content of the archive&quot;</span>));</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;    <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims[1]) == <a class="code" href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a>,</div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      <span class="stringliteral">&quot;The number of rows of the matrix does not match the content of the archive&quot;</span>));</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160; </div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;  <span class="comment">// gather the number of local rows and columns from all processes</span></div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;  std::vector&lt;int&gt; proc_n_local_rows(<a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>),</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;    proc_n_local_columns(<a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">n_mpi_processes</a>);</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;  <span class="keywordtype">int</span> ierr = <a class="code" href="mpi__0_8txt.html#a0585dbdf9f181004518cc3ae72b5b65f">MPI_Allgather</a>(&amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#a2aeb43089505bb7b32477271cc76312e">n_local_rows</a>,</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                           1,</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;                           MPI_INT,</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;                           proc_n_local_rows.data(),</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;                           1,</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;                           MPI_INT,</div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;                           tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;  ierr = <a class="code" href="mpi__0_8txt.html#a0585dbdf9f181004518cc3ae72b5b65f">MPI_Allgather</a>(&amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#a4b34cedd3940060edbe3ce4aeec09903">n_local_columns</a>,</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;                       1,</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;                       MPI_INT,</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;                       proc_n_local_columns.data(),</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;                       1,</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;                       MPI_INT,</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;                       tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator);</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;  <a class="code" href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a>(ierr);</div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160; </div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> my_rank(</div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(tmp.<a class="code" href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">grid</a>-&gt;mpi_communicator));</div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160; </div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;  <span class="comment">// hyperslab selection parameters</span></div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;  <span class="comment">// each process defines dataset in memory and writes it to the hyperslab in</span></div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;  <span class="comment">// the file</span></div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  hsize_t <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>[2];</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;  <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>[0] = tmp.<a class="code" href="classScaLAPACKMatrix.html#a4b34cedd3940060edbe3ce4aeec09903">n_local_columns</a>;</div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>[1] = tmp.<a class="code" href="classScaLAPACKMatrix.html#a2aeb43089505bb7b32477271cc76312e">n_local_rows</a>;</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160; </div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  hsize_t offset[2] = {0};</div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; my_rank; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;    offset[0] += proc_n_local_columns[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160; </div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;  <span class="comment">// select hyperslab in the file</span></div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sselect_hyperslab(</div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;    dataspace_id, H5S_SELECT_SET, offset, <span class="keyword">nullptr</span>, <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160; </div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;  <span class="comment">// create a memory dataspace independently</span></div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;  hid_t memspace = H5Screate_simple(2, <a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160; </div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;  <span class="comment">// read data independently</span></div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> =</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;    H5Dread(dataset_id, datatype, memspace, dataspace_id, H5P_DEFAULT, <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160; </div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;  <span class="comment">// create HDF5 enum type for LAPACKSupport::State and LAPACKSupport::Property</span></div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;  hid_t state_enum_id, property_enum_id;</div>
<div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;  internal::create_HDF5_state_enum_id(state_enum_id);</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;  internal::create_HDF5_property_enum_id(property_enum_id);</div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160; </div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;  <span class="comment">// open the datasets for the state and property enum in the file</span></div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;  hid_t       dataset_state_id = H5Dopen2(file_id, <span class="stringliteral">&quot;/state&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  hid_t       datatype_state   = H5Dget_type(dataset_state_id);</div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  H5T_class_t t_class_state    = H5Tget_class(datatype_state);</div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(t_class_state == H5T_ENUM, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160; </div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;  hid_t       dataset_property_id = H5Dopen2(file_id, <span class="stringliteral">&quot;/property&quot;</span>, H5P_DEFAULT);</div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;  hid_t       datatype_property   = H5Dget_type(dataset_property_id);</div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;  H5T_class_t t_class_property    = H5Tget_class(datatype_property);</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(t_class_property == H5T_ENUM, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160; </div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;  <span class="comment">// get dataspace handles</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;  hid_t dataspace_state    = H5Dget_space(dataset_state_id);</div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;  hid_t dataspace_property = H5Dget_space(dataset_property_id);</div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;  <span class="comment">// get number of dimensions</span></div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ndims_state = H5Sget_simple_extent_ndims(dataspace_state);</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ndims_state == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> ndims_property = H5Sget_simple_extent_ndims(dataspace_property);</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ndims_property == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;  <span class="comment">// get every dimension</span></div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;  hsize_t dims_state[1];</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;  H5Sget_simple_extent_dims(dataspace_state, dims_state, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims_state[0]) == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;  hsize_t dims_property[1];</div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;  H5Sget_simple_extent_dims(dataspace_property, dims_property, <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(dims_property[0]) == 1, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160; </div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;  <span class="comment">// read data</span></div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dread(</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;    dataset_state_id, state_enum_id, H5S_ALL, H5S_ALL, H5P_DEFAULT, &amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">state</a>);</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160; </div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dread(dataset_property_id,</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;                   property_enum_id,</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;                   H5S_ALL,</div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;                   H5S_ALL,</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;                   H5P_DEFAULT,</div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;                   &amp;tmp.<a class="code" href="classScaLAPACKMatrix.html#aae1c9ee4a7967975a161bc336d24a173">property</a>);</div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160; </div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;  <span class="comment">// close/release sources</span></div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(memspace);</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_id);</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_state_id);</div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Dclose(dataset_property_id);</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_id);</div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_state);</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Sclose(dataspace_property);</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;  <span class="comment">// status = H5Tclose(datatype);</span></div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;  <span class="comment">// AssertThrow(status &gt;= 0, ExcIO());</span></div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(state_enum_id);</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Tclose(property_enum_id);</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;  <a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> = H5Fclose(file_id);</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a> &gt;= 0, <a class="code" href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">ExcIO</a>());</div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160; </div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;  <span class="comment">// copying the distributed matrices</span></div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;  tmp.<a class="code" href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">copy_to</a>(*<span class="keyword">this</span>);</div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160; </div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;<span class="preprocessor">#    endif // H5_HAVE_PARALLEL</span></div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="preprocessor">#  endif   // DEAL_II_WITH_HDF5</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;}</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160; </div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160; </div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160; </div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;{</div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  <span class="keyword">namespace</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;  {</div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;    scale_columns(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;                  <span class="keyword">const</span> <a class="code" href="classArrayView.html">ArrayView&lt;const NumberType&gt;</a> &amp;<a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>)</div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    {</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n() == <a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>.size(),</div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n(), <a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>.size()));</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160; </div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.local_n(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;        {</div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;          <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = <a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>[<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.global_column(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)];</div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160; </div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.local_m(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;            <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.local_el(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) *= <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>;</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        }</div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    }</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160; </div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;    scale_rows(<a class="code" href="classScaLAPACKMatrix.html">ScaLAPACKMatrix&lt;NumberType&gt;</a> &amp;      <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;               <span class="keyword">const</span> <a class="code" href="classArrayView.html">ArrayView&lt;const NumberType&gt;</a> &amp;<a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>)</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;    {</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m() == <a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>.size(),</div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;             <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m(), <a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>.size()));</div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160; </div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.local_m(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        {</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;          <span class="keyword">const</span> <a class="code" href="classNumberType.html">NumberType</a> <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = <a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>[<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.global_row(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)];</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160; </div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.local_n(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;            <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.local_el(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) *= <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>;</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;        }</div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    }</div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160; </div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;  } <span class="comment">// namespace</span></div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;} <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160; </div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160; </div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160; </div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> InputVector&gt;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03496"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#af6819321d6f65302155b6b7e2be70988"> 3496</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#af6819321d6f65302155b6b7e2be70988">ScaLAPACKMatrix&lt;NumberType&gt;::scale_columns</a>(<span class="keyword">const</span> InputVector &amp;<a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>)</div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;{</div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160;    internal::scale_columns(*<span class="keyword">this</span>, <a class="code" href="classArrayView.html#a2339bfed866b07b8d100f017616e2f2a">make_array_view</a>(<a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>));</div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;}</div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160; </div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160; </div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160; </div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">typename</span> NumberType&gt;</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;<span class="keyword">template</span> &lt;<span class="keyword">class</span> InputVector&gt;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l03507"></a><span class="lineno"><a class="line" href="classScaLAPACKMatrix.html#a64013567ad63bbc2cee395c1b01fdb3b"> 3507</a></span>&#160;<a class="code" href="classScaLAPACKMatrix.html#a64013567ad63bbc2cee395c1b01fdb3b">ScaLAPACKMatrix&lt;NumberType&gt;::scale_rows</a>(<span class="keyword">const</span> InputVector &amp;<a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>)</div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;{</div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;  <span class="keywordflow">if</span> (this-&gt;<a class="code" href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a>-&gt;mpi_process_is_active)</div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;    internal::scale_rows(*<span class="keyword">this</span>, <a class="code" href="classArrayView.html#a2339bfed866b07b8d100f017616e2f2a">make_array_view</a>(<a class="code" href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a>));</div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160;}</div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160; </div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160; </div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160; </div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160;<span class="comment">// instantiations</span></div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;<span class="preprocessor">#  include &quot;scalapack.inst&quot;</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160; </div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160; </div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160; </div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;<span class="preprocessor">#endif // DEAL_II_WITH_SCALAPACK</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ad8c472d23a551bbbdfbfcfee4f5bbe51"><div class="ttname"><a href="classScaLAPACKMatrix.html#ad8c472d23a551bbbdfbfcfee4f5bbe51">ScaLAPACKMatrix::reciprocal_condition_number</a></div><div class="ttdeci">NumberType reciprocal_condition_number(const NumberType a_norm) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02313">scalapack.cc:2313</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ae0278fa22a587e65fe73102baa4e3336"><div class="ttname"><a href="classScaLAPACKMatrix.html#ae0278fa22a587e65fe73102baa4e3336">ScaLAPACKMatrix::eigenpairs_symmetric_by_index</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; eigenpairs_symmetric_by_index(const std::pair&lt; unsigned int, unsigned int &gt; &amp;index_limits, const bool compute_eigenvectors)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01430">scalapack.cc:1430</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_aa25b18f13ceb1f252c2526124396d180"><div class="ttname"><a href="classScaLAPACKMatrix.html#aa25b18f13ceb1f252c2526124396d180">ScaLAPACKMatrix::compute_lu_factorization</a></div><div class="ttdeci">void compute_lu_factorization()</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01273">scalapack.cc:1273</a></div></div>
<div class="ttc" id="anewton__0_8txt_html_af4dc1cb00f59a52e48df46a4c205a8e6"><div class="ttname"><a href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a></div><div class="ttdeci">*Operator class performing Newton s iteration with standard step size control and adaptive matrix generation This class performs a Newton iteration up to convergence determined by control If after an update the norm of the residual has become larger then step size control is activated and the update is subsequently divided by two until the residual actually becomes depending on the tends to be this method applies an adaptive reassembling strategy Only if the reduction factor for the residual is more than receiving the applications computing the residual and solving the linear respectively **Declare the parameters applicable to Newton s method **Read the parameters in the ParameterHandler **Initialize the pointer data_out for debugging **The actual Newton iteration The initial value is in&lt; tt &gt; which also contains the result after convergence Values in&lt; tt &gt; in&lt;/tt &gt; are not used by but will be handed down to the objects **Set the maximal residual reduction allowed without triggering assembling in the next step Return the previous value **Control object for the Newton iteration **The indicating that the matrix must be assembled anew upon start **A flag used to decide how many stepsize iteration should be made Default is the original value of Enter zero here to turn off stepsize control *Controlled by&lt; tt &gt; Stepsize iterations&lt;/tt &gt; in parameter file **Threshold for re assembling matrix If the quotient of two consecutive residuals is smaller than this the system matrix is not assembled in this step *This parameter should be adjusted to the residual gain of the inner solver The default values is resulting in reassembling in every Newton step **Print update and updated solution after each step into file&lt; tt &gt; Newton_NNN&lt;/tt &gt; **Write debug output to[2.x.3] the higher the number</div><div class="ttdef"><b>Definition:</b> <a href="newton__0_8txt_source.html#l00034">newton_0.txt:34</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a33e63a29c50e98a404240efd43b2cba0">LAPACKSupport::upper_triangular</a></div><div class="ttdeci">@ upper_triangular</div><div class="ttdoc">Matrix is upper triangular.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00122">lapack_support.h:122</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a64013567ad63bbc2cee395c1b01fdb3b"><div class="ttname"><a href="classScaLAPACKMatrix.html#a64013567ad63bbc2cee395c1b01fdb3b">ScaLAPACKMatrix::scale_rows</a></div><div class="ttdeci">void scale_rows(const InputVector &amp;factors)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l03507">scalapack.cc:3507</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a9fae8f6bbe61900874e495b566059ed9"><div class="ttname"><a href="classScaLAPACKMatrix.html#a9fae8f6bbe61900874e495b566059ed9">ScaLAPACKMatrix::l1_norm</a></div><div class="ttdeci">NumberType l1_norm() const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02375">scalapack.cc:2375</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ae4fab96dc8bf972386fa37936fe8c132"><div class="ttname"><a href="classScaLAPACKMatrix.html#ae4fab96dc8bf972386fa37936fe8c132">ScaLAPACKMatrix::compute_cholesky_factorization</a></div><div class="ttdeci">void compute_cholesky_factorization()</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01240">scalapack.cc:1240</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gac29b5f3efd2b164642b8e0c49ad3ad27"><div class="ttname"><a href="group__Exceptions.html#gac29b5f3efd2b164642b8e0c49ad3ad27">StandardExceptions::ExcIO</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcIO()</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a2d424dbb47f6c4ce6d554677c53c1570"><div class="ttname"><a href="classScaLAPACKMatrix.html#a2d424dbb47f6c4ce6d554677c53c1570">ScaLAPACKMatrix::operator=</a></div><div class="ttdeci">ScaLAPACKMatrix&lt; NumberType &gt; &amp; operator=(const FullMatrix&lt; NumberType &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00331">scalapack.cc:331</a></div></div>
<div class="ttc" id="anamespaceCUDAWrappers_html_afc4f5064c82cee9664113d3dfef56ecb"><div class="ttname"><a href="namespaceCUDAWrappers.html#afc4f5064c82cee9664113d3dfef56ecb">CUDAWrappers::block_size</a></div><div class="ttdeci">constexpr int block_size</div><div class="ttdef"><b>Definition:</b> <a href="base_2cuda__size_8h_source.html#l00030">cuda_size.h:30</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ad627c6064a484ecd10108f6582c74af5">LAPACKSupport::general</a></div><div class="ttdeci">@ general</div><div class="ttdoc">No special properties.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00118">lapack_support.h:118</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a08a95c596933974250d0841957432c7e">LAPACKSupport::cholesky</a></div><div class="ttdeci">@ cholesky</div><div class="ttdoc">Contents is a Cholesky decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00069">lapack_support.h:69</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_adc8bcecff39fec4dda83ee72279081d3"><div class="ttname"><a href="classScaLAPACKMatrix.html#adc8bcecff39fec4dda83ee72279081d3">ScaLAPACKMatrix::state</a></div><div class="ttdeci">LAPACKSupport::State state</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00892">scalapack.h:892</a></div></div>
<div class="ttc" id="aconvergence__table__0_8txt_html_a37c53a384d86a02751b04a0a89820c55"><div class="ttname"><a href="convergence__table__0_8txt.html#a37c53a384d86a02751b04a0a89820c55">fill</a></div><div class="ttdeci">*The ConvergenceTable class is an application to the TableHandler class and stores some convergence data such as residuals of the cg method or some evaluated[1.x.0] errors of discrete and evaluates convergence rates or orders *The already implemented *For the number of cells may be added to the table by calling n_dofs Of one can also add more kinds of information by calling before the output of the table the functions it switches off the auto fill mode of the TableHandler base class If you intend to add further data with auto fill</div><div class="ttdef"><b>Definition:</b> <a href="convergence__table__0_8txt_source.html#l00025">convergence_table_0.txt:25</a></div></div>
<div class="ttc" id="atrilinos__sparse__matrix__0_8txt_html_a4fea52a6c0731b115fed61310c695914"><div class="ttname"><a href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a></div><div class="ttdeci">A B&lt;/tt &gt;, or, if an optional vector argument is given,&lt; tt &gt;C=A diag(V) B&lt;/tt &gt;, where&lt; tt &gt;diag(V)&lt;/tt &gt; defines a diagonal matrix with the vector entries. This function assumes that the calling matrix&lt; tt &gt;A&lt;/tt &gt; and&lt; tt &gt;B&lt;/tt &gt; have compatible sizes. The size of&lt; tt &gt;C&lt;/tt &gt; will be set within this function. The content as well as the sparsity pattern of the matrix C will be changed by this function, so make sure that the sparsity pattern is not used somewhere else in your program. This is an expensive operation, so think twice before you use this function. *[0.x.128] *Perform the matrix-matrix multiplication with the transpose of&lt; tt &gt;this&lt;/tt &gt;, i.e.,&lt; tt &gt;C=A&lt; sup &gt;T&lt;/sup &gt; B&lt;/tt &gt;, or, if an optional vector argument is given,&lt; tt &gt;C=A&lt; sup &gt;T&lt;/sup &gt; diag(V) B&lt;/tt &gt;, where&lt; tt &gt;diag(V)&lt;/tt &gt; defines a diagonal matrix with the vector entries. This function assumes that the calling matrix&lt; tt &gt;A&lt;/tt &gt; and&lt; tt &gt;B&lt;/tt &gt; have compatible sizes. The size of&lt; tt &gt;C&lt;/tt &gt; will be set within this function. The content as well as the sparsity pattern of the matrix C will be changed by this function, so make sure that the sparsity pattern is not used somewhere else in your program. This is an expensive operation, so think twice before you use this function. *[0.x.129] *[2.x.81] Matrix norms *[0.x.130] *Return the[1.x.23]&lt; sub &gt;1&lt;/sub &gt; -norm of the matrix, that is[2.x.82],(max. sum of columns). This is the natural matrix norm that is compatible to the l1-norm for vectors, i.e.[2.x.83] .(cf. Haemmerlin-Hoffmann:Numerische Mathematik) *[0.x.131] *Return the linfty-norm of the matrix, that is[2.x.84],(max. sum of rows). This is the natural matrix norm that is compatible to the linfty-norm of vectors, i.e.[2.x.85] .(cf. Haemmerlin-Hoffmann:Numerische Mathematik) *[0.x.132] *Return the frobenius norm of the matrix, i.e. the square root of the sum of squares of all entries in the matrix. *[0.x.133] *[2.x.86] Access to underlying Trilinos data *[0.x.134] *Return a const reference to the underlying Trilinos Epetra_CrsMatrix data. *[0.x.135] *Return a const reference to the underlying Trilinos Epetra_CrsGraph data that stores the sparsity pattern of the matrix. *[0.x.136] *[2.x.87] Partitioners *[0.x.137] *Return the partitioning of the domain space of this matrix, i.e., the partitioning of the vectors this matrix has to be multiplied with. *[0.x.138] *Return the partitioning of the range space of this matrix, i.e., the partitioning of the vectors that are result from matrix-vector products. *[0.x.139] *[2.x.88] Iterators *[0.x.140] *Return an iterator pointing to the first element of the matrix. The elements accessed by iterators within each row are ordered in the way in which Trilinos stores them, though the implementation guarantees that all elements of one row are accessed before the elements of the next row. If your algorithm relies on visiting elements within one row, you will need to consult with the Trilinos documentation on the order in which it stores data. It is, however, generally not a good and long- term stable idea to rely on the order in which receive elements if you iterate over them. When you iterate over the elements of a parallel matrix, you will only be able to access the locally owned rows.(You can access the other rows as well, but they will look empty.) In that case, you probably want to call the begin() function that takes the row as an argument to limit the range of elements to loop over. *[0.x.141] *Like the function above, but for non-const matrices. *[0.x.142] *Return an iterator pointing the element past the last one of this matrix. *[0.x.143] *Like the function above, but for non-const matrices. *[0.x.144] *Return an iterator pointing to the first element of row[2.x.89] Note that if the given row is empty, i.e. does not contain any nonzero entries, then the iterator returned by this function equals&lt; tt &gt;end(r)&lt;/tt &gt;. The returned iterator may not be dereferenceable in that case if neither row[2.x.90] nor any of the following rows contain any nonzero entries. The elements accessed by iterators within each row are ordered in the way in which Trilinos stores them, though the implementation guarantees that all elements of one row are accessed before the elements of the next row. If your algorithm relies on visiting elements within one row, you will need to consult with the Trilinos documentation on the order in which it stores data. It is, however, generally not a good and long- term stable idea to rely on the order in which receive elements if you iterate over them. *[2.x.91] When you access the elements of a parallel matrix, you can only access the elements of rows that are actually stored locally.(You can access the other rows as well, but they will look empty.) Even then, if another processor has since written into, or added to, an element of the matrix that is stored on the current processor, then you will still see the old value of this entry unless you have called compress() between modifying the matrix element on the remote processor and accessing it on the current processor. See the documentation of the compress() function for more information. *[0.x.145] *Like the function above, but for non-const matrices. *[0.x.146] *Return an iterator pointing the element past the last one of row[2.x.92], or past the end of the entire sparsity pattern if none of the rows after[2.x.93] contain any entries at all. Note that the end iterator is not necessarily dereferenceable. This is in particular the case if it is the end iterator for the last row of a matrix. *[0.x.147] *Like the function above, but for non-const matrices. *[0.x.148] *[2.x.94] Input/Output *[0.x.149] *Abstract Trilinos object that helps view in ASCII other Trilinos objects. Currently this function is not implemented. TODO:Not implemented. *[0.x.150] *Print the matrix to the given stream, using the format&lt; tt &gt;(line, col) value&lt;/tt &gt;, i.e. one nonzero entry of the matrix per line. The optional flag outputs the sparsity pattern in Trilinos style, where the data is sorted according to the processor number when printed to the stream, as well as a summary of the matrix like the global size. *[0.x.151] *[2.x.95] Exceptions *[0.x.152] *Exception *[0.x.153] *Exception *[0.x.154] *Exception *[0.x.155] *Exception *[0.x.156] *Exception *[0.x.157] *Exception *[0.x.158] *For some matrix storage formats, in particular for the PETSc distributed blockmatrices, set and add operations on individual elements can not be freely mixed. Rather, one has to synchronize operations when one wants to switch from setting elements to adding to elements. BlockMatrixBase automatically synchronizes the access by calling this helper function for each block. This function ensures that the matrix is in a state that allows adding elements C</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix__0_8txt_source.html#l00330">trilinos_sparse_matrix_0.txt:330</a></div></div>
<div class="ttc" id="aclassTableBase_html_a9e1b4872bcdbec9c22616fd6ffc34c18"><div class="ttname"><a href="classTableBase.html#a9e1b4872bcdbec9c22616fd6ffc34c18">TableBase&lt; 2, NumberType &gt;::values</a></div><div class="ttdeci">AlignedVector&lt; NumberType &gt; values</div><div class="ttdef"><b>Definition:</b> <a href="base_2table_8h_source.html#l00782">table.h:782</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a1bb57a0f97778b451507ee32233571d4"><div class="ttname"><a href="classScaLAPACKMatrix.html#a1bb57a0f97778b451507ee32233571d4">ScaLAPACKMatrix::copy_from</a></div><div class="ttdeci">void copy_from(const LAPACKFullMatrix&lt; NumberType &gt; &amp;matrix, const unsigned int rank)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00362">scalapack.cc:362</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a05736f2044c74db48f53067f46ed4c75"><div class="ttname"><a href="classScaLAPACKMatrix.html#a05736f2044c74db48f53067f46ed4c75">ScaLAPACKMatrix::eigenpairs_symmetric_by_value</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; eigenpairs_symmetric_by_value(const std::pair&lt; NumberType, NumberType &gt; &amp;value_limits, const bool compute_eigenvectors)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01453">scalapack.cc:1453</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_1_1internal_1_1Tags_html_a1c190e50dabbd9b60e230b843c6caa44aecb41c3aa91091dcb8fc050ab0a8b5f7"><div class="ttname"><a href="namespaceUtilities_1_1MPI_1_1internal_1_1Tags.html#a1c190e50dabbd9b60e230b843c6caa44aecb41c3aa91091dcb8fc050ab0a8b5f7">Utilities::MPI::internal::Tags::scalapack_copy_to</a></div><div class="ttdeci">@ scalapack_copy_to</div><div class="ttdoc">ScaLAPACKMatrix&lt;NumberType&gt;::copy_to.</div><div class="ttdef"><b>Definition:</b> <a href="base_2mpi__tags_8h_source.html#l00176">mpi_tags.h:176</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a8c9e68ebdb81c95dc91a5cadc2d8d44e"><div class="ttname"><a href="classScaLAPACKMatrix.html#a8c9e68ebdb81c95dc91a5cadc2d8d44e">ScaLAPACKMatrix::norm_general</a></div><div class="ttdeci">NumberType norm_general(const char type) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02417">scalapack.cc:2417</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638aef1753b142c24961b944eab49b33b1db"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638aef1753b142c24961b944eab49b33b1db">LAPACKSupport::svd</a></div><div class="ttdeci">@ svd</div><div class="ttdoc">Matrix contains singular value decomposition,.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00073">lapack_support.h:73</a></div></div>
<div class="ttc" id="afe__nedelec__sz__0_8txt_html_af4a7b1c52711f25dcb91bc3d69a63d18"><div class="ttname"><a href="fe__nedelec__sz__0_8txt.html#af4a7b1c52711f25dcb91bc3d69a63d18">v2</a></div><div class="ttdeci">the total polynomial degree may be higher If the element is linear and has degrees of freedom only on the edges If faces and volume For example the version of FE_NedelecSZ has degrees of freedom for where order is the order of FE_NedelecSZ **This element is vector valued so this function will throw an exception **Not implemented **This element is vector valued so this function will throw an exception **Not implemented **This element is vector valued so this function will throw an exception **Not implemented **The mapping kind to be used to map shape functions from the reference cell to the mesh cell **Compute information about the shape functions on the cell denoted by the first argument Note that this function must recompute the cell dependent degrees of and so is not thread safe at this time **Compute information about the shape functions on the cell and face denoted by the first two arguments Note that this function must recompute the cell dependent degrees of and so is not thread safe at this time **Not implemented **Derived Internal data which is used to store cell independent data Note that due to the nature of this a number of useful pre computed quantities are stored for the computation of cell dependent shape functions The main quantities which are stored are associated with edge and face parameterizations These equal to one at the[2.x.5] th vertex and zero at all other vertices *[2.x.6][2.x.7][2.x.8] *linear functional associated with the[2.x.9] th vertex[2.x.10][2.x.11] The definitions of these as well as the edge and face parameterizations and edge and face extension can be found on page of Zaglmayr s thesis The details of the definition of the globally defined edge and face orientations can be found on page **Storage for shape functions on the reference element We only pre compute cell based as the edge and face based DoFs depend on the cell Due to the cell dependent this variable is declared mutable **Storage for shape function gradients on the reference element We only pre compute cell based as the edge and face based DoFs depend on the cell Due to the cell dependent this variable is declared mutable **Storage for all possible edge parameterization between vertices These are required in the computation of edge and face based which are cell dependent The edge parameterization of an starting at vertex i and ending at vertex[2.x.12] is given by[2.x.13] sigma_imj_values[q][i][j] stores the value of the edge parameterization connected by vertices[2.x.14] and[2.x.15] at the q th quadrature point Note that not all of the[2.x.16] and[2.x.17] combinations result in valid edges on the hexahedral but they are computed in this fashion for use with non standard edge and face orientations **Storage for gradients of all possible edge parameterizations between vertices These are required in the computation of edge and face based which are cell dependent Note that the components of the gradient are constant The edge parameterization of an starting at vertex[2.x.19] and ending at vertex[2.x.20] is given by[2.x.21] sigma_imj_grads[i][j][d] stores the gradient of the edge parameterization connected by vertices[2.x.22] and[2.x.23] in component[2.x.24] Note that the gradient of the edge parameterization is constant on an so we do not need to store it at every quadrature point **Storage for values of edge parameterizations at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell edge_sigma_values[m][q] stores the edge parameterization value at the q th quadrature point on edge m These values change with the orientation of the edges of a physical cell and so must take the sign into account when used for computation **Storage for gradients of edge parameterization at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell edge_sigma_grads[m][d] stores the gradient of the edge parameterization for component d on edge m These values change with the orientation of the edges of a physical cell and so must take the sign into account when used for computation **Storage for edge extension parameters at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell The edge extension parameter of an starting at vertex[2.x.26] and ending at vertex[2.x.27] is given by[2.x.28] Note that under this the values of[2.x.29] do not change with the orientation of the edge edge_lambda_values[m][q] stores the edge extension parameter value at the[2.x.30] th quadrature point on edge *[2.x.31] *Storage for gradients of edge extension parameters in In this case they are constant These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_grads_2d[m][d] stores the gradient of the edge extension parameter for component[2.x.32] on edge *[2.x.33] *Storage for gradients of edge extension parameters in In this case they are non constant These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_grads_3d[m][q][d] stores the gradient of the edge extension parameter for component[2.x.34] at the[2.x.35] th quadrature point on edge m **Storage for derivatives of edge extension parameters which are constant across the cell These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_gradgrads_3d[m][d1][d2] stores the derivatives of the edge extension parameters with respect to components d1 and d2 on edge *[2.x.36] *Storage for the face extension parameters These are stored for the faces such that the global vertex numbering would follow the order defined by the standard deal II cell The face extension parameter of a defined by the vertices v2</div><div class="ttdef"><b>Definition:</b> <a href="fe__nedelec__sz__0_8txt_source.html#l00059">fe_nedelec_sz_0.txt:59</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a711503af730f169914268d2e307aa0ab"><div class="ttname"><a href="classScaLAPACKMatrix.html#a711503af730f169914268d2e307aa0ab">ScaLAPACKMatrix::ScaLAPACKMatrix</a></div><div class="ttdeci">ScaLAPACKMatrix(const size_type n_rows, const size_type n_columns, const std::shared_ptr&lt; const Utilities::MPI::ProcessGrid &gt; &amp;process_grid, const size_type row_block_size=32, const size_type column_block_size=32, const LAPACKSupport::Property property=LAPACKSupport::Property::general)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00080">scalapack.cc:80</a></div></div>
<div class="ttc" id="aclassArrayView_html"><div class="ttname"><a href="classArrayView.html">ArrayView</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2array__view_8h_source.html#l00086">array_view.h:86</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a5286111f1e05e8019b36933eef6a55aa"><div class="ttname"><a href="classScaLAPACKMatrix.html#a5286111f1e05e8019b36933eef6a55aa">ScaLAPACKMatrix::column_block_size</a></div><div class="ttdeci">int column_block_size</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00931">scalapack.h:931</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a1c9a16cb5cdeb15f4ef1a18a3415dce2"><div class="ttname"><a href="classScaLAPACKMatrix.html#a1c9a16cb5cdeb15f4ef1a18a3415dce2">ScaLAPACKMatrix::save_parallel</a></div><div class="ttdeci">void save_parallel(const std::string &amp;filename, const std::pair&lt; unsigned int, unsigned int &gt; &amp;chunk_size) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02807">scalapack.cc:2807</a></div></div>
<div class="ttc" id="ampi__compute__index__owner__internal__0_8txt_html_a556508d4f019d698d28e912ee1ef9937"><div class="ttname"><a href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a></div><div class="ttdeci">namespace used for[2.x.0] and for *[2.x.1] *Specialization of[2.x.2] for setting up the Dictionary even if there are ranges in the IndexSet space not owned by any processes *Only for internal usage **Constructor **Implementation of *[2.x.4] *Implementation of *[2.x.5] *Implementation of *[2.x.6] *Dictionary class with basic partitioning in terms of a single interval of fixed size known to all MPI ranks for two stage index lookup **The minimum grain size for the intervals We choose to limit the smallest size an interval for the two stage lookup can have with the following two conflicting goals in we do not want intervals in the dictionary to become too short For uneven distributions of the lookup DoFs *dictionary then involves sending from one MPI rank to many other MPI ranks holding dictionary leading to an exceedingly high number of messages some ranks have to send fewer longer intervals are generally more efficient to look up On the other a range size too large leads to opposite effect of many messages that come into a particular dictionary owner in the lookup DoFs *dictionary With the current we get at most messages coming to a single MPI rank in case there is dof per MPI rank</div><div class="ttdef"><b>Definition:</b> <a href="mpi__compute__index__owner__internal__0_8txt_source.html#l00021">mpi_compute_index_owner_internal_0.txt:21</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_aada5bc79adf4d2b6f7a0a586dd154553"><div class="ttname"><a href="classScaLAPACKMatrix.html#aada5bc79adf4d2b6f7a0a586dd154553">ScaLAPACKMatrix::mult</a></div><div class="ttdeci">void mult(const NumberType b, const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const NumberType c, ScaLAPACKMatrix&lt; NumberType &gt; &amp;C, const bool transpose_A=false, const bool transpose_B=false) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01067">scalapack.cc:1067</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a8c742afbfe0ebcd052583a6c31990f82"><div class="ttname"><a href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a></div><div class="ttdeci">it does so for both DoFHandler and[2.x.14] objects Note that the DoFAccessor class is derived from either TriaAccessor or the DoFAccessor class comes in two flavors one accessing degrees of freedom on the level of a cell and the other accessing the active dofs of an active cell **The DoFCellAccessor class has the same purpose and relation to DoFCellAccessor as the CellAccessor has to TriaAccessor *Except to look up member you will not usually have to deal withthe actual class names listed above Rather one uses the typedefs provided bythe mesh classes Triangulation DoFHandler and[2.x.15] as wellas the function that generate such buta hexahedron there are corresponding types and calls like[2.x.34] that act on thedimension independent geometric objects and hex These just as the ones exist in active and non active forms *The actual definition of all the typedefs to the mesh classes arestated in the **and[2.x.37] classes for Triangulation and[1.x.10] classes for DoFHandler and[2.x.38] iterators *IteratorAccessorInternals Iterator and accessor internals being like act as if they pointed to an but in reality all they do is to return an accessor whendereferenced The accessor object contains the state</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00083">iterators_0.txt:83</a></div></div>
<div class="ttc" id="ascalapack_8cc_html_a04bf5b2311592fea427200e2e35df7cb"><div class="ttname"><a href="scalapack_8cc.html#a04bf5b2311592fea427200e2e35df7cb">hdf5_type_id</a></div><div class="ttdeci">hid_t hdf5_type_id(const number *)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00039">scalapack.cc:39</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a801e8b7f84711c97d732019ca9ddce50"><div class="ttname"><a href="classScaLAPACKMatrix.html#a801e8b7f84711c97d732019ca9ddce50">ScaLAPACKMatrix::submatrix_row</a></div><div class="ttdeci">const int submatrix_row</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00996">scalapack.h:996</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a3e681d2d74dcf90f6556706d66f81a0d"><div class="ttname"><a href="namespaceLAPACKSupport.html#a3e681d2d74dcf90f6556706d66f81a0d">LAPACKSupport::U</a></div><div class="ttdeci">static const char U</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00182">lapack_support.h:182</a></div></div>
<div class="ttc" id="aclassSymmetricTensor_html_aa18a9d623fcd520f022421fd1d6c7a14"><div class="ttname"><a href="classSymmetricTensor.html#aa18a9d623fcd520f022421fd1d6c7a14">SymmetricTensor::eigenvectors</a></div><div class="ttdeci">std::array&lt; std::pair&lt; Number, Tensor&lt; 1, dim, Number &gt; &gt;, std::integral_constant&lt; int, dim &gt;::value &gt; eigenvectors(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;T, const SymmetricTensorEigenvectorMethod method=SymmetricTensorEigenvectorMethod::ql_implicit_shifts)</div></div>
<div class="ttc" id="aclassAlignedVector_html_ac1900b4748c7de0d12858b0a93ee0060"><div class="ttname"><a href="classAlignedVector.html#ac1900b4748c7de0d12858b0a93ee0060">AlignedVector::size</a></div><div class="ttdeci">size_type size() const</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a86231732a54f89df92e15ec186d46e82"><div class="ttname"><a href="classScaLAPACKMatrix.html#a86231732a54f89df92e15ec186d46e82">ScaLAPACKMatrix::save_serial</a></div><div class="ttdeci">void save_serial(const std::string &amp;filename, const std::pair&lt; unsigned int, unsigned int &gt; &amp;chunk_size) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02650">scalapack.cc:2650</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ae25c0bf99b3489c9b929a17be267d27f"><div class="ttname"><a href="classScaLAPACKMatrix.html#ae25c0bf99b3489c9b929a17be267d27f">ScaLAPACKMatrix::copy_to</a></div><div class="ttdeci">void copy_to(FullMatrix&lt; NumberType &gt; &amp;matrix) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00664">scalapack.cc:664</a></div></div>
<div class="ttc" id="amg__0_8txt_html_a05d914308ac970c97c941a291a81ccc1"><div class="ttname"><a href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a></div><div class="ttdeci">which is a wrapper around Multigrid with the standard interface of deal II[2.x.9] Preconditioners PreconditionMG also uses the classes inheriting from for instance where it uses[2.x.10] and[2.x.11] which transfer between the global vector and the level vectors we have several auxiliary namely which stores an object on each level **See b</div><div class="ttdef"><b>Definition:</b> <a href="mg__0_8txt_source.html#l00011">mg_0.txt:11</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gaafbb69cc2a791ae55880fd8d57d0c1b0"><div class="ttname"><a href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a></div><div class="ttdeci">#define AssertIndexRange(index, range)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01827">exceptions.h:1827</a></div></div>
<div class="ttc" id="aclassNumberType_html"><div class="ttname"><a href="classNumberType.html">NumberType</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_af10d04b6961bffb230a58f658ddb7d5d"><div class="ttname"><a href="classScaLAPACKMatrix.html#af10d04b6961bffb230a58f658ddb7d5d">ScaLAPACKMatrix::row_block_size</a></div><div class="ttdeci">int row_block_size</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00925">scalapack.h:925</a></div></div>
<div class="ttc" id="amapping__info__0_8txt_html_aaed09e22b1fee38bd2273caeedfb0e90"><div class="ttname"><a href="mapping__info__0_8txt.html#aaed09e22b1fee38bd2273caeedfb0e90">c</a></div><div class="ttdeci">*An enum to identify various types of cells and faces The most general type is what we typically compute in the FEValues context but for many geometries we can save significant storage ***The cell or face is Cartesian **The cell or face can be described with an affine mapping **The face is i the normal factor on a face is the same on all quadrature points This type is not assigned for cells **There is no special information available for compressing the representation of the object under consideration **Definition of a structure that stores all cached data related to the evaluated geometry from the mapping In order to support hp adaptivity and compressed storage length can be different for different rows it allows to jump at the data of individual rows similar to compressed row storage in sparse matrices We have two different start indices for fields with different sizes The first category of offsets are the indices for Jacobians of the transformation from unit to real second JxW and normal vectors We keep separate arrays for all these data structures because a user code might access only some of them In such a one array will be gone through in a contiguous order with access to all which makes it easy for the processor to prefetch data Having all data in a single array would require some strides in the access which is much more complicated for the processor to called which contains the quadrature weights and permutations of how to go through quadrature points in case of face data The latter comes in a vector for the support of hp with several data fields for the individual quadrature formulas ***Constructor Does nothing **Set up the lengths in the various members of this struct **Set up the lengths in the various members of this struct **Returns the memory consumption in bytes **Number of quadrature points applied on the given cell or face **Original one dimensional quadrature formula applied on the given cell or face **Quadrature formula applied on the given cell or face **Quadrature weights separated by dimension for use in specific situations **A cached vector of quadrature weights in the given number the evaluation of basis functions is not in the correct order if a face is not in the standard orientation to a given element This data structure is used to re order the data evaluated on quadrature points to represent the correct order **A class describing the layout of the sections in the[2.x.2] field and also includes some data that depends on the number of quadrature points in the hp context such as the inner quadrature formula and re indexing for faces that are not in the standard orientation **Collection of quadrature formulae applied on the given face *Only filled for since faces might be quadrilateral or triangle shaped **Stores the index offset into the arrays[2.x.4][2.x.5][2.x.6] and the second derivatives Note that affine cells have shorter fields of where the others have lengths equal to the number of quadrature points of the given cell **The storage of the Jacobian i the inverse and transposed Jacobians of the transformation from the unit to the real cell Indexed by[2.x.9] Contains two fields for access from both sides for interior but the default only the upper diagonal and diagonal part are needed The first index runs through the starting with the diagonal and then continuing row i and so on The second index is the spatial coordinate Indexed by[2.x.12] Contains two fields for access from both sides for interior but the default including a compression scheme for Cartesian cells where we do not need to store the full data on all points Indexed by *[2.x.16] *Clears all data fields except the descriptor vector **Returns the quadrature index for a given number of quadrature points If not in hp mode or if the index is not this function always returns index this function does not check whether the given degree is actually present **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **Returns the memory consumption in bytes **The class that stores all geometry dependent data related with cell interiors for use in the matrix free class ***Compute the information in the given cells and faces The cells are specified by the level and the index within the a mapping and several quadrature formulas are given **Update the information in the given cells and faces that is the result of a change in the given mapping keeping the quadrature formulas and other unknowns unchanged This call is only valid if[2.x.20] has been called before **Return the type of a given cell as detected during initialization **Clear all data fields in this class **Return the memory consumption of this class in bytes **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **The given update flags for computing the geometry on the cells **The given update flags for computing the geometry on the boundary faces **The given update flags for computing the geometry on the interior faces **The given update flags for computing the geometry on the faces for cell centric loops **Stores whether a cell is has constant transform data() or is whether it represents an affine whether it is a flat face where the normal vector is the same throughout the or is following the[2.x.21] variable for the cell types **The pointer to the underlying[2.x.22] object **The pointer to the first entry of mapping_collection **Reference cell type related to each quadrature and active quadrature index **Internal function to compute the geometry for the case the mapping is a MappingQ and a single quadrature formula per i it uses a polynomial description of the cell especially when several different quadrature formulas are and consumes less memory[2.x.23] tria The triangulation to be used for setup[2.x.24] cells The actual cells of the triangulation to be worked given as a tuple of the level and index within the level as used in the main initialization of the class ::x faces The description of the connectivity from faces to cells as filled in the MatrixFree class **Computes the information in the given called within initialize **Computes the information in the given called within initialize **Computes the information in the given called within initialize **Helper function to determine which update flags must be set in the internal functions to initialize all data as requested by the user **A helper class to extract either cell or face data from mapping info for use in FEEvaluationBase **A class that is used to compare floating point c</div><div class="ttdef"><b>Definition:</b> <a href="mapping__info__0_8txt_source.html#l00116">mapping_info_0.txt:116</a></div></div>
<div class="ttc" id="anamespaceStep20_1_1PrescribedSolution_html_a2ec9d2a9c0f55b8fb13bd1c83c358e38"><div class="ttname"><a href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">Step20::PrescribedSolution::beta</a></div><div class="ttdeci">constexpr double beta</div><div class="ttdef"><b>Definition:</b> <a href="step-20_8cc_source.html#l00088">step-20.cc:88</a></div></div>
<div class="ttc" id="aclassUtilities_1_1MPI_1_1ProcessGrid_html_a008060e7491aa63e8038f6098b1908e4"><div class="ttname"><a href="classUtilities_1_1MPI_1_1ProcessGrid.html#a008060e7491aa63e8038f6098b1908e4">Utilities::MPI::ProcessGrid::mpi_communicator</a></div><div class="ttdeci">MPI_Comm mpi_communicator</div><div class="ttdef"><b>Definition:</b> <a href="base_2process__grid_8h_source.html#l00214">process_grid.h:214</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ab755a374266785648ae364b6d78f6c94"><div class="ttname"><a href="classScaLAPACKMatrix.html#ab755a374266785648ae364b6d78f6c94">ScaLAPACKMatrix::reinit</a></div><div class="ttdeci">void reinit(const size_type n_rows, const size_type n_columns, const std::shared_ptr&lt; const Utilities::MPI::ProcessGrid &gt; &amp;process_grid, const size_type row_block_size=32, const size_type column_block_size=32, const LAPACKSupport::Property property=LAPACKSupport::Property::general)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00216">scalapack.cc:216</a></div></div>
<div class="ttc" id="abase_2array__view_8h_html"><div class="ttname"><a href="base_2array__view_8h.html">array_view.h</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a86885edfb652da041a42028c469d32b0"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a86885edfb652da041a42028c469d32b0">LAPACKSupport::eigenvalues</a></div><div class="ttdeci">@ eigenvalues</div><div class="ttdoc">Eigenvalue vector is filled.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00071">lapack_support.h:71</a></div></div>
<div class="ttc" id="aclassLAPACKFullMatrix_html"><div class="ttname"><a href="classLAPACKFullMatrix.html">LAPACKFullMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2array__view_8h_source.html#l00036">array_view.h:36</a></div></div>
<div class="ttc" id="achunk__sparsity__pattern__0_8txt_html_a5b51102d307d0296227f3b3f5b095be4"><div class="ttname"><a href="chunk__sparsity__pattern__0_8txt.html#a5b51102d307d0296227f3b3f5b095be4">add</a></div><div class="ttdeci">&lt;/tt &gt; with&lt; tt &gt; v&lt;/tt &gt; a vector of ChunkSparsityPattern objects it is sufficient to use the keyword to disallow unwanted but this does not work for[2.x.6] Since copying a structure like this is not useful anyway because multiple matrices can use the same sparsity copies are only allowed for empty as described above **Initialize a rectangular matrix[2.x.7] m number of rows[2.x.8] n number of columns[2.x.9] max_per_row maximum number of nonzero entries per row **Initialize a rectangular matrix[2.x.10] m number of rows[2.x.11] n number of columns[2.x.12] row_lengths possible number of nonzero entries for each row This vector must have one entry for each row **Initialize a quadratic matrix of dimension&lt; tt &gt; n&lt;/tt &gt; with at most&lt; tt &gt; max_per_row&lt;/tt &gt; nonzero entries per row This constructor automatically enables optimized storage of diagonal elements To avoid use the constructor taking row and column numbers separately **Initialize a quadratic matrix[2.x.13] m number of rows and columns[2.x.14] row_lengths possible number of nonzero entries for each row This vector must have one entry for each row **Destructor **Copy subsequent calls to add() and a final call to close() if you know exactly in advance the entries that will form the matrix sparsity pattern. The first two parameters determine the size of the matrix. For the two last ones</div></div>
<div class="ttc" id="aclassLAPACKFullMatrix_html_a9b75af632cd9b8fb02f65a684e9c4201"><div class="ttname"><a href="classLAPACKFullMatrix.html#a9b75af632cd9b8fb02f65a684e9c4201">LAPACKFullMatrix::m</a></div><div class="ttdeci">size_type m() const</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__full__matrix_8h_source.html#l01009">lapack_full_matrix.h:1009</a></div></div>
<div class="ttc" id="apolynomials__abf__0_8txt_html_a7a716deb19e461cf8ba2a26e01c6a908"><div class="ttname"><a href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a></div><div class="ttdeci">*This class implements the[1.x.0] vector valued Arnold Boffi Falk polynomials as described in the article by Arnold Boffi SIAM J Numer Anal pp **The ABF polynomials are constructed such that the divergence is in the tensor product polynomial space[1.x.1] the polynomial order of each component must be two orders higher in the corresponding yielding the polynomial spaces[1.x.2] and[1.x.3] in resp ******Constructor Creates all basis functions for Raviart Thomas polynomials of given degree[2.x.1] k</div><div class="ttdef"><b>Definition:</b> <a href="polynomials__abf__0_8txt_source.html#l00013">polynomials_abf_0.txt:13</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a65afd93d8c47d4e8bc413fa1fac7fa83"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of and gets compile or both ****auto_diff_1 Automatic differentiation *commonly also referred to as algorithmic is a numerical method that can be used to automatically compute the and perhaps higher order</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00019">automatic_and_symbolic_differentiation_0.txt:19</a></div></div>
<div class="ttc" id="aclassScalarPolynomialsBase_html_a1f249ec13923bf17eac6469d92804ec8"><div class="ttname"><a href="classScalarPolynomialsBase.html#a1f249ec13923bf17eac6469d92804ec8">ScalarPolynomialsBase::n</a></div><div class="ttdeci">unsigned int n() const</div><div class="ttdef"><b>Definition:</b> <a href="base_2scalar__polynomials__base_8h_source.html#l00227">scalar_polynomials_base.h:227</a></div></div>
<div class="ttc" id="afe__dgp__monomial__0_8txt_html_a693ae94e63a794847813a4e1cb94fdac"><div class="ttname"><a href="fe__dgp__monomial__0_8txt.html#a693ae94e63a794847813a4e1cb94fdac">property</a></div><div class="ttdeci">*Discontinuous finite elements based on monomials *This finite element implements complete polynomial that dim dimensional polynomials of degree p For in the element which is in contrast to the element it is immediately clear that this element can not be continuous *The basis functions for this element are chosen to be the monomials listed above Note that this is the main difference to the FE_DGP class that uses a set of polynomials of complete degree[2.x.2] that form a Legendre basis on the unit square the mass matrix is if the grid cells are parallelograms The basis here does not have this property</div><div class="ttdef"><b>Definition:</b> <a href="fe__dgp__monomial__0_8txt_source.html#l00004">fe_dgp_monomial_0.txt:4</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html"><div class="ttname"><a href="classScaLAPACKMatrix.html">ScaLAPACKMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00069">scalapack.h:69</a></div></div>
<div class="ttc" id="adata__out__base__0_8txt_html_a0069596c748f19eefb336d83ba03c96f"><div class="ttname"><a href="data__out__base__0_8txt.html#a0069596c748f19eefb336d83ba03c96f">grid</a></div><div class="ttdeci">if you want to write out data on such a grid</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base__0_8txt_source.html#l00010">data_out_base_0.txt:10</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_aa41a2ed7e7d97d1bab0742f8dd4f48b5"><div class="ttname"><a href="classScaLAPACKMatrix.html#aa41a2ed7e7d97d1bab0742f8dd4f48b5">ScaLAPACKMatrix::norm_symmetric</a></div><div class="ttdeci">NumberType norm_symmetric(const char type) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02476">scalapack.cc:2476</a></div></div>
<div class="ttc" id="aclassLAPACKFullMatrix_html_ab7d05c5ec71b091ea75e65c049e511ea"><div class="ttname"><a href="classLAPACKFullMatrix.html#ab7d05c5ec71b091ea75e65c049e511ea">LAPACKFullMatrix::n</a></div><div class="ttdeci">size_type n() const</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__full__matrix_8h_source.html#l01016">lapack_full_matrix.h:1016</a></div></div>
<div class="ttc" id="afunction__tools__0_8txt_html_a1a2acf608502527a80c0aeecdc12c908"><div class="ttname"><a href="function__tools__0_8txt.html#a1a2acf608502527a80c0aeecdc12c908">a</a></div><div class="ttdeci">*Estimate bounds on the value and bounds on each gradient component of a over a by approximating it by a order Taylor polynomial starting from the box center Each lower and upper bound is returned as a[2.x.1]</div><div class="ttdef"><b>Definition:</b> <a href="function__tools__0_8txt_source.html#l00002">function_tools_0.txt:2</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a0a53f1e6c1fce2ca93b718f34d215ae9"><div class="ttname"><a href="classScaLAPACKMatrix.html#a0a53f1e6c1fce2ca93b718f34d215ae9">ScaLAPACKMatrix::eigenpairs_symmetric_by_value_MRRR</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; eigenpairs_symmetric_by_value_MRRR(const std::pair&lt; NumberType, NumberType &gt; &amp;value_limits, const bool compute_eigenvectors)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01786">scalapack.cc:1786</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_adcfc441f7e61468e505c20a2b937c46c"><div class="ttname"><a href="classScaLAPACKMatrix.html#adcfc441f7e61468e505c20a2b937c46c">ScaLAPACKMatrix::TmTmult</a></div><div class="ttdeci">void TmTmult(ScaLAPACKMatrix&lt; NumberType &gt; &amp;C, const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const bool adding=false) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01226">scalapack.cc:1226</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ae9aa2d98bc501ca6c59b7bf72f3c0ceb"><div class="ttname"><a href="classScaLAPACKMatrix.html#ae9aa2d98bc501ca6c59b7bf72f3c0ceb">ScaLAPACKMatrix::copy_transposed</a></div><div class="ttdeci">void copy_transposed(const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00981">scalapack.cc:981</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a23f528e743bbb29f0608960eb420c102"><div class="ttname"><a href="classScaLAPACKMatrix.html#a23f528e743bbb29f0608960eb420c102">ScaLAPACKMatrix::least_squares</a></div><div class="ttdeci">void least_squares(ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const bool transpose=false)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02134">scalapack.cc:2134</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a988e7c86e7e560b2d8c815317a565371"><div class="ttname"><a href="classScaLAPACKMatrix.html#a988e7c86e7e560b2d8c815317a565371">ScaLAPACKMatrix::save</a></div><div class="ttdeci">void save(const std::string &amp;filename, const std::pair&lt; unsigned int, unsigned int &gt; &amp;chunk_size=std::make_pair(numbers::invalid_unsigned_int, numbers::invalid_unsigned_int)) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02608">scalapack.cc:2608</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ab1a0999bd5c5d5a519ae09bb1b1f6ddd"><div class="ttname"><a href="classScaLAPACKMatrix.html#ab1a0999bd5c5d5a519ae09bb1b1f6ddd">ScaLAPACKMatrix::set_property</a></div><div class="ttdeci">void set_property(const LAPACKSupport::Property property)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00303">scalapack.cc:303</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a8242435e8730f7cac460b1ac2310c7ed"><div class="ttname"><a href="classScaLAPACKMatrix.html#a8242435e8730f7cac460b1ac2310c7ed">ScaLAPACKMatrix::mmult</a></div><div class="ttdeci">void mmult(ScaLAPACKMatrix&lt; NumberType &gt; &amp;C, const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const bool adding=false) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01184">scalapack.cc:1184</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_aae1c9ee4a7967975a161bc336d24a173"><div class="ttname"><a href="classScaLAPACKMatrix.html#aae1c9ee4a7967975a161bc336d24a173">ScaLAPACKMatrix::property</a></div><div class="ttdeci">LAPACKSupport::Property property</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00899">scalapack.h:899</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga0d685aad996180f9851183ae3e29019a"><div class="ttname"><a href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">StandardExceptions::ExcIndexRange</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcIndexRange(int arg1, int arg2, int arg3)</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga83a07eaacbb97effd136cf5e49fa831a"><div class="ttname"><a href="group__Exceptions.html#ga83a07eaacbb97effd136cf5e49fa831a">AssertIsFinite</a></div><div class="ttdeci">#define AssertIsFinite(number)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01863">exceptions.h:1863</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98ada41a4e38396361e72345ad4ad1d7388">LAPACKSupport::symmetric</a></div><div class="ttdeci">@ symmetric</div><div class="ttdoc">Matrix is symmetric.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00120">lapack_support.h:120</a></div></div>
<div class="ttc" id="afe__nedelec__sz__0_8txt_html_a608cb7709f379e8a072b27b7b897d245"><div class="ttname"><a href="fe__nedelec__sz__0_8txt.html#a608cb7709f379e8a072b27b7b897d245">v1</a></div><div class="ttdeci">the total polynomial degree may be higher If the element is linear and has degrees of freedom only on the edges If faces and volume For example the version of FE_NedelecSZ has degrees of freedom for where order is the order of FE_NedelecSZ **This element is vector valued so this function will throw an exception **Not implemented **This element is vector valued so this function will throw an exception **Not implemented **This element is vector valued so this function will throw an exception **Not implemented **The mapping kind to be used to map shape functions from the reference cell to the mesh cell **Compute information about the shape functions on the cell denoted by the first argument Note that this function must recompute the cell dependent degrees of and so is not thread safe at this time **Compute information about the shape functions on the cell and face denoted by the first two arguments Note that this function must recompute the cell dependent degrees of and so is not thread safe at this time **Not implemented **Derived Internal data which is used to store cell independent data Note that due to the nature of this a number of useful pre computed quantities are stored for the computation of cell dependent shape functions The main quantities which are stored are associated with edge and face parameterizations These equal to one at the[2.x.5] th vertex and zero at all other vertices *[2.x.6][2.x.7][2.x.8] *linear functional associated with the[2.x.9] th vertex[2.x.10][2.x.11] The definitions of these as well as the edge and face parameterizations and edge and face extension can be found on page of Zaglmayr s thesis The details of the definition of the globally defined edge and face orientations can be found on page **Storage for shape functions on the reference element We only pre compute cell based as the edge and face based DoFs depend on the cell Due to the cell dependent this variable is declared mutable **Storage for shape function gradients on the reference element We only pre compute cell based as the edge and face based DoFs depend on the cell Due to the cell dependent this variable is declared mutable **Storage for all possible edge parameterization between vertices These are required in the computation of edge and face based which are cell dependent The edge parameterization of an starting at vertex i and ending at vertex[2.x.12] is given by[2.x.13] sigma_imj_values[q][i][j] stores the value of the edge parameterization connected by vertices[2.x.14] and[2.x.15] at the q th quadrature point Note that not all of the[2.x.16] and[2.x.17] combinations result in valid edges on the hexahedral but they are computed in this fashion for use with non standard edge and face orientations **Storage for gradients of all possible edge parameterizations between vertices These are required in the computation of edge and face based which are cell dependent Note that the components of the gradient are constant The edge parameterization of an starting at vertex[2.x.19] and ending at vertex[2.x.20] is given by[2.x.21] sigma_imj_grads[i][j][d] stores the gradient of the edge parameterization connected by vertices[2.x.22] and[2.x.23] in component[2.x.24] Note that the gradient of the edge parameterization is constant on an so we do not need to store it at every quadrature point **Storage for values of edge parameterizations at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell edge_sigma_values[m][q] stores the edge parameterization value at the q th quadrature point on edge m These values change with the orientation of the edges of a physical cell and so must take the sign into account when used for computation **Storage for gradients of edge parameterization at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell edge_sigma_grads[m][d] stores the gradient of the edge parameterization for component d on edge m These values change with the orientation of the edges of a physical cell and so must take the sign into account when used for computation **Storage for edge extension parameters at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell The edge extension parameter of an starting at vertex[2.x.26] and ending at vertex[2.x.27] is given by[2.x.28] Note that under this the values of[2.x.29] do not change with the orientation of the edge edge_lambda_values[m][q] stores the edge extension parameter value at the[2.x.30] th quadrature point on edge *[2.x.31] *Storage for gradients of edge extension parameters in In this case they are constant These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_grads_2d[m][d] stores the gradient of the edge extension parameter for component[2.x.32] on edge *[2.x.33] *Storage for gradients of edge extension parameters in In this case they are non constant These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_grads_3d[m][q][d] stores the gradient of the edge extension parameter for component[2.x.34] at the[2.x.35] th quadrature point on edge m **Storage for derivatives of edge extension parameters which are constant across the cell These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_gradgrads_3d[m][d1][d2] stores the derivatives of the edge extension parameters with respect to components d1 and d2 on edge *[2.x.36] *Storage for the face extension parameters These are stored for the faces such that the global vertex numbering would follow the order defined by the standard deal II cell The face extension parameter of a defined by the vertices v1</div><div class="ttdef"><b>Definition:</b> <a href="fe__nedelec__sz__0_8txt_source.html#l00059">fe_nedelec_sz_0.txt:59</a></div></div>
<div class="ttc" id="abase_2mpi_8h_html"><div class="ttname"><a href="base_2mpi_8h.html">mpi.h</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a432e6f19e0ba55f12031a1a68fa7ab17"><div class="ttname"><a href="classScaLAPACKMatrix.html#a432e6f19e0ba55f12031a1a68fa7ab17">ScaLAPACKMatrix::size_type</a></div><div class="ttdeci">unsigned int size_type</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00076">scalapack.h:76</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_aa802e135eb0b2b5fb07636b3ad20e123"><div class="ttname"><a href="classScaLAPACKMatrix.html#aa802e135eb0b2b5fb07636b3ad20e123">ScaLAPACKMatrix::n_columns</a></div><div class="ttdeci">int n_columns</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00919">scalapack.h:919</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_1_1internal_1_1Tags_html_a1c190e50dabbd9b60e230b843c6caa44a6fbc4c4e968c254b02e0361b2499ed89"><div class="ttname"><a href="namespaceUtilities_1_1MPI_1_1internal_1_1Tags.html#a1c190e50dabbd9b60e230b843c6caa44a6fbc4c4e968c254b02e0361b2499ed89">Utilities::MPI::internal::Tags::scalapack_copy_to2</a></div><div class="ttdeci">@ scalapack_copy_to2</div><div class="ttdoc">ScaLAPACKMatrix&lt;NumberType&gt;::copy_to.</div><div class="ttdef"><b>Definition:</b> <a href="base_2mpi__tags_8h_source.html#l00178">mpi_tags.h:178</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638">LAPACKSupport::State</a></div><div class="ttdeci">State</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="anamespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2matrix__block_8h_source.html#l00656">matrix_block.h:656</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ae2c72bf2945cab1cd8050371520629ed"><div class="ttname"><a href="classScaLAPACKMatrix.html#ae2c72bf2945cab1cd8050371520629ed">ScaLAPACKMatrix::global_row</a></div><div class="ttdeci">unsigned int global_row(const unsigned int loc_row) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00496">scalapack.cc:496</a></div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="atria__accessor_8templates__0_8txt_html_a456453dd94fbd82cfc84e80f1bb9b520"><div class="ttname"><a href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a></div><div class="ttdeci">*Compute the diameter for a given set of vertices The vertices are depending on their count</div><div class="ttdef"><b>Definition:</b> <a href="tria__accessor_8templates__0_8txt_source.html#l00002">tria_accessor.templates_0.txt:2</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a1778f4beadba1c47a5c4d0b4ff0390b0">LAPACKSupport::unusable</a></div><div class="ttdeci">@ unusable</div><div class="ttdoc">Contents is something useless.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00077">lapack_support.h:77</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a28ea56ec89f475fdefb3ccd0e0c64e54"><div class="ttname"><a href="multithreading__0_8txt.html#a28ea56ec89f475fdefb3ccd0e0c64e54">work</a></div><div class="ttdeci">threads then execute sub ranges if they are done with their work</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00081">multithreading_0.txt:81</a></div></div>
<div class="ttc" id="aindex__set__0_8txt_html_a06c4d20c91ab07a0e74210eb580db6d1"><div class="ttname"><a href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a></div><div class="ttdeci">*A class that represents a subset of indices among a larger set For example it can be used to denote the set of degrees of freedom within the range[2.x.0] that belongs to a particular or those among all degrees of freedom that are stored on a particular processor in a distributed parallel computation *This class can represent a collection of half open ranges of indices as well as individual elements For practical purposes it also stores the overall range these indices can assume In other words you need to specify the size of the index space[2.x.1] of which objects of this class are a subset *There are two ways to iterate over the begin() and end() allow iteration over individual indices in the set. Second</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ac78850bc990c4f8de2270176a95b177a"><div class="ttname"><a href="classScaLAPACKMatrix.html#ac78850bc990c4f8de2270176a95b177a">ScaLAPACKMatrix::load_serial</a></div><div class="ttdeci">void load_serial(const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l03064">scalapack.cc:3064</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a443dbf06df77b3d40eb1a355ae88e5ba"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a443dbf06df77b3d40eb1a355ae88e5ba">LAPACKSupport::inverse_svd</a></div><div class="ttdeci">@ inverse_svd</div><div class="ttdoc">Matrix is the inverse of a singular value decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00075">lapack_support.h:75</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a36438ff9295f52ed4bb385663529f6cb"><div class="ttname"><a href="classScaLAPACKMatrix.html#a36438ff9295f52ed4bb385663529f6cb">ScaLAPACKMatrix::mTmult</a></div><div class="ttdeci">void mTmult(ScaLAPACKMatrix&lt; NumberType &gt; &amp;C, const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const bool adding=false) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01212">scalapack.cc:1212</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a965e8f1c07847958b77370b5074bee91"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a965e8f1c07847958b77370b5074bee91">LAPACKSupport::lu</a></div><div class="ttdeci">@ lu</div><div class="ttdoc">Contents is an LU decomposition.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00067">lapack_support.h:67</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_af85863b31be0cbd660acba99051e0634"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a></div><div class="ttdeci">****This module contains classes that are used in the exception mechanism of deal II **Exceptions are used in two different not in static assertions are typically used to check that parameters to functions satisfy certain that internal data structures are and similar assertions For static assertions are used to make sure that two vectors that are added together have the same number of components **everything else would not make any sense anyway *Such checks are performed by the[2.x.3] macro in several thousand places within the library several tutorial programs starting with[2.x.4] show how to do this *If static a assertion is the exception mechanism generates an exception of a type that indicates what exactly goes wrong displays appropriate information including the exact location where the problem was detected and then aborts the program **if you try to add two vectors of different there is nothing that can be done within the program to cope with the you have to go fix the program code instead There is generally not even a reason to[2.x.5] an exception object using the usual C exception mechanism because there is nothing a function higher up could do in such cases to rectify the situation and deal with it in a useful way **it s not that the program received bad data</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00015">exceptions_0.txt:15</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_ae10eacb6dbdb705df9683564f03ee525"><div class="ttname"><a href="classScaLAPACKMatrix.html#ae10eacb6dbdb705df9683564f03ee525">ScaLAPACKMatrix::global_column</a></div><div class="ttdeci">unsigned int global_column(const unsigned int loc_column) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00513">scalapack.cc:513</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_af71d4b9497936fedf1398c0b6fba2ee7"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#af71d4b9497936fedf1398c0b6fba2ee7">Utilities::MPI::create_group</a></div><div class="ttdeci">int create_group(const MPI_Comm &amp;comm, const MPI_Group &amp;group, const int tag, MPI_Comm *new_comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00181">mpi.cc:181</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a56a20ea915118b8b2b149e3d4af10a5e"><div class="ttname"><a href="classScaLAPACKMatrix.html#a56a20ea915118b8b2b149e3d4af10a5e">ScaLAPACKMatrix::eigenpairs_symmetric_MRRR</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; eigenpairs_symmetric_MRRR(const bool compute_eigenvectors, const std::pair&lt; unsigned int, unsigned int &gt; &amp;index_limits=std::make_pair(numbers::invalid_unsigned_int, numbers::invalid_unsigned_int), const std::pair&lt; NumberType, NumberType &gt; &amp;value_limits=std::make_pair(std::numeric_limits&lt; NumberType &gt;::quiet_NaN(), std::numeric_limits&lt; NumberType &gt;::quiet_NaN()))</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01804">scalapack.cc:1804</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga9677b6d6fb5a89c8b7778bb8b13314e4"><div class="ttname"><a href="group__Exceptions.html#ga9677b6d6fb5a89c8b7778bb8b13314e4">AssertThrowMPI</a></div><div class="ttdeci">#define AssertThrowMPI(error_code)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01894">exceptions.h:1894</a></div></div>
<div class="ttc" id="anamespaceStep20_1_1PrescribedSolution_html_a6142e18d25af27882714d1787af4ee59"><div class="ttname"><a href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">Step20::PrescribedSolution::alpha</a></div><div class="ttdeci">constexpr double alpha</div><div class="ttdef"><b>Definition:</b> <a href="step-20_8cc_source.html#l00087">step-20.cc:87</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a7a4b0582dd1e9230b5b59a6b2b698713"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7a4b0582dd1e9230b5b59a6b2b698713">LAPACKSupport::lower_triangular</a></div><div class="ttdeci">@ lower_triangular</div><div class="ttdoc">Matrix is lower triangular.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00124">lapack_support.h:124</a></div></div>
<div class="ttc" id="aclassAlignedVector_html_a60d3ec3ed58e7c10cb66288834220cd3"><div class="ttname"><a href="classAlignedVector.html#a60d3ec3ed58e7c10cb66288834220cd3">AlignedVector::data</a></div><div class="ttdeci">pointer data()</div></div>
<div class="ttc" id="avector__valued__0_8txt_html_add141cdc4d28d06d71948acb7f0c7150"><div class="ttname"><a href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a></div><div class="ttdeci">each of these vectors has[2.x.174] elements containing the values of the[2.x.175] velocities and the one pressure at a quadrature point *We can use these values to then construct other things like residuals the construct is a bit awkward we have a[2.x.176] s</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00155">vector_valued_0.txt:155</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga2a8559dd80dc049c51ea5f56e4038a4c"><div class="ttname"><a href="group__Exceptions.html#ga2a8559dd80dc049c51ea5f56e4038a4c">SparseMatrixEZ::n_columns</a></div><div class="ttdeci">size_type n_columns</div><div class="ttdef"><b>Definition:</b> <a href="lac_2sparse__matrix__ez_8h_source.html#l00945">sparse_matrix_ez.h:945</a></div></div>
<div class="ttc" id="aclassArrayView_html_a2339bfed866b07b8d100f017616e2f2a"><div class="ttname"><a href="classArrayView.html#a2339bfed866b07b8d100f017616e2f2a">ArrayView::make_array_view</a></div><div class="ttdeci">ArrayView&lt; typename std::remove_reference&lt; typename std::iterator_traits&lt; Iterator &gt;::reference &gt;::type, MemorySpaceType &gt; make_array_view(const Iterator begin, const Iterator end)</div><div class="ttdef"><b>Definition:</b> <a href="base_2array__view_8h_source.html#l00715">array_view.h:715</a></div></div>
<div class="ttc" id="anamespaceDifferentiation_1_1SD_html_a6545410ba18556ebf7c478b6ad9939f6"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a6545410ba18556ebf7c478b6ad9939f6">Differentiation::SD::ceil</a></div><div class="ttdeci">Expression ceil(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00301">symengine_math.cc:301</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a></div><div class="ttdeci">@ values</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__flags_8h_source.html#l00055">evaluation_flags.h:55</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a49f5b93c67c0f8851fd29ed89e4220cd"><div class="ttname"><a href="classScaLAPACKMatrix.html#a49f5b93c67c0f8851fd29ed89e4220cd">ScaLAPACKMatrix::get_state</a></div><div class="ttdeci">LAPACKSupport::State get_state() const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00322">scalapack.cc:322</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_af6819321d6f65302155b6b7e2be70988"><div class="ttname"><a href="classScaLAPACKMatrix.html#af6819321d6f65302155b6b7e2be70988">ScaLAPACKMatrix::scale_columns</a></div><div class="ttdeci">void scale_columns(const InputVector &amp;factors)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l03496">scalapack.cc:3496</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a7578e1be3f70805316ec69f587ed7730"><div class="ttname"><a href="classScaLAPACKMatrix.html#a7578e1be3f70805316ec69f587ed7730">ScaLAPACKMatrix::load</a></div><div class="ttdeci">void load(const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l03043">scalapack.cc:3043</a></div></div>
<div class="ttc" id="ampi__0_8txt_html_a0585dbdf9f181004518cc3ae72b5b65f"><div class="ttname"><a href="mpi__0_8txt.html#a0585dbdf9f181004518cc3ae72b5b65f">MPI_Allgather</a></div><div class="ttdeci">*Helper macro to const remove from the pointer arguments to some MPI_ *functions *This is needed as the input arguments of functions like MPI_Allgather() are not marked as const in OpenMPI 1.6.5. If using MPI 3 or new er</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a5f723f324b1c7c22941f33034b652eec"><div class="ttname"><a href="classScaLAPACKMatrix.html#a5f723f324b1c7c22941f33034b652eec">ScaLAPACKMatrix::invert</a></div><div class="ttdeci">void invert()</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01314">scalapack.cc:1314</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a546401290947b77277a5f1811bc97ea2"><div class="ttname"><a href="classScaLAPACKMatrix.html#a546401290947b77277a5f1811bc97ea2">ScaLAPACKMatrix::Tmmult</a></div><div class="ttdeci">void Tmmult(ScaLAPACKMatrix&lt; NumberType &gt; &amp;C, const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const bool adding=false) const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01198">scalapack.cc:1198</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a462e4473e763e00148572e554395c448"><div class="ttname"><a href="classScaLAPACKMatrix.html#a462e4473e763e00148572e554395c448">ScaLAPACKMatrix::add</a></div><div class="ttdeci">void add(const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B, const NumberType a=0., const NumberType b=1., const bool transpose_B=false)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00991">scalapack.cc:991</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a895dcd8223a0ee6f0e6a80b80e2d5982"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a></div><div class="ttdeci">unsigned int this_mpi_process(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00128">mpi.cc:128</a></div></div>
<div class="ttc" id="aclassTransposeTable_html_a1850f8cb99a54fe25506a8ff39418aaf"><div class="ttname"><a href="classTransposeTable.html#a1850f8cb99a54fe25506a8ff39418aaf">TransposeTable::reinit</a></div><div class="ttdeci">void reinit(const size_type size1, const size_type size2, const bool omit_default_initialization=false)</div></div>
<div class="ttc" id="ablock__sparse__matrix__ez__0_8txt_html_af734f4df74ac4822dd99a6cca7203600"><div class="ttname"><a href="block__sparse__matrix__ez__0_8txt.html#af734f4df74ac4822dd99a6cca7203600">m</a></div><div class="ttdeci">Matrix1 *[2.x.1] **A block matrix consisting of blocks of type SparseMatrixEZ *Like the other Block this matrix can be used like a when it comes to access to entries there are functions for the multiplication with BlockVector and access to the individual blocks the block s must be empty **Copy this operation is only allowed if the actual value to be assigned is zero This in order to be able to relay global indices into the matrix to indices into the subobjects Youmust *call this function each time after you have changed the size of the sub objects **Access the block with the given coordinates **Access the block with the given coordinates Version for constant objects **Return the number of blocks in a column **Return the number of blocks in a row **Return whether the object is empty It is empty if no memory is which is the same as that both dimensions are zero This function is just the concatenation of the respective call to all sub matrices **Return number of rows of this which equals the dimension of the which equals the dimension of the domain space It is the sum of the number of columns over the sub matrix blocks of this matrix Recall that the matrix is of size m() times n(). *[0.x.18] *Set the element&lt; tt &gt;(i</div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a7bdd80b5e29a004e22f2aeb150e5ec51"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a7bdd80b5e29a004e22f2aeb150e5ec51">LAPACKSupport::diagonal</a></div><div class="ttdeci">@ diagonal</div><div class="ttdoc">Matrix is diagonal.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00126">lapack_support.h:126</a></div></div>
<div class="ttc" id="anamespaceCUDAWrappers_html_a864647b22a94b792d131a43d5823c9f1"><div class="ttname"><a href="namespaceCUDAWrappers.html#a864647b22a94b792d131a43d5823c9f1">CUDAWrappers::chunk_size</a></div><div class="ttdeci">constexpr int chunk_size</div><div class="ttdef"><b>Definition:</b> <a href="base_2cuda__size_8h_source.html#l00037">cuda_size.h:37</a></div></div>
<div class="ttc" id="atria__objects__0_8txt_html_a2a2a31a8b067d7c9972c9f03fb7712a1"><div class="ttname"><a href="tria__objects__0_8txt.html#a2a2a31a8b067d7c9972c9f03fb7712a1">status</a></div><div class="ttdeci">*General template for information belonging to the geometrical objects of a i e hexahedra Apart from the vector of objects additional information is namely vectors indicating the the used status</div><div class="ttdef"><b>Definition:</b> <a href="tria__objects__0_8txt_source.html#l00002">tria_objects_0.txt:2</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a0a17919a2ff3b9c8dc1f76beca7f57b4"><div class="ttname"><a href="classScaLAPACKMatrix.html#a0a17919a2ff3b9c8dc1f76beca7f57b4">ScaLAPACKMatrix::pseudoinverse</a></div><div class="ttdeci">unsigned int pseudoinverse(const NumberType ratio)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02226">scalapack.cc:2226</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ac26de0c059200523177bb1d92cc25d00"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a></div><div class="ttdeci">unsigned int n_mpi_processes(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00117">mpi.cc:117</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a8ae36952c7e0cc778b47b5371b3aeff1"><div class="ttname"><a href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a></div><div class="ttdeci">static const unsigned int invalid_unsigned_int</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00179">types.h:179</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a177c697348e3052c514824563807ea3b"><div class="ttname"><a href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div><div class="ttdeci">**Throughout deal we strive to keep our programming style and the kind ofinterfaces we provide as consistent as possible To this end</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00003">coding_conventions_0.txt:3</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a84115bec54d73663a31d714e1a17c82c"><div class="ttname"><a href="classScaLAPACKMatrix.html#a84115bec54d73663a31d714e1a17c82c">ScaLAPACKMatrix::eigenpairs_symmetric</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; eigenpairs_symmetric(const bool compute_eigenvectors, const std::pair&lt; unsigned int, unsigned int &gt; &amp;index_limits=std::make_pair(numbers::invalid_unsigned_int, numbers::invalid_unsigned_int), const std::pair&lt; NumberType, NumberType &gt; &amp;value_limits=std::make_pair(std::numeric_limits&lt; NumberType &gt;::quiet_NaN(), std::numeric_limits&lt; NumberType &gt;::quiet_NaN()))</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01473">scalapack.cc:1473</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a9ac5275c3c74902f8a9d6e7bdb514179"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a></div><div class="ttdeci">T min(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga6060b2304b8600f5efa0d31eeda0207d"><div class="ttname"><a href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">StandardExceptions::ExcDimensionMismatch</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcDimensionMismatch(std::size_t arg1, std::size_t arg2)</div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a940af7650aa330737cd9ec1712d7554f">LAPACKSupport::inverse_matrix</a></div><div class="ttdeci">@ inverse_matrix</div><div class="ttdoc">Contents is the inverse of a matrix.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00065">lapack_support.h:65</a></div></div>
<div class="ttc" id="achunk__sparse__matrix__0_8txt_html_a59317914f0b63e3c2c7c6bd150b8ba3e"><div class="ttname"><a href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a></div><div class="ttdeci">0&lt;/tt &gt;, which sets all elements of the matrix to zero, but keep the sparsity pattern previously used. *[0.x.66] *Reinitialize the sparse matrix with the given sparsity pattern. The latter tells the matrix how many nonzero elements there need to be reserved. Regarding memory allocation, the same applies as said above. You have to make sure that the lifetime of the sparsity structure is at least as long as that of this matrix or as long as reinit(const ChunkSparsityPattern &amp;) is not called with a new sparsity structure. The elements of the matrix are set to zero by this function. *[0.x.67] *Release all memory and return to a state just like after having called the default constructor. It also forgets the sparsity pattern it was previously tied to. *[0.x.68] *[2.x.18] Information on the matrix *[0.x.69] *Return whether the object is empty. It is empty if either both dimensions are zero or no ChunkSparsityPattern is associated. *[0.x.70] *Return the dimension of the codomain(or range) space. Note that the matrix is of dimension[2.x.19] . *[0.x.71] *Return the dimension of the domain space. Note that the matrix is of dimension[2.x.20] . *[0.x.72] *Return the number of nonzero elements of this matrix. Actually, it returns the number of entries in the sparsity pattern matrix</div><div class="ttdef"><b>Definition:</b> <a href="chunk__sparse__matrix__0_8txt_source.html#l00156">chunk_sparse_matrix_0.txt:156</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a354f71241b0d44cba4f46e8410f26fcd"><div class="ttname"><a href="classScaLAPACKMatrix.html#a354f71241b0d44cba4f46e8410f26fcd">ScaLAPACKMatrix::Tadd</a></div><div class="ttdeci">void Tadd(const NumberType b, const ScaLAPACKMatrix&lt; NumberType &gt; &amp;B)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01057">scalapack.cc:1057</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a08c248dd3d7474ad88f01f361fb38763"><div class="ttname"><a href="classScaLAPACKMatrix.html#a08c248dd3d7474ad88f01f361fb38763">ScaLAPACKMatrix::frobenius_norm</a></div><div class="ttdeci">NumberType frobenius_norm() const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02403">scalapack.cc:2403</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_aea9548947486d99129361ec663b410ec"><div class="ttname"><a href="classScaLAPACKMatrix.html#aea9548947486d99129361ec663b410ec">ScaLAPACKMatrix::grid</a></div><div class="ttdeci">std::shared_ptr&lt; const Utilities::MPI::ProcessGrid &gt; grid</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00907">scalapack.h:907</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a04feb5d5c22d71a40c6912ec8f0ee2f9"><div class="ttname"><a href="classScaLAPACKMatrix.html#a04feb5d5c22d71a40c6912ec8f0ee2f9">ScaLAPACKMatrix::compute_SVD</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; compute_SVD(ScaLAPACKMatrix&lt; NumberType &gt; *U=nullptr, ScaLAPACKMatrix&lt; NumberType &gt; *VT=nullptr)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02014">scalapack.cc:2014</a></div></div>
<div class="ttc" id="asynchronous__iterator__0_8txt_html_a3e447fe5e17c249965365f92a0755913"><div class="ttname"><a href="synchronous__iterator__0_8txt.html#a3e447fe5e17c249965365f92a0755913">range</a></div><div class="ttdeci">*A class that represents a set of iterators each of which are incremented by one at the same time This is typically used in calls like[2.x.0] where we have synchronous iterators marching through the containers[2.x.1] If an object of this type represents the end of a range</div><div class="ttdef"><b>Definition:</b> <a href="synchronous__iterator__0_8txt_source.html#l00002">synchronous_iterator_0.txt:2</a></div></div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2full__matrix_8h_source.html#l00070">full_matrix.h:70</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a32bd47df6685fac166ef2a32de1bf91b"><div class="ttname"><a href="classScaLAPACKMatrix.html#a32bd47df6685fac166ef2a32de1bf91b">ScaLAPACKMatrix::descriptor</a></div><div class="ttdeci">int descriptor[9]</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00949">scalapack.h:949</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_af08bd68181f1690263ca241568a65e6e"><div class="ttname"><a href="classScaLAPACKMatrix.html#af08bd68181f1690263ca241568a65e6e">ScaLAPACKMatrix::linfty_norm</a></div><div class="ttdeci">NumberType linfty_norm() const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l02389">scalapack.cc:2389</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98">LAPACKSupport::Property</a></div><div class="ttdeci">Property</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00115">lapack_support.h:115</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">VectorTools::EvaluationFlags::min</a></div><div class="ttdeci">@ min</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00062">vector_tools_evaluate.h:62</a></div></div>
<div class="ttc" id="arefinement__0_8txt_html_a2195d1da36ad3f385300e8ecd70108b0"><div class="ttname"><a href="refinement__0_8txt.html#a2195d1da36ad3f385300e8ecd70108b0">factors</a></div><div class="ttdeci">namespace collects tools to decide which type of adaptive methods to apply[1.x.0] To successfully apply hp adaptive we recommend the following we will determine error estimates in the usual we may determine if those qualify for p adaptive methods Corresponding functions will set[2.x.4] on top of the refinement and coarsening flags if they fulfil a certain criterion In case of the superordinate element of the underlying[2.x.5] will be assigned as the future finite element the subordinate element will be selected for coarsening[2.x.6] will now supply both h and p adaptive methods independently[2.x.7] Right there may be cells scheduled for both h and p adaptation If we do not want to impose both methods at we need to decide which one to pick for each cell individually and unambiguously Since grid refinement will be imposed by default and we only determine qualification for p adaptivity on we will always decide in favour of p adaptive methods Calling[2.x.8] will now perform either h or p adaptive methods uniquely on each cell[2.x.9] Up to this each cell knows its destiny in terms of adaptivity We can now move on to prepare all data structures to be transferred across mesh changes Previously set refinement and coarsening flags as well as[2.x.10] will be used to update the data accordingly[2.x.11] As an a realisation of pure p adaptive methods would look like the while the other one conforms to the reference The result of the comparison will be returned as a boolean **Setting p adaptivity flags *[2.x.14] *Each cell flagged for h refinement will also be flagged for p refinement The same applies to coarsening *and[2.x.17] may change refine and coarsen flags as well as future finite element indices Avoid calling them before this particular function **Adapt which finite element to use on cells that have been specifically flagged for p adaptation via the parameter[2.x.18] Future finite elements will only be assigned if cells have been flagged for refinement and coarsening beforehand Each entry of the parameter[2.x.19] needs to correspond to an active cell *and[2.x.22] may change refine and coarsen flags as well as future finite element indices Avoid calling them before this particular function **Adapt which finite element to use on cells whose criteria meet a certain absolute threshold For p refinement and p two separate thresholds need to provided via parameters[2.x.23] and[2.x.24] We consider a cell for p adaptivity if it is currently flagged for refinement or coarsening and its criterion successfully compares to the corresponding threshold Let us be more specific on the default but the cell s criterion must be lower than or equal to the threshold different compare function objects can be supplied via the parameters[2.x.25] and[2.x.26] to impose different decision strategies Each entry of the parameter[2.x.27] needs to correspond to an active cell *and[2.x.30] may change refine and coarsen flags as well as future finite element indices Avoid calling them before this particular function **Adapt which finite element to use on cells whose criteria meet a certain threshold relative to the overall range of criterion values The threshold will be determined for refined and coarsened cells separately based on the currently set refinement markers For each class of cells we determine the maximal and minimal values of all criteria and determine the threshold by linear interpolation between these limits Parameters[2.x.31] and[2.x.32] are used as interpolation factors</div><div class="ttdef"><b>Definition:</b> <a href="refinement__0_8txt_source.html#l00020">refinement_0.txt:20</a></div></div>
<div class="ttc" id="anamespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2aligned__vector_8h_source.html#l00471">aligned_vector.h:471</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_acf56a3d220794a7c0e0839a1f44ff539"><div class="ttname"><a href="classScaLAPACKMatrix.html#acf56a3d220794a7c0e0839a1f44ff539">ScaLAPACKMatrix::eigenpairs_symmetric_by_index_MRRR</a></div><div class="ttdeci">std::vector&lt; NumberType &gt; eigenpairs_symmetric_by_index_MRRR(const std::pair&lt; unsigned int, unsigned int &gt; &amp;index_limits, const bool compute_eigenvectors)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l01763">scalapack.cc:1763</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a2ea295a0904915804c899950757b1de2"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a2ea295a0904915804c899950757b1de2">LAPACKSupport::hessenberg</a></div><div class="ttdeci">@ hessenberg</div><div class="ttdoc">Matrix is in upper Hessenberg form.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00128">lapack_support.h:128</a></div></div>
<div class="ttc" id="agrid_2manifold__lib__0_8txt_html_a274eab5e4d4c64f33343b97a843e51ca"><div class="ttname"><a href="grid_2manifold__lib__0_8txt.html#a274eab5e4d4c64f33343b97a843e51ca">descriptor</a></div><div class="ttdeci">*Manifold description for a polar coordinate system *You can use this Manifold object to describe any hypersphere or hyperdisc in two or three both as a co dimension one manifold descriptor or as co dimension zero manifold descriptor</div><div class="ttdef"><b>Definition:</b> <a href="grid_2manifold__lib__0_8txt_source.html#l00003">manifold_lib_0.txt:3</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_ac00ea19562c135512a6ff275a3cf0d8f"><div class="ttname"><a href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has this class generates all dim dimensional polynomials of the where the sum and[1.x.8] is less than or equal *[1.x.9] The i e for each dim dimensional polynomial in the polynomial space it gives the indices j</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00004">polynomial_space_0.txt:4</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">VectorTools::EvaluationFlags::max</a></div><div class="ttdeci">@ max</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00056">vector_tools_evaluate.h:56</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a2bdb8189d7e88a60291430a2945e8bc3"><div class="ttname"><a href="classScaLAPACKMatrix.html#a2bdb8189d7e88a60291430a2945e8bc3">ScaLAPACKMatrix::n_rows</a></div><div class="ttdeci">int n_rows</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00913">scalapack.h:913</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a784802959d4846fc5f2fd329ea8c66d5"><div class="ttname"><a href="classScaLAPACKMatrix.html#a784802959d4846fc5f2fd329ea8c66d5">ScaLAPACKMatrix::submatrix_column</a></div><div class="ttdeci">const int submatrix_column</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l01003">scalapack.h:1003</a></div></div>
<div class="ttc" id="alac_2scalapack_8h_html"><div class="ttname"><a href="lac_2scalapack_8h.html">scalapack.h</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a9a12de09785d8b7be4f95e7a6f9fb06a"><div class="ttname"><a href="classScaLAPACKMatrix.html#a9a12de09785d8b7be4f95e7a6f9fb06a">ScaLAPACKMatrix::load_parallel</a></div><div class="ttdeci">void load_parallel(const std::string &amp;filename)</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l03242">scalapack.cc:3242</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_ae3fd76f0fcd93dcbcc9df2df2c6028fb"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of this</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01699">exceptions.h:1699</a></div></div>
<div class="ttc" id="abase_2mpi_8h_html_a1c5369b6df31b6df6d7bcd6a46fdf566"><div class="ttname"><a href="base_2mpi_8h.html#a1c5369b6df31b6df6d7bcd6a46fdf566">DEAL_II_MPI_CONST_CAST</a></div><div class="ttdeci">#define DEAL_II_MPI_CONST_CAST(expr)</div><div class="ttdef"><b>Definition:</b> <a href="base_2mpi_8h_source.html#l00078">mpi.h:78</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a4dcde64aa5131d2a997b7221132cbf5d"><div class="ttname"><a href="classScaLAPACKMatrix.html#a4dcde64aa5131d2a997b7221132cbf5d">ScaLAPACKMatrix::get_property</a></div><div class="ttdeci">LAPACKSupport::Property get_property() const</div><div class="ttdef"><b>Definition:</b> <a href="scalapack_8cc_source.html#l00313">scalapack.cc:313</a></div></div>
<div class="ttc" id="aclassDerivativeForm_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">DerivativeForm::transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="base_2derivative__form_8h_source.html#l00550">derivative_form.h:550</a></div></div>
<div class="ttc" id="agrid__0_8txt_html_abc4bc3849dde2110dfa9e18bf7ae1b8c"><div class="ttname"><a href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a></div><div class="ttdeci">triangles and tetrahedra are not supported *This collection of cells is managed by the Triangulation class and derived classes such as[2.x.1] and[2.x.2] It holds the relevant data in memory and offers interfaces to query it Most things you want to do on cells are performed in loops over all cells For this the Triangulation class offers the concept of iterators(see[2.x.3])[2.x.7] Reading from a file</div><div class="ttdef"><b>Definition:</b> <a href="grid__0_8txt_source.html#l00007">grid_0.txt:7</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a2aeb43089505bb7b32477271cc76312e"><div class="ttname"><a href="classScaLAPACKMatrix.html#a2aeb43089505bb7b32477271cc76312e">ScaLAPACKMatrix::n_local_rows</a></div><div class="ttdeci">int n_local_rows</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00937">scalapack.h:937</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ad2f716b789abe53715d6659f38aa7815"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a></div><div class="ttdeci">T max(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="aany__data__0_8txt_html_a19ab1003fb0826e8e4d596df81fd7f84"><div class="ttname"><a href="any__data__0_8txt.html#a19ab1003fb0826e8e4d596df81fd7f84">type</a></div><div class="ttdeci">*Store any amount of any type of data accessible by an identifier string try to convert it to&lt; tt &gt; type&lt;/tt &gt; and return it This function throws an exception if either the name does not exist or if the conversion fails If such an exception is not desired use try to convert it to&lt; tt &gt; type&lt;/tt &gt; and return it This function throws an exception if either the name does not exist or if the conversion fails If such an exception is not desired use this function equals it forces read only access to the data In it throws an exception if the object is not found or cannot be converted to type If such an exception is not desired use the logic of access becomes fairly complicated the standard read function may depending on whether it was const a pointer or a regular pointer This function fixes the logic and ascertains that the object does not become by accident **Perform the same action as but do not throw an exception if the pointer does not exist Return a null pointer instead ***This function tries to find the name in the list and return a pointer to the associated object If either the name is not found or the object cannot be converted to the return type</div><div class="ttdef"><b>Definition:</b> <a href="any__data__0_8txt_source.html#l00022">any_data_0.txt:22</a></div></div>
<div class="ttc" id="aclassScaLAPACKMatrix_html_a4b34cedd3940060edbe3ce4aeec09903"><div class="ttname"><a href="classScaLAPACKMatrix.html#a4b34cedd3940060edbe3ce4aeec09903">ScaLAPACKMatrix::n_local_columns</a></div><div class="ttdeci">int n_local_columns</div><div class="ttdef"><b>Definition:</b> <a href="lac_2scalapack_8h_source.html#l00943">scalapack.h:943</a></div></div>
<div class="ttc" id="atensor__product__kernels__0_8txt_html_ac9be14b95309fbebbb45e29cc384188c"><div class="ttname"><a href="tensor__product__kernels__0_8txt.html#ac9be14b95309fbebbb45e29cc384188c">n_rows</a></div><div class="ttdeci">must implement taking the data from corresponding to a multiplication of along the given[2.x.49] of the tensor data in the input array This function allows the[2.x.50] and[2.x.51] arrays to alias for the case n_rows</div><div class="ttdef"><b>Definition:</b> <a href="tensor__product__kernels__0_8txt_source.html#l00052">tensor_product_kernels_0.txt:52</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638afb9cf45d5916e2dce29dbefbeb3c6a1a">LAPACKSupport::matrix</a></div><div class="ttdeci">@ matrix</div><div class="ttdoc">Contents is actually a matrix.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00063">lapack_support.h:63</a></div></div>
<div class="ttc" id="afunction__0_8txt_html_a4f780342f2d5d632f82cf7fd90158a66"><div class="ttname"><a href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a></div><div class="ttdeci">it defaults to i e the first component **Return all components of a vector valued function at a given point&lt; tt &gt; values&lt;/tt &gt; shall have the right size i e **Set&lt; tt &gt; values&lt;/tt &gt; to the point values of the specified component of the function at the&lt; tt &gt; points&lt;/tt &gt; It is assumed that&lt; tt &gt; values&lt;/tt &gt; already has the right size</div><div class="ttdef"><b>Definition:</b> <a href="function__0_8txt_source.html#l00052">function_0.txt:52</a></div></div>
<div class="ttc" id="apetsc__matrix__base__0_8txt_html_a5a1b8b75c93e6ea5e27829c4fe862a8e"><div class="ttname"><a href="petsc__matrix__base__0_8txt.html#a5a1b8b75c93e6ea5e27829c4fe862a8e">n</a></div><div class="ttdeci">local_size()&lt;/tt &gt;. *[0.x.57] *Return whether[2.x.13] is in the local range or not, see also local_range(). *[0.x.58] *Return a reference to the MPI communicator object in use with this matrix. This function has to be implemented in derived classes. *[0.x.59] *Return the number of nonzero elements of this matrix. Actually, it returns the number of entries in the sparsity pattern n</div><div class="ttdef"><b>Definition:</b> <a href="petsc__matrix__base__0_8txt_source.html#l00127">petsc_matrix_base_0.txt:127</a></div></div>
<div class="ttc" id="agraph__coloring__0_8txt_html_a068d28578c03dd6b6bb6b32bf268eafd"><div class="ttname"><a href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a></div><div class="ttdeci">namespace containing functions that can color graphs ***Given two sets of indices that are assumed to be determine whether they will have a nonempty intersection The actual intersection is not computed[2.x.0] indices1 A set of indices</div><div class="ttdef"><b>Definition:</b> <a href="graph__coloring__0_8txt_source.html#l00006">graph_coloring_0.txt:6</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_1_1internal_1_1Tags_html_a1c190e50dabbd9b60e230b843c6caa44a5cefd5f49fb86ffc193f75f2a7302fb6"><div class="ttname"><a href="namespaceUtilities_1_1MPI_1_1internal_1_1Tags.html#a1c190e50dabbd9b60e230b843c6caa44a5cefd5f49fb86ffc193f75f2a7302fb6">Utilities::MPI::internal::Tags::scalapack_copy_from</a></div><div class="ttdeci">@ scalapack_copy_from</div><div class="ttdoc">ScaLAPACKMatrix&lt;NumberType&gt;::copy_from.</div><div class="ttdef"><b>Definition:</b> <a href="base_2mpi__tags_8h_source.html#l00180">mpi_tags.h:180</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
