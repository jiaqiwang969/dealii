<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step_60.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-60 tutorial program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The step-60 tutorial program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial depends on <a class="el" href="step_6.html">step-6</a>.</p>
<p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#NonmatchinggridconstraintsthroughdistributedLagrangemultipliers">Non-matching grid constraints through distributed Lagrange multipliers</a>
        <li><a href="#Thetestcase">The testcase</a>
        <li><a href="#References">References</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Includefiles">Include files</a>
        <li><a href="#DistributedLagrangeProblem">DistributedLagrangeProblem</a>
        <li><a href="#DistributedLagrangeProblemParameters">DistributedLagrangeProblem::Parameters</a>
        <li><a href="#Setup">Set up</a>
        <li><a href="#Assembly">Assembly</a>
        <li><a href="#Solve">Solve</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Testcase1"> Test case 1: </a>
        <li><a href="#Testcase2and3"> Test case 2 and 3: </a>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
      <ul>
        <li><a href="#Runningwithspacedimequaltothree"> Running with `spacedim` equal to three</a>
        <li><a href="#Moregeneraldomains"> More general domains </a>
        <li><a href="#Preconditioner"> Preconditioner</a>
        <li><a href="#ParallelCode"> Parallel Code </a>
    </ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <br  />
</p>
<p><em>This program was contributed by Luca Heltai and Giovanni Alzetta, SISSA, Trieste. </em></p>
<dl class="section note"><dt>Note</dt><dd>If you use this program as a basis for your own work, please consider citing it in your list of references. The initial version of this work was contributed to the deal.II project by the authors listed in the following citation: <a href="https://doi.org/10.5281/zenodo.1243280"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1243280.svg" alt="10.5281/zenodo.1243280"/></a> </dd></dl>
<p><a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p><a class="anchor" id="NonmatchinggridconstraintsthroughdistributedLagrangemultipliers"></a></p><h3>Non-matching grid constraints through distributed Lagrange multipliers</h3>
<p>In this tutorial we consider the case of two domains, \(\Omega\) in \(R^{\text{spacedim}}\) and \(\Gamma\) in \(R^{\text{dim}}\), where \(\Gamma\) is embedded in \(\Omega\) ( \(\Gamma \subseteq \Omega\)). We want to solve a partial differential equation on \(\Omega\), enforcing some conditions on the solution of the problem <em>on the embedded domain</em> \(\Gamma\).</p>
<p>There are two interesting scenarios:</p>
<ul>
<li>the geometrical dimension <code>dim</code> of the embedded domain \(\Gamma\) is the same of the domain \(\Omega\) (<code>spacedim</code>), that is, the spacedim-dimensional measure of \(\Gamma\) is not zero, or</li>
<li>the embedded domain \(\Gamma\) has an intrinsic dimension <code>dim</code> which is smaller than that of \(\Omega\) (<code>spacedim</code>), thus its spacedim-dimensional measure is zero; for example it is a curve embedded in a two dimensional domain, or a surface embedded in a three-dimensional domain.</li>
</ul>
<p>In both cases define the restriction operator \(\gamma\) as the operator that, given a continuous function on \(\Omega\), returns its (continuous) restriction on \(\Gamma\), i.e.,</p>
<p class="formulaDsp">
\[ \gamma : C^0(\Omega) \mapsto C^0(\Gamma), \quad \text{ s.t. } \gamma u = u|_{\Gamma} \in C^0(\Gamma), \quad \forall u \in C^0(\Omega). \]
</p>
<p>It is well known that the operator \(\gamma\) can be extended to a continuous operator on \(H^1(\Omega)\), mapping functions in \(H^1(\Omega)\) to functions in \(H^1(\Gamma)\) when the intrinsic dimension of \(\Gamma\) is the same of \(\Omega\).</p>
<p>The same is true, with a less regular range space (namely \(H^{1/2}(\Gamma)\)), when the dimension of \(\Gamma\) is one less with respect to \(\Omega\), and \(\Gamma\) does not have a boundary. In this second case, the operator \(\gamma\) is also known as the <em>trace</em> operator, and it is well defined for Lipschitz co-dimension one curves and surfaces \(\Gamma\) embedded in \(\Omega\) (read <a href="https://en.wikipedia.org/wiki/Trace_operator">this wikipedia article</a> for further details on the trace operator).</p>
<p>The co-dimension two case is a little more complicated, and in general it is not possible to construct a continuous trace operator, not even from \(H^1(\Omega)\) to \(L^2(\Gamma)\), when the dimension of \(\Gamma\) is zero or one respectively in two and three dimensions.</p>
<p>In this tutorial program we're not interested in further details on \(\gamma\): we take the extension \(\gamma\) for granted, assuming that the dimension of the embedded domain (<code>dim</code>) is always smaller by one or equal with respect to the dimension of the embedding domain \(\Omega\) (<code>spacedim</code>).</p>
<p>We are going to solve the following differential problem: given a sufficiently regular function \(g\) on \(\Gamma\), find the solution \(u\) to</p>
<p class="formulaDsp">
\begin{eqnarray*} - \Delta u + \gamma^T \lambda &amp;=&amp; 0 \text{ in } \Omega\\ \gamma u &amp;=&amp; g \text{ in } \Gamma \\ u &amp; = &amp; 0 \text{ on } \partial\Omega. \end{eqnarray*}
</p>
<p>This is a constrained problem, where we are looking for a harmonic function \(u\) that satisfies homogeneous boundary conditions on \(\partial\Omega\), subject to the constraint \(\gamma u = g\) using a Lagrange multiplier.</p>
<p>This problem has a physical interpretation: harmonic functions, i.e., functions that satisfy the Laplace equation, can be thought of as the displacements of a membrane whose boundary values are prescribed. The current situation then corresponds to finding the shape of a membrane for which not only the displacement at the boundary, but also on \(\Gamma\) is prescribed. For example, if \(\Gamma\) is a closed curve in 2d space, then that would model a soap film that is held in place by a wire loop along \(\partial \Omega\) as well as a second loop along \(\Gamma\). In cases where \(\Gamma\) is a whole area, you can think of this as a membrane that is stretched over an obstacle where \(\Gamma\) is the contact area. (If the contact area is not known we have a different problem &ndash; called the "obstacle problem" &ndash; which is modeled in <a class="el" href="step_41.html">step-41</a>.)</p>
<p>As a first example we study the zero Dirichlet boundary condition on \(\partial\Omega\). The same equations apply if we apply zero Neumann boundary conditions on \(\partial\Omega\) or a mix of the two.</p>
<p>The variational formulation can be derived by introducing two infinite dimensional spaces \(V(\Omega)\) and \(Q^*(\Gamma)\), respectively for the solution \(u\) and for the Lagrange multiplier \(\lambda\).</p>
<p>Multiplying the first equation by \(v \in V(\Omega)\) and the second by \(q \in Q(\Gamma)\), integrating by parts when possible, and exploiting the boundary conditions on \(\partial\Omega\), we obtain the following variational problem:</p>
<p>Given a sufficiently regular function \(g\) on \(\Gamma\), find the solution \(u\) to </p><p class="formulaDsp">
\begin{eqnarray*} (\nabla u, \nabla v)_{\Omega} + (\lambda, \gamma v)_{\Gamma} &amp;=&amp; 0 \qquad \forall v \in V(\Omega) \\ (\gamma u, q)_{\Gamma} &amp;=&amp; (g,q)_{\Gamma} \qquad \forall q \in Q(\Gamma), \end{eqnarray*}
</p>
<p>where \((\cdot, \cdot)_{\Omega}\) and \((\cdot, \cdot)_{\Gamma}\) represent, respectively, \(L^2\) scalar products in \(\Omega\) and in \(\Gamma\).</p>
<p>Inspection of the variational formulation tells us that the space \(V(\Omega)\) can be taken to be \(H^1_0(\Omega)\). The space \(Q(\Gamma)\), in the co-dimension zero case, should be taken as \(H^1(\Gamma)\), while in the co-dimension one case should be taken as \(H^{1/2}(\Gamma)\).</p>
<p>The function \(g\) should therefore be either in \(H^1(\Gamma)\) (for the co-dimension zero case) or \(H^{1/2}(\Gamma)\) (for the co-dimension one case). This leaves us with a Lagrange multiplier \(\lambda\) in \(Q^*(\Gamma)\), which is either \(H^{-1}(\Gamma)\) or \(H^{-1/2}(\Gamma)\).</p>
<p>There are two options for the discretization of the problem above. One could choose matching discretizations, where the <a class="el" href="classTriangulation.html">Triangulation</a> for \(\Gamma\) is aligned with the <a class="el" href="classTriangulation.html">Triangulation</a> for \(\Omega\), or one could choose to discretize the two domains in a completely independent way.</p>
<p>The first option is clearly more indicated for the simple problem we proposed above: it is sufficient to use a single <a class="el" href="classTriangulation.html">Triangulation</a> for \(\Omega\) and then impose certain constraints depending \(\Gamma\). An example of this approach is studied in <a class="el" href="step_40.html">step-40</a>, where the solution has to stay above an obstacle and this is achieved imposing constraints on \(\Omega\).</p>
<p>To solve more complex problems, for example one where the domain \(\Gamma\) is time dependent, the second option could be a more viable solution. Handling non aligned meshes is complex by itself: to illustrate how is done we study a simple problem.</p>
<p>The technique we describe here is presented in the literature using one of many names: the <b>immersed finite element method</b>, the <b>fictitious boundary method</b>, the <b>distributed Lagrange multiplier method</b>, and others. The main principle is that the discretization of the two grids and of the two finite element spaces are kept completely independent. This technique is particularly efficient for the simulation of fluid-structure interaction problems, where the configuration of the embedded structure is part of the problem itself, and one solves a (possibly non-linear) elastic problem to determine the (time dependent) configuration of \(\Gamma\), and a (possibly non-linear) flow problem in \(\Omega \setminus \Gamma\), plus coupling conditions on the interface between the fluid and the solid.</p>
<p>In this tutorial program we keep things a little simpler, and we assume that the configuration of the embedded domain is given in one of two possible ways:</p>
<ul>
<li>as a deformation mapping \(\psi: \Gamma_0 \mapsto \Gamma \subseteq \Omega\), defined on a continuous finite dimensional space on \(\Gamma_0\) and representing, for any point \(x \in \Gamma_0\), its coordinate \(\psi(x)\) in \(\Omega\);</li>
<li>as a displacement mapping \(\delta \psi(x) = \psi(x)-x\) for \(x\in \Gamma_0\), representing for any point \(x\) the displacement vector applied in order to deform \(x\) to its actual configuration \(\psi(x) = x +\delta\psi(x)\).</li>
</ul>
<p>We define the embedded reference domain \(\Gamma_0\) <code>embedded_grid</code>: on this triangulation we construct a finite dimensional space (<code>embedded_configuration_dh</code>) to describe either the deformation or the displacement through a <a class="el" href="classFiniteElement.html">FiniteElement</a> system of <a class="el" href="classFE__Q.html">FE_Q</a> objects (<code>embedded_configuration_fe</code>). This finite dimensional space is used only to interpolate a user supplied function (<code>embedded_configuration_function</code>) representing either \(\psi\) (if the parameter <code>use_displacement</code> is set to <code>false</code>) or \(\delta\psi\) (if the parameter <code>use_displacement</code> is set to <code>true</code>).</p>
<p>The Lagrange multiplier \(\lambda\) and the user supplied function \(g\) are defined through another finite dimensional space <code>embedded_dh</code>, and through another <a class="el" href="classFiniteElement.html">FiniteElement</a> <code>embedded_fe</code>, using the same reference domain. In order to take into account the deformation of the domain, either a <a class="el" href="classMappingFEField.html">MappingFEField</a> or a <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> object are initialized with the <code>embedded_configuration</code> vector.</p>
<p>In the embedding space, a standard finite dimensional space <code>space_dh</code> is constructed on the embedding grid <code>space_grid</code>, using the <a class="el" href="classFiniteElement.html">FiniteElement</a> <code>space_fe</code>, following almost verbatim the approach taken in <a class="el" href="step_6.html">step-6</a>.</p>
<p>We represent the discretizations of the spaces \(V\) and \(Q\) with </p><p class="formulaDsp">
\[ V_h(\Omega) = \text{span} \{v_i\}_{i=1}^n \]
</p>
<p> and </p><p class="formulaDsp">
\[ Q_h(\Gamma) = \text{span} \{q_i\}_{i=1}^m \]
</p>
<p> respectively, where \(n\) is the dimension of <code>space_dh</code>, and \(m\) the dimension of <code>embedded_dh</code>.</p>
<p>Once all the finite dimensional spaces are defined, the variational formulation of the problem above leaves us with the following finite dimensional system of equations:</p>
<p class="formulaDsp">
\[ \begin{pmatrix} K &amp; C^T \\ C &amp; 0 \end{pmatrix} \begin{pmatrix} u \\ \lambda \end{pmatrix} = \begin{pmatrix} 0 \\ G \end{pmatrix} \]
</p>
<p>where</p>
<p class="formulaDsp">
\begin{eqnarray*} K_{ij} &amp;\dealcoloneq&amp; (\nabla v_j, \nabla v_i)_\Omega \qquad i,j=1,\dots,n \\ C_{\alpha j} &amp;\dealcoloneq&amp; (v_j, q_\alpha)_\Gamma \qquad j=1,\dots,n, \alpha = 1,\dots, m \\\\ G_{\alpha} &amp;\dealcoloneq&amp; (g, q_\alpha)_\Gamma \qquad \alpha = 1,\dots, m. \end{eqnarray*}
</p>
<p>While the matrix \(K\) is the standard stiffness matrix for the Poisson problem on \(\Omega\), and the vector \(G\) is a standard right-hand-side vector for a finite element problem with forcing term \(g\) on \(\Gamma\), (see, for example, <a class="el" href="step_3.html">step-3</a>), the matrix \(C\) or its transpose \(C^T\) are non-standard since they couple information on two non-matching grids.</p>
<p>In particular, the integral that appears in the computation of a single entry of \(C\), is computed on \(\Gamma\). As usual in finite elements we split this integral into contributions from all cells of the triangulation used to discretize \(\Gamma\), we transform the integral on \(K\) to an integral on the reference element \(\hat K\), where \(F_{K}\) is the mapping from \(\hat K\) to \(K\), and compute the integral on \(\hat K\) using a quadrature formula:</p>
<p class="formulaDsp">
\[ C_{\alpha j} \dealcoloneq (v_j, q_\alpha)_\Gamma = \sum_{K\in \Gamma} \int_{\hat K} \hat q_\alpha(\hat x) (v_j \circ F_{K}) (\hat x) J_K (\hat x) \mathrm{d} \hat x = \sum_{K\in \Gamma} \sum_{i=1}^{n_q} \big(\hat q_\alpha(\hat x_i) (v_j \circ F_{K}) (\hat x_i) J_K (\hat x_i) w_i \big) \]
</p>
<p>Computing this sum is non-trivial because we have to evaluate \((v_j \circ F_{K}) (\hat x_i)\). In general, if \(\Gamma\) and \(\Omega\) are not aligned, the point \(F_{K}(\hat x_i)\) is completely arbitrary with respect to \(\Omega\), and unless we figure out a way to interpolate all basis functions of \(V_h(\Omega)\) on an arbitrary point on \(\Omega\), we cannot compute the integral needed for an entry of the matrix \(C\).</p>
<p>To evaluate \((v_j \circ F_{K}) (\hat x_i)\) the following steps needs to be taken (as shown in the picture below):</p>
<ul>
<li>For a given cell \(K\) in \(\Gamma\) compute the real point \(y_i \dealcoloneq F_{K} (\hat x_i)\), where \(x_i\) is one of the quadrature points used for the integral on \(K \subseteq \Gamma\).</li>
<li>Find the cell of \(\Omega\) in which \(y_i\) lies. We shall call this element \(T\).</li>
<li>To evaluate the basis function use the inverse of the mapping \(G_T\) that transforms the reference element \(\hat T\) into the element \(T\): \(v_j(y_i) = \hat v_j \circ G^{-1}_{T} (y_i)\).</li>
</ul>
<p align="center"></p>
<p><img src="https://www.dealii.org/images/steps/developer/step-60.C_interpolation.png" alt="" class="inline"/> </p>
<p>The three steps above can be computed by calling, in turn,</p>
<ul>
<li><a class="el" href="namespaceGridTools.html#a2e10aeb1c8e76110a84b6945eac3aaf0">GridTools::find_active_cell_around_point()</a>, followed by</li>
<li><a class="el" href="classMapping.html#a38ba6aaa1745359910e1b465a0f5fb27">Mapping::transform_real_to_unit_cell()</a>. We then</li>
<li>construct a custom <a class="el" href="classQuadrature.html">Quadrature</a> formula, containing the point in the reference cell and then</li>
<li>construct an <a class="el" href="classFEValues.html">FEValues</a> object, with the given quadrature formula, and initialized with the cell obtained in the first step.</li>
</ul>
<p>This is what the deal.II function <a class="el" href="namespaceVectorTools.html#acd358e9b110ccbf4a7f76796d206b9c7">VectorTools::point_value()</a> does when evaluating a finite element field (not just a single shape function) at an arbitrary point; but this would be inefficient in this case.</p>
<p>A better solution is to use a convenient wrapper to perform the first three steps on a collection of points: <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations()</a>. If one is actually interested in computing the full coupling matrix, then it is possible to call the method <a class="el" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix()</a>, that performs the above steps in an efficient way, reusing all possible data structures, and gathering expensive steps together. This is the function we'll be using later in this tutorial.</p>
<p>We solve the final saddle point problem by an iterative solver, applied to the Schur complement \(S\) (whose construction is described, for example, in <a class="el" href="step_20.html">step-20</a>), and we construct \(S\) using <a class="el" href="classLinearOperator.html">LinearOperator</a> classes.</p>
<p><a class="anchor" id="Thetestcase"></a></p><h3>The testcase</h3>
<p>The problem we solve here is identical to <a class="el" href="step_4.html">step-4</a>, with the difference that we impose some constraints on an embedded domain \(\Gamma\). The tutorial is written in a dimension independent way, and in the results section we show how to vary both <code>dim</code> and <code>spacedim</code>.</p>
<p>The tutorial is compiled for <code>dim</code> equal to one and <code>spacedim</code> equal to two. If you want to run the program in embedding dimension <code>spacedim</code> equal to three, you will most likely want to change the reference domain for \(\Gamma\) to be, for example, something you read from file, or a closed sphere that you later deform to something more interesting.</p>
<p>In the default scenario, \(\Gamma\) has co-dimension one, and this tutorial program implements the Fictitious Boundary Method. As it turns out, the same techniques are used in the Variational Immersed Finite Element Method, and the coupling operator \(C\) defined above is the same in almost all of these non-matching methods.</p>
<p>The embedded domain is assumed to be included in \(\Omega\), which we take as the unit square \([0,1]^2\). The definition of the fictitious domain \(\Gamma\) can be modified through the parameter file, and can be given as a mapping from the reference interval \([0,1]\) to a curve in \(\Omega\).</p>
<p>If the curve is closed, then the results will be similar to running the same problem on a grid whose boundary is \(\Gamma\). The program will happily run also with a non-closed \(\Gamma\), although in those cases the mathematical formulation of the problem is more difficult, since \(\Gamma\) will have a boundary by itself that has co-dimension two with respect to the domain \(\Omega\).</p>
<p><a class="anchor" id="References"></a></p><h3>References</h3>
<ul>
<li>
<p class="startli">Glowinski, R., T.-W. Pan, T.I. Hesla, and D.D. Joseph. 1999. “A Distributed Lagrange Multiplier/fictitious Domain Method for Particulate Flows.” International Journal of Multiphase Flow 25 (5). Pergamon: 755–94.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">Boffi, D., L. Gastaldi, L. Heltai, and C.S. Peskin. 2008. “On the Hyper-Elastic Formulation of the Immersed Boundary Method.” Computer Methods in Applied Mechanics and Engineering 197 (25–28).</p>
<p class="endli"></p>
</li>
<li>
Heltai, L., and F. Costanzo. 2012. “Variational Implementation of Immersed Finite Element Methods.” Computer Methods in Applied Mechanics and Engineering 229–232. </li>
</ul>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Includefiles"></a> </p><h3>Include files</h3>
<p>Most of these have been introduced elsewhere, we'll comment only on the new ones.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
</div><!-- fragment --><p>The parameter acceptor class is the first novelty of this tutorial program: in general parameter files are used to steer the execution of a program at run time. While even a simple approach saves compile time, as the same executable can be run with different parameter settings, it can become difficult to handle hundreds of parameters simultaneously while maintaining compatibility between different programs. This is where the class <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> proves useful.</p>
<p>This class is used to define a public interface for classes that want to use a single global <a class="el" href="classParameterHandler.html">ParameterHandler</a> to handle parameters. The class provides a static <a class="el" href="classParameterHandler.html">ParameterHandler</a> member, namely <a class="el" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>, and implements the "Command design pattern" (see, for example, E. Gamma, R. Helm, R. Johnson, J. Vlissides, Design <a class="el" href="namespacePatterns.html">Patterns</a>: Elements of Reusable Object-Oriented Software, Addison-Wesley Professional, 1994. <a href="https://goo.gl/FNYByc">https://goo.gl/FNYByc</a>).</p>
<p><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> provides a global subscription mechanism. Whenever an object of a class derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> is constructed, a pointer to that object-of-derived-type is registered, together with a section entry in the parameter file. Such registry is traversed upon invocation of the single function <a class="el" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a>("file.prm") which in turn makes sure that all classes stored in the global registry declare the parameters they will be using, and after having declared them, it reads the content of <code>file.prm</code> to parse the actual parameters.</p>
<p>If you call the method <a class="el" href="classParameterHandler.html#a04b75c02037d19fd7fd781785fcefc79">ParameterHandler::add_parameter</a> for each of the parameters you want to use in your code, there is nothing else you need to do. If you are using an already existing class that provides the two functions <code>declare_parameters</code> and <code>parse_parameters</code>, you can still use <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>, by encapsulating the existing class into a <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a> class.</p>
<p>In this example, we'll use both strategies, using <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a> for deal.II classes, and deriving our own parameter classes directly from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parameter__acceptor_8h.html">deal.II/base/parameter_acceptor.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools_8h.html">deal.II/grid/grid_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>The other new include file is the one that contains the <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> class. The structure of deal.II, as many modern numerical libraries, is organized following a Directed Acyclic Graph (DAG). A DAG is a directed graph with topological ordering: each node structurally represents an object, and is connected to non-root nodes by one (or more) oriented edges, from the parent to the child. The most significant example of this structure is the <a class="el" href="classTriangulation.html">Triangulation</a> and its <a class="el" href="group__Iterators.html#ga997d61ac77777cdc2be3ae934b1f7cdb">Triangulation::cell_iterator</a> structure. From a <a class="el" href="classTriangulation.html">Triangulation</a> (the main node), we can access each cell (children nodes of the triangulation). From the cells themselves we can access over all vertices of the cell. In this simple example, the DAG structure can be represented as three node types (the triangulation, the cell iterator, and the vertex) connected by oriented edges from the triangulation to the cell iterators, and from the cell iterator to the vertices. This has several advantages, but it intrinsically creates “asymmetries”, making certain operations fast and their inverse very slow: finding the vertices of a cell has low computational cost, and can be done by simply traversing the DAG, while finding all the cells that share a vertex requires a non-trivial computation unless a new DAG data structure is added that represents the inverse search.</p>
<p>Since inverse operations are usually not needed in a finite element code, these are implemented in <a class="el" href="namespaceGridTools.html">GridTools</a> without the use of extra data structures related to the <a class="el" href="classTriangulation.html">Triangulation</a> which would make them much faster. One such data structure, for example, is a map from the vertices of a <a class="el" href="classTriangulation.html">Triangulation</a> to all cells that share those vertices, which would reduce the computations needed to answer to the previous question.</p>
<p>Some methods, for example <a class="el" href="namespaceGridTools.html#a2e10aeb1c8e76110a84b6945eac3aaf0">GridTools::find_active_cell_around_point</a>, make heavy usage of these non-standard operations. If you need to call these methods more than once, it becomes convenient to store those data structures somewhere. <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> does exactly this, giving you access to previously computed objects, or computing them on the fly (and then storing them inside the class for later use), and making sure that whenever the <a class="el" href="classTriangulation.html">Triangulation</a> is updated, also the relevant data structures are recomputed.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools__cache_8h.html">deal.II/grid/grid_tools_cache.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2fe_2fe_8h.html">deal.II/fe/fe.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
</div><!-- fragment --><p>In this example, we will be using a reference domain to describe an embedded <a class="el" href="classTriangulation.html">Triangulation</a>, deformed through a finite element vector field.</p>
<p>The next two include files contain the definition of two classes that can be used in these cases. <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> allows one to describe a domain through a <em>displacement</em> field, based on a <a class="el" href="classFESystem.html">FESystem</a>[<a class="el" href="classFE__Q.html">FE_Q(p)</a>^spacedim] finite element space. The second is a little more generic, and allows you to use arbitrary vector <a class="el" href="classFiniteElement.html">FiniteElement</a> spaces, as long as they provide a <em>continuous</em> description of your domain. In this case, the description is done through the actual <em>deformation</em> field, rather than a <em>displacement</em> field.</p>
<p>Which one is used depends on how the user wants to specify the reference domain, and/or the actual configuration. We'll provide both options, and experiment a little in the results section of this tutorial program.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q__eulerian_8h.html">deal.II/fe/mapping_q_eulerian.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__fe__field_8h.html">deal.II/fe/mapping_fe_field.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>The parsed function class is another new entry. It allows one to create a <a class="el" href="classFunction.html">Function</a> object, starting from a string in a parameter file which is parsed into an object that you can use anywhere deal.II accepts a <a class="el" href="classFunction.html">Function</a> (for example, for interpolation, boundary conditions, etc.).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2matrix__tools_8h.html">deal.II/numerics/matrix_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>This is the last new entry for this tutorial program. The namespace <a class="el" href="namespaceNonMatching.html">NonMatching</a> contains a few methods that are useful when performing computations on non-matching grids, or on curves that are not aligned with the underlying mesh.</p>
<p>We'll discuss its use in detail later on in the <code>setup_coupling</code> method.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="non__matching_2coupling_8h.html">deal.II/non_matching/coupling.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__direct_8h.html">deal.II/lac/sparse_direct.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator_8h.html">deal.II/lac/linear_operator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator__tools_8h.html">deal.II/lac/linear_operator_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep60.html">Step60</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p><a class="anchor" id="DistributedLagrangeProblem"></a> </p><h3>DistributedLagrangeProblem</h3>
<p>In the DistributedLagrangeProblem, we need two parameters describing the dimensions of the domain \(\Gamma\) (<code>dim</code>) and of the domain \(\Omega\) (<code>spacedim</code>).</p>
<p>These will be used to initialize a Triangulation&lt;dim,spacedim&gt; (for \(\Gamma\)) and a Triangulation&lt;spacedim,spacedim&gt; (for \(\Omega\)).</p>
<p>A novelty with respect to other tutorial programs is the heavy use of std::unique_ptr. These behave like classical pointers, with the advantage of doing automatic house-keeping: the contained object is automatically destroyed as soon as the unique_ptr goes out of scope, even if it is inside a container or there's an exception. Moreover it does not allow for duplicate pointers, which prevents ownership problems. We do this, because we want to be able to i) construct the problem, ii) read the parameters, and iii) initialize all objects according to what is specified in a parameter file.</p>
<p>We construct the parameters of our problem in the internal class <code>Parameters</code>, derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>. The <code>DistributedLagrangeProblem</code> class takes a const reference to a <code>Parameters</code> object, so that it is not possible to modify the parameters from within the DistributedLagrangeProblem class itself.</p>
<p>We could have initialized the parameters first, and then pass the parameters to the DistributedLagrangeProblem assuming all entries are set to the desired values, but this has two disadvantages:</p>
<ul>
<li>We should not make assumptions on how the user initializes a class that is not under our direct control. If the user fails to initialize the class, we should notice and throw an exception;</li>
<li>Not all objects that need to read parameters from a parameter file may be available when we construct the Parameters; this is often the case for complex programs, with multiple physics, or where we reuse existing code in some external classes. We simulate this by keeping some "complex" objects, like ParsedFunction objects, inside the <code>DistributedLagrangeProblem</code> instead of inside the <code>Parameters</code>.</li>
</ul>
<p>Here we assume that upon construction, the classes that build up our problem are not usable yet. Parsing the parameter file is what ensures we have all ingredients to build up our classes, and we design them so that if parsing fails, or is not executed, the run is aborted.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim = dim&gt;</div>
<div class="line"><span class="keyword">class </span>DistributedLagrangeProblem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
</div><!-- fragment --><p>The <code>Parameters</code> class is derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>. This allows us to use the <a class="el" href="classParameterAcceptor.html#af2a534c7f1ea5bfa165fa8a469744a5d">ParameterAcceptor::add_parameter()</a> method in its constructor.</p>
<p>The members of this function are all non-const, but the <code>DistributedLagrangeProblem</code> class takes a const reference to a <code>Parameters</code> object: this ensures that parameters are not modified from within the <code>DistributedLagrangeProblem</code> class.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Parameters : <span class="keyword">public</span> <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  Parameters();</div>
</div><!-- fragment --><p>The parameters now described can all be set externally using a parameter file: if no parameter file is present when running the executable, the program will create a "parameters.prm" file with the default values defined here, and then abort to give the user a chance to modify the parameters.prm file.</p>
<p>Initial refinement for the embedding grid, corresponding to the domain \(\Omega\).</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_refinement = 4;</div>
</div><!-- fragment --><p>The interaction between the embedded grid \(\Omega\) and the embedding grid \(\Gamma\) is handled through the computation of \(C\), which involves all cells of \(\Omega\) overlapping with parts of \(\Gamma\): a higher refinement of such cells might improve quality of our computations. For this reason we define <code>delta_refinement</code>: if it is greater than zero, then we mark each cell of the space grid that contains a vertex of the embedded grid and its neighbors, execute the refinement, and repeat this process <code>delta_refinement</code> times.</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> delta_refinement = 3;</div>
</div><!-- fragment --><p>Starting refinement of the embedded grid, corresponding to the domain \(\Gamma\).</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_embedded_refinement = 8;</div>
</div><!-- fragment --><p>The list of boundary ids where we impose homogeneous Dirichlet boundary conditions. On the remaining boundary ids (if any), we impose homogeneous Neumann boundary conditions. As a default problem we have zero Dirichlet boundary conditions on \(\partial \Omega\)</p>
<div class="fragment"><div class="line">std::list&lt;types::boundary_id&gt; homogeneous_dirichlet_ids{0, 1, 2, 3};</div>
</div><!-- fragment --><p><a class="el" href="classFiniteElement.html">FiniteElement</a> degree of the embedding space: \(V_h(\Omega)\)</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedding_space_finite_element_degree = 1;</div>
</div><!-- fragment --><p><a class="el" href="classFiniteElement.html">FiniteElement</a> degree of the embedded space: \(Q_h(\Gamma)\)</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_space_finite_element_degree = 1;</div>
</div><!-- fragment --><p><a class="el" href="classFiniteElement.html">FiniteElement</a> degree of the space used to describe the deformation of the embedded domain</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_configuration_finite_element_degree = 1;</div>
</div><!-- fragment --><p>Order of the quadrature formula used to integrate the coupling</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coupling_quadrature_order = 3;</div>
</div><!-- fragment --><p>If set to true, then the embedded configuration function is interpreted as a displacement function</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> use_displacement = <span class="keyword">false</span>;</div>
</div><!-- fragment --><p>Level of verbosity to use in the output</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> verbosity_level = 10;</div>
</div><!-- fragment --><p>A flag to keep track if we were initialized or not</p>
<div class="fragment"><div class="line">  <span class="keywordtype">bool</span> <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">false</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">DistributedLagrangeProblem(<span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
</div><!-- fragment --><p>Entry point for the DistributedLagrangeProblem</p>
<div class="fragment"><div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
</div><!-- fragment --><p>Object containing the actual parameters</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
</div><!-- fragment --><p>The following functions are similar to all other tutorial programs, with the exception that we now need to set up things for two different families of objects, namely the ones related to the <em>embedding</em> grids, and the ones related to the <em>embedded</em> one.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> setup_grids_and_dofs();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup_embedding_dofs();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup_embedded_dofs();</div>
</div><!-- fragment --><p>The only unconventional function we have here is the <code>setup_coupling()</code> method, used to generate the sparsity patter for the coupling matrix \(C\).</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> setup_coupling();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> assemble_system();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> output_results();</div>
</div><!-- fragment --><p>first we gather all the objects related to the embedding space geometry</p>
<div class="fragment"><div class="line">std::unique_ptr&lt;Triangulation&lt;spacedim&gt;&gt; space_grid;</div>
<div class="line">std::unique_ptr&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;</div>
<div class="line">                                         space_grid_tools_cache;</div>
<div class="line">std::unique_ptr&lt;FiniteElement&lt;spacedim&gt;&gt; space_fe;</div>
<div class="line">std::unique_ptr&lt;DoFHandler&lt;spacedim&gt;&gt;    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>;</div>
</div><!-- fragment --><p>Then the ones related to the embedded grid, with the <a class="el" href="classDoFHandler.html">DoFHandler</a> associated to the Lagrange multiplier <code>lambda</code></p>
<div class="fragment"><div class="line">std::unique_ptr&lt;Triangulation&lt;dim, spacedim&gt;&gt; embedded_grid;</div>
<div class="line">std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_fe;</div>
<div class="line">std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_dh;</div>
</div><!-- fragment --><p>And finally, everything that is needed to <em>deform</em> the embedded triangulation</p>
<div class="fragment"><div class="line">std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_configuration_fe;</div>
<div class="line">std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_configuration_dh;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a>                                embedded_configuration;</div>
</div><!-- fragment --><p>The <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a> class is a "transparent" wrapper derived from both <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> and the type passed as its template parameter. At construction, the arguments are split into two parts: the first argument is an std::string, forwarded to the <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> class, and containing the name of the section that should be used for this class, while all the remaining arguments are forwarded to the constructor of the templated type, in this case, to the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> constructor.</p>
<p>This class allows you to use existing classes in conjunction with the <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> registration mechanism, provided that those classes have the members <code><a class="el" href="data__out__base__0_8txt.html#a918b7763318d7dd4fc059a2898fe1ef6">declare_parameters()</a></code> and <code>parse_parameters()</code>.</p>
<p>This is the case here, making it fairly easy to exploit the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> class: instead of requiring users to create new <a class="el" href="classFunction.html">Function</a> objects in their code for the RHS, boundary functions, etc., (like it is done in most of the other tutorials), here we allow the user to use deal.II interface to muParser (<a href="http://muparser.beltoforion.de">http://muparser.beltoforion.de</a>), where the specification of the function is not done at compile time, but at run time, using a string that is parsed into an actual <a class="el" href="classFunction.html">Function</a> object.</p>
<p>In this case, the <code>embedded_configuration_function</code> is a vector valued <a class="el" href="classFunction.html">Function</a> that can be interpreted as either a <em>deformation</em> or a displacement* according to the boolean value of <code>parameters.use_displacement</code>. The number of components is specified later on in the construction.</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">  embedded_configuration_function;</div>
<div class="line"> </div>
<div class="line">std::unique_ptr&lt;Mapping&lt;dim, spacedim&gt;&gt; embedded_mapping;</div>
</div><!-- fragment --><p>We do the same thing to specify the value of the function \(g\), which is what we want our solution to be in the embedded space. In this case the <a class="el" href="classFunction.html">Function</a> is a scalar one.</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">  embedded_value_function;</div>
</div><!-- fragment --><p>Similarly to what we have done with the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> class, we repeat the same for the <a class="el" href="classReductionControl.html">ReductionControl</a> class, allowing us to specify all possible stopping criteria for the Schur complement iterative solver we'll use later on.</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;ReductionControl&gt;</a> schur_solver_control;</div>
</div><!-- fragment --><p>Next we gather all <a class="el" href="classSparsityPattern.html">SparsityPattern</a>, <a class="el" href="classSparseMatrix.html">SparseMatrix</a>, and <a class="el" href="classVector.html">Vector</a> objects we'll need</p>
<div class="fragment"><div class="line"><a class="code" href="classSparsityPattern.html">SparsityPattern</a> stiffness_sparsity;</div>
<div class="line"><a class="code" href="classSparsityPattern.html">SparsityPattern</a> coupling_sparsity;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> stiffness_matrix;</div>
<div class="line"><a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> coupling_matrix;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_rhs;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_value;</div>
</div><!-- fragment --><p>The <a class="el" href="classTimerOutput.html">TimerOutput</a> class is used to provide some statistics on the performance of our program.</p>
<div class="fragment"><div class="line">  <a class="code" href="classTimerOutput.html">TimerOutput</a> monitor;</div>
<div class="line">};</div>
</div><!-- fragment --><p><a class="anchor" id="DistributedLagrangeProblemParameters"></a> </p><h3>DistributedLagrangeProblem::Parameters</h3>
<p>At construction time, we initialize also the <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> class, with the section name we want our problem to use when parsing the parameter file.</p>
<p>Parameter files can be organized into section/subsection/etc.: this has the advantage that defined objects share parameters when sharing the same section/subsection/etc. <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> allows to specify the section name using Unix conventions on paths. If the section name starts with a slash ("/"), then the section is interpreted as an <em>absolute path</em>, <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> enters a subsection for each directory in the path, using the last name it encountered as the landing subsection for the current class.</p>
<p>For example, if you construct your class using <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("/first/second/third/My Class")</code>, the parameters will be organized as follows:</p>
<div class="CodeFragmentInTutorialComment"> <div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file</span></div>
<div class="line">subsection <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div>
<div class="line">  subsection <a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div>
<div class="line">    subsection <a class="code" href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div>
<div class="line">      subsection My Class</div>
<div class="line">       ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a></div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --> </div><p>Internally, the <em>current path</em> stored in <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> is now considered to be "/first/second/third/", i.e. when you specify an absolute path, <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> <em>changes</em> the current section to the current path, i.e. to the path of the section name until the <em>last</em> "/".</p>
<p>You can now construct another class derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> using a relative path (e.g., <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("My Other Class")</code>) instead of the absolute one (e.g. <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("/first/second/third/My Other
 Class")</code>), obtaining: </p><div class="CodeFragmentInTutorialComment"> <div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file</span></div>
<div class="line">subsection <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div>
<div class="line">  subsection <a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div>
<div class="line">    subsection <a class="code" href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div>
<div class="line">      subsection My Class</div>
<div class="line">        ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a></div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">      subsection My Other Class</div>
<div class="line">        ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> MyOtherClass</div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --> </div><p>If the section name <em>ends</em> with a slash then subsequent classes will interpret this as a full path: for example, similar to the one above, if we have two classes, one initialized with <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("/first/second/third/My Class/")</code> and the other with <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("My Other Class")</code>, then the resulting parameter file will look like:</p>
<div class="CodeFragmentInTutorialComment"> <div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file</span></div>
<div class="line">subsection <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div>
<div class="line">  subsection <a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div>
<div class="line">    subsection <a class="code" href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div>
<div class="line">      subsection My Class</div>
<div class="line">        ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> MyClass</div>
<div class="line">        ... # notice My Class subsection <a class="code" href="multithreading__0_8txt.html#a65ecb3886ec86207a20d2f9e8e690022">does</a> <a class="code" href="work__stream__0_8txt.html#a1c121a619b3787a3c8ac4194ed595af8">not</a> <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a> <a class="code" href="coding__conventions__0_8txt.html#addd9e976d1ed783e7621bc9c390f0ac2">here</a></div>
<div class="line">        subsection My Other Class</div>
<div class="line">          ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> MyOtherClass</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a> # <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> subsection My Other Class</div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a> # <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> subsection My Class</div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --> </div><p>We are going to exploit this, by making our <code>Parameters</code> the <em>parent</em> of all subsequently constructed classes. Since most of the other classes are members of <code>DistributedLagrangeProblem</code> this allows, for example, to construct two <code>DistributedLagrangeProblem</code> for two different dimensions, without having conflicts in the parameters for the two problems.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters::Parameters()</div>
<div class="line">  : <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a>(<span class="stringliteral">&quot;/Distributed Lagrange&lt;&quot;</span> +</div>
<div class="line">                      <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;,&quot;</span> +</div>
<div class="line">                      <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>) + <span class="stringliteral">&quot;&gt;/&quot;</span>)</div>
<div class="line">{</div>
</div><!-- fragment --><p>The <a class="el" href="classParameterAcceptor.html#af2a534c7f1ea5bfa165fa8a469744a5d">ParameterAcceptor::add_parameter()</a> function does a few things:</p>
<ul>
<li>enters the subsection specified at construction time to <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a></li>
<li>calls the ParameterAcceptor::prm.add_parameter() function</li>
<li>calls any signal you may have attached to <a class="el" href="classParameterAcceptor.html#a83d6a663cb62dffcf80155dd5dbfc5c1">ParameterAcceptor::declare_parameters_call_back</a></li>
<li>leaves the subsection</li>
</ul>
<p>In turn, ParameterAcceptor::prm.add_parameter</p>
<ul>
<li>declares an entry in the parameter handler for the given variable;</li>
<li>takes the current value of the variable</li>
<li>transforms it to a string, used as the default value for the parameter file</li>
<li>attaches an <em>action</em> to <a class="el" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a> that monitors when a file is parsed, or when an entry is set, and when this happens, it updates the value of the variable passed to <code>add_parameter()</code> by setting it to whatever was specified in the input file (of course, after the input file has been parsed and the text representation converted to the type of the variable).</li>
</ul>
<div class="fragment"><div class="line">add_parameter(<span class="stringliteral">&quot;Initial embedding space refinement&quot;</span>, initial_refinement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Initial embedded space refinement&quot;</span>,</div>
<div class="line">              initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Local refinements steps near embedded domain&quot;</span>,</div>
<div class="line">              delta_refinement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Homogeneous Dirichlet boundary ids&quot;</span>,</div>
<div class="line">              homogeneous_dirichlet_ids);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Use displacement in embedded interface&quot;</span>, use_displacement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Embedding space finite element degree&quot;</span>,</div>
<div class="line">              embedding_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Embedded space finite element degree&quot;</span>,</div>
<div class="line">              embedded_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Embedded configuration finite element degree&quot;</span>,</div>
<div class="line">              embedded_configuration_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Coupling quadrature order&quot;</span>, coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Verbosity level&quot;</span>, verbosity_level);</div>
</div><!-- fragment --><p>Once the parameter file has been parsed, then the parameters are good to go. Set the internal variable <code>initialized</code> to true.</p>
<div class="fragment"><div class="line">  parse_parameters_call_back.connect([&amp;]() -&gt; <span class="keywordtype">void</span> { <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">true</span>; });</div>
<div class="line">}</div>
</div><!-- fragment --><p>The constructor is pretty standard, with the exception of the <code><a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a></code> objects, as explained earlier.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">DistributedLagrangeProblem&lt;dim, spacedim&gt;::DistributedLagrangeProblem(</div>
<div class="line">  <span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">  : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">  , embedded_configuration_function(<span class="stringliteral">&quot;Embedded configuration&quot;</span>, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>)</div>
<div class="line">  , embedded_value_function(<span class="stringliteral">&quot;Embedded value&quot;</span>)</div>
<div class="line">  , schur_solver_control(<span class="stringliteral">&quot;Schur solver control&quot;</span>)</div>
<div class="line">  , monitor(std::cout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::summary, <a class="code" href="classTimerOutput.html">TimerOutput</a>::cpu_and_wall_times)</div>
<div class="line">{</div>
</div><!-- fragment --><p>Here is a way to set default values for a <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> class that was constructed using <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a>.</p>
<p>In this case, we set the default deformation of the embedded grid to be a circle with radius \(R\) and center \((Cx, Cy)\), we set the default value for the embedded_value_function to be the constant one, and specify some sensible values for the <a class="el" href="classSolverControl.html">SolverControl</a> object.</p>
<p>It is fundamental for \(\Gamma\) to be embedded: from the definition of \(C_{\alpha j}\) is clear that, if \(\Gamma \not\subseteq \Omega\), certain rows of the matrix \(C\) will be zero. This would be a problem, as the Schur complement method requires \(C\) to have full column rank.</p>
<div class="fragment"><div class="line">  embedded_configuration_function.declare_parameters_call_back.connect(</div>
<div class="line">    []() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function constants&quot;</span>, <span class="stringliteral">&quot;R=.3, Cx=.4, Cy=.4&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>,</div>
<div class="line">                                 <span class="stringliteral">&quot;R*cos(2*pi*x)+Cx; R*sin(2*pi*x)+Cy&quot;</span>);</div>
<div class="line">    });</div>
<div class="line"> </div>
<div class="line">  embedded_value_function.declare_parameters_call_back.connect(</div>
<div class="line">    []() -&gt; <span class="keywordtype">void</span> { <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>); });</div>
<div class="line"> </div>
<div class="line">  schur_solver_control.declare_parameters_call_back.connect([]() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">    <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Max steps&quot;</span>, <span class="stringliteral">&quot;1000&quot;</span>);</div>
<div class="line">    <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Reduction&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">    <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Tolerance&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">  });</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Setup"></a> </p><h3>Set up</h3>
<p>The function <code>DistributedLagrangeProblem::setup_grids_and_dofs()</code> is used to set up the finite element spaces. Notice how <code>std::make_unique</code> is used to create objects wrapped inside <code>std::unique_ptr</code> objects.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_grids_and_dofs()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup grids and dofs&quot;</span>);</div>
</div><!-- fragment --><p>Initializing \(\Omega\): constructing the <a class="el" href="classTriangulation.html">Triangulation</a> and wrapping it into a <code>std::unique_ptr</code> object</p>
<div class="fragment"><div class="line">space_grid = std::make_unique&lt;Triangulation&lt;spacedim&gt;&gt;();</div>
</div><!-- fragment --><p>Next, we actually create the triangulation using <a class="el" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube()</a>. The last argument is set to true: this activates colorization (i.e., assigning different boundary indicators to different parts of the boundary), which we use to assign the Dirichlet and Neumann conditions.</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*space_grid, 0, 1, <span class="keyword">true</span>);</div>
</div><!-- fragment --><p>Once we constructed a <a class="el" href="classTriangulation.html">Triangulation</a>, we refine it globally according to the specifications in the parameter file, and construct a <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> with it.</p>
<div class="fragment"><div class="line">space_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_refinement);</div>
<div class="line">space_grid_tools_cache =</div>
<div class="line">  std::make_unique&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;(*space_grid);</div>
</div><!-- fragment --><p>The same is done with the embedded grid. Since the embedded grid is deformed, we first need to setup the deformation mapping. We do so in the following few lines:</p>
<div class="fragment"><div class="line">embedded_grid = std::make_unique&lt;Triangulation&lt;dim, spacedim&gt;&gt;();</div>
<div class="line"><a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*embedded_grid);</div>
<div class="line">embedded_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">embedded_configuration_fe = std::make_unique&lt;FESystem&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">  <a class="code" href="classFE__Q.html">FE_Q&lt;dim, spacedim&gt;</a>(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree),</div>
<div class="line">  <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>);</div>
<div class="line"> </div>
<div class="line">embedded_configuration_dh =</div>
<div class="line">  std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line"> </div>
<div class="line">embedded_configuration_dh-&gt;distribute_dofs(*embedded_configuration_fe);</div>
<div class="line">embedded_configuration.reinit(embedded_configuration_dh-&gt;n_dofs());</div>
</div><!-- fragment --><p>Once we have defined a finite dimensional space for the deformation, we interpolate the <code>embedded_configuration_function</code> defined in the parameter file :</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_configuration_dh,</div>
<div class="line">                         embedded_configuration_function,</div>
<div class="line">                         embedded_configuration);</div>
</div><!-- fragment --><p>Now we can interpret it according to what the user has specified in the parameter file: as a displacement, in which case we construct a mapping that <em>displaces</em> the position of each support point of our configuration finite element space by the specified amount on the corresponding configuration vector, or as an absolution position.</p>
<p>In the first case, the class <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> offers its services, while in the second one, we'll use the class <a class="el" href="classMappingFEField.html">MappingFEField</a>. They are in fact very similar. <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> will only work for systems of <a class="el" href="classFE__Q.html">FE_Q</a> finite element spaces, where the displacement vector is stored in the first <code>spacedim</code> components of the <a class="el" href="classFESystem.html">FESystem</a>, and the degree given as a parameter at construction time, must match the degree of the first <code>spacedim</code> components.</p>
<p>The class <a class="el" href="classMappingFEField.html">MappingFEField</a> is slightly more general, in that it allows you to select arbitrary <a class="el" href="classFiniteElement.html">FiniteElement</a> types when constructing your approximation. Naturally some choices may (or may not) make sense, according to the type of <a class="el" href="classFiniteElement.html">FiniteElement</a> you choose. <a class="el" href="classMappingFEField.html">MappingFEField</a> implements the pure iso-parametric concept, and can be used, for example, to implement iso-geometric analysis codes in deal.II, by combining it with the <a class="el" href="classFE__Bernstein.html">FE_Bernstein</a> finite element class. In this example, we'll use the two interchangeably, by taking into account the fact that one configuration will be a <code>displacement</code>, while the other will be an absolute <code>deformation</code> field.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.use_displacement == <span class="keyword">true</span>)</div>
<div class="line">  embedded_mapping =</div>
<div class="line">    std::make_unique&lt;MappingQEulerian&lt;dim, Vector&lt;double&gt;, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;&gt;(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree,</div>
<div class="line">      *embedded_configuration_dh,</div>
<div class="line">      embedded_configuration);</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  embedded_mapping =</div>
<div class="line">    std::make_unique&lt;MappingFEField&lt;dim, spacedim, Vector&lt;double&gt;&gt;&gt;(</div>
<div class="line">      *embedded_configuration_dh, embedded_configuration);</div>
<div class="line"> </div>
<div class="line">setup_embedded_dofs();</div>
</div><!-- fragment --><p>In this tutorial program we not only refine \(\Omega\) globally, but also allow a local refinement depending on the position of \(\Gamma\), according to the value of <code>parameters.delta_refinement</code>, that we use to decide how many rounds of local refinement we should do on \(\Omega\), corresponding to the position of \(\Gamma\).</p>
<p>With the mapping in place, it is now possible to query what is the location of all support points associated with the <code>embedded_dh</code>, by calling the method <a class="el" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>.</p>
<p>This method has two variants. One that does <em>not</em> take a <a class="el" href="classMapping.html" title="Abstract base class for mapping classes. This class declares the interface for the functionality to d...">Mapping</a>, and one that takes a <a class="el" href="classMapping.html" title="Abstract base class for mapping classes. This class declares the interface for the functionality to d...">Mapping</a>. If you use the second type, like we are doing in this case, the support points are computed through the specified mapping, which can manipulate them accordingly.</p>
<p>This is precisely what the <code>embedded_mapping</code> is there for.</p>
<div class="fragment"><div class="line">std::vector&lt;Point&lt;spacedim&gt;&gt; support_points(embedded_dh-&gt;n_dofs());</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement != 0)</div>
<div class="line">  <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>(*embedded_mapping,</div>
<div class="line">                                       *embedded_dh,</div>
<div class="line">                                       support_points);</div>
</div><!-- fragment --><p>Once we have the support points of the embedded finite element space, we would like to identify what cells of the embedding space contain what support point, to get a chance at refining the embedding grid where it is necessary, i.e., where the embedded grid is. This can be done manually, by looping over each support point, and then calling the method <a class="el" href="classMapping.html#a38ba6aaa1745359910e1b465a0f5fb27">Mapping::transform_real_to_unit_cell</a> for each cell of the embedding space, until we find one that returns points in the unit reference cell, or it can be done in a more intelligent way.</p>
<p>The <a class="el" href="namespaceGridTools.html#a2e10aeb1c8e76110a84b6945eac3aaf0">GridTools::find_active_cell_around_point</a> is a possible option that performs the above task in a cheaper way, by first identifying the closest vertex of the embedding <a class="el" href="classTriangulation.html">Triangulation</a> to the target point, and then by calling <a class="el" href="classMapping.html#a38ba6aaa1745359910e1b465a0f5fb27">Mapping::transform_real_to_unit_cell</a> only for those cells that share the found vertex.</p>
<p>In fact, there are algorithms in the <a class="el" href="namespaceGridTools.html">GridTools</a> namespace that exploit a <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> object, and possibly a KDTree object to speed up these operations as much as possible.</p>
<p>The simplest way to exploit the maximum speed is by calling a specialized method, <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a>, that will store a lot of useful information and data structures during the first point search, and then reuse all of this for subsequent points.</p>
<p><a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a> returns a tuple where the first element is a vector of cells containing the input points, in this case support_points. For refinement, this is the only information we need, and this is exactly what happens now.</p>
<p>When we need to assemble a coupling matrix, however, we'll also need the reference location of each point to evaluate the basis functions of the embedding space. The other elements of the tuple returned by <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a> allow you to reconstruct, for each point, what cell contains it, and what is the location in the reference cell of the given point. Since this information is better grouped into cells, then this is what the algorithm returns: a tuple, containing a vector of all cells that have at least one point in them, together with a list of all reference points and their corresponding index in the original vector.</p>
<p>In the following loop, we will be ignoring all returned objects except the first, identifying all cells contain at least one support point of the embedded space. This allows for a simple adaptive refinement strategy: refining these cells and their neighbors.</p>
<p>Notice that we need to do some sanity checks, in the sense that we want to have an embedding grid which is well refined around the embedded grid, but where two consecutive support points lie either in the same cell, or in neighbor embedding cells.</p>
<p>This is only possible if we ensure that the smallest cell size of the embedding grid is nonetheless bigger than the largest cell size of the embedded grid. Since users can modify both levels of refinements, as well as the amount of local refinement they want around the embedded grid, we make sure that the resulting meshes satisfy our requirements, and if this is not the case, we bail out with an exception.</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> point_locations =</div>
<div class="line">      <a class="code" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a>(*space_grid_tools_cache,</div>
<div class="line">                                         support_points);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a> = std::get&lt;0&gt;(point_locations);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;set_refine_flag();</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a> : <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;face_indices())</div>
<div class="line">          <span class="keywordflow">if</span> (!<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;at_boundary(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>))</div>
<div class="line">            <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;neighbor(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>)-&gt;set_refine_flag();</div>
<div class="line">      }</div>
<div class="line">    space_grid-&gt;execute_coarsening_and_refinement();</div>
<div class="line">  }</div>
</div><!-- fragment --><p>In order to construct a well posed coupling interpolation operator \(C\), there are some constraints on the relative dimension of the grids between the embedding and the embedded domains. The coupling operator \(C\) and the spaces \(V\) and \(Q\) have to satisfy an inf-sup condition in order for the problem to have a solution. It turns out that the non-matching \(L^2\) projection satisfies such inf-sup, provided that the spaces \(V\) and \(Q\) are compatible between each other (for example, provided that they are chosen to be the ones described in the introduction).</p>
<p>However, the <em>discrete</em> inf-sup condition must also hold. No complications arise here, but it turns out that the discrete inf-sup constant deteriorates when the non-matching grids have local diameters that are too far away from each other. In particular, it turns out that if you choose an embedding grid which is <em>finer</em> with respect to the embedded grid, the inf-sup constant deteriorates much more than if you let the embedded grid be finer.</p>
<p>In order to avoid issues, in this tutorial we will throw an exception if the parameters chosen by the user are such that the maximal diameter of the embedded grid is greater than the minimal diameter of the embedding grid.</p>
<p>This choice guarantees that almost every cell of the embedded grid spans no more than two cells of the embedding grid, with some rare exceptions, that are negligible in terms of the resulting inf-sup.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> embedded_space_maximal_diameter =</div>
<div class="line">  <a class="code" href="namespaceGridTools.html#ae8409fa9cb46a0070abc4da7de0f47f2">GridTools::maximal_cell_diameter</a>(*embedded_grid, *embedded_mapping);</div>
<div class="line"><span class="keywordtype">double</span> embedding_space_minimal_diameter =</div>
<div class="line">  <a class="code" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a>(*space_grid);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding minimal diameter: &quot;</span></div>
<div class="line">        &lt;&lt; embedding_space_minimal_diameter</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, embedded maximal diameter: &quot;</span></div>
<div class="line">        &lt;&lt; embedded_space_maximal_diameter &lt;&lt; <span class="stringliteral">&quot;, ratio: &quot;</span></div>
<div class="line">        &lt;&lt; embedded_space_maximal_diameter /</div>
<div class="line">             embedding_space_minimal_diameter</div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(embedded_space_maximal_diameter &lt;</div>
<div class="line">              embedding_space_minimal_diameter,</div>
<div class="line">            <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">              <span class="stringliteral">&quot;The embedding grid is too refined (or the embedded grid &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;is too coarse). Adjust the parameters so that the minimal &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;grid size of the embedding grid is larger &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;than the maximal grid size of the embedded grid.&quot;</span>));</div>
</div><!-- fragment --><p>\(\Omega\) has been refined and we can now set up its DoFs</p>
<div class="fragment"><div class="line">  setup_embedding_dofs();</div>
<div class="line">}</div>
</div><!-- fragment --><p>We now set up the DoFs of \(\Omega\) and \(\Gamma\): since they are fundamentally independent (except for the fact that \(\Omega\)'s mesh is more refined "around" \(\Gamma\)) the procedure is standard.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedding_dofs()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a> = std::make_unique&lt;DoFHandler&lt;spacedim&gt;&gt;(*space_grid);</div>
<div class="line">  space_fe = std::make_unique&lt;FE_Q&lt;spacedim&gt;&gt;(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">  <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(*space_fe);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">id</span> : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.homogeneous_dirichlet_ids)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a>(</div>
<div class="line">        *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <span class="keywordtype">id</span>, <a class="code" href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;spacedim&gt;</a>(), <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a>();</div>
</div><!-- fragment --><p>By definition the stiffness matrix involves only \(\Omega\)'s DoFs</p>
<div class="fragment"><div class="line">  <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>(), <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line">  <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, dsp, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">  stiffness_sparsity.copy_from(dsp);</div>
<div class="line">  stiffness_matrix.<a class="code" href="classSparseMatrix.html#afa7ae4d32bda6035661c9cccfe185597">reinit</a>(stiffness_sparsity);</div>
<div class="line">  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line">  <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding dofs: &quot;</span> &lt;&lt; <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>() &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedded_dofs()</div>
<div class="line">{</div>
<div class="line">  embedded_dh = std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line">  embedded_fe = std::make_unique&lt;FE_Q&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">  embedded_dh-&gt;distribute_dofs(*embedded_fe);</div>
</div><!-- fragment --><p>By definition the rhs of the system we're solving involves only a zero vector and \(G\), which is computed using only \(\Gamma\)'s DoFs</p>
<div class="fragment"><div class="line">  <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">  embedded_rhs.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">  embedded_value.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedded dofs: &quot;</span> &lt;&lt; embedded_dh-&gt;n_dofs() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Creating the coupling sparsity pattern is a complex operation, but it can be easily done using the <a class="el" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>, which requires the two <a class="el" href="classDoFHandler.html">DoFHandler</a> objects, the quadrature points for the coupling, a <a class="el" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> (which then needs to be copied into the sparsity one, as usual), the component mask for the embedding and embedded <a class="el" href="classTriangulation.html">Triangulation</a> (which we leave empty) and the mappings for both the embedding and the embedded <a class="el" href="classTriangulation.html">Triangulation</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_coupling()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup coupling&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>(), embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>(*space_grid_tools_cache,</div>
<div class="line">                                                *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                                *embedded_dh,</div>
<div class="line">                                                <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                                dsp,</div>
<div class="line">                                                <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                                <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                *embedded_mapping);</div>
<div class="line">  coupling_sparsity.copy_from(dsp);</div>
<div class="line">  coupling_matrix.reinit(coupling_sparsity);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Assembly"></a> </p><h3>Assembly</h3>
<p>The following function creates the matrices: as noted before computing the stiffness matrix and the rhs is a standard procedure.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::assemble_system()</div>
<div class="line">{</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble system&quot;</span>);</div>
</div><!-- fragment --><p>Embedding stiffness matrix \(K\), and the right hand side \(G\).</p>
<div class="fragment"><div class="line">  <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixTools::create_laplace_matrix</a>(</div>
<div class="line">    *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;spacedim&gt;</a>(2 * space_fe-&gt;degree + 1),</div>
<div class="line">    stiffness_matrix,</div>
<div class="line">    <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classFunction.html">Function&lt;spacedim&gt;</a> *<span class="keyword">&gt;</span>(<span class="keyword">nullptr</span>),</div>
<div class="line">    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceVectorTools.html#a6e325333a138893e181da47f29ac680a">VectorTools::create_right_hand_side</a>(*embedded_mapping,</div>
<div class="line">                                      *embedded_dh,</div>
<div class="line">                                      <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(2 * embedded_fe-&gt;degree +</div>
<div class="line">                                                  1),</div>
<div class="line">                                      embedded_value_function,</div>
<div class="line">                                      embedded_rhs);</div>
<div class="line">}</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble coupling system&quot;</span>);</div>
</div><!-- fragment --><p>To compute the coupling matrix we use the <a class="el" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a> tool, which works similarly to <a class="el" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>.</p>
<div class="fragment"><div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line">    <a class="code" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a>(*space_grid_tools_cache,</div>
<div class="line">                                             *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                             *embedded_dh,</div>
<div class="line">                                             <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                             coupling_matrix,</div>
<div class="line">                                             <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                             <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                             <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                             *embedded_mapping);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_mapping,</div>
<div class="line">                             *embedded_dh,</div>
<div class="line">                             embedded_value_function,</div>
<div class="line">                             embedded_value);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Solve"></a> </p><h3>Solve</h3>
<p>All parts have been assembled: we solve the system using the Schur complement method</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">DistributedLagrangeProblem&lt;dim, spacedim&gt;::solve</a>()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Solve system&quot;</span>);</div>
</div><!-- fragment --><p>Start by creating the inverse stiffness matrix</p>
<div class="fragment"><div class="line"><a class="code" href="classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a> K_inv_umfpack;</div>
<div class="line">K_inv_umfpack.<a class="code" href="classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">initialize</a>(stiffness_matrix);</div>
</div><!-- fragment --><p>Initializing the operators, as described in the introduction</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> K  = <a class="code" href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">linear_operator</a>(stiffness_matrix);</div>
<div class="line"><span class="keyword">auto</span> Ct = <a class="code" href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">linear_operator</a>(coupling_matrix);</div>
<div class="line"><span class="keyword">auto</span> <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>  = <a class="code" href="group__LAOperators.html#ga6bdc65fb2db56230e6bc7d545e81295d">transpose_operator</a>(Ct);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> K_inv = <a class="code" href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">linear_operator</a>(K, K_inv_umfpack);</div>
</div><!-- fragment --><p>Using the Schur complement method</p>
<div class="fragment"><div class="line">  <span class="keyword">auto</span>                     S = <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a> * K_inv * Ct;</div>
<div class="line">  <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver_cg(schur_solver_control);</div>
<div class="line">  <span class="keyword">auto</span> S_inv = <a class="code" href="group__LAOperators.html#ga87e38fbde431397c069a88692bd24ae7">inverse_operator</a>(S, solver_cg, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> = S_inv * embedded_rhs;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = K_inv * Ct * <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a7b3d3f295bb56d6cd6856bdc6cbe8a01">distribute</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following function simply generates standard result output on two separate files, one for each mesh.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::output_results()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Output results&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;spacedim&gt;</a> embedding_out;</div>
<div class="line"> </div>
<div class="line">  std::ofstream embedding_out_file(<span class="stringliteral">&quot;embedding.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  embedding_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>);</div>
<div class="line">  embedding_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line">  embedding_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">  embedding_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedding_out_file);</div>
</div><!-- fragment --><p>The only difference between the two output routines is that in the second case, we want to output the data on the current configuration, and not on the reference one. This is possible by passing the actual embedded_mapping to the <a class="el" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a> function. The mapping will take care of outputting the result on the actual deformed configuration.</p>
<div class="fragment"><div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;dim, spacedim&gt;</a> embedded_out;</div>
<div class="line"> </div>
<div class="line">  std::ofstream embedded_out_file(<span class="stringliteral">&quot;embedded.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  embedded_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*embedded_dh);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>, <span class="stringliteral">&quot;lambda&quot;</span>);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(embedded_value, <span class="stringliteral">&quot;g&quot;</span>);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(*embedded_mapping,</div>
<div class="line">                             <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedded_out_file);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Similar to all other tutorial programs, the <code><a class="el" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run()</a></code> function simply calls all other methods in the correct order. Nothing special to note, except that we check if parsing was done before we actually attempt to run our program.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">DistributedLagrangeProblem&lt;dim, spacedim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initialized, <a class="code" href="group__Exceptions.html#ga426dec8d8185f1410e09a795e0b36e86">ExcNotInitialized</a>());</div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.verbosity_level);</div>
<div class="line"> </div>
<div class="line">    setup_grids_and_dofs();</div>
<div class="line">    setup_coupling();</div>
<div class="line">    assemble_system();</div>
<div class="line">    <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line">    output_results();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step60</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep60.html">Step60</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> = 1, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a> = 2;</div>
</div><!-- fragment --><p>Differently to what happens in other tutorial programs, here we use <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> style of initialization, i.e., all objects are first constructed, and then a single call to the static method <a class="el" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a> is issued to fill all parameters of the classes that are derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>.</p>
<p>We check if the user has specified a parameter file name to use when the program was launched. If so, try to read that parameter file, otherwise, try to read the file "parameters.prm".</p>
<p>If the parameter file that was specified (implicitly or explicitly) does not exist, <a class="el" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a> will create one for you, and exit the program.</p>
<div class="fragment"><div class="line">      DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
<div class="line">      DistributedLagrangeProblem&lt;dim, spacedim&gt;             <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
<div class="line"> </div>
<div class="line">      std::string parameter_file;</div>
<div class="line">      <span class="keywordflow">if</span> (argc &gt; 1)</div>
<div class="line">        parameter_file = argv[1];</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        parameter_file = <span class="stringliteral">&quot;parameters.prm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a>(parameter_file, <span class="stringliteral">&quot;used_parameters.prm&quot;</span>);</div>
<div class="line">      <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>The directory in which this program is run does not contain a parameter file by default. On the other hand, this program wants to read its parameters from a file called parameters.prm &ndash; and so, when you execute it the first time, you will get an exception that no such file can be found:</p>
<div class="fragment"><div class="line">----------------------------------------------------</div>
<div class="line">Exception <a class="code" href="data__out__base__0_8txt.html#a1a0f08903e9f2a25a073261a20b86e26">on</a> processing:</div>
<div class="line"> </div>
<div class="line">--------------------------------------------------------</div>
<div class="line">An <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> occurred <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> line &lt;74&gt; <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a> &lt;../<a class="code" href="data__out__base__0_8txt.html#a0d0a9b5bbc80d6f0b9d863fa664d74ef">source</a>/base/parameter_acceptor.cc&gt; <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <span class="keyword">function</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="table__0_8txt.html#aa22355d271761047703d8c139352814f">void ::ParameterAcceptor::initialize</a>(<span class="keyword">const</span> std::string &amp;, <span class="keyword">const</span> std::string &amp;, <span class="keyword">const</span> <a class="code" href="classParameterHandler.html#a8364dda711b93753c6809eefe2a8e827">ParameterHandler::OutputStyle</a>, ::<a class="code" href="classParameterHandler.html">ParameterHandler</a> &amp;)</div>
<div class="line"><a class="code" href="A-headers_2fe__0_8txt.html#ac58f1344c78bfcb3556c763b59c923c6">The</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#a887b88f558acbcf4a6621eb0f0d39772">violated</a> <a class="code" href="vector__tools__constraints__0_8txt.html#acb0039192ebc332fa285c0450e90388b">condition</a> was:</div>
<div class="line">    <span class="keyword">false</span></div>
<div class="line">Additional <a class="code" href="fe__vs__mapping__vs__fevalues__0_8txt.html#a4e0105c19ddbc5d3acf9aa95e2c9a082">information</a>:</div>
<div class="line">    You <a class="code" href="tensor__function__0_8txt.html#a7df5c44c3259e9ce6ab8c7d1681e8e5e">specified</a> &lt;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.prm&gt; <a class="code" href="coding__conventions__0_8txt.html#a7b1ab7a5dcacc31df12a0592293133c0">as</a> <a class="code" href="parameter__handler__0_8txt.html#a141ebbaf93668d52831bbd4ec5a1e949">input</a> <a class="code" href="coding__conventions__0_8txt.html#a676390618e4d4cade021c4edeac58b65">parameter</a> <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>, <a class="code" href="fe__nedelec__0_8txt.html#a8b7c0468fae3de73000ffc4dfafc048a">but</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> <a class="code" href="multithreading__0_8txt.html#a65ecb3886ec86207a20d2f9e8e690022">does</a> <a class="code" href="work__stream__0_8txt.html#a1c121a619b3787a3c8ac4194ed595af8">not</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a5aa168344f21991b9dfdd2e4854a305c">exist</a>. We <a class="code" href="opencascade_2utilities__0_8txt.html#a23b9c1bdc9420a32a79f19f214a53812">created</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> <span class="keywordflow">for</span> you.</div>
<div class="line">--------------------------------------------------------</div>
<div class="line"> </div>
<div class="line">Aborting!</div>
<div class="line">----------------------------------------------------</div>
</div><!-- fragment --><p>However, as the error message already states, the code that triggers the exception will also generate a parameters.prm file that simply contains the default values for all parameters this program cares about. By inspection of the parameter file, we see the following:</p>
<div class="fragment"><div class="line"><span class="preprocessor"># Listing of Parameters</span></div>
<div class="line"><span class="preprocessor"># ---------------------</span></div>
<div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">Coupling</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>                    = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>        = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Homogeneous Dirichlet <a class="code" href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a> ids           = 0, 1, 2, 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 7</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Use <a class="code" href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">displacement</a> <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <span class="keyword">interface       </span>= <a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Verbosity <a class="code" href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a>                              = 10</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line"><span class="preprocessor">    # Sometimes it is convenient to use symbolic constants in the expression</span></div>
<div class="line"><span class="preprocessor">    # that describes the function, rather than having to use its numeric value</span></div>
<div class="line"><span class="preprocessor">    # everywhere the constant appears. These values can be defined using this</span></div>
<div class="line"><span class="preprocessor">    # parameter, in the form `var1=value1, var2=value2, ...&#39;.</span></div>
<div class="line"><span class="preprocessor">    #</span></div>
<div class="line"><span class="preprocessor">    # A typical example would be to set this runtime parameter to</span></div>
<div class="line"><span class="preprocessor">    # `pi=3.1415926536&#39; and then use `pi&#39; in the expression of the actual</span></div>
<div class="line"><span class="preprocessor">    # formula. (That said, for convenience this class actually defines both</span></div>
<div class="line"><span class="preprocessor">    # `pi&#39; and `Pi&#39; by default, but you get the idea.)</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.4, Cy=.4                 # <span class="keywordflow">default</span>:</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">    # The formula that denotes the function you want to evaluate for</span></div>
<div class="line"><span class="preprocessor">    # particular values of the independent variables. This expression may</span></div>
<div class="line"><span class="preprocessor">    # contain any of the usual operations such as addition or multiplication,</span></div>
<div class="line"><span class="preprocessor">    # as well as all of the common functions such as `sin&#39; or `cos&#39;. In</span></div>
<div class="line"><span class="preprocessor">    # addition, it may contain expressions like `if(x&gt;0, 1, -1)&#39; where the</span></div>
<div class="line"><span class="preprocessor">    # expression evaluates to the second argument if the first argument is</span></div>
<div class="line"><span class="preprocessor">    # true, and to the third argument otherwise. For a full overview of</span></div>
<div class="line"><span class="preprocessor">    # possible expressions accepted see the documentation of the muparser</span></div>
<div class="line"><span class="preprocessor">    # library at http://muparser.beltoforion.de/.</span></div>
<div class="line"><span class="preprocessor">    #</span></div>
<div class="line"><span class="preprocessor">    # If the function you are describing represents a vector-valued function</span></div>
<div class="line"><span class="preprocessor">    # with multiple components, then separate the expressions for individual</span></div>
<div class="line"><span class="preprocessor">    # components by a semicolon.</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = R*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; R*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy # <span class="keywordflow">default</span>: 0</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">    # The names of the variables as they will be used in the function,</span></div>
<div class="line"><span class="preprocessor">    # separated by commas. By default, the names of variables at which the</span></div>
<div class="line"><span class="preprocessor">    # function will be evaluated are `x&#39; (in 1d), `x,y&#39; (in 2d) or `x,y,z&#39; (in</span></div>
<div class="line"><span class="preprocessor">    # 3d) for spatial coordinates and `t&#39; for time. You can then use these</span></div>
<div class="line"><span class="preprocessor">    # variable names in your function expression and they will be replaced by</span></div>
<div class="line"><span class="preprocessor">    # the values of these variables at which the function is currently</span></div>
<div class="line"><span class="preprocessor">    # evaluated. However, you can also choose a different set of names for the</span></div>
<div class="line"><span class="preprocessor">    # independent variables at which to evaluate your function expression. For</span></div>
<div class="line"><span class="preprocessor">    # example, if you work in spherical coordinates, you may wish to set this</span></div>
<div class="line"><span class="preprocessor">    # input parameter to `r,phi,theta,t&#39; and then use these variable names in</span></div>
<div class="line"><span class="preprocessor">    # your function expression.</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"> </div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line"><span class="preprocessor">    # Sometimes it is convenient to use symbolic constants in the expression</span></div>
<div class="line"><span class="preprocessor">    # that describes the function, rather than having to use its numeric value</span></div>
<div class="line"><span class="preprocessor">    # everywhere the constant appears. These values can be defined using this</span></div>
<div class="line"><span class="preprocessor">    # parameter, in the form `var1=value1, var2=value2, ...&#39;.</span></div>
<div class="line"><span class="preprocessor">    #</span></div>
<div class="line"><span class="preprocessor">    # A typical example would be to set this runtime parameter to</span></div>
<div class="line"><span class="preprocessor">    # `pi=3.1415926536&#39; and then use `pi&#39; in the expression of the actual</span></div>
<div class="line"><span class="preprocessor">    # formula. (That said, for convenience this class actually defines both</span></div>
<div class="line"><span class="preprocessor">    # `pi&#39; and `Pi&#39; by default, but you get the idea.)</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">    # The formula that denotes the function you want to evaluate for</span></div>
<div class="line"><span class="preprocessor">    # particular values of the independent variables. This expression may</span></div>
<div class="line"><span class="preprocessor">    # contain any of the usual operations such as addition or multiplication,</span></div>
<div class="line"><span class="preprocessor">    # as well as all of the common functions such as `sin&#39; or `cos&#39;. In</span></div>
<div class="line"><span class="preprocessor">    # addition, it may contain expressions like `if(x&gt;0, 1, -1)&#39; where the</span></div>
<div class="line"><span class="preprocessor">    # expression evaluates to the second argument if the first argument is</span></div>
<div class="line"><span class="preprocessor">    # true, and to the third argument otherwise. For a full overview of</span></div>
<div class="line"><span class="preprocessor">    # possible expressions accepted see the documentation of the muparser</span></div>
<div class="line"><span class="preprocessor">    # library at http://muparser.beltoforion.de/.</span></div>
<div class="line"><span class="preprocessor">    #</span></div>
<div class="line"><span class="preprocessor">    # If the function you are describing represents a vector-valued function</span></div>
<div class="line"><span class="preprocessor">    # with multiple components, then separate the expressions for individual</span></div>
<div class="line"><span class="preprocessor">    # components by a semicolon.</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 1     # <span class="keywordflow">default</span>: 0</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">    # The names of the variables as they will be used in the function,</span></div>
<div class="line"><span class="preprocessor">    # separated by commas. By default, the names of variables at which the</span></div>
<div class="line"><span class="preprocessor">    # function will be evaluated are `x&#39; (in 1d), `x,y&#39; (in 2d) or `x,y,z&#39; (in</span></div>
<div class="line"><span class="preprocessor">    # 3d) for spatial coordinates and `t&#39; for time. You can then use these</span></div>
<div class="line"><span class="preprocessor">    # variable names in your function expression and they will be replaced by</span></div>
<div class="line"><span class="preprocessor">    # the values of these variables at which the function is currently</span></div>
<div class="line"><span class="preprocessor">    # evaluated. However, you can also choose a different set of names for the</span></div>
<div class="line"><span class="preprocessor">    # independent variables at which to evaluate your function expression. For</span></div>
<div class="line"><span class="preprocessor">    # example, if you work in spherical coordinates, you may wish to set this</span></div>
<div class="line"><span class="preprocessor">    # input parameter to `r,phi,theta,t&#39; and then use these variable names in</span></div>
<div class="line"><span class="preprocessor">    # your function expression.</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"> </div>
<div class="line">  subsection Schur <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a> control</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log frequency = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a>   = <span class="keyword">false</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>    = <span class="keyword">true</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Max <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a>     = 1000   # <span class="keywordflow">default</span>: 100</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Reduction     = 1.e-12 # <span class="keywordflow">default</span>: 1.e-2</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a>     = 1.e-12 # <span class="keywordflow">default</span>: 1.e-10</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"> </div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>If you now run the program, you will get a file called <code>used_parameters.prm</code>, containing a shorter version of the above parameters (without comments and documentation), documenting all parameters that were used to run your program: </p><div class="fragment"><div class="line"><span class="preprocessor"># Parameter file generated with</span></div>
<div class="line"><span class="preprocessor"># DEAL_II_PACKAGE_VERSION = 9.0.0</span></div>
<div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">Coupling</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>                    = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>        = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Homogeneous Dirichlet <a class="code" href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a> ids           = 0, 1, 2, 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 7</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Use <a class="code" href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">displacement</a> <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <span class="keyword">interface       </span>= <a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Verbosity <a class="code" href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a>                              = 10</div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.4, Cy=.4</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = R*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; R*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Schur <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a> control</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log frequency = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a>   = <span class="keyword">false</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>    = <span class="keyword">true</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Max <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a>     = 1000</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Reduction     = 1.e-12</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a>     = 1.e-12</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>The rationale behind creating first <code>parameters.prm</code> file (the first time the program is run) and then a <code>used_parameters.prm</code> (every other times you run the program), is because you may want to leave most parameters to their default values, and only modify a handful of them.</p>
<p>For example, you could use the following (perfectly valid) parameter file with this tutorial program: </p><div class="fragment"><div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 7</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 3</div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.4, Cy=.4</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = R*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; R*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>and you would obtain exactly the same results as in test case 1 below.</p>
<p><a class="anchor" id="Testcase1"></a></p><h3>Test case 1: </h3>
<p>For the default problem the value of \(u\) on \(\Gamma\) is set to the constant \(1\): this is like imposing a constant Dirichlet boundary condition on \(\Gamma\), seen as boundary of the portion of \(\Omega\) inside \(\Gamma\). Similarly on \(\partial \Omega\) we have zero Dirichlet boundary conditions.</p>
<div class="twocolumn" style="width: 80%"> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.1_no_grid.png" alt="" width="500" class="inline"/> </div> </div> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.1_grid.png" alt="" width="500" class="inline"/> </div> </div> </div><p>The output of the program will look like the following:</p>
<div class="fragment"><div class="line">DEAL::Embedded <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>: 129</div>
<div class="line">DEAL::Embedding minimal <a class="code" href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">diameter</a>: 0.0110485, <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> maximal <a class="code" href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">diameter</a>: 0.00781250, ratio: 0.707107</div>
<div class="line">DEAL::Embedding <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>: 2429</div>
<div class="line">DEAL:cg::Starting <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a> 0.166266</div>
<div class="line">DEAL:cg::Convergence <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> 108 <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a> 7.65958e-13</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">+---------------------------------------------+------------+------------+</div>
<div class="line">| Total CPU <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed <a class="code" href="grid_2manifold__0_8txt.html#a02d8bd1db3a4d0b6d68a99a931ce1b83">since</a> <a class="code" href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a>          |     0.586s |            |</div>
<div class="line">|                                             |            |            |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                         | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |  CPU <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  | % <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> total |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
<div class="line">| Assemble coupling <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>        |         1 |     0.132s |        23% |</div>
<div class="line">| Assemble <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                 |         1 |    0.0733s |        12% |</div>
<div class="line">| Output results                  |         1 |     0.087s |        15% |</div>
<div class="line">| Setup coupling                  |         1 |    0.0244s |       4.2% |</div>
<div class="line">| Setup <a class="code" href="reordering__0_8txt.html#a4a9ed06a3880b1ccf188c35213698758">grids</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#acce0a318676405d57af6ef0f5cbe4ec3">and</a> <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>            |         1 |    0.0907s |        15% |</div>
<div class="line">| Solve <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                    |         1 |     0.178s |        30% |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">+---------------------------------------------+------------+------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed <a class="code" href="grid_2manifold__0_8txt.html#a02d8bd1db3a4d0b6d68a99a931ce1b83">since</a> <a class="code" href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a>    |     0.301s |            |</div>
<div class="line">|                                             |            |            |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                         | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |  wall <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> | % <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> total |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
<div class="line">| Assemble coupling <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>        |         1 |    0.0385s |        13% |</div>
<div class="line">| Assemble <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                 |         1 |    0.0131s |       4.3% |</div>
<div class="line">| Output results                  |         1 |    0.0736s |        24% |</div>
<div class="line">| Setup coupling                  |         1 |    0.0234s |       7.7% |</div>
<div class="line">| Setup <a class="code" href="reordering__0_8txt.html#a4a9ed06a3880b1ccf188c35213698758">grids</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#acce0a318676405d57af6ef0f5cbe4ec3">and</a> <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>            |         1 |    0.0679s |        23% |</div>
<div class="line">| Solve <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                    |         1 |    0.0832s |        28% |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
</div><!-- fragment --><p>You may notice that, in terms of CPU time, assembling the coupling system is twice as expensive as assembling the standard Poisson system, even though the matrix is smaller. This is due to the non-matching nature of the discretization. Whether this is acceptable or not, depends on the applications.</p>
<p>If the problem was set in a three-dimensional setting, and the immersed mesh was time dependent, it would be much more expensive to recreate the mesh at each step rather than use the technique we present here. Moreover, you may be able to create a very fast and optimized solver on a uniformly refined square or cubic grid, and embed the domain where you want to perform your computation using the technique presented here. This would require you to only have a surface representatio of your domain (a much cheaper and easier mesh to produce).</p>
<p>To play around a little bit, we are going to complicate a little the fictitious domain as well as the boundary conditions we impose on it.</p>
<p><a class="anchor" id="Testcase2and3"></a></p><h3>Test case 2 and 3: </h3>
<p>If we use the following parameter file : </p><div class="fragment"><div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">Coupling</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>                    = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>        = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Homogeneous Dirichlet <a class="code" href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a> ids           = 0,1,2,3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 8</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Use <a class="code" href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">displacement</a> <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <span class="keyword">interface       </span>= <a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Verbosity <a class="code" href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a>                              = 10</div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.5, Cy=.5, r=.1, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">w</a>=12</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = (R+r*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">w</a>*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>))*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; (R+r*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">w</a>*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>))*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>-.5</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Schur <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a> control</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log frequency = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a>   = <span class="keyword">false</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>    = <span class="keyword">true</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Max <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a>     = 100000</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Reduction     = 1.e-12</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a>     = 1.e-12</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>We get a "flowery" looking domain, where we impose a linear boundary condition \(g=x-.5\). This test shows that the method is actually quite accurate in recovering an exactly linear function from its boundary conditions, and even though the meshes are not aligned, we obtain a pretty good result.</p>
<p>Replacing \(x-.5\) with \(2(x-.5)^2-2(y-.5)^2\), i.e., modifying the parameter file such that we have </p><div class="fragment"><div class="line">...</div>
<div class="line">subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 2*(<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>-.5)^2-2*(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>-.5)^2</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p> produces the saddle on the right.</p>
<div class="twocolumn" style="width: 80%"> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.3_grid.png" alt="" width="500" class="inline"/> </div> </div> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.4_grid.png" alt="" width="500" class="inline"/> </div> </div> </div><p><a class="anchor" id="extensions"></a> <a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p><a class="anchor" id="Runningwithspacedimequaltothree"></a></p><h4>Running with <code>spacedim</code> equal to three</h4>
<p>While the current tutorial program is written for <code>spacedim</code> equal to two, there are only minor changes you have to do in order for the program to run in different combinations of dimensions.</p>
<p>If you want to run with <code>spacedim</code> equal to three and <code>dim</code> equal to two, then you will almost certainly want to perform the following changes:</p>
<ul>
<li>use a different reference domain for the embedded grid, maybe reading it from a file. It is not possible to construct a smooth closed surface with one single parametrization of a square domain, therefore you'll most likely want to use a reference domain that is topologically equivalent to a the boundary of a sphere.</li>
<li>use a displacement instead of the deformation to map \(\Gamma_0\) into \(\Gamma\)</li>
</ul>
<p><a class="anchor" id="Moregeneraldomains"></a></p><h4>More general domains </h4>
<p>We have seen in other tutorials (for example in <a class="el" href="step_5.html">step-5</a> and <a class="el" href="step_54.html">step-54</a>) how to read grids from input files. A nice generalization for this tutorial program would be to allow the user to select a grid to read from the parameter file itself, instead of hardcoding the mesh type in the tutorial program itself.</p>
<p><a class="anchor" id="Preconditioner"></a></p><h4>Preconditioner</h4>
<p>At the moment, we have no preconditioner on the Schur complement. This is ok for two dimensional problems, where a few hundred iterations bring the residual down to the machine precision, but it's not going to work in three dimensions.</p>
<p>It is not obvious what a good preconditioner would be here. The physical problem we are solving with the Schur complement, is to associate to the Dirichlet data \(g\), the value of the Lagrange multiplier \(\lambda\). \(\lambda\) can be interpreted as the <em>jump</em> in the normal gradient that needs to be imposed on \(u\) across \(\Gamma\), in order to obtain the Dirichlet data \(g\).</p>
<p>So \(S\) is some sort of Neumann to Dirichlet map, and we would like to have a good approximation for the Dirichlet to Neumann map. A possibility would be to use a Boundary Element approximation of the problem on \(\Gamma\), and construct a rough approximation of the hyper-singular operator for the Poisson problem associated to \(\Gamma\), which is precisely a Dirichlet to Neumann map.</p>
<p><a class="anchor" id="ParallelCode"></a></p><h4>Parallel Code </h4>
<p>The simple code proposed here can serve as a starting point for more complex problems which, to be solved, need to be run on parallel code, possibly using distributed meshes (see <a class="el" href="step_17.html">step-17</a>, <a class="el" href="step_40.html">step-40</a>, and the documentation for <a class="el" href="classparallel_1_1shared_1_1Triangulation.html">parallel::shared::Triangulation</a> and <a class="el" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a>).</p>
<p>When using non-matching grids in parallel a problem arises: to compute the matrix \(C\) a process needs information about both meshes on the same portion of real space but, when working with distributed meshes, this information may not be available, because the locally owned part of the \(\Omega\) triangulation stored on a given processor may not be physically co-located with the locally owned part of the \(\Gamma\) triangulation stored on the same processor.</p>
<p>Various strategies can be implemented to tackle this problem:</p>
<ul>
<li>distribute the two meshes so that this constraint is satisfied;</li>
<li>use communication for the parts of real space where the constraint is not satisfied;</li>
<li>use a distributed triangulation for the embedding space, and a shared triangulation for the emdedded configuration.</li>
</ul>
<p>The latter strategy is clearly the easiest to implement, as most of the functions used in this tutorial program will work unchanged also in the parallel case. Of course one could use the reversal strategy (that is, have a distributed embedded <a class="el" href="classTriangulation.html">Triangulation</a> and a shared embedding <a class="el" href="classTriangulation.html">Triangulation</a>).</p>
<p>However, this strategy is most likely going to be more expensive, since by definition the embedding grid is larger than the embedded grid, and it makes more sense to distribute the largest of the two grids, maintaining the smallest one shared among all processors.</p>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2018 - 2020 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Authors: Luca Heltai, Giovanni Alzetta,</span></div>
<div class="line"><span class="comment"> * International School for Advanced Studies, Trieste, 2018</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parameter__acceptor_8h.html">deal.II/base/parameter_acceptor.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools_8h.html">deal.II/grid/grid_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools__cache_8h.html">deal.II/grid/grid_tools_cache.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2fe_2fe_8h.html">deal.II/fe/fe.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q__eulerian_8h.html">deal.II/fe/mapping_q_eulerian.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__fe__field_8h.html">deal.II/fe/mapping_fe_field.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2matrix__tools_8h.html">deal.II/numerics/matrix_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="non__matching_2coupling_8h.html">deal.II/non_matching/coupling.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__direct_8h.html">deal.II/lac/sparse_direct.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator_8h.html">deal.II/lac/linear_operator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator__tools_8h.html">deal.II/lac/linear_operator_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep60.html">Step60</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim = dim&gt;</div>
<div class="line">  <span class="keyword">class </span>DistributedLagrangeProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">class </span>Parameters : <span class="keyword">public</span> <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a></div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Parameters();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_refinement = 4;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> delta_refinement = 3;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_embedded_refinement = 8;</div>
<div class="line"> </div>
<div class="line">      std::list&lt;types::boundary_id&gt; homogeneous_dirichlet_ids{0, 1, 2, 3};</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedding_space_finite_element_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_space_finite_element_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_configuration_finite_element_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coupling_quadrature_order = 3;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">bool</span> use_displacement = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> verbosity_level = 10;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">bool</span> <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">false</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    DistributedLagrangeProblem(<span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_grids_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_embedding_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_embedded_dofs();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_coupling();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> assemble_system();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Triangulation&lt;spacedim&gt;&gt; space_grid;</div>
<div class="line">    std::unique_ptr&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;</div>
<div class="line">                                             space_grid_tools_cache;</div>
<div class="line">    std::unique_ptr&lt;FiniteElement&lt;spacedim&gt;&gt; space_fe;</div>
<div class="line">    std::unique_ptr&lt;DoFHandler&lt;spacedim&gt;&gt;    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Triangulation&lt;dim, spacedim&gt;&gt; embedded_grid;</div>
<div class="line">    std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_fe;</div>
<div class="line">    std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_dh;</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_configuration_fe;</div>
<div class="line">    std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_configuration_dh;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>                                embedded_configuration;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">      embedded_configuration_function;</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Mapping&lt;dim, spacedim&gt;&gt; embedded_mapping;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">      embedded_value_function;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;ReductionControl&gt;</a> schur_solver_control;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a> stiffness_sparsity;</div>
<div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a> coupling_sparsity;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> stiffness_matrix;</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> coupling_matrix;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_rhs;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_value;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> monitor;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <a class="code" href="classStep60_1_1DistributedLagrangeProblem_1_1Parameters.html#a4d6fa5f1cf54eb6b828e03848022e3a9">DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters::Parameters</a>()</div>
<div class="line">    : <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a>(<span class="stringliteral">&quot;/Distributed Lagrange&lt;&quot;</span> +</div>
<div class="line">                        <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;,&quot;</span> +</div>
<div class="line">                        <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>) + <span class="stringliteral">&quot;&gt;/&quot;</span>)</div>
<div class="line">  {</div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Initial embedding space refinement&quot;</span>, initial_refinement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Initial embedded space refinement&quot;</span>,</div>
<div class="line">                  initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Local refinements steps near embedded domain&quot;</span>,</div>
<div class="line">                  delta_refinement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Homogeneous Dirichlet boundary ids&quot;</span>,</div>
<div class="line">                  homogeneous_dirichlet_ids);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Use displacement in embedded interface&quot;</span>, use_displacement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Embedding space finite element degree&quot;</span>,</div>
<div class="line">                  embedding_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Embedded space finite element degree&quot;</span>,</div>
<div class="line">                  embedded_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Embedded configuration finite element degree&quot;</span>,</div>
<div class="line">                  embedded_configuration_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Coupling quadrature order&quot;</span>, coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Verbosity level&quot;</span>, verbosity_level);</div>
<div class="line"> </div>
<div class="line">    parse_parameters_call_back.connect([&amp;]() -&gt; <span class="keywordtype">void</span> { <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">true</span>; });</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  DistributedLagrangeProblem&lt;dim, spacedim&gt;::DistributedLagrangeProblem(</div>
<div class="line">    <span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">    : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">    , embedded_configuration_function(<span class="stringliteral">&quot;Embedded configuration&quot;</span>, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>)</div>
<div class="line">    , embedded_value_function(<span class="stringliteral">&quot;Embedded value&quot;</span>)</div>
<div class="line">    , schur_solver_control(<span class="stringliteral">&quot;Schur solver control&quot;</span>)</div>
<div class="line">    , monitor(std::cout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::summary, <a class="code" href="classTimerOutput.html">TimerOutput</a>::cpu_and_wall_times)</div>
<div class="line">  {</div>
<div class="line">    embedded_configuration_function.declare_parameters_call_back.connect(</div>
<div class="line">      []() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function constants&quot;</span>, <span class="stringliteral">&quot;R=.3, Cx=.4, Cy=.4&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>,</div>
<div class="line">                                   <span class="stringliteral">&quot;R*cos(2*pi*x)+Cx; R*sin(2*pi*x)+Cy&quot;</span>);</div>
<div class="line">      });</div>
<div class="line"> </div>
<div class="line">    embedded_value_function.declare_parameters_call_back.connect(</div>
<div class="line">      []() -&gt; <span class="keywordtype">void</span> { <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>); });</div>
<div class="line"> </div>
<div class="line">    schur_solver_control.declare_parameters_call_back.connect([]() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Max steps&quot;</span>, <span class="stringliteral">&quot;1000&quot;</span>);</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Reduction&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Tolerance&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">    });</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_grids_and_dofs()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup grids and dofs&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    space_grid = std::make_unique&lt;Triangulation&lt;spacedim&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*space_grid, 0, 1, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    space_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_refinement);</div>
<div class="line">    space_grid_tools_cache =</div>
<div class="line">      std::make_unique&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;(*space_grid);</div>
<div class="line"> </div>
<div class="line">    embedded_grid = std::make_unique&lt;Triangulation&lt;dim, spacedim&gt;&gt;();</div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*embedded_grid);</div>
<div class="line">    embedded_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">    embedded_configuration_fe = std::make_unique&lt;FESystem&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">      <a class="code" href="classFE__Q.html">FE_Q&lt;dim, spacedim&gt;</a>(</div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree),</div>
<div class="line">      <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>);</div>
<div class="line"> </div>
<div class="line">    embedded_configuration_dh =</div>
<div class="line">      std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line"> </div>
<div class="line">    embedded_configuration_dh-&gt;distribute_dofs(*embedded_configuration_fe);</div>
<div class="line">    embedded_configuration.reinit(embedded_configuration_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_configuration_dh,</div>
<div class="line">                             embedded_configuration_function,</div>
<div class="line">                             embedded_configuration);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.use_displacement == <span class="keyword">true</span>)</div>
<div class="line">      embedded_mapping =</div>
<div class="line">        std::make_unique&lt;MappingQEulerian&lt;dim, Vector&lt;double&gt;, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;&gt;(</div>
<div class="line">          <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree,</div>
<div class="line">          *embedded_configuration_dh,</div>
<div class="line">          embedded_configuration);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      embedded_mapping =</div>
<div class="line">        std::make_unique&lt;MappingFEField&lt;dim, spacedim, Vector&lt;double&gt;&gt;&gt;(</div>
<div class="line">          *embedded_configuration_dh, embedded_configuration);</div>
<div class="line"> </div>
<div class="line">    setup_embedded_dofs();</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Point&lt;spacedim&gt;&gt; support_points(embedded_dh-&gt;n_dofs());</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement != 0)</div>
<div class="line">      <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>(*embedded_mapping,</div>
<div class="line">                                           *embedded_dh,</div>
<div class="line">                                           support_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> point_locations =</div>
<div class="line">          <a class="code" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a>(*space_grid_tools_cache,</div>
<div class="line">                                             support_points);</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a> = std::get&lt;0&gt;(point_locations);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>)</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;set_refine_flag();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a> : <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;face_indices())</div>
<div class="line">              <span class="keywordflow">if</span> (!<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;at_boundary(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>))</div>
<div class="line">                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;neighbor(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>)-&gt;set_refine_flag();</div>
<div class="line">          }</div>
<div class="line">        space_grid-&gt;execute_coarsening_and_refinement();</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> embedded_space_maximal_diameter =</div>
<div class="line">      <a class="code" href="namespaceGridTools.html#ae8409fa9cb46a0070abc4da7de0f47f2">GridTools::maximal_cell_diameter</a>(*embedded_grid, *embedded_mapping);</div>
<div class="line">    <span class="keywordtype">double</span> embedding_space_minimal_diameter =</div>
<div class="line">      <a class="code" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a>(*space_grid);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding minimal diameter: &quot;</span></div>
<div class="line">            &lt;&lt; embedding_space_minimal_diameter</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;, embedded maximal diameter: &quot;</span></div>
<div class="line">            &lt;&lt; embedded_space_maximal_diameter &lt;&lt; <span class="stringliteral">&quot;, ratio: &quot;</span></div>
<div class="line">            &lt;&lt; embedded_space_maximal_diameter /</div>
<div class="line">                 embedding_space_minimal_diameter</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(embedded_space_maximal_diameter &lt;</div>
<div class="line">                  embedding_space_minimal_diameter,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">                  <span class="stringliteral">&quot;The embedding grid is too refined (or the embedded grid &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;is too coarse). Adjust the parameters so that the minimal &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;grid size of the embedding grid is larger &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;than the maximal grid size of the embedded grid.&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    setup_embedding_dofs();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedding_dofs()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a> = std::make_unique&lt;DoFHandler&lt;spacedim&gt;&gt;(*space_grid);</div>
<div class="line">    space_fe = std::make_unique&lt;FE_Q&lt;spacedim&gt;&gt;(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;distribute_dofs(*space_fe);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">id</span> : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.homogeneous_dirichlet_ids)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a>(</div>
<div class="line">          *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <span class="keywordtype">id</span>, <a class="code" href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;spacedim&gt;</a>(), <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">      }</div>
<div class="line">    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs(), <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs());</div>
<div class="line">    <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, dsp, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">    stiffness_sparsity.copy_from(dsp);</div>
<div class="line">    stiffness_matrix.<a class="code" href="classSparseMatrix.html#afa7ae4d32bda6035661c9cccfe185597">reinit</a>(stiffness_sparsity);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs());</div>
<div class="line">    <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding dofs: &quot;</span> &lt;&lt; <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedded_dofs()</div>
<div class="line">  {</div>
<div class="line">    embedded_dh = std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line">    embedded_fe = std::make_unique&lt;FE_Q&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">    embedded_dh-&gt;distribute_dofs(*embedded_fe);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">    embedded_rhs.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">    embedded_value.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedded dofs: &quot;</span> &lt;&lt; embedded_dh-&gt;n_dofs() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_coupling()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup coupling&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs(), embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>(*space_grid_tools_cache,</div>
<div class="line">                                                  *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                                  *embedded_dh,</div>
<div class="line">                                                  <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                                  dsp,</div>
<div class="line">                                                  <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                                  <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                  <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                  *embedded_mapping);</div>
<div class="line">    coupling_sparsity.copy_from(dsp);</div>
<div class="line">    coupling_matrix.reinit(coupling_sparsity);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::assemble_system()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble system&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixTools::create_laplace_matrix</a>(</div>
<div class="line">        *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">        <a class="code" href="classQGauss.html">QGauss&lt;spacedim&gt;</a>(2 * space_fe-&gt;degree + 1),</div>
<div class="line">        stiffness_matrix,</div>
<div class="line">        <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classFunction.html">Function&lt;spacedim&gt;</a> *<span class="keyword">&gt;</span>(<span class="keyword">nullptr</span>),</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#a6e325333a138893e181da47f29ac680a">VectorTools::create_right_hand_side</a>(*embedded_mapping,</div>
<div class="line">                                          *embedded_dh,</div>
<div class="line">                                          <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(2 * embedded_fe-&gt;degree +</div>
<div class="line">                                                      1),</div>
<div class="line">                                          embedded_value_function,</div>
<div class="line">                                          embedded_rhs);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble coupling system&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line">      <a class="code" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a>(*space_grid_tools_cache,</div>
<div class="line">                                               *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                               *embedded_dh,</div>
<div class="line">                                               <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                               coupling_matrix,</div>
<div class="line">                                               <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                               <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                               <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                               *embedded_mapping);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_mapping,</div>
<div class="line">                               *embedded_dh,</div>
<div class="line">                               embedded_value_function,</div>
<div class="line">                               embedded_value);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">DistributedLagrangeProblem&lt;dim, spacedim&gt;::solve</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Solve system&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a> K_inv_umfpack;</div>
<div class="line">    K_inv_umfpack.<a class="code" href="classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">initialize</a>(stiffness_matrix);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> K  = <a class="code" href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a>(stiffness_matrix);</div>
<div class="line">    <span class="keyword">auto</span> Ct = <a class="code" href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a>(coupling_matrix);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>  = <a class="code" href="group__LAOperators.html#ga6bdc65fb2db56230e6bc7d545e81295d">transpose_operator</a>(Ct);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> K_inv = <a class="code" href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a>(K, K_inv_umfpack);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span>                     S = <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a> * K_inv * Ct;</div>
<div class="line">    <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver_cg(schur_solver_control);</div>
<div class="line">    <span class="keyword">auto</span> S_inv = <a class="code" href="group__LAOperators.html#ga87e38fbde431397c069a88692bd24ae7">inverse_operator</a>(S, solver_cg, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> = S_inv * embedded_rhs;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = K_inv * Ct * <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a7b3d3f295bb56d6cd6856bdc6cbe8a01">distribute</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::output_results()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Output results&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;spacedim&gt;</a> embedding_out;</div>
<div class="line"> </div>
<div class="line">    std::ofstream embedding_out_file(<span class="stringliteral">&quot;embedding.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    embedding_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>);</div>
<div class="line">    embedding_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line">    embedding_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">    embedding_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedding_out_file);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim, spacedim&gt;</a> embedded_out;</div>
<div class="line"> </div>
<div class="line">    std::ofstream embedded_out_file(<span class="stringliteral">&quot;embedded.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    embedded_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*embedded_dh);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(lambda, <span class="stringliteral">&quot;lambda&quot;</span>);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(embedded_value, <span class="stringliteral">&quot;g&quot;</span>);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(*embedded_mapping,</div>
<div class="line">                               <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedded_out_file);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">DistributedLagrangeProblem&lt;dim, spacedim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initialized, <a class="code" href="group__Exceptions.html#ga426dec8d8185f1410e09a795e0b36e86">ExcNotInitialized</a>());</div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.verbosity_level);</div>
<div class="line"> </div>
<div class="line">    setup_grids_and_dofs();</div>
<div class="line">    setup_coupling();</div>
<div class="line">    assemble_system();</div>
<div class="line">    <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line">    output_results();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step60</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep60.html">Step60</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> = 1, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a> = 2;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classStep60_1_1DistributedLagrangeProblem_1_1Parameters.html">DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
<div class="line">      DistributedLagrangeProblem&lt;dim, spacedim&gt;             <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
<div class="line"> </div>
<div class="line">      std::string parameter_file;</div>
<div class="line">      <span class="keywordflow">if</span> (argc &gt; 1)</div>
<div class="line">        parameter_file = argv[1];</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        parameter_file = <span class="stringliteral">&quot;parameters.prm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a>(parameter_file, <span class="stringliteral">&quot;used_parameters.prm&quot;</span>);</div>
<div class="line">      <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><br  />
 This tutorial depends on <a class="el" href="step_6.html">step-6</a> .  
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a><a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#NonmatchinggridconstraintsthroughdistributedLagrangemultipliers">Non-matching grid constraints through distributed Lagrange multipliers</a><a href="#NonmatchinggridconstraintsthroughdistributedLagrangemultipliers">Non-matching grid constraints through distributed Lagrange multipliers</a>
        <li><a href="#Thetestcase">The testcase</a><a href="#Thetestcase">The testcase</a>
        <li><a href="#References">References</a><a href="#References">References</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a><a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Includefiles">Include files</a><a href="#Includefiles">Include files</a>
        <li><a href="#DistributedLagrangeProblem">DistributedLagrangeProblem</a><a href="#DistributedLagrangeProblem">DistributedLagrangeProblem</a>
        <li><a href="#DistributedLagrangeProblemParameters">DistributedLagrangeProblem::Parameters</a><a href="#DistributedLagrangeProblemParameters">DistributedLagrangeProblem::Parameters</a>
        <li><a href="#Setup">Set up</a><a href="#Setup">Set up</a>
        <li><a href="#Assembly">Assembly</a><a href="#Assembly">Assembly</a>
        <li><a href="#Solve">Solve</a><a href="#Solve">Solve</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a><a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Testcase1"> Test case 1: </a><a href="#Testcase1"> Test case 1: </a>
        <li><a href="#Testcase2and3"> Test case 2 and 3: </a><a href="#Testcase2and3"> Test case 2 and 3: </a>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
      <ul>
        <li><a href="#Runningwithspacedimequaltothree"> Running with `spacedim` equal to three</a><a href="#Runningwithspacedimequaltothree"> Running with `spacedim` equal to three</a>
        <li><a href="#Moregeneraldomains"> More general domains </a><a href="#Moregeneraldomains"> More general domains </a>
        <li><a href="#Preconditioner"> Preconditioner</a><a href="#Preconditioner"> Preconditioner</a>
        <li><a href="#ParallelCode"> Parallel Code </a><a href="#ParallelCode"> Parallel Code </a>
    </ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a><a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <br  />
 <br  />
 <em>This program was contributed by Luca Heltai and Giovanni Alzetta, SISSA, Trieste. </em> </p><dl class="section note"><dt>Note</dt><dd>If you use this program as a basis for your own work, please consider citing it in your list of references. The initial version of this work was contributed to the deal.II project by the authors listed in the following citation: <a href="https://doi.org/10.5281/zenodo.1243280"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.1243280.svg" alt="10.5281/zenodo.1243280"/></a>  <br  />
</dd></dl>
<p><a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p><a class="anchor" id="NonmatchinggridconstraintsthroughdistributedLagrangemultipliers"></a></p><h3>Non-matching grid constraints through distributed Lagrange multipliers</h3>
<p>In this tutorial we consider the case of two domains, \(\Omega\) in \(R^{\text{spacedim}}\) and \(\Gamma\) in \(R^{\text{dim}}\) , where \(\Gamma\) isembedded in \(\Omega\) ( \(\Gamma \subseteq \Omega\) ). We want to solve a partialdifferential equation on \(\Omega\) , enforcing some conditions on the solution ofthe problemon the embedded domain* \(\Gamma\) . There are two interesting scenarios:</p>
<ul>
<li>the geometrical dimension <code>dim</code> of the embedded domain \(\Gamma\) is the same ofthe domain \(\Omega\) (<code>spacedim</code>), that is, the spacedim-dimensional measure of \(\Gamma\) is not zero, or</li>
<li>the embedded domain \(\Gamma\) has an intrinsic dimension <code>dim</code> which is smallerthan that of \(\Omega\) (<code>spacedim</code>), thus its spacedim-dimensional measure iszero; for example it is a curve embedded in a two dimensional domain, or asurface embedded in a three-dimensional domain. In both cases define the restriction operator \(\gamma\) as the operator that,given a continuous function on \(\Omega\) , returns its (continuous) restriction on \(\Gamma\) , i.e., <p class="formulaDsp">
\[ \gamma : C^0(\Omega) \mapsto C^0(\Gamma), \quad \text{ s.t. } \gamma u = u|_{\Gamma} \in C^0(\Gamma), \quad \forall u \in C^0(\Omega). \]
</p>
 It is well known that the operator \(\gamma\) can be extended to a continuousoperator on \(H^1(\Omega)\) , mapping functions in \(H^1(\Omega)\) to functions in \(H^1(\Gamma)\) when the intrinsic dimension of \(\Gamma\) is the same of \(\Omega\) . The same is true, with a less regular range space (namely \(H^{1/2}(\Gamma)\) ),when the dimension of \(\Gamma\) is one less with respect to \(\Omega\) , and \(\Gamma\) does not have a boundary. In this second case, the operator \(\gamma\) isalso known as thetrace* operator, and it is well defined for Lipschitzco-dimension one curves and surfaces \(\Gamma\) embedded in \(\Omega\) (read <a href="https://en.wikipedia.org/wiki/Trace_operator">this wikipedia article</a>for further details on the trace operator). The co-dimension two case is a little more complicated, and in general it is notpossible to construct a continuous trace operator, not even from \(H^1(\Omega)\) to \(L^2(\Gamma)\) , when the dimension of \(\Gamma\) is zero or one respectively in twoand three dimensions. In this tutorial program we're not interested in further details on \(\gamma\) : wetake the extension \(\gamma\) for granted, assuming that the dimension of theembedded domain (<code>dim</code>) is always smaller by one or equal with respect to thedimension of the embedding domain \(\Omega\) (<code>spacedim</code>). We are going to solve the following differential problem: given a sufficientlyregular function \(g\) on \(\Gamma\) , find the solution \(u\) to <p class="formulaDsp">
\begin{eqnarray*} - \Delta u + \gamma^T \lambda &amp;=&amp; 0 \text{ in } \Omega\\ \gamma u &amp;=&amp; g \text{ in } \Gamma \\ u &amp; = &amp; 0 \text{ on } \partial\Omega. \end{eqnarray*}
</p>
</li>
</ul>
<p>This is a constrained problem, where we are looking for a harmonic function \(u\) that satisfies homogeneous boundary conditions on \(\partial\Omega\) , subject tothe constraint \(\gamma u = g\) using a Lagrange multiplier. This problem has a physical interpretation: harmonic functions, i.e., functionsthat satisfy the Laplace equation, can be thought of as the displacements of amembrane whose boundary values are prescribed. The current situation thencorresponds to finding the shape of a membrane for which not only thedisplacement at the boundary, but also on \(\Gamma\) is prescribed. For example,if \(\Gamma\) is a closed curve in 2d space, then that would model a soap filmthat is held in place by a wire loop along \(\partial \Omega\) as well as a secondloop along \(\Gamma\) . In cases where \(\Gamma\) is a whole area, you can think ofthis as a membrane that is stretched over an obstacle where \(\Gamma\) is thecontact area. (If the contact area is not known we have a different problem</p>
<ul>
<li>called the "obstacle problem"</li>
<li>which is modeled in <a class="el" href="step_41.html">step-41</a> .) As a first example we study the zero Dirichlet boundary condition on \(\partial\Omega\) . The same equations apply if we apply zero Neumann boundaryconditions on \(\partial\Omega\) or a mix of the two. The variational formulation can be derived by introducing two infinitedimensional spaces \(V(\Omega)\) and \(Q^*(\Gamma)\) , respectively for the solution \(u\) and for the Lagrange multiplier \(\lambda\) . Multiplying the first equation by \(v \in V(\Omega)\) and the second by \(q \in Q(\Gamma)\) , integrating by parts when possible, and exploiting the boundaryconditions on \(\partial\Omega\) , we obtain the following variational problem: Given a sufficiently regular function \(g\) on \(\Gamma\) , find the solution \(u\) to <p class="formulaDsp">
\begin{eqnarray*} (\nabla u, \nabla v)_{\Omega} + (\lambda, \gamma v)_{\Gamma} &amp;=&amp; 0 \qquad \forall v \in V(\Omega) \\ (\gamma u, q)_{\Gamma} &amp;=&amp; (g,q)_{\Gamma} \qquad \forall q \in Q(\Gamma), \end{eqnarray*}
</p>
</li>
</ul>
<p>where \((\cdot, \cdot)_{\Omega}\) and \((\cdot, \cdot)_{\Gamma}\) represent,respectively, \(L^2\) scalar products in \(\Omega\) and in \(\Gamma\) . Inspection of the variational formulation tells us that the space \(V(\Omega)\) can be taken to be \(H^1_0(\Omega)\) . The space \(Q(\Gamma)\) , in the co-dimensionzero case, should be taken as \(H^1(\Gamma)\) , while in the co-dimension one caseshould be taken as \(H^{1/2}(\Gamma)\) . The function \(g\) should therefore be either in \(H^1(\Gamma)\) (for theco-dimension zero case) or \(H^{1/2}(\Gamma)\) (for the co-dimension one case).This leaves us with a Lagrange multiplier \(\lambda\) in \(Q^*(\Gamma)\) , which iseither \(H^{-1}(\Gamma)\) or \(H^{-1/2}(\Gamma)\) . There are two options for the discretization of the problem above. One could choosematching discretizations, where the <a class="el" href="classTriangulation.html">Triangulation</a> for \(\Gamma\) is aligned with theTriangulation for \(\Omega\) , or one could choose to discretize the two domains ina completely independent way. The first option is clearly more indicated for the simple problem weproposed above: it is sufficient to use a single <a class="el" href="classTriangulation.html">Triangulation</a> for \(\Omega\) andthen impose certain constraints depending \(\Gamma\) . An example of this approachis studied in <a class="el" href="step_40.html">step-40</a> , where the solution has to stay above an obstacle and thisis achieved imposing constraints on \(\Omega\) . To solve more complex problems, for example one where the domain \(\Gamma\) is timedependent, the second option could be a more viable solution. Handlingnon aligned meshes is complex by itself: to illustrate how is done we study asimple problem. The technique we describe here is presented in the literature using one of many names:the <b>immersed finite element method</b>, the <b>fictitious boundary method</b>, the<b>distributed Lagrange multiplier method</b>, and others. The main principle isthat the discretization of the two grids and of the two finite element spacesare kept completely independent. This technique is particularly efficient forthe simulation of fluid-structure interaction problems, where the configurationof the embedded structure is part of the problem itself, and one solves a(possibly non-linear) elastic problem to determine the (time dependent)configuration of \(\Gamma\) , and a (possibly non-linear) flow problem in \(\Omega \setminus \Gamma\) , plus coupling conditions on the interface between the fluidand the solid. In this tutorial program we keep things a little simpler, and we assume that theconfiguration of the embedded domain is given in one of two possible ways:</p>
<ul>
<li>as a deformation mapping \(\psi: \Gamma_0 \mapsto \Gamma \subseteq \Omega\) ,defined on a continuous finite dimensional space on \(\Gamma_0\) and representing,for any point \(x \in \Gamma_0\) , its coordinate \(\psi(x)\) in \(\Omega\) ;</li>
<li>as a displacement mapping \(\delta \psi(x) = \psi(x)-x\) for \(x\in \Gamma_0\) ,representing for any point \(x\) the displacement vector applied in order todeform \(x\) to its actual configuration \(\psi(x) = x +\delta\psi(x)\) . We define the embedded reference domain \(\Gamma_0\) <code>embedded_grid</code>: onthis triangulation we construct a finite dimensional space (<code>embedded_configuration_dh</code>)to describe either the deformation or the displacement through a FiniteElementsystem of <a class="el" href="classFE__Q.html">FE_Q</a> objects (<code>embedded_configuration_fe</code>). This finite dimensionalspace is used only to interpolate a user supplied function(<code>embedded_configuration_function</code>) representing either \(\psi\) (if theparameter <code>use_displacement</code> is set to <code>false</code>) or \(\delta\psi\) (if theparameter <code>use_displacement</code> is set to <code>true</code>). <br  />
 The Lagrange multiplier \(\lambda\) and the user supplied function \(g\) aredefined through another finite dimensional space <code>embedded_dh</code>, and throughanother <a class="el" href="classFiniteElement.html">FiniteElement</a> <code>embedded_fe</code>, using the same reference domain. Inorder to take into account the deformation of the domain, either a MappingFEFieldor a <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> object are initialized with the <code>embedded_configuration</code>vector. In the embedding space, a standard finite dimensional space <code>space_dh</code> isconstructed on the embedding grid <code>space_grid</code>, using theFiniteElement <code>space_fe</code>, following almost verbatim the approach taken in <a class="el" href="step_6.html">step-6</a> . We represent the discretizations of the spaces \(V\) and \(Q\) with <p class="formulaDsp">
\[ V_h(\Omega) = \text{span} \{v_i\}_{i=1}^n \]
</p>
@_fakenland <p class="formulaDsp">
\[ Q_h(\Gamma) = \text{span} \{q_i\}_{i=1}^m \]
</p>
@_fakenlrespectively, where \(n\) is the dimension of <code>space_dh</code>, and \(m\) the dimension of <code>embedded_dh</code>. Once all the finite dimensional spaces are defined, the variational formulationof the problem above leaves us with the following finite dimensional systemof equations: <p class="formulaDsp">
\[ \begin{pmatrix} K &amp; C^T \\ C &amp; 0 \end{pmatrix} \begin{pmatrix} u \\ \lambda \end{pmatrix} = \begin{pmatrix} 0 \\ G \end{pmatrix} \]
</p>
 where <p class="formulaDsp">
\begin{eqnarray*} K_{ij} &amp;\dealcoloneq&amp; (\nabla v_j, \nabla v_i)_\Omega \qquad i,j=1,\dots,n \\ C_{\alpha j} &amp;\dealcoloneq&amp; (v_j, q_\alpha)_\Gamma \qquad j=1,\dots,n, \alpha = 1,\dots, m \\\\ G_{\alpha} &amp;\dealcoloneq&amp; (g, q_\alpha)_\Gamma \qquad \alpha = 1,\dots, m. \end{eqnarray*}
</p>
</li>
</ul>
<p>While the matrix \(K\) is the standard stiffness matrix for the Poisson problem on \(\Omega\) , and the vector \(G\) is a standard right-hand-side vector for a finiteelement problem with forcing term \(g\) on \(\Gamma\) , (see, for example, <a class="el" href="step_3.html">step-3</a> ),the matrix \(C\) or its transpose \(C^T\) are non-standard since they coupleinformation on two non-matching grids. In particular, the integral that appears in the computation of a single entry of \(C\) , is computed on \(\Gamma\) . As usual in finite elements we split thisintegral into contributions from all cells of the triangulation used todiscretize \(\Gamma\) , we transform the integral on \(K\) to an integral on thereference element \(\hat K\) , where \(F_{K}\) is the mapping from \(\hat K\) to \(K\) ,and compute the integral on \(\hat K\) using a quadrature formula: </p><p class="formulaDsp">
\[ C_{\alpha j} \dealcoloneq (v_j, q_\alpha)_\Gamma = \sum_{K\in \Gamma} \int_{\hat K} \hat q_\alpha(\hat x) (v_j \circ F_{K}) (\hat x) J_K (\hat x) \mathrm{d} \hat x = \sum_{K\in \Gamma} \sum_{i=1}^{n_q} \big(\hat q_\alpha(\hat x_i) (v_j \circ F_{K}) (\hat x_i) J_K (\hat x_i) w_i \big) \]
</p>
<p> Computing this sum is non-trivial because we have to evaluate \((v_j \circ F_{K}) (\hat x_i)\) . In general, if \(\Gamma\) and \(\Omega\) are not aligned, the point \(F_{K}(\hat x_i)\) is completely arbitrary with respect to \(\Omega\) , and unlesswe figure out a way to interpolate all basis functions of \(V_h(\Omega)\) on anarbitrary point on \(\Omega\) , we cannot compute the integral needed for an entryof the matrix \(C\) . To evaluate \((v_j \circ F_{K}) (\hat x_i)\) the following steps needs to betaken (as shown in the picture below):</p>
<ul>
<li>For a given cell \(K\) in \(\Gamma\) compute the real point \(y_i \dealcoloneq F_{K} (\hat x_i)\) , where \(x_i\) is one of the quadrature points used for the integral on \(K \subseteq \Gamma\) .</li>
<li>Find the cell of \(\Omega\) in which \(y_i\) lies. We shall call this element \(T\) .</li>
<li> align="center"To evaluate the basis function use the inverse of the mapping \(G_T\) thattransforms the reference element \(\hat T\) into the element \(T\) : \(v_j(y_i) = \hat v_j \circ G^{-1}_{T} (y_i)\) . </li>
</ul>
<p><img src="https://www.dealii.org/images/steps/developer/step-60.C_interpolation.png" alt="" class="inline"/> </p>
<p><br  />
 The three steps above can be computed by calling, in turn,</p>
<ul>
<li><a class="el" href="namespaceGridTools.html#a2e10aeb1c8e76110a84b6945eac3aaf0">GridTools::find_active_cell_around_point()</a>, followed by</li>
<li><a class="el" href="classMapping.html#a38ba6aaa1745359910e1b465a0f5fb27">Mapping::transform_real_to_unit_cell()</a>. We then</li>
<li>construct a custom <a class="el" href="classQuadrature.html">Quadrature</a> formula, containing the point in the reference cell and then</li>
<li>construct an <a class="el" href="classFEValues.html">FEValues</a> object, with the given quadrature formula, and initialized with the cell obtained in the first step. This is what the deal.II function <a class="el" href="namespaceVectorTools.html#acd358e9b110ccbf4a7f76796d206b9c7">VectorTools::point_value()</a> does whenevaluating a finite element field (not just a single shape function) at anarbitrary point; but this would be inefficient in this case. A better solution is to use a convenient wrapper to perform the first threesteps on a collection of points: <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations()</a>. If one isactually interested in computing the full coupling matrix, then it is possibleto call the method <a class="el" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix()</a>, that performs theabove steps in an efficient way, reusing all possible data structures, andgathering expensive steps together. This is the function we'll be using later inthis tutorial. We solve the final saddle point problem by an iterative solver, applied to theSchur complement \(S\) (whose construction is described, for example, in <a class="el" href="step_20.html">step-20</a> ),and we construct \(S\) using <a class="el" href="classLinearOperator.html">LinearOperator</a> classes.</li>
</ul>
<p><a class="anchor" id="Thetestcase"></a></p><h3>The testcase</h3>
<p>The problem we solve here is identical to <a class="el" href="step_4.html">step-4</a> , with the difference that weimpose some constraints on an embedded domain \(\Gamma\) . The tutorial is writtenin a dimension independent way, and in the results section we show how to varyboth <code>dim</code> and <code>spacedim</code>. The tutorial is compiled for <code>dim</code> equal to one and <code>spacedim</code> equal to two. Ifyou want to run the program in embedding dimension <code>spacedim</code> equal to three,you will most likely want to change the reference domain for \(\Gamma\) to be, forexample, something you read from file, or a closed sphere that you later deformto something more interesting. In the default scenario, \(\Gamma\) has co-dimension one, and this tutorialprogram implements the Fictitious Boundary Method. As it turns out, the sametechniques are used in the Variational Immersed Finite Element Method, andthe coupling operator \(C\) defined above is the same in almost all of thesenon-matching methods. The embedded domain is assumed to be included in \(\Omega\) , which we take as theunit square \([0,1]^2\) . The definition of the fictitious domain \(\Gamma\) can bemodified through the parameter file, and can be given as a mapping from thereference interval \([0,1]\) to a curve in \(\Omega\) . If the curve is closed, then the results will be similar to running the sameproblem on a grid whose boundary is \(\Gamma\) . The program will happily run alsowith a non-closed \(\Gamma\) , although in those cases the mathematicalformulation of the problem is more difficult, since \(\Gamma\) will have aboundary by itself that has co-dimension two with respect to the domain \(\Omega\) .</p>
<p><a class="anchor" id="References"></a></p><h3>References</h3>
<ul>
<li>
Glowinski, R., T.-W. Pan, T.I. Hesla, and D.D. Joseph. 1999. “A Distributed Lagrange Multiplier/fictitious Domain Method for Particulate Flows.” International Journal of Multiphase Flow 25 (5). Pergamon: 755–94. </li>
<li>
Boffi, D., L. Gastaldi, L. Heltai, and C.S. Peskin. 2008. “On the Hyper-Elastic Formulation of the Immersed Boundary Method.” Computer Methods in Applied Mechanics and Engineering 197 (25–28). </li>
<li>
Heltai, L., and F. Costanzo. 2012. “Variational Implementation of Immersed Finite Element Methods.” Computer Methods in Applied Mechanics and Engineering 229–232. </li>
</ul>
<p><br  />
</p>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Includefiles"></a> </p><h3>Include files</h3>
<p>Most of these have been introduced elsewhere, we'll comment only on the new ones.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
</div><!-- fragment --><p>The parameter acceptor class is the first novelty of this tutorial program: in general parameter files are used to steer the execution of a program at run time. While even a simple approach saves compile time, as the same executable can be run with different parameter settings, it can become difficult to handle hundreds of parameters simultaneously while maintaining compatibility between different programs. This is where the class <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> proves useful.</p>
<p>This class is used to define a public interface for classes that want to use a single global <a class="el" href="classParameterHandler.html">ParameterHandler</a> to handle parameters. The class provides a static <a class="el" href="classParameterHandler.html">ParameterHandler</a> member, namely <a class="el" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>, and implements the "Command design pattern" (see, for example, E. Gamma, R. Helm, R. Johnson, J. Vlissides, Design <a class="el" href="namespacePatterns.html">Patterns</a>: Elements of Reusable Object-Oriented Software, Addison-Wesley Professional, 1994. <a href="https://goo.gl/FNYByc">https://goo.gl/FNYByc</a>).</p>
<p><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> provides a global subscription mechanism. Whenever an object of a class derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> is constructed, a pointer to that object-of-derived-type is registered, together with a section entry in the parameter file. Such registry is traversed upon invocation of the single function <a class="el" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a>("file.prm") which in turn makes sure that all classes stored in the global registry declare the parameters they will be using, and after having declared them, it reads the content of <code>file.prm</code> to parse the actual parameters.</p>
<p>If you call the method <a class="el" href="classParameterHandler.html#a04b75c02037d19fd7fd781785fcefc79">ParameterHandler::add_parameter</a> for each of the parameters you want to use in your code, there is nothing else you need to do. If you are using an already existing class that provides the two functions <code>declare_parameters</code> and <code>parse_parameters</code>, you can still use <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>, by encapsulating the existing class into a <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a> class.</p>
<p>In this example, we'll use both strategies, using <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a> for deal.II classes, and deriving our own parameter classes directly from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parameter__acceptor_8h.html">deal.II/base/parameter_acceptor.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools_8h.html">deal.II/grid/grid_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>The other new include file is the one that contains the <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> class. The structure of deal.II, as many modern numerical libraries, is organized following a Directed Acyclic Graph (DAG). A DAG is a directed graph with topological ordering: each node structurally represents an object, and is connected to non-root nodes by one (or more) oriented edges, from the parent to the child. The most significant example of this structure is the <a class="el" href="classTriangulation.html">Triangulation</a> and its <a class="el" href="group__Iterators.html#ga997d61ac77777cdc2be3ae934b1f7cdb">Triangulation::cell_iterator</a> structure. From a <a class="el" href="classTriangulation.html">Triangulation</a> (the main node), we can access each cell (children nodes of the triangulation). From the cells themselves we can access over all vertices of the cell. In this simple example, the DAG structure can be represented as three node types (the triangulation, the cell iterator, and the vertex) connected by oriented edges from the triangulation to the cell iterators, and from the cell iterator to the vertices. This has several advantages, but it intrinsically creates “asymmetries”, making certain operations fast and their inverse very slow: finding the vertices of a cell has low computational cost, and can be done by simply traversing the DAG, while finding all the cells that share a vertex requires a non-trivial computation unless a new DAG data structure is added that represents the inverse search.</p>
<p>Since inverse operations are usually not needed in a finite element code, these are implemented in <a class="el" href="namespaceGridTools.html">GridTools</a> without the use of extra data structures related to the <a class="el" href="classTriangulation.html">Triangulation</a> which would make them much faster. One such data structure, for example, is a map from the vertices of a <a class="el" href="classTriangulation.html">Triangulation</a> to all cells that share those vertices, which would reduce the computations needed to answer to the previous question.</p>
<p>Some methods, for example <a class="el" href="namespaceGridTools.html#a2e10aeb1c8e76110a84b6945eac3aaf0">GridTools::find_active_cell_around_point</a>, make heavy usage of these non-standard operations. If you need to call these methods more than once, it becomes convenient to store those data structures somewhere. <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> does exactly this, giving you access to previously computed objects, or computing them on the fly (and then storing them inside the class for later use), and making sure that whenever the <a class="el" href="classTriangulation.html">Triangulation</a> is updated, also the relevant data structures are recomputed.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools__cache_8h.html">deal.II/grid/grid_tools_cache.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2fe_2fe_8h.html">deal.II/fe/fe.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
</div><!-- fragment --><p>In this example, we will be using a reference domain to describe an embedded <a class="el" href="classTriangulation.html">Triangulation</a>, deformed through a finite element vector field.</p>
<p>The next two include files contain the definition of two classes that can be used in these cases. <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> allows one to describe a domain through adisplacement* field, based on a <a class="el" href="classFESystem.html">FESystem</a>[<a class="el" href="classFE__Q.html">FE_Q(p)</a>^spacedim] finite element space. The second is a little more generic, and allows you to use arbitrary vector <a class="el" href="classFiniteElement.html">FiniteElement</a> spaces, as long as they provide acontinuous* description of your domain. In this case, the description is done through the actualdeformation* field, rather than adisplacement* field.</p>
<p>Which one is used depends on how the user wants to specify the reference domain, and/or the actual configuration. We'll provide both options, and experiment a little in the results section of this tutorial program.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q__eulerian_8h.html">deal.II/fe/mapping_q_eulerian.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__fe__field_8h.html">deal.II/fe/mapping_fe_field.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>The parsed function class is another new entry. It allows one to create a <a class="el" href="classFunction.html">Function</a> object, starting from a string in a parameter file which is parsed into an object that you can use anywhere deal.II accepts a <a class="el" href="classFunction.html">Function</a> (for example, for interpolation, boundary conditions, etc.).</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2matrix__tools_8h.html">deal.II/numerics/matrix_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>This is the last new entry for this tutorial program. The namespace <a class="el" href="namespaceNonMatching.html">NonMatching</a> contains a few methods that are useful when performing computations on non-matching grids, or on curves that are not aligned with the underlying mesh.</p>
<p>We'll discuss its use in detail later on in the <code>setup_coupling</code> method.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="non__matching_2coupling_8h.html">deal.II/non_matching/coupling.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__direct_8h.html">deal.II/lac/sparse_direct.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator_8h.html">deal.II/lac/linear_operator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator__tools_8h.html">deal.II/lac/linear_operator_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep60.html">Step60</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p><a class="anchor" id="DistributedLagrangeProblem"></a> </p><h3>DistributedLagrangeProblem</h3>
<p><br  />
 In the DistributedLagrangeProblem, we need two parameters describing the dimensions of the domain \(\Gamma\) (<code>dim</code>) and of the domain \(\Omega\) (<code>spacedim</code>). <br  />
 These will be used to initialize a Triangulation&lt;dim,spacedim&gt; (for \(\Gamma\) ) and a Triangulation&lt;spacedim,spacedim&gt; (for \(\Omega\) ). <br  />
 A novelty with respect to other tutorial programs is the heavy use of std::unique_ptr. These behave like classical pointers, with the advantage of doing automatic house-keeping: the contained object is automatically destroyed as soon as the unique_ptr goes out of scope, even if it is inside a container or there's an exception. Moreover it does not allow for duplicate pointers, which prevents ownership problems. We do this, because we want to be able to i) construct the problem, ii) read the parameters, and iii) initialize all objects according to what is specified in a parameter file. <br  />
 We construct the parameters of our problem in the internal class <code>Parameters</code>, derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>. The <code>DistributedLagrangeProblem</code> class takes a const reference to a <code>Parameters</code> object, so that it is not possible to modify the parameters from within the DistributedLagrangeProblem class itself. <br  />
 We could have initialized the parameters first, and then pass the parameters to the DistributedLagrangeProblem assuming all entries are set to the desired values, but this has two disadvantages:</p>
<ul>
<li>We should not make assumptions on how the user initializes a class that is not under our direct control. If the user fails to initialize the class, we should notice and throw an exception;</li>
<li>Not all objects that need to read parameters from a parameter file may be available when we construct the Parameters; this is often the case for complex programs, with multiple physics, or where we reuse existing code in some external classes. We simulate this by keeping some "complex" objects, like ParsedFunction objects, inside the <code>DistributedLagrangeProblem</code> instead of inside the <code>Parameters</code>. <br  />
 Here we assume that upon construction, the classes that build up our problem are not usable yet. Parsing the parameter file is what ensures we have all ingredients to build up our classes, and we design them so that if parsing fails, or is not executed, the run is aborted.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim = dim&gt;</div>
<div class="line"><span class="keyword">class </span>DistributedLagrangeProblem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
</div><!-- fragment --><p>The <code>Parameters</code> class is derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>. This allows us to use the <a class="el" href="classParameterAcceptor.html#af2a534c7f1ea5bfa165fa8a469744a5d">ParameterAcceptor::add_parameter()</a> method in its constructor. <br  />
 The members of this function are all non-const, but the <code>DistributedLagrangeProblem</code> class takes a const reference to a <code>Parameters</code> object: this ensures that parameters are not modified from within the <code>DistributedLagrangeProblem</code> class.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>Parameters : <span class="keyword">public</span> <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  Parameters();</div>
</div><!-- fragment --><p>The parameters now described can all be set externally using a parameter file: if no parameter file is present when running the executable, the program will create a "parameters.prm" file with the default values defined here, and then abort to give the user a chance to modify the parameters.prm file.</p>
<p>Initial refinement for the embedding grid, corresponding to the domain \(\Omega\) .</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_refinement = 4;</div>
</div><!-- fragment --><p>The interaction between the embedded grid \(\Omega\) and the embedding grid \(\Gamma\) is handled through the computation of \(C\) , which involves all cells of \(\Omega\) overlapping with parts of \(\Gamma\) : a higher refinement of such cells might improve quality of our computations. For this reason we define <code>delta_refinement</code>: if it is greater than zero, then we mark each cell of the space grid that contains a vertex of the embedded grid and its neighbors, execute the refinement, and repeat this process <code>delta_refinement</code> times.</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> delta_refinement = 3;</div>
</div><!-- fragment --><p>Starting refinement of the embedded grid, corresponding to the domain \(\Gamma\) .</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_embedded_refinement = 8;</div>
</div><!-- fragment --><p>The list of boundary ids where we impose homogeneous Dirichlet boundary conditions. On the remaining boundary ids (if any), we impose homogeneous Neumann boundary conditions. As a default problem we have zero Dirichlet boundary conditions on \(\partial \Omega\) <br  />
</p>
<div class="fragment"><div class="line">std::list&lt;types::boundary_id&gt; homogeneous_dirichlet_ids{0, 1, 2, 3};</div>
</div><!-- fragment --><p><a class="el" href="classFiniteElement.html">FiniteElement</a> degree of the embedding space: \(V_h(\Omega)\) <br  />
</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedding_space_finite_element_degree = 1;</div>
</div><!-- fragment --><p><a class="el" href="classFiniteElement.html">FiniteElement</a> degree of the embedded space: \(Q_h(\Gamma)\) <br  />
</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_space_finite_element_degree = 1;</div>
</div><!-- fragment --><p><a class="el" href="classFiniteElement.html">FiniteElement</a> degree of the space used to describe the deformation of the embedded domain</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_configuration_finite_element_degree = 1;</div>
</div><!-- fragment --><p>Order of the quadrature formula used to integrate the coupling</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coupling_quadrature_order = 3;</div>
</div><!-- fragment --><p>If set to true, then the embedded configuration function is interpreted as a displacement function</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> use_displacement = <span class="keyword">false</span>;</div>
</div><!-- fragment --><p>Level of verbosity to use in the output</p>
<div class="fragment"><div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> verbosity_level = 10;</div>
</div><!-- fragment --><p>A flag to keep track if we were initialized or not</p>
<div class="fragment"><div class="line">  <span class="keywordtype">bool</span> <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">false</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">DistributedLagrangeProblem(<span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
</div><!-- fragment --><p>Entry point for the DistributedLagrangeProblem</p>
<div class="fragment"><div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
</div><!-- fragment --><p>Object containing the actual parameters</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
</div><!-- fragment --><p>The following functions are similar to all other tutorial programs, with the exception that we now need to set up things for two different families of objects, namely the ones related to theembedding* grids, and the ones related to theembedded* one.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> setup_grids_and_dofs();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup_embedding_dofs();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> setup_embedded_dofs();</div>
</div><!-- fragment --><p>The only unconventional function we have here is the <code>setup_coupling()</code> method, used to generate the sparsity patter for the coupling matrix \(C\) .</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> setup_coupling();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> assemble_system();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> output_results();</div>
</div><!-- fragment --><p>first we gather all the objects related to the embedding space geometry</p>
<div class="fragment"><div class="line">std::unique_ptr&lt;Triangulation&lt;spacedim&gt;&gt; space_grid;</div>
<div class="line">std::unique_ptr&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;</div>
<div class="line">                                         space_grid_tools_cache;</div>
<div class="line">std::unique_ptr&lt;FiniteElement&lt;spacedim&gt;&gt; space_fe;</div>
<div class="line">std::unique_ptr&lt;DoFHandler&lt;spacedim&gt;&gt;    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>;</div>
</div><!-- fragment --><p>Then the ones related to the embedded grid, with the <a class="el" href="classDoFHandler.html">DoFHandler</a> associated to the Lagrange multiplier <code>lambda</code></p>
<div class="fragment"><div class="line">std::unique_ptr&lt;Triangulation&lt;dim, spacedim&gt;&gt; embedded_grid;</div>
<div class="line">std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_fe;</div>
<div class="line">std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_dh;</div>
</div><!-- fragment --><p>And finally, everything that is needed todeform* the embedded triangulation</p>
<div class="fragment"><div class="line">std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_configuration_fe;</div>
<div class="line">std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_configuration_dh;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a>                                embedded_configuration;</div>
</div><!-- fragment --><p>The <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a> class is a "transparent" wrapper derived from both <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> and the type passed as its template parameter. At construction, the arguments are split into two parts: the first argument is an std::string, forwarded to the <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> class, and containing the name of the section that should be used for this class, while all the remaining arguments are forwarded to the constructor of the templated type, in this case, to the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> constructor. <br  />
 This class allows you to use existing classes in conjunction with the <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> registration mechanism, provided that those classes have the members <code><a class="el" href="data__out__base__0_8txt.html#a918b7763318d7dd4fc059a2898fe1ef6">declare_parameters()</a></code> and <code>parse_parameters()</code>. <br  />
 This is the case here, making it fairly easy to exploit the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> class: instead of requiring users to create new <a class="el" href="classFunction.html">Function</a> objects in their code for the RHS, boundary functions, etc., (like it is done in most of the other tutorials), here we allow the user to use deal.II interface to muParser (<a href="http://muparser.beltoforion.de">http://muparser.beltoforion.de</a>), where the specification of the function is not done at compile time, but at run time, using a string that is parsed into an actual <a class="el" href="classFunction.html">Function</a> object. <br  />
 In this case, the <code>embedded_configuration_function</code> is a vector valued <a class="el" href="classFunction.html">Function</a> that can be interpreted as either adeformation* or adisplacement* according to the boolean value of <code>parameters.use_displacement</code>. The number of components is specified later on in the construction.</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">  embedded_configuration_function;</div>
<div class="line"> </div>
<div class="line">std::unique_ptr&lt;Mapping&lt;dim, spacedim&gt;&gt; embedded_mapping;</div>
</div><!-- fragment --><p>We do the same thing to specify the value of the function \(g\) , which is what we want our solution to be in the embedded space. In this case the <a class="el" href="classFunction.html">Function</a> is a scalar one.</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">  embedded_value_function;</div>
</div><!-- fragment --><p>Similarly to what we have done with the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> class, we repeat the same for the <a class="el" href="classReductionControl.html">ReductionControl</a> class, allowing us to specify all possible stopping criteria for the Schur complement iterative solver we'll use later on.</p>
<div class="fragment"><div class="line"><a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;ReductionControl&gt;</a> schur_solver_control;</div>
</div><!-- fragment --><p>Next we gather all <a class="el" href="classSparsityPattern.html">SparsityPattern</a>, <a class="el" href="classSparseMatrix.html">SparseMatrix</a>, and <a class="el" href="classVector.html">Vector</a> objects we'll need</p>
<div class="fragment"><div class="line"><a class="code" href="classSparsityPattern.html">SparsityPattern</a> stiffness_sparsity;</div>
<div class="line"><a class="code" href="classSparsityPattern.html">SparsityPattern</a> coupling_sparsity;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> stiffness_matrix;</div>
<div class="line"><a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> coupling_matrix;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_rhs;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_value;</div>
</div><!-- fragment --><p>The <a class="el" href="classTimerOutput.html">TimerOutput</a> class is used to provide some statistics on the performance of our program.</p>
<div class="fragment"><div class="line">  <a class="code" href="classTimerOutput.html">TimerOutput</a> monitor;</div>
<div class="line">};</div>
</div><!-- fragment --><p><a class="anchor" id="DistributedLagrangeProblemParameters"></a> </p><h3>DistributedLagrangeProblem::Parameters</h3>
<p><br  />
 At construction time, we initialize also the <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> class, with the section name we want our problem to use when parsing the parameter file. <br  />
 Parameter files can be organized into section/subsection/etc.: this has the advantage that defined objects share parameters when sharing the same section/subsection/etc. <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> allows to specify the section name using Unix conventions on paths. If the section name starts with a slash ("/"), then the section is interpreted as anabsolute path*, <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> enters a subsection for each directory in the path, using the last name it encountered as the landing subsection for the current class. <br  />
 For example, if you construct your class using <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("/first/second/third/My Class")</code>, the parameters will be organized as follows: <br  />
 </p><div class="CodeFragmentInTutorialComment"></div><div class="CodeFragmentInTutorialComment"><div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file</span></div>
<div class="line">subsection <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div>
<div class="line">  subsection <a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div>
<div class="line">    subsection <a class="code" href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div>
<div class="line">      subsection My Class</div>
<div class="line">       ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a></div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --></div><div class="CodeFragmentInTutorialComment"> </div><p> <br  />
 Internally, thecurrent path* stored in <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> is now considered to be "/first/second/third/", i.e. when you specify an absolute path, ParameterAcceptorchanges* the current section to the current path, i.e. to the path of the section name until thelast* "/". <br  />
 You can now construct another class derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> using a relative path (e.g., <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("My Other Class")</code>) instead of the absolute one (e.g. <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("/first/second/third/My Other Class")</code>), obtaining: </p><div class="CodeFragmentInTutorialComment"></div><div class="CodeFragmentInTutorialComment"><div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file</span></div>
<div class="line">subsection <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div>
<div class="line">  subsection <a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div>
<div class="line">    subsection <a class="code" href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div>
<div class="line">      subsection My Class</div>
<div class="line">        ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a></div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">      subsection My Other Class</div>
<div class="line">        ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> MyOtherClass</div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --></div><div class="CodeFragmentInTutorialComment"> </div><p> <br  />
 If the section nameends* with a slash then subsequent classes will interpret this as a full path: for example, similar to the one above, if we have two classes, one initialized with <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("/first/second/third/My Class/")</code> and the other with <code><a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>("My Other Class")</code>, then the resulting parameter file will look like: <br  />
 </p><div class="CodeFragmentInTutorialComment"></div><div class="CodeFragmentInTutorialComment"><div class="fragment"><div class="line"><span class="preprocessor"># Example parameter file</span></div>
<div class="line">subsection <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div>
<div class="line">  subsection <a class="code" href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div>
<div class="line">    subsection <a class="code" href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div>
<div class="line">      subsection My Class</div>
<div class="line">        ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> MyClass</div>
<div class="line">        ... # notice My Class subsection <a class="code" href="multithreading__0_8txt.html#a65ecb3886ec86207a20d2f9e8e690022">does</a> <a class="code" href="work__stream__0_8txt.html#a1c121a619b3787a3c8ac4194ed595af8">not</a> <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a> <a class="code" href="coding__conventions__0_8txt.html#addd9e976d1ed783e7621bc9c390f0ac2">here</a></div>
<div class="line">        subsection My Other Class</div>
<div class="line">          ... # <a class="code" href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a> <a class="code" href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> MyOtherClass</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a> # <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> subsection My Other Class</div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a> # <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> subsection My Class</div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --></div><div class="CodeFragmentInTutorialComment"> </div><p> <br  />
 We are going to exploit this, by making our <code>Parameters</code> theparent* of all subsequently constructed classes. Since most of the other classes are members of <code>DistributedLagrangeProblem</code> this allows, for example, to construct two <code>DistributedLagrangeProblem</code> for two different dimensions, without having conflicts in the parameters for the two problems.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters::Parameters()</div>
<div class="line">  : <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a>(<span class="stringliteral">&quot;/Distributed Lagrange&lt;&quot;</span> +</div>
<div class="line">                      <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;,&quot;</span> +</div>
<div class="line">                      <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>) + <span class="stringliteral">&quot;&gt;/&quot;</span>)</div>
<div class="line">{</div>
</div><!-- fragment --><p>The <a class="el" href="classParameterAcceptor.html#af2a534c7f1ea5bfa165fa8a469744a5d">ParameterAcceptor::add_parameter()</a> function does a few things:</p>
<ul>
<li>enters the subsection specified at construction time to <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a></li>
<li>calls the ParameterAcceptor::prm.add_parameter() function</li>
<li>calls any signal you may have attached to <a class="el" href="classParameterAcceptor.html#a83d6a663cb62dffcf80155dd5dbfc5c1">ParameterAcceptor::declare_parameters_call_back</a> <br  />
</li>
<li>leaves the subsection <br  />
 In turn, ParameterAcceptor::prm.add_parameter <br  />
</li>
<li>declares an entry in the parameter handler for the given variable;</li>
<li>takes the current value of the variable</li>
<li>transforms it to a string, used as the default value for the parameter file</li>
<li>attaches anaction* to <a class="el" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a> that monitors when a file is parsed, or when an entry is set, and when this happens, it updates the value of the variable passed to <code>add_parameter()</code> by setting it to whatever was specified in the input file (of course, after the input file has been parsed and the text representation converted to the type of the variable).</li>
</ul>
<div class="fragment"><div class="line">add_parameter(<span class="stringliteral">&quot;Initial embedding space refinement&quot;</span>, initial_refinement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Initial embedded space refinement&quot;</span>,</div>
<div class="line">              initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Local refinements steps near embedded domain&quot;</span>,</div>
<div class="line">              delta_refinement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Homogeneous Dirichlet boundary ids&quot;</span>,</div>
<div class="line">              homogeneous_dirichlet_ids);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Use displacement in embedded interface&quot;</span>, use_displacement);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Embedding space finite element degree&quot;</span>,</div>
<div class="line">              embedding_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Embedded space finite element degree&quot;</span>,</div>
<div class="line">              embedded_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Embedded configuration finite element degree&quot;</span>,</div>
<div class="line">              embedded_configuration_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Coupling quadrature order&quot;</span>, coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">add_parameter(<span class="stringliteral">&quot;Verbosity level&quot;</span>, verbosity_level);</div>
</div><!-- fragment --><p>Once the parameter file has been parsed, then the parameters are good to go. Set the internal variable <code>initialized</code> to true.</p>
<div class="fragment"><div class="line">     parse_parameters_call_back.connect([&amp;]()</div>
<div class="line">  </div>
<div class="line">-&gt; <span class="keywordtype">void</span> { <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">true</span>; });</div>
<div class="line">   }</div>
</div><!-- fragment --><p>The constructor is pretty standard, with the exception of the <code><a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a></code> objects, as explained earlier.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">DistributedLagrangeProblem&lt;dim, spacedim&gt;::DistributedLagrangeProblem(</div>
<div class="line">  <span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">  : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">  , embedded_configuration_function(<span class="stringliteral">&quot;Embedded configuration&quot;</span>, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>)</div>
<div class="line">  , embedded_value_function(<span class="stringliteral">&quot;Embedded value&quot;</span>)</div>
<div class="line">  , schur_solver_control(<span class="stringliteral">&quot;Schur solver control&quot;</span>)</div>
<div class="line">  , monitor(std::cout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::summary, <a class="code" href="classTimerOutput.html">TimerOutput</a>::cpu_and_wall_times)</div>
<div class="line">{</div>
</div><!-- fragment --><p>Here is a way to set default values for a <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> class that was constructed using <a class="el" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a>. <br  />
 In this case, we set the default deformation of the embedded grid to be a circle with radius \(R\) and center \((Cx, Cy)\) , we set the default value for the embedded_value_function to be the constant one, and specify some sensible values for the <a class="el" href="classSolverControl.html">SolverControl</a> object. <br  />
 It is fundamental for \(\Gamma\) to be embedded: from the definition of \(C_{\alpha j}\) is clear that, if \(\Gamma \not\subseteq \Omega\) , certain rows of the matrix \(C\) will be zero. This would be a problem, as the Schur complement method requires \(C\) to have full column rank.</p>
<div class="fragment"><div class="line">     embedded_configuration_function.declare_parameters_call_back.connect(</div>
<div class="line">       []()</div>
<div class="line">  </div>
<div class="line">-&gt; <span class="keywordtype">void</span> {</div>
<div class="line">         <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function constants&quot;</span>, <span class="stringliteral">&quot;R=.3, Cx=.4, Cy=.4&quot;</span>);</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">         <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>,</div>
<div class="line">                                    <span class="stringliteral">&quot;R*cos(2*pi*x)+Cx; R*sin(2*pi*x)+Cy&quot;</span>);</div>
<div class="line">       });</div>
<div class="line">  </div>
<div class="line">     embedded_value_function.declare_parameters_call_back.connect(</div>
<div class="line">       []()</div>
<div class="line">  </div>
<div class="line">-&gt; <span class="keywordtype">void</span> { <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>); });</div>
<div class="line">  </div>
<div class="line">     schur_solver_control.declare_parameters_call_back.connect([]()</div>
<div class="line">  </div>
<div class="line">-&gt; <span class="keywordtype">void</span> {</div>
<div class="line">       <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Max steps&quot;</span>, <span class="stringliteral">&quot;1000&quot;</span>);</div>
<div class="line">       <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Reduction&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">       <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Tolerance&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">     });</div>
<div class="line">   }</div>
</div><!-- fragment --><p><a class="anchor" id="Setup"></a> </p><h3>Set up</h3>
<p><br  />
 The function <code>DistributedLagrangeProblem::setup_grids_and_dofs()</code> is used to set up the finite element spaces. Notice how <code>std::make_unique</code> is used to create objects wrapped inside <code>std::unique_ptr</code> objects.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_grids_and_dofs()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup grids and dofs&quot;</span>);</div>
</div><!-- fragment --><p>Initializing \(\Omega\) : constructing the <a class="el" href="classTriangulation.html">Triangulation</a> and wrapping it into a <code>std::unique_ptr</code> object</p>
<div class="fragment"><div class="line">space_grid = std::make_unique&lt;Triangulation&lt;spacedim&gt;&gt;();</div>
</div><!-- fragment --><p>Next, we actually create the triangulation using <a class="el" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube()</a>. The last argument is set to true: this activates colorization (i.e., assigning different boundary indicators to different parts of the boundary), which we use to assign the Dirichlet and Neumann conditions.</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*space_grid, 0, 1, <span class="keyword">true</span>);</div>
</div><!-- fragment --><p>Once we constructed a <a class="el" href="classTriangulation.html">Triangulation</a>, we refine it globally according to the specifications in the parameter file, and construct a <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> with it.</p>
<div class="fragment"><div class="line">space_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_refinement);</div>
<div class="line">space_grid_tools_cache =</div>
<div class="line">  std::make_unique&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;(*space_grid);</div>
</div><!-- fragment --><p>The same is done with the embedded grid. Since the embedded grid is deformed, we first need to setup the deformation mapping. We do so in the following few lines:</p>
<div class="fragment"><div class="line">embedded_grid = std::make_unique&lt;Triangulation&lt;dim, spacedim&gt;&gt;();</div>
<div class="line"><a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*embedded_grid);</div>
<div class="line">embedded_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">embedded_configuration_fe = std::make_unique&lt;FESystem&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">  <a class="code" href="classFE__Q.html">FE_Q&lt;dim, spacedim&gt;</a>(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree),</div>
<div class="line">  <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>);</div>
<div class="line"> </div>
<div class="line">embedded_configuration_dh =</div>
<div class="line">  std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line"> </div>
<div class="line">embedded_configuration_dh-&gt;distribute_dofs(*embedded_configuration_fe);</div>
<div class="line">embedded_configuration.reinit(embedded_configuration_dh-&gt;n_dofs());</div>
</div><!-- fragment --><p>Once we have defined a finite dimensional space for the deformation, we interpolate the <code>embedded_configuration_function</code> defined in the parameter file :</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_configuration_dh,</div>
<div class="line">                         embedded_configuration_function,</div>
<div class="line">                         embedded_configuration);</div>
</div><!-- fragment --><p>Now we can interpret it according to what the user has specified in the parameter file: as a displacement, in which case we construct a mapping thatdisplaces* the position of each support point of our configuration finite element space by the specified amount on the corresponding configuration vector, or as an absolution position. <br  />
 In the first case, the class <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> offers its services, while in the second one, we'll use the class <a class="el" href="classMappingFEField.html">MappingFEField</a>. They are in fact very similar. <a class="el" href="classMappingQEulerian.html">MappingQEulerian</a> will only work for systems of <a class="el" href="classFE__Q.html">FE_Q</a> finite element spaces, where the displacement vector is stored in the first <code>spacedim</code> components of the <a class="el" href="classFESystem.html">FESystem</a>, and the degree given as a parameter at construction time, must match the degree of the first <code>spacedim</code> components. <br  />
 The class <a class="el" href="classMappingFEField.html">MappingFEField</a> is slightly more general, in that it allows you to select arbitrary <a class="el" href="classFiniteElement.html">FiniteElement</a> types when constructing your approximation. Naturally some choices may (or may not) make sense, according to the type of <a class="el" href="classFiniteElement.html">FiniteElement</a> you choose. <a class="el" href="classMappingFEField.html">MappingFEField</a> implements the pure iso-parametric concept, and can be used, for example, to implement iso-geometric analysis codes in deal.II, by combining it with the <a class="el" href="classFE__Bernstein.html">FE_Bernstein</a> finite element class. In this example, we'll use the two interchangeably, by taking into account the fact that one configuration will be a <code>displacement</code>, while the other will be an absolute <code>deformation</code> field.</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.use_displacement == <span class="keyword">true</span>)</div>
<div class="line">  embedded_mapping =</div>
<div class="line">    std::make_unique&lt;MappingQEulerian&lt;dim, Vector&lt;double&gt;, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;&gt;(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree,</div>
<div class="line">     embedded_configuration_dh,</div>
<div class="line">      embedded_configuration);</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  embedded_mapping =</div>
<div class="line">    std::make_unique&lt;MappingFEField&lt;dim, spacedim, Vector&lt;double&gt;&gt;&gt;(</div>
<div class="line">     embedded_configuration_dh, embedded_configuration);</div>
<div class="line"> </div>
<div class="line">setup_embedded_dofs();</div>
</div><!-- fragment --><p>In this tutorial program we not only refine \(\Omega\) globally, but also allow a local refinement depending on the position of \(\Gamma\) , according to the value of <code>parameters.delta_refinement</code>, that we use to decide how many rounds of local refinement we should do on \(\Omega\) , corresponding to the position of \(\Gamma\) . <br  />
 With the mapping in place, it is now possible to query what is the location of all support points associated with the <code>embedded_dh</code>, by calling the method <a class="el" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>. <br  />
 This method has two variants. One that doesnot* take a <a class="el" href="classMapping.html" title="Abstract base class for mapping classes. This class declares the interface for the functionality to d...">Mapping</a>, and one that takes a <a class="el" href="classMapping.html" title="Abstract base class for mapping classes. This class declares the interface for the functionality to d...">Mapping</a>. If you use the second type, like we are doing in this case, the support points are computed through the specified mapping, which can manipulate them accordingly. <br  />
 This is precisely what the <code>embedded_mapping</code> is there for.</p>
<div class="fragment"><div class="line">std::vector&lt;Point&lt;spacedim&gt;&gt; support_points(embedded_dh-&gt;n_dofs());</div>
<div class="line"><span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement != 0)</div>
<div class="line">  <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>(*embedded_mapping,</div>
<div class="line">                                      embedded_dh,</div>
<div class="line">                                       support_points);</div>
</div><!-- fragment --><p>Once we have the support points of the embedded finite element space, we would like to identify what cells of the embedding space contain what support point, to get a chance at refining the embedding grid where it is necessary, i.e., where the embedded grid is. This can be done manually, by looping over each support point, and then calling the method <a class="el" href="classMapping.html#a38ba6aaa1745359910e1b465a0f5fb27">Mapping::transform_real_to_unit_cell</a> for each cell of the embedding space, until we find one that returns points in the unit reference cell, or it can be done in a more intelligent way. <br  />
 The <a class="el" href="namespaceGridTools.html#a2e10aeb1c8e76110a84b6945eac3aaf0">GridTools::find_active_cell_around_point</a> is a possible option that performs the above task in a cheaper way, by first identifying the closest vertex of the embedding <a class="el" href="classTriangulation.html">Triangulation</a> to the target point, and then by calling <a class="el" href="classMapping.html#a38ba6aaa1745359910e1b465a0f5fb27">Mapping::transform_real_to_unit_cell</a> only for those cells that share the found vertex. <br  />
 In fact, there are algorithms in the <a class="el" href="namespaceGridTools.html">GridTools</a> namespace that exploit a <a class="el" href="classGridTools_1_1Cache.html">GridTools::Cache</a> object, and possibly a KDTree object to speed up these operations as much as possible. <br  />
 The simplest way to exploit the maximum speed is by calling a specialized method, <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a>, that will store a lot of useful information and data structures during the first point search, and then reuse all of this for subsequent points. <br  />
 <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a> returns a tuple where the first element is a vector of cells containing the input points, in this case support_points. For refinement, this is the only information we need, and this is exactly what happens now. <br  />
 When we need to assemble a coupling matrix, however, we'll also need the reference location of each point to evaluate the basis functions of the embedding space. The other elements of the tuple returned by <a class="el" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a> allow you to reconstruct, for each point, what cell contains it, and what is the location in the reference cell of the given point. Since this information is better grouped into cells, then this is what the algorithm returns: a tuple, containing a vector of all cells that have at least one point in them, together with a list of all reference points and their corresponding index in the original vector. <br  />
 In the following loop, we will be ignoring all returned objects except the first, identifying all cells contain at least one support point of the embedded space. This allows for a simple adaptive refinement strategy: refining these cells and their neighbors. <br  />
 Notice that we need to do some sanity checks, in the sense that we want to have an embedding grid which is well refined around the embedded grid, but where two consecutive support points lie either in the same cell, or in neighbor embedding cells. <br  />
 This is only possible if we ensure that the smallest cell size of the embedding grid is nonetheless bigger than the largest cell size of the embedded grid. Since users can modify both levels of refinements, as well as the amount of local refinement they want around the embedded grid, we make sure that the resulting meshes satisfy our requirements, and if this is not the case, we bail out with an exception.</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> point_locations =</div>
<div class="line">      <a class="code" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a>(*space_grid_tools_cache,</div>
<div class="line">                                         support_points);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a> = std::get&lt;0&gt;(point_locations);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;set_refine_flag();</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a> : <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;face_indices())</div>
<div class="line">          <span class="keywordflow">if</span> (!<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;at_boundary(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>))</div>
<div class="line">            <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;neighbor(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>)-&gt;set_refine_flag();</div>
<div class="line">      }</div>
<div class="line">    space_grid-&gt;execute_coarsening_and_refinement();</div>
<div class="line">  }</div>
</div><!-- fragment --><p>In order to construct a well posed coupling interpolation operator \(C\) , there are some constraints on the relative dimension of the grids between the embedding and the embedded domains. The coupling operator \(C\) and the spaces \(V\) and \(Q\) have to satisfy an inf-sup condition in order for the problem to have a solution. It turns out that the non-matching \(L^2\) projection satisfies such inf-sup, provided that the spaces \(V\) and \(Q\) are compatible between each other (for example, provided that they are chosen to be the ones described in the introduction). <br  />
 However, thediscrete* inf-sup condition must also hold. No complications arise here, but it turns out that the discrete inf-sup constant deteriorates when the non-matching grids have local diameters that are too far away from each other. In particular, it turns out that if you choose an embedding grid which isfiner* with respect to the embedded grid, the inf-sup constant deteriorates much more than if you let the embedded grid be finer. <br  />
 In order to avoid issues, in this tutorial we will throw an exception if the parameters chosen by the user are such that the maximal diameter of the embedded grid is greater than the minimal diameter of the embedding grid. <br  />
 This choice guarantees that almost every cell of the embedded grid spans no more than two cells of the embedding grid, with some rare exceptions, that are negligible in terms of the resulting inf-sup.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> embedded_space_maximal_diameter =</div>
<div class="line">  <a class="code" href="namespaceGridTools.html#ae8409fa9cb46a0070abc4da7de0f47f2">GridTools::maximal_cell_diameter</a>(*embedded_grid,embedded_mapping);</div>
<div class="line"><span class="keywordtype">double</span> embedding_space_minimal_diameter =</div>
<div class="line">  <a class="code" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a>(*space_grid);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding minimal diameter: &quot;</span></div>
<div class="line">        &lt;&lt; embedding_space_minimal_diameter</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, embedded maximal diameter: &quot;</span></div>
<div class="line">        &lt;&lt; embedded_space_maximal_diameter &lt;&lt; <span class="stringliteral">&quot;, ratio: &quot;</span></div>
<div class="line">        &lt;&lt; embedded_space_maximal_diameter /</div>
<div class="line">             embedding_space_minimal_diameter</div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(embedded_space_maximal_diameter &lt;</div>
<div class="line">              embedding_space_minimal_diameter,</div>
<div class="line">            <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">              <span class="stringliteral">&quot;The embedding grid is too refined (or the embedded grid &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;is too coarse). Adjust the parameters so that the minimal &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;grid size of the embedding grid is larger &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;than the maximal grid size of the embedded grid.&quot;</span>));</div>
</div><!-- fragment --> <pre class="fragment">@f$\Omega@f$   has been refined and we can now set up its DoFs
</pre><div class="fragment"><div class="line">  setup_embedding_dofs();</div>
<div class="line">}</div>
</div><!-- fragment --><p>We now set up the DoFs of \(\Omega\) and \(\Gamma\) : since they are fundamentally independent (except for the fact that \(\Omega\) 's mesh is more refined "around" \(\Gamma\) ) the procedure is standard.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedding_dofs()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a> = std::make_unique&lt;DoFHandler&lt;spacedim&gt;&gt;(*space_grid);</div>
<div class="line">  space_fe = std::make_unique&lt;FE_Q&lt;spacedim&gt;&gt;(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">  <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(*space_fe);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">id</span> : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.homogeneous_dirichlet_ids)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a>(</div>
<div class="line">       <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <span class="keywordtype">id</span>, <a class="code" href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;spacedim&gt;</a>(), <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a>();</div>
</div><!-- fragment --><p>By definition the stiffness matrix involves only \(\Omega\) 's DoFs</p>
<div class="fragment"><div class="line">  <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>(), <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line">  <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, dsp, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">  stiffness_sparsity.copy_from(dsp);</div>
<div class="line">  stiffness_matrix.<a class="code" href="classSparseMatrix.html#afa7ae4d32bda6035661c9cccfe185597">reinit</a>(stiffness_sparsity);</div>
<div class="line">  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line">  <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding dofs: &quot;</span> &lt;&lt; <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>() &lt;&lt; std::endl;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedded_dofs()</div>
<div class="line">{</div>
<div class="line">  embedded_dh = std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line">  embedded_fe = std::make_unique&lt;FE_Q&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">  embedded_dh-&gt;distribute_dofs(*embedded_fe);</div>
</div><!-- fragment --><p>By definition the rhs of the system we're solving involves only a zero vector and \(G\) , which is computed using only \(\Gamma\) 's DoFs</p>
<div class="fragment"><div class="line">  <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">  embedded_rhs.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">  embedded_value.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedded dofs: &quot;</span> &lt;&lt; embedded_dh-&gt;n_dofs() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Creating the coupling sparsity pattern is a complex operation, but it can be easily done using the <a class="el" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>, which requires the two <a class="el" href="classDoFHandler.html">DoFHandler</a> objects, the quadrature points for the coupling, a <a class="el" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> (which then needs to be copied into the sparsity one, as usual), the component mask for the embedding and embedded <a class="el" href="classTriangulation.html">Triangulation</a> (which we leave empty) and the mappings for both the embedding and the embedded <a class="el" href="classTriangulation.html">Triangulation</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_coupling()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup coupling&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>(), embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>(*space_grid_tools_cache,</div>
<div class="line">                                               <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                               embedded_dh,</div>
<div class="line">                                                <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                                dsp,</div>
<div class="line">                                                <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                                <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                               embedded_mapping);</div>
<div class="line">  coupling_sparsity.copy_from(dsp);</div>
<div class="line">  coupling_matrix.reinit(coupling_sparsity);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Assembly"></a> </p><h3>Assembly</h3>
<p><br  />
 The following function creates the matrices: as noted before computing the stiffness matrix and the rhs is a standard procedure.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::assemble_system()</div>
<div class="line">{</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble system&quot;</span>);</div>
</div><!-- fragment --><p>Embedding stiffness matrix \(K\) , and the right hand side \(G\) .</p>
<div class="fragment"><div class="line">  <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixTools::create_laplace_matrix</a>(</div>
<div class="line">   <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;spacedim&gt;</a>(2 space_fe-&gt;degree + 1),</div>
<div class="line">    stiffness_matrix,</div>
<div class="line">    <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classFunction.html">Function&lt;spacedim&gt;</a><span class="keyword">&gt;</span>(<span class="keyword">nullptr</span>),</div>
<div class="line">    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceVectorTools.html#a6e325333a138893e181da47f29ac680a">VectorTools::create_right_hand_side</a>(*embedded_mapping,</div>
<div class="line">                                     embedded_dh,</div>
<div class="line">                                      <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(2 embedded_fe-&gt;degree +</div>
<div class="line">                                                  1),</div>
<div class="line">                                      embedded_value_function,</div>
<div class="line">                                      embedded_rhs);</div>
<div class="line">}</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble coupling system&quot;</span>);</div>
</div><!-- fragment --><p>To compute the coupling matrix we use the <a class="el" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a> tool, which works similarly to <a class="el" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>. <br  />
</p>
<div class="fragment"><div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line">    <a class="code" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a>(*space_grid_tools_cache,</div>
<div class="line">                                            <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                            embedded_dh,</div>
<div class="line">                                             <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                             coupling_matrix,</div>
<div class="line">                                             <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                             <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                             <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                            embedded_mapping);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_mapping,</div>
<div class="line">                            embedded_dh,</div>
<div class="line">                             embedded_value_function,</div>
<div class="line">                             embedded_value);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Solve"></a> </p><h3>Solve</h3>
<p><br  />
 All parts have been assembled: we solve the system using the Schur complement method</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">DistributedLagrangeProblem&lt;dim, spacedim&gt;::solve</a>()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Solve system&quot;</span>);</div>
</div><!-- fragment --><p>Start by creating the inverse stiffness matrix</p>
<div class="fragment"><div class="line"><a class="code" href="classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a> K_inv_umfpack;</div>
<div class="line">K_inv_umfpack.<a class="code" href="classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">initialize</a>(stiffness_matrix);</div>
</div><!-- fragment --><p>Initializing the operators, as described in the introduction</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> K  = <a class="code" href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">linear_operator</a>(stiffness_matrix);</div>
<div class="line"><span class="keyword">auto</span> Ct = <a class="code" href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">linear_operator</a>(coupling_matrix);</div>
<div class="line"><span class="keyword">auto</span> <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>  = <a class="code" href="group__LAOperators.html#ga6bdc65fb2db56230e6bc7d545e81295d">transpose_operator</a>(Ct);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> K_inv = <a class="code" href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">linear_operator</a>(K, K_inv_umfpack);</div>
</div><!-- fragment --><p>Using the Schur complement method</p>
<div class="fragment"><div class="line">  <span class="keyword">auto</span>                     S = <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a> K_inv Ct;</div>
<div class="line">  <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver_cg(schur_solver_control);</div>
<div class="line">  <span class="keyword">auto</span> S_inv = <a class="code" href="group__LAOperators.html#ga87e38fbde431397c069a88692bd24ae7">inverse_operator</a>(S, solver_cg, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> = S_inv embedded_rhs;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = K_inv Ct <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a7b3d3f295bb56d6cd6856bdc6cbe8a01">distribute</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The following function simply generates standard result output on two separate files, one for each mesh.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::output_results()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Output results&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;spacedim&gt;</a> embedding_out;</div>
<div class="line"> </div>
<div class="line">  std::ofstream embedding_out_file(<span class="stringliteral">&quot;embedding.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  embedding_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>);</div>
<div class="line">  embedding_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line">  embedding_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(</div>
<div class="line">    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">  embedding_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedding_out_file);</div>
</div><!-- fragment --><p>The only difference between the two output routines is that in the second case, we want to output the data on the current configuration, and not on the reference one. This is possible by passing the actual embedded_mapping to the <a class="el" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a> function. The mapping will take care of outputting the result on the actual deformed configuration.</p>
<div class="fragment"><div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;dim, spacedim&gt;</a> embedded_out;</div>
<div class="line"> </div>
<div class="line">  std::ofstream embedded_out_file(<span class="stringliteral">&quot;embedded.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  embedded_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*embedded_dh);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>, <span class="stringliteral">&quot;lambda&quot;</span>);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(embedded_value, <span class="stringliteral">&quot;g&quot;</span>);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(*embedded_mapping,</div>
<div class="line">                             <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">  embedded_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedded_out_file);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Similar to all other tutorial programs, the <code><a class="el" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run()</a></code> function simply calls all other methods in the correct order. Nothing special to note, except that we check if parsing was done before we actually attempt to run our program.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">DistributedLagrangeProblem&lt;dim, spacedim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initialized, <a class="code" href="group__Exceptions.html#ga426dec8d8185f1410e09a795e0b36e86">ExcNotInitialized</a>());</div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.verbosity_level);</div>
<div class="line"> </div>
<div class="line">    setup_grids_and_dofs();</div>
<div class="line">    setup_coupling();</div>
<div class="line">    assemble_system();</div>
<div class="line">    <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line">    output_results();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step60</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep60.html">Step60</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> = 1, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a> = 2;</div>
</div><!-- fragment --><p>Differently to what happens in other tutorial programs, here we use <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a> style of initialization, i.e., all objects are first constructed, and then a single call to the static method <a class="el" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a> is issued to fill all parameters of the classes that are derived from <a class="el" href="classParameterAcceptor.html">ParameterAcceptor</a>. <br  />
 We check if the user has specified a parameter file name to use when the program was launched. If so, try to read that parameter file, otherwise, try to read the file "parameters.prm". <br  />
 If the parameter file that was specified (implicitly or explicitly) does not exist, <a class="el" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a> will create one for you, and exit the program.</p>
<div class="fragment"><div class="line">      DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
<div class="line">      DistributedLagrangeProblem&lt;dim, spacedim&gt;             <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
<div class="line"> </div>
<div class="line">      std::string parameter_file;</div>
<div class="line">      <span class="keywordflow">if</span> (argc &gt; 1)</div>
<div class="line">        parameter_file = argv[1];</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        parameter_file = <span class="stringliteral">&quot;parameters.prm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a>(parameter_file, <span class="stringliteral">&quot;used_parameters.prm&quot;</span>);</div>
<div class="line">      <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>The directory in which this program is run does not contain a parameter file bydefault. On the other hand, this program wants to read its parameters from afile called parameters.prm</p>
<ul>
<li>and so, when you execute it the first time, youwill get an exception that no such file can be found: <div class="fragment"><div class="line">----------------------------------------------------</div>
<div class="line">Exception <a class="code" href="data__out__base__0_8txt.html#a1a0f08903e9f2a25a073261a20b86e26">on</a> processing:</div>
<div class="line">  </div>
<div class="line">--------------------------------------------------------</div>
<div class="line">An <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> occurred <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> line &lt;74&gt; <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a> &lt;../<a class="code" href="data__out__base__0_8txt.html#a0d0a9b5bbc80d6f0b9d863fa664d74ef">source</a>/base/parameter_acceptor.cc&gt; <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <span class="keyword">function</span></div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="table__0_8txt.html#aa22355d271761047703d8c139352814f">void ::ParameterAcceptor::initialize</a>(<span class="keyword">const</span> std::string &amp;, <span class="keyword">const</span> std::string &amp;, <span class="keyword">const</span> <a class="code" href="classParameterHandler.html#a8364dda711b93753c6809eefe2a8e827">ParameterHandler::OutputStyle</a>, ::<a class="code" href="classParameterHandler.html">ParameterHandler</a> &amp;)</div>
<div class="line"><a class="code" href="A-headers_2fe__0_8txt.html#ac58f1344c78bfcb3556c763b59c923c6">The</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#a887b88f558acbcf4a6621eb0f0d39772">violated</a> <a class="code" href="vector__tools__constraints__0_8txt.html#acb0039192ebc332fa285c0450e90388b">condition</a> was:</div>
<div class="line">    <span class="keyword">false</span></div>
<div class="line">Additional <a class="code" href="fe__vs__mapping__vs__fevalues__0_8txt.html#a4e0105c19ddbc5d3acf9aa95e2c9a082">information</a>:</div>
<div class="line">    You <a class="code" href="tensor__function__0_8txt.html#a7df5c44c3259e9ce6ab8c7d1681e8e5e">specified</a> &lt;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.prm&gt; <a class="code" href="coding__conventions__0_8txt.html#a7b1ab7a5dcacc31df12a0592293133c0">as</a> <a class="code" href="parameter__handler__0_8txt.html#a141ebbaf93668d52831bbd4ec5a1e949">input</a> <a class="code" href="coding__conventions__0_8txt.html#a676390618e4d4cade021c4edeac58b65">parameter</a> <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>, <a class="code" href="fe__nedelec__0_8txt.html#a8b7c0468fae3de73000ffc4dfafc048a">but</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> <a class="code" href="multithreading__0_8txt.html#a65ecb3886ec86207a20d2f9e8e690022">does</a> <a class="code" href="work__stream__0_8txt.html#a1c121a619b3787a3c8ac4194ed595af8">not</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a5aa168344f21991b9dfdd2e4854a305c">exist</a>. We <a class="code" href="opencascade_2utilities__0_8txt.html#a23b9c1bdc9420a32a79f19f214a53812">created</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> <span class="keywordflow">for</span> you.</div>
<div class="line">  </div>
<div class="line">--------------------------------------------------------</div>
<div class="line">  </div>
<div class="line">Aborting!</div>
<div class="line">  </div>
<div class="line">----------------------------------------------------</div>
</div><!-- fragment --></li>
</ul>
<p>However, as the error message already states, the code that triggers theexception will also generate a parameters.prm file that simply contains thedefault values for all parameters this program cares about. By inspection of theparameter file, we see the following: </p><div class="fragment"><div class="line"><span class="preprocessor"># Listing of Parameters</span></div>
<div class="line"><span class="preprocessor">#</span></div>
<div class="line">  </div>
<div class="line">---------------------</div>
<div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">Coupling</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>                    = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>        = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Homogeneous Dirichlet <a class="code" href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a> ids           = 0, 1, 2, 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 7</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Use <a class="code" href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">displacement</a> <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <span class="keyword">interface       </span>= <a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Verbosity <a class="code" href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a>                              = 10</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line"><span class="preprocessor">    # Sometimes it is convenient to use symbolic constants in the expression</span></div>
<div class="line"><span class="preprocessor">    # that describes the function, rather than having to use its numeric value</span></div>
<div class="line"><span class="preprocessor">    # everywhere the constant appears. These values can be defined using this</span></div>
<div class="line"><span class="preprocessor">    # parameter, in the form `var1=value1, var2=value2, ...&#39;.</span></div>
<div class="line"><span class="preprocessor">    #</span></div>
<div class="line"><span class="preprocessor">    # A typical example would be to set this runtime parameter to</span></div>
<div class="line"><span class="preprocessor">    # `pi=3.1415926536&#39; and then use `pi&#39; in the expression of the actual</span></div>
<div class="line"><span class="preprocessor">    # formula. (That said, for convenience this class actually defines both</span></div>
<div class="line"><span class="preprocessor">    # `pi&#39; and `Pi&#39; by default, but you get the idea.)</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.4, Cy=.4                 # <span class="keywordflow">default</span>:</div>
<div class="line">  </div>
<div class="line"><span class="preprocessor">    # The formula that denotes the function you want to evaluate for</span></div>
<div class="line"><span class="preprocessor">    # particular values of the independent variables. This expression may</span></div>
<div class="line"><span class="preprocessor">    # contain any of the usual operations such as addition or multiplication,</span></div>
<div class="line"><span class="preprocessor">    # as well as all of the common functions such as `sin&#39; or `cos&#39;. In</span></div>
<div class="line"><span class="preprocessor">    # addition, it may contain expressions like `if(x&gt;0, 1,</span></div>
<div class="line">  </div>
<div class="line">-1)<span class="stringliteral">&#39; where the</span></div>
<div class="line"><span class="stringliteral">    # expression evaluates to the second argument if the first argument is</span></div>
<div class="line"><span class="stringliteral">    # true, and to the third argument otherwise. For a full overview of</span></div>
<div class="line"><span class="stringliteral">    # possible expressions accepted see the documentation of the muparser</span></div>
<div class="line"><span class="stringliteral">    # library at http://muparser.beltoforion.de/.</span></div>
<div class="line"><span class="stringliteral">    #</span></div>
<div class="line"><span class="stringliteral">    # If the function you are describing represents a vector-valued function</span></div>
<div class="line"><span class="stringliteral">    # with multiple components, then separate the expressions for individual</span></div>
<div class="line"><span class="stringliteral">    # components by a semicolon.</span></div>
<div class="line"><span class="stringliteral">    set Function expression = R*cos(2*pi*x)+Cx; R*sin(2*pi*x)+Cy # default: 0</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">    # The names of the variables as they will be used in the function,</span></div>
<div class="line"><span class="stringliteral">    # separated by commas. By default, the names of variables at which the</span></div>
<div class="line"><span class="stringliteral">    # function will be evaluated are `x&#39;</span> (<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>), `<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a><span class="stringliteral">&#39; (in 2d) or `x,y,z&#39;</span> (<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a></div>
<div class="line"><span class="preprocessor">    # 3d) for spatial coordinates and `t&#39; for time. You can then use these</span></div>
<div class="line"><span class="preprocessor">    # variable names in your function expression and they will be replaced by</span></div>
<div class="line"><span class="preprocessor">    # the values of these variables at which the function is currently</span></div>
<div class="line"><span class="preprocessor">    # evaluated. However, you can also choose a different set of names for the</span></div>
<div class="line"><span class="preprocessor">    # independent variables at which to evaluate your function expression. For</span></div>
<div class="line"><span class="preprocessor">    # example, if you work in spherical coordinates, you may wish to set this</span></div>
<div class="line"><span class="preprocessor">    # input parameter to `r,phi,theta,t&#39; and then use these variable names in</span></div>
<div class="line"><span class="preprocessor">    # your function expression.</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  </div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line"><span class="preprocessor">    # Sometimes it is convenient to use symbolic constants in the expression</span></div>
<div class="line"><span class="preprocessor">    # that describes the function, rather than having to use its numeric value</span></div>
<div class="line"><span class="preprocessor">    # everywhere the constant appears. These values can be defined using this</span></div>
<div class="line"><span class="preprocessor">    # parameter, in the form `var1=value1, var2=value2, ...&#39;.</span></div>
<div class="line"><span class="preprocessor">    #</span></div>
<div class="line"><span class="preprocessor">    # A typical example would be to set this runtime parameter to</span></div>
<div class="line"><span class="preprocessor">    # `pi=3.1415926536&#39; and then use `pi&#39; in the expression of the actual</span></div>
<div class="line"><span class="preprocessor">    # formula. (That said, for convenience this class actually defines both</span></div>
<div class="line"><span class="preprocessor">    # `pi&#39; and `Pi&#39; by default, but you get the idea.)</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">  </div>
<div class="line"><span class="preprocessor">    # The formula that denotes the function you want to evaluate for</span></div>
<div class="line"><span class="preprocessor">    # particular values of the independent variables. This expression may</span></div>
<div class="line"><span class="preprocessor">    # contain any of the usual operations such as addition or multiplication,</span></div>
<div class="line"><span class="preprocessor">    # as well as all of the common functions such as `sin&#39; or `cos&#39;. In</span></div>
<div class="line"><span class="preprocessor">    # addition, it may contain expressions like `if(x&gt;0, 1,</span></div>
<div class="line">  </div>
<div class="line">-1)<span class="stringliteral">&#39; where the</span></div>
<div class="line"><span class="stringliteral">    # expression evaluates to the second argument if the first argument is</span></div>
<div class="line"><span class="stringliteral">    # true, and to the third argument otherwise. For a full overview of</span></div>
<div class="line"><span class="stringliteral">    # possible expressions accepted see the documentation of the muparser</span></div>
<div class="line"><span class="stringliteral">    # library at http://muparser.beltoforion.de/.</span></div>
<div class="line"><span class="stringliteral">    #</span></div>
<div class="line"><span class="stringliteral">    # If the function you are describing represents a vector-valued function</span></div>
<div class="line"><span class="stringliteral">    # with multiple components, then separate the expressions for individual</span></div>
<div class="line"><span class="stringliteral">    # components by a semicolon.</span></div>
<div class="line"><span class="stringliteral">    set Function expression = 1     # default: 0</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">    # The names of the variables as they will be used in the function,</span></div>
<div class="line"><span class="stringliteral">    # separated by commas. By default, the names of variables at which the</span></div>
<div class="line"><span class="stringliteral">    # function will be evaluated are `x&#39;</span> (<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>), `<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a><span class="stringliteral">&#39; (in 2d) or `x,y,z&#39;</span> (<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a></div>
<div class="line"><span class="preprocessor">    # 3d) for spatial coordinates and `t&#39; for time. You can then use these</span></div>
<div class="line"><span class="preprocessor">    # variable names in your function expression and they will be replaced by</span></div>
<div class="line"><span class="preprocessor">    # the values of these variables at which the function is currently</span></div>
<div class="line"><span class="preprocessor">    # evaluated. However, you can also choose a different set of names for the</span></div>
<div class="line"><span class="preprocessor">    # independent variables at which to evaluate your function expression. For</span></div>
<div class="line"><span class="preprocessor">    # example, if you work in spherical coordinates, you may wish to set this</span></div>
<div class="line"><span class="preprocessor">    # input parameter to `r,phi,theta,t&#39; and then use these variable names in</span></div>
<div class="line"><span class="preprocessor">    # your function expression.</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  </div>
<div class="line">  subsection Schur <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a> control</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log frequency = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a>   = <span class="keyword">false</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>    = <span class="keyword">true</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Max <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a>     = 1000   # <span class="keywordflow">default</span>: 100</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Reduction     = 1.e-12 # <span class="keywordflow">default</span>: 1.e-2</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a>     = 1.e-12 # <span class="keywordflow">default</span>: 1.e-10</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  </div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>If you now run the program, you will get a file called <code>used_parameters.prm</code>,containing a shorter version of the above parameters (without comments anddocumentation), documenting all parameters that were used to run your program: </p><div class="fragment"><div class="line"><span class="preprocessor"># Parameter file generated with</span></div>
<div class="line"><span class="preprocessor"># DEAL_II_PACKAGE_VERSION = 9.0.0</span></div>
<div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">Coupling</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>                    = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>        = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Homogeneous Dirichlet <a class="code" href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a> ids           = 0, 1, 2, 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 7</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Use <a class="code" href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">displacement</a> <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <span class="keyword">interface       </span>= <a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Verbosity <a class="code" href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a>                              = 10</div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.4, Cy=.4</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = R*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; R*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Schur <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a> control</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log frequency = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a>   = <span class="keyword">false</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>    = <span class="keyword">true</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Max <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a>     = 1000</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Reduction     = 1.e-12</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a>     = 1.e-12</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>The rationale behind creating first <code>parameters.prm</code> file (the first time theprogram is run) and then a <code>used_parameters.prm</code> (every other times you run theprogram), is because you may want to leave most parameters to their defaultvalues, and only modify a handful of them. For example, you could use the following (perfectly valid) parameter file withthis tutorial program: </p><div class="fragment"><div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 7</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 3</div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.4, Cy=.4</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = R*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; R*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>and you would obtain exactly the same results as in test case 1 below. <a class="anchor" id="Testcase1"></a></p><h3>Test case 1: </h3>
<p>For the default problem the value of \(u\) on \(\Gamma\) is set to the constant \(1\) :this is like imposing a constant Dirichlet boundary condition on \(\Gamma\) , seenas boundary of the portion of \(\Omega\) inside \(\Gamma\) . Similarly on \(\partial \Omega\) we have zero Dirichlet boundary conditions.</p>
<div class="twocolumn" style="width: 80%"> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.1_no_grid.png" alt="" width="500" class="inline"/> </div> </div> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.1_grid.png" alt="" width="500" class="inline"/> </div> </div> </div><p> <br  />
 The output of the program will look like the following: </p><div class="fragment"><div class="line">DEAL::Embedded <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>: 129</div>
<div class="line">DEAL::Embedding minimal <a class="code" href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">diameter</a>: 0.0110485, <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> maximal <a class="code" href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">diameter</a>: 0.00781250, ratio: 0.707107</div>
<div class="line">DEAL::Embedding <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>: 2429</div>
<div class="line">DEAL:cg::Starting <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a> 0.166266</div>
<div class="line">DEAL:cg::Convergence <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> 108 <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a> 7.65958e-13</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">+---------------------------------------------+------------+------------+</div>
<div class="line">| Total CPU <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed <a class="code" href="grid_2manifold__0_8txt.html#a02d8bd1db3a4d0b6d68a99a931ce1b83">since</a> <a class="code" href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a>          |     0.586s |            |</div>
<div class="line">|                                             |            |            |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                         | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |  CPU <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  | % <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> total |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
<div class="line">| Assemble coupling <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>        |         1 |     0.132s |        23% |</div>
<div class="line">| Assemble <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                 |         1 |    0.0733s |        12% |</div>
<div class="line">| Output results                  |         1 |     0.087s |        15% |</div>
<div class="line">| Setup coupling                  |         1 |    0.0244s |       4.2% |</div>
<div class="line">| Setup <a class="code" href="reordering__0_8txt.html#a4a9ed06a3880b1ccf188c35213698758">grids</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#acce0a318676405d57af6ef0f5cbe4ec3">and</a> <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>            |         1 |    0.0907s |        15% |</div>
<div class="line">| Solve <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                    |         1 |     0.178s |        30% |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line">+---------------------------------------------+------------+------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed <a class="code" href="grid_2manifold__0_8txt.html#a02d8bd1db3a4d0b6d68a99a931ce1b83">since</a> <a class="code" href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a>    |     0.301s |            |</div>
<div class="line">|                                             |            |            |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                         | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |  wall <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> | % <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> total |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
<div class="line">| Assemble coupling <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>        |         1 |    0.0385s |        13% |</div>
<div class="line">| Assemble <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                 |         1 |    0.0131s |       4.3% |</div>
<div class="line">| Output results                  |         1 |    0.0736s |        24% |</div>
<div class="line">| Setup coupling                  |         1 |    0.0234s |       7.7% |</div>
<div class="line">| Setup <a class="code" href="reordering__0_8txt.html#a4a9ed06a3880b1ccf188c35213698758">grids</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#acce0a318676405d57af6ef0f5cbe4ec3">and</a> <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>            |         1 |    0.0679s |        23% |</div>
<div class="line">| Solve <a class="code" href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a>                    |         1 |    0.0832s |        28% |</div>
<div class="line">+---------------------------------+-----------+------------+------------+</div>
</div><!-- fragment --><p>You may notice that, in terms of CPU time, assembling the coupling system istwice as expensive as assembling the standard Poisson system, even though thematrix is smaller. This is due to the non-matching nature of the discretization.Whether this is acceptable or not, depends on the applications. If the problem was set in a three-dimensional setting, and the immersed mesh wastime dependent, it would be much more expensive to recreate the mesh at eachstep rather than use the technique we present here. Moreover, you may be able tocreate a very fast and optimized solver on a uniformly refined square or cubicgrid, and embed the domain where you want to perform your computation using thetechnique presented here. This would require you to only have a surfacerepresentatio of your domain (a much cheaper and easier mesh to produce). To play around a little bit, we are going to complicate a little the fictitiousdomain as well as the boundary conditions we impose on it. <a class="anchor" id="Testcase2and3"></a></p><h3>Test case 2 and 3: </h3>
<p>If we use the following parameter file : </p><div class="fragment"><div class="line">subsection Distributed Lagrange&lt;1,2&gt;</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">Coupling</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a>                    = 3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a> = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedded <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> finite <a class="code" href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>        = 1</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Homogeneous Dirichlet <a class="code" href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a> ids           = 0,1,2,3</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>            = 8</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Initial embedding <a class="code" href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a> <a class="code" href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a>           = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Local refinements <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a> near <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <a class="code" href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a> = 4</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Use <a class="code" href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">displacement</a> <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a> <a class="code" href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a> <span class="keyword">interface       </span>= <a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Verbosity <a class="code" href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a>                              = 10</div>
<div class="line">  subsection Embedded <a class="code" href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  = R=.3, Cx=.5, Cy=.5, r=.1, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">w</a>=12</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = (R+r*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">w</a>*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>))*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cx; (R+r*<a class="code" href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">cos</a>(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">w</a>*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>))*<a class="code" href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">sin</a>(2*<a class="code" href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a>*<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>)+Cy</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>-.5</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line">  subsection Schur <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a> control</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log frequency = 1</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a>   = <span class="keyword">false</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Log <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>    = <span class="keyword">true</span></div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Max <a class="code" href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a>     = 100000</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Reduction     = 1.e-12</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a>     = 1.e-12</div>
<div class="line">  <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p>We get a "flowery" looking domain, where we impose a linear boundary condition \(g=x-.5\) . This test shows that the method is actually quite accurate inrecovering an exactly linear function from its boundary conditions, and eventhough the meshes are not aligned, we obtain a pretty good result. Replacing \(x-.5\) with \(2(x-.5)^2-2(y-.5)^2\) , i.e., modifying the parameter filesuch that we have </p><div class="fragment"><div class="line">...</div>
<div class="line">subsection Embedded <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a>  =</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> <a class="code" href="classFunction.html">Function</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a> = 2*(<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>-.5)^2-2*(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>-.5)^2</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a> Variable <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>      = <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>,t</div>
<div class="line"><a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div>
</div><!-- fragment --><p> produces the saddle on the right. </p><div class="twocolumn" style="width: 80%"> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.3_grid.png" alt="" width="500" class="inline"/> </div> </div> <div class="parent"> <div class="img" align="center"> <img src="https://www.dealii.org/images/steps/developer/step-60.4_grid.png" alt="" width="500" class="inline"/> </div> </div> </div><p> <br  />
 <a class="anchor" id="extensions"></a><a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p><a class="anchor" id="Runningwithspacedimequaltothree"></a></p><h4>Running with <code>spacedim</code> equal to three</h4>
<p>While the current tutorial program is written for <code>spacedim</code> equal to two, thereare only minor changes you have to do in order for the program to run indifferent combinations of dimensions. If you want to run with <code>spacedim</code> equal to three and <code>dim</code> equal to two, thenyou will almost certainly want to perform the following changes:</p>
<ul>
<li>use a different reference domain for the embedded grid, maybe reading it from a file. It is not possible to construct a smooth closed surface with one single parametrization of a square domain, therefore you'll most likely want to use a reference domain that is topologically equivalent to a the boundary of a sphere.</li>
<li>use a displacement instead of the deformation to map \(\Gamma_0\) into \(\Gamma\) <br  />
 <a class="anchor" id="Moregeneraldomains"></a><h4>More general domains </h4>
</li>
</ul>
<p>We have seen in other tutorials (for example in <a class="el" href="step_5.html">step-5</a> and <a class="el" href="step_54.html">step-54</a> ) how to readgrids from input files. A nice generalization for this tutorial program would beto allow the user to select a grid to read from the parameter file itself,instead of hardcoding the mesh type in the tutorial program itself. <a class="anchor" id="Preconditioner"></a></p><h4>Preconditioner</h4>
<p>At the moment, we have no preconditioner on the Schur complement. This is ok fortwo dimensional problems, where a few hundred iterations bring the residual downto the machine precision, but it's not going to work in three dimensions. It is not obvious what a good preconditioner would be here. The physical problemwe are solving with the Schur complement, is to associate to the Dirichlet data \(g\) , the value of the Lagrange multiplier \(\lambda\) . \(\lambda\) can beinterpreted as thejump* in the normal gradient that needs to be imposed on \(u\) across \(\Gamma\) , in order to obtain the Dirichlet data \(g\) . So \(S\) is some sort of Neumann to Dirichlet map, and we would like to have agood approximation for the Dirichlet to Neumann map. A possibility would be touse a Boundary Element approximation of the problem on \(\Gamma\) , and construct arough approximation of the hyper-singular operator for the Poisson problemassociated to \(\Gamma\) , which is precisely a Dirichlet to Neumann map. <a class="anchor" id="ParallelCode"></a></p><h4>Parallel Code </h4>
<p>The simple code proposed here can serve as a starting point for morecomplex problems which, to be solved, need to be run on parallelcode, possibly using distributed meshes (see <a class="el" href="step_17.html">step-17</a> , <a class="el" href="step_40.html">step-40</a> , and thedocumentation for <a class="el" href="classparallel_1_1shared_1_1Triangulation.html">parallel::shared::Triangulation</a> and <a class="el" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a>). <br  />
 When using non-matching grids in parallel a problem arises: to compute thematrix \(C\) a process needs information about both meshes on the same portion ofreal space but, when working with distributed meshes, this information may notbe available, because the locally owned part of the \(\Omega\) triangulationstored on a given processor may not be physically co-located with the locallyowned part of the \(\Gamma\) triangulation stored on the same processor. Various strategies can be implemented to tackle this problem:</p>
<ul>
<li>distribute the two meshes so that this constraint is satisfied;</li>
<li>use communication for the parts of real space where the constraint is not satisfied;</li>
<li>use a distributed triangulation for the embedding space, and a shared triangulation for the emdedded configuration. The latter strategy is clearly the easiest to implement, as most of thefunctions used in this tutorial program will work unchanged also in the parallelcase. Of course one could use the reversal strategy (that is, have a distributedembedded <a class="el" href="classTriangulation.html">Triangulation</a> and a shared embedding <a class="el" href="classTriangulation.html">Triangulation</a>). However, this strategy is most likely going to be more expensive, since bydefinition the embedding grid is larger than the embedded grid, and it makesmore sense to distribute the largest of the two grids, maintaining the smallestone shared among all processors.</li>
</ul>
<p><a class="anchor" id="PlainProg"></a></p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2018 - 2020 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Authors: Luca Heltai, Giovanni Alzetta,</span></div>
<div class="line"><span class="comment"> * International School for Advanced Studies, Trieste, 2018</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parameter__acceptor_8h.html">deal.II/base/parameter_acceptor.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools_8h.html">deal.II/grid/grid_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__tools__cache_8h.html">deal.II/grid/grid_tools_cache.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2fe_2fe_8h.html">deal.II/fe/fe.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q__eulerian_8h.html">deal.II/fe/mapping_q_eulerian.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__fe__field_8h.html">deal.II/fe/mapping_fe_field.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2matrix__tools_8h.html">deal.II/numerics/matrix_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="non__matching_2coupling_8h.html">deal.II/non_matching/coupling.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__matrix_8h.html">deal.II/lac/sparse_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2sparse__direct_8h.html">deal.II/lac/sparse_direct.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__cg_8h.html">deal.II/lac/solver_cg.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator_8h.html">deal.II/lac/linear_operator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2linear__operator__tools_8h.html">deal.II/lac/linear_operator_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep60.html">Step60</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim = dim&gt;</div>
<div class="line">  <span class="keyword">class </span>DistributedLagrangeProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">class </span>Parameters : <span class="keyword">public</span> <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a></div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Parameters();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_refinement = 4;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> delta_refinement = 3;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> initial_embedded_refinement = 8;</div>
<div class="line"> </div>
<div class="line">      std::list&lt;types::boundary_id&gt; homogeneous_dirichlet_ids{0, 1, 2, 3};</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedding_space_finite_element_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_space_finite_element_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> embedded_configuration_finite_element_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> coupling_quadrature_order = 3;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">bool</span> use_displacement = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> verbosity_level = 10;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">bool</span> <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">false</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    DistributedLagrangeProblem(<span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_grids_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_embedding_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_embedded_dofs();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setup_coupling();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> assemble_system();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Triangulation&lt;spacedim&gt;&gt; space_grid;</div>
<div class="line">    std::unique_ptr&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;</div>
<div class="line">                                             space_grid_tools_cache;</div>
<div class="line">    std::unique_ptr&lt;FiniteElement&lt;spacedim&gt;&gt; space_fe;</div>
<div class="line">    std::unique_ptr&lt;DoFHandler&lt;spacedim&gt;&gt;    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Triangulation&lt;dim, spacedim&gt;&gt; embedded_grid;</div>
<div class="line">    std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_fe;</div>
<div class="line">    std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_dh;</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;FiniteElement&lt;dim, spacedim&gt;&gt; embedded_configuration_fe;</div>
<div class="line">    std::unique_ptr&lt;DoFHandler&lt;dim, spacedim&gt;&gt;    embedded_configuration_dh;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>                                embedded_configuration;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">      embedded_configuration_function;</div>
<div class="line"> </div>
<div class="line">    std::unique_ptr&lt;Mapping&lt;dim, spacedim&gt;&gt; embedded_mapping;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;Functions::ParsedFunction&lt;spacedim&gt;</a>&gt;</div>
<div class="line">      embedded_value_function;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterAcceptorProxy.html">ParameterAcceptorProxy&lt;ReductionControl&gt;</a> schur_solver_control;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a> stiffness_sparsity;</div>
<div class="line">    <a class="code" href="classSparsityPattern.html">SparsityPattern</a> coupling_sparsity;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> stiffness_matrix;</div>
<div class="line">    <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> coupling_matrix;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_rhs;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> embedded_value;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> monitor;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <a class="code" href="classStep60_1_1DistributedLagrangeProblem_1_1Parameters.html#a4d6fa5f1cf54eb6b828e03848022e3a9">DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters::Parameters</a>()</div>
<div class="line">    : <a class="code" href="classParameterAcceptor.html">ParameterAcceptor</a>(<span class="stringliteral">&quot;/Distributed Lagrange&lt;&quot;</span> +</div>
<div class="line">                        <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;,&quot;</span> +</div>
<div class="line">                        <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(<a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>) + <span class="stringliteral">&quot;&gt;/&quot;</span>)</div>
<div class="line">  {</div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Initial embedding space refinement&quot;</span>, initial_refinement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Initial embedded space refinement&quot;</span>,</div>
<div class="line">                  initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Local refinements steps near embedded domain&quot;</span>,</div>
<div class="line">                  delta_refinement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Homogeneous Dirichlet boundary ids&quot;</span>,</div>
<div class="line">                  homogeneous_dirichlet_ids);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Use displacement in embedded interface&quot;</span>, use_displacement);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Embedding space finite element degree&quot;</span>,</div>
<div class="line">                  embedding_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Embedded space finite element degree&quot;</span>,</div>
<div class="line">                  embedded_space_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Embedded configuration finite element degree&quot;</span>,</div>
<div class="line">                  embedded_configuration_finite_element_degree);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Coupling quadrature order&quot;</span>, coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">    add_parameter(<span class="stringliteral">&quot;Verbosity level&quot;</span>, verbosity_level);</div>
<div class="line"> </div>
<div class="line">    parse_parameters_call_back.connect([&amp;]() -&gt; <span class="keywordtype">void</span> { <a class="code" href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a> = <span class="keyword">true</span>; });</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  DistributedLagrangeProblem&lt;dim, spacedim&gt;::DistributedLagrangeProblem(</div>
<div class="line">    <span class="keyword">const</span> Parameters &amp;<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">    : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>)</div>
<div class="line">    , embedded_configuration_function(<span class="stringliteral">&quot;Embedded configuration&quot;</span>, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>)</div>
<div class="line">    , embedded_value_function(<span class="stringliteral">&quot;Embedded value&quot;</span>)</div>
<div class="line">    , schur_solver_control(<span class="stringliteral">&quot;Schur solver control&quot;</span>)</div>
<div class="line">    , monitor(std::cout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::summary, <a class="code" href="classTimerOutput.html">TimerOutput</a>::cpu_and_wall_times)</div>
<div class="line">  {</div>
<div class="line">    embedded_configuration_function.declare_parameters_call_back.connect(</div>
<div class="line">      []() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">        <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function constants&quot;</span>, <span class="stringliteral">&quot;R=.3, Cx=.4, Cy=.4&quot;</span>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>,</div>
<div class="line">                                   <span class="stringliteral">&quot;R*cos(2*pi*x)+Cx; R*sin(2*pi*x)+Cy&quot;</span>);</div>
<div class="line">      });</div>
<div class="line"> </div>
<div class="line">    embedded_value_function.declare_parameters_call_back.connect(</div>
<div class="line">      []() -&gt; <span class="keywordtype">void</span> { <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1&quot;</span>); });</div>
<div class="line"> </div>
<div class="line">    schur_solver_control.declare_parameters_call_back.connect([]() -&gt; <span class="keywordtype">void</span> {</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Max steps&quot;</span>, <span class="stringliteral">&quot;1000&quot;</span>);</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Reduction&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a>.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Tolerance&quot;</span>, <span class="stringliteral">&quot;1.e-12&quot;</span>);</div>
<div class="line">    });</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_grids_and_dofs()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup grids and dofs&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    space_grid = std::make_unique&lt;Triangulation&lt;spacedim&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*space_grid, 0, 1, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    space_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_refinement);</div>
<div class="line">    space_grid_tools_cache =</div>
<div class="line">      std::make_unique&lt;GridTools::Cache&lt;spacedim, spacedim&gt;&gt;(*space_grid);</div>
<div class="line"> </div>
<div class="line">    embedded_grid = std::make_unique&lt;Triangulation&lt;dim, spacedim&gt;&gt;();</div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(*embedded_grid);</div>
<div class="line">    embedded_grid-&gt;refine_global(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initial_embedded_refinement);</div>
<div class="line"> </div>
<div class="line">    embedded_configuration_fe = std::make_unique&lt;FESystem&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">      <a class="code" href="classFE__Q.html">FE_Q&lt;dim, spacedim&gt;</a>(</div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree),</div>
<div class="line">      <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>);</div>
<div class="line"> </div>
<div class="line">    embedded_configuration_dh =</div>
<div class="line">      std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line"> </div>
<div class="line">    embedded_configuration_dh-&gt;distribute_dofs(*embedded_configuration_fe);</div>
<div class="line">    embedded_configuration.reinit(embedded_configuration_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_configuration_dh,</div>
<div class="line">                             embedded_configuration_function,</div>
<div class="line">                             embedded_configuration);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.use_displacement == <span class="keyword">true</span>)</div>
<div class="line">      embedded_mapping =</div>
<div class="line">        std::make_unique&lt;MappingQEulerian&lt;dim, Vector&lt;double&gt;, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a>&gt;&gt;(</div>
<div class="line">          <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_configuration_finite_element_degree,</div>
<div class="line">          *embedded_configuration_dh,</div>
<div class="line">          embedded_configuration);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      embedded_mapping =</div>
<div class="line">        std::make_unique&lt;MappingFEField&lt;dim, spacedim, Vector&lt;double&gt;&gt;&gt;(</div>
<div class="line">          *embedded_configuration_dh, embedded_configuration);</div>
<div class="line"> </div>
<div class="line">    setup_embedded_dofs();</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Point&lt;spacedim&gt;&gt; support_points(embedded_dh-&gt;n_dofs());</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement != 0)</div>
<div class="line">      <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>(*embedded_mapping,</div>
<div class="line">                                           *embedded_dh,</div>
<div class="line">                                           support_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.delta_refinement; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> point_locations =</div>
<div class="line">          <a class="code" href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a>(*space_grid_tools_cache,</div>
<div class="line">                                             support_points);</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a> = std::get&lt;0&gt;(point_locations);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>)</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;set_refine_flag();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a> : <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;face_indices())</div>
<div class="line">              <span class="keywordflow">if</span> (!<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;at_boundary(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>))</div>
<div class="line">                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;neighbor(<a class="code" href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a>)-&gt;set_refine_flag();</div>
<div class="line">          }</div>
<div class="line">        space_grid-&gt;execute_coarsening_and_refinement();</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> embedded_space_maximal_diameter =</div>
<div class="line">      <a class="code" href="namespaceGridTools.html#ae8409fa9cb46a0070abc4da7de0f47f2">GridTools::maximal_cell_diameter</a>(*embedded_grid, *embedded_mapping);</div>
<div class="line">    <span class="keywordtype">double</span> embedding_space_minimal_diameter =</div>
<div class="line">      <a class="code" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a>(*space_grid);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding minimal diameter: &quot;</span></div>
<div class="line">            &lt;&lt; embedding_space_minimal_diameter</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;, embedded maximal diameter: &quot;</span></div>
<div class="line">            &lt;&lt; embedded_space_maximal_diameter &lt;&lt; <span class="stringliteral">&quot;, ratio: &quot;</span></div>
<div class="line">            &lt;&lt; embedded_space_maximal_diameter /</div>
<div class="line">                 embedding_space_minimal_diameter</div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(embedded_space_maximal_diameter &lt;</div>
<div class="line">                  embedding_space_minimal_diameter,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line">                  <span class="stringliteral">&quot;The embedding grid is too refined (or the embedded grid &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;is too coarse). Adjust the parameters so that the minimal &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;grid size of the embedding grid is larger &quot;</span></div>
<div class="line">                  <span class="stringliteral">&quot;than the maximal grid size of the embedded grid.&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    setup_embedding_dofs();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedding_dofs()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a> = std::make_unique&lt;DoFHandler&lt;spacedim&gt;&gt;(*space_grid);</div>
<div class="line">    space_fe = std::make_unique&lt;FE_Q&lt;spacedim&gt;&gt;(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">    <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;distribute_dofs(*space_fe);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <span class="keywordtype">id</span> : <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.homogeneous_dirichlet_ids)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a>(</div>
<div class="line">          *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, <span class="keywordtype">id</span>, <a class="code" href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;spacedim&gt;</a>(), <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">      }</div>
<div class="line">    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs(), <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs());</div>
<div class="line">    <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>, dsp, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line">    stiffness_sparsity.copy_from(dsp);</div>
<div class="line">    stiffness_matrix.<a class="code" href="classSparseMatrix.html#afa7ae4d32bda6035661c9cccfe185597">reinit</a>(stiffness_sparsity);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs());</div>
<div class="line">    <a class="code" href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a>.reinit(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedding dofs: &quot;</span> &lt;&lt; <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_embedded_dofs()</div>
<div class="line">  {</div>
<div class="line">    embedded_dh = std::make_unique&lt;DoFHandler&lt;dim, spacedim&gt;&gt;(*embedded_grid);</div>
<div class="line">    embedded_fe = std::make_unique&lt;FE_Q&lt;dim, spacedim&gt;&gt;(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">    embedded_dh-&gt;distribute_dofs(*embedded_fe);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">    embedded_rhs.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line">    embedded_value.reinit(embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Embedded dofs: &quot;</span> &lt;&lt; embedded_dh-&gt;n_dofs() &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::setup_coupling()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Setup coupling&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>-&gt;n_dofs(), embedded_dh-&gt;n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a>(*space_grid_tools_cache,</div>
<div class="line">                                                  *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                                  *embedded_dh,</div>
<div class="line">                                                  <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                                  dsp,</div>
<div class="line">                                                  <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                                  <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                  <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                                  *embedded_mapping);</div>
<div class="line">    coupling_sparsity.copy_from(dsp);</div>
<div class="line">    coupling_matrix.reinit(coupling_sparsity);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::assemble_system()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble system&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixTools::create_laplace_matrix</a>(</div>
<div class="line">        *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">        <a class="code" href="classQGauss.html">QGauss&lt;spacedim&gt;</a>(2 * space_fe-&gt;degree + 1),</div>
<div class="line">        stiffness_matrix,</div>
<div class="line">        <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code" href="classFunction.html">Function&lt;spacedim&gt;</a> *<span class="keyword">&gt;</span>(<span class="keyword">nullptr</span>),</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#a6e325333a138893e181da47f29ac680a">VectorTools::create_right_hand_side</a>(*embedded_mapping,</div>
<div class="line">                                          *embedded_dh,</div>
<div class="line">                                          <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(2 * embedded_fe-&gt;degree +</div>
<div class="line">                                                      1),</div>
<div class="line">                                          embedded_value_function,</div>
<div class="line">                                          embedded_rhs);</div>
<div class="line">    }</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Assemble coupling system&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.coupling_quadrature_order);</div>
<div class="line">      <a class="code" href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a>(*space_grid_tools_cache,</div>
<div class="line">                                               *<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line">                                               *embedded_dh,</div>
<div class="line">                                               <a class="code" href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a>,</div>
<div class="line">                                               coupling_matrix,</div>
<div class="line">                                               <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>(),</div>
<div class="line">                                               <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                               <a class="code" href="classComponentMask.html">ComponentMask</a>(),</div>
<div class="line">                                               *embedded_mapping);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a>(*embedded_mapping,</div>
<div class="line">                               *embedded_dh,</div>
<div class="line">                               embedded_value_function,</div>
<div class="line">                               embedded_value);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">DistributedLagrangeProblem&lt;dim, spacedim&gt;::solve</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Solve system&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a> K_inv_umfpack;</div>
<div class="line">    K_inv_umfpack.<a class="code" href="classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">initialize</a>(stiffness_matrix);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> K  = <a class="code" href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a>(stiffness_matrix);</div>
<div class="line">    <span class="keyword">auto</span> Ct = <a class="code" href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a>(coupling_matrix);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a>  = <a class="code" href="group__LAOperators.html#ga6bdc65fb2db56230e6bc7d545e81295d">transpose_operator</a>(Ct);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> K_inv = <a class="code" href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a>(K, K_inv_umfpack);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span>                     S = <a class="code" href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a> * K_inv * Ct;</div>
<div class="line">    <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver_cg(schur_solver_control);</div>
<div class="line">    <span class="keyword">auto</span> S_inv = <a class="code" href="group__LAOperators.html#ga87e38fbde431397c069a88692bd24ae7">inverse_operator</a>(S, solver_cg, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> = S_inv * embedded_rhs;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = K_inv * Ct * <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a7b3d3f295bb56d6cd6856bdc6cbe8a01">distribute</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> DistributedLagrangeProblem&lt;dim, spacedim&gt;::output_results()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> timer_section(monitor, <span class="stringliteral">&quot;Output results&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;spacedim&gt;</a> embedding_out;</div>
<div class="line"> </div>
<div class="line">    std::ofstream embedding_out_file(<span class="stringliteral">&quot;embedding.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    embedding_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>);</div>
<div class="line">    embedding_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <span class="stringliteral">&quot;solution&quot;</span>);</div>
<div class="line">    embedding_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(</div>
<div class="line">      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedding_space_finite_element_degree);</div>
<div class="line">    embedding_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedding_out_file);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim, spacedim&gt;</a> embedded_out;</div>
<div class="line"> </div>
<div class="line">    std::ofstream embedded_out_file(<span class="stringliteral">&quot;embedded.vtu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    embedded_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(*embedded_dh);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(lambda, <span class="stringliteral">&quot;lambda&quot;</span>);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(embedded_value, <span class="stringliteral">&quot;g&quot;</span>);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(*embedded_mapping,</div>
<div class="line">                               <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.embedded_space_finite_element_degree);</div>
<div class="line">    embedded_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(embedded_out_file);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">DistributedLagrangeProblem&lt;dim, spacedim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.initialized, <a class="code" href="group__Exceptions.html#ga426dec8d8185f1410e09a795e0b36e86">ExcNotInitialized</a>());</div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>.verbosity_level);</div>
<div class="line"> </div>
<div class="line">    setup_grids_and_dofs();</div>
<div class="line">    setup_coupling();</div>
<div class="line">    assemble_system();</div>
<div class="line">    <a class="code" href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a>();</div>
<div class="line">    output_results();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step60</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep60.html">Step60</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> = 1, <a class="code" href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a> = 2;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classStep60_1_1DistributedLagrangeProblem_1_1Parameters.html">DistributedLagrangeProblem&lt;dim, spacedim&gt;::Parameters</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>;</div>
<div class="line">      DistributedLagrangeProblem&lt;dim, spacedim&gt;             <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a>);</div>
<div class="line"> </div>
<div class="line">      std::string parameter_file;</div>
<div class="line">      <span class="keywordflow">if</span> (argc &gt; 1)</div>
<div class="line">        parameter_file = argv[1];</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        parameter_file = <span class="stringliteral">&quot;parameters.prm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a>(parameter_file, <span class="stringliteral">&quot;used_parameters.prm&quot;</span>);</div>
<div class="line">      <a class="code" href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a>.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a5aa168344f21991b9dfdd2e4854a305c"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a5aa168344f21991b9dfdd2e4854a305c">exist</a></div><div class="ttdeci">******to automatic and symbolic differentiation *Below we provide a very brief introduction as to what automatic and symbolic differentiation what variations of these computational numerical schemes exist</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00010">automatic_and_symbolic_differentiation_0.txt:10</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_adeac996b7de9cb86911e504716172e83"><div class="ttname"><a href="distributed__0_8txt.html#adeac996b7de9cb86911e504716172e83">system</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data error input in integration This is because in these one typically needs access not only to[2.x.39] locally owned dofs but also to[2.x.40] locally active dofs and sometimes to[2.x.41] locally relevant and their values may not be stored in non ghosted vectors on the processor that needs them The operations listed above also only require read only access to and ghosted vectors are therefore usable in these contexts *On the other vectors without ghost entries are used in all other places like or any other form of manipulation These are typically write only operations and therefore need not have read access to vector elements that may be owned by another processor *You can copy between vectors with and without ghost the only class equipped to deal with the situation just explained is DynamicSparsityPattern A version of the function[2.x.45] exists that takes an IndexSet argument that indicates which lines of the sparsity pattern to allocate memory for In other it is safe to create such an object that will report as its size but in fact only stores only as many rows as the index set has elements You can then use the usual function[2.x.46] to build the sparsity pattern that results from assembling on the locally owned portion of the mesh The resulting object can be used to initialize a PETSc or Trilinos matrix which support very large object sizes through completely distributed storage The matrix can then be assembled by only looping over those cells owned by the current processor *The only thing to pay attention to is for which degrees of freedom the sparsity needs to store entries These in the ones we could possibly store values to in the matrix upon assembly It is clear that these are certainly the locally active degrees of it may also be possible to write to entries that are located on ghost cells you need to pass the index set that results from[2.x.47] upon initializing the sparsity pattern ***When creating the sparsity pattern as well as when assembling the linear system</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00070">distributed_0.txt:70</a></div></div>
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData&lt; dim, dim, dim, dim &gt;::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out__dof__data_8h_source.html#l01096">data_out_dof_data.h:1096</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a8364dda711b93753c6809eefe2a8e827"><div class="ttname"><a href="classParameterHandler.html#a8364dda711b93753c6809eefe2a8e827">ParameterHandler::OutputStyle</a></div><div class="ttdeci">OutputStyle</div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__handler_8h_source.html#l00845">parameter_handler.h:845</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_aa2b5a089b26d5eb6842e77a0320440b0"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a></div><div class="ttdeci">precision How many digits to use when writing the error</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00041">parsed_convergence_table_0.txt:41</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_a761f008bdeb7d94a69205ae824deefad"><div class="ttname"><a href="namespaceVectorTools.html#a761f008bdeb7d94a69205ae824deefad">VectorTools::interpolate</a></div><div class="ttdeci">void interpolate(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
<div class="ttc" id="afe_2mapping__q__eulerian_8h_html"><div class="ttname"><a href="fe_2mapping__q__eulerian_8h.html">mapping_q_eulerian.h</a></div></div>
<div class="ttc" id="atable__0_8txt_html_aa22355d271761047703d8c139352814f"><div class="ttname"><a href="table__0_8txt.html#aa22355d271761047703d8c139352814f">initialize</a></div><div class="ttdeci">and so on *This class specifically replaces attempts at higher dimensional arrays like[2.x.8] or even higher nested constructs These constructs have the disadvantage that they are hard to initialize</div><div class="ttdef"><b>Definition:</b> <a href="table__0_8txt_source.html#l00043">table_0.txt:43</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ad207fe81a5be05e18534713c2677da7b"><div class="ttname"><a href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data error input in integration This is because in these one typically needs access not only to[2.x.39] locally owned dofs but also to[2.x.40] locally active dofs and sometimes to[2.x.41] locally relevant dofs</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="afunctions__0_8txt_html_ae902d012155474413712116e310bba66"><div class="ttname"><a href="functions__0_8txt.html#ae902d012155474413712116e310bba66">problem</a></div><div class="ttdeci">namespace ::x *For time dependent boundary conditions and or right hand side functions may also change with time Since at a given time step one is usually only interested in the spatial dependence of a it would be awkward if one had to pass a value for the time variable to all methods that use function objects For the[2.x.3] function would have to take a time argument which it can use when it wants to query the value of the boundary function at a given time step it would also have to do so if we are considering a stationary problem</div><div class="ttdef"><b>Definition:</b> <a href="functions__0_8txt_source.html#l00011">functions_0.txt:11</a></div></div>
<div class="ttc" id="aclassSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__cg_8h_source.html#l00088">solver_cg.h:88</a></div></div>
<div class="ttc" id="aclassTimerOutput_1_1Scope_html"><div class="ttname"><a href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2timer_8h_source.html#l00600">timer.h:600</a></div></div>
<div class="ttc" id="abase_2parameter__acceptor_8h_html"><div class="ttname"><a href="base_2parameter__acceptor_8h.html">parameter_acceptor.h</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_a8fba07b9a84b89e6be225f5f95c3e355"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a></div><div class="ttdeci">the program is just and one can not intelligently work around that *It is sometimes useful to change the behavior of the[2.x.6] macro from aborting a program to throwing exceptions On the other exceptions are not allowed to propagate out of destructors of classes For this there is a variant of the called[2.x.7] that can be used in destructors These use cases are discussed further down below on this page **Dynamic such as whether an output file can be written to *These are things that shouldn t be checked because it is not guaranteed that a program for which the condition is satisfied in a debug mode run</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00022">exceptions_0.txt:22</a></div></div>
<div class="ttc" id="aclassFE__Q_html"><div class="ttname"><a href="classFE__Q.html">FE_Q</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__q_8h_source.html#l00587">fe_q.h:587</a></div></div>
<div class="ttc" id="aparameter__handler__0_8txt_html_a141ebbaf93668d52831bbd4ec5a1e949"><div class="ttname"><a href="parameter__handler__0_8txt.html#a141ebbaf93668d52831bbd4ec5a1e949">input</a></div><div class="ttdeci">if you have code where no sensible default value for a parameter is you can then catch and ignore this exception The parameter[2.x.43] defaulting to an empty string is used to add a documenting text to each entry which will be printed as a comment when this class is asked to write out all declarations to a stream using the for example to override an earlier default value **Attach an action to the parameter with name[2.x.46] in the current section The action needs to be a function like object that takes the value of the parameter as as well as examples The action is executed in three different even those that are not actually specified in the input the action is executed whenever the parameter with which it is associated is read from the input</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler__0_8txt_source.html#l00289">parameter_handler_0.txt:289</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a2e990f30e4c3b71e80e78084f073ca9b"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a></div><div class="ttdeci">****This class simplifies the construction of convergence tables reading the options for the generation of the table from a parameter file It provides a series of methods that can be used to compute the error given a reference exact solution or the difference between two numerical solutions or any other custom computation of the error given via[2.x.1] objects *An example usage of this class is given by ****The above code constructs a ParsedConvergenceTable that works for scalar and will produce an error table with and Linfty_norm norms of the error *Whenever a call to the methods the instance of this class inspects its parameters computes all norms specified by the parameter given at construction time possibly modified via a parameter file computes all extra column entries specified using the method and writes one row of the convergence table *Once you have finished with the a call to and to the the same code can be used to estimate the errors of mixed or multi physics e and one component for the pressure field and will produce an error table with H1 and L2 norm of the error in the velocity to write the table only to the file specified in the parameter file *By calling the method the following options will be defined in the given ParameterHandler and can be modified at run time through a parameter please cite ******Minimal constructor for ParsedConvergenceTable objects The number of components must match the number of components of the finite element space that is used to compute the errors If a component name is than it is interpreted as a vector and the errors of the repeated components are grouped together The size of the vector[2.x.3] must match the number of unique component names</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00035">parsed_convergence_table_0.txt:35</a></div></div>
<div class="ttc" id="aclassSparseDirectUMFPACK_html_a25b1d3c7dbb88158a76165a4a56a16d6"><div class="ttname"><a href="classSparseDirectUMFPACK.html#a25b1d3c7dbb88158a76165a4a56a16d6">SparseDirectUMFPACK::initialize</a></div><div class="ttdeci">void initialize(const SparsityPattern &amp;sparsity_pattern)</div><div class="ttdef"><b>Definition:</b> <a href="sparse__direct_8cc_source.html#l00049">sparse_direct.cc:49</a></div></div>
<div class="ttc" id="agrid_2grid__tools_8h_html"><div class="ttname"><a href="grid_2grid__tools_8h.html">grid_tools.h</a></div></div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="doc_2doxygen_2headers_2namespace__dealii_8h_source.html#l00026">namespace_dealii.h:26</a></div></div>
<div class="ttc" id="adata__out__base__0_8txt_html_a138febc7b9c140e5ea6f80e2ce7b44ef"><div class="ttname"><a href="data__out__base__0_8txt.html#a138febc7b9c140e5ea6f80e2ce7b44ef">boundary</a></div><div class="ttdeci">for&lt; tt &gt;&lt; tt &gt;&lt; tt &gt; etc The actual location of these points on the patch will be computed by a multilinear transformation from the vertices given for this patch For cells at the boundary</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base__0_8txt_source.html#l00011">data_out_base_0.txt:11</a></div></div>
<div class="ttc" id="atrilinos__sparse__matrix__0_8txt_html_a4fea52a6c0731b115fed61310c695914"><div class="ttname"><a href="trilinos__sparse__matrix__0_8txt.html#a4fea52a6c0731b115fed61310c695914">C</a></div><div class="ttdeci">A B&lt;/tt &gt;, or, if an optional vector argument is given,&lt; tt &gt;C=A diag(V) B&lt;/tt &gt;, where&lt; tt &gt;diag(V)&lt;/tt &gt; defines a diagonal matrix with the vector entries. This function assumes that the calling matrix&lt; tt &gt;A&lt;/tt &gt; and&lt; tt &gt;B&lt;/tt &gt; have compatible sizes. The size of&lt; tt &gt;C&lt;/tt &gt; will be set within this function. The content as well as the sparsity pattern of the matrix C will be changed by this function, so make sure that the sparsity pattern is not used somewhere else in your program. This is an expensive operation, so think twice before you use this function. *[0.x.128] *Perform the matrix-matrix multiplication with the transpose of&lt; tt &gt;this&lt;/tt &gt;, i.e.,&lt; tt &gt;C=A&lt; sup &gt;T&lt;/sup &gt; B&lt;/tt &gt;, or, if an optional vector argument is given,&lt; tt &gt;C=A&lt; sup &gt;T&lt;/sup &gt; diag(V) B&lt;/tt &gt;, where&lt; tt &gt;diag(V)&lt;/tt &gt; defines a diagonal matrix with the vector entries. This function assumes that the calling matrix&lt; tt &gt;A&lt;/tt &gt; and&lt; tt &gt;B&lt;/tt &gt; have compatible sizes. The size of&lt; tt &gt;C&lt;/tt &gt; will be set within this function. The content as well as the sparsity pattern of the matrix C will be changed by this function, so make sure that the sparsity pattern is not used somewhere else in your program. This is an expensive operation, so think twice before you use this function. *[0.x.129] *[2.x.81] Matrix norms *[0.x.130] *Return the[1.x.23]&lt; sub &gt;1&lt;/sub &gt; -norm of the matrix, that is[2.x.82],(max. sum of columns). This is the natural matrix norm that is compatible to the l1-norm for vectors, i.e.[2.x.83] .(cf. Haemmerlin-Hoffmann:Numerische Mathematik) *[0.x.131] *Return the linfty-norm of the matrix, that is[2.x.84],(max. sum of rows). This is the natural matrix norm that is compatible to the linfty-norm of vectors, i.e.[2.x.85] .(cf. Haemmerlin-Hoffmann:Numerische Mathematik) *[0.x.132] *Return the frobenius norm of the matrix, i.e. the square root of the sum of squares of all entries in the matrix. *[0.x.133] *[2.x.86] Access to underlying Trilinos data *[0.x.134] *Return a const reference to the underlying Trilinos Epetra_CrsMatrix data. *[0.x.135] *Return a const reference to the underlying Trilinos Epetra_CrsGraph data that stores the sparsity pattern of the matrix. *[0.x.136] *[2.x.87] Partitioners *[0.x.137] *Return the partitioning of the domain space of this matrix, i.e., the partitioning of the vectors this matrix has to be multiplied with. *[0.x.138] *Return the partitioning of the range space of this matrix, i.e., the partitioning of the vectors that are result from matrix-vector products. *[0.x.139] *[2.x.88] Iterators *[0.x.140] *Return an iterator pointing to the first element of the matrix. The elements accessed by iterators within each row are ordered in the way in which Trilinos stores them, though the implementation guarantees that all elements of one row are accessed before the elements of the next row. If your algorithm relies on visiting elements within one row, you will need to consult with the Trilinos documentation on the order in which it stores data. It is, however, generally not a good and long- term stable idea to rely on the order in which receive elements if you iterate over them. When you iterate over the elements of a parallel matrix, you will only be able to access the locally owned rows.(You can access the other rows as well, but they will look empty.) In that case, you probably want to call the begin() function that takes the row as an argument to limit the range of elements to loop over. *[0.x.141] *Like the function above, but for non-const matrices. *[0.x.142] *Return an iterator pointing the element past the last one of this matrix. *[0.x.143] *Like the function above, but for non-const matrices. *[0.x.144] *Return an iterator pointing to the first element of row[2.x.89] Note that if the given row is empty, i.e. does not contain any nonzero entries, then the iterator returned by this function equals&lt; tt &gt;end(r)&lt;/tt &gt;. The returned iterator may not be dereferenceable in that case if neither row[2.x.90] nor any of the following rows contain any nonzero entries. The elements accessed by iterators within each row are ordered in the way in which Trilinos stores them, though the implementation guarantees that all elements of one row are accessed before the elements of the next row. If your algorithm relies on visiting elements within one row, you will need to consult with the Trilinos documentation on the order in which it stores data. It is, however, generally not a good and long- term stable idea to rely on the order in which receive elements if you iterate over them. *[2.x.91] When you access the elements of a parallel matrix, you can only access the elements of rows that are actually stored locally.(You can access the other rows as well, but they will look empty.) Even then, if another processor has since written into, or added to, an element of the matrix that is stored on the current processor, then you will still see the old value of this entry unless you have called compress() between modifying the matrix element on the remote processor and accessing it on the current processor. See the documentation of the compress() function for more information. *[0.x.145] *Like the function above, but for non-const matrices. *[0.x.146] *Return an iterator pointing the element past the last one of row[2.x.92], or past the end of the entire sparsity pattern if none of the rows after[2.x.93] contain any entries at all. Note that the end iterator is not necessarily dereferenceable. This is in particular the case if it is the end iterator for the last row of a matrix. *[0.x.147] *Like the function above, but for non-const matrices. *[0.x.148] *[2.x.94] Input/Output *[0.x.149] *Abstract Trilinos object that helps view in ASCII other Trilinos objects. Currently this function is not implemented. TODO:Not implemented. *[0.x.150] *Print the matrix to the given stream, using the format&lt; tt &gt;(line, col) value&lt;/tt &gt;, i.e. one nonzero entry of the matrix per line. The optional flag outputs the sparsity pattern in Trilinos style, where the data is sorted according to the processor number when printed to the stream, as well as a summary of the matrix like the global size. *[0.x.151] *[2.x.95] Exceptions *[0.x.152] *Exception *[0.x.153] *Exception *[0.x.154] *Exception *[0.x.155] *Exception *[0.x.156] *Exception *[0.x.157] *Exception *[0.x.158] *For some matrix storage formats, in particular for the PETSc distributed blockmatrices, set and add operations on individual elements can not be freely mixed. Rather, one has to synchronize operations when one wants to switch from setting elements to adding to elements. BlockMatrixBase automatically synchronizes the access by calling this helper function for each block. This function ensures that the matrix is in a state that allows adding elements C</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix__0_8txt_source.html#l00330">trilinos_sparse_matrix_0.txt:330</a></div></div>
<div class="ttc" id="afe__vs__mapping__vs__fevalues__0_8txt_html_a4e0105c19ddbc5d3acf9aa95e2c9a082"><div class="ttname"><a href="fe__vs__mapping__vs__fevalues__0_8txt.html#a4e0105c19ddbc5d3acf9aa95e2c9a082">information</a></div><div class="ttdeci">*****Most people create finite but that is also just set during construction time In other people never observe FiniteElement or Mapping objects actually[1.x.1] anything **and that is completely by design *This document is therefore for those who are interested in writing finite element or mapping classes and want to understand how FEValues works and interacts with the FiniteElement and Mapping classes In the we will not make a distinction between and the term FEValues will be used generally for all three of these classes in the text below ***Before going into detail about data and control let us define which class is responsible for providing what kind of information **FEValues is an abstraction that derived from the observation that almost everything one ever does in finite element codes only requires the evaluation of finite element shape functions at quadrature points This could for the approximation of an integral of the form[1.x.4] by quadrature[1.x.5] but it is equally valid when wanting to generate graphical and this too can be written as evaluating everything at quadrature points **these quadrature points are then simply the vertices of the their at quadrature points The same is true with some geometric information</div><div class="ttdef"><b>Definition:</b> <a href="fe__vs__mapping__vs__fevalues__0_8txt_source.html#l00021">fe_vs_mapping_vs_fevalues_0.txt:21</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a8d598702a2d755352f20b4b6c3b0a9eb"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a8d598702a2d755352f20b4b6c3b0a9eb">expression</a></div><div class="ttdeci">they may later be interpreted as complex or something else for which the power and natural logarithm functions are well defined Obviously this means that there is also no assumption about which point to evaluate either the expression or its derivatives One could readily take the expression for[2.x.83] and evaluate it at[2.x.84] and then with no recomputation of the derivative expression evaluate it at[2.x.85] In the interpretation of any symbolic variable or expression</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00347">automatic_and_symbolic_differentiation_0.txt:347</a></div></div>
<div class="ttc" id="ageodynamics__0_8txt_html_a47b3a2cd492d04754f4796002e14ed13"><div class="ttname"><a href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a></div><div class="ttdeci">all others have started as modifications of one of the tutorial programs *The tutorial programs we propose to write will provide students and researchers with a reference implementation of current numerical technology such as higher order sophisticated linear and nonlinear stabilization etc Providing these as starting points for further development by others will also serve the goal of training a new generation of geodynamicists in modern numerical algorithms *In deal it is fairly simple to extend a set of equations by another for example an additional advected quantity that enters the existing equations as a right hand side or in one of the coefficients Since applications typically use blocked matrices rather than the one big matrix for everything it is also not complicated to find suitable linear solvers for augmented equations deal II is a good tool for trying out more complex formulations of or more complete models and their effects on the accuracy of solutions *deal II provides many interchangeable components that allow rapid prototyping of finite element kinds and stabilization or linear solvers For typically only a few lines of code have to be changed to replace low order by high order elements Through it becomes relatively simple to try out higher order a different block elimination solver</div><div class="ttdef"><b>Definition:</b> <a href="geodynamics__0_8txt_source.html#l00033">geodynamics_0.txt:33</a></div></div>
<div class="ttc" id="astep-1_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="step-1_8cc_source.html#l00086">step-1.cc:86</a></div></div>
<div class="ttc" id="anamespaceStep60_html"><div class="ttname"><a href="namespaceStep60.html">Step60</a></div><div class="ttdef"><b>Definition:</b> <a href="step-60_8cc_source.html#l00062">step-60.cc:62</a></div></div>
<div class="ttc" id="anamespaceMatrixCreator_html_a7b8157122064151d414dc34a22a3ca9c"><div class="ttname"><a href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a></div><div class="ttdeci">void create_laplace_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; double &gt; &amp;matrix, const Function&lt; spacedim &gt; *const a=nullptr, const AffineConstraints&lt; double &gt; &amp;constraints=AffineConstraints&lt; double &gt;())</div></div>
<div class="ttc" id="agrid_2tria_8h_html"><div class="ttname"><a href="grid_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="asolver__cg__0_8txt_html_ab8dd1e5e6028b76d234561ae8e1d22bc"><div class="ttname"><a href="solver__cg__0_8txt.html#ab8dd1e5e6028b76d234561ae8e1d22bc">steps</a></div><div class="ttdeci">*This class implements the preconditioned Conjugate but is used in many other tutorial programs as well Like all other solver it can work on any kind of vector and matrix as long as they satisfy certain and defaults to *[2.x.2] **This version of CG is taken from D Braess s book Finite Elements It requires a symmetric the projected matrix[2.x.4] is tri diagonal Since the projection is the eigenvalues of[2.x.5] approximate those of the original preconditioned matrix[2.x.6] In after[2.x.7] steps</div><div class="ttdef"><b>Definition:</b> <a href="solver__cg__0_8txt_source.html#l00010">solver_cg_0.txt:10</a></div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_a5873b8f7eeaefb5e7a99005c6c93b175"><div class="ttname"><a href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a></div><div class="ttdeci">and a mapping object that provides the Jacobian as well as its determinant Dealing with all these objects would be cumbersome and error prone *On the other these three kinds of objects almost always appear and it is in fact very rare for deal II application codes to do anything with quadrature</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00019">update_flags_0.txt:19</a></div></div>
<div class="ttc" id="afe_2fe__q_8h_html"><div class="ttname"><a href="fe_2fe__q_8h.html">fe_q.h</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2base_2utilities_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2utilities_8h.html">utilities.h</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_addd9e976d1ed783e7621bc9c390f0ac2"><div class="ttname"><a href="coding__conventions__0_8txt.html#addd9e976d1ed783e7621bc9c390f0ac2">here</a></div><div class="ttdeci">and someone else can make a mistake while calling myfunction In either I would like to write my code in such a way thaterrors ii that the compiler can alreadyfind some of the for example because the program aborts Defensiveprogramming is then a set of strategies that make these goals more likely *[2.x.85] Over we have learned a number of techniques to this some of whichwe list here</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00061">coding_conventions_0.txt:61</a></div></div>
<div class="ttc" id="abase_2timer_8h_html"><div class="ttname"><a href="base_2timer_8h.html">timer.h</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_aa2626b9a8731384418b99aaadfc1d365"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a></div><div class="ttdeci">this leads to a degree of flexibility in computations that cannot be matched by auto differentiation For one could perform the permanent substitution[2.x.86] and then recompute[2.x.87] for several different values of[2.x.88] One could also post factum express an interdependency between x and y</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00347">automatic_and_symbolic_differentiation_0.txt:347</a></div></div>
<div class="ttc" id="aphysics__0_8txt_html_a38362129af36598c1e4b4e928688ca77"><div class="ttname"><a href="physics__0_8txt.html#a38362129af36598c1e4b4e928688ca77">configuration</a></div><div class="ttdeci">******classes that relate to continuum physical fields and materials ***A collection of namespaces and utilities to assist in the construction and manipulation of data related to physical fields and materials ***Notations that reduce the order of effectively storing them in some sort of consistent compressed storage pattern An example is storing the independent components of[2.x.2] symmetric tensors of rank as a vector with and then representing the independent elements of symmetric[2.x.3] tensors of with its generalization it has wider applicability This representation is also common in the material science and FEM literature There are several variations of tensor each a slightly different structure The primary difference between the various forms of tensor notation is the weighting prescribed to the various elements of the compressed tensors This[1.x.0] has some further general insights on this topic *Jean Paul **A collection of operations to assist in the transformation of tensor quantities from the reference to spatial configuration</div><div class="ttdef"><b>Definition:</b> <a href="physics__0_8txt_source.html#l00020">physics_0.txt:20</a></div></div>
<div class="ttc" id="aclassSparseMatrix_html"><div class="ttname"><a href="classSparseMatrix.html">SparseMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_aafea668ad0c451ac7a0fae0f558c36d7"><div class="ttname"><a href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a></div><div class="ttdeci">in the area occupied by these artificial cells</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00037">distributed_0.txt:37</a></div></div>
<div class="ttc" id="adata__out__dof__data__0_8txt_html_afd3176ce3adeace4c1e28dff7b3ab16e"><div class="ttname"><a href="data__out__dof__data__0_8txt.html#afd3176ce3adeace4c1e28dff7b3ab16e">embedded</a></div><div class="ttdeci">another piece of information specified through arguments with default values is how certain output components should be i e whether each component of the data is logically an independent scalar or whether some of them together form logically a vector for memory consumption reasons It only stores a reference to so it is in your responsibility to make sure that the data vectors exist long enough *After adding all data you need to call a function which generates the you to a file *In the example an object of type DataOut was i e an object of a derived class This is necessary since the current class does not provide means to actually generate the patches only aids to store and access data Any real functionality is implemented in derived classes such as DataOut *Note that the base class of this class DataOutInterface offers several functions to ease programming with run time determinable output and also functions and classes offering ways to control the appearance of the output by setting flags for each output format ***What this class lacks is a way to produce the patches for output itself from the stored data and degree of freedom information Since this task is often application dependent it is left to derived classes For example in many applications it might be wanted to limit the depth of output to a certain number of refinement levels and write data from finer cells only in a way interpolated to coarser cells to reduce the amount of output Also it might be wanted to use different numbers of subdivisions on different cells when forming a patch for example to accomplish for different polynomial degrees of the trial space on different cells Also the output need not necessarily consist of a patch for each cell but might be made up of patches for faces of other things Take a look at derived classes to what is possible in this respect *For this it is left to a derived class to provide a function named usually which fills the *Regarding the templates of this it needs three second the dimension of the objects which the patches represent Although in most cases they are there are also classes for which this does not for example if one outputs the result of a computation exploiting rotational symmetry in the original or one might conceive that one could write a class that only outputs the solution on a cut through the domain in which case the space dimension of the output is less than that of the DoF handler The last template argument denotes the dimension of the space into which the patches are embedded</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data__0_8txt_source.html#l00092">data_out_dof_data_0.txt:92</a></div></div>
<div class="ttc" id="afe_2mapping__fe__field_8h_html"><div class="ttname"><a href="fe_2mapping__fe__field_8h.html">mapping_fe_field.h</a></div></div>
<div class="ttc" id="akinsol__0_8txt_html_a6f62a16b407bb6c63e7b27a45efe9c97"><div class="ttname"><a href="kinsol__0_8txt.html#a6f62a16b407bb6c63e7b27a45efe9c97">rhs</a></div><div class="ttdeci">**Additional parameters that can be passed to the KINSOL class **KINSOL solution strategy KINSOL includes a Newton Krylov solver(both local and global) as well as Picard and fixed point solvers. *[0.x.3] *Standard Newton iteration. *[0.x.4] *Newton iteration with linesearch. *[0.x.5] *Fixed point iteration. *[0.x.6] *Picard iteration. *[0.x.7] *Initialization parameters for KINSOL. Global parameters the computation will be aborted and an assertion will be thrown **A function object that users may supply and that is intended to prepare the linear solver for subsequent calls to in the solution of linear systems[2.x.78] The exact nature of this system depends on the SolutionStrategy that has been selected In the cases and this function is never called The or a function within the linear solver to compute Jacobian related data that is required by the linear solver It may also preprocess that data as needed for which may involve calling a generic more build preconditioners from the assembled Jacobian In any the data so generated may then be used whenever a linear system is solved The point of this function is that but only as frequently as the solver determines that it is appropriate to perform the setup task In this Jacobian related data generated by thereby saving the effort to regenerate the Jacobian matrix and a preconditioner for it whenever possible[2.x.87] current_u Current value of[2.x.88][2.x.89] current_f Current value of[2.x.90] or[2.x.91] This function should then KINSOL does not call on the internal KINSOL convergence tests then KINSOL calls then only a fixed point iteration strategy can be used Notice that this may not or may converge very slowly A call to this function should store in dst the result of[2.x.93] applied to rhs</div><div class="ttdef"><b>Definition:</b> <a href="kinsol__0_8txt_source.html#l00517">kinsol_0.txt:517</a></div></div>
<div class="ttc" id="alac_2linear__operator_8h_html"><div class="ttname"><a href="lac_2linear__operator_8h.html">linear_operator.h</a></div></div>
<div class="ttc" id="aclassComponentMask_html"><div class="ttname"><a href="classComponentMask.html">ComponentMask</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2component__mask_8h_source.html#l00080">component_mask.h:80</a></div></div>
<div class="ttc" id="agroup__LAOperators_html_ga52a70111839180da28ccfebb4c588eca"><div class="ttname"><a href="group__LAOperators.html#ga52a70111839180da28ccfebb4c588eca">linear_operator</a></div><div class="ttdeci">LinearOperator&lt; Range, Domain, Payload &gt; linear_operator(const OperatorExemplar &amp;, const Matrix &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2linear__operator_8h_source.html#l01465">linear_operator.h:1465</a></div></div>
<div class="ttc" id="aclassDataOutInterface_html_a93c780f93105e0daaa76c6c43694b4ae"><div class="ttname"><a href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">DataOutInterface&lt; patch_dim, patch_spacedim &gt;::write_vtu</a></div><div class="ttdeci">void write_vtu(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07232">data_out_base.cc:7232</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a93f65b0385560a34ec1d3c5ec5a882b8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a9132c79972fe954d265b941f34bebed9"><div class="ttname"><a href="constraints__0_8txt.html#a9132c79972fe954d265b941f34bebed9">the</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal as happens in flow problems and is handled by the[2.x.11] function or prescribed tangential as happens in electromagnetic problems and is handled by the[2.x.13] function For the former imagine for example that we are at at vertex where the normal vector has the form[2.x.14] and that the[2.x.15]</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="amatrix__free_2dof__info__0_8txt_html_a25259c0d79c0a1903d448526d900b41d"><div class="ttname"><a href="matrix__free_2dof__info__0_8txt.html#a25259c0d79c0a1903d448526d900b41d">initialized</a></div><div class="ttdeci">We set the granularity to **that is a number sufficiently large to minimize loop peel overhead within the this function always returns index If an index is not found in hp it returns *[2.x.2] *Populate the vector[2.x.3] with locally owned degrees of freedom stored on the cell block[2.x.4] If[2.x.5] is then the returned vector will contain indices required to resolve constraints The image below illustrates the output of this function for cell blocks zero and one with zero Dirichlet boundary conditions at the bottom of the domain Note that due to the presence of the DoFs returned by this function for the case i indices that are located on another get a temporary number by this and will later be assigned the correct index after all the ghost indices have been collected by the call to *[2.x.12] *This method assigns the correct indices to ghost indices from the temporary numbering employed by the[2.x.13] function The numbers are localized with respect to the MPI and ghosts start at the end of the locally owned range This we get direct access to all vector entries **This method reorders the way cells are gone through based on a given renumbering of the cells It also takes[2.x.14] cells together and interprets them as one cell as is needed for vectorization **Finds possible compression for the cell indices that we can apply for increased efficiency Run at the end of reorder_cells **Finds possible compression for the face indices that we can apply for increased efficiency Run at the end of reorder_cells **This function computes the connectivity of the currently stored indices in terms of connections between the individual cells and fills the structure into a sparsity pattern **In case face integrals are find out whether certain loops over the unknowns only access a subset of all the ghost dofs we keep in the main partitioner **Given[2.x.15] containing the index of cells of macro the index ordering can be improved for typical DG elements by interleaving the degrees of freedom from batches of which avoids the data transposition in[2.x.16] these more advanced features are not so there is only limited value of this function **Fills the array that defines how to zero selected ranges in the result vector within the cell filling the two member variables[2.x.17] vector_zero_range_list_index and[2.x.18] The intent of this pattern is to zero the vector entries in close temporal proximity to the first access and thus keeping the vector entries in cache **Return the memory consumption in bytes of this class **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **Prints a representation of the indices in the class to the given output stream **Enum for various storage variants of the indices This storage format is used to implement more efficient indexing schemes in case the underlying data structures allow for and to inform the access functions in[2.x.19] on which array to get the data from One example of more efficient storage is the enum value[2.x.20] which means that one can get the indices to all degrees of freedom of a cell by reading only the first index for each whereas all subsequent indices are merely an offset from the first index **This value indicates that no index compression was found and the only valid storage is to access all indices present on the possibly including constraints For a cell face of this index the data access in FEEvaluationBase is directed to the array[2.x.21] dof_indices with the index row_starts[cell_index *n_vectorization *n_components] first **This value indicates that the indices are interleaved for access with vectorized gather and scatter operation This storage variant is possible in case there are no constraints on the cell and the indices in the batch of cells are not pointing to the same global index in different slots of a vectorized the data access in FEEvaluationBase is directed to the array dof_indices_interleaved with the index row_starts[cell_index *n_vectorization *n_components] first **This value indicates that the indices within a cell are all and one can get the index to the cell by reading that single value for each of the cells in the cell batch For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **This value indicates that the indices with a cell are contiguous and interleaved for i the first DoF index on a cell to the four or eight cells in the vectorization batch come than the second DoF and so on the interleaving between cells implies that only the batches for vectorization can be accessed whereas there is a strided access for getting only some of the entries The two additional categories interleaved_contiguous_strided and interleaved_contiguous_mixed_strides are a consequence of this storage type The former is for faces where at least one of the two adjacent sides will break with the interleaved storage We then have to make a strided access as described in the next category The last category interleaved_contiguous_mixed_strides appears in the ghost see the more detailed description of that category below this is something that cannot be avoided in general once we interleave the indices between cells For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **Similar to interleaved_contiguous but for the case when the interleaved indices are only contiguous within the degrees of but not also over the components of a vectorized array This happens typically on faces with DG where the cells have interleaved_contiguous storage but the faces numbering is not the same as the cell s numbering For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **Similar to interleaved_contiguous_separate but for the case when the interleaved indices are not n_vectorization apart This happens typically within the ghost layer of DG where the remote owner has applied an interleaved storage and the current processor only sees some of the cells For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization including the array dof_indices_interleave_strides for the information about the actual stride **Enum used to distinguish the data arrays for the vectorization type in cells and faces **The data index for the faces designated as interior **The data index for the faces designated as exterior **The data index for the cells **Stores the dimension of the underlying DoFHandler Since the indices are not this is the variable that makes the dimension accessible in always keep a fixed number of cells with similar properties together This variable controls the number of cells batched together As opposed to the other classes which are templated on the number this class as a pure index container is not templated so we need to keep the information otherwise contained in *[2.x.22] *Stores the index storage variant of all cell and face batches The three arrays given here address the types for the faces decorated as the faces decorated with as and the so it is simpler to keep just one variable for them This also obviates keeping two rowstart vectors in sync **Stores the indices of the degrees of freedom for each cell These indices are computed in MPI index i each processor stores the locally owned indices as numbers between&lt; tt &gt;&lt;/tt &gt; and&lt; tt &gt; n_locally_owned_dofs&lt;/tt &gt; and ghost indices in the range&lt; tt &gt; n_locally_owned_dofs&lt;/tt &gt; to&lt; tt &gt; n_locally_owned_dofs n_ghost_dofs&lt;/tt &gt; The translation between this MPI index space and the global numbering of degrees of freedom is stored in the[2.x.25] data structure This array also includes the indirect contributions from which are described by the[2.x.26] field Because of variable lengths of this would be a vector of a vector we use one contiguous memory region and store the rowstart in the variable *[2.x.27] *This variable describes the position of constraints in terms of the numbering of degrees of freedom on a cell The first number stores the distance from one constrained degree of freedom to the next This allows to identify the position of constrained DoFs as we loop through the degrees of freedom of the cell when reading from or writing to a vector The second number stores the index of the constraint stored in the variable constraint_pool_data **Reordered index storage for *[2.x.28] *Compressed index storage for faster access than through[2.x.29] dof_indices used according to the description in IndexStorageVariants The three arrays given here address the types for the faces decorated as the faces decorated with as and the the faces decorated with as and the but this field allows for faster access The three arrays given here address the types for the faces decorated as the faces decorated with as and the and also includes how the ghosts look like This enables initialization of vectors based on the DoFInfo field **Vector exchanger compatible with vector_partitioner **Vector exchanger compatible with partitioners that select a subset of ghost indices to the full vector partitioner stored in[2.x.33] These partitioners are used in specialized loops that only import parts of the ghosted region for reducing the amount of communication There are five variants of the partitioner initialized</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2dof__info__0_8txt_source.html#l00130">dof_info_0.txt:130</a></div></div>
<div class="ttc" id="alac_2affine__constraints_8h_html"><div class="ttname"><a href="lac_2affine__constraints_8h.html">affine_constraints.h</a></div></div>
<div class="ttc" id="agroup__LAOperators_html_ga87e38fbde431397c069a88692bd24ae7"><div class="ttname"><a href="group__LAOperators.html#ga87e38fbde431397c069a88692bd24ae7">LinearOperator::inverse_operator</a></div><div class="ttdeci">LinearOperator&lt; Domain, Range, Payload &gt; inverse_operator(const LinearOperator&lt; Range, Domain, Payload &gt; &amp;op, Solver &amp;solver, const Preconditioner &amp;preconditioner)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2linear__operator_8h_source.html#l00746">linear_operator.h:746</a></div></div>
<div class="ttc" id="areordering__0_8txt_html_a4a9ed06a3880b1ccf188c35213698758"><div class="ttname"><a href="reordering__0_8txt.html#a4a9ed06a3880b1ccf188c35213698758">grids</a></div><div class="ttdeci">if it is not then it aborts in linear time as well *Both algorithms are described in the paper On orienting edges of unstructured two and three dimensional R M W W L ACM Transactions on Mathematical A preprint is available as *[1.x.19] **Prior to the implementation of the algorithms described we used a branch and cut algorithm initially implemented in by Wolfgang Bangerth Although it is no longer here is how it and why it doesn t always work for large meshes since its run time can be exponential in bad cases *The first observation is that although there are problems are usually local For in the second example mentioned if we had numbered the cells in a way that neighboring cells have similar cell then the amount of backtracking needed is greatly reduced in the implementation of the the first step is to renumber the cells in a Cuthill McKee and so on this represents finding zones of cells consecutively further away from the initial cells and number them in this front marching way This already greatly improves locality of problems and consequently reduced the necessary amount of backtracking *The second point is that we can use some methods to prune the which usually lead to a valid orientation of all cells very quickly *The first such method is based on the observation that if we fail to insert one cell with number then this may not be due to cell N unless N is a direct neighbor of N The reason is for the latter cannot be the case if we fail to add cell then it is not necessary to track back to cell but we can track back to the neighbor of N with the largest cell index and which has already been added this method can fail to yield a valid path through the tree if not applied with care Consider the following initially extracted from a mesh of cells generated automatically by the program BAMG(this program usually generates meshes that are quite badly balanced, often have many **- sometimes 10 or more **- neighbors of one vertex, and exposed several problems in the initial algorithm;note also that the example is in 2d where we now have the much better algorithm described above, but the same observations also apply to 3d) we will therefore find no orientation of cell in which it can be added without violation of the consistency of the triangulation According to the rule stated we track back to the neighbor with greatest which is but since its bottom line is to the its top line must be to the right as so we won t be able to find an orientation of cell such that will fit into the triangulation if we have finished all possible orientations of we track back to the neighbor of with the largest index and which has been added already This would be cell we know that the orientation of cell can t be so we conclude that there is no possible way to orient all the lines of the given cells such that they satisfy the requirements of deal II triangulations We know that this can t so it results in an exception be thrown *The bottom line of this example is that when we looked at all possible orientations of we couldn t find one such that cell could be and then decided to track back to cell We did not even attempt to turn after which it would be simple to add cell the algorithm described above has to be with the largest cell if we fail to add a cell in any orientation If we track back further because we have exhausted all possible orientations but could add the then we are not allowed to track back to one of its but have to track back only one cell index *The second method to prune the tree is that usually we cannot add a new cell since the orientation of one of its neighbors that have already been added is wrong if we may try to rotate one of the turning a neighbor means jumping to a totally different place in the tree For both one can find arguments that they will never miss a path that is valid and only skip paths that are invalid anyway *These two methods have proven extremely efficient We have been able to read very larg grids)(several ten thousands of cells) without the need to track back much. In particular</div><div class="ttdef"><b>Definition:</b> <a href="reordering__0_8txt_source.html#l00129">reordering_0.txt:129</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ac2b339f054fd752a401e197097db8cfe"><div class="ttname"><a href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a></div><div class="ttdeci">********clusters ***deal II can use multiple machines connected via MPI to parallelize in addition to the parallelization within a shared memory machine discussed in the[2.x.4] module There are essentially two ways to utilize multiple but only a share of the global sparsity and solution vector is stored on each machine ****The mesh and DoF handler are also i e each processor stores only a share of the cells and degrees of freedom No processor has knowledge of the entire or solution</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00025">distributed_0.txt:25</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_ae4e256a1298425a946574012d5b81e53"><div class="ttname"><a href="classVectorizedArray.html#ae4e256a1298425a946574012d5b81e53">VectorizedArray::sin</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; sin(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="origin_2base_2vectorization_8h_source.html#l05220">vectorization.h:5220</a></div></div>
<div class="ttc" id="adata__out__base__0_8txt_html_a0d0a9b5bbc80d6f0b9d863fa664d74ef"><div class="ttname"><a href="data__out__base__0_8txt.html#a0d0a9b5bbc80d6f0b9d863fa664d74ef">source</a></div><div class="ttdeci">several of the example programs show how to do this **All functions take a parameter which is a structure of type&lt; tt &gt; where&lt; tt &gt; X&lt;/tt &gt; is the name of the output format To find out what flags are presently read the documentation of the different structures *Note that usually the output formats used for scientific visualization programs have no or very few like Postscript or Povray need to be given a lot more since there the output file has to contain all details of the light source</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base__0_8txt_source.html#l00027">data_out_base_0.txt:27</a></div></div>
<div class="ttc" id="aparameter__handler__0_8txt_html_ad919e2b915d8e8226aef004c2d8399a8"><div class="ttname"><a href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">exception</a></div><div class="ttdeci">since default values may change in the process of program you cannot know the values of parameters not specified in the input file ****It is often convenient to have something happen as soon as a parameter value is read This could be a check that it is valid that a file that is listed in the parameter file exists **or to initiate something else in such as setting a variable outside the this action could also be initiated once all parameters are read via but it is sometimes[1.x.19] to do it right away *This is facilitated by the and can then do whatever they want with it **e save it somewhere outside the ParameterHandler in C one doesn t usually pass around the address of a but an action can be a function like object(taking a string as argument) that results from calling such as a[1.x.20] that has the form **[1.x.21] *and that is attached to a specific parameter. *A typical example of such an action would be as follows the content of the file equals the default value of the parameter the contents of files are never changed after declaration of a parameter a directory in this file system may not have a file called[2.x.20] in it In that the directory represents a subsection as declared and the directory s name will correspond to the name of the subsection It will then have no files in it at but it may have further directories in the code above will lead to a hierarchical representation of data that looks like this(the content of files is indicated at the right in a different font) this is only used when creating output for exceptions If non empty[2.x.35] is the ParameterHandler object will stop parsing lines after encountering[2.x.36] This is handy when adding extra data that shall be parsed manually If[2.x.37] the parameter handler will skip undefined sections and entries This is useful for partially parsing a parameter for example to obtain only the spatial dimension of the problem By default all entries and subsections are expected to be declared The function sets the value of all parameters it encounters in the input file to the provided value Parameters not explicitly listed in the input file are left at the value they previously which will be the default value provided to and for each parameter all associated actions that may previously have been set by or if an associated action throws an exception</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler__0_8txt_source.html#l00241">parameter_handler_0.txt:241</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData&lt; dim, dim, dim, dim &gt;::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="awork__stream__0_8txt_html_a1c121a619b3787a3c8ac4194ed595af8"><div class="ttname"><a href="work__stream__0_8txt.html#a1c121a619b3787a3c8ac4194ed595af8">not</a></div><div class="ttdeci">a large number makes sure that each thread gets a significant amount of work before the next task switch whereas a small number is better for load balancing **A class that manages calling the worker function on a number of parallel threads Note that it is in the TBB notation a filter that can run in parallel **Constructor Takes a reference to the object on which we will operate as well as a pointer to the function that will do the assembly **Work on an item **Pointer to the function that does the assembling on the sequence of cells **This flag is true if the copier stage exist If it does not</div><div class="ttdef"><b>Definition:</b> <a href="work__stream__0_8txt_source.html#l00109">work_stream_0.txt:109</a></div></div>
<div class="ttc" id="alac_2linear__operator__tools_8h_html"><div class="ttname"><a href="lac_2linear__operator__tools_8h.html">linear_operator_tools.h</a></div></div>
<div class="ttc" id="amg__0_8txt_html_a1f7a91126f3fe8004760adfc52fc5dbe"><div class="ttname"><a href="mg__0_8txt.html#a1f7a91126f3fe8004760adfc52fc5dbe">level</a></div><div class="ttdeci">which is a wrapper around Multigrid with the standard interface of deal II[2.x.9] Preconditioners PreconditionMG also uses the classes inheriting from for instance where it uses[2.x.10] and[2.x.11] which transfer between the global vector and the level vectors we have several auxiliary namely which stores an object on each level **See and[2.x.14] example programs on how to use this functionality **Using multigrid methods on adaptively refined meshes involves more infrastructure than with regular refinement in order to keep the complexity we need to decide how to do the smoothing on each level And to this we have to define what a level is in the sense of multilevel decomposition we define that a level in the multigrid sense is constituted by all cells of a certain level in the mesh hierarchy smoothing on a certain level is restricted to the subdomain which consists of cells of this level or finer This is usually referred to as smoothing The advantage of this definition that level matrices for the multigrid scheme can be assembled easily by traversing to all cells of a certain level</div><div class="ttdef"><b>Definition:</b> <a href="mg__0_8txt_source.html#l00014">mg_0.txt:14</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a676390618e4d4cade021c4edeac58b65"><div class="ttname"><a href="coding__conventions__0_8txt.html#a676390618e4d4cade021c4edeac58b65">parameter</a></div><div class="ttdeci">and someone else can make a mistake while calling myfunction In either I would like to write my code in such a way thaterrors ii that the compiler can alreadyfind some of the for example because the program aborts Defensiveprogramming is then a set of strategies that make these goals more likely *[2.x.85] Over we have learned a number of techniques to this some of whichwe list all the time As the prototypical consider a trivial implementation of vector this function will get into trouble if the two vectors do not have the same size You think it is silly to call this function with vectors of different size of course it is But it happens all the or it is reset in a different etc It happens So if you are in such an unlucky it can take a long time to figure out what s going on because you are likely to just read uninitialized or maybe you are writing to memory the[2.x.89] vector doesn t actually own Neither is going to lead to immediate termination of the but you ll probably get random errors at a later time It would be much easier if the program just stopped here right away The following implementation will do exactly and otherwise prints a string containing information encoded by the second argument and aborts the program This when you write a new program that happens to call this you will learn of your error right away and have the opportunity to fix it without ever having to seriously debug anything[2.x.91] As a general whenever you implement a new think about the[1.x.16] on parameter</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00065">coding_conventions_0.txt:65</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_adea3423146bcdda2dce143cfb4d10ae8"><div class="ttname"><a href="classVectorizedArray.html#adea3423146bcdda2dce143cfb4d10ae8">VectorizedArray::cos</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; cos(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05605">vectorization.h:5605</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_a553ca864aaf70330d9be86bc78f36d1e"><div class="ttname"><a href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">DoFHandler::distribute_dofs</a></div><div class="ttdeci">void distribute_dofs(const FiniteElement&lt; dim, spacedim &gt; &amp;fe)</div></div>
<div class="ttc" id="agroup__constraints_html_ga3b4ea7dfd313e388d868c4e4aa685799"><div class="ttname"><a href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a></div><div class="ttdeci">void make_hanging_node_constraints(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, AffineConstraints&lt; number &gt; &amp;constraints)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__constraints_8cc_source.html#l01787">dof_tools_constraints.cc:1787</a></div></div>
<div class="ttc" id="adof__tools__0_8txt_html_a3035dd98aa5693622f109eb3b8bd1012"><div class="ttname"><a href="dof__tools__0_8txt.html#a3035dd98aa5693622f109eb3b8bd1012">domain</a></div><div class="ttdeci">if your DoF was interior to the domain</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__0_8txt_source.html#l00011">dof_tools_0.txt:11</a></div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a2c36f900d9fa534947e4cca66c542244"><div class="ttname"><a href="constraints__0_8txt.html#a2c36f900d9fa534947e4cca66c542244">third</a></div><div class="ttdeci">**** third</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00061">constraints_0.txt:61</a></div></div>
<div class="ttc" id="anumerics_2vector__tools_8h_html"><div class="ttname"><a href="numerics_2vector__tools_8h.html">vector_tools.h</a></div></div>
<div class="ttc" id="aclassPreconditionIdentity_html"><div class="ttname"><a href="classPreconditionIdentity.html">PreconditionIdentity</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2precondition_8h_source.html#l00082">precondition.h:82</a></div></div>
<div class="ttc" id="aclassTimerOutput_html"><div class="ttname"><a href="classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2timer_8h_source.html#l00591">timer.h:591</a></div></div>
<div class="ttc" id="agroup__LAOperators_html_ga6b74b7ed76e4aeea2c67c0bbb03e3e24"><div class="ttname"><a href="group__LAOperators.html#ga6b74b7ed76e4aeea2c67c0bbb03e3e24">LinearOperator::linear_operator</a></div><div class="ttdeci">LinearOperator&lt; Range, Domain, Payload &gt; linear_operator(const Matrix &amp;matrix)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2linear__operator_8h_source.html#l01436">linear_operator.h:1436</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a33468e75b7ea6d2e64b7e88c6ff1217a"><div class="ttname"><a href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a></div><div class="ttdeci">namespace are implemented the way they are More information on their implementation can be found in the[2.x.72] WorkStream paper To see the WorkStream class used in practice on tasks like the ones outlined above take a look at or[2.x.78] tutorial programs *To begin given the brief description the way the[2.x.79] function could then be written is like this(note that this is not quite the correct syntax, as will be described below) we recycle these objects after they have been used by[2.x.101] and feed them back into another instance of[2.x.102]</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00171">multithreading_0.txt:171</a></div></div>
<div class="ttc" id="anamespaceSAND_1_1SolutionComponents_html_a588bfd864c527d22182866c3b0973ae5"><div class="ttname"><a href="namespaceSAND_1_1SolutionComponents.html#a588bfd864c527d22182866c3b0973ae5">SAND::SolutionComponents::displacement</a></div><div class="ttdeci">constexpr unsigned int displacement</div><div class="ttdef"><b>Definition:</b> <a href="step-79_8cc_source.html#l00068">step-79.cc:68</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a65afd93d8c47d4e8bc413fa1fac7fa83"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a65afd93d8c47d4e8bc413fa1fac7fa83">order</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of and gets compile or both ****auto_diff_1 Automatic differentiation *commonly also referred to as algorithmic is a numerical method that can be used to automatically compute the and perhaps higher order</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00019">automatic_and_symbolic_differentiation_0.txt:19</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a65ecb3886ec86207a20d2f9e8e690022"><div class="ttname"><a href="multithreading__0_8txt.html#a65ecb3886ec86207a20d2f9e8e690022">does</a></div><div class="ttdeci">threads then execute sub ranges if they are done with their steal entire or parts of sub ranges from other threads to keep busy This work is load balanced even if not every loop iteration takes equally much or if some of the CPU cores fall behind because the operating system interrupted them for some other work *The TBB library primitives for this are a bit clumsy so deal II has wrapper routines for the most frequently used operations The simplest one is akin to what the[2.x.40] does</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00082">multithreading_0.txt:82</a></div></div>
<div class="ttc" id="ageometry__and__primitives__0_8txt_html_ad687a359ee2f71b8471c9a49cc8172ad"><div class="ttname"><a href="geometry__and__primitives__0_8txt.html#ad687a359ee2f71b8471c9a49cc8172ad">space</a></div><div class="ttdeci">as the Point class is derived from tensors of but in contrast to arbitrary tensors points have the special connotation of points in space</div><div class="ttdef"><b>Definition:</b> <a href="geometry__and__primitives__0_8txt_source.html#l00007">geometry_and_primitives_0.txt:7</a></div></div>
<div class="ttc" id="avector__tools__constraints__0_8txt_html_acb0039192ebc332fa285c0450e90388b"><div class="ttname"><a href="vector__tools__constraints__0_8txt.html#acb0039192ebc332fa285c0450e90388b">condition</a></div><div class="ttdeci">*Interpolation and projection **This function computes the constraints that correspond to boundary conditions of the i normal flux constraints where[2.x.2] is a vector valued solution variable and[2.x.3] is a prescribed vector field whose normal component we want to be equal to the normal component of the solution These conditions have exactly the form handled by the AffineConstraints in that they relate a[1.x.0] of boundary degrees of freedom to a corresponding the current function creates a list of constraints that are written into an AffineConstraints container This object may already have some for example from hanging node that remains untouched These constraints have to be applied to the linear system like any other such i you have to condense the linear system with the constraints before and you have to distribute the solution vector afterwards This function treats a more general case because everything that would apply to that function also applies as a special case to the current the following discussion is relevant to both *This function doesn t make much sense so it throws an exception if[2.x.9] equals one[1.x.1] The second argument of this function denotes the first vector component in the finite element that corresponds to the vector function that you want to constrain For if we were solving a Stokes equation in and the finite element had then[2.x.11] first_vector_component needs to be zero if you intend to constraint the vector[2.x.12] On the other if we solved the Maxwell equations in and the finite element has components[2.x.13] and we want the boundary condition[2.x.14]</div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__constraints__0_8txt_source.html#l00005">vector_tools_constraints_0.txt:5</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html"><div class="ttname"><a href="base_2logstream_8h.html">logstream.h</a></div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a5abc878123b65e2a7a16e57bba0e282e"><div class="ttname"><a href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal as happens in flow problems and is handled by the[2.x.11] function or prescribed tangential as happens in electromagnetic problems and is handled by the[2.x.13] function For the former imagine for example that we are at at vertex where the normal vector has the form[2.x.14] and that and[2.x.17] components of the flow field at this vertex are associated with degrees of and Then the no normal flux condition means that we need to have the condition[2.x.18] The prescribed tangential component leads to similar constraints though there is often something on the right hand side ****If you have hanging node constraints</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="anumerics_2matrix__tools_8h_html"><div class="ttname"><a href="numerics_2matrix__tools_8h.html">matrix_tools.h</a></div></div>
<div class="ttc" id="agroup__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="avector__tools__point__value__0_8txt_html_ac7a5c2ceb5c739d5b51cc7e0eee8100a"><div class="ttname"><a href="vector__tools__point__value__0_8txt.html#ac7a5c2ceb5c739d5b51cc7e0eee8100a">solve</a></div><div class="ttdeci">*Assembling of right hand sides **Create a right hand side vector for a point source at point[2.x.1] In other it creates a vector[2.x.2] so that[2.x.3] where[2.x.4] are the shape functions described by[2.x.5] and[2.x.6] is the point at which the delta function is located Prior content of the given[2.x.7] vector is deleted This function is for the case of a scalar finite element This function is typically used in one of these two with different values for right hand sides or and then evaluate the solution at the same point every time You could do this by calling[2.x.8] after each solve</div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__point__value__0_8txt_source.html#l00015">vector_tools_point_value_0.txt:15</a></div></div>
<div class="ttc" id="aparticles_2utilities__0_8txt_html_a6ecb2efebb411e1654774e4b776fcb7a"><div class="ttname"><a href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a></div><div class="ttdeci">namespace for functions offering tools to handle ParticleHandler objects and their coupling with DoFHandler objects **Create an interpolation sparsity pattern for particles Given a triangulation representing the a particle handler of particles and a scalar finite element compute the sparsity pattern that would be necessary to assemble the matrix[1.x.0] where[2.x.3] is the finite element space associated with the space_dh</div><div class="ttdef"><b>Definition:</b> <a href="particles_2utilities__0_8txt_source.html#l00004">utilities_0.txt:4</a></div></div>
<div class="ttc" id="aclassParameterAcceptor_html_a8c735525d2865112e5d67f9ba697224e"><div class="ttname"><a href="classParameterAcceptor.html#a8c735525d2865112e5d67f9ba697224e">ParameterAcceptor::initialize</a></div><div class="ttdeci">static void initialize(const std::string &amp;filename=&quot;&quot;, const std::string &amp;output_filename=&quot;&quot;, const ParameterHandler::OutputStyle output_style_for_output_filename=ParameterHandler::Short, ParameterHandler &amp;prm=ParameterAcceptor::prm, const ParameterHandler::OutputStyle output_style_for_filename=ParameterHandler::DefaultStyle)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__acceptor_8cc_source.html#l00060">parameter_acceptor.cc:60</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="adof__tools__0_8txt_html_a9442956f28da0afe6f6e41e15e33d525"><div class="ttname"><a href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a></div><div class="ttdeci">namespace the creation of the sparsity pattern is done by the it needs to have a numbering of all those degrees of freedom that are on those parts of the boundary that we are interested in You can get this from the where[2.x.10] and[2.x.11] are indices into the and[2.x.12] is the global DoF number of a degree of freedom sitting on a remember that these flags are used as elements of tables of size[2.x.16] times[2.x.17] where each element indicates whether two components do or do not couple **Two components do not couple **Two components do couple **Two components couple only if their shape functions are both nonzero on a given face This flag is only used when computing integrals over faces of e in[2.x.18] Use[2.x.19] in general cases where gradients etc occur on face integrals **DoF couplings *[2.x.21] *Map a coupling table from the user friendly organization by components to the organization by blocks The return vector will be initialized to the correct length inside this function **Given a finite element and a table how the vector components of it couple with each compute and return a table that describes how the individual shape functions couple with each other **Same function as above for a collection of finite returning a collection of tables The function currently treats[2.x.22] the same as *[2.x.23] ***Sparsity pattern generation *[2.x.26] *Compute which entries of a matrix built on the given[2.x.27] may possibly be and create a sparsity pattern object that represents these nonzero locations This function computes the possible positions of non zero entries in the global system matrix by[1.x.3] which entries one would write to during the actual assembly of a matrix For the function assumes that each finite element basis function is non zero on a cell only if its degree of freedom is associated with the a an edge or a vertex of this cell As a result</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__0_8txt_source.html#l00049">dof_tools_0.txt:49</a></div></div>
<div class="ttc" id="aclassSparseMatrix_html_afa7ae4d32bda6035661c9cccfe185597"><div class="ttname"><a href="classSparseMatrix.html#afa7ae4d32bda6035661c9cccfe185597">SparseMatrix::reinit</a></div><div class="ttdeci">virtual void reinit(const SparsityPattern &amp;sparsity)</div></div>
<div class="ttc" id="amapping__q__cache__0_8txt_html_ad70e0fe32f41f61653b79c84cbeedbee"><div class="ttname"><a href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a></div><div class="ttdeci">*This class implements a caching strategy for objects of the MappingQ family in terms of the[2.x.0] which is used in all operations of MappingQGeneric The information of the mapping is pre computed by the[2.x.1] function *The use of this class is discussed extensively in *[2.x.2] **Constructor[2.x.3] denotes the polynomial degree of the polynomials that are used to map cells from the reference to the real cell **Copy constructor **Destructor see *[2.x.4] *Returns[2.x.5] because the preservation of vertex locations depends on the mapping handed to the where[2.x.12] is the polynomial degree of the and it must be in the order the mapping or FE_Q sort their i all[2.x.13] vertex points then the points on the and hexes according to the usual hierarchical numbering No attempt is made to validate these points except for the number of given points *If multiple threads are this function will run in invoking the function passed in several times in case[2.x.15] the user code must make sure that the typically a lambda</div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__cache__0_8txt_source.html#l00024">mapping_q_cache_0.txt:24</a></div></div>
<div class="ttc" id="anamespaceGridTools_html_a8e8bb9211264d2106758ac4d7184117e"><div class="ttname"><a href="namespaceGridTools.html#a8e8bb9211264d2106758ac4d7184117e">GridTools::compute_point_locations</a></div><div class="ttdeci">return_type compute_point_locations(const Cache&lt; dim, spacedim &gt; &amp;cache, const std::vector&lt; Point&lt; spacedim &gt;&gt; &amp;points, const typename Triangulation&lt; dim, spacedim &gt;::active_cell_iterator &amp;cell_hint=typename Triangulation&lt; dim, spacedim &gt;::active_cell_iterator())</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l05461">grid_tools.cc:5461</a></div></div>
<div class="ttc" id="aclassDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a4935a9d561ccf1937e01dcf1e4c1e4d9"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a4935a9d561ccf1937e01dcf1e4c1e4d9">Physics::Elasticity::Kinematics::w</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; w(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_a5f3fcf87333f5770d16608f67ad88d19"><div class="ttname"><a href="update__flags__0_8txt.html#a5f3fcf87333f5770d16608f67ad88d19">all</a></div><div class="ttdeci">this property does not hold for the shape functions of Raviart Thomas which must be rotated with the cell This allows further optimization of the computations underlying assembly ***Let s say you want to compute the Laplace matrix as shown above In that you need to specify the[2.x.20] the finite element requires the computation of the inverse of the full Jacobian and not just the determinant of the and to compute the inverse of the it is also necessary to compute the Jacobian matrix first *Since these are requirements that are not important to the it is not necessary to specify this in user code given a set of update the FEValues object first asks the finite element object what information it needs to compute in order to satisfy the user s request provided in the update flags The finite element object may therefore add other flags to the update FEValues then asks the mapping whether it also wants to add more flags to the list to satisfy the needs of both the user and the finite element by the FEValues object then asks both the finite element object and mapping object to create temporary structures into which they can store some temporary information that can be computed once and for all</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00026">update_flags_0.txt:26</a></div></div>
<div class="ttc" id="afe__system__0_8txt_html_aec4ff0d63baa29c5fcf5471aef3241f6"><div class="ttname"><a href="fe__system__0_8txt.html#aec4ff0d63baa29c5fcf5471aef3241f6">face_no</a></div><div class="ttdeci">we then get the vector from this temporary object immediately to pass it to the constructor of[2.x.69] destructor is called at the end of the entire expression(after the constructor of[2.x.70] has finished) and destroys the elements of the temporary vector. Voila calls[2.x.169] if&lt; tt &gt; face_no</div><div class="ttdef"><b>Definition:</b> <a href="fe__system__0_8txt_source.html#l00178">fe_system_0.txt:178</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a30a552b07accf65da90f851e25d14d1c"><div class="ttname"><a href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div><div class="ttdeci">3, where it offers following possibilities:a face(quad) being refined in x- or y-direction(in the face-intern coordinate system) separately,([2.x.79] or([2.x.80] which corresponds to([2.x.81]). Additionally, it offers the possibilities a face can have through repeated anisotropic refinement steps performed on one of the two neighboring cells. It might be possible for example, that a face(quad) is refined with[2.x.82] and afterwards the left child is again refined with[2.x.83], so that there are three active subfaces. Note, however, that only refinement cases are allowed such that each line on a face between two hexes has not more than one hanging node. Furthermore, it is not allowed that two neighboring hexes are refined such that one of the hexes refines the common face with[2.x.84] and the other hex refines that face with[2.x.85] . In fact,[2.x.86] takes care of this situation and ensures that each face of a refined cell is completely contained in a single face of neighboring cells. The following drawings explain the SubfacePossibilities and give the corresponding subface numbers:*[1.x.4] **[2.x.87] *[0.x.68] *Possible cases of faces being subdivided into subface. See documentation to the SubfacePossibilities&lt; 3 &gt; for more details on the subface possibilities. *[0.x.69] *A class that provides all possible cases a face(in the current space dimension[2.x.88] might be subdivided into subfaces. *[2.x.89] *[0.x.70] *Constructor. Take and store a value indicating a particular subface possibility in the list of possible situations specified in the base class. *[0.x.71] *Return the numeric value stored by this class. While the presence of this operator might seem dangerous, it is useful in cases where one would like to have code like&lt; code &gt;switch(subface_case)... case[2.x.90] ...&lt;/code &gt;, which can be written as&lt; code &gt;switch[2.x.91] Another application is to use an object of the current type as an index into an array dim</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00202">geometry_info_0.txt:202</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2fe_2fe_8h_html"><div class="ttname"><a href="include_2deal_8II_2fe_2fe_8h.html">fe.h</a></div></div>
<div class="ttc" id="aclassDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2dynamic__sparsity__pattern_8h_source.html#l00340">dynamic_sparsity_pattern.h:340</a></div></div>
<div class="ttc" id="aclassSparsityPattern_html"><div class="ttname"><a href="classSparsityPattern.html">SparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2sparsity__pattern_8h_source.html#l00900">sparsity_pattern.h:900</a></div></div>
<div class="ttc" id="atensor__function__0_8txt_html_a7df5c44c3259e9ce6ab8c7d1681e8e5e"><div class="ttname"><a href="tensor__function__0_8txt.html#a7df5c44c3259e9ce6ab8c7d1681e8e5e">specified</a></div><div class="ttdeci">takes the constant tensor value as an argument The reference value is copied internally An initial value for the time variable may be specified</div><div class="ttdef"><b>Definition:</b> <a href="tensor__function__0_8txt_source.html#l00038">tensor_function_0.txt:38</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_ab2562d41bb26f362043f9719a8cd9b87"><div class="ttname"><a href="namespaceVectorTools.html#ab2562d41bb26f362043f9719a8cd9b87">VectorTools::interpolate_boundary_values</a></div><div class="ttdeci">void interpolate_boundary_values(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::map&lt; types::boundary_id, const Function&lt; spacedim, number &gt; * &gt; &amp;function_map, std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
<div class="ttc" id="adata__out__base__0_8txt_html_a1a0f08903e9f2a25a073261a20b86e26"><div class="ttname"><a href="data__out__base__0_8txt.html#a1a0f08903e9f2a25a073261a20b86e26">on</a></div><div class="ttdeci">several of the example programs show how to do this **All functions take a parameter which is a structure of type&lt; tt &gt; where&lt; tt &gt; X&lt;/tt &gt; is the name of the output format To find out what flags are presently read the documentation of the different structures *Note that usually the output formats used for scientific visualization programs have no or very few like Postscript or Povray need to be given a lot more since there the output file has to contain all details of the light etc **An abstraction layer has been introduced to facilitate coding backends for additional visualization tools It is applicable for data formats separating the information into a field of a field of connection information for the grid cells and data fields *For each of these output functions are namely a format specific output stream must be following the examples of VtkStream and so on</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base__0_8txt_source.html#l00030">data_out_base_0.txt:30</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga426dec8d8185f1410e09a795e0b36e86"><div class="ttname"><a href="group__Exceptions.html#ga426dec8d8185f1410e09a795e0b36e86">StandardExceptions::ExcNotInitialized</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotInitialized()</div></div>
<div class="ttc" id="aiterators__0_8txt_html_a41759f335f88bc10c6a57cec3af958fd"><div class="ttname"><a href="iterators__0_8txt.html#a41759f335f88bc10c6a57cec3af958fd">quad</a></div><div class="ttdeci">it does so for both DoFHandler and[2.x.14] objects Note that the DoFAccessor class is derived from either TriaAccessor or the DoFAccessor class comes in two flavors one accessing degrees of freedom on the level of a cell and the other accessing the active dofs of an active cell **The DoFCellAccessor class has the same purpose and relation to DoFCellAccessor as the CellAccessor has to TriaAccessor *Except to look up member you will not usually have to deal withthe actual class names listed above Rather one uses the typedefs provided bythe mesh classes Triangulation DoFHandler and[2.x.15] as wellas the function that generate such buta hexahedron there are corresponding types and calls like[2.x.34] that act on thedimension independent geometric objects quad</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00076">iterators_0.txt:76</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_ac5d1c63883bb2a85710935e76a7dedd4"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a></div><div class="ttdeci">******to automatic and symbolic differentiation *Below we provide a very brief introduction as to what automatic and symbolic differentiation what variations of these computational numerical schemes and how they are integrated within deal II s framework The purpose of all of these schemes is to automatically compute the derivative of or approximations of it</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00010">automatic_and_symbolic_differentiation_0.txt:10</a></div></div>
<div class="ttc" id="aclassParameterAcceptorProxy_html"><div class="ttname"><a href="classParameterAcceptorProxy.html">ParameterAcceptorProxy</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__acceptor_8h_source.html#l00671">parameter_acceptor.h:671</a></div></div>
<div class="ttc" id="adofs_2dof__tools_8h_html"><div class="ttname"><a href="dofs_2dof__tools_8h.html">dof_tools.h</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160">DoFTools::Coupling</a></div><div class="ttdeci">Coupling</div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__tools_8h_source.html#l00210">dof_tools.h:210</a></div></div>
<div class="ttc" id="aclassParameterAcceptor_html_a96081d4cc985b722c9841fcf0c0e54ec"><div class="ttname"><a href="classParameterAcceptor.html#a96081d4cc985b722c9841fcf0c0e54ec">ParameterAcceptor::prm</a></div><div class="ttdeci">static ParameterHandler prm</div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__acceptor_8h_source.html#l00521">parameter_acceptor.h:521</a></div></div>
<div class="ttc" id="afe_2fe__system_8h_html"><div class="ttname"><a href="fe_2fe__system_8h.html">fe_system.h</a></div></div>
<div class="ttc" id="alac_2precondition_8h_html"><div class="ttname"><a href="lac_2precondition_8h.html">precondition.h</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_a602682024ec652b990be121b5665f8ce"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#a602682024ec652b990be121b5665f8ce">set</a></div><div class="ttdeci">&lt;/tt &gt; **If the&lt; tt &gt;&lt;/tt &gt; preprocessor directive is set</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00031">exceptions_0.txt:31</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_a2b24e414d1a0d32deea919c5e8899811"><div class="ttname"><a href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div><div class="ttdeci">([1.x.8]&lt; sub &gt;1&lt;/sub &gt;, [1.x.9]&lt; sub &gt;2&lt;/sub &gt;, [1.x.10]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt; and[1.x.11] accordingly. Then, we can write the simplified equation in coordinates as[1.x.12] We see, that this is just three copies of the bilinear form of the Laplacian, one applied to each component(this is where the formulation with the[2.x.33] is more exciting, and we want to derive a framework that applies to that one as well). We can make this weak form a system of differential equations again by choosing special test functions:first, choose[1.x.13]=([1.x.14]&lt; sub &gt;1&lt;/sub &gt;, 0, 0)&lt; sup &gt;T&lt;/sup &gt;, then[1.x.15]=(0, [1.x.16]&lt; sub &gt;2&lt;/sub &gt;, 0)&lt; sup &gt;T&lt;/sup &gt;, and finally[1.x.17]=(0, 0, [1.x.18]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt;. writing the outcomes below each other, we obtain the system[1.x.19] where we used the standard inner product notation[2.x.34] . It is important for our understanding, that we keep in mind that the latter form as a system of PDE is completely equivalent to the original definition of the bilinear form[1.x.20]([1.x.21], [1.x.22]), which does not immediately exhibit this system structure. Let us close by writing the full system of the elastic equation with symmetric gradient[1.x.23]:[1.x.24] Very formally, if we believe in operator valued matrices, we can rewrite this in the form[1.x.25]&lt; sup &gt;T&lt;/sup &gt;[1.x.26]=[1.x.27]&lt; sup &gt;T&lt;/sup &gt;[1.x.28] or[1.x.29] *[1.x.30] Now, let us consider a more complex example, the mixed Laplace equations discussed in[2.x.35] in three dimensions:[1.x.31] **Here, we have four solution components:the scalar pressure[2.x.36] and the vector-valued velocity[2.x.37] with three vector components. Note as important difference to the previous example, that the vector space[1.x.32] is not just simply a copy of three identical spaces/*A systematic way to get a weak or variational form for this and other vector problems is to first consider it as a problem where the operators and solution variables are written in vector and matrix form. For the example, this would read as follows:[1.x.33] **This makes it clear that the solution[1.x.34] *indeed has four components. We note that we could change the ordering of the solution components[2.x.38] and[2.x.39] inside[2.x.40] if we also change columns of the matrix operator.*Next, we need to think about test functions[2.x.41] . We want to multiply both sides of the equation with them, then integrate over[2.x.42] . The result should be a scalar equality. We can achieve this by choosing[2.x.43] also vector valued as[1.x.35] **It is convenient to multiply the matrix-vector equation by the test function from the left, since this way we automatically get the correct matrix later on(in the linear system, the matrix is also multiplied from the right with the solution variable, not from the left), whereas if we multiplied from the right then the matrix so assembled is the transpose of the one we really want. *With this in mind, let us multiply by[2.x.44] and integrate to get the following equation which has to hold for all test functions[2.x.45] :[1.x.36] *or equivalently:[1.x.37] ***We get the final form by integrating by part the second term:[1.x.38] **It is this form that we will later use in assembling the discrete weak form into a matrix and a right hand side vector:the form in which we have solution and test functions[2.x.46] that each consist of a number of vector components that we can extract. **[2.x.47] VVFEs[1.x.39] *Once we have settled on a bilinear form and a functional setting, we need to find a way to describe the vector-valued finite element spaces from which we draw solution and test functions. This is where the FESystem class comes in:it composes vector-valued finite element spaces from simpler ones. In the example of the elasticity problem, we need[2.x.48] copies of the same element, for instance **[1.x.40] *This will generate a vector valued space of dimension[2.x.49], where each component is a continuous bilinear element of type FE_Q. It will have[2.x.50] times as many basis functions as the corresponding FE_Q, and each of these basis functions is a basis function of FE_Q, lifted into one of the components of the vector. *For the mixed Laplacian, the situation is more complex. First, we have to settle on a pair of discrete spaces[2.x.51] . One option would be the stable Raviart-Thomas pair **[1.x.41] *The first element in this system is already a vector valued element of dimension[2.x.52], while the second is a regular scalar element. *Alternatively to using the stable Raviart-Thomas pair, we could consider a stabilized formulation for the mixed Laplacian, for instance the LDG method. There, we have the option of using the same spaces for velocity components and pressure, namely **[1.x.42] *This system just has[2.x.53] equal copies of the same discontinuous element, which not really reflects the structure of the system. Therefore, we prefer **[1.x.43] *Here, we have a system of two elements, one vector-valued and one scalar, very much like with the[2.x.54] . Indeed, in many codes, the two can be interchanged. This element also allows us easily to switch to an LDG method with lower order approximation in the velocity, namely **[1.x.44] *It must be pointed out, that this element is different from **[1.x.45] *While the constructor call is very similar to[2.x.55], the result actually resembles more[2.x.56] in that this element produces[2.x.57] independent components. A more detailed comparison of the resulting FESystem objects is below. *[1.x.46] *FESystem has a few internal variables which reflect the internal structure set up by the constructor. These can then also be used by application programs to give structure to matrix assembling and linear algebra. We give the names and values of these variables for the examples above in the following table:&lt; table border=&quot;1&quot;&gt;&lt; tr &gt;&lt; th &gt;System Element&lt;/th &gt;[2.x.58][2.x.59][2.x.60]&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.61]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.62]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.63]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.64]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.65]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt;/table &gt; *From this table, it is clear that the FESystem reflects a lot of the structure of the system of differential equations in the cases of the[2.x.66] and the[2.x.67], in that we have a vector valued and a scalar variable. On the other hand, the convoluted elements do not have this structure and we have to reconstruct it somehow when assembling systems, as described below. *At this point, it is important to note that nesting of two FESystem object can give the whole FESystem a richer structure than just concatenating them. This structure can be exploited by application programs, but is not automatically so. *[2.x.68] VVAssembling[1.x.47] The next step is to assemble the linear system. How to do this for the simple case of a scalar problem has been shown in many tutorial programs, starting with[2.x.69] . Here we will show how to do it for vector problems. Corresponding to the different characterizations of weak formulations above and the different system elements created, we have a few options which are outlined below. *The whole concept is probably best explained by showing an example illustrating how the local contribution of a cell to the weak form of above mixed Laplace equations could be assembled. *[1.x.48] This is essentially how[2.x.70] does it:**[1.x.49] **So here 's what is happening:[2.x.71][2.x.72] The first thing we do is to declare &quot;extractors&quot;(see the FEValuesExtractors namespace). These are objects that don 't do much except store which components of a vector-valued finite element constitute a single scalar component, or a tensor of rank 1(i.e. what we call a &quot;physical vector&quot;, always consisting of[2.x.73] components). Here, we declare an object that represents the velocities consisting of[2.x.74] components starting at component zero, and the extractor for the pressure, which is a scalar component at position[2.x.75] . *[2.x.76] We then do our usual loop over all cells, shape functions, and quadrature points. In the innermost loop, we compute the local contribution of a pair of shape functions to the global matrix and right hand side vector. Recall that the cell contributions to the bilinear form(i.e. neglecting boundary terms) looked as follows, based on shape functions[2.x.77] :[1.x.50] *whereas the implementation looked like this:*[1.x.51] *The similarities are pretty obvious. *[2.x.78] Essentially, what happens in above code is this:when you do[2.x.79], a so-called &quot;view&quot; is created, i.e. an object that unlike the full FEValues object represents not all components of a finite element, but only the one(s) represented by the extractor object[2.x.80] or[2.x.81] . *[2.x.82] These views can then be asked for information about these individual components. For example, when you write[2.x.83] you get the value of the pressure component of the[2.x.84] th shape function[2.x.85] at the[2.x.86] th quadrature point. Because the extractor[2.x.87] represents a scalar component, the results of the operator[2.x.88] is a scalar number. On the other hand, the call[2.x.89] would produce the value of a whole set of[2.x.90] components, which would be of type[2.x.91] . *[2.x.92] Other things that can be done with views is to ask for the gradient of a particular shape function 's components described by an extractor. For example,[2.x.93] would represent the gradient of the scalar pressure component, which is of type[2.x.94], whereas the gradient of the velocities components,[2.x.95] is a[2.x.96], i.e. a matrix[2.x.97] that consists of entries[2.x.98] . Finally, both scalar and vector views can be asked for the second derivatives(&quot;Hessians&quot;) and vector views can be asked for the symmetric gradient, defined as[2.x.99] as well as the divergence[2.x.100] .[2.x.101] Other examples of using extractors and views are shown in tutorial programs[2.x.102],[2.x.103],[2.x.104] and several other programs. ***[2.x.105] In the current context, when we talk about a vector(for example in extracting the velocity components above), we mean the word in the sense physics uses it:it has[2.x.106] components that behave in specific ways under coordinate system transformations. Examples include velocity or displacement fields. This is opposed to how mathematics uses the word &quot;vector&quot;(and how we use this word in other contexts in the library, for example in the Vector class), where it really stands for a collection of numbers. An example of this latter use of the word could be the set of concentrations of chemical species in a flame x</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00090">vector_valued_0.txt:90</a></div></div>
<div class="ttc" id="aA-headers_2fe__0_8txt_html_ac58f1344c78bfcb3556c763b59c923c6"><div class="ttname"><a href="A-headers_2fe__0_8txt.html#ac58f1344c78bfcb3556c763b59c923c6">The</a></div><div class="ttdeci">****All classes related to shape functions and to access to shape functions This concerns the actual values of finite elements For the numbering of degrees of freedom refer to the module on *[2.x.1] The classes and functions of this module fall into several sub groups that are discussed in their respective sub modules listed above In the FETools class provides functions that provide information on finite elements transformations between elements etc *In the grand scheme of the pieces of this module interact with a variety of other parts of the without actually implementing a concrete element For the FiniteElement base class declares the virtual functions a derived class has to implement if it wants to describe a finite element space Likewise the FiniteElementData holds variables that describe certain values characterizing a finite element such as the number of degrees of freedom per vertex line or face *On the other classes like FE_Poly and FE_PolyTensor are higher abstractions They describe finite elements that are built atop polynomial descriptions of the shape functions on the unit cell Classes derived from them then only have to provide a description of the particular polynomial from which a finite element is built For the FE_Q class that implements the usual Lagrange elements uses the FE_Poly base class to generate a finite element by providing it with a set of Lagrange interpolation polynomials corresponding to an equidistant subdivision of interpolation points the FESystem class is used for vector valued problems There one may want to couple a number of for Navier Stokes one may want to use three Q1 elements for the three components of the and a piecewise constant Q0 element for the pressure The FESystem class can be used to couple these four base elements together into a single vector valued element with vector components The[2.x.3]</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2fe__0_8txt_source.html#l00021">fe_0.txt:21</a></div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="aclassStep60_1_1DistributedLagrangeProblem_1_1Parameters_html"><div class="ttname"><a href="classStep60_1_1DistributedLagrangeProblem_1_1Parameters.html">Step60::DistributedLagrangeProblem::Parameters</a></div><div class="ttdef"><b>Definition:</b> <a href="step-60_8cc_source.html#l00071">step-60.cc:71</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a2c7b85beed973f20ac73d33d8bbe8a57"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div><div class="ttdeci">compute_rate If set to then this column will be included in the list of columns for which error rates are computed You may want to set this to false if you want to compute error rates with respect to this column In this you should also specify[2.x.28] as the rate key in the parameter file **Difference between two solutions in the same vector space **Same as with a non default mapping **Write the error table to the[2.x.29] no output is written **Add rates to the output table **Names of the solution components **Same as but containing repeated component names only once **Masks for each unique component name **Additional methods to call when adding rows to the table **Type of error to compute per components **Exponent to use in p norm types **The actual table **Extra columns to add to the table **The name of column with respect to which we compute convergence rates **Reduction rate mode See[2.x.30] for a documentation **The precision used to output the table **Filename to use when writing to file **Compute the error If this is false</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00093">parsed_convergence_table_0.txt:93</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_a03a2f48682e29e39f7bccc11a7d1c4d1"><div class="ttname"><a href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has degree[1.x.4]</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00003">polynomial_space_0.txt:3</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a96ecfde131843f52ee49d0e0c1180134"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of and gets compile time</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ac4c845555bda24566ddc584532b7fa57"><div class="ttname"><a href="distributed__0_8txt.html#ac4c845555bda24566ddc584532b7fa57">element</a></div><div class="ttdeci">see C J T ***The DoFHandler class builds on the Triangulation class but it can detect whenever we actually use an object of type[2.x.22] as triangulation In that it assigns global numbers for all degrees of freedom that given a finite element</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00046">distributed_0.txt:46</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints&lt; double &gt;</a></div></div>
<div class="ttc" id="anamespaceGridTools_html_acd5ccc543d561cfb086b571d1f7818cb"><div class="ttname"><a href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">GridTools::diameter</a></div><div class="ttdeci">double diameter(const Triangulation&lt; dim, spacedim &gt; &amp;tria)</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l00081">grid_tools.cc:81</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html_a7b3d3f295bb56d6cd6856bdc6cbe8a01"><div class="ttname"><a href="classAffineConstraints.html#a7b3d3f295bb56d6cd6856bdc6cbe8a01">AffineConstraints::distribute</a></div><div class="ttdeci">void distribute(VectorType &amp;vec) const</div></div>
<div class="ttc" id="asunlinsol__wrapper__0_8txt_html_a596fe530f5203831fcb681b183f7ddf6"><div class="ttname"><a href="sunlinsol__wrapper__0_8txt.html#a596fe530f5203831fcb681b183f7ddf6">Tolerance</a></div><div class="ttdeci">*A linear i it computes *[2.x.6] *Apply the wrapped i solve[2.x.7] where[2.x.8] is the[2.x.9] vector and[2.x.10] the[2.x.11] vector[2.x.12] dst Result vector of the preconditioner application[2.x.13] src Target vector of the preconditioner application **Constructor[2.x.14] P_data Data required by[2.x.15][2.x.16] p_solve_fn A function pointer to the function that computes A *v[2.x.17] tol Tolerance</div><div class="ttdef"><b>Definition:</b> <a href="sunlinsol__wrapper__0_8txt_source.html#l00016">sunlinsol_wrapper_0.txt:16</a></div></div>
<div class="ttc" id="aclassStep60_1_1DistributedLagrangeProblem_1_1Parameters_html_a4d6fa5f1cf54eb6b828e03848022e3a9"><div class="ttname"><a href="classStep60_1_1DistributedLagrangeProblem_1_1Parameters.html#a4d6fa5f1cf54eb6b828e03848022e3a9">Step60::DistributedLagrangeProblem::Parameters::Parameters</a></div><div class="ttdeci">Parameters()</div><div class="ttdef"><b>Definition:</b> <a href="step-60_8cc_source.html#l00170">step-60.cc:170</a></div></div>
<div class="ttc" id="anamespaceGridTools_html_a47c293eff2ec7ce4b90ba08b35d1f2e2"><div class="ttname"><a href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a></div><div class="ttdeci">double minimal_cell_diameter(const Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Mapping&lt; dim, spacedim &gt; &amp;mapping=(ReferenceCells::get_hypercube&lt; dim &gt;() .template get_default_linear_mapping&lt; dim, spacedim &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l04309">grid_tools.cc:4309</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a680d8b0d6d9162296d224196cfd47028"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a680d8b0d6d9162296d224196cfd47028">parameters</a></div><div class="ttdeci">and situations where one is given a parameter dependent problem[2.x.4] and wants to form derivatives with regards to the parameters[2.x.5]</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00010">automatic_and_symbolic_differentiation_0.txt:10</a></div></div>
<div class="ttc" id="agroup__LAOperators_html_ga6bdc65fb2db56230e6bc7d545e81295d"><div class="ttname"><a href="group__LAOperators.html#ga6bdc65fb2db56230e6bc7d545e81295d">LinearOperator::transpose_operator</a></div><div class="ttdeci">LinearOperator&lt; Domain, Range, Payload &gt; transpose_operator(const LinearOperator&lt; Range, Domain, Payload &gt; &amp;op)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2linear__operator_8h_source.html#l00706">linear_operator.h:706</a></div></div>
<div class="ttc" id="agrid_2grid__tools__cache_8h_html"><div class="ttname"><a href="grid_2grid__tools__cache_8h.html">grid_tools_cache.h</a></div></div>
<div class="ttc" id="alac_2solver__cg_8h_html"><div class="ttname"><a href="lac_2solver__cg_8h.html">solver_cg.h</a></div></div>
<div class="ttc" id="anamespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a7b1ab7a5dcacc31df12a0592293133c0"><div class="ttname"><a href="coding__conventions__0_8txt.html#a7b1ab7a5dcacc31df12a0592293133c0">as</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per the child indices of the child cells adjacent to rather than writing them into the code directly as[2.x.35]</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="afe__nedelec__0_8txt_html_a8b7c0468fae3de73000ffc4dfafc048a"><div class="ttname"><a href="fe__nedelec__0_8txt.html#a8b7c0468fae3de73000ffc4dfafc048a">but</a></div><div class="ttdeci">lec element is constructed in such a way ii the shape functions are but(iii) the tangential component(s) of the vector field represented by each shape function are continuous across the faces of cells. *Other properties of the N &amp;eacute</div></div>
<div class="ttc" id="adata__out__base__0_8txt_html_a4baf3a79030f53d8ecd9bd4e5a688bbb"><div class="ttname"><a href="data__out__base__0_8txt.html#a4baf3a79030f53d8ecd9bd4e5a688bbb">second</a></div><div class="ttdeci">for&lt; tt &gt;&lt; tt &gt;&lt; tt &gt; etc The actual location of these points on the patch will be computed by a multilinear transformation from the vertices given for this patch For cells at the a mapping might be used to calculate the position of the inner points In that case the coordinates are stored inside the as they cannot be easily recovered otherwise *Given these the actual data to be printed on this patch of points consists of several data sets each of which has a value at each of the patch points For example with&lt; tt &gt; each data set has to provide nine and since the patch is to be printed as a tensor its values are to be ordered i e the z coordinate runs then the y then the patches as explained above might be too restricted For one might want to draw only the outer faces of a domain in a three dimensional if one is not interested in what happens inside the objects that should be drawn are two dimensional in a three dimensional world The Patch class and associated output functions handle these cases The Patch class therefore takes two template parameters the first named&lt; tt &gt; dim&lt;/tt &gt; denoting the dimension of the while the second</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base__0_8txt_source.html#l00016">data_out_base_0.txt:16</a></div></div>
<div class="ttc" id="alac_2sparse__direct_8h_html"><div class="ttname"><a href="lac_2sparse__direct_8h.html">sparse_direct.h</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a6365596c7d2490c474cd0b7ce9722b37"><div class="ttname"><a href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a></div><div class="ttdeci">it does so for both DoFHandler and[2.x.14] objects Note that the DoFAccessor class is derived from either TriaAccessor or the DoFAccessor class comes in two flavors one accessing degrees of freedom on the level of a cell and the other accessing the active dofs of an active cell **The DoFCellAccessor class has the same purpose and relation to DoFCellAccessor as the CellAccessor has to TriaAccessor *Except to look up member you will not usually have to deal withthe actual class names listed above Rather one uses the typedefs provided bythe mesh classes Triangulation DoFHandler and[2.x.15] as wellas the function that generate such buta hexahedron there are corresponding types and calls like[2.x.34] that act on thedimension independent geometric objects and hex These calls</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00076">iterators_0.txt:76</a></div></div>
<div class="ttc" id="alac_2vector_8h_html"><div class="ttname"><a href="lac_2vector_8h.html">vector.h</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a177c697348e3052c514824563807ea3b"><div class="ttname"><a href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div><div class="ttdeci">**Throughout deal we strive to keep our programming style and the kind ofinterfaces we provide as consistent as possible To this end</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00003">coding_conventions_0.txt:3</a></div></div>
<div class="ttc" id="aquadrature__point__data__0_8txt_html_a35c4177ef651238576ebc1395f9e116e"><div class="ttname"><a href="quadrature__point__data__0_8txt.html#a35c4177ef651238576ebc1395f9e116e">refinement</a></div><div class="ttdeci">i a property that varies discontinuously within a solid In such trying to transfer data from the quadrature points to a finite element field that is once evaluated at a different set of quadrature the quadrature rule[2.x.94] used to integrate its mass matrix and finally the quadrature rule[2.x.95] which is used to store[2.x.96][2.x.97][2.x.98] has to be scalar valued *Since this class does projection on cell by cell basis[2.x.100] is only required to be continuous within the cell **Prepare for coarsening and refinement of a triangulation[2.x.101][2.x.102] represents the cell data which should be transferred and it should be initialized for each locally owned active cell *Although CellDataStorage class allows storing on different cells different objects derived from the base class here we assume that[2.x.104] contains objects of the same more specifically they pack unpack the same data **Interpolate the data previously stored in this object before the mesh was refined or coarsened onto the quadrature points of the currently active set of cells *Before calling this function the user is expected to populate the data stored in the[2.x.106] object provided to an exception will be thrown in debug mode **A callback function used to pack the data on the current mesh into objects that can later be retrieved after refinement</div><div class="ttdef"><b>Definition:</b> <a href="quadrature__point__data__0_8txt_source.html#l00085">quadrature_point_data_0.txt:85</a></div></div>
<div class="ttc" id="arefinement__0_8txt_html_a61dd5d9b9472f67e075676c7196275a9"><div class="ttname"><a href="refinement__0_8txt.html#a61dd5d9b9472f67e075676c7196275a9">history</a></div><div class="ttdeci">this assumption enters the rate of convergence that is used in the prediction The[2.x.84] norm of the output argument[2.x.85] corresponds to the predicted global error after adaptation For p the error is expected to converge exponentially with the polynomial degree of the assigned finite element Each increase or decrease of the degree will thus change its value by a user defined control parameter[2.x.86] For h we expect the error[2.x.87] on cell[2.x.88] to be proportional to[2.x.89] in the energy where[2.x.90] denotes the cell diameter and[2.x.91] the polynomial degree of the currently assigned finite element on cell[2.x.92] During h the finite elements on siblings may be and their parent cell will be assigned to their least dominating finite element that belongs to its most general child we will always interpolate on an enclosing finite element space Additionally assuming that the finite elements on the cells to be coarsened are sufficient to represent the solution we are confident to say that the error will not change by sole interpolation on the larger finite element space For p the error is expected to converge exponentially with the polynomial degree of the assigned finite element Each increase or decrease of the degree will thus change its value by a user defined control parameter[2.x.93] The assumption of exponential convergence is only valid if both h and p adaptive methods are combined in a sense that they are both utilitzed throughout a but do not have to be applied both on a cell simultaneously The prediction algorithm is formulated as follows with control parameters[2.x.94][2.x.95] and[2.x.96] that may be used to influence prediction for each adaptation type individually The results for each individual cell are stored in the[2.x.97] output argument[2.x.98] On basis of the refinement history</div><div class="ttdef"><b>Definition:</b> <a href="refinement__0_8txt_source.html#l00036">refinement_0.txt:36</a></div></div>
<div class="ttc" id="aclassFunctions_1_1ZeroFunction_html"><div class="ttname"><a href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2function_8h_source.html#l00516">function.h:516</a></div></div>
<div class="ttc" id="atimer__0_8txt_html_a48e9e3a8116df3cc4b62db810904e91f"><div class="ttname"><a href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a></div><div class="ttdeci">*A compatible with the[2.x.0] notion of a whose by in multiples of of a second and POSIX uses so go with microseconds for uniformity **Signed integral type used to store the value returned by this requires platform specific so this function returns on platforms that are neither Windows nor POSIX **The Timer class provides a way to measure both the amount of wall or[2.x.1] as well as the total time elapsed over all laps Here is an you can also restart the timer instead of resetting it The times between successive calls to start() and stop()(i.e.</div></div>
<div class="ttc" id="aclassParameterHandler_html"><div class="ttname"><a href="classParameterHandler.html">ParameterHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__handler_8h_source.html#l00820">parameter_handler.h:820</a></div></div>
<div class="ttc" id="atable__handler__0_8txt_html_a61e9964f9093088848525ca172895749"><div class="ttname"><a href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a></div><div class="ttdeci">the ConvergenceTable class does something like this *To support both the TableHandler class has a property called[1.x.4] By auto fill mode is but it can be enabled by calling set_auto_fill_mode(). If auto-fill mode is enabled we use the following algorithm call it *[2.x.18] ***If[2.x.19] then we add[2.x.20] copies of the object[2.x.21] to this column is the data type of the given[2.x.23] is a numeric then[2.x.24] is[2.x.25] is the empty string *[2.x.26] ***Add the given value to this column *Padding the column with default elements makes sure that after the addition the column has as many entries as the longest other column In other if we have skipped previous invocations of then the padding will enter default values into this column *The algorithm as described will fail if you try to skip adding values for a key if adding an element for this key is the first thing you want to do for a given iteration or time step</div><div class="ttdef"><b>Definition:</b> <a href="table__handler__0_8txt_source.html#l00070">table_handler_0.txt:70</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a06f24e4861fb115188fd2a8027e7b407"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a06f24e4861fb115188fd2a8027e7b407">first</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of and gets compile or both ****auto_diff_1 Automatic differentiation *commonly also referred to as algorithmic is a numerical method that can be used to automatically compute the first</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00019">automatic_and_symbolic_differentiation_0.txt:19</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_acce0a318676405d57af6ef0f5cbe4ec3"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#acce0a318676405d57af6ef0f5cbe4ec3">and</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications and</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="aclassSparseDirectUMFPACK_html"><div class="ttname"><a href="classSparseDirectUMFPACK.html">SparseDirectUMFPACK</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2sparse__direct_8h_source.html#l00089">sparse_direct.h:89</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ad83f9d9d8b603ed71c3483de199bc7a7"><div class="ttname"><a href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a></div><div class="ttdeci">their purpose is merely to keepdeal II as uniform as possible Uniformity reduces the number of bugs weproduce because we for always assume that input arguments comebefore output arguments of a function call They also simplify reading codebecause some things become clear already by looking at the style a piece ofcode is without having to look up the exact definition of something **deal II uses[2.x.2] to normalize indentation Astyle file is provided at ***Before a you should run **on each of your files This will make sure indentation is conforming to thestyle guidelines outlined in this page *This is cumbersome and more you can just run **in whatever directory you set up the library to be compiled in</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00013">coding_conventions_0.txt:13</a></div></div>
<div class="ttc" id="aopencascade_2utilities__0_8txt_html_a23b9c1bdc9420a32a79f19f214a53812"><div class="ttname"><a href="opencascade_2utilities__0_8txt.html#a23b9c1bdc9420a32a79f19f214a53812">created</a></div><div class="ttdeci">namespace all utilities which operate on OpenCASCADE entities OpenCASCADE splits every object into a topological description and a geometrical entity The basic topological description is a TopoDS_Shape TopoDS_Shapes are light objects and can be copied around The closest deal II analog is a TriaIterator *The OpenCASCADE topology is designed with reference to the STEP standard ISO The structure is an oriented one way where parents refer to their and there are no back references Abstract structure is implemented as C classes from the TopoDS package A TopoDS_Shape is manipulated by value and contains orientation and a myTShape myTShape and Location are used to share data between various shapes to save memory For an edge belonging to two faces has equal Locations and myTShape fields but different etc *Once a topological description is if a concrete geometrical object can be created</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities__0_8txt_source.html#l00005">utilities_0.txt:5</a></div></div>
<div class="ttc" id="aclassFunction_html"><div class="ttname"><a href="classFunction.html">Function&lt; spacedim &gt;</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="anamespaceNonMatching_html_ac3821491559b8a76af0be66736fe4c6f"><div class="ttname"><a href="namespaceNonMatching.html#ac3821491559b8a76af0be66736fe4c6f">NonMatching::create_coupling_mass_matrix</a></div><div class="ttdeci">void create_coupling_mass_matrix(const DoFHandler&lt; dim0, spacedim &gt; &amp;space_dh, const DoFHandler&lt; dim1, spacedim &gt; &amp;immersed_dh, const Quadrature&lt; dim1 &gt; &amp;quad, Matrix &amp;matrix, const AffineConstraints&lt; typename Matrix::value_type &gt; &amp;constraints=AffineConstraints&lt; typename Matrix::value_type &gt;(), const ComponentMask &amp;space_comps=ComponentMask(), const ComponentMask &amp;immersed_comps=ComponentMask(), const Mapping&lt; dim0, spacedim &gt; &amp;space_mapping=StaticMappingQ1&lt; dim0, spacedim &gt;::mapping, const Mapping&lt; dim1, spacedim &gt; &amp;immersed_mapping=StaticMappingQ1&lt; dim1, spacedim &gt;::mapping)</div><div class="ttdef"><b>Definition:</b> <a href="coupling_8cc_source.html#l00363">coupling.cc:363</a></div></div>
<div class="ttc" id="abase_2bounding__box__0_8txt_html_a448658829353774b234a6819182c72db"><div class="ttname"><a href="base_2bounding__box__0_8txt.html#a448658829353774b234a6819182c72db">spacedim</a></div><div class="ttdeci">*The enumerator NeighborType describes the neighboring relation between two bounding boxes ***Not in this means that the two boxes touch at one corner of the each box **Attached in this means that the two boxes touch along an edge **Mergeable e g **or one is inside the other **A class that represents a box of arbitrary dimension&lt; tt &gt; spacedim&lt;/tt &gt; and with sides parallel to the coordinate axes that is a region a bounding box is top right for useful in parallel distributed meshes to give a general description of the owners of each portion of the mesh *Taking the cross section of a BoundingBox&lt; spacedim &gt; orthogonal to a given direction gives a box in one dimension the coordinates of the cross section of BoundingBox&lt; 3 &gt; can be ordered in different ways That if we take the cross section orthogonal to the y direction we could either order a coordinate into a coordinate as[2.x.1] or as[2.x.2] This class uses the second convention corresponding to the coordinates being ordered cyclicly[2.x.3] To be if we take a cross z y *This is according to the convention set by the function *[2.x.4] **Standard constructor Creates an object that corresponds to an empty i e a degenerate box with both points being the origin **Standard constructor for non empty Number elements **Return a reference to the boundary_points **Return const a reference to the boundary_points **Test for equality **Test for inequality **Check if the current object and[2.x.5] are i e if the boxes have dimension spacedim</div><div class="ttdef"><b>Definition:</b> <a href="base_2bounding__box__0_8txt_source.html#l00070">bounding_box_0.txt:70</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a01e76d6a9109d0fc42c67e122e06757e"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a01e76d6a9109d0fc42c67e122e06757e">constants</a></div><div class="ttdeci">dual numbers do not contain any higher order terms in their first while for the complex step method these existent higher order terms are neglected It can be shown that both of these methods are not subject to subtractive cancellation errors and within their finite difference they are not numerically sensitive to the internal[2.x.35] size chosen for the numerical perturbation The dual number approach thus produces exact first while the complex step approximation does not The standard implementation of the dual cannot yield exact values for second derivatives Hyper dual numbers take a different view of this with numbers being represented in a form similar to with the appropriate both first and second derivatives can be computed exactly ****With[2.x.36] taped[2.x.37] a specified subregion of code is selected as one for which all operations executed with the recorded arbitrarily high order derivatives of the function then can be computed by referring to the code path tracked and stored on the or if it is not analytic one might need to consider the case of branched where the tape is no longer but rather forks off on a different evaluation path to that due to the original recorded inputs ****Methods based on[1.x.2] leverage the computational constructed from abstract the syntax that resolves the function output from its input values The outermost leaves on the tree represent the independent variables or constants</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00068">automatic_and_symbolic_differentiation_0.txt:68</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_aa6418ea655b1b550b9dcf63513030196"><div class="ttname"><a href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">ParameterHandler::set</a></div><div class="ttdeci">void set(const std::string &amp;entry_name, const std::string &amp;new_value)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l01152">parameter_handler.cc:1152</a></div></div>
<div class="ttc" id="anamespaceGridTools_html_ae8409fa9cb46a0070abc4da7de0f47f2"><div class="ttname"><a href="namespaceGridTools.html#ae8409fa9cb46a0070abc4da7de0f47f2">GridTools::maximal_cell_diameter</a></div><div class="ttdeci">double maximal_cell_diameter(const Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Mapping&lt; dim, spacedim &gt; &amp;mapping=(ReferenceCells::get_hypercube&lt; dim &gt;() .template get_default_linear_mapping&lt; dim, spacedim &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l04336">grid_tools.cc:4336</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_a5514e4f59ea659f63953d62ca429eaff"><div class="ttname"><a href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a></div><div class="ttdeci">void map_dofs_to_support_points(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, std::vector&lt; Point&lt; spacedim &gt;&gt; &amp;support_points, const ComponentMask &amp;mask=ComponentMask())</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8cc_source.html#l02222">dof_tools.cc:2222</a></div></div>
<div class="ttc" id="anumerics_2data__out_8h_html"><div class="ttname"><a href="numerics_2data__out_8h.html">data_out.h</a></div></div>
<div class="ttc" id="aclassParameterAcceptor_html"><div class="ttname"><a href="classParameterAcceptor.html">ParameterAcceptor</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__acceptor_8h_source.html#l00351">parameter_acceptor.h:351</a></div></div>
<div class="ttc" id="anamespaceNonMatching_html_a8829bfa8e55c21b8eeaafd086c53680d"><div class="ttname"><a href="namespaceNonMatching.html#a8829bfa8e55c21b8eeaafd086c53680d">NonMatching::create_coupling_sparsity_pattern</a></div><div class="ttdeci">void create_coupling_sparsity_pattern(const DoFHandler&lt; dim0, spacedim &gt; &amp;space_dh, const DoFHandler&lt; dim1, spacedim &gt; &amp;immersed_dh, const Quadrature&lt; dim1 &gt; &amp;quad, Sparsity &amp;sparsity, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const ComponentMask &amp;space_comps=ComponentMask(), const ComponentMask &amp;immersed_comps=ComponentMask(), const Mapping&lt; dim0, spacedim &gt; &amp;space_mapping=StaticMappingQ1&lt; dim0, spacedim &gt;::mapping, const Mapping&lt; dim1, spacedim &gt; &amp;immersed_mapping=StaticMappingQ1&lt; dim1, spacedim &gt;::mapping)</div><div class="ttdef"><b>Definition:</b> <a href="coupling_8cc_source.html#l00175">coupling.cc:175</a></div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00137">data_out.h:137</a></div></div>
<div class="ttc" id="afunctions__0_8txt_html_af9f808a82e8c618e2e7a19dd08a9eae3"><div class="ttname"><a href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div><div class="ttdeci">****Functions are used in various places in deal for example to describe boundary coefficients in forcing or exact solutions Since closed form expressions for equations are often hard to pass along as function deal II uses the Function base class to describe these objects Essentially the interface of this base class requires derived classes to implement the ability to return the value of a function at one or a list of particular locations and function objects can then be used by algorithms like[2.x.1][2.x.2] and other functions *Some functions are needed again and and are therefore already provided in deal II This includes a function with a constant value</div><div class="ttdef"><b>Definition:</b> <a href="functions__0_8txt_source.html#l00007">functions_0.txt:7</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="anon__matching_2coupling_8h_html"><div class="ttname"><a href="non__matching_2coupling_8h.html">coupling.h</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_a6e325333a138893e181da47f29ac680a"><div class="ttname"><a href="namespaceVectorTools.html#a6e325333a138893e181da47f29ac680a">VectorTools::create_right_hand_side</a></div><div class="ttdeci">void create_right_hand_side(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;rhs, VectorType &amp;rhs_vector, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints=AffineConstraints&lt; typename VectorType::value_type &gt;())</div></div>
<div class="ttc" id="alac_2sparse__matrix_8h_html"><div class="ttname"><a href="lac_2sparse__matrix_8h.html">sparse_matrix.h</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html_a1611aa37f754086388ca76bcd421cce5"><div class="ttname"><a href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">AffineConstraints::close</a></div><div class="ttdeci">void close()</div></div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01699">exceptions.h:1699</a></div></div>
<div class="ttc" id="agrid_2manifold__0_8txt_html_a02d8bd1db3a4d0b6d68a99a931ce1b83"><div class="ttname"><a href="grid_2manifold__0_8txt.html#a02d8bd1db3a4d0b6d68a99a931ce1b83">since</a></div><div class="ttdeci">*We collect here some helper functions used in the Manifold&lt; dim, spacedim &gt; classes ***A[2.x.0] helper function that returns the number of default points for the structure type pointed to by the given[2.x.1] See the documentation of[2.x.2] for more information **Given a general mesh construct arrays of quadrature points and weights that contain the following then the quadrature points are the two vertices of the line This results in a point vector with two points ********If the iterator points to a then the quadrature points are the vertices and line mid points This results in a point vector with then the quadrature points are the the line mid and the face mid points This results in a points vector which computes a new point on a manifold based on a weighted average of surrounding points represented by the quadrature points and weights stored in the returned pair of vectors This function creates such an object based on the points that surround a or and weights are chosen in a way appropriate for computing the new mid point of the object pointed to An example of where this is necessary is for mesh and then a new cell point[2.x.8] iterator A mesh iterator that points to either a or hex[2.x.9] with_interpolation Whether or not to compute the quadrature weights from transfinite as discussed above[2.x.10] MeshIteratorType An iterator type that corresponds to then no periodicity is assumed in that direction Whenever a function that tries to compute averages is an exception will be thrown if one of the points which you are using for the average lies outside the periodicity box The return points are guaranteed to lie in the periodicity box plus or minus tolerance *periodicity and then calls internally the function is to allow lazy programmers to implement only the the middle point of a cell is close to true middle point of the and a projection may suffice For most simple it is possible to get reasonable results by deriving your own Manifold class from FlatManifold and write a new interface only for the project_to_manifold function You will have good approximations also with large deformations as long as in the coarsest mesh size you are trying to refine the middle point is not too far from the manifold mid point i e as long as the coarse mesh size is small enough **Compute a new set of points that interpolate between the given points[2.x.108] surrounding_points[2.x.109] is a table with as many columns as[2.x.110] surrounding_points the interpolation of the[2.x.113] according to the[2.x.114] is simply performed in Cartesian space **Project to FlatManifold This is the identity function for Euclidean spaces Note however that this function can be overloaded by derived which will then benefit from the logic behind the is tangential to the geodesic that connects two points[2.x.116] For the current we assume that the manifold is so the geodesic is the straight line between the two and we return[2.x.117] The normalization of the vector is chosen so that it fits the convention described in *[2.x.118] If you use this class as a stepping stone to build a manifold that only slightly deviates from a flat manifold by overloading the and the one at which the direction is to be evaluated[2.x.121] x2 The second point that describes the geodesic[2.x.122] A direction vector tangential to the geodesic this possibly modified by the periodicity of the domain as set in the to use the shortest connection between the points through the periodic boundary as necessary **Return the normal vector to the given face at point p taking into account that quadrilateral faces of hexahedral cells in may not be planar In those the face is assumed to have a geometry described by a bilinear and the normal vector is computed by embedding this bilinear form into a Cartesian space with a flat metric **Compute the normal vectors to the boundary at each vertex of the given face taking into account that quadrilateral faces of hexahedral cells in may not be planar In those the face is assumed to have a geometry described by a bilinear and the normal vector is computed by embedding this bilinear form into a Cartesian space with a flat metric **Return the periodicity of this Manifold **The periodicity of this Manifold Periodicity affects the way a middle point is computed It is assumed that if two points are more than half period then the distance should be computed by crossing the periodicity i the average is computed by adding a full period to the sum of the two For if along direction we have *pi then the average but since</div><div class="ttdef"><b>Definition:</b> <a href="grid_2manifold__0_8txt_source.html#l00147">manifold_0.txt:147</a></div></div>
<div class="ttc" id="agrid_2manifold__0_8txt_html_a646cdf83c7aa73d8bd5537621889ac21"><div class="ttname"><a href="grid_2manifold__0_8txt.html#a646cdf83c7aa73d8bd5537621889ac21">pi</a></div><div class="ttdeci">*We collect here some helper functions used in the Manifold&lt; dim, spacedim &gt; classes ***A[2.x.0] helper function that returns the number of default points for the structure type pointed to by the given[2.x.1] See the documentation of[2.x.2] for more information **Given a general mesh construct arrays of quadrature points and weights that contain the following then the quadrature points are the two vertices of the line This results in a point vector with two points ********If the iterator points to a then the quadrature points are the vertices and line mid points This results in a point vector with then the quadrature points are the the line mid and the face mid points This results in a points vector which computes a new point on a manifold based on a weighted average of surrounding points represented by the quadrature points and weights stored in the returned pair of vectors This function creates such an object based on the points that surround a or and weights are chosen in a way appropriate for computing the new mid point of the object pointed to An example of where this is necessary is for mesh and then a new cell point[2.x.8] iterator A mesh iterator that points to either a or hex[2.x.9] with_interpolation Whether or not to compute the quadrature weights from transfinite as discussed above[2.x.10] MeshIteratorType An iterator type that corresponds to then no periodicity is assumed in that direction Whenever a function that tries to compute averages is an exception will be thrown if one of the points which you are using for the average lies outside the periodicity box The return points are guaranteed to lie in the periodicity box plus or minus tolerance *periodicity and then calls internally the function is to allow lazy programmers to implement only the the middle point of a cell is close to true middle point of the and a projection may suffice For most simple it is possible to get reasonable results by deriving your own Manifold class from FlatManifold and write a new interface only for the project_to_manifold function You will have good approximations also with large deformations as long as in the coarsest mesh size you are trying to refine the middle point is not too far from the manifold mid point i e as long as the coarse mesh size is small enough **Compute a new set of points that interpolate between the given points[2.x.108] surrounding_points[2.x.109] is a table with as many columns as[2.x.110] surrounding_points the interpolation of the[2.x.113] according to the[2.x.114] is simply performed in Cartesian space **Project to FlatManifold This is the identity function for Euclidean spaces Note however that this function can be overloaded by derived which will then benefit from the logic behind the is tangential to the geodesic that connects two points[2.x.116] For the current we assume that the manifold is so the geodesic is the straight line between the two and we return[2.x.117] The normalization of the vector is chosen so that it fits the convention described in *[2.x.118] If you use this class as a stepping stone to build a manifold that only slightly deviates from a flat manifold by overloading the and the one at which the direction is to be evaluated[2.x.121] x2 The second point that describes the geodesic[2.x.122] A direction vector tangential to the geodesic this possibly modified by the periodicity of the domain as set in the to use the shortest connection between the points through the periodic boundary as necessary **Return the normal vector to the given face at point p taking into account that quadrilateral faces of hexahedral cells in may not be planar In those the face is assumed to have a geometry described by a bilinear and the normal vector is computed by embedding this bilinear form into a Cartesian space with a flat metric **Compute the normal vectors to the boundary at each vertex of the given face taking into account that quadrilateral faces of hexahedral cells in may not be planar In those the face is assumed to have a geometry described by a bilinear and the normal vector is computed by embedding this bilinear form into a Cartesian space with a flat metric **Return the periodicity of this Manifold **The periodicity of this Manifold Periodicity affects the way a middle point is computed It is assumed that if two points are more than half period then the distance should be computed by crossing the periodicity i the average is computed by adding a full period to the sum of the two For if along direction we have *pi then the average but * pi(or zero)</div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a4c0a7149e1927066d2fcdb356cb90f7b"><div class="ttname"><a href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a></div><div class="ttdeci">in this it often pays off to use rather than in a program *deal II does not implement scheduling tasks to threads itself For we use the[1.x.10] for which we provide simple wrappers TBB abstracts the details of how to start or stop start tasks on individual and provides interfaces that are portable across many different systems ***MTUsing *[1.x.11] the syntax to start would be something like this for the example we would like to indicate the fact that the function call should be run on a separate task by simply prefixing the call with a as it is here *Since C does not support the creation of new we have to be a bit more creative The way chosen is to introduce a function[2.x.24] that takes as arguments the function to call as well as the arguments to the call The[2.x.25] function is overloaded to accommodate starting tasks with functions that take no</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00045">multithreading_0.txt:45</a></div></div>
<div class="ttc" id="agrid_2grid__refinement__0_8txt_html_a8bdcf8330609e043ba26a394139934f2"><div class="ttname"><a href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a></div><div class="ttdeci">and W R the function uses the observation that the error behaves like[2.x.65] with some constant[2.x.66] that depends on the dimension and the finite element degree It should **given optimal mesh refinement **not depend so much on the regularity of the as it is based on the that all singularities can be resolved by refinement Mesh refinement is then based on the idea that we want to make[2.x.67] small This corresponds to the functional[2.x.68] above *This function was originally implemented by Thomas Richter It follows a strategy described in T Parallel Multigrid Method for Adaptive Finite Elements with Application to Flow PhD University of See in particular Section</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement__0_8txt_source.html#l00029">grid_refinement_0.txt:29</a></div></div>
<div class="ttc" id="abase_2parsed__function_8h_html"><div class="ttname"><a href="base_2parsed__function_8h.html">parsed_function.h</a></div></div>
<div class="ttc" id="agrid__0_8txt_html_abc4bc3849dde2110dfa9e18bf7ae1b8c"><div class="ttname"><a href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a></div><div class="ttdeci">triangles and tetrahedra are not supported *This collection of cells is managed by the Triangulation class and derived classes such as[2.x.1] and[2.x.2] It holds the relevant data in memory and offers interfaces to query it Most things you want to do on cells are performed in loops over all cells For this the Triangulation class offers the concept of iterators(see[2.x.3])[2.x.7] Reading from a file</div><div class="ttdef"><b>Definition:</b> <a href="grid__0_8txt_source.html#l00007">grid_0.txt:7</a></div></div>
<div class="ttc" id="anamespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00030">communication_pattern_base.h:30</a></div></div>
<div class="ttc" id="agrid_2grid__generator_8h_html"><div class="ttname"><a href="grid_2grid__generator_8h.html">grid_generator.h</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_aa5b8d3c4b9deb0774dde5c2851e07e1e"><div class="ttname"><a href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">DoFHandler::n_dofs</a></div><div class="ttdeci">types::global_dof_index n_dofs() const</div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_a887b88f558acbcf4a6621eb0f0d39772"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#a887b88f558acbcf4a6621eb0f0d39772">violated</a></div><div class="ttdeci">****This module contains classes that are used in the exception mechanism of deal II **Exceptions are used in two different not in static assertions are typically used to check that parameters to functions satisfy certain that internal data structures are and similar assertions For static assertions are used to make sure that two vectors that are added together have the same number of components **everything else would not make any sense anyway *Such checks are performed by the[2.x.3] macro in several thousand places within the library several tutorial programs starting with[2.x.4] show how to do this *If static a assertion is violated</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00013">exceptions_0.txt:13</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
