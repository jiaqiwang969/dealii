<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/timestep__control_8cc_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: source/algorithms/timestep_control.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_1f1e02da0ed68619c8cd86756bb8077c.html">algorithms</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">timestep_control.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="timestep__control_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2006 - 2019 by the deal.II authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="algorithms_2timestep__control_8h.html">deal.II/algorithms/timestep_control.h</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="base_2parameter__handler_8h.html">deal.II/base/parameter_handler.h</a>&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceAlgorithms.html">Algorithms</a>;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="classAlgorithms_1_1TimestepControl.html#a355a83ed80e5e327d9168a1175ca87a9">   25</a></span>&#160;<a class="code" href="classAlgorithms_1_1TimestepControl.html#a355a83ed80e5e327d9168a1175ca87a9">TimestepControl::TimestepControl</a>(<span class="keywordtype">double</span> <a class="code" href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a>,</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                                 <span class="keywordtype">double</span> <span class="keyword">final</span>,</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;                                 <span class="keywordtype">double</span> <a class="code" href="trilinos__precondition__0_8txt.html#ae2e38e4f182c566122b10d662b9d3f89">tolerance</a>,</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                                 <span class="keywordtype">double</span> start_step,</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;                                 <span class="keywordtype">double</span> print_step,</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                                 <span class="keywordtype">double</span> max_step)</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  : start_val(<a class="code" href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a>)</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  , final_val(final)</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  , tolerance_val(<a class="code" href="trilinos__precondition__0_8txt.html#ae2e38e4f182c566122b10d662b9d3f89">tolerance</a>)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  , start_step_val(start_step)</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  , max_step_val(max_step)</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  , min_step_val(0)</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  , current_step_val(start_step)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  , step_val(start_step)</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  , print_step(print_step)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  , next_print_val(print_step &gt; 0. ? start_val + print_step : start_val - 1.)</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#a4336137d139210df5cfb651372567aea">now_val</a> = <a class="code" href="classAlgorithms_1_1TimestepControl.html#ad1bf1bfd1a45e78e0c6cef404c0ffe9e">start_val</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <span class="comment">// avoid compiler warning</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  (void)<a class="code" href="classAlgorithms_1_1TimestepControl.html#a8efad9d4a3ced4f7490718da91ebb1a9">min_step_val</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160; </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="classAlgorithms_1_1TimestepControl.html#a6dc370b6b42d321fa6cd537808072d7b">   51</a></span>&#160;<a class="code" href="classAlgorithms_1_1TimestepControl.html#a6dc370b6b42d321fa6cd537808072d7b">TimestepControl::declare_parameters</a>(<a class="code" href="classParameterHandler.html">ParameterHandler</a> &amp;param)</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;{</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  param.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Start&quot;</span>, <span class="stringliteral">&quot;0.&quot;</span>, <a class="code" href="classPatterns_1_1Double.html">Patterns::Double</a>());</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  param.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Final&quot;</span>, <span class="stringliteral">&quot;1.&quot;</span>, <a class="code" href="classPatterns_1_1Double.html">Patterns::Double</a>());</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  param.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;First step&quot;</span>, <span class="stringliteral">&quot;1.e-2&quot;</span>, <a class="code" href="classPatterns_1_1Double.html">Patterns::Double</a>(0.));</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  param.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Max step&quot;</span>, <span class="stringliteral">&quot;1.&quot;</span>, <a class="code" href="classPatterns_1_1Double.html">Patterns::Double</a>(0.));</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  param.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Tolerance&quot;</span>, <span class="stringliteral">&quot;1.e-2&quot;</span>, <a class="code" href="classPatterns_1_1Double.html">Patterns::Double</a>(0.));</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  param.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Print step&quot;</span>, <span class="stringliteral">&quot;-1.&quot;</span>, <a class="code" href="classPatterns_1_1Double.html">Patterns::Double</a>());</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;}</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="keywordtype">void</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="classAlgorithms_1_1TimestepControl.html#aec8ee17103a14334f832a754a61b8592">   64</a></span>&#160;<a class="code" href="classAlgorithms_1_1TimestepControl.html#aec8ee17103a14334f832a754a61b8592">TimestepControl::parse_parameters</a>(<a class="code" href="classParameterHandler.html">ParameterHandler</a> &amp;param)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#a0d03937513235d571a5adfac14a3b2fa">start</a>(param.<a class="code" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">&quot;Start&quot;</span>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#ab250ad6b6e0090c23a69a5b0004395e0">start_step</a>(param.<a class="code" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">&quot;First step&quot;</span>));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#af9affb9139a1cdc118daba5be678e636">max_step</a>(param.<a class="code" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">&quot;Max step&quot;</span>));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keyword">final</span>(param.<a class="code" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">&quot;Final&quot;</span>));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#a3c7550340ffbdc7bdf89802f17096a9c">tolerance</a>(param.<a class="code" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">&quot;Tolerance&quot;</span>));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#ae3f67cf412ba4fde475bf5c42bc28ce0">print_step</a> = param.<a class="code" href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">get_double</a>(<span class="stringliteral">&quot;Print step&quot;</span>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;}</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160; </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="classAlgorithms_1_1TimestepControl.html#ae7430957134cb3dffa002f66a1267070">   77</a></span>&#160;<a class="code" href="classAlgorithms_1_1TimestepControl.html#ae7430957134cb3dffa002f66a1267070">TimestepControl::advance</a>()</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;{</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="theta__timestepping__0_8txt.html#afc30ee1ca2206d39fdb5e4119a1949c0">changed</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160; </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <span class="comment">// Try incrementing time by s</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="keywordtype">double</span> now_trial = <a class="code" href="classAlgorithms_1_1TimestepControl.html#a4336137d139210df5cfb651372567aea">now_val</a> + <a class="code" href="classAlgorithms_1_1TimestepControl.html#a3c7d1eae5fed3d4f72cb681e95f299b0">step_val</a>;</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#a1c1d1620c5a346517621e92cb502338a">current_step_val</a> = <a class="code" href="classAlgorithms_1_1TimestepControl.html#a3c7d1eae5fed3d4f72cb681e95f299b0">step_val</a>;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">// If we just missed the final time, increase the step size a bit. This way,</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <span class="comment">// we avoid a very small final step. If the step shot over the final time,</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="comment">// adjust it so we hit the final time exactly.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keywordtype">double</span> <a class="code" href="fe__system__0_8txt.html#a87c599652a2e9cab3cff29c83c34e566">s1</a> = .01 * <a class="code" href="classAlgorithms_1_1TimestepControl.html#a3c7d1eae5fed3d4f72cb681e95f299b0">step_val</a>;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">if</span> (now_trial &gt; <a class="code" href="classAlgorithms_1_1TimestepControl.html#a269b7ccc09131304acd69a3a31fc246b">final_val</a> - <a class="code" href="fe__system__0_8txt.html#a87c599652a2e9cab3cff29c83c34e566">s1</a>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    {</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      <a class="code" href="classAlgorithms_1_1TimestepControl.html#a1c1d1620c5a346517621e92cb502338a">current_step_val</a> = <a class="code" href="classAlgorithms_1_1TimestepControl.html#a269b7ccc09131304acd69a3a31fc246b">final_val</a> - <a class="code" href="classAlgorithms_1_1TimestepControl.html#a4336137d139210df5cfb651372567aea">now_val</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      now_trial        = <a class="code" href="classAlgorithms_1_1TimestepControl.html#a269b7ccc09131304acd69a3a31fc246b">final_val</a>;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      <a class="code" href="theta__timestepping__0_8txt.html#afc30ee1ca2206d39fdb5e4119a1949c0">changed</a>          = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    }</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="classAlgorithms_1_1TimestepControl.html#a4336137d139210df5cfb651372567aea">now_val</a> = now_trial;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="theta__timestepping__0_8txt.html#afc30ee1ca2206d39fdb5e4119a1949c0">changed</a>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;}</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keywordtype">bool</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="classAlgorithms_1_1TimestepControl.html#a9ec15a8fe16a77ce60a268cd8ebeefbc">  102</a></span>&#160;<a class="code" href="classAlgorithms_1_1TimestepControl.html#a9ec15a8fe16a77ce60a268cd8ebeefbc">TimestepControl::print</a>()</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;{</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classAlgorithms_1_1TimestepControl.html#ae3f67cf412ba4fde475bf5c42bc28ce0">print_step</a> == 0.)</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classAlgorithms_1_1TimestepControl.html#ae3f67cf412ba4fde475bf5c42bc28ce0">print_step</a> &lt; 0.)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a> = (<a class="code" href="classAlgorithms_1_1TimestepControl.html#a4336137d139210df5cfb651372567aea">now_val</a> &gt;= <a class="code" href="classAlgorithms_1_1TimestepControl.html#ae6a659eef67370c357a6249131e13f5a">next_print_val</a>);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;      <a class="code" href="classAlgorithms_1_1TimestepControl.html#ae6a659eef67370c357a6249131e13f5a">next_print_val</a> += <a class="code" href="classAlgorithms_1_1TimestepControl.html#ae3f67cf412ba4fde475bf5c42bc28ce0">print_step</a>;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classAlgorithms_1_1TimestepControl.html#ae6a659eef67370c357a6249131e13f5a">next_print_val</a> &gt; <a class="code" href="classAlgorithms_1_1TimestepControl.html#a269b7ccc09131304acd69a3a31fc246b">final_val</a>)</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="classAlgorithms_1_1TimestepControl.html#ae6a659eef67370c357a6249131e13f5a">next_print_val</a> = <a class="code" href="classAlgorithms_1_1TimestepControl.html#a269b7ccc09131304acd69a3a31fc246b">final_val</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    }</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_ae7430957134cb3dffa002f66a1267070"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#ae7430957134cb3dffa002f66a1267070">Algorithms::TimestepControl::advance</a></div><div class="ttdeci">bool advance()</div><div class="ttdef"><b>Definition:</b> <a href="timestep__control_8cc_source.html#l00077">timestep_control.cc:77</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_aeaf3c7846747695b1f327677e3716ec5"><div class="ttname"><a href="classParameterHandler.html#aeaf3c7846747695b1f327677e3716ec5">ParameterHandler::get_double</a></div><div class="ttdeci">double get_double(const std::string &amp;entry_name) const</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l01068">parameter_handler.cc:1068</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a3c7550340ffbdc7bdf89802f17096a9c"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a3c7550340ffbdc7bdf89802f17096a9c">Algorithms::TimestepControl::tolerance</a></div><div class="ttdeci">double tolerance() const</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00261">timestep_control.h:261</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a8efad9d4a3ced4f7490718da91ebb1a9"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a8efad9d4a3ced4f7490718da91ebb1a9">Algorithms::TimestepControl::min_step_val</a></div><div class="ttdeci">double min_step_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00202">timestep_control.h:202</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a355a83ed80e5e327d9168a1175ca87a9"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a355a83ed80e5e327d9168a1175ca87a9">Algorithms::TimestepControl::TimestepControl</a></div><div class="ttdeci">TimestepControl(double start=0., double final=1., double tolerance=1.e-2, double start_step=1.e-2, double print_step=-1., double max_step=1.)</div><div class="ttdef"><b>Definition:</b> <a href="timestep__control_8cc_source.html#l00025">timestep_control.cc:25</a></div></div>
<div class="ttc" id="abase_2parameter__handler_8h_html"><div class="ttname"><a href="base_2parameter__handler_8h.html">parameter_handler.h</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a6d65f458be69e23a348221cb67fc411d"><div class="ttname"><a href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">ParameterHandler::declare_entry</a></div><div class="ttdeci">void declare_entry(const std::string &amp;entry, const std::string &amp;default_value, const Patterns::PatternBase &amp;pattern=Patterns::Anything(), const std::string &amp;documentation=&quot;&quot;, const bool has_to_be_set=false)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l00796">parameter_handler.cc:796</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_ae6a659eef67370c357a6249131e13f5a"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#ae6a659eef67370c357a6249131e13f5a">Algorithms::TimestepControl::next_print_val</a></div><div class="ttdeci">double next_print_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00235">timestep_control.h:235</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a6dc370b6b42d321fa6cd537808072d7b"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a6dc370b6b42d321fa6cd537808072d7b">Algorithms::TimestepControl::declare_parameters</a></div><div class="ttdeci">static void declare_parameters(ParameterHandler &amp;param)</div><div class="ttdef"><b>Definition:</b> <a href="timestep__control_8cc_source.html#l00051">timestep_control.cc:51</a></div></div>
<div class="ttc" id="afe__system__0_8txt_html_a87c599652a2e9cab3cff29c83c34e566"><div class="ttname"><a href="fe__system__0_8txt.html#a87c599652a2e9cab3cff29c83c34e566">s1</a></div><div class="ttdeci">no requirement exist between shape functions of different i e in the above the respective value of the[2.x.39] velocity is only coupled to[2.x.40] at the vertices and the line on the larger cell next to this but there is no interaction with[2.x.41] and[2.x.42] of this or the other cell ***The overall numbering of degrees of freedom is as or the degrees of freedom are numbered such that we run over all subelements before turning for the next dof on this subobject or for the next subobject For for an element of three components in one space the first two components being cubic lagrange elements and the third being a quadratic lagrange the ordering for the system&lt; tt &gt; s1</div><div class="ttdef"><b>Definition:</b> <a href="fe__system__0_8txt_source.html#l00058">fe_system_0.txt:58</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a9ec15a8fe16a77ce60a268cd8ebeefbc"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a9ec15a8fe16a77ce60a268cd8ebeefbc">Algorithms::TimestepControl::print</a></div><div class="ttdeci">bool print()</div><div class="ttdef"><b>Definition:</b> <a href="timestep__control_8cc_source.html#l00102">timestep_control.cc:102</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_ae3f67cf412ba4fde475bf5c42bc28ce0"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#ae3f67cf412ba4fde475bf5c42bc28ce0">Algorithms::TimestepControl::print_step</a></div><div class="ttdeci">double print_step</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00229">timestep_control.h:229</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_ad1bf1bfd1a45e78e0c6cef404c0ffe9e"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#ad1bf1bfd1a45e78e0c6cef404c0ffe9e">Algorithms::TimestepControl::start_val</a></div><div class="ttdeci">double start_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00172">timestep_control.h:172</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a0d03937513235d571a5adfac14a3b2fa"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a0d03937513235d571a5adfac14a3b2fa">Algorithms::TimestepControl::start</a></div><div class="ttdeci">double start() const</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00240">timestep_control.h:240</a></div></div>
<div class="ttc" id="atrilinos__precondition__0_8txt_html_ae2e38e4f182c566122b10d662b9d3f89"><div class="ttname"><a href="trilinos__precondition__0_8txt.html#ae2e38e4f182c566122b10d662b9d3f89">tolerance</a></div><div class="ttdeci">more required fill in elements require this parameter to be set to a higher integer value The AdditionalData data structure allows to set preconditioner options Besides the fill in these options are some options for and a parameter&lt; tt &gt; overlap&lt;/tt &gt; that determines if and how much overlap there should be between the matrix partitions on the various MPI processes The default settings are for the additional fill for the absolute augmentation tolerance</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__precondition__0_8txt_source.html#l00174">trilinos_precondition_0.txt:174</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a1c1d1620c5a346517621e92cb502338a"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a1c1d1620c5a346517621e92cb502338a">Algorithms::TimestepControl::current_step_val</a></div><div class="ttdeci">double current_step_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00209">timestep_control.h:209</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_ab250ad6b6e0090c23a69a5b0004395e0"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#ab250ad6b6e0090c23a69a5b0004395e0">Algorithms::TimestepControl::start_step</a></div><div class="ttdeci">void start_step(const double step)</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00296">timestep_control.h:296</a></div></div>
<div class="ttc" id="atheta__timestepping__0_8txt_html_afc30ee1ca2206d39fdb5e4119a1949c0"><div class="ttname"><a href="theta__timestepping__0_8txt.html#afc30ee1ca2206d39fdb5e4119a1949c0">changed</a></div><div class="ttdeci">*A little gathering the size of a timestep and the current time Time stepping schemes can use this to provide time step information to the classes actually performing a single step The definition of what is considered current time depends on the scheme For an this is the time at the beginning of the step For an implicit it is usually the time at the end **Application class performing the theta timestepping scheme The theta scheme is an abstraction of implicit and explicit Euler schemes the Crank Nicholson scheme and linear combinations of those The choice of the actual scheme is controlled by the parameter theta as follows *[2.x.0][2.x.1] *These operators will be implemented after the main program But let us look first at how they get used let us define a matrix to be used for our system and also an OutputOperator in order to write the data of each timestep to a file **Now we create objects for the implicit and parts of the steps as well as the ThetaTimestepping itself We initialize the timestepping with the output we first get the time step size from the AnyData object that was provided as input if we are in the first step or if the timestep has changed</div><div class="ttdef"><b>Definition:</b> <a href="theta__timestepping__0_8txt_source.html#l00016">theta_timestepping_0.txt:16</a></div></div>
<div class="ttc" id="adof__tools__0_8txt_html_a9442956f28da0afe6f6e41e15e33d525"><div class="ttname"><a href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a></div><div class="ttdeci">namespace the creation of the sparsity pattern is done by the it needs to have a numbering of all those degrees of freedom that are on those parts of the boundary that we are interested in You can get this from the where[2.x.10] and[2.x.11] are indices into the and[2.x.12] is the global DoF number of a degree of freedom sitting on a remember that these flags are used as elements of tables of size[2.x.16] times[2.x.17] where each element indicates whether two components do or do not couple **Two components do not couple **Two components do couple **Two components couple only if their shape functions are both nonzero on a given face This flag is only used when computing integrals over faces of e in[2.x.18] Use[2.x.19] in general cases where gradients etc occur on face integrals **DoF couplings *[2.x.21] *Map a coupling table from the user friendly organization by components to the organization by blocks The return vector will be initialized to the correct length inside this function **Given a finite element and a table how the vector components of it couple with each compute and return a table that describes how the individual shape functions couple with each other **Same function as above for a collection of finite returning a collection of tables The function currently treats[2.x.22] the same as *[2.x.23] ***Sparsity pattern generation *[2.x.26] *Compute which entries of a matrix built on the given[2.x.27] may possibly be and create a sparsity pattern object that represents these nonzero locations This function computes the possible positions of non zero entries in the global system matrix by[1.x.3] which entries one would write to during the actual assembly of a matrix For the function assumes that each finite element basis function is non zero on a cell only if its degree of freedom is associated with the a an edge or a vertex of this cell As a result</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__0_8txt_source.html#l00049">dof_tools_0.txt:49</a></div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_af9affb9139a1cdc118daba5be678e636"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#af9affb9139a1cdc118daba5be678e636">Algorithms::TimestepControl::max_step</a></div><div class="ttdeci">void max_step(double)</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00303">timestep_control.h:303</a></div></div>
<div class="ttc" id="aalgorithms_2timestep__control_8h_html"><div class="ttname"><a href="algorithms_2timestep__control_8h.html">timestep_control.h</a></div></div>
<div class="ttc" id="anamespaceAlgorithms_html"><div class="ttname"><a href="namespaceAlgorithms.html">Algorithms</a></div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2newton_8h_source.html#l00036">newton.h:36</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_aec8ee17103a14334f832a754a61b8592"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#aec8ee17103a14334f832a754a61b8592">Algorithms::TimestepControl::parse_parameters</a></div><div class="ttdeci">void parse_parameters(ParameterHandler &amp;param)</div><div class="ttdef"><b>Definition:</b> <a href="timestep__control_8cc_source.html#l00064">timestep_control.cc:64</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a3c7d1eae5fed3d4f72cb681e95f299b0"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a3c7d1eae5fed3d4f72cb681e95f299b0">Algorithms::TimestepControl::step_val</a></div><div class="ttdeci">double step_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00216">timestep_control.h:216</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a269b7ccc09131304acd69a3a31fc246b"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a269b7ccc09131304acd69a3a31fc246b">Algorithms::TimestepControl::final_val</a></div><div class="ttdeci">double final_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00178">timestep_control.h:178</a></div></div>
<div class="ttc" id="atimer__0_8txt_html_a48e9e3a8116df3cc4b62db810904e91f"><div class="ttname"><a href="timer__0_8txt.html#a48e9e3a8116df3cc4b62db810904e91f">start</a></div><div class="ttdeci">*A compatible with the[2.x.0] notion of a whose by in multiples of of a second and POSIX uses so go with microseconds for uniformity **Signed integral type used to store the value returned by this requires platform specific so this function returns on platforms that are neither Windows nor POSIX **The Timer class provides a way to measure both the amount of wall or[2.x.1] as well as the total time elapsed over all laps Here is an you can also restart the timer instead of resetting it The times between successive calls to start() and stop()(i.e.</div></div>
<div class="ttc" id="aclassParameterHandler_html"><div class="ttname"><a href="classParameterHandler.html">ParameterHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__handler_8h_source.html#l00820">parameter_handler.h:820</a></div></div>
<div class="ttc" id="aclassAlgorithms_1_1TimestepControl_html_a4336137d139210df5cfb651372567aea"><div class="ttname"><a href="classAlgorithms_1_1TimestepControl.html#a4336137d139210df5cfb651372567aea">Algorithms::TimestepControl::now_val</a></div><div class="ttdeci">double now_val</div><div class="ttdef"><b>Definition:</b> <a href="algorithms_2timestep__control_8h_source.html#l00222">timestep_control.h:222</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Double_html"><div class="ttname"><a href="classPatterns_1_1Double.html">Patterns::Double</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l00307">patterns.h:307</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
