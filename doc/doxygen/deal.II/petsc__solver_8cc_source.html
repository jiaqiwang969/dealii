<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/petsc__solver_8cc_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: source/lac/petsc_solver.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_d5c75a340e4829ceb672546587d22d54.html">lac</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">petsc_solver.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="petsc__solver_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2004 - 2021 by the deal.II authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2petsc__solver_8h.html">deal.II/lac/petsc_solver.h</a>&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifdef DEAL_II_WITH_PETSC</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="include_2deal_8II_2lac_2exceptions_8h.html">deal.II/lac/exceptions.h</a>&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="lac_2petsc__compatibility_8h.html">deal.II/lac/petsc_compatibility.h</a>&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="lac_2petsc__matrix__base_8h.html">deal.II/lac/petsc_matrix_base.h</a>&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="lac_2petsc__precondition_8h.html">deal.II/lac/petsc_precondition.h</a>&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="lac_2petsc__vector__base_8h.html">deal.II/lac/petsc_vector_base.h</a>&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#  include &lt;petscversion.h&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#  include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#  include &lt;memory&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacePETScWrappers.html">PETScWrappers</a></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;{</div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structPETScWrappers_1_1SolverBase_1_1SolverData.html#a20af42c76ed6d4735693c5f3b45f4064">   38</a></span>&#160;  <a class="code" href="structPETScWrappers_1_1SolverBase_1_1SolverData.html#a20af42c76ed6d4735693c5f3b45f4064">SolverBase::SolverData::~SolverData</a>()</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  {</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="namespacePETScWrappers.html#a8d5ac4c26e7010d975fcfd04c5b039e9">destroy_krylov_solver</a>(<a class="code" href="structPETScWrappers_1_1SolverBase_1_1SolverData.html#a3b67abc1b21e164f52a19d0a3852689e">ksp</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  }</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#ad8abf2cd55633333a0fd6d6553724958">   45</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#ad8abf2cd55633333a0fd6d6553724958">SolverBase::SolverBase</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;cn, <span class="keyword">const</span> MPI_Comm &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>)</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>(cn)</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    , <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>(<a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  {}</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#abfc375c07a38e1314a79c6a1093edb53">   53</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#abfc375c07a38e1314a79c6a1093edb53">SolverBase::solve</a>(<span class="keyword">const</span> <a class="code" href="classPETScWrappers_1_1MatrixBase.html">MatrixBase</a> &amp;      <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>,</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                    <a class="code" href="classPETScWrappers_1_1VectorBase.html">VectorBase</a> &amp;            <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classPETScWrappers_1_1VectorBase.html">VectorBase</a> &amp;      <a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>,</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                    <span class="keyword">const</span> <a class="code" href="classPETScWrappers_1_1PreconditionBase.html">PreconditionBase</a> &amp;<a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment">      TODO: PETSc duplicates communicators, so this does not work (you put</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment">    MPI_COMM_SELF in, but get something other out when you ask PETSc for the</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">    communicator. This mainly fails due to the MatrixFree classes, that can not</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">    ask PETSc for a communicator. //Timo Heister</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">    Assert(A.get_mpi_communicator()==mpi_communicator, ExcMessage(&quot;PETSc Solver</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment">    and Matrix need to use the same MPI_Comm.&quot;));</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment">    Assert(x.get_mpi_communicator()==mpi_communicator, ExcMessage(&quot;PETSc Solver</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment">    and Vector need to use the same MPI_Comm.&quot;));</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment">    Assert(b.get_mpi_communicator()==mpi_communicator, ExcMessage(&quot;PETSc Solver</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">    and Vector need to use the same MPI_Comm.&quot;));</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// first create a solver object if this</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="comment">// is necessary</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>.get() == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a> = std::make_unique&lt;SolverData&gt;();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        PetscErrorCode ierr = KSPCreate(<a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>, &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        <span class="comment">// let derived classes set the solver</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        <span class="comment">// type, and the preconditioning</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <span class="comment">// object set the type of</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <span class="comment">// preconditioner</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        <a class="code" href="classPETScWrappers_1_1SolverBase.html#a13eec5bf768040dffb3be81e04df71dd">set_solver_type</a>(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        ierr = KSPSetPC(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp, <a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>.get_pc());</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="comment">// make sure the preconditioner has an associated matrix set</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keyword">const</span> Mat B = <a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(B != <span class="keyword">nullptr</span>,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                    <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;PETSc preconditioner should have an &quot;</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;                               <span class="stringliteral">&quot;associated matrix set to be used in solver.&quot;</span>));</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="comment">// setting the preconditioner overwrites the used matrices.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        <span class="comment">// hence, we need to set the matrices after the preconditioner.</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="preprocessor">#  if DEAL_II_PETSC_VERSION_LT(3, 5, 0)</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="comment">// the last argument is irrelevant here,</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="comment">// since we use the solver only once anyway</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        ierr = KSPSetOperators(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                               <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                               <a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                               SAME_PRECONDITIONER);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="preprocessor">#  else</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        ierr = KSPSetOperators(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp, <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>, <a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="comment">// then a convergence monitor</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="comment">// function. that function simply</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        <span class="comment">// checks with the solver_control</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        <span class="comment">// object we have in this object for</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="comment">// convergence</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        ierr = KSPSetConvergenceTest(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp,</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                                     &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a71e97d3ad2075793e1f177f7128299b8">convergence_test</a>,</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                                     <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(&amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>),</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                                     <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    <span class="comment">// set the command line option prefix name</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    PetscErrorCode ierr =</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      KSPSetOptionsPrefix(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp, <a class="code" href="classPETScWrappers_1_1SolverBase.html#a1693decd08f4666d89c887d44c8a4dce">prefix_name</a>.c_str());</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">// set the command line options provided</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="comment">// by the user to override the defaults</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    ierr = KSPSetFromOptions(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// then do the real work: set up solver</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="comment">// internal data and solve the</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// system.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    ierr = KSPSetUp(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    ierr = KSPSolve(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp, <a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>, <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// do not destroy solver object</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="comment">//    solver_data.reset ();</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="comment">// in case of failure: throw</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="comment">// exception</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a1558e27e46b7204a5154adf81038da07">last_check</a>() != <a class="code" href="classSolverControl.html#afcdeab4b55513dbd766b56e35efecbaaabbc662e5ce1fe64021a2e3d8cfe2d036">SolverControl::success</a>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                  <a class="code" href="classSolverControl_1_1NoConvergence.html">SolverControl::NoConvergence</a>(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a42aeae81cd6b67ce93b5fbea3328371f">last_step</a>(),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                               <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a4a3b4da9834a3a5f1da12fa8fcc074f0">last_value</a>()));</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="comment">// otherwise exit as normal</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00154"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#a912ada8e128dc3a23f9e0c2dac87d51a">  154</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#a912ada8e128dc3a23f9e0c2dac87d51a">SolverBase::set_prefix</a>(<span class="keyword">const</span> std::string &amp;prefix)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    <a class="code" href="classPETScWrappers_1_1SolverBase.html#a1693decd08f4666d89c887d44c8a4dce">prefix_name</a> = prefix;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  }</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#a8724b9c6cc906bf5213c09f09dbd9a32">  161</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#a8724b9c6cc906bf5213c09f09dbd9a32">SolverBase::reset</a>()</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    <a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>.reset();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="classSolverControl.html">SolverControl</a> &amp;</div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#a271b791d8cb267ae211c56a0499385c4">  168</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#a271b791d8cb267ae211c56a0499385c4">SolverBase::control</a>()<span class="keyword"> const</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="keywordtype">int</span></div>
<div class="line"><a name="l00175"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#a71e97d3ad2075793e1f177f7128299b8">  175</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#a71e97d3ad2075793e1f177f7128299b8">SolverBase::convergence_test</a>(KSP <span class="comment">/*ksp*/</span>,</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;                               <span class="keyword">const</span> PetscInt      <a class="code" href="preconditioners__0_8txt.html#abebc9af399f7664771e26564a49c8dc1">iteration</a>,</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;                               <span class="keyword">const</span> PetscReal     residual_norm,</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                               KSPConvergedReason *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a>,</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                               <span class="keywordtype">void</span> *              solver_control_x)</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classSolverControl.html">SolverControl</a> &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a> =</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      *<span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classSolverControl.html">SolverControl</a> *<span class="keyword">&gt;</span>(solver_control_x);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <span class="keyword">const</span> <a class="code" href="classSolverControl.html#afcdeab4b55513dbd766b56e35efecbaa">SolverControl::State</a> <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> =</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a56fdf4c8d099edaca6fad443d7c76649">check</a>(<a class="code" href="preconditioners__0_8txt.html#abebc9af399f7664771e26564a49c8dc1">iteration</a>, residual_norm);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        <a class="code" href="kinsol__0_8txt.html#afe1eeca1ecfef01d41c7cbe94b9639dd">case ::SolverControl::iterate</a>:</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;          *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = KSP_CONVERGED_ITERATING;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        case ::SolverControl::success:</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;          *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = <span class="keyword">static_cast&lt;</span>KSPConvergedReason<span class="keyword">&gt;</span>(1);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        case ::SolverControl::failure:</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a42aeae81cd6b67ce93b5fbea3328371f">last_step</a>() &gt; <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#aba046b0a2315e735fdf17d36ecb44f0b">max_steps</a>())</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = KSP_DIVERGED_ITS;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;            *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = KSP_DIVERGED_DTOL;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160; </div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      }</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <span class="comment">// return without failure</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBase.html#a63996b94c34f0fcf590c725d4decc06f">  213</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBase.html#a63996b94c34f0fcf590c725d4decc06f">SolverBase::initialize</a>(<span class="keyword">const</span> <a class="code" href="classPETScWrappers_1_1PreconditionBase.html">PreconditionBase</a> &amp;<a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>)</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  {</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    PetscErrorCode ierr;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a> = std::make_unique&lt;SolverData&gt;();</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    ierr = KSPCreate(<a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>, &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// let derived classes set the solver</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">// type, and the preconditioning</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">// object set the type of</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="comment">// preconditioner</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <a class="code" href="classPETScWrappers_1_1SolverBase.html#a13eec5bf768040dffb3be81e04df71dd">set_solver_type</a>(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    ierr = KSPSetPC(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp, <a class="code" href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a>.get_pc());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// then a convergence monitor</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="comment">// function. that function simply</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// checks with the solver_control</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// object we have in this object for</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// convergence</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    ierr = KSPSetConvergenceTest(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                 &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a71e97d3ad2075793e1f177f7128299b8">convergence_test</a>,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                 <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(&amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>),</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                 <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="comment">// set the command line options provided</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="comment">// by the user to override the defaults</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    ierr = KSPSetFromOptions(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="comment">/* ---------------------- SolverRichardson ------------------------ */</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html#a2b84d6dade4dd8f5da036866c1195b75">  252</a></span>&#160;  <a class="code" href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html#a2b84d6dade4dd8f5da036866c1195b75">SolverRichardson::AdditionalData::AdditionalData</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> omega)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    : omega(omega)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  {}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverRichardson.html#a4e0b1b3290b125e1b476d6c1c5b8de17">  258</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverRichardson.html#a4e0b1b3290b125e1b476d6c1c5b8de17">SolverRichardson::SolverRichardson</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                     <span class="keyword">const</span> MPI_Comm &amp;      <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>)</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    , <a class="code" href="classPETScWrappers_1_1SolverRichardson.html#a5420342e17831c2737cf9db695429774">additional_data</a>(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  {}</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160; </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverRichardson.html#a81d743e8bb544846339b1757711d4add">  267</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverRichardson.html#a81d743e8bb544846339b1757711d4add">SolverRichardson::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPRICHARDSON);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="comment">// set the damping factor from the data</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    ierr = KSPRichardsonSetScale(ksp, <a class="code" href="classPETScWrappers_1_1SolverRichardson.html#a5420342e17831c2737cf9db695429774">additional_data</a>.<a class="code" href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html#a780fc35f5e5f6b41840e909cf65496ae">omega</a>);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    <span class="comment">// Hand over the absolute</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="comment">// tolerance and the maximum</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// iteration number to the PETSc</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="comment">// convergence criterion. The</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">// custom deal.II SolverControl</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="comment">// object is ignored by the PETSc</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="comment">// Richardson method (when no</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="comment">// PETSc monitoring is present),</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// since in this case PETSc</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="comment">// uses a faster version of</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="comment">// the Richardson iteration,</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// where no residual is</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// available.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    ierr = KSPSetTolerances(ksp,</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                            PETSC_DEFAULT,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                            this-&gt;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#ade280d37d8b399d293982a0c64953033">tolerance</a>(),</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                            PETSC_DEFAULT,</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a>-&gt;solver_control.max_steps() + 1);</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160; </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="comment">/* ---------------------- SolverChebychev ------------------------ */</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverChebychev.html#a28e30004e6934db26875d1e3cb7aa721">  306</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverChebychev.html#a28e30004e6934db26875d1e3cb7aa721">SolverChebychev::SolverChebychev</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                                   <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverChebychev_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  {}</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00315"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverChebychev.html#a1db7856395fc62644b0564fb6c86e212">  315</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverChebychev.html#a1db7856395fc62644b0564fb6c86e212">SolverChebychev::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPCHEBYSHEV);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; </div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  }</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="comment">/* ---------------------- SolverCG ------------------------ */</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverCG.html#a91de1d30904b69e690d2786e5850940f">  330</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverCG.html#a91de1d30904b69e690d2786e5850940f">SolverCG::SolverCG</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                     <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                     <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverCG_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  {}</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverCG.html#ad121c05be905cfef7aa562fac1af0cfd">  339</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverCG.html#ad121c05be905cfef7aa562fac1af0cfd">SolverCG::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPCG);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <span class="comment">/* ---------------------- SolverBiCG ------------------------ */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBiCG.html#a28fda07f2844c3b5602aed8bfb9ccc3b">  354</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBiCG.html#a28fda07f2844c3b5602aed8bfb9ccc3b">SolverBiCG::SolverBiCG</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                         <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                         <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverBiCG_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  {}</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBiCG.html#a462c9fc09e84dc40e64b0c44f4bc22c1">  363</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBiCG.html#a462c9fc09e84dc40e64b0c44f4bc22c1">SolverBiCG::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPBICG);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160; </div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="comment">/* ---------------------- SolverGMRES ------------------------ */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160; </div>
<div class="line"><a name="l00378"></a><span class="lineno"><a class="line" href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a4185706bd59744601ac0a68bfe489c2a">  378</a></span>&#160;  <a class="code" href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a4185706bd59744601ac0a68bfe489c2a">SolverGMRES::AdditionalData::AdditionalData</a>(</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> restart_parameter,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span>         right_preconditioning)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    : restart_parameter(restart_parameter)</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    , right_preconditioning(right_preconditioning)</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  {}</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160; </div>
<div class="line"><a name="l00387"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverGMRES.html#aa67bdf780098b031e843dfbe0032ee17">  387</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverGMRES.html#aa67bdf780098b031e843dfbe0032ee17">SolverGMRES::SolverGMRES</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                           <span class="keyword">const</span> MPI_Comm &amp;      <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>,</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                           <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    , <a class="code" href="classPETScWrappers_1_1SolverGMRES.html#a41051c02104c0914244c15b5044f2e8e">additional_data</a>(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  {}</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00396"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverGMRES.html#abf64e01b6a4c50a5702ab31911aa2e7b">  396</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverGMRES.html#abf64e01b6a4c50a5702ab31911aa2e7b">SolverGMRES::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPGMRES);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// set the restart parameter from the</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">// data. we would like to use the simple</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="comment">// code that is commented out, but this</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">// leads to nasty warning and error</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// messages due to some stupidity on</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// PETSc&#39;s side: KSPGMRESSetRestart is</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="comment">// implemented as a macro in which return</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="comment">// statements are hidden. This may work</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// if people strictly follow the PETSc</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">// coding style of always having</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// functions return an integer error</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// code, but the present function isn&#39;t</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="comment">// like this.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="comment">        ierr = KSPGMRESSetRestart (ksp, additional_data.restart_parameter);</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="comment">        AssertThrow (ierr == 0, ExcPETScError(ierr));</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment">    */</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">// so rather expand their macros by hand,</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="comment">// and do some equally nasty stuff that at</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="comment">// least doesn&#39;t yield warnings...</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <a class="code" href="table__handler__0_8txt.html#aa02519610f643695a6a4f66c4062392a">int</a> (*fun_ptr)(KSP, <a class="code" href="table__handler__0_8txt.html#aa02519610f643695a6a4f66c4062392a">int</a>);</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    ierr = PetscObjectQueryFunction(<span class="keyword">reinterpret_cast&lt;</span>PetscObject<span class="keyword">&gt;</span>(ksp),</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                    <span class="stringliteral">&quot;KSPGMRESSetRestart_C&quot;</span>,</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                                    <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span> (**)()<span class="keyword">&gt;</span>(&amp;fun_ptr));</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    ierr = (*fun_ptr)(ksp, <a class="code" href="classPETScWrappers_1_1SolverGMRES.html#a41051c02104c0914244c15b5044f2e8e">additional_data</a>.<a class="code" href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a1cf5f076c7bfdd2bd19e202bf6c041c1">restart_parameter</a>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="comment">// Set preconditioning side to</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// right</span></div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SolverGMRES.html#a41051c02104c0914244c15b5044f2e8e">additional_data</a>.<a class="code" href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a51ed265e304a2828b72fa43def8cc971">right_preconditioning</a>)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;        ierr = KSPSetPCSide(ksp, PC_RIGHT);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;  }</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="comment">/* ---------------------- SolverBicgstab ------------------------ */</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160; </div>
<div class="line"><a name="l00448"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBicgstab.html#a39506f6ed266b8694df6b1cdf181c3c1">  448</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBicgstab.html#a39506f6ed266b8694df6b1cdf181c3c1">SolverBicgstab::SolverBicgstab</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                                 <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverBicgstab_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;  {}</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverBicgstab.html#a8e3b0b24309b6477b5a68f99292221eb">  457</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverBicgstab.html#a8e3b0b24309b6477b5a68f99292221eb">SolverBicgstab::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPBCGS);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">/* ---------------------- SolverCGS ------------------------ */</span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverCGS.html#a007e687d16b4cb7eb2ee1088b718924f">  472</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverCGS.html#a007e687d16b4cb7eb2ee1088b718924f">SolverCGS::SolverCGS</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                       <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                       <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverCGS_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  {}</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverCGS.html#a868cb10d96fc427b89679b9a4c369558">  481</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverCGS.html#a868cb10d96fc427b89679b9a4c369558">SolverCGS::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPCGS);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160; </div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;  <span class="comment">/* ---------------------- SolverTFQMR ------------------------ */</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160; </div>
<div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverTFQMR.html#a17835b5cba535fb2a01e297d27e4098f">  496</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverTFQMR.html#a17835b5cba535fb2a01e297d27e4098f">SolverTFQMR::SolverTFQMR</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                           <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                           <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverTFQMR_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  {}</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverTFQMR.html#a46f7615be6a43c00dc69df74061d3e5f">  505</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverTFQMR.html#a46f7615be6a43c00dc69df74061d3e5f">SolverTFQMR::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPTFQMR);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;  }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160; </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">/* ---------------------- SolverTCQMR ------------------------ */</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverTCQMR.html#a97ea37a631ba7d3a24041825a8ccb678">  520</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverTCQMR.html#a97ea37a631ba7d3a24041825a8ccb678">SolverTCQMR::SolverTCQMR</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                           <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                           <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverTCQMR_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;  {}</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; </div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00529"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverTCQMR.html#a897b6471eb71a5e758723de0d2e9f07b">  529</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverTCQMR.html#a897b6471eb71a5e758723de0d2e9f07b">SolverTCQMR::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPTCQMR);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  }</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  <span class="comment">/* ---------------------- SolverCR ------------------------ */</span></div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverCR.html#aa8d18b8a702eab68f664f0962fd5c991">  544</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverCR.html#aa8d18b8a702eab68f664f0962fd5c991">SolverCR::SolverCR</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                     <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                     <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverCR_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  {}</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00553"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverCR.html#a24dbd85ed98ac21a0391c54663cf9deb">  553</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverCR.html#a24dbd85ed98ac21a0391c54663cf9deb">SolverCR::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPCR);</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160; </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;  <span class="comment">/* ---------------------- SolverLSQR ------------------------ */</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverLSQR.html#a7baca62a81cdfa5d6e1180c157b8a3d3">  568</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverLSQR.html#a7baca62a81cdfa5d6e1180c157b8a3d3">SolverLSQR::SolverLSQR</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                         <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                         <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverLSQR_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  {}</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00577"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverLSQR.html#a14a9909be0b71d5047cd9569136a915e">  577</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverLSQR.html#a14a9909be0b71d5047cd9569136a915e">SolverLSQR::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPLSQR);</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">// in the deal.II solvers, we always</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <span class="comment">// honor the initial guess in the</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="comment">// solution vector. do so here as well:</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_TRUE);</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  }</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; </div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  <span class="comment">/* ---------------------- SolverPreOnly ------------------------ */</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverPreOnly.html#a6d7bc3d1245a8d0a6d3d66d3c1fb56dd">  592</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverPreOnly.html#a6d7bc3d1245a8d0a6d3d66d3c1fb56dd">SolverPreOnly::SolverPreOnly</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                               <span class="keyword">const</span> MPI_Comm &amp;      mpi_communicator,</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                               <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SolverPreOnly_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, mpi_communicator)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    , additional_data(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  {}</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00601"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SolverPreOnly.html#acb09d6c22c20e52b65ec87caae8cbace">  601</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SolverPreOnly.html#acb09d6c22c20e52b65ec87caae8cbace">SolverPreOnly::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPPREONLY);</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="comment">// The KSPPREONLY solver of</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="comment">// PETSc never calls the convergence</span></div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="comment">// monitor, which leads to failure</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// even when everything was ok.</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="comment">// Therefore the SolverControl status</span></div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="comment">// is set to some nice values, which</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// guarantee a nice result at the end</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <span class="comment">// of the solution process.</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a56fdf4c8d099edaca6fad443d7c76649">check</a>(1, 0.0);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <span class="comment">// Using the PREONLY solver with</span></div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="comment">// a nonzero initial guess leads</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    <span class="comment">// PETSc to produce some error messages.</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_FALSE);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="comment">/* ---------------------- SparseDirectMUMPS------------------------ */</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno"><a class="line" href="structPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS.html#af72cb2c7bd2ec22f2420cd718fb4524d">  626</a></span>&#160;  <a class="code" href="structPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS.html#af72cb2c7bd2ec22f2420cd718fb4524d">SparseDirectMUMPS::SolverDataMUMPS::~SolverDataMUMPS</a>()</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <a class="code" href="namespacePETScWrappers.html#a8d5ac4c26e7010d975fcfd04c5b039e9">destroy_krylov_solver</a>(<a class="code" href="structPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS.html#a2d3894b66468ce36744fc2807dc96f60">ksp</a>);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="comment">// the &#39;pc&#39; object is owned by the &#39;ksp&#39; object, and consequently</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="comment">// does not have to be destroyed explicitly here</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  }</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; </div>
<div class="line"><a name="l00634"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SparseDirectMUMPS.html#acafdb3b2a37a53914bb8958ccdbfa44c">  634</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#acafdb3b2a37a53914bb8958ccdbfa44c">SparseDirectMUMPS::SparseDirectMUMPS</a>(<a class="code" href="classSolverControl.html">SolverControl</a> &amp;       cn,</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                                       <span class="keyword">const</span> MPI_Comm &amp;      <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="structPETScWrappers_1_1SparseDirectMUMPS_1_1AdditionalData.html">AdditionalData</a> &amp;<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    : <a class="code" href="classPETScWrappers_1_1SolverBase.html">SolverBase</a>(cn, <a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>)</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    , <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a4454c586867254222e3dd5eeecdaf27f">additional_data</a>(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>)</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    , <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#adc29243b7a37499a9e31f6cf05a47bfc">symmetric_mode</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a>)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  {}</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160; </div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00644"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a11450efb60c23f89b1467deb4efd8a61">  644</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a11450efb60c23f89b1467deb4efd8a61">SparseDirectMUMPS::set_solver_type</a>(KSP &amp;ksp)<span class="keyword"> const</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keyword">  </span>{</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="comment">     * KSPPREONLY implements a stub method that applies only the</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="comment">     * preconditioner.  Its use is due to SparseDirectMUMPS being a direct</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="comment">     * (rather than iterative) solver</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    PetscErrorCode ierr = KSPSetType(ksp, KSPPREONLY);</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="comment">     * The KSPPREONLY solver of PETSc never calls the convergence monitor,</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="comment">     * which leads to failure even when everything was ok. Therefore, the</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="comment">     * SolverControl status is set to some nice values, which guarantee a</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="comment">     * nice result at the end of the solution process.</span></div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a56fdf4c8d099edaca6fad443d7c76649">check</a>(1, 0.0);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160; </div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment">     * Using a PREONLY solver with a nonzero initial guess leads PETSc to</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment">     * produce some error messages.</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    ierr = KSPSetInitialGuessNonzero(ksp, PETSC_FALSE);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160; </div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00671"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a08d73453888955bd5a9863be32f3b347">  671</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a08d73453888955bd5a9863be32f3b347">SparseDirectMUMPS::solve</a>(<span class="keyword">const</span> <a class="code" href="classPETScWrappers_1_1MatrixBase.html">MatrixBase</a> &amp;<a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>,</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;                           <a class="code" href="classPETScWrappers_1_1VectorBase.html">VectorBase</a> &amp;      <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;                           <span class="keyword">const</span> <a class="code" href="classPETScWrappers_1_1VectorBase.html">VectorBase</a> &amp;<a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>)</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  {</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="preprocessor">#  ifdef DEAL_II_PETSC_WITH_MUMPS</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">     * factorization matrix to be obtained from MUMPS</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    Mat <a class="code" href="fe__nedelec__sz__0_8txt.html#ae0c48442a4b869ada9ce9f16c1a9bdb6">F</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="comment">     * setting MUMPS integer control parameters ICNTL to be passed to</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">     * MUMPS.  Setting entry 7 of MUMPS ICNTL array (of size 40) to a value</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">     * of 2. This sets use of Approximate Minimum Fill (AMF)</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    PetscInt ival = 2, icntl = 7;</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="comment">     * number of iterations to solution (should be 1) for a direct solver</span></div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    PetscInt its;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="comment">     * norm of residual</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    PetscReal rnorm;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="comment">     * creating a solver object if this is necessary</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a> == <span class="keyword">nullptr</span>)</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;      {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a> = std::make_unique&lt;SolverDataMUMPS&gt;();</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160; </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment">         * creates the default KSP context and puts it in the location</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment">         * solver_data-&gt;ksp</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        PetscErrorCode ierr = KSPCreate(<a class="code" href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">mpi_communicator</a>, &amp;<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">         * set the matrices involved. the last argument is irrelevant here,</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment">         * since we use the solver only once anyway</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#    if DEAL_II_PETSC_VERSION_LT(3, 5, 0)</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        ierr =</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;          KSPSetOperators(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>, <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>, DIFFERENT_NONZERO_PATTERN);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#    else</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        ierr = KSPSetOperators(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>, <a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="preprocessor">#    endif</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160; </div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="comment">         * setting the solver type</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a11450efb60c23f89b1467deb4efd8a61">set_solver_type</a>(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="comment">         * getting the associated preconditioner context</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        ierr = KSPGetPC(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, &amp;<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc);</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="comment">         * build PETSc PC for particular PCLU or PCCHOLESKY preconditioner</span></div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="comment">         * depending on whether the symmetric mode has been set</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#adc29243b7a37499a9e31f6cf05a47bfc">symmetric_mode</a>)</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          ierr = PCSetType(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc, PCCHOLESKY);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          ierr = PCSetType(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc, PCLU);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment">         * convergence monitor function that checks with the solver_control</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment">         * object for convergence</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        ierr = KSPSetConvergenceTest(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp,</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                                     &amp;<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8ee4f6e34b6a4762deb4c1bfe0d5755d">convergence_test</a>,</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                                     <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(&amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>),</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                     PETSC_NULL);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160; </div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment">         * set the software that is to be used to perform the lu</span></div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="comment">         * factorization here we start to see differences with the base</span></div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="comment">         * class solve function</span></div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor">#    if DEAL_II_PETSC_VERSION_LT(3, 9, 0)</span></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        ierr = PCFactorSetMatSolverPackage(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc, MATSOLVERMUMPS);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="preprocessor">#    else</span></div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        ierr = PCFactorSetMatSolverType(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc, MATSOLVERMUMPS);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="preprocessor">#    endif</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="comment">         * set up the package to call for the factorization</span></div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="preprocessor">#    if DEAL_II_PETSC_VERSION_LT(3, 9, 0)</span></div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;        ierr = PCFactorSetUpMatSolverPackage(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#    else</span></div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;        ierr = PCFactorSetUpMatSolverType(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc);</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">#    endif</span></div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160; </div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="comment">         * get the factored matrix F from the preconditioner context.  This</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="comment">         * routine is valid only for LU, ILU, Cholesky, and incomplete</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment">         * Cholesky</span></div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        ierr = PCFactorGetMatrix(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;pc, &amp;<a class="code" href="fe__nedelec__sz__0_8txt.html#ae0c48442a4b869ada9ce9f16c1a9bdb6">F</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="comment">         * Passing the control parameters to MUMPS</span></div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        ierr = MatMumpsSetIcntl(<a class="code" href="fe__nedelec__sz__0_8txt.html#ae0c48442a4b869ada9ce9f16c1a9bdb6">F</a>, icntl, ival);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="comment">         * set the command line option prefix name</span></div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;        ierr = KSPSetOptionsPrefix(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, <a class="code" href="classPETScWrappers_1_1SolverBase.html#a1693decd08f4666d89c887d44c8a4dce">prefix_name</a>.c_str());</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; </div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="comment">         * set the command line options provided by the user to override</span></div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="comment">         * the defaults</span></div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        ierr = KSPSetFromOptions(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp);</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      }</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; </div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="comment">     * solve the linear system</span></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    PetscErrorCode ierr = KSPSolve(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, <a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>, <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>);</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160; </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="comment">/*</span></div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="comment">     * in case of failure throw exception</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="comment">     */</span></div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a1558e27e46b7204a5154adf81038da07">last_check</a>() != <a class="code" href="classSolverControl.html#afcdeab4b55513dbd766b56e35efecbaaabbc662e5ce1fe64021a2e3d8cfe2d036">SolverControl::success</a>)</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                    <a class="code" href="classSolverControl_1_1NoConvergence.html">SolverControl::NoConvergence</a>(<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a42aeae81cd6b67ce93b5fbea3328371f">last_step</a>(),</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                                 <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a4a3b4da9834a3a5f1da12fa8fcc074f0">last_value</a>()));</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        <span class="comment">/*</span></div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="comment">         * obtain convergence information. obtain the number of iterations</span></div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="comment">         * and residual norm</span></div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="comment">         */</span></div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        ierr = KSPGetIterationNumber(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, &amp;its);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        ierr = KSPGetResidualNorm(<a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">solver_data</a>-&gt;ksp, &amp;rnorm);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(ierr == 0, <a class="code" href="classLACExceptions_1_1ExcPETScError.html">ExcPETScError</a>(ierr));</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      }</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="preprocessor">#  else // DEAL_II_PETSC_WITH_MUMPS</span></div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      <span class="keyword">false</span>,</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        <span class="stringliteral">&quot;Your PETSc installation does not include a copy of &quot;</span></div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="stringliteral">&quot;the MUMPS package necessary for this solver. You will need to configure &quot;</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="stringliteral">&quot;PETSc so that it includes MUMPS, recompile it, and then re-configure &quot;</span></div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;        <span class="stringliteral">&quot;and recompile deal.II as well.&quot;</span>));</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; </div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    <span class="comment">// Cast to void to silence compiler warnings</span></div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    (void)<a class="code" href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a>;</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    (void)<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>;</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;    (void)<a class="code" href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="preprocessor">#  endif</span></div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;  }</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;  PetscErrorCode</div>
<div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8ee4f6e34b6a4762deb4c1bfe0d5755d">  847</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8ee4f6e34b6a4762deb4c1bfe0d5755d">SparseDirectMUMPS::convergence_test</a>(KSP <span class="comment">/*ksp*/</span>,</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;                                      <span class="keyword">const</span> PetscInt      <a class="code" href="preconditioners__0_8txt.html#abebc9af399f7664771e26564a49c8dc1">iteration</a>,</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;                                      <span class="keyword">const</span> PetscReal     residual_norm,</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                                      KSPConvergedReason *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a>,</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                      <span class="keywordtype">void</span> *              solver_control_x)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <a class="code" href="classSolverControl.html">SolverControl</a> &amp;<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a> =</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;      *<span class="keyword">reinterpret_cast&lt;</span><a class="code" href="classSolverControl.html">SolverControl</a> *<span class="keyword">&gt;</span>(solver_control_x);</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="keyword">const</span> <a class="code" href="classSolverControl.html#afcdeab4b55513dbd766b56e35efecbaa">SolverControl::State</a> <a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a> =</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a56fdf4c8d099edaca6fad443d7c76649">check</a>(<a class="code" href="preconditioners__0_8txt.html#abebc9af399f7664771e26564a49c8dc1">iteration</a>, residual_norm);</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160; </div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a>)</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <a class="code" href="kinsol__0_8txt.html#afe1eeca1ecfef01d41c7cbe94b9639dd">case ::SolverControl::iterate</a>:</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = KSP_CONVERGED_ITERATING;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        case ::SolverControl::success:</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = <span class="keyword">static_cast&lt;</span>KSPConvergedReason<span class="keyword">&gt;</span>(1);</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        case ::SolverControl::failure:</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#a42aeae81cd6b67ce93b5fbea3328371f">last_step</a>() &gt; <a class="code" href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">solver_control</a>.<a class="code" href="classSolverControl.html#aba046b0a2315e735fdf17d36ecb44f0b">max_steps</a>())</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;            *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = KSP_DIVERGED_ITS;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            *<a class="code" href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a> = KSP_DIVERGED_DTOL;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;      }</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="keywordtype">void</span></div>
<div class="line"><a name="l00884"></a><span class="lineno"><a class="line" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8b78ae70a3ab806f362bab1ac57b02c8">  884</a></span>&#160;  <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8b78ae70a3ab806f362bab1ac57b02c8">SparseDirectMUMPS::set_symmetric_mode</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="geometry__info__0_8txt.html#a4ee70847dcfd5dfae56b4e49a096733a">flag</a>)</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    <a class="code" href="classPETScWrappers_1_1SparseDirectMUMPS.html#adc29243b7a37499a9e31f6cf05a47bfc">symmetric_mode</a> = <a class="code" href="geometry__info__0_8txt.html#a4ee70847dcfd5dfae56b4e49a096733a">flag</a>;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;  }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160; </div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;} <span class="comment">// namespace PETScWrappers</span></div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; </div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160; </div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="preprocessor">#endif // DEAL_II_WITH_PETSC</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a1693decd08f4666d89c887d44c8a4dce"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a1693decd08f4666d89c887d44c8a4dce">PETScWrappers::SolverBase::prefix_name</a></div><div class="ttdeci">std::string prefix_name</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00206">petsc_solver.h:206</a></div></div>
<div class="ttc" id="aclassSolverControl_html_a56fdf4c8d099edaca6fad443d7c76649"><div class="ttname"><a href="classSolverControl.html#a56fdf4c8d099edaca6fad443d7c76649">SolverControl::check</a></div><div class="ttdeci">virtual State check(const unsigned int step, const double check_value)</div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8cc_source.html#l00052">solver_control.cc:52</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverCG_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverCG_1_1AdditionalData.html">PETScWrappers::SolverCG::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00398">petsc_solver.h:398</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_abfc375c07a38e1314a79c6a1093edb53"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#abfc375c07a38e1314a79c6a1093edb53">PETScWrappers::SolverBase::solve</a></div><div class="ttdeci">void solve(const MatrixBase &amp;A, VectorBase &amp;x, const VectorBase &amp;b, const PreconditionBase &amp;preconditioner)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00053">petsc_solver.cc:53</a></div></div>
<div class="ttc" id="asymmetric__tensor__0_8txt_html_a37cd5701f5aaccacc8caf38d4a7a903a"><div class="ttname"><a href="symmetric__tensor__0_8txt.html#a37cd5701f5aaccacc8caf38d4a7a903a">A</a></div><div class="ttdeci">1 A</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor__0_8txt_source.html#l00078">symmetric_tensor_0.txt:78</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBicgstab_html_a39506f6ed266b8694df6b1cdf181c3c1"><div class="ttname"><a href="classPETScWrappers_1_1SolverBicgstab.html#a39506f6ed266b8694df6b1cdf181c3c1">PETScWrappers::SolverBicgstab::SolverBicgstab</a></div><div class="ttdeci">SolverBicgstab(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00448">petsc_solver.cc:448</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverCGS_html_a868cb10d96fc427b89679b9a4c369558"><div class="ttname"><a href="classPETScWrappers_1_1SolverCGS.html#a868cb10d96fc427b89679b9a4c369558">PETScWrappers::SolverCGS::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00481">petsc_solver.cc:481</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverGMRES_html_abf64e01b6a4c50a5702ab31911aa2e7b"><div class="ttname"><a href="classPETScWrappers_1_1SolverGMRES.html#abf64e01b6a4c50a5702ab31911aa2e7b">PETScWrappers::SolverGMRES::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00396">petsc_solver.cc:396</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverTCQMR_html_a897b6471eb71a5e758723de0d2e9f07b"><div class="ttname"><a href="classPETScWrappers_1_1SolverTCQMR.html#a897b6471eb71a5e758723de0d2e9f07b">PETScWrappers::SolverTCQMR::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00529">petsc_solver.cc:529</a></div></div>
<div class="ttc" id="alac_2petsc__solver_8h_html"><div class="ttname"><a href="lac_2petsc__solver_8h.html">petsc_solver.h</a></div></div>
<div class="ttc" id="apetsc__precondition__0_8txt_html_a41ebb2d49faa97a3d9eab4b4f13c2742"><div class="ttname"><a href="petsc__precondition__0_8txt.html#a41ebb2d49faa97a3d9eab4b4f13c2742">preconditioner</a></div><div class="ttdeci">*Base class for preconditioner classes using the PETSc functionality The classes in this hierarchy don t do a whole lot except for providing a function that sets the preconditioner and certain parameters on the preconditioning context of the solver These classes are basically here only to allow a similar interface as already used for the deal II solver and preconditioner classes Note that derived classes only provide interfaces to the relevant functionality of PETSc PETSc does not implement all preconditioners for all matrix types In particular some preconditioners are not going to work for parallel jobs such as for example the ILU preconditioner ***Constructor **Destructor **Destroys the preconditioner</div><div class="ttdef"><b>Definition:</b> <a href="petsc__precondition__0_8txt_source.html#l00002">petsc_precondition_0.txt:2</a></div></div>
<div class="ttc" id="aclassSolverControl_html_afcdeab4b55513dbd766b56e35efecbaa"><div class="ttname"><a href="classSolverControl.html#afcdeab4b55513dbd766b56e35efecbaa">SolverControl::State</a></div><div class="ttdeci">State</div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__control_8h_source.html#l00060">solver_control.h:60</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html">PETScWrappers::SolverBase</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00107">petsc_solver.h:107</a></div></div>
<div class="ttc" id="anamespacePETScWrappers_html"><div class="ttname"><a href="namespacePETScWrappers.html">PETScWrappers</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__block__sparse__matrix_8h_source.html#l00036">petsc_block_sparse_matrix.h:36</a></div></div>
<div class="ttc" id="aclassSolverControl_html_a1558e27e46b7204a5154adf81038da07"><div class="ttname"><a href="classSolverControl.html#a1558e27e46b7204a5154adf81038da07">SolverControl::last_check</a></div><div class="ttdeci">State last_check() const</div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8cc_source.html#l00106">solver_control.cc:106</a></div></div>
<div class="ttc" id="aclassSolverControl_1_1NoConvergence_html"><div class="ttname"><a href="classSolverControl_1_1NoConvergence.html">SolverControl::NoConvergence</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__control_8h_source.html#l00082">solver_control.h:82</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverPreOnly_html_a6d7bc3d1245a8d0a6d3d66d3c1fb56dd"><div class="ttname"><a href="classPETScWrappers_1_1SolverPreOnly.html#a6d7bc3d1245a8d0a6d3d66d3c1fb56dd">PETScWrappers::SolverPreOnly::SolverPreOnly</a></div><div class="ttdeci">SolverPreOnly(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00592">petsc_solver.cc:592</a></div></div>
<div class="ttc" id="alac_2petsc__matrix__base_8h_html"><div class="ttname"><a href="lac_2petsc__matrix__base_8h.html">petsc_matrix_base.h</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverCR_html_a24dbd85ed98ac21a0391c54663cf9deb"><div class="ttname"><a href="classPETScWrappers_1_1SolverCR.html#a24dbd85ed98ac21a0391c54663cf9deb">PETScWrappers::SolverCR::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00553">petsc_solver.cc:553</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="akinsol__0_8txt_html_afe1eeca1ecfef01d41c7cbe94b9639dd"><div class="ttname"><a href="kinsol__0_8txt.html#afe1eeca1ecfef01d41c7cbe94b9639dd">iterate</a></div><div class="ttdeci">**Additional parameters that can be passed to the KINSOL class **KINSOL solution strategy KINSOL includes a Newton Krylov solver(both local and global) as well as Picard and fixed point solvers. *[0.x.3] *Standard Newton iteration. *[0.x.4] *Newton iteration with linesearch. *[0.x.5] *Fixed point iteration. *[0.x.6] *Picard iteration. *[0.x.7] *Initialization parameters for KINSOL. Global parameters the computation will be aborted and an assertion will be thrown **A function object that users may supply and that is intended to prepare the linear solver for subsequent calls to in the solution of linear systems[2.x.78] The exact nature of this system depends on the SolutionStrategy that has been selected In the cases and this function is never called The or a function within the linear solver to compute Jacobian related data that is required by the linear solver It may also preprocess that data as needed for which may involve calling a generic more build preconditioners from the assembled Jacobian In any the data so generated may then be used whenever a linear system is solved The point of this function is that but only as frequently as the solver determines that it is appropriate to perform the setup task In this Jacobian related data generated by thereby saving the effort to regenerate the Jacobian matrix and a preconditioner for it whenever possible[2.x.87] current_u Current value of[2.x.88][2.x.89] current_f Current value of[2.x.90] or[2.x.91] This function should then KINSOL does not call on the internal KINSOL convergence tests then KINSOL calls then only a fixed point iteration strategy can be used Notice that this may not or may converge very slowly A call to this function should store in dst the result of[2.x.93] applied to i J this[2.x.96] vector is generally denoted by[2.x.97][2.x.98] fcur The current value of the implicit right hand side at rhs The system right hand side to solve for[2.x.101] dst The solution of[2.x.102] This function should SUNDIALS no longer provides the ycur and fcur variables **only rhs is provided and dst needs to be returned The first two arguments will therefore be empty vectors in that case In that means that one can no longer compute a Jacobian matrix for the current iterate within this function this has to happen inside the setup_jacobian function above that receives this information If it is important that the Jacobian corresponds to thecurrent * iterate(rather than a re-used Jacobian matrix that had been computed in a previous iteration and that therefore corresponds to aprevious *iterate)</div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a13eec5bf768040dffb3be81e04df71dd"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a13eec5bf768040dffb3be81e04df71dd">PETScWrappers::SolverBase::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const =0</div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_a08d73453888955bd5a9863be32f3b347"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#a08d73453888955bd5a9863be32f3b347">PETScWrappers::SparseDirectMUMPS::solve</a></div><div class="ttdeci">void solve(const MatrixBase &amp;A, VectorBase &amp;x, const VectorBase &amp;b)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00671">petsc_solver.cc:671</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverBase_1_1SolverData_html_a20af42c76ed6d4735693c5f3b45f4064"><div class="ttname"><a href="structPETScWrappers_1_1SolverBase_1_1SolverData.html#a20af42c76ed6d4735693c5f3b45f4064">PETScWrappers::SolverBase::SolverData::~SolverData</a></div><div class="ttdeci">~SolverData()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00038">petsc_solver.cc:38</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a8c742afbfe0ebcd052583a6c31990f82"><div class="ttname"><a href="iterators__0_8txt.html#a8c742afbfe0ebcd052583a6c31990f82">state</a></div><div class="ttdeci">it does so for both DoFHandler and[2.x.14] objects Note that the DoFAccessor class is derived from either TriaAccessor or the DoFAccessor class comes in two flavors one accessing degrees of freedom on the level of a cell and the other accessing the active dofs of an active cell **The DoFCellAccessor class has the same purpose and relation to DoFCellAccessor as the CellAccessor has to TriaAccessor *Except to look up member you will not usually have to deal withthe actual class names listed above Rather one uses the typedefs provided bythe mesh classes Triangulation DoFHandler and[2.x.15] as wellas the function that generate such buta hexahedron there are corresponding types and calls like[2.x.34] that act on thedimension independent geometric objects and hex These just as the ones exist in active and non active forms *The actual definition of all the typedefs to the mesh classes arestated in the **and[2.x.37] classes for Triangulation and[1.x.10] classes for DoFHandler and[2.x.38] iterators *IteratorAccessorInternals Iterator and accessor internals being like act as if they pointed to an but in reality all they do is to return an accessor whendereferenced The accessor object contains the state</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00083">iterators_0.txt:83</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverTCQMR_html_a97ea37a631ba7d3a24041825a8ccb678"><div class="ttname"><a href="classPETScWrappers_1_1SolverTCQMR.html#a97ea37a631ba7d3a24041825a8ccb678">PETScWrappers::SolverTCQMR::SolverTCQMR</a></div><div class="ttdeci">SolverTCQMR(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00520">petsc_solver.cc:520</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverChebychev_html_a28e30004e6934db26875d1e3cb7aa721"><div class="ttname"><a href="classPETScWrappers_1_1SolverChebychev.html#a28e30004e6934db26875d1e3cb7aa721">PETScWrappers::SolverChebychev::SolverChebychev</a></div><div class="ttdeci">SolverChebychev(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00306">petsc_solver.cc:306</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_aaeb4c9d4ba637ee4ba95b5c7af926bee"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#aaeb4c9d4ba637ee4ba95b5c7af926bee">PETScWrappers::SolverBase::mpi_communicator</a></div><div class="ttdeci">const MPI_Comm mpi_communicator</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00189">petsc_solver.h:189</a></div></div>
<div class="ttc" id="amg__0_8txt_html_a05d914308ac970c97c941a291a81ccc1"><div class="ttname"><a href="mg__0_8txt.html#a05d914308ac970c97c941a291a81ccc1">b</a></div><div class="ttdeci">which is a wrapper around Multigrid with the standard interface of deal II[2.x.9] Preconditioners PreconditionMG also uses the classes inheriting from for instance where it uses[2.x.10] and[2.x.11] which transfer between the global vector and the level vectors we have several auxiliary namely which stores an object on each level **See b</div><div class="ttdef"><b>Definition:</b> <a href="mg__0_8txt_source.html#l00011">mg_0.txt:11</a></div></div>
<div class="ttc" id="afe__nedelec__sz__0_8txt_html_ae0c48442a4b869ada9ce9f16c1a9bdb6"><div class="ttname"><a href="fe__nedelec__sz__0_8txt.html#ae0c48442a4b869ada9ce9f16c1a9bdb6">F</a></div><div class="ttdeci">the total polynomial degree may be higher If the element is linear and has degrees of freedom only on the edges If faces and volume For example the version of FE_NedelecSZ has degrees of freedom for where order is the order of FE_NedelecSZ **This element is vector valued so this function will throw an exception **Not implemented **This element is vector valued so this function will throw an exception **Not implemented **This element is vector valued so this function will throw an exception **Not implemented **The mapping kind to be used to map shape functions from the reference cell to the mesh cell **Compute information about the shape functions on the cell denoted by the first argument Note that this function must recompute the cell dependent degrees of and so is not thread safe at this time **Compute information about the shape functions on the cell and face denoted by the first two arguments Note that this function must recompute the cell dependent degrees of and so is not thread safe at this time **Not implemented **Derived Internal data which is used to store cell independent data Note that due to the nature of this a number of useful pre computed quantities are stored for the computation of cell dependent shape functions The main quantities which are stored are associated with edge and face parameterizations These equal to one at the[2.x.5] th vertex and zero at all other vertices *[2.x.6][2.x.7][2.x.8] *linear functional associated with the[2.x.9] th vertex[2.x.10][2.x.11] The definitions of these as well as the edge and face parameterizations and edge and face extension can be found on page of Zaglmayr s thesis The details of the definition of the globally defined edge and face orientations can be found on page **Storage for shape functions on the reference element We only pre compute cell based as the edge and face based DoFs depend on the cell Due to the cell dependent this variable is declared mutable **Storage for shape function gradients on the reference element We only pre compute cell based as the edge and face based DoFs depend on the cell Due to the cell dependent this variable is declared mutable **Storage for all possible edge parameterization between vertices These are required in the computation of edge and face based which are cell dependent The edge parameterization of an starting at vertex i and ending at vertex[2.x.12] is given by[2.x.13] sigma_imj_values[q][i][j] stores the value of the edge parameterization connected by vertices[2.x.14] and[2.x.15] at the q th quadrature point Note that not all of the[2.x.16] and[2.x.17] combinations result in valid edges on the hexahedral but they are computed in this fashion for use with non standard edge and face orientations **Storage for gradients of all possible edge parameterizations between vertices These are required in the computation of edge and face based which are cell dependent Note that the components of the gradient are constant The edge parameterization of an starting at vertex[2.x.19] and ending at vertex[2.x.20] is given by[2.x.21] sigma_imj_grads[i][j][d] stores the gradient of the edge parameterization connected by vertices[2.x.22] and[2.x.23] in component[2.x.24] Note that the gradient of the edge parameterization is constant on an so we do not need to store it at every quadrature point **Storage for values of edge parameterizations at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell edge_sigma_values[m][q] stores the edge parameterization value at the q th quadrature point on edge m These values change with the orientation of the edges of a physical cell and so must take the sign into account when used for computation **Storage for gradients of edge parameterization at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell edge_sigma_grads[m][d] stores the gradient of the edge parameterization for component d on edge m These values change with the orientation of the edges of a physical cell and so must take the sign into account when used for computation **Storage for edge extension parameters at quadrature points These are stored for the edges such that the global vertex numbering would follow the order defined by the standard deal II cell The edge extension parameter of an starting at vertex[2.x.26] and ending at vertex[2.x.27] is given by[2.x.28] Note that under this the values of[2.x.29] do not change with the orientation of the edge edge_lambda_values[m][q] stores the edge extension parameter value at the[2.x.30] th quadrature point on edge *[2.x.31] *Storage for gradients of edge extension parameters in In this case they are constant These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_grads_2d[m][d] stores the gradient of the edge extension parameter for component[2.x.32] on edge *[2.x.33] *Storage for gradients of edge extension parameters in In this case they are non constant These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_grads_3d[m][q][d] stores the gradient of the edge extension parameter for component[2.x.34] at the[2.x.35] th quadrature point on edge m **Storage for derivatives of edge extension parameters which are constant across the cell These are stored for the edges such that the global vertex numbering *would follow the order defined by the standard deal II cell edge_lambda_gradgrads_3d[m][d1][d2] stores the derivatives of the edge extension parameters with respect to components d1 and d2 on edge *[2.x.36] *Storage for the face extension parameters These are stored for the faces such that the global vertex numbering would follow the order defined by the standard deal II cell The face extension parameter of a F</div><div class="ttdef"><b>Definition:</b> <a href="fe__nedelec__sz__0_8txt_source.html#l00059">fe_nedelec_sz_0.txt:59</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBiCG_html_a462c9fc09e84dc40e64b0c44f4bc22c1"><div class="ttname"><a href="classPETScWrappers_1_1SolverBiCG.html#a462c9fc09e84dc40e64b0c44f4bc22c1">PETScWrappers::SolverBiCG::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00363">petsc_solver.cc:363</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_a8b78ae70a3ab806f362bab1ac57b02c8"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8b78ae70a3ab806f362bab1ac57b02c8">PETScWrappers::SparseDirectMUMPS::set_symmetric_mode</a></div><div class="ttdeci">void set_symmetric_mode(const bool flag)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00884">petsc_solver.cc:884</a></div></div>
<div class="ttc" id="alac_2petsc__compatibility_8h_html"><div class="ttname"><a href="lac_2petsc__compatibility_8h.html">petsc_compatibility.h</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverLSQR_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverLSQR_1_1AdditionalData.html">PETScWrappers::SolverLSQR::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00832">petsc_solver.h:832</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2lac_2exceptions_8h_html"><div class="ttname"><a href="include_2deal_8II_2lac_2exceptions_8h.html">exceptions.h</a></div></div>
<div class="ttc" id="aclassSolverControl_html_a4a3b4da9834a3a5f1da12fa8fcc074f0"><div class="ttname"><a href="classSolverControl.html#a4a3b4da9834a3a5f1da12fa8fcc074f0">SolverControl::last_value</a></div><div class="ttdeci">double last_value() const</div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8cc_source.html#l00120">solver_control.cc:120</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverCGS_html_a007e687d16b4cb7eb2ee1088b718924f"><div class="ttname"><a href="classPETScWrappers_1_1SolverCGS.html#a007e687d16b4cb7eb2ee1088b718924f">PETScWrappers::SolverCGS::SolverCGS</a></div><div class="ttdeci">SolverCGS(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00472">petsc_solver.cc:472</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverRichardson_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html">PETScWrappers::SolverRichardson::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00283">petsc_solver.h:283</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a59106e5502be382a237ad7b05aeb67b4"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a59106e5502be382a237ad7b05aeb67b4">PETScWrappers::SolverBase::solver_control</a></div><div class="ttdeci">SolverControl &amp; solver_control</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00183">petsc_solver.h:183</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverCG_html_ad121c05be905cfef7aa562fac1af0cfd"><div class="ttname"><a href="classPETScWrappers_1_1SolverCG.html#ad121c05be905cfef7aa562fac1af0cfd">PETScWrappers::SolverCG::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00339">petsc_solver.cc:339</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverBiCG_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverBiCG_1_1AdditionalData.html">PETScWrappers::SolverBiCG::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00449">petsc_solver.h:449</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a271b791d8cb267ae211c56a0499385c4"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a271b791d8cb267ae211c56a0499385c4">PETScWrappers::SolverBase::control</a></div><div class="ttdeci">SolverControl &amp; control() const</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00168">petsc_solver.cc:168</a></div></div>
<div class="ttc" id="aclassSolverControl_html_a42aeae81cd6b67ce93b5fbea3328371f"><div class="ttname"><a href="classSolverControl.html#a42aeae81cd6b67ce93b5fbea3328371f">SolverControl::last_step</a></div><div class="ttdeci">unsigned int last_step() const</div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8cc_source.html#l00127">solver_control.cc:127</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverCR_html_aa8d18b8a702eab68f664f0962fd5c991"><div class="ttname"><a href="classPETScWrappers_1_1SolverCR.html#aa8d18b8a702eab68f664f0962fd5c991">PETScWrappers::SolverCR::SolverCR</a></div><div class="ttdeci">SolverCR(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00544">petsc_solver.cc:544</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverGMRES_1_1AdditionalData_html_a4185706bd59744601ac0a68bfe489c2a"><div class="ttname"><a href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a4185706bd59744601ac0a68bfe489c2a">PETScWrappers::SolverGMRES::AdditionalData::AdditionalData</a></div><div class="ttdeci">AdditionalData(const unsigned int restart_parameter=30, const bool right_preconditioning=false)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00378">petsc_solver.cc:378</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a63996b94c34f0fcf590c725d4decc06f"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a63996b94c34f0fcf590c725d4decc06f">PETScWrappers::SolverBase::initialize</a></div><div class="ttdeci">void initialize(const PreconditionBase &amp;preconditioner)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00213">petsc_solver.cc:213</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverTFQMR_html_a17835b5cba535fb2a01e297d27e4098f"><div class="ttname"><a href="classPETScWrappers_1_1SolverTFQMR.html#a17835b5cba535fb2a01e297d27e4098f">PETScWrappers::SolverTFQMR::SolverTFQMR</a></div><div class="ttdeci">SolverTFQMR(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00496">petsc_solver.cc:496</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html"><div class="ttname"><a href="base_2logstream_8h.html">logstream.h</a></div></div>
<div class="ttc" id="aclassSolverControl_html_afcdeab4b55513dbd766b56e35efecbaaabbc662e5ce1fe64021a2e3d8cfe2d036"><div class="ttname"><a href="classSolverControl.html#afcdeab4b55513dbd766b56e35efecbaaabbc662e5ce1fe64021a2e3d8cfe2d036">SolverControl::success</a></div><div class="ttdeci">@ success</div><div class="ttdoc">Stop iteration, goal reached.</div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__control_8h_source.html#l00065">solver_control.h:65</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a4a9fb291cadc26663871c636800fe491"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a4a9fb291cadc26663871c636800fe491">PETScWrappers::SolverBase::solver_data</a></div><div class="ttdeci">std::unique_ptr&lt; SolverData &gt; solver_data</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00259">petsc_solver.h:259</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a71e97d3ad2075793e1f177f7128299b8"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a71e97d3ad2075793e1f177f7128299b8">PETScWrappers::SolverBase::convergence_test</a></div><div class="ttdeci">static PetscErrorCode convergence_test(KSP ksp, const PetscInt iteration, const PetscReal residual_norm, KSPConvergedReason *reason, void *solver_control)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00175">petsc_solver.cc:175</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverCGS_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverCGS_1_1AdditionalData.html">PETScWrappers::SolverCGS::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00622">petsc_solver.h:622</a></div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverGMRES_html_a41051c02104c0914244c15b5044f2e8e"><div class="ttname"><a href="classPETScWrappers_1_1SolverGMRES.html#a41051c02104c0914244c15b5044f2e8e">PETScWrappers::SolverGMRES::additional_data</a></div><div class="ttdeci">const AdditionalData additional_data</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00546">petsc_solver.h:546</a></div></div>
<div class="ttc" id="anamespacePETScWrappers_html_a8d5ac4c26e7010d975fcfd04c5b039e9"><div class="ttname"><a href="namespacePETScWrappers.html#a8d5ac4c26e7010d975fcfd04c5b039e9">PETScWrappers::destroy_krylov_solver</a></div><div class="ttdeci">PetscErrorCode destroy_krylov_solver(KSP &amp;krylov_solver)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__compatibility_8h_source.html#l00089">petsc_compatibility.h:89</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS_html_af72cb2c7bd2ec22f2420cd718fb4524d"><div class="ttname"><a href="structPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS.html#af72cb2c7bd2ec22f2420cd718fb4524d">PETScWrappers::SparseDirectMUMPS::SolverDataMUMPS::~SolverDataMUMPS</a></div><div class="ttdeci">~SolverDataMUMPS()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00626">petsc_solver.cc:626</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1MatrixBase_html"><div class="ttname"><a href="classPETScWrappers_1_1MatrixBase.html">PETScWrappers::MatrixBase</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__matrix__base_8h_source.html#l00302">petsc_matrix_base.h:302</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverPreOnly_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverPreOnly_1_1AdditionalData.html">PETScWrappers::SolverPreOnly::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00888">petsc_solver.h:888</a></div></div>
<div class="ttc" id="atable__handler__0_8txt_html_aa02519610f643695a6a4f66c4062392a"><div class="ttname"><a href="table__handler__0_8txt.html#aa02519610f643695a6a4f66c4062392a">int</a></div><div class="ttdeci">*A&lt; tt &gt; TableEntry&lt;/tt &gt; stores the value of a table entry It can either be of type int</div><div class="ttdef"><b>Definition:</b> <a href="table__handler__0_8txt_source.html#l00002">table_handler_0.txt:2</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_af85863b31be0cbd660acba99051e0634"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a></div><div class="ttdeci">****This module contains classes that are used in the exception mechanism of deal II **Exceptions are used in two different not in static assertions are typically used to check that parameters to functions satisfy certain that internal data structures are and similar assertions For static assertions are used to make sure that two vectors that are added together have the same number of components **everything else would not make any sense anyway *Such checks are performed by the[2.x.3] macro in several thousand places within the library several tutorial programs starting with[2.x.4] show how to do this *If static a assertion is the exception mechanism generates an exception of a type that indicates what exactly goes wrong displays appropriate information including the exact location where the problem was detected and then aborts the program **if you try to add two vectors of different there is nothing that can be done within the program to cope with the you have to go fix the program code instead There is generally not even a reason to[2.x.5] an exception object using the usual C exception mechanism because there is nothing a function higher up could do in such cases to rectify the situation and deal with it in a useful way **it s not that the program received bad data</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00015">exceptions_0.txt:15</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverGMRES_1_1AdditionalData_html_a1cf5f076c7bfdd2bd19e202bf6c041c1"><div class="ttname"><a href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a1cf5f076c7bfdd2bd19e202bf6c041c1">PETScWrappers::SolverGMRES::AdditionalData::restart_parameter</a></div><div class="ttdeci">unsigned int restart_parameter</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00514">petsc_solver.h:514</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverTFQMR_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverTFQMR_1_1AdditionalData.html">PETScWrappers::SolverTFQMR::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00673">petsc_solver.h:673</a></div></div>
<div class="ttc" id="aclassSolverControl_html_ade280d37d8b399d293982a0c64953033"><div class="ttname"><a href="classSolverControl.html#ade280d37d8b399d293982a0c64953033">SolverControl::tolerance</a></div><div class="ttdeci">double tolerance() const</div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_a11450efb60c23f89b1467deb4efd8a61"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#a11450efb60c23f89b1467deb4efd8a61">PETScWrappers::SparseDirectMUMPS::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00644">petsc_solver.cc:644</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS_html_a2d3894b66468ce36744fc2807dc96f60"><div class="ttname"><a href="structPETScWrappers_1_1SparseDirectMUMPS_1_1SolverDataMUMPS.html#a2d3894b66468ce36744fc2807dc96f60">PETScWrappers::SparseDirectMUMPS::SolverDataMUMPS::ksp</a></div><div class="ttdeci">KSP ksp</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l01019">petsc_solver.h:1019</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a4ee70847dcfd5dfae56b4e49a096733a"><div class="ttname"><a href="geometry__info__0_8txt.html#a4ee70847dcfd5dfae56b4e49a096733a">flag</a></div><div class="ttdeci">this use is deprecated as it assumes a certain mapping from the symbolic flags defined in the RefinementPossibilities base class to actual numerical if the current object holds the flag[2.x.53]</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00140">geometry_info_0.txt:140</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_a2b24e414d1a0d32deea919c5e8899811"><div class="ttname"><a href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div><div class="ttdeci">([1.x.8]&lt; sub &gt;1&lt;/sub &gt;, [1.x.9]&lt; sub &gt;2&lt;/sub &gt;, [1.x.10]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt; and[1.x.11] accordingly. Then, we can write the simplified equation in coordinates as[1.x.12] We see, that this is just three copies of the bilinear form of the Laplacian, one applied to each component(this is where the formulation with the[2.x.33] is more exciting, and we want to derive a framework that applies to that one as well). We can make this weak form a system of differential equations again by choosing special test functions:first, choose[1.x.13]=([1.x.14]&lt; sub &gt;1&lt;/sub &gt;, 0, 0)&lt; sup &gt;T&lt;/sup &gt;, then[1.x.15]=(0, [1.x.16]&lt; sub &gt;2&lt;/sub &gt;, 0)&lt; sup &gt;T&lt;/sup &gt;, and finally[1.x.17]=(0, 0, [1.x.18]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt;. writing the outcomes below each other, we obtain the system[1.x.19] where we used the standard inner product notation[2.x.34] . It is important for our understanding, that we keep in mind that the latter form as a system of PDE is completely equivalent to the original definition of the bilinear form[1.x.20]([1.x.21], [1.x.22]), which does not immediately exhibit this system structure. Let us close by writing the full system of the elastic equation with symmetric gradient[1.x.23]:[1.x.24] Very formally, if we believe in operator valued matrices, we can rewrite this in the form[1.x.25]&lt; sup &gt;T&lt;/sup &gt;[1.x.26]=[1.x.27]&lt; sup &gt;T&lt;/sup &gt;[1.x.28] or[1.x.29] *[1.x.30] Now, let us consider a more complex example, the mixed Laplace equations discussed in[2.x.35] in three dimensions:[1.x.31] **Here, we have four solution components:the scalar pressure[2.x.36] and the vector-valued velocity[2.x.37] with three vector components. Note as important difference to the previous example, that the vector space[1.x.32] is not just simply a copy of three identical spaces/*A systematic way to get a weak or variational form for this and other vector problems is to first consider it as a problem where the operators and solution variables are written in vector and matrix form. For the example, this would read as follows:[1.x.33] **This makes it clear that the solution[1.x.34] *indeed has four components. We note that we could change the ordering of the solution components[2.x.38] and[2.x.39] inside[2.x.40] if we also change columns of the matrix operator.*Next, we need to think about test functions[2.x.41] . We want to multiply both sides of the equation with them, then integrate over[2.x.42] . The result should be a scalar equality. We can achieve this by choosing[2.x.43] also vector valued as[1.x.35] **It is convenient to multiply the matrix-vector equation by the test function from the left, since this way we automatically get the correct matrix later on(in the linear system, the matrix is also multiplied from the right with the solution variable, not from the left), whereas if we multiplied from the right then the matrix so assembled is the transpose of the one we really want. *With this in mind, let us multiply by[2.x.44] and integrate to get the following equation which has to hold for all test functions[2.x.45] :[1.x.36] *or equivalently:[1.x.37] ***We get the final form by integrating by part the second term:[1.x.38] **It is this form that we will later use in assembling the discrete weak form into a matrix and a right hand side vector:the form in which we have solution and test functions[2.x.46] that each consist of a number of vector components that we can extract. **[2.x.47] VVFEs[1.x.39] *Once we have settled on a bilinear form and a functional setting, we need to find a way to describe the vector-valued finite element spaces from which we draw solution and test functions. This is where the FESystem class comes in:it composes vector-valued finite element spaces from simpler ones. In the example of the elasticity problem, we need[2.x.48] copies of the same element, for instance **[1.x.40] *This will generate a vector valued space of dimension[2.x.49], where each component is a continuous bilinear element of type FE_Q. It will have[2.x.50] times as many basis functions as the corresponding FE_Q, and each of these basis functions is a basis function of FE_Q, lifted into one of the components of the vector. *For the mixed Laplacian, the situation is more complex. First, we have to settle on a pair of discrete spaces[2.x.51] . One option would be the stable Raviart-Thomas pair **[1.x.41] *The first element in this system is already a vector valued element of dimension[2.x.52], while the second is a regular scalar element. *Alternatively to using the stable Raviart-Thomas pair, we could consider a stabilized formulation for the mixed Laplacian, for instance the LDG method. There, we have the option of using the same spaces for velocity components and pressure, namely **[1.x.42] *This system just has[2.x.53] equal copies of the same discontinuous element, which not really reflects the structure of the system. Therefore, we prefer **[1.x.43] *Here, we have a system of two elements, one vector-valued and one scalar, very much like with the[2.x.54] . Indeed, in many codes, the two can be interchanged. This element also allows us easily to switch to an LDG method with lower order approximation in the velocity, namely **[1.x.44] *It must be pointed out, that this element is different from **[1.x.45] *While the constructor call is very similar to[2.x.55], the result actually resembles more[2.x.56] in that this element produces[2.x.57] independent components. A more detailed comparison of the resulting FESystem objects is below. *[1.x.46] *FESystem has a few internal variables which reflect the internal structure set up by the constructor. These can then also be used by application programs to give structure to matrix assembling and linear algebra. We give the names and values of these variables for the examples above in the following table:&lt; table border=&quot;1&quot;&gt;&lt; tr &gt;&lt; th &gt;System Element&lt;/th &gt;[2.x.58][2.x.59][2.x.60]&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.61]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.62]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.63]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.64]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.65]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt;/table &gt; *From this table, it is clear that the FESystem reflects a lot of the structure of the system of differential equations in the cases of the[2.x.66] and the[2.x.67], in that we have a vector valued and a scalar variable. On the other hand, the convoluted elements do not have this structure and we have to reconstruct it somehow when assembling systems, as described below. *At this point, it is important to note that nesting of two FESystem object can give the whole FESystem a richer structure than just concatenating them. This structure can be exploited by application programs, but is not automatically so. *[2.x.68] VVAssembling[1.x.47] The next step is to assemble the linear system. How to do this for the simple case of a scalar problem has been shown in many tutorial programs, starting with[2.x.69] . Here we will show how to do it for vector problems. Corresponding to the different characterizations of weak formulations above and the different system elements created, we have a few options which are outlined below. *The whole concept is probably best explained by showing an example illustrating how the local contribution of a cell to the weak form of above mixed Laplace equations could be assembled. *[1.x.48] This is essentially how[2.x.70] does it:**[1.x.49] **So here 's what is happening:[2.x.71][2.x.72] The first thing we do is to declare &quot;extractors&quot;(see the FEValuesExtractors namespace). These are objects that don 't do much except store which components of a vector-valued finite element constitute a single scalar component, or a tensor of rank 1(i.e. what we call a &quot;physical vector&quot;, always consisting of[2.x.73] components). Here, we declare an object that represents the velocities consisting of[2.x.74] components starting at component zero, and the extractor for the pressure, which is a scalar component at position[2.x.75] . *[2.x.76] We then do our usual loop over all cells, shape functions, and quadrature points. In the innermost loop, we compute the local contribution of a pair of shape functions to the global matrix and right hand side vector. Recall that the cell contributions to the bilinear form(i.e. neglecting boundary terms) looked as follows, based on shape functions[2.x.77] :[1.x.50] *whereas the implementation looked like this:*[1.x.51] *The similarities are pretty obvious. *[2.x.78] Essentially, what happens in above code is this:when you do[2.x.79], a so-called &quot;view&quot; is created, i.e. an object that unlike the full FEValues object represents not all components of a finite element, but only the one(s) represented by the extractor object[2.x.80] or[2.x.81] . *[2.x.82] These views can then be asked for information about these individual components. For example, when you write[2.x.83] you get the value of the pressure component of the[2.x.84] th shape function[2.x.85] at the[2.x.86] th quadrature point. Because the extractor[2.x.87] represents a scalar component, the results of the operator[2.x.88] is a scalar number. On the other hand, the call[2.x.89] would produce the value of a whole set of[2.x.90] components, which would be of type[2.x.91] . *[2.x.92] Other things that can be done with views is to ask for the gradient of a particular shape function 's components described by an extractor. For example,[2.x.93] would represent the gradient of the scalar pressure component, which is of type[2.x.94], whereas the gradient of the velocities components,[2.x.95] is a[2.x.96], i.e. a matrix[2.x.97] that consists of entries[2.x.98] . Finally, both scalar and vector views can be asked for the second derivatives(&quot;Hessians&quot;) and vector views can be asked for the symmetric gradient, defined as[2.x.99] as well as the divergence[2.x.100] .[2.x.101] Other examples of using extractors and views are shown in tutorial programs[2.x.102],[2.x.103],[2.x.104] and several other programs. ***[2.x.105] In the current context, when we talk about a vector(for example in extracting the velocity components above), we mean the word in the sense physics uses it:it has[2.x.106] components that behave in specific ways under coordinate system transformations. Examples include velocity or displacement fields. This is opposed to how mathematics uses the word &quot;vector&quot;(and how we use this word in other contexts in the library, for example in the Vector class), where it really stands for a collection of numbers. An example of this latter use of the word could be the set of concentrations of chemical species in a flame x</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00090">vector_valued_0.txt:90</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverRichardson_1_1AdditionalData_html_a780fc35f5e5f6b41840e909cf65496ae"><div class="ttname"><a href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html#a780fc35f5e5f6b41840e909cf65496ae">PETScWrappers::SolverRichardson::AdditionalData::omega</a></div><div class="ttdeci">double omega</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00295">petsc_solver.h:295</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_acafdb3b2a37a53914bb8958ccdbfa44c"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#acafdb3b2a37a53914bb8958ccdbfa44c">PETScWrappers::SparseDirectMUMPS::SparseDirectMUMPS</a></div><div class="ttdeci">SparseDirectMUMPS(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00634">petsc_solver.cc:634</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SparseDirectMUMPS_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SparseDirectMUMPS_1_1AdditionalData.html">PETScWrappers::SparseDirectMUMPS::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00954">petsc_solver.h:954</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a2c7b85beed973f20ac73d33d8bbe8a57"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a2c7b85beed973f20ac73d33d8bbe8a57">false</a></div><div class="ttdeci">compute_rate If set to then this column will be included in the list of columns for which error rates are computed You may want to set this to false if you want to compute error rates with respect to this column In this you should also specify[2.x.28] as the rate key in the parameter file **Difference between two solutions in the same vector space **Same as with a non default mapping **Write the error table to the[2.x.29] no output is written **Add rates to the output table **Names of the solution components **Same as but containing repeated component names only once **Masks for each unique component name **Additional methods to call when adding rows to the table **Type of error to compute per components **Exponent to use in p norm types **The actual table **Extra columns to add to the table **The name of column with respect to which we compute convergence rates **Reduction rate mode See[2.x.30] for a documentation **The precision used to output the table **Filename to use when writing to file **Compute the error If this is false</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00093">parsed_convergence_table_0.txt:93</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverChebychev_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverChebychev_1_1AdditionalData.html">PETScWrappers::SolverChebychev::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00347">petsc_solver.h:347</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverTCQMR_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverTCQMR_1_1AdditionalData.html">PETScWrappers::SolverTCQMR::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00729">petsc_solver.h:729</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverRichardson_html_a5420342e17831c2737cf9db695429774"><div class="ttname"><a href="classPETScWrappers_1_1SolverRichardson.html#a5420342e17831c2737cf9db695429774">PETScWrappers::SolverRichardson::additional_data</a></div><div class="ttdeci">const AdditionalData additional_data</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00321">petsc_solver.h:321</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a8724b9c6cc906bf5213c09f09dbd9a32"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a8724b9c6cc906bf5213c09f09dbd9a32">PETScWrappers::SolverBase::reset</a></div><div class="ttdeci">virtual void reset()</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00161">petsc_solver.cc:161</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_a912ada8e128dc3a23f9e0c2dac87d51a"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#a912ada8e128dc3a23f9e0c2dac87d51a">PETScWrappers::SolverBase::set_prefix</a></div><div class="ttdeci">void set_prefix(const std::string &amp;prefix)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00154">petsc_solver.cc:154</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverRichardson_html_a81d743e8bb544846339b1757711d4add"><div class="ttname"><a href="classPETScWrappers_1_1SolverRichardson.html#a81d743e8bb544846339b1757711d4add">PETScWrappers::SolverRichardson::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00267">petsc_solver.cc:267</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBicgstab_html_a8e3b0b24309b6477b5a68f99292221eb"><div class="ttname"><a href="classPETScWrappers_1_1SolverBicgstab.html#a8e3b0b24309b6477b5a68f99292221eb">PETScWrappers::SolverBicgstab::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00457">petsc_solver.cc:457</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverChebychev_html_a1db7856395fc62644b0564fb6c86e212"><div class="ttname"><a href="classPETScWrappers_1_1SolverChebychev.html#a1db7856395fc62644b0564fb6c86e212">PETScWrappers::SolverChebychev::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00315">petsc_solver.cc:315</a></div></div>
<div class="ttc" id="alac_2petsc__precondition_8h_html"><div class="ttname"><a href="lac_2petsc__precondition_8h.html">petsc_precondition.h</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_a4454c586867254222e3dd5eeecdaf27f"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#a4454c586867254222e3dd5eeecdaf27f">PETScWrappers::SparseDirectMUMPS::additional_data</a></div><div class="ttdeci">const AdditionalData additional_data</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00985">petsc_solver.h:985</a></div></div>
<div class="ttc" id="alac_2petsc__vector__base_8h_html"><div class="ttname"><a href="lac_2petsc__vector__base_8h.html">petsc_vector_base.h</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverLSQR_html_a7baca62a81cdfa5d6e1180c157b8a3d3"><div class="ttname"><a href="classPETScWrappers_1_1SolverLSQR.html#a7baca62a81cdfa5d6e1180c157b8a3d3">PETScWrappers::SolverLSQR::SolverLSQR</a></div><div class="ttdeci">SolverLSQR(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00568">petsc_solver.cc:568</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_a8ee4f6e34b6a4762deb4c1bfe0d5755d"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#a8ee4f6e34b6a4762deb4c1bfe0d5755d">PETScWrappers::SparseDirectMUMPS::convergence_test</a></div><div class="ttdeci">static PetscErrorCode convergence_test(KSP ksp, const PetscInt iteration, const PetscReal residual_norm, KSPConvergedReason *reason, void *solver_control)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00847">petsc_solver.cc:847</a></div></div>
<div class="ttc" id="aclassLACExceptions_1_1ExcPETScError_html"><div class="ttname"><a href="classLACExceptions_1_1ExcPETScError.html">LACExceptions::ExcPETScError</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2lac_2exceptions_8h_source.html#l00071">exceptions.h:71</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverBase_1_1SolverData_html_a3b67abc1b21e164f52a19d0a3852689e"><div class="ttname"><a href="structPETScWrappers_1_1SolverBase_1_1SolverData.html#a3b67abc1b21e164f52a19d0a3852689e">PETScWrappers::SolverBase::SolverData::ksp</a></div><div class="ttdeci">KSP ksp</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00251">petsc_solver.h:251</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverCG_html_a91de1d30904b69e690d2786e5850940f"><div class="ttname"><a href="classPETScWrappers_1_1SolverCG.html#a91de1d30904b69e690d2786e5850940f">PETScWrappers::SolverCG::SolverCG</a></div><div class="ttdeci">SolverCG(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00330">petsc_solver.cc:330</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_a91e9997f38f0f1ba3f687a3bac1915df"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#a91e9997f38f0f1ba3f687a3bac1915df">PETScWrappers::SparseDirectMUMPS::solver_data</a></div><div class="ttdeci">std::unique_ptr&lt; SolverDataMUMPS &gt; solver_data</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l01023">petsc_solver.h:1023</a></div></div>
<div class="ttc" id="apreconditioners__0_8txt_html_abebc9af399f7664771e26564a49c8dc1"><div class="ttname"><a href="preconditioners__0_8txt.html#abebc9af399f7664771e26564a49c8dc1">iteration</a></div><div class="ttdeci">*****Preconditioners are used to accelerate the iterative solution of linear systems Typical preconditioners are Gauss or but the library also supports more complex ones such as Vanka or incomplete LU sparse direct solvers can be used as preconditioners when available *Broadly preconditioners are which are multiplied with a matrix to improve conditioning The idea that the preconditioned system[1.x.1] is much easier to solve than the original system[1.x.2] What this means exactly depends on the structure of the matrix and cannot be discussed here in generality For positive definite matrices[1.x.3] it means that the spectral condition Richardson iteration</div><div class="ttdef"><b>Definition:</b> <a href="preconditioners__0_8txt_source.html#l00009">preconditioners_0.txt:9</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverPreOnly_html_acb09d6c22c20e52b65ec87caae8cbace"><div class="ttname"><a href="classPETScWrappers_1_1SolverPreOnly.html#acb09d6c22c20e52b65ec87caae8cbace">PETScWrappers::SolverPreOnly::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00601">petsc_solver.cc:601</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverRichardson_html_a4e0b1b3290b125e1b476d6c1c5b8de17"><div class="ttname"><a href="classPETScWrappers_1_1SolverRichardson.html#a4e0b1b3290b125e1b476d6c1c5b8de17">PETScWrappers::SolverRichardson::SolverRichardson</a></div><div class="ttdeci">SolverRichardson(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00258">petsc_solver.cc:258</a></div></div>
<div class="ttc" id="aclassSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__control_8h_source.html#l00052">solver_control.h:52</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverGMRES_1_1AdditionalData_html_a51ed265e304a2828b72fa43def8cc971"><div class="ttname"><a href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html#a51ed265e304a2828b72fa43def8cc971">PETScWrappers::SolverGMRES::AdditionalData::right_preconditioning</a></div><div class="ttdeci">bool right_preconditioning</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00520">petsc_solver.h:520</a></div></div>
<div class="ttc" id="aclassSolverControl_html_aba046b0a2315e735fdf17d36ecb44f0b"><div class="ttname"><a href="classSolverControl.html#aba046b0a2315e735fdf17d36ecb44f0b">SolverControl::max_steps</a></div><div class="ttdeci">unsigned int max_steps() const</div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverTFQMR_html_a46f7615be6a43c00dc69df74061d3e5f"><div class="ttname"><a href="classPETScWrappers_1_1SolverTFQMR.html#a46f7615be6a43c00dc69df74061d3e5f">PETScWrappers::SolverTFQMR::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00505">petsc_solver.cc:505</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBiCG_html_a28fda07f2844c3b5602aed8bfb9ccc3b"><div class="ttname"><a href="classPETScWrappers_1_1SolverBiCG.html#a28fda07f2844c3b5602aed8bfb9ccc3b">PETScWrappers::SolverBiCG::SolverBiCG</a></div><div class="ttdeci">SolverBiCG(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00354">petsc_solver.cc:354</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverGMRES_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverGMRES_1_1AdditionalData.html">PETScWrappers::SolverGMRES::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00500">petsc_solver.h:500</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1VectorBase_html"><div class="ttname"><a href="classPETScWrappers_1_1VectorBase.html">PETScWrappers::VectorBase</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__vector__base_8h_source.html#l00268">petsc_vector_base.h:268</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverCR_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverCR_1_1AdditionalData.html">PETScWrappers::SolverCR::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00780">petsc_solver.h:780</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverGMRES_html_aa67bdf780098b031e843dfbe0032ee17"><div class="ttname"><a href="classPETScWrappers_1_1SolverGMRES.html#aa67bdf780098b031e843dfbe0032ee17">PETScWrappers::SolverGMRES::SolverGMRES</a></div><div class="ttdeci">SolverGMRES(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator=PETSC_COMM_SELF, const AdditionalData &amp;data=AdditionalData())</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00387">petsc_solver.cc:387</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_ae3fd76f0fcd93dcbcc9df2df2c6028fb"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#ae3fd76f0fcd93dcbcc9df2df2c6028fb">this</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of this</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverRichardson_1_1AdditionalData_html_a2b84d6dade4dd8f5da036866c1195b75"><div class="ttname"><a href="structPETScWrappers_1_1SolverRichardson_1_1AdditionalData.html#a2b84d6dade4dd8f5da036866c1195b75">PETScWrappers::SolverRichardson::AdditionalData::AdditionalData</a></div><div class="ttdeci">AdditionalData(const double omega=1)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00252">petsc_solver.cc:252</a></div></div>
<div class="ttc" id="astructPETScWrappers_1_1SolverBicgstab_1_1AdditionalData_html"><div class="ttname"><a href="structPETScWrappers_1_1SolverBicgstab_1_1AdditionalData.html">PETScWrappers::SolverBicgstab::AdditionalData</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l00572">petsc_solver.h:572</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverBase_html_ad8abf2cd55633333a0fd6d6553724958"><div class="ttname"><a href="classPETScWrappers_1_1SolverBase.html#ad8abf2cd55633333a0fd6d6553724958">PETScWrappers::SolverBase::SolverBase</a></div><div class="ttdeci">SolverBase(SolverControl &amp;cn, const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00045">petsc_solver.cc:45</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01699">exceptions.h:1699</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SolverLSQR_html_a14a9909be0b71d5047cd9569136a915e"><div class="ttname"><a href="classPETScWrappers_1_1SolverLSQR.html#a14a9909be0b71d5047cd9569136a915e">PETScWrappers::SolverLSQR::set_solver_type</a></div><div class="ttdeci">virtual void set_solver_type(KSP &amp;ksp) const override</div><div class="ttdef"><b>Definition:</b> <a href="petsc__solver_8cc_source.html#l00577">petsc_solver.cc:577</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a972c66b590bef4527cf74830c5e9ebec"><div class="ttname"><a href="multithreading__0_8txt.html#a972c66b590bef4527cf74830c5e9ebec">reason</a></div><div class="ttdeci">for if the values of a function need to be evaluated at quadrature then this is for some reason</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00192">multithreading_0.txt:192</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1SparseDirectMUMPS_html_adc29243b7a37499a9e31f6cf05a47bfc"><div class="ttname"><a href="classPETScWrappers_1_1SparseDirectMUMPS.html#adc29243b7a37499a9e31f6cf05a47bfc">PETScWrappers::SparseDirectMUMPS::symmetric_mode</a></div><div class="ttdeci">bool symmetric_mode</div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__solver_8h_source.html#l01030">petsc_solver.h:1030</a></div></div>
<div class="ttc" id="aclassPETScWrappers_1_1PreconditionBase_html"><div class="ttname"><a href="classPETScWrappers_1_1PreconditionBase.html">PETScWrappers::PreconditionBase</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2petsc__precondition_8h_source.html#l00057">petsc_precondition.h:57</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
