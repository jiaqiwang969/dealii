<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/namespaceLocalIntegrators.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: LocalIntegrators Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a>  </div>
  <div class="headertitle">
<div class="title">LocalIntegrators Namespace Reference<div class="ingroups"><a class="el" href="group__Integrators.html">Integrators</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Library of integrals over cells and faces This namespace contains application specific local integrals for bilinear forms, forms and error estimates. It is a collection of functions organized into namespaces devoted to certain applications. For instance, the namespace <a class="el" href="namespaceLocalIntegrators_1_1Laplace.html" title="Local integrators related to the Laplacian and its DG formulations.">Laplace</a> contains functions for computing cell matrices and cell residuals for the Laplacian operator, as well as functions for the weak boundary conditions by Nitsche or the interior penalty discontinuous Galerkin method. The namespace <a class="el" href="namespaceLocalIntegrators_1_1Maxwell.html" title="Local integrators related to curl operators and their traces. We use the following conventions for cu...">Maxwell</a> does the same for curl-curl type problems. The namespace <a class="el" href="namespaceLocalIntegrators_1_1L2.html" title="Local integrators related to L2-inner products.">L2</a> contains functions for mass matrices and <em>L<sup>2</sup></em>-inner products.  
<a href="namespaceLocalIntegrators.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1Advection"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1Advection.html">Advection</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1Advection"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local integrators related to advection along a vector field and its DG formulations All advection operators depend on an advection velocity denoted by <b>w</b> in the formulas below. It is denoted as <code>velocity</code> in the parameter lists. The functions <a class="el" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix()</a> and both <a class="el" href="namespaceLocalIntegrators_1_1Advection.html#a32e7c84d8a003be777ea86194920c907">upwind_value_matrix()</a> are taking the equation in weak form, that is, the directional derivative is on the test function. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1Divergence"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1Divergence.html">Divergence</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1Divergence"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local integrators related to the divergence operator and its trace. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1Elasticity"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1Elasticity.html">Elasticity</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1Elasticity"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local integrators related to elasticity problems. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1GradDiv"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1GradDiv.html">GradDiv</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1L2"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1L2.html">L2</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1L2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local integrators related to <em>L<sup>2</sup></em>-inner products. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1Laplace"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1Laplace.html">Laplace</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1Laplace"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local integrators related to the Laplacian and its DG formulations. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1Maxwell"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1Maxwell.html">Maxwell</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1Maxwell"><td class="mdescLeft">&#160;</td><td class="mdescRight">Local integrators related to curl operators and their traces. We use the following conventions for curl operators. First, in three space dimensions. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:namespaceLocalIntegrators_1_1Patches"><td class="memItemLeft" align="right" valign="top"> &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceLocalIntegrators_1_1Patches.html">Patches</a></td></tr>
<tr class="memdesc:namespaceLocalIntegrators_1_1Patches"><td class="mdescLeft">&#160;</td><td class="mdescRight">Integrators writing patches with values in quadrature points. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Library of integrals over cells and faces This namespace contains application specific local integrals for bilinear forms, forms and error estimates. It is a collection of functions organized into namespaces devoted to certain applications. For instance, the namespace <a class="el" href="namespaceLocalIntegrators_1_1Laplace.html" title="Local integrators related to the Laplacian and its DG formulations.">Laplace</a> contains functions for computing cell matrices and cell residuals for the Laplacian operator, as well as functions for the weak boundary conditions by Nitsche or the interior penalty discontinuous Galerkin method. The namespace <a class="el" href="namespaceLocalIntegrators_1_1Maxwell.html" title="Local integrators related to curl operators and their traces. We use the following conventions for cu...">Maxwell</a> does the same for curl-curl type problems. The namespace <a class="el" href="namespaceLocalIntegrators_1_1L2.html" title="Local integrators related to L2-inner products.">L2</a> contains functions for mass matrices and <em>L<sup>2</sup></em>-inner products. </p>
<p>Library of integrals over cells and faces.</p>
<h3>Notational conventions</h3>
<p>In most cases, the action of a function in this namespace can be described by a single integral. We distinguish between integrals over cells <em>Z</em> and over faces <em>F</em>. If an integral is denoted as </p><p class="formulaDsp">
\[ \int_Z u \otimes v \,dx, \]
</p>
<p> it will yield the following results, depending on the type of operation </p><ul>
<li>
If the function returns a matrix, the entry at position <em>(i,j)</em> will be the integrated product of test function <em>v<sub>i</sub></em> and trial function <em>u<sub>j</sub></em> (note the reversion of indices)  </li>
<li>
If the function returns a vector, then the vector entry at position <em>i</em> will be the integrated product of the given function <em>u</em> with the test function <em>v<sub>i</sub></em>.  </li>
<li>
If the function returns a number, then this number is the integral of the two given functions <em>u</em> and <em>v</em>. </li>
</ul>
<p>We will use regular cursive symbols \(u\) for scalars and bold symbols \(\mathbf u\) for vectors. Test functions are always <em>v</em> and trial functions are always <em>u</em>. Parameters are Greek and the face normal vectors are \(\mathbf n = \mathbf n_1 = -\mathbf n_2\) . </p><h3>Signature of functions</h3>
<p><a class="el" href="namespaceFunctions.html">Functions</a> in this namespace follow a generic signature. In the simplest case, you have two related functions</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a> (</div>
<div class="line">  <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a>&amp; M,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a>&amp; fe,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> factor = 1.);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Advection.html#aaff3056f2b80ada5c55d8c5825932c22">cell_residual</a> (</div>
<div class="line">  <a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a>* v,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a>&amp; fe,</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;<a class="code" href="classTensor.html">Tensor&lt;1,dim&gt;</a> &gt;&amp; input,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> factor = 1.);</div>
</div><!-- fragment --><p>There is typically a pair of functions for the same operator, the function <code>cell_residual</code> implementing the mapping of the operator from the finite element space into its dual, and the function <code>cell_matrix</code> generating the bilinear form corresponding to the Frechet derivative of <code>cell_residual</code>. The first argument of these functions is the return type, which is </p><ul>
<li>
<a class="el" href="classFullMatrix.html">FullMatrix</a>&lt;double&gt; for matrices </li>
<li>
<a class="el" href="classBlockVector.html">BlockVector</a>&amp;ltdouble&gt; for vectors </li>
</ul>
<p>The next argument is the <a class="el" href="classFEValuesBase.html">FEValuesBase</a> object representing the finite element for integration. If the integrated operator maps from one finite element space into the dual of another (for instance an off-diagonal matrix in a block system), then first the <a class="el" href="classFEValuesBase.html">FEValuesBase</a> for the trial space and after this the one for the test space are specified. This list is followed by the set of required data in the order </p><ol>
<li>
Data vectors from finite element functions </li>
<li>
Data vectors from other objects </li>
<li>
Additional data </li>
<li>
A factor which is multiplied with the whole result </li>
</ol>
<h3>Usage</h3>
<p>The local integrators can be used wherever a local integration loop would have been implemented instead. The following example is from the implementation of a Stokes solver, using MeshWorker::Assembler::LocalBlocksToGlobalBlocks. The matrices are </p><ul>
<li>
0: The vector Laplacian for the velocity (here with a vector valued element) </li>
<li>
1: The divergence matrix </li>
<li>
2: The pressure mass matrix used in the preconditioner </li>
</ul>
<p>With these matrices, the function called by <a class="el" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop()</a> could be written like</p>
<div class="fragment"><div class="line"><span class="keyword">using namespace </span>dealii::LocalIntegrators;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a>         &amp;dinfo,</div>
<div class="line">                               <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)</div>
<div class="line">{</div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#a733b581e72bfe9d27cc59501a35bcd30">Laplace::cell_matrix</a> (dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0,<span class="keyword">false</span>).<a class="code" href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">matrix</a>,</div>
<div class="line">                      info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0));</div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#ae2c29fed2a2e800bbb2a888d2f0daedb">Divergence::cell_matrix</a> (dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(1,<span class="keyword">false</span>).<a class="code" href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">matrix</a>,</div>
<div class="line">                         info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">                         info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(1));</div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">L2::cell_matrix</a> (dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(2,<span class="keyword">false</span>).<a class="code" href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">matrix</a>,</div>
<div class="line">                 info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(1));</div>
<div class="line">}</div>
</div><!-- fragment --><p> See <a class="el" href="step_39.html">step-39</a> for a worked out example of this code.</p>
<p>This namespace contains application specific local integrals for bilinear forms, forms and error estimates. It is a collection of functions organized into namespaces devoted to certain applications. For instance, the namespace <a class="el" href="namespaceLocalIntegrators_1_1Laplace.html" title="Local integrators related to the Laplacian and its DG formulations.">Laplace</a> contains functions for computing cell matrices and cell residuals for the Laplacian operator, as well as functions for the weak boundary conditions by Nitsche or the interior penalty discontinuous Galerkin method. The namespace <a class="el" href="namespaceLocalIntegrators_1_1Maxwell.html" title="Local integrators related to curl operators and their traces. We use the following conventions for cu...">Maxwell</a> does the same for curl-curl type problems.</p>
<p>The namespace <a class="el" href="namespaceLocalIntegrators_1_1L2.html" title="Local integrators related to L2-inner products.">L2</a> contains functions for mass matrices and <em>L<sup>2</sup></em>-inner products.</p>
<h3>Notational conventions</h3>
<p>In most cases, the action of a function in this namespace can be described by a single integral. We distinguish between integrals over cells <em>Z</em> and over faces <em>F</em>. If an integral is denoted as </p><p class="formulaDsp">
\[ \int_Z u \otimes v \,dx, \]
</p>
<p> it will yield the following results, depending on the type of operation </p><ul>
<li>
If the function returns a matrix, the entry at position <em>(i,j)</em> will be the integrated product of test function <em>v<sub>i</sub></em> and trial function <em>u<sub>j</sub></em> (note the reversion of indices) </li>
<li>
If the function returns a vector, then the vector entry at position <em>i</em> will be the integrated product of the given function <em>u</em> with the test function <em>v<sub>i</sub></em>. </li>
<li>
If the function returns a number, then this number is the integral of the two given functions <em>u</em> and <em>v</em>. </li>
</ul>
<p>We will use regular cursive symbols \(u\) for scalars and bold symbols \(\mathbf u\) for vectors. Test functions are always <em>v</em> and trial functions are always <em>u</em>. Parameters are Greek and the face normal vectors are \(\mathbf n = \mathbf n_1 = -\mathbf n_2\).</p>
<h3>Signature of functions</h3>
<p><a class="el" href="namespaceFunctions.html">Functions</a> in this namespace follow a generic signature. In the simplest case, you have two related functions </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a> (</div>
<div class="line">  <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a>&amp; M,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a>&amp; fe,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> factor = 1.);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line"><a class="code" href="namespaceLocalIntegrators_1_1Advection.html#aaff3056f2b80ada5c55d8c5825932c22">cell_residual</a> (</div>
<div class="line">  <a class="code" href="classBlockVector.html">BlockVector&lt;double&gt;</a>* v,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFEValuesBase.html">FEValuesBase&lt;dim&gt;</a>&amp; fe,</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;<a class="code" href="classTensor.html">Tensor&lt;1,dim&gt;</a> &gt;&amp; input,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> factor = 1.);</div>
</div><!-- fragment --><p>There is typically a pair of functions for the same operator, the function <code>cell_residual</code> implementing the mapping of the operator from the finite element space into its dual, and the function <code>cell_matrix</code> generating the bilinear form corresponding to the Frechet derivative of <code>cell_residual</code>.</p>
<p>The first argument of these functions is the return type, which is </p><ul>
<li>
<a class="el" href="classFullMatrix.html">FullMatrix</a>&lt;double&gt; for matrices </li>
<li>
<a class="el" href="classBlockVector.html">BlockVector</a>&amp;ltdouble&gt; for vectors </li>
</ul>
<p>The next argument is the <a class="el" href="classFEValuesBase.html">FEValuesBase</a> object representing the finite element for integration. If the integrated operator maps from one finite element space into the dual of another (for instance an off-diagonal matrix in a block system), then first the <a class="el" href="classFEValuesBase.html">FEValuesBase</a> for the trial space and after this the one for the test space are specified.</p>
<p>This list is followed by the set of required data in the order </p><ol>
<li>
Data vectors from finite element functions </li>
<li>
Data vectors from other objects </li>
<li>
Additional data </li>
<li>
A factor which is multiplied with the whole result </li>
</ol>
<h3>Usage</h3>
<p>The local integrators can be used wherever a local integration loop would have been implemented instead. The following example is from the implementation of a Stokes solver, using MeshWorker::Assembler::LocalBlocksToGlobalBlocks. The matrices are </p><ul>
<li>
0: The vector Laplacian for the velocity (here with a vector valued element) </li>
<li>
1: The divergence matrix </li>
<li>
2: The pressure mass matrix used in the preconditioner </li>
</ul>
<p>With these matrices, the function called by <a class="el" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop()</a> could be written like </p><div class="fragment"><div class="line"><span class="keyword">using namespace </span>dealii::LocalIntegrators;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> MatrixIntegrator&lt;dim&gt;::cell(<a class="code" href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo&lt;dim&gt;</a>         &amp;dinfo,</div>
<div class="line">                                 <a class="code" href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo&lt;dim&gt;</a> &amp;info)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1Laplace.html#a733b581e72bfe9d27cc59501a35bcd30">Laplace::cell_matrix</a> (dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(0,<span class="keyword">false</span>).<a class="code" href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">matrix</a>,</div>
<div class="line">                        info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0));</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#ae2c29fed2a2e800bbb2a888d2f0daedb">Divergence::cell_matrix</a> (dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(1,<span class="keyword">false</span>).<a class="code" href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">matrix</a>,</div>
<div class="line">                           info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(0),</div>
<div class="line">                           info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(1));</div>
<div class="line">  <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">L2::cell_matrix</a> (dinfo.<a class="code" href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">matrix</a>(2,<span class="keyword">false</span>).<a class="code" href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">matrix</a>,</div>
<div class="line">                   info.<a class="code" href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">fe_values</a>(1));</div>
<div class="line">}</div>
</div><!-- fragment --><p> See <a class="el" href="step_39.html">step-39</a> for a worked out example of this code. </p>
</div></div><!-- contents -->
<div class="ttc" id="anamespaceLocalIntegrators_1_1Divergence_html_ae2c29fed2a2e800bbb2a888d2f0daedb"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Divergence.html#ae2c29fed2a2e800bbb2a888d2f0daedb">LocalIntegrators::Divergence::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="integrators_2divergence_8h_source.html#l00055">divergence.h:55</a></div></div>
<div class="ttc" id="aclassBlockVector_html"><div class="ttname"><a href="classBlockVector.html">BlockVector&lt; double &gt;</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Laplace_html_a733b581e72bfe9d27cc59501a35bcd30"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Laplace.html#a733b581e72bfe9d27cc59501a35bcd30">LocalIntegrators::Laplace::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="integrators_2laplace_8h_source.html#l00052">laplace.h:52</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html_a32fa7363be71ba320bcdc94f6d677843"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html#a32fa7363be71ba320bcdc94f6d677843">MeshWorker::IntegrationInfo::fe_values</a></div><div class="ttdeci">const FEValuesBase&lt; dim, spacedim &gt; &amp; fe_values() const</div><div class="ttdoc">Access to finite element.</div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2integration__info_8h_source.html#l00645">integration_info.h:645</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Advection_html_a8bc7b8136646134f73a4193adefe15f8"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">LocalIntegrators::Advection::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="integrators_2advection_8h_source.html#l00068">advection.h:68</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1IntegrationInfo_html"><div class="ttname"><a href="classMeshWorker_1_1IntegrationInfo.html">MeshWorker::IntegrationInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2integration__info_8h_source.html#l00071">integration_info.h:71</a></div></div>
<div class="ttc" id="anamespaceLocalIntegrators_1_1Advection_html_aaff3056f2b80ada5c55d8c5825932c22"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#aaff3056f2b80ada5c55d8c5825932c22">LocalIntegrators::Advection::cell_residual</a></div><div class="ttdeci">void cell_residual(Vector&lt; double &gt; &amp;result, const FEValuesBase&lt; dim &gt; &amp;fe, const std::vector&lt; Tensor&lt; 1, dim &gt;&gt; &amp;input, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="integrators_2advection_8h_source.html#l00123">advection.h:123</a></div></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor&lt; 1, dim &gt;</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1LocalResults_html_a06c5d817ce47a4c26966df1cdcebeac4"><div class="ttname"><a href="classMeshWorker_1_1LocalResults.html#a06c5d817ce47a4c26966df1cdcebeac4">MeshWorker::LocalResults&lt; double &gt;::matrix</a></div><div class="ttdeci">MatrixBlock&lt; FullMatrix&lt; double &gt; &gt; &amp; matrix(const unsigned int i, const bool external=false)</div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2local__results_8h_source.html#l00549">local_results.h:549</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html"><div class="ttname"><a href="classFEValuesBase.html">FEValuesBase</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00036">fe.h:36</a></div></div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassMatrixBlock_html_a33610e6dfbd57d6ff0aa23e8582676bf"><div class="ttname"><a href="classMatrixBlock.html#a33610e6dfbd57d6ff0aa23e8582676bf">MatrixBlock::matrix</a></div><div class="ttdeci">MatrixType matrix</div><div class="ttdef"><b>Definition:</b> <a href="lac_2matrix__block_8h_source.html#l00326">matrix_block.h:326</a></div></div>
<div class="ttc" id="aclassMeshWorker_1_1DoFInfo_html"><div class="ttname"><a href="classMeshWorker_1_1DoFInfo.html">MeshWorker::DoFInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="meshworker_2dof__info_8h_source.html#l00069">dof_info.h:69</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
