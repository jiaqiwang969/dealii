<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/particles_2utilities_8cc_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: source/particles/utilities.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_ca918688fe6ad16dbc1c00f976b7b03f.html">particles</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">utilities.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="particles_2utilities_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2020 - 2021 by the deal.II authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="config_8h.html">deal.II/base/config.h</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2generic__linear__algebra_8h.html">deal.II/lac/generic_linear_algebra.h</a>&gt;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2particles_2utilities_8h.html">deal.II/particles/utilities.h</a>&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceParticles.html">Particles</a></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;{</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;  <span class="keyword">namespace </span><a class="code" href="namespaceUtilities.html">Utilities</a></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  {</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim, <span class="keyword">typename</span> SparsityType, <span class="keyword">typename</span> number&gt;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="namespaceParticles_1_1Utilities.html#a385ac8de44e5ce109e68a966c422defa">   32</a></span>&#160;    <a class="code" href="namespaceParticles_1_1Utilities.html#a385ac8de44e5ce109e68a966c422defa">create_interpolation_sparsity_pattern</a>(</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;      <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp;                <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;      <span class="keyword">const</span> <a class="code" href="classParticles_1_1ParticleHandler.html">Particles::ParticleHandler&lt;dim, spacedim&gt;</a> &amp;particle_handler,</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;      SparsityType &amp;                                   sparsity,</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;      <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;number&gt;</a> &amp;                <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>,</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;      <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a> &amp;                            space_comps)</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    {</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;      <span class="keywordflow">if</span> (particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#abafee65f03660b3adf80a40e52bfc7e4">n_locally_owned_particles</a>() == 0)</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// nothing to do here</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;tria = <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>.get_triangulation();</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>   = <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>.get_fe();</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>  max_particles_per_cell =</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#adf5e803af074c2c55cf5a19c3228059d">n_global_max_particles_per_cell</a>();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;      <span class="comment">// Take care of components</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;      <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a> comps =</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        (space_comps.<a class="code" href="classComponentMask.html#aaf3a560dc53de0fb8701646122b47fd2">size</a>() == 0 ? <a class="code" href="classComponentMask.html">ComponentMask</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">n_components</a>(), <span class="keyword">true</span>) :</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                                   space_comps);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(comps.<a class="code" href="classComponentMask.html#aaf3a560dc53de0fb8701646122b47fd2">size</a>(), <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">n_components</a>());</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> n_comps = comps.<a class="code" href="classComponentMask.html#ad2826c43e4d6b3c2fbb87e64c7c58780">n_selected_components</a>();</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="comment">// Global to local indices</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      std::vector&lt;unsigned int&gt; space_gtl(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">n_components</a>(),</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                                          <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; space_gtl.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">if</span> (comps[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>])</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;          space_gtl[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>++;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;      <span class="comment">// [TODO]: when the add_entries_local_to_global below will implement</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="comment">// the version with the dof_mask, this should be uncommented.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;      <span class="comment">// // Construct a dof_mask, used to distribute entries to the sparsity</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      <span class="comment">// Table&lt;2, bool&gt; dof_mask(max_particles_per_cell * n_comps,</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;      <span class="comment">//                         fe.n_dofs_per_cell());</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="comment">// dof_mask.fill(false);</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;      <span class="comment">// for (unsigned int i = 0; i &lt; space_fe.n_dofs_per_cell(); ++i)</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="comment">//   {</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="comment">//     const auto comp_i = space_fe.system_to_component_index(i).first;</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;      <span class="comment">//     if (space_gtl[comp_i] != numbers::invalid_unsigned_int)</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      <span class="comment">//       for (unsigned int j = 0; j &lt; max_particles_per_cell; ++j)</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="comment">//         dof_mask(i, j * n_comps + space_gtl[comp_i]) = true;</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">//   }</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;      std::vector&lt;types::global_dof_index&gt; dof_indices(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      std::vector&lt;types::particle_index&gt;   particle_indices(</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        max_particles_per_cell * n_comps);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      <span class="keyword">auto</span> <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a> = particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#a958a15b3aa325db82b4876cdb9feb527">begin</a>();</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a> != particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#ab5f542a397843198eb82d8537602daf3">end</a>())</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        {</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>-&gt;get_surrounding_cell(tria);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span>  dh_cell =</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#ga32b2a057d9abd2e1752bf8a3cb88e644">DoFHandler&lt;dim, spacedim&gt;::cell_iterator</a>(*<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, &amp;<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;          dh_cell-&gt;get_dof_indices(dof_indices);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> pic         = particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#acaf1232ffce0746baa64122a5c65822e">particles_in_cell</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> n_particles = particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#ac043a4ea224ed50a03b8e9c3d3b98aec">n_particles_in_cell</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;          particle_indices.resize(n_particles * n_comps);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(pic.begin() == <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a> != pic.<a class="code" href="classArrayView.html#a775e02d2deaf2f769e24dee0c3e7a582">end</a>(); ++<a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>, ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;            {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;              <span class="keyword">const</span> <span class="keyword">auto</span> p_id = <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>-&gt;get_id();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                {</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;                  <span class="keyword">const</span> <span class="keyword">auto</span> comp_j =</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                    space_gtl[<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElement.html#a86644fe67824373cd51e9ff7fca94f8c">system_to_component_index</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>).first];</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                  <span class="keywordflow">if</span> (comp_j != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                    <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#ad210f57f792afd7f51c72c546f22e298">add_entries_local_to_global</a>(</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                      {p_id * n_comps + comp_j}, {dof_indices[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]}, sparsity);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                }</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;            }</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;          <span class="comment">// [TODO]: when this works, use this:</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          <span class="comment">// constraints.add_entries_local_to_global(particle_indices,</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;          <span class="comment">//                                         dof_indices,</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;          <span class="comment">//                                         sparsity,</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          <span class="comment">//                                         dof_mask);</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        }</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim, <span class="keyword">typename</span> MatrixType&gt;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00115"></a><span class="lineno"><a class="line" href="namespaceParticles_1_1Utilities.html#acc316d7cfe8b762d0093207948d0fd79">  115</a></span>&#160;    <a class="code" href="namespaceParticles_1_1Utilities.html#acc316d7cfe8b762d0093207948d0fd79">create_interpolation_matrix</a>(</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp;                <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>,</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;      <span class="keyword">const</span> <a class="code" href="classParticles_1_1ParticleHandler.html">Particles::ParticleHandler&lt;dim, spacedim&gt;</a> &amp;particle_handler,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      MatrixType &amp;                                     <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;typename MatrixType::value_type&gt;</a> &amp;<a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>,</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a> &amp;                                     space_comps)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    {</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="keywordflow">if</span> (particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#abafee65f03660b3adf80a40e52bfc7e4">n_locally_owned_particles</a>() == 0)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;          <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.compress(<a class="code" href="group__Vectors.html#ga40c50779cd14ba89bbf0bd9b4561964cad11ac5bd2488371d9fa940c84241f82b">VectorOperation::add</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <span class="keywordflow">return</span>; <span class="comment">// nothing else to do here</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.n(), <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>.n_dofs());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;tria = <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>.get_triangulation();</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>   = <a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>.get_fe();</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span>  max_particles_per_cell =</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#adf5e803af074c2c55cf5a19c3228059d">n_global_max_particles_per_cell</a>();</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="comment">// Take care of components</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a> comps =</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        (space_comps.<a class="code" href="classComponentMask.html#aaf3a560dc53de0fb8701646122b47fd2">size</a>() == 0 ? <a class="code" href="classComponentMask.html">ComponentMask</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">n_components</a>(), <span class="keyword">true</span>) :</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                   space_comps);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(comps.<a class="code" href="classComponentMask.html#aaf3a560dc53de0fb8701646122b47fd2">size</a>(), <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">n_components</a>());</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keyword">const</span> <span class="keyword">auto</span> n_comps = comps.<a class="code" href="classComponentMask.html#ad2826c43e4d6b3c2fbb87e64c7c58780">n_selected_components</a>();</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.m(),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                      particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#a11a0beaff35d1541936ffa8d4724aab1">n_global_particles</a>() * n_comps);</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      <span class="comment">// Global to local indices</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      std::vector&lt;unsigned int&gt; space_gtl(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">n_components</a>(),</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                          <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; space_gtl.size(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="keywordflow">if</span> (comps[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>])</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;          space_gtl[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>++;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      <span class="comment">// [TODO]: when the add_entries_local_to_global below will implement</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;      <span class="comment">// the version with the dof_mask, this should be uncommented.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;      <span class="comment">// // Construct a dof_mask, used to distribute entries to the sparsity</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="comment">// Table&lt;2, bool&gt; dof_mask(max_particles_per_cell * n_comps,</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="comment">//                         fe.n_dofs_per_cell());</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <span class="comment">// dof_mask.fill(false);</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="comment">// for (unsigned int i = 0; i &lt; space_fe.n_dofs_per_cell(); ++i)</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      <span class="comment">//   {</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="comment">//     const auto comp_i = space_fe.system_to_component_index(i).first;</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;      <span class="comment">//     if (space_gtl[comp_i] != numbers::invalid_unsigned_int)</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      <span class="comment">//       for (unsigned int j = 0; j &lt; max_particles_per_cell; ++j)</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      <span class="comment">//         dof_mask(i, j * n_comps + space_gtl[comp_i]) = true;</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      <span class="comment">//   }</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;      std::vector&lt;types::global_dof_index&gt; dof_indices(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;      std::vector&lt;types::particle_index&gt;   particle_indices(</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        max_particles_per_cell * n_comps);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="classFullMatrix.html">FullMatrix&lt;typename MatrixType::value_type&gt;</a> local_matrix(</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        max_particles_per_cell * n_comps, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;      <span class="keyword">auto</span> <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a> = particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#a958a15b3aa325db82b4876cdb9feb527">begin</a>();</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      <span class="keywordflow">while</span> (<a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a> != particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#ab5f542a397843198eb82d8537602daf3">end</a>())</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>-&gt;get_surrounding_cell(tria);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> &amp;dh_cell =</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;            <span class="keyword">typename</span> <a class="code" href="group__Iterators.html#ga32b2a057d9abd2e1752bf8a3cb88e644">DoFHandler&lt;dim, spacedim&gt;::cell_iterator</a>(*<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, &amp;<a class="code" href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a>);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          dh_cell-&gt;get_dof_indices(dof_indices);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> pic         = particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#acaf1232ffce0746baa64122a5c65822e">particles_in_cell</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> n_particles = particle_handler.<a class="code" href="classParticles_1_1ParticleHandler.html#ac043a4ea224ed50a03b8e9c3d3b98aec">n_particles_in_cell</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          particle_indices.resize(n_particles * n_comps);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          local_matrix.reinit({n_particles * n_comps, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>()});</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(pic.begin() == <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a> != pic.<a class="code" href="classArrayView.html#a775e02d2deaf2f769e24dee0c3e7a582">end</a>(); ++<a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>, ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            {</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;              <span class="keyword">const</span> <span class="keyword">auto</span> &amp;reference_location =</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>-&gt;get_reference_location();</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; n_comps; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                particle_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> * n_comps + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                  <a class="code" href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a>-&gt;get_id() * n_comps + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                  <span class="keyword">const</span> <span class="keyword">auto</span> comp_j =</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                    space_gtl[<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElement.html#a86644fe67824373cd51e9ff7fca94f8c">system_to_component_index</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>).first];</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                  <span class="keywordflow">if</span> (comp_j != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>)</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                    local_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> * n_comps + comp_j, <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) =</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                      <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFE__Poly.html#a9205cb50b9901b40adc7220dd92ded5c">shape_value</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, reference_location);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                }</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            }</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;          <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>.<a class="code" href="classAffineConstraints.html#a373fbdacd8c486e675b8d2bff8943192">distribute_local_to_global</a>(local_matrix,</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                                 particle_indices,</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                                                 dof_indices,</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                 <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;      <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>.compress(<a class="code" href="group__Vectors.html#ga40c50779cd14ba89bbf0bd9b4561964cad11ac5bd2488371d9fa940c84241f82b">VectorOperation::add</a>);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">#include &quot;utilities.inst&quot;</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  } <span class="comment">// namespace Utilities</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;} <span class="comment">// namespace Particles</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_acaf1232ffce0746baa64122a5c65822e"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#acaf1232ffce0746baa64122a5c65822e">Particles::ParticleHandler::particles_in_cell</a></div><div class="ttdeci">particle_iterator_range particles_in_cell(const typename Triangulation&lt; dim, spacedim &gt;::active_cell_iterator &amp;cell)</div><div class="ttdef"><b>Definition:</b> <a href="particle__handler_8cc_source.html#l00318">particle_handler.cc:318</a></div></div>
<div class="ttc" id="aclassArrayView_html_a775e02d2deaf2f769e24dee0c3e7a582"><div class="ttname"><a href="classArrayView.html#a775e02d2deaf2f769e24dee0c3e7a582">ArrayView::end</a></div><div class="ttdeci">iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="base_2array__view_8h_source.html#l00611">array_view.h:611</a></div></div>
<div class="ttc" id="agroup__Iterators_html_ga32b2a057d9abd2e1752bf8a3cb88e644"><div class="ttname"><a href="group__Iterators.html#ga32b2a057d9abd2e1752bf8a3cb88e644">DoFHandler::cell_iterator</a></div><div class="ttdeci">typename ActiveSelector::cell_iterator cell_iterator</div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00372">dof_handler.h:372</a></div></div>
<div class="ttc" id="aclassComponentMask_html_ad2826c43e4d6b3c2fbb87e64c7c58780"><div class="ttname"><a href="classComponentMask.html#ad2826c43e4d6b3c2fbb87e64c7c58780">ComponentMask::n_selected_components</a></div><div class="ttdeci">unsigned int n_selected_components(const unsigned int overall_number_of_components=numbers::invalid_unsigned_int) const</div></div>
<div class="ttc" id="aclassComponentMask_html"><div class="ttname"><a href="classComponentMask.html">ComponentMask</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2component__mask_8h_source.html#l00080">component_mask.h:80</a></div></div>
<div class="ttc" id="anamespaceParticles_html"><div class="ttname"><a href="namespaceParticles.html">Particles</a></div><div class="ttdef"><b>Definition:</b> <a href="particles_2data__out_8h_source.html#l00029">data_out.h:29</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2particles_2utilities_8h_html"><div class="ttname"><a href="include_2deal_8II_2particles_2utilities_8h.html">utilities.h</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a93f65b0385560a34ec1d3c5ec5a882b8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="agroup__Vectors_html_ga40c50779cd14ba89bbf0bd9b4561964cad11ac5bd2488371d9fa940c84241f82b"><div class="ttname"><a href="group__Vectors.html#ga40c50779cd14ba89bbf0bd9b4561964cad11ac5bd2488371d9fa940c84241f82b">VectorOperation::add</a></div><div class="ttdeci">@ add</div><div class="ttdef"><b>Definition:</b> <a href="lac_2vector__operation_8h_source.html#l00056">vector_operation.h:56</a></div></div>
<div class="ttc" id="aclassComponentMask_html_aaf3a560dc53de0fb8701646122b47fd2"><div class="ttname"><a href="classComponentMask.html#aaf3a560dc53de0fb8701646122b47fd2">ComponentMask::size</a></div><div class="ttdeci">unsigned int size() const</div></div>
<div class="ttc" id="aclassAffineConstraints_html_a373fbdacd8c486e675b8d2bff8943192"><div class="ttname"><a href="classAffineConstraints.html#a373fbdacd8c486e675b8d2bff8943192">AffineConstraints::distribute_local_to_global</a></div><div class="ttdeci">void distribute_local_to_global(const InVector &amp;local_vector, const std::vector&lt; size_type &gt; &amp;local_dof_indices, OutVector &amp;global_vector) const</div><div class="ttdef"><b>Definition:</b> <a href="lac_2affine__constraints_8h_source.html#l02250">affine_constraints.h:2250</a></div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a5abc878123b65e2a7a16e57bba0e282e"><div class="ttname"><a href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal as happens in flow problems and is handled by the[2.x.11] function or prescribed tangential as happens in electromagnetic problems and is handled by the[2.x.13] function For the former imagine for example that we are at at vertex where the normal vector has the form[2.x.14] and that and[2.x.17] components of the flow field at this vertex are associated with degrees of and Then the no normal flux condition means that we need to have the condition[2.x.18] The prescribed tangential component leads to similar constraints though there is often something on the right hand side ****If you have hanging node constraints</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html_ad210f57f792afd7f51c72c546f22e298"><div class="ttname"><a href="classAffineConstraints.html#ad210f57f792afd7f51c72c546f22e298">AffineConstraints::add_entries_local_to_global</a></div><div class="ttdeci">void add_entries_local_to_global(const std::vector&lt; size_type &gt; &amp;local_dof_indices, SparsityPatternType &amp;sparsity_pattern, const bool keep_constrained_entries=true, const Table&lt; 2, bool &gt; &amp;dof_mask=Table&lt; 2, bool &gt;()) const</div><div class="ttdef"><b>Definition:</b> <a href="lac_2affine__constraints_8h_source.html#l02482">affine_constraints.h:2482</a></div></div>
<div class="ttc" id="aparticles_2utilities__0_8txt_html_a6ecb2efebb411e1654774e4b776fcb7a"><div class="ttname"><a href="particles_2utilities__0_8txt.html#a6ecb2efebb411e1654774e4b776fcb7a">space_dh</a></div><div class="ttdeci">namespace for functions offering tools to handle ParticleHandler objects and their coupling with DoFHandler objects **Create an interpolation sparsity pattern for particles Given a triangulation representing the a particle handler of particles and a scalar finite element compute the sparsity pattern that would be necessary to assemble the matrix[1.x.0] where[2.x.3] is the finite element space associated with the space_dh</div><div class="ttdef"><b>Definition:</b> <a href="particles_2utilities__0_8txt_source.html#l00004">utilities_0.txt:4</a></div></div>
<div class="ttc" id="anamespaceParticles_1_1Utilities_html_a385ac8de44e5ce109e68a966c422defa"><div class="ttname"><a href="namespaceParticles_1_1Utilities.html#a385ac8de44e5ce109e68a966c422defa">Particles::Utilities::create_interpolation_sparsity_pattern</a></div><div class="ttdeci">void create_interpolation_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;space_dh, const Particles::ParticleHandler&lt; dim, spacedim &gt; &amp;particle_handler, SparsityType &amp;sparsity, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const ComponentMask &amp;space_comps=ComponentMask())</div><div class="ttdef"><b>Definition:</b> <a href="particles_2utilities_8cc_source.html#l00032">utilities.cc:32</a></div></div>
<div class="ttc" id="aclassFiniteElement_html_a86644fe67824373cd51e9ff7fca94f8c"><div class="ttname"><a href="classFiniteElement.html#a86644fe67824373cd51e9ff7fca94f8c">FiniteElement::system_to_component_index</a></div><div class="ttdeci">std::pair&lt; unsigned int, unsigned int &gt; system_to_component_index(const unsigned int index) const</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l03180">fe.h:3180</a></div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_a11a0beaff35d1541936ffa8d4724aab1"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#a11a0beaff35d1541936ffa8d4724aab1">Particles::ParticleHandler::n_global_particles</a></div><div class="ttdeci">types::particle_index n_global_particles() const</div><div class="ttdef"><b>Definition:</b> <a href="particle__handler_8cc_source.html#l00762">particle_handler.cc:762</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga9442b63275c9ef3fab29bc222831c49c"><div class="ttname"><a href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a></div><div class="ttdeci">#define AssertDimension(dim1, dim2)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01749">exceptions.h:1749</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_ab5f542a397843198eb82d8537602daf3"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#ab5f542a397843198eb82d8537602daf3">Particles::ParticleHandler::end</a></div><div class="ttdeci">particle_iterator end() const</div><div class="ttdef"><b>Definition:</b> <a href="particles_2particle__handler_8h_source.html#l01045">particle_handler.h:1045</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_abafee65f03660b3adf80a40e52bfc7e4"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#abafee65f03660b3adf80a40e52bfc7e4">Particles::ParticleHandler::n_locally_owned_particles</a></div><div class="ttdeci">types::particle_index n_locally_owned_particles() const</div><div class="ttdef"><b>Definition:</b> <a href="particle__handler_8cc_source.html#l00780">particle_handler.cc:780</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2affine__constraints_8h_source.html#l00516">affine_constraints.h:516</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="anamespaceParticles_1_1Utilities_html_acc316d7cfe8b762d0093207948d0fd79"><div class="ttname"><a href="namespaceParticles_1_1Utilities.html#acc316d7cfe8b762d0093207948d0fd79">Particles::Utilities::create_interpolation_matrix</a></div><div class="ttdeci">void create_interpolation_matrix(const DoFHandler&lt; dim, spacedim &gt; &amp;space_dh, const Particles::ParticleHandler&lt; dim, spacedim &gt; &amp;particle_handler, MatrixType &amp;matrix, const AffineConstraints&lt; typename MatrixType::value_type &gt; &amp;constraints=AffineConstraints&lt; typename MatrixType::value_type &gt;(), const ComponentMask &amp;space_comps=ComponentMask())</div><div class="ttdef"><b>Definition:</b> <a href="particles_2utilities_8cc_source.html#l00115">utilities.cc:115</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a8ae36952c7e0cc778b47b5371b3aeff1"><div class="ttname"><a href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a></div><div class="ttdeci">static const unsigned int invalid_unsigned_int</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00179">types.h:179</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html">Particles::ParticleHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="particles_2data__out_8h_source.html#l00032">data_out.h:32</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a5a698695065333035e493294ce92820e"><div class="ttname"><a href="classFiniteElementData.html#a5a698695065333035e493294ce92820e">FiniteElementData::n_components</a></div><div class="ttdeci">unsigned int n_components() const</div></div>
<div class="ttc" id="achunk__sparse__matrix__0_8txt_html_a59317914f0b63e3c2c7c6bd150b8ba3e"><div class="ttname"><a href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a></div><div class="ttdeci">0&lt;/tt &gt;, which sets all elements of the matrix to zero, but keep the sparsity pattern previously used. *[0.x.66] *Reinitialize the sparse matrix with the given sparsity pattern. The latter tells the matrix how many nonzero elements there need to be reserved. Regarding memory allocation, the same applies as said above. You have to make sure that the lifetime of the sparsity structure is at least as long as that of this matrix or as long as reinit(const ChunkSparsityPattern &amp;) is not called with a new sparsity structure. The elements of the matrix are set to zero by this function. *[0.x.67] *Release all memory and return to a state just like after having called the default constructor. It also forgets the sparsity pattern it was previously tied to. *[0.x.68] *[2.x.18] Information on the matrix *[0.x.69] *Return whether the object is empty. It is empty if either both dimensions are zero or no ChunkSparsityPattern is associated. *[0.x.70] *Return the dimension of the codomain(or range) space. Note that the matrix is of dimension[2.x.19] . *[0.x.71] *Return the dimension of the domain space. Note that the matrix is of dimension[2.x.20] . *[0.x.72] *Return the number of nonzero elements of this matrix. Actually, it returns the number of entries in the sparsity pattern matrix</div><div class="ttdef"><b>Definition:</b> <a href="chunk__sparse__matrix__0_8txt_source.html#l00156">chunk_sparse_matrix_0.txt:156</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_ad3b9cdeadeb3bcdb52af5db70c041a6e"><div class="ttname"><a href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **Constructor Takes all data stored in MatrixFree If applied to problems with more than one finite element or more than one quadrature formula selected during construction of[2.x.343] the appropriate component can be selected by the optional arguments[2.x.344] matrix_free Data object that contains all data[2.x.345] dof_no If matrix_free was set up with multiple DoFHandler this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.346] quad_no If matrix_free was set up with multiple Quadrature this parameter selects the appropriate number of the quadrature formula[2.x.347] first_selected_component If the dof_handler selected by dof_no uses an FESystem consisting of more than one this parameter allows for selecting the component where the current evaluation routine should start Note that one evaluator does not support combining different shape functions in different components In other the same base element of a FESystem needs to be set for the components between[2.x.348] and[2.x.349][2.x.350] active_fe_index If matrix_free was set up with DoFHandler objects with[2.x.351] this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.352] active_quad_index If matrix_free was set up with[2.x.353] this parameter selects the appropriate number of the quadrature formula **Constructor Takes all data stored in MatrixFree for a given cell which allows to automatically identify the active_fe_index and active_quad_index in case of a p adaptive strategy The rest of the arguments are the same as in the constructor above **Constructor that comes with reduced functionality and works similar as FEValues The arguments are similar to the ones passed to the constructor of with the notable difference that FEEvaluation expects a one dimensional quadrature instead of a[2.x.354] dimensional one The finite element can be both scalar or vector but this method always only selects a scalar base element at a the optional argument[2.x.356] allows to specify the index of the base element to be used for evaluation Note that the internal data structures always assume that the base element is non primitive are not supported currently As known from a call to the reinit method with a[2.x.357] is necessary to make the geometry and degrees of freedom of the current class known::If the iterator includes DoFHandler the initialization allows to also read from or write to vectors in the standard way for[2.x.359] types for one cell at a time this approach is much slower than the path with MatrixFree with MPI since index translation has to be done As only one cell at a time is this method does not vectorize over several but only possibly within the element if the evaluate integrate routines are combined inside user an object of type i the underlying mapping and quadrature points do only need to be evaluated once Make sure to not pass an optional object around when you intend to use the FEEvaluation object in parallel to the given one because otherwise the intended sharing may create race conditions **Copy constructor If FEEvaluationBase was constructed from a fe</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00555">fe_evaluation_0.txt:555</a></div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_adf5e803af074c2c55cf5a19c3228059d"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#adf5e803af074c2c55cf5a19c3228059d">Particles::ParticleHandler::n_global_max_particles_per_cell</a></div><div class="ttdeci">types::particle_index n_global_max_particles_per_cell() const</div><div class="ttdef"><b>Definition:</b> <a href="particle__handler_8cc_source.html#l00771">particle_handler.cc:771</a></div></div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; typename MatrixType::value_type &gt;</a></div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_ac043a4ea224ed50a03b8e9c3d3b98aec"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#ac043a4ea224ed50a03b8e9c3d3b98aec">Particles::ParticleHandler::n_particles_in_cell</a></div><div class="ttdeci">types::particle_index n_particles_in_cell(const typename Triangulation&lt; dim, spacedim &gt;::active_cell_iterator &amp;cell) const</div><div class="ttdef"><b>Definition:</b> <a href="particle__handler_8cc_source.html#l00282">particle_handler.cc:282</a></div></div>
<div class="ttc" id="alac_2generic__linear__algebra_8h_html"><div class="ttname"><a href="lac_2generic__linear__algebra_8h.html">generic_linear_algebra.h</a></div></div>
<div class="ttc" id="aclassFE__Poly_html_a9205cb50b9901b40adc7220dd92ded5c"><div class="ttname"><a href="classFE__Poly.html#a9205cb50b9901b40adc7220dd92ded5c">FE_Poly::shape_value</a></div><div class="ttdeci">virtual double shape_value(const unsigned int i, const Point&lt; dim &gt; &amp;p) const override</div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_ac00ea19562c135512a6ff275a3cf0d8f"><div class="ttname"><a href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has this class generates all dim dimensional polynomials of the where the sum and[1.x.8] is less than or equal *[1.x.9] The i e for each dim dimensional polynomial in the polynomial space it gives the indices j</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00004">polynomial_space_0.txt:4</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a33b522422da89e5c080e7405ad49d7c7"><div class="ttname"><a href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">FiniteElementData::n_dofs_per_cell</a></div><div class="ttdeci">unsigned int n_dofs_per_cell() const</div></div>
<div class="ttc" id="aparticle__0_8txt_html_a770ac0edb21c7955207df05e1fa5e0c5"><div class="ttname"><a href="particle__0_8txt.html#a770ac0edb21c7955207df05e1fa5e0c5">particle</a></div><div class="ttdeci">namespace that contains all classes that are related to the particle implementation in particular the fundamental Particle class ***Internal alias of cell level index pair **A class that represents a particle in a domain that is meshed by a triangulation of some kind The data this class stores is the position of the particle in the overall space the position of the particle in the reference coordinate system of the cell it is currently in an ID number that is unique among all particles and a variable number of properties The properties attached to each object of this class are stored by a PropertyPool object These properties are stored as an array of double variables that can be accessed via an ArrayView object For example if one wanted to equip each particle with a temperature and chemical composition property that is advected along with the particle(and may change from time step to time step based on some differential equation, for example)</div></div>
<div class="ttc" id="aclassParticles_1_1ParticleHandler_html_a958a15b3aa325db82b4876cdb9feb527"><div class="ttname"><a href="classParticles_1_1ParticleHandler.html#a958a15b3aa325db82b4876cdb9feb527">Particles::ParticleHandler::begin</a></div><div class="ttdeci">particle_iterator begin() const</div><div class="ttdef"><b>Definition:</b> <a href="particles_2particle__handler_8h_source.html#l01027">particle_handler.h:1027</a></div></div>
<div class="ttc" id="anamespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00030">communication_pattern_base.h:30</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
