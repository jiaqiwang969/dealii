<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step_34.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-34 tutorial program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The step-34 tutorial program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial depends on <a class="el" href="step_4.html">step-4</a>.</p>
<p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#Irrotationalflow"> Irrotational flow </a>
        <li><a href="#Thenumericalapproximation">The numerical approximation</a>
        <li><a href="#Collocationboundaryelementmethod"> Collocation boundary element method </a>
        <li><a href="#Treatingthesingularintegrals"> Treating the singular integrals. </a>
        <li><a href="#Implementation">Implementation</a>
        <li><a href="#Testcase">Testcase</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Includefiles">Include files</a>
        <li><a href="#Singleanddoublelayeroperatorkernels">Single and double layer operator kernels</a>
        <li><a href="#TheBEMProblemclass">The BEMProblem class</a>
      <ul>
        <li><a href="#BEMProblemBEMProblemandBEMProblemread_parameters">BEMProblem::BEMProblem and BEMProblem::read_parameters</a>
        <li><a href="#BEMProblemread_domain">BEMProblem::read_domain</a>
        <li><a href="#BEMProblemrefine_and_resize">BEMProblem::refine_and_resize</a>
        <li><a href="#BEMProblemassemble_system">BEMProblem::assemble_system</a>
        <li><a href="#BEMProblemsolve_system">BEMProblem::solve_system</a>
        <li><a href="#BEMProblemcompute_errors">BEMProblem::compute_errors</a>
        <li><a href="#BEMProblemcompute_exterior_solution">BEMProblem::compute_exterior_solution</a>
        <li><a href="#BEMProblemoutput_results">BEMProblem::output_results</a>
        <li><a href="#BEMProblemrun">BEMProblem::run</a>
      </ul>
        <li><a href="#Themainfunction">The main() function</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <br  />
</p>
<p><em>This program was contributed by Luca Heltai (thanks to Michael Gratton for pointing out what the exact solution should have been in the three dimensional case). </em></p>
<dl class="section note"><dt>Note</dt><dd>If you use this program as a basis for your own work, please consider citing it in your list of references. The initial version of this work was contributed to the deal.II project by the authors listed in the following citation: <a href="https://doi.org/10.5281/zenodo.495473"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.495473.svg" alt="10.5281/zenodo.495473"/></a> </dd></dl>
<p><a class="anchor" id="Intro"></a></p>
<p><a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p><a class="anchor" id="Irrotationalflow"></a></p><h3>Irrotational flow </h3>
<p>The incompressible motion of an inviscid fluid past a body (for example air past an airplane wing, or air or water past a propeller) is usually modeled by the Euler equations of fluid dynamics:</p>
<p class="formulaDsp">
\begin{align*} \frac{\partial }{\partial t}\mathbf{v} + (\mathbf{v}\cdot\nabla)\mathbf{v} &amp;= -\frac{1}{\rho}\nabla p + \mathbf{g} \qquad &amp;\text{in } \mathbb{R}^n \backslash \Omega \\ \nabla \cdot \mathbf{v}&amp;=0 &amp;\text{in } \mathbb{R}^n\backslash\Omega \end{align*}
</p>
<p> where the fluid density \(\rho\) and the acceleration \(\mathbf{g}\) due to external forces are given and the velocity \(\mathbf{v}\) and the pressure \(p\) are the unknowns. Here \(\Omega\) is a closed bounded region representing the body around which the fluid moves.</p>
<p>The above equations can be derived from Navier-Stokes equations assuming that the effects due to viscosity are negligible compared to those due to the pressure gradient, inertial forces and the external forces. This is the opposite case of the Stokes equations discussed in <a class="el" href="step_22.html">step-22</a> which are the limit case of dominant viscosity, i.e. where the velocity is so small that inertia forces can be neglected. On the other hand, owing to the assumed incompressibility, the equations are not suited for very high speed gas flows where compressibility and the equation of state of the gas have to be taken into account, leading to the Euler equations of gas dynamics, a hyperbolic system.</p>
<p>For the purpose of this tutorial program, we will consider only stationary flow without external forces: </p><p class="formulaDsp">
\begin{align*} (\mathbf{v}\cdot\nabla)\mathbf{v} &amp;= -\frac{1}{\rho}\nabla p \qquad &amp;\text{in } \mathbb{R}^n \backslash \Omega \\ \nabla \cdot \mathbf{v}&amp;=0 &amp;\text{in } \mathbb{R}^n\backslash\Omega \end{align*}
</p>
<p>Uniqueness of the solution of the Euler equations is ensured by adding the boundary conditions </p><p class="formulaDsp">
\[ \label{eq:boundary-conditions} \begin{aligned} \mathbf{n}\cdot\mathbf{v}&amp; = 0 \qquad &amp;&amp; \text{ on } \partial\Omega \\ \mathbf{v}&amp; = \mathbf{v}_\infty &amp;&amp; \text{ when } |\mathbf{x}| \to \infty, \end{aligned} \]
</p>
<p>which is to say that the body is at rest in our coordinate systems and is not permeable, and that the fluid has (constant) velocity \(\mathbf{v}_\infty\) at infinity. An alternative viewpoint is that our coordinate system moves along with the body whereas the background fluid is at rest at infinity. Notice that we define the normal \(\mathbf{n}\) as the <em>outer</em> normal to the domain \(\Omega\), which is the opposite of the outer normal to the integration domain.</p>
<p>For both stationary and non stationary flow, the solution process starts by solving for the velocity in the second equation and substituting in the first equation in order to find the pressure. The solution of the stationary Euler equations is typically performed in order to understand the behavior of the given (possibly complex) geometry when a prescribed motion is enforced on the system.</p>
<p>The first step in this process is to change the frame of reference from a coordinate system moving along with the body to one in which the body moves through a fluid that is at rest at infinity. This can be expressed by introducing a new velocity \(\mathbf{\tilde{v}}=\mathbf{v}-\mathbf{v}_\infty\) for which we find that the same equations hold (because \(\nabla\cdot \mathbf{v}_\infty=0\)) and we have boundary conditions </p><p class="formulaDsp">
\[ \label{eq:boundary-conditions-tilde} \begin{aligned} \mathbf{n}\cdot\mathbf{\tilde{v}}&amp; = -\mathbf{n}\cdot\mathbf{v}_\infty \qquad &amp;&amp; \text{ on } \partial\Omega \\ \mathbf{\tilde{v}}&amp; = 0 &amp;&amp; \text{ when } |\mathbf{x}| \to \infty, \end{aligned} \]
</p>
<p>If we assume that the fluid is irrotational, i.e., \(\nabla \times \mathbf{v}=0\) in \(\mathbb{R}^n\backslash\Omega\), we can represent the velocity, and consequently also the perturbation velocity, as the gradient of a scalar function: </p><p class="formulaDsp">
\[ \mathbf{\tilde{v}}=\nabla\phi, \]
</p>
<p> and so the second part of Euler equations above can be rewritten as the homogeneous Laplace equation for the unknown \(\phi\): </p><p class="formulaDsp">
\begin{align*} \label{laplace} \Delta\phi &amp;= 0 \qquad &amp;&amp;\text{in}\ \mathbb{R}^n\backslash\Omega, \\ \mathbf{n}\cdot\nabla\phi &amp;= -\mathbf{n}\cdot\mathbf{v}_\infty &amp;&amp; \text{on}\ \partial\Omega \end{align*}
</p>
<p> while the momentum equation reduces to Bernoulli's equation that expresses the pressure \(p\) as a function of the potential \(\phi\): </p><p class="formulaDsp">
\[ \frac{p}{\rho} +\frac{1}{2} | \nabla \phi |^2 = 0 \in \Omega. \]
</p>
<p>So we can solve the problem by solving the Laplace equation for the potential. We recall that the following functions, called fundamental solutions of the Laplace equation,</p>
<p class="formulaDsp">
\[ \begin{aligned} \label{eq:3} G(\mathbf{y}-\mathbf{x}) = &amp; -\frac{1}{2\pi}\ln|\mathbf{y}-\mathbf{x}| \qquad &amp;&amp; \text{for } n=2 \\ G(\mathbf{y}-\mathbf{x}) = &amp; \frac{1}{4\pi}\frac{1}{|\mathbf{y}-\mathbf{x}|}&amp;&amp; \text{for } n=3, \end{aligned} \]
</p>
<p>satisfy in a distributional sense the equation:</p>
<p class="formulaDsp">
\[ -\Delta_y G(\mathbf{y}-\mathbf{x}) = \delta(\mathbf{y}-\mathbf{x}), \]
</p>
<p>where the derivative is done in the variable \(\mathbf{y}\). By using the usual Green identities, our problem can be written on the boundary \(\partial\Omega = \Gamma\) only. We recall the general definition of the second Green identity:</p>
<p class="formulaDsp">
\[\label{green} \int_{\omega} (-\Delta u)v\,dx + \int_{\partial\omega} \frac{\partial u}{\partial \tilde{\mathbf{n}} }v \,ds = \int_{\omega} (-\Delta v)u\,dx + \int_{\partial\omega} u\frac{\partial v}{\partial \tilde{\mathbf{n}}} \,ds, \]
</p>
<p>where \(\tilde{\mathbf{n}}\) is the normal to the surface of \(\omega\) pointing outwards from the domain of integration \(\omega\).</p>
<p>In our case the domain of integration is the domain \(\mathbb{R}^n\backslash\Omega\), whose boundary is \( \Gamma_\infty \cup \Gamma\), where the "boundary" at infinity is defined as</p>
<p class="formulaDsp">
\[ \Gamma_\infty \dealcoloneq \lim_{r\to\infty} \partial B_r(0). \]
</p>
<p>In our program the normals are defined as <em>outer</em> to the domain \(\Omega\), that is, they are in fact <em>inner</em> to the integration domain, and some care is required in defining the various integrals with the correct signs for the normals, i.e. replacing \(\tilde{\mathbf{n}}\) by \(-\mathbf{n}\).</p>
<p>If we substitute \(u\) and \(v\) in the Green identity with the solution \(\phi\) and with the fundamental solution of the Laplace equation respectively, as long as \(\mathbf{x}\) is chosen in the region \(\mathbb{R}^n\backslash\Omega\), we obtain: </p><p class="formulaDsp">
\[ \phi(\mathbf{x}) - \int_{\Gamma\cup\Gamma_\infty}\frac{\partial G(\mathbf{y}-\mathbf{x})}{\partial \mathbf{n}_y}\phi(\mathbf{y})\,ds_y = -\int_{\Gamma\cup\Gamma_\infty}G(\mathbf{y}-\mathbf{x})\frac{\partial \phi}{\partial \mathbf{n}_y}(\mathbf{y})\,ds_y \qquad \forall\mathbf{x}\in \mathbb{R}^n\backslash\Omega \]
</p>
<p>where the normals are now pointing <em>inward</em> the domain of integration.</p>
<p>Notice that in the above equation, we also have the integrals on the portion of the boundary at \(\Gamma_\infty\). Using the boundary conditions of our problem, we have that \(\nabla \phi\) is zero at infinity (which simplifies the integral on \(\Gamma_\infty\) on the right hand side).</p>
<p>The integral on \(\Gamma_\infty\) that appears on the left hand side can be treated by observing that \(\nabla\phi=0\) implies that \(\phi\) at infinity is necessarily constant. We define its value to be \(\phi_\infty\). It is an easy exercise to prove that</p>
<p class="formulaDsp">
\[ -\int_{\Gamma_\infty} \frac{\partial G(\mathbf{y}-\mathbf{x})} {\partial \mathbf{n}_y}\phi_\infty \,ds_y = \lim_{r\to\infty} \int_{\partial B_r(0)} \frac{\mathbf{r}}{r} \cdot \nabla G(\mathbf{y}-\mathbf{x}) \phi_\infty \,ds_y = -\phi_\infty. \]
</p>
<p>Using this result, we can reduce the above equation only on the boundary \(\Gamma\) using the so-called Single and Double Layer Potential operators:</p>
<p class="formulaDsp">
\[\label{integral} \phi(\mathbf{x}) - (D\phi)(\mathbf{x}) = \phi_\infty -\left(S \frac{\partial \phi}{\partial n_y}\right)(\mathbf{x}) \qquad \forall\mathbf{x}\in \mathbb{R}^n\backslash\Omega. \]
</p>
<p>(The name of these operators comes from the fact that they describe the electric potential in \(\mathbb{R}^n\) due to a single thin sheet of charges along a surface, and due to a double sheet of charges and anti-charges along the surface, respectively.)</p>
<p>In our case, we know the Neumann values of \(\phi\) on the boundary: \(\mathbf{n}\cdot\nabla\phi = -\mathbf{n}\cdot\mathbf{v}_\infty\). Consequently, </p><p class="formulaDsp">
\[ \phi(\mathbf{x}) - (D\phi)(\mathbf{x}) = \phi_\infty + \left(S[\mathbf{n}\cdot\mathbf{v}_\infty]\right)(\mathbf{x}) \qquad \forall\mathbf{x} \in \mathbb{R}^n\backslash\Omega. \]
</p>
<p> If we take the limit for \(\mathbf{x}\) tending to \(\Gamma\) of the above equation, using well known properties of the single and double layer operators, we obtain an equation for \(\phi\) just on the boundary \(\Gamma\) of \(\Omega\):</p>
<p class="formulaDsp">
\[\label{SD} \alpha(\mathbf{x})\phi(\mathbf{x}) - (D\phi)(\mathbf{x}) = \phi_\infty + \left(S [\mathbf{n}\cdot\mathbf{v}_\infty]\right)(\mathbf{x}) \quad \mathbf{x}\in \partial\Omega, \]
</p>
<p>which is the Boundary Integral Equation (BIE) we were looking for, where the quantity \(\alpha(\mathbf{x})\) is the fraction of angle or solid angle by which the point \(\mathbf{x}\) sees the domain of integration \(\mathbb{R}^n\backslash\Omega\).</p>
<p>In particular, at points \(\mathbf{x}\) where the boundary \(\partial\Omega\) is differentiable (i.e. smooth) we have \(\alpha(\mathbf{x})=\frac 12\), but the value may be smaller or larger at points where the boundary has a corner or an edge.</p>
<p>Substituting the single and double layer operators we get: </p><p class="formulaDsp">
\[ \alpha(\mathbf{x}) \phi(\mathbf{x}) + \frac{1}{2\pi}\int_{\partial \Omega} \frac{ (\mathbf{y}-\mathbf{x})\cdot\mathbf{n}_y }{ |\mathbf{y}-\mathbf{x}|^2 } \phi(\mathbf{y}) \,ds_y = \phi_\infty -\frac{1}{2\pi}\int_{\partial \Omega} \ln|\mathbf{y}-\mathbf{x}| \, \mathbf{n}\cdot\mathbf{v_\infty}\,ds_y \]
</p>
<p> for two dimensional flows and </p><p class="formulaDsp">
\[ \alpha(\mathbf{x}) \phi(\mathbf{x}) + \frac{1}{4\pi}\int_{\partial \Omega} \frac{ (\mathbf{y}-\mathbf{x})\cdot\mathbf{n}_y }{ |\mathbf{y}-\mathbf{x}|^3 }\phi(\mathbf{y})\,ds_y = \phi_\infty + \frac{1}{4\pi}\int_{\partial \Omega} \frac{1}{|\mathbf{y}-\mathbf{x}|} \, \mathbf{n}\cdot\mathbf{v_\infty}\,ds_y \]
</p>
<p> for three dimensional flows, where the normal derivatives of the fundamental solutions have been written in a form that makes computation easier. In either case, \(\phi\) is the solution of an integral equation posed entirely on the boundary since both \(\mathbf{x},\mathbf{y}\in\partial\Omega\).</p>
<p>Notice that the fraction of angle (in 2d) or solid angle (in 3d) \(\alpha(\mathbf{x})\) by which the point \(\mathbf{x}\) sees the domain \(\Omega\) can be defined using the double layer potential itself: </p><p class="formulaDsp">
\[ \alpha(\mathbf{x}) \dealcoloneq 1 - \frac{1}{2(n-1)\pi}\int_{\partial \Omega} \frac{ (\mathbf{y}-\mathbf{x})\cdot\mathbf{n}_y } { |\mathbf{y}-\mathbf{x}|^{n} }\phi(\mathbf{y})\,ds_y = 1+ \int_{\partial \Omega} \frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y. \]
</p>
<p>The reason why this is possible can be understood if we consider the fact that the solution of a pure Neumann problem is known up to an arbitrary constant \(c\), which means that, if we set the Neumann data to be zero, then any constant \(\phi = \phi_\infty\) will be a solution. Inserting the constant solution and the Neumann boundary condition in the boundary integral equation, we have </p><p class="formulaDsp">
\begin{align*} \alpha\left(\mathbf{x}\right)\phi\left(\mathbf{x}\right) &amp;=\int_{\Omega}\phi\left(\mathbf{y}\right)\delta\left(\mathbf{y}-\mathbf{x}\right)\, dy\\ \Rightarrow \alpha\left(\mathbf{x}\right)\phi_\infty &amp;=\phi_\infty\int_{\Gamma\cup\Gamma_\infty}\frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y =\phi_\infty\left[\int_{\Gamma_\infty}\frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y +\int_{\Gamma}\frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y \right] \end{align*}
</p>
<p> The integral on \(\Gamma_\infty\) is unity, see above, so division by the constant \(\phi_\infty\) gives us the explicit expression above for \(\alpha(\mathbf{x})\).</p>
<p>While this example program is really only focused on the solution of the boundary integral equation, in a realistic setup one would still need to solve for the velocities. To this end, note that we have just computed \(\phi(\mathbf{x})\) for all \(\mathbf{x}\in\partial\Omega\). In the next step, we can compute (analytically, if we want) the solution \(\phi(\mathbf{x})\) in all of \(\mathbb{R}^n\backslash\Omega\). To this end, recall that we had </p><p class="formulaDsp">
\[ \phi(\mathbf{x}) = \phi_\infty + (D\phi)(\mathbf{x}) + \left(S[\mathbf{n}\cdot\mathbf{v}_\infty]\right)(\mathbf{x}) \qquad \forall\mathbf{x}\in \mathbb{R}^n\backslash\Omega. \]
</p>
<p> where now we have everything that is on the right hand side ( \(S\) and \(D\) are integrals we can evaluate, the normal velocity on the boundary is given, and \(\phi\) on the boundary we have just computed). Finally, we can then recover the velocity as \(\mathbf{\tilde v}=\nabla \phi\).</p>
<p>Notice that the evaluation of the above formula for \(\mathbf{x} \in \Omega\) should yield zero as a result, since the integration of the Dirac delta \(\delta(\mathbf{x})\) in the domain \(\mathbb{R}^n\backslash\Omega\) is always zero by definition.</p>
<p>As a final test, let us verify that this velocity indeed satisfies the momentum balance equation for a stationary flow field, i.e., whether \(\mathbf{v}\cdot\nabla\mathbf{v} = -\frac 1\rho \nabla p\) where \(\mathbf{v}=\mathbf{\tilde v}+\mathbf{v}_\infty=\nabla\phi+\mathbf{v}_\infty\) for some (unknown) pressure \(p\) and a given constant \(\rho\). In other words, we would like to verify that Bernoulli's law as stated above indeed holds. To show this, we use that the left hand side of this equation equates to </p><p class="formulaDsp">
\begin{align*} \mathbf{v}\cdot\nabla\mathbf{v} &amp;= [(\nabla\phi+\mathbf{v}_\infty)\cdot\nabla] (\nabla\phi+\mathbf{v}_\infty) \\ &amp;= [(\nabla\phi+\mathbf{v}_\infty)\cdot\nabla] (\nabla\phi) \end{align*}
</p>
<p> where we have used that \(\mathbf{v}_\infty\) is constant. We would like to write this expression as the gradient of something (remember that \(\rho\) is a constant). The next step is more convenient if we consider the components of the equation individually (summation over indices that appear twice is implied): </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= (\partial_j\phi+v_{\infty,j}) \partial_j \partial_i\phi \\ &amp;= \partial_j [(\partial_j\phi+v_{\infty,j}) \partial_i\phi] - \partial_j [(\partial_j\phi+v_{\infty,j})] \partial_i\phi \\ &amp;= \partial_j [(\partial_j\phi+v_{\infty,j}) \partial_i\phi] \end{align*}
</p>
<p> because \(\partial_j \partial_j\phi = \Delta \phi = 0\) and \(\textrm{div} \ \mathbf{v}_\infty=0\). Next, </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= \partial_j [(\partial_j\phi+v_{\infty,j}) \partial_i\phi] \\ &amp;= \partial_j [(\partial_j\phi) (\partial_i\phi)] + \partial_j [v_{\infty,j} \partial_i\phi] \\ &amp;= \partial_j [(\partial_j\phi) (\partial_i\phi)] + \partial_j [v_{\infty,j}] \partial_i\phi + v_{\infty,j} \partial_j \partial_i\phi \\ &amp;= \partial_j [(\partial_j\phi) (\partial_i\phi)] + v_{\infty,j} \partial_j \partial_i\phi \\ &amp;= \partial_i \partial_j [(\partial_j\phi) \phi] - \partial_j [\partial_i (\partial_j\phi) \phi] + \partial_i [v_{\infty,j} \partial_j \phi] - \partial_i [v_{\infty,j}] \partial_j \phi \end{align*}
</p>
<p> Again, the last term disappears because \(\mathbf{v}_\infty\) is constant and we can merge the first and third term into one: </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= \partial_i (\partial_j [(\partial_j\phi) \phi + v_{\infty,j} \partial_j \phi]) - \partial_j [\partial_i (\partial_j\phi) \phi] \\ &amp;= \partial_i [(\partial_j\phi)(\partial_j \phi) + v_{\infty,j} \partial_j \phi] - \partial_j [\partial_i (\partial_j\phi) \phi] \end{align*}
</p>
<p>We now only need to massage that last term a bit more. Using the product rule, we get </p><p class="formulaDsp">
\begin{align*} \partial_j [\partial_i (\partial_j\phi) \phi] &amp;= \partial_i [\partial_j \partial_j\phi] \phi + \partial_i [\partial_j \phi] (\partial_j \phi). \end{align*}
</p>
<p> The first of these terms is zero (because, again, the summation over \(j\) gives \(\Delta\phi\), which is zero). The last term can be written as \(\frac 12 \partial_i [(\partial_j\phi)(\partial_j\phi)]\) which is in the desired gradient form. As a consequence, we can now finally state that </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= \partial_i (\partial_j [(\partial_j\phi) \phi + v_{\infty,j} \partial_j \phi]) - \partial_j [\partial_i (\partial_j\phi) \phi] \\ &amp;= \partial_i \left[ (\partial_j\phi)(\partial_j \phi) + v_{\infty,j} \partial_j \phi - \frac 12 (\partial_j\phi)(\partial_j\phi) \right], \\ &amp;= \partial_i \left[ \frac 12 (\partial_j\phi)(\partial_j \phi) + v_{\infty,j} \partial_j \phi \right], \end{align*}
</p>
<p> or in vector form: </p><p class="formulaDsp">
\[ \mathbf{v}\cdot\nabla\mathbf{v} = \nabla \left[ \frac 12 \mathbf{\tilde v}^2 + \mathbf{v}_{\infty} \cdot \mathbf{\tilde v} \right], \]
</p>
<p> or in other words: </p><p class="formulaDsp">
\[ p = -\rho \left[ \frac 12 \mathbf{\tilde v}^2 + \mathbf{v}_{\infty} \cdot \mathbf{\tilde v} \right] = -\rho \left[ \frac 12 \mathbf{v}^2 - \frac 12 \mathbf{v}_{\infty}^2 \right] . \]
</p>
<p> Because the pressure is only determined up to a constant (it appears only with a gradient in the equations), an equally valid definition is </p><p class="formulaDsp">
\[ p = -\frac 12 \rho \mathbf{v}^2 . \]
</p>
<p> This is exactly Bernoulli's law mentioned above.</p>
<p><a class="anchor" id="Thenumericalapproximation"></a></p><h3>The numerical approximation</h3>
<p>Numerical approximations of Boundary Integral Equations (BIE) are commonly referred to as the boundary element method or panel method (the latter expression being used mostly in the computational fluid dynamics community). The goal of the following test problem is to solve the integral formulation of the Laplace equation with Neumann boundary conditions, using a circle and a sphere respectively in two and three space dimensions, illustrating along the way the features that allow one to treat boundary element problems almost as easily as finite element problems using the deal.II library.</p>
<p>To this end, let \(\mathcal{T}_h = \bigcup_i K_i\) be a subdivision of the manifold \(\Gamma = \partial \Omega\) into \(M\) line segments if \(n=2\), or \(M\) quadrilaterals if \(n=3\). We will call each individual segment or quadrilateral an <em>element</em> or <em>cell</em>, independently of the dimension \(n\) of the surrounding space \(\mathbb{R}^n\). We define the finite dimensional space \(V_h\) as </p><p class="formulaDsp">
\[ \label{eq:definition-Vh} V_h \dealcoloneq \{ v \in C^0(\Gamma) \text{ s.t. } v|_{K_i} \in \mathcal{Q}^1(K_i), \forall i\}, \]
</p>
<p> with basis functions \(\psi_i(\mathbf{x})\) for which we will use the usual <a class="el" href="classFE__Q.html">FE_Q</a> finite element, with the catch that this time it is defined on a manifold of codimension one (which we do by using the second template argument that is usually defaulted to equal the first; here, we will create objects <code><a class="el" href="classFE__Q.html">FE_Q</a>&lt;dim-1,dim&gt;</code> to indicate that we have <code>dim-1</code> dimensional cells in a <code>dim</code> dimensional space). An element \(\phi_h\) of \(V_h\) is uniquely identified by the vector \(\boldsymbol{\phi}\) of its coefficients \(\phi_i\), that is: </p><p class="formulaDsp">
\[ \label{eq:definition-of-element} \phi_h(\mathbf{x}) \dealcoloneq \phi_i \psi_i(\mathbf{x}), \qquad \boldsymbol{\phi} \dealcoloneq \{ \phi_i \}, \]
</p>
<p> where summation is implied over repeated indexes. Note that we could use discontinuous elements here &mdash; in fact, there is no real reason to use continuous ones since the integral formulation does not imply any derivatives on our trial functions so continuity is unnecessary, and often in the literature only piecewise constant elements are used.</p>
<p><a class="anchor" id="Collocationboundaryelementmethod"></a></p><h3>Collocation boundary element method </h3>
<p>By far, the most common approximation of boundary integral equations is by use of the collocation based boundary element method.</p>
<p>This method requires the evaluation of the boundary integral equation at a number of collocation points which is equal to the number of unknowns of the system. The choice of these points is a delicate matter, that requires a careful study. Assume that these points are known for the moment, and call them \(\mathbf x_i\) with \(i=0...n\_dofs\).</p>
<p>The problem then becomes: Given the datum \(\mathbf{v}_\infty\), find a function \(\phi_h\) in \(V_h\) such that the following \(n\_dofs\) equations are satisfied:</p>
<p class="formulaDsp">
\begin{align*} \alpha(\mathbf{x}_i) \phi_h(\mathbf{x}_i) - \int_{\Gamma_y} \frac{ \partial G(\mathbf{y}-\mathbf{x}_i)}{\partial\mathbf{n}_y } \phi_h(\mathbf{y}) \,ds_y = \int_{\Gamma_y} G(\mathbf{y}-\mathbf{x}_i) \, \mathbf{n}_y\cdot\mathbf{v_\infty} \,ds_y , \end{align*}
</p>
<p>where the quantity \(\alpha(\mathbf{x}_i)\) is the fraction of (solid) angle by which the point \(\mathbf{x}_i\) sees the domain \(\Omega\), as explained above, and we set \(\phi_\infty\) to be zero. If the support points \(\mathbf{x}_i\) are chosen appropriately, then the problem can be written as the following linear system:</p>
<p class="formulaDsp">
\[ \label{eq:linear-system} (\mathbf{A}+\mathbf{N})\boldsymbol\phi = \mathbf{b}, \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ \begin{aligned} \mathbf{A}_{ij}&amp;= \alpha(\mathbf{x}_i) \psi_j(\mathbf{x}_i) = 1+\int_\Gamma \frac{\partial G(\mathbf{y}-\mathbf{x}_i)}{\partial \mathbf{n}_y}\,ds_y \psi_j(\mathbf{x}_i) \\ \mathbf{N}_{ij}&amp;= - \int_\Gamma \frac{\partial G(\mathbf{y}-\mathbf{x}_i)}{\partial \mathbf{n}_y} \psi_j(\mathbf{y}) \,ds_y \\ \mathbf{b}_i&amp;= \int_\Gamma G(\mathbf{y}-\mathbf{x}_i) \, \mathbf{n}_y\cdot\mathbf{v_\infty} ds_y. \end{aligned} \]
</p>
<p>From a linear algebra point of view, the best possible choice of the collocation points is the one that renders the matrix \(\mathbf{A}+\mathbf{N}\) the most diagonally dominant. A natural choice is then to select the \(\mathbf{x}_i\) collocation points to be the support points of the nodal basis functions \(\psi_i(\mathbf{x})\). In that case, \(\psi_j(\mathbf{x}_i)=\delta_{ij}\), and as a consequence the matrix \(\mathbf{A}\) is diagonal with entries </p><p class="formulaDsp">
\[ \mathbf{A}_{ii} = 1+\int_\Gamma \frac{\partial G(\mathbf{y}-\mathbf{x}_i)}{\partial \mathbf{n}_y}\,ds_y = 1-\sum_j N_{ij}, \]
</p>
<p> where we have used that \(\sum_j \psi_j(\mathbf{y})=1\) for the usual Lagrange elements. With this choice of collocation points, the computation of the entries of the matrices \(\mathbf{A}\), \(\mathbf{N}\) and of the right hand side \(\mathbf{b}\) requires the evaluation of singular integrals on the elements \(K_i\) of the triangulation \(\mathcal{T}_h\). As usual in these cases, all integrations are performed on a reference simple domain, i.e., we assume that each element \(K_i\) of \(\mathcal{T}_h\) can be expressed as a linear (in two dimensions) or bi-linear (in three dimensions) transformation of the reference boundary element \(\hat K \dealcoloneq [0,1]^{n-1}\), and we perform the integrations after a change of variables from the real element \(K_i\) to the reference element \(\hat K\).</p>
<p><a class="anchor" id="Treatingthesingularintegrals"></a></p><h3>Treating the singular integrals. </h3>
<p>In two dimensions it is not necessary to compute the diagonal elements \(\mathbf{N}_{ii}\) of the system matrix, since, even if the denominator goes to zero when \(\mathbf{x}=\mathbf{y}\), the numerator is always zero because \(\mathbf{n}_y\) and \((\mathbf{y}-\mathbf{x})\) are orthogonal (on our polygonal approximation of the boundary of \(\Omega\)), and the only singular integral arises in the computation of \(\mathbf{b}_i\) on the i-th element of \(\mathcal{T}_h\): </p><p class="formulaDsp">
\[ \frac{1}{\pi} \int_{K_i} \ln|\mathbf{y}-\mathbf{x}_i| \, \mathbf{n}_y\cdot\mathbf{v_\infty} \,ds_y. \]
</p>
<p>This can be easily treated by the <a class="el" href="classQGaussLogR.html">QGaussLogR</a> quadrature formula.</p>
<p>Similarly, it is possible to use the <a class="el" href="classQGaussOneOverR.html">QGaussOneOverR</a> quadrature formula to perform the singular integrations in three dimensions. The interested reader will find detailed explanations on how these quadrature rules work in their documentation.</p>
<p>The resulting matrix \(\mathbf{A}+\mathbf{N}\) is full. Depending on its size, it might be convenient to use a direct solver or an iterative one. For the purpose of this example code, we chose to use only an iterative solver, without providing any preconditioner.</p>
<p>If this were a production code rather than a demonstration of principles, there are techniques that are available to not store full matrices but instead store only those entries that are large and/or relevant. In the literature on boundary element methods, a plethora of methods is available that allows to determine which elements are important and which are not, leading to a significantly sparser representation of these matrices that also facilitates rapid evaluations of the scalar product between vectors and matrices. This not being the goal of this program, we leave this for more sophisticated implementations.</p>
<p><a class="anchor" id="Implementation"></a></p><h3>Implementation</h3>
<p>The implementation is rather straight forward. The main point that hasn't been used in any of the previous tutorial programs is that most classes in deal.II are not only templated on the dimension, but in fact on the dimension of the manifold on which we pose the differential equation as well as the dimension of the space into which this manifold is embedded. By default, the second template argument equals the first, meaning for example that we want to solve on a two-dimensional region of two-dimensional space. The triangulation class to use in this case would be <code><a class="el" href="classTriangulation.html">Triangulation</a>&lt;2&gt;</code>, which is an equivalent way of writing <code><a class="el" href="classTriangulation.html">Triangulation</a>&lt;2,2&gt;</code>.</p>
<p>However, this doesn't have to be so: in the current example, we will for example want to solve on the surface of a sphere, which is a two-dimensional manifold embedded in a three-dimensional space. Consequently, the right class will be <code><a class="el" href="classTriangulation.html">Triangulation</a>&lt;2,3&gt;</code>, and correspondingly we will use <code><a class="el" href="classDoFHandler.html">DoFHandler</a>&lt;2,3&gt;</code> as the DoF handler class and <code><a class="el" href="classFE__Q.html">FE_Q</a>&lt;2,3&gt;</code> for finite elements.</p>
<p>Some further details on what one can do with things that live on curved manifolds can be found in the report <a href="http://www.dealii.org/reports/codimension-one/desimone-heltai-manigrasso.pdf" target="_top"><em>Tools for the Solution of PDEs Defined on Curved Manifolds with the deal.II Library</em> by A. DeSimone, L. Heltai, C. Manigrasso</a>. In addition, the <a class="el" href="step_38.html">step-38</a> tutorial program extends what we show here to cases where the equation posed on the manifold is not an integral operator but in fact involves derivatives.</p>
<p><a class="anchor" id="Testcase"></a></p><h3>Testcase</h3>
<p>The testcase we will be solving is for a circular (in 2d) or spherical (in 3d) obstacle. Meshes for these geometries will be read in from files in the current directory and an object of type <a class="el" href="classSphericalManifold.html">SphericalManifold</a> will then be attached to the triangulation to allow mesh refinement that respects the continuous geometry behind the discrete initial mesh.</p>
<p>For a sphere of radius \(a\) translating at a velocity of \(U\) in the \(x\) direction, the potential reads </p><p class="formulaDsp">
\begin{align*} \phi = -\frac{1}{2}U \left(\frac{a}{r}\right)3 r \cos\theta \end{align*}
</p>
<p> see, e.g. J. N. Newman, <em>Marine Hydrodynamics</em>, 1977, pp. 127. For unit speed and radius, and restricting \((x,y,z)\) to lie on the surface of the sphere, \(\phi = -x/2\). In the test problem, the flow is \((1,1,1)\), so the appropriate exact solution on the surface of the sphere is the superposition of the above solution with the analogous solution along the \(y\) and \(z\) axes, or \(\phi = \frac{1}{2}(x + y + z)\).</p>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Includefiles"></a> </p><h3>Include files</h3>
<p>The program starts with including a bunch of include files that we will use in the various parts of the program. Most of them have been discussed in previous tutorials already:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2smartpointer_8h.html">deal.II/base/smartpointer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2convergence__table_8h.html">deal.II/base/convergence_table.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__selector_8h.html">deal.II/base/quadrature_selector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2full__matrix_8h.html">deal.II/lac/full_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__control_8h.html">deal.II/lac/solver_control.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__gmres_8h.html">deal.II/lac/solver_gmres.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__in_8h.html">deal.II/grid/grid_in.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__out_8h.html">deal.II/grid/grid_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2manifold__lib_8h.html">deal.II/grid/manifold_lib.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__values_8h.html">deal.II/fe/fe_values.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q_8h.html">deal.II/fe/mapping_q.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>And here are a few C++ standard header files that we will need:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
</div><!-- fragment --><p>The last part of this preamble is to import everything in the dealii namespace into the one into which everything in this program will go:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep34.html">Step34</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p><a class="anchor" id="Singleanddoublelayeroperatorkernels"></a> </p><h3>Single and double layer operator kernels</h3>
<p>First, let us define a bit of the boundary integral equation machinery.</p>
<p>The following two functions are the actual calculations of the single and double layer potential kernels, that is \(G\) and \(\nabla G\). They are well defined only if the vector \(R = \mathbf{y}-\mathbf{x}\) is different from zero.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>LaplaceKernel</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">single_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          <span class="keywordflow">return</span> (-std::log(R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>()) / (2 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          <span class="keywordflow">return</span> (1. / (R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>() * 4 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">          <span class="keywordflow">return</span> 0.;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">double_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          <span class="keywordflow">return</span> R / (-2 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>());</div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          <span class="keywordflow">return</span> R / (-4 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>() * R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">          <span class="keywordflow">return</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a>();</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace LaplaceKernel</span></div>
</div><!-- fragment --><p><a class="anchor" id="TheBEMProblemclass"></a> </p><h3>The BEMProblem class</h3>
<p>The structure of a boundary element method code is very similar to the structure of a finite element code, and so the member functions of this class are like those of most of the other tutorial programs. In particular, by now you should be familiar with reading parameters from an external file, and with the splitting of the different tasks into different modules. The same applies to boundary element methods, and we won't comment too much on them, except on the differences.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>BEMProblem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  BEMProblem(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>      = 1,</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">void</span> read_parameters(<span class="keyword">const</span> std::string &amp;filename);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> read_domain();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> refine_and_resize();</div>
</div><!-- fragment --><p>The only really different function that we find here is the assembly routine. We wrote this function in the most possible general way, in order to allow for easy generalization to higher order methods and to different fundamental solutions (e.g., Stokes or Maxwell).</p>
<p>The most noticeable difference is the fact that the final matrix is full, and that we have a nested loop inside the usual loop on cells that visits all support points of the degrees of freedom. Moreover, when the support point lies inside the cell which we are visiting, then the integral we perform becomes singular.</p>
<p>The practical consequence is that we have two sets of quadrature formulas, finite element values and temporary storage, one for standard integration and one for the singular integration, which are used where necessary.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> assemble_system();</div>
</div><!-- fragment --><p>There are two options for the solution of this problem. The first is to use a direct solver, and the second is to use an iterative solver. We opt for the second option.</p>
<p>The matrix that we assemble is not symmetric, and we opt to use the GMRES method; however the construction of an efficient preconditioner for boundary element methods is not a trivial issue. Here we use a non preconditioned GMRES solver. The options for the iterative solver, such as the tolerance, the maximum number of iterations, are selected through the parameter file.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> solve_system();</div>
</div><!-- fragment --><p>Once we obtained the solution, we compute the \(L^2\) error of the computed potential as well as the \(L^\infty\) error of the approximation of the solid angle. The mesh we are using is an approximation of a smooth curve, therefore the computed diagonal matrix of fraction of angles or solid angles \(\alpha(\mathbf{x})\) should be constantly equal to \(\frac 12\). In this routine we output the error on the potential and the error in the approximation of the computed angle. Notice that the latter error is actually not the error in the computation of the angle, but a measure of how well we are approximating the sphere and the circle.</p>
<p>Experimenting a little with the computation of the angles gives very accurate results for simpler geometries. To verify this you can comment out, in the read_domain() method, the tria.set_manifold(1, manifold) line, and check the alpha that is generated by the program. By removing this call, whenever the mesh is refined new nodes will be placed along the straight lines that made up the coarse mesh, rather than be pulled onto the surface that we really want to approximate. In the three dimensional case, the coarse grid of the sphere is obtained starting from a cube, and the obtained values of alphas are exactly \(\frac 12\) on the nodes of the faces, \(\frac 34\) on the nodes of the edges and \(\frac 78\) on the 8 nodes of the vertices.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> compute_errors(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
</div><!-- fragment --><p>Once we obtained a solution on the codimension one domain, we want to interpolate it to the rest of the space. This is done by performing again the convolution of the solution with the kernel in the compute_exterior_solution() function.</p>
<p>We would like to plot the velocity variable which is the gradient of the potential solution. The potential solution is only known on the boundary, but we use the convolution with the fundamental solution to interpolate it on a standard dim dimensional continuous finite element space. The plot of the gradient of the extrapolated solution will give us the velocity we want.</p>
<p>In addition to the solution on the exterior domain, we also output the solution on the domain's boundary in the output_results() function, of course.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> compute_exterior_solution();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
</div><!-- fragment --><p>To allow for dimension independent programming, we specialize this single function to extract the singular quadrature formula needed to integrate the singular kernels in the interior of the cells.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt; &amp;get_singular_quadrature(</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim - 1, dim&gt;::active_cell_iterator</a> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>) <span class="keyword">const</span>;</div>
</div><!-- fragment --><p>The usual deal.II classes can be used for boundary element methods by specifying the "codimension" of the problem. This is done by setting the optional second template arguments to <a class="el" href="classTriangulation.html">Triangulation</a>, <a class="el" href="classFiniteElement.html">FiniteElement</a> and <a class="el" href="classDoFHandler.html">DoFHandler</a> to the dimension of the embedding space. In our case we generate either 1 or 2 dimensional meshes embedded in 2 or 3 dimensional spaces.</p>
<p>The optional argument by default is equal to the first argument, and produces the usual finite element classes that we saw in all previous examples.</p>
<p>The class is constructed in a way to allow for arbitrary order of approximation of both the domain (through high order mapping) and the finite element space. The order of the finite element space and of the mapping can be selected in the constructor of the class.</p>
<div class="fragment"><div class="line"><a class="code" href="classTriangulation.html">Triangulation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; tria;</div>
<div class="line"><a class="code" href="classFE__Q.html">FE_Q</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;          <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line"><a class="code" href="classDoFHandler.html">DoFHandler</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;    dof_handler;</div>
<div class="line"><a class="code" href="classMappingQ.html">MappingQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
</div><!-- fragment --><p>In BEM methods, the matrix that is generated is dense. Depending on the size of the problem, the final system might be solved by direct LU decomposition, or by iterative methods. In this example we use an unpreconditioned GMRES method. Building a preconditioner for BEM method is non trivial, and we don't treat this subject here.</p>
<div class="fragment"><div class="line"><a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> system_matrix;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a>     system_rhs;</div>
</div><!-- fragment --><p>The next two variables will denote the solution \(\phi\) as well as a vector that will hold the values of \(\alpha(\mathbf x)\) (the fraction of \(\Omega\) visible from a point \(\mathbf x\)) at the support points of our shape functions.</p>
<div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> phi;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>;</div>
</div><!-- fragment --><p>The convergence table is used to output errors in the exact solution and in the computed alphas.</p>
<div class="fragment"><div class="line"><a class="code" href="classConvergenceTable.html">ConvergenceTable</a> convergence_table;</div>
</div><!-- fragment --><p>The following variables are the ones that we fill through a parameter file. The new objects that we use in this example are the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> object and the <a class="el" href="classQuadratureSelector.html">QuadratureSelector</a> object.</p>
<p>The <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> class allows us to easily and quickly define new function objects via parameter files, with custom definitions which can be very complex (see the documentation of that class for all the available options).</p>
<p>We will allocate the quadrature object using the <a class="el" href="classQuadratureSelector.html">QuadratureSelector</a> class that allows us to generate quadrature formulas based on an identifying string and on the possible degree of the formula itself. We used this to allow custom selection of the quadrature formulas for the standard integration, and to define the order of the singular quadrature rule.</p>
<p>We also define a couple of parameters which are used in case we wanted to extend the solution to the entire domain.</p>
<div class="fragment"><div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> wind;</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         singular_quadrature_order;</div>
<div class="line">  std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;&gt; <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classSolverControl.html">SolverControl</a> solver_control;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cycles;</div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> external_refinement;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">bool</span> run_in_this_dimension;</div>
<div class="line">  <span class="keywordtype">bool</span> extend_solution;</div>
<div class="line">};</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemBEMProblemandBEMProblemread_parameters"></a> </p><h4>BEMProblem::BEMProblem and BEMProblem::read_parameters</h4>
<p>The constructor initializes the various object in much the same way as done in the finite element programs such as <a class="el" href="step_4.html">step-4</a> or <a class="el" href="step_6.html">step-6</a>. The only new ingredient here is the ParsedFunction object, which needs, at construction time, the specification of the number of components.</p>
<p>For the exact solution the number of vector components is one, and no action is required since one is the default value for a ParsedFunction object. The wind, however, requires dim components to be specified. Notice that when declaring entries in a parameter file for the expression of the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a>, we need to specify the number of components explicitly, since the function <a class="el" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction::declare_parameters</a> is static, and has no knowledge of the number of components.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">BEMProblem&lt;dim&gt;::BEMProblem(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>,</div>
<div class="line">                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree)</div>
<div class="line">  : <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">  , dof_handler(tria)</div>
<div class="line">  , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(mapping_degree, <a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">  , wind(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">  , singular_quadrature_order(5)</div>
<div class="line">  , n_cycles(4)</div>
<div class="line">  , external_refinement(5)</div>
<div class="line">  , run_in_this_dimension(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">  , extend_solution(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">{}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::read_parameters(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Parsing parameter file &quot;</span> &lt;&lt; filename &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;for a &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &lt;&lt; <span class="stringliteral">&quot; dimensional simulation. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classParameterHandler.html">ParameterHandler</a> prm;</div>
<div class="line"> </div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;External refinement&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Extend solution on the -2,2 box&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;true&quot;</span>,</div>
<div class="line">                    <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 2d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 3d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line"> </div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">  {</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(</div>
<div class="line">      <span class="stringliteral">&quot;Quadrature type&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;gauss&quot;</span>,</div>
<div class="line">      <a class="code" href="classPatterns_1_1Selection.html">Patterns::Selection</a>(</div>
<div class="line">        <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1)&gt;::get_quadrature_names()));</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">  }</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>For both two and three dimensions, we set the default input data to be such that the solution is \(x+y\) or \(x+y+z\). The actually computed solution will have value zero at infinity. In this case, this coincide with the exact solution, and no additional corrections are needed, but you should be aware of the fact that we arbitrarily set \(\phi_\infty\), and the exact solution we pass to the program needs to have the same value at infinity for the error to be computed correctly.</p>
<p>The use of the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> object is pretty straight forward. The <a class="el" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction::declare_parameters</a> function takes an additional integer argument that specifies the number of components of the given function. Its default value is one. When the corresponding <a class="el" href="classFunctions_1_1ParsedFunction.html#ad63dc7cf2f447d3acfec839f28416914">Functions::ParsedFunction::parse_parameters</a> method is called, the calling object has to have the same number of components defined here, otherwise an exception is thrown.</p>
<p>When declaring entries, we declare both 2 and three dimensional functions. However only the dim-dimensional one is ultimately parsed. This allows us to have only one parameter file for both 2 and 3 dimensional problems.</p>
<p>Notice that from a mathematical point of view, the wind function on the boundary should satisfy the condition \(\int_{\partial\Omega} \mathbf{v}\cdot \mathbf{n} d \Gamma = 0\), for the problem to have a solution. If this condition is not satisfied, then no solution can be found, and the solver will not converge.</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 2d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm, 2);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 3d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm, 3);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1; 1&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 2d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 3d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y+z&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>In the solver section, we set all <a class="el" href="classSolverControl.html">SolverControl</a> parameters. The object will then be fed to the GMRES solver in the solve_system() function.</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line"><a class="code" href="classSolverControl.html#a0bb6dc567e07e9f7b0a9d09f801bf149">SolverControl::declare_parameters</a>(prm);</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>After declaring all these parameters to the <a class="el" href="classParameterHandler.html">ParameterHandler</a> object, let's read an input file that will give the parameters their values. We then proceed to extract these values from the <a class="el" href="classParameterHandler.html">ParameterHandler</a> object:</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#a0ddaa05c5463c6c0b7701e18005717a9">parse_input</a>(filename);</div>
<div class="line"> </div>
<div class="line">n_cycles            = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>);</div>
<div class="line">external_refinement = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;External refinement&quot;</span>);</div>
<div class="line">extend_solution     = prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Extend solution on the -2,2 box&quot;</span>);</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> = std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;&gt;(</div>
<div class="line">    <span class="keyword">new</span> <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;(prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a>(<span class="stringliteral">&quot;Quadrature type&quot;</span>),</div>
<div class="line">                                    prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>)));</div>
<div class="line">  singular_quadrature_order = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  wind.parse_parameters(prm);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>.parse_parameters(prm);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line">solver_control.parse_parameters(prm);</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>Finally, here's another example of how to use parameter files in dimension independent programming. If we wanted to switch off one of the two simulations, we could do this by setting the corresponding "Run
 2d simulation" or "Run 3d simulation" flag to false:</p>
<div class="fragment"><div class="line">  run_in_this_dimension =</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Run &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d simulation&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemread_domain"></a> </p><h4>BEMProblem::read_domain</h4>
<p>A boundary element method triangulation is basically the same as a (dim-1) dimensional triangulation, with the difference that the vertices belong to a (dim) dimensional space.</p>
<p>Some of the mesh formats supported in deal.II use by default three dimensional points to describe meshes. These are the formats which are compatible with the boundary element method capabilities of deal.II. In particular we can use either UCD or GMSH formats. In both cases, we have to be particularly careful with the orientation of the mesh, because, unlike in the standard finite element case, no reordering or compatibility check is performed here. All meshes are considered as oriented, because they are embedded in a higher dimensional space. (See the documentation of the <a class="el" href="classGridIn.html">GridIn</a> and of the <a class="el" href="classTriangulation.html">Triangulation</a> for further details on orientation of cells in a triangulation.) In our case, the normals to the mesh are external to both the circle in 2d or the sphere in 3d.</p>
<p>The other detail that is required for appropriate refinement of the boundary element mesh is an accurate description of the manifold that the mesh approximates. We already saw this several times for the boundary of standard finite element meshes (for example in <a class="el" href="step_5.html">step-5</a> and <a class="el" href="step_6.html">step-6</a>), and here the principle and usage is the same, except that the <a class="el" href="classSphericalManifold.html">SphericalManifold</a> class takes an additional template parameter that specifies the embedding space dimension.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::read_domain()</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>                      <a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a> = <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>();</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classSphericalManifold.html">SphericalManifold</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>(<a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a>);</div>
<div class="line"> </div>
<div class="line">  std::ifstream <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>;</div>
<div class="line">  <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> 2:</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_circle.inp&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">case</span> 3:</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_sphere.inp&quot;</span>);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classGridIn.html">GridIn</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; gi;</div>
<div class="line">  gi.<a class="code" href="classGridIn.html#a82ac1c03b0efe87204ad45d2f1d87f7e">attach_triangulation</a>(tria);</div>
<div class="line">  gi.read_ucd(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>);</div>
<div class="line"> </div>
<div class="line">  tria.set_all_manifold_ids(1);</div>
</div><!-- fragment --><p>The call to <a class="el" href="group__manifold.html#ga9f9d720f5fbdcdf3dcbb445feefbdb9f">Triangulation::set_manifold</a> copies the manifold (via <a class="el" href="classManifold.html#a140e1b7c7334d16f99aa7ad0dbabb44a">Manifold::clone()</a>), so we do not need to worry about invalid pointers to <code>manifold</code>:</p>
<div class="fragment"><div class="line">  tria.set_manifold(1, <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemrefine_and_resize"></a> </p><h4>BEMProblem::refine_and_resize</h4>
<p>This function globally refines the mesh, distributes degrees of freedom, and resizes matrices and vectors.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::refine_and_resize()</div>
<div class="line">{</div>
<div class="line">  tria.refine_global(1);</div>
<div class="line"> </div>
<div class="line">  dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs = dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>();</div>
<div class="line"> </div>
<div class="line">  system_matrix.reinit(n_dofs, n_dofs);</div>
<div class="line"> </div>
<div class="line">  system_rhs.reinit(n_dofs);</div>
<div class="line">  phi.reinit(n_dofs);</div>
<div class="line">  <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.reinit(n_dofs);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemassemble_system"></a> </p><h4>BEMProblem::assemble_system</h4>
<p>The following is the main function of this program, assembling the matrix that corresponds to the boundary integral equation.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::assemble_system()</div>
<div class="line">{</div>
</div><!-- fragment --><p>First we initialize an <a class="el" href="classFEValues.html">FEValues</a> object with the quadrature formula for the integration of the kernel in non singular cells. This quadrature is selected with the parameter file, and needs to be quite precise, since the functions we are integrating are not polynomial functions.</p>
<div class="fragment"><div class="line"><a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                            <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                            *<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                            <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                              <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line"> </div>
<div class="line">std::vector&lt;types::global_dof_index&gt; <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>(</div>
<div class="line">  <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line">std::vector&lt;Vector&lt;double&gt;&gt; cell_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"><span class="keywordtype">double</span>                      normal_wind;</div>
</div><!-- fragment --><p>Unlike in finite element methods, if we use a collocation boundary element method, then in each assembly loop we only assemble the information that refers to the coupling between one degree of freedom (the degree associated with support point \(i\)) and the current cell. This is done using a vector of fe.dofs_per_cell elements, which will then be distributed to the matrix in the global row \(i\). The following object will hold this information:</p>
<div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> local_matrix_row_i(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
</div><!-- fragment --><p>The index \(i\) runs on the collocation points, which are the support points of the \(i\)th basis function, while \(j\) runs on inner integration points.</p>
<p>We construct a vector of support points which will be used in the local integrations:</p>
<div class="fragment"><div class="line">std::vector&lt;Point&lt;dim&gt;&gt; support_points(dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>());</div>
<div class="line"><a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                                   dof_handler,</div>
<div class="line">                                                   support_points);</div>
</div><!-- fragment --><p>After doing so, we can start the integration loop over all cells, where we first initialize the <a class="el" href="classFEValues.html">FEValues</a> object and get the values of \(\mathbf{\tilde v}\) at the quadrature points (this vector field should be constant, but it doesn't hurt to be more general):</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">  {</div>
<div class="line">    fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line">    wind.vector_value_list(q_points, cell_wind);</div>
</div><!-- fragment --><p>We then form the integral over the current cell for all degrees of freedom (note that this includes degrees of freedom not located on the current cell, a deviation from the usual finite element integrals). The integral that we need to perform is singular if one of the local degrees of freedom is the same as the support point \(i\). A the beginning of the loop we therefore check whether this is the case, and we store which one is the singular index:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  {</div>
<div class="line">    local_matrix_row_i = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span>         is_singular    = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> singular_index = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] == <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">        {</div>
<div class="line">          singular_index = <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>;</div>
<div class="line">          is_singular    = <span class="keyword">true</span>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
</div><!-- fragment --><p>We then perform the integral. If the index \(i\) is not one of the local degrees of freedom, we simply have to add the single layer terms to the right hand side, and the double layer terms to the matrix:</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (is_singular == <span class="keyword">false</span>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">      {</div>
<div class="line">        normal_wind = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          normal_wind += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q] - support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">        system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) *</div>
<div class="line">                          normal_wind * fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"> </div>
<div class="line">          local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) -=</div>
<div class="line">            ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) * <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q]) *</div>
<div class="line">             fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) * fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"><span class="keywordflow">else</span></div>
<div class="line">  {</div>
</div><!-- fragment --><p>Now we treat the more delicate case. If we are here, this means that the cell that runs on the \(j\) index contains support_point[i]. In this case both the single and the double layer potential are singular, and they require special treatment.</p>
<p>Whenever the integration is performed with the singularity inside the given cell, then a special quadrature formula is used that allows one to integrate arbitrary functions against a singular weight on the reference cell.</p>
<p>The correct quadrature formula is selected by the get_singular_quadrature function, which is explained in detail below.</p>
<div class="fragment"><div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(singular_index != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt; &amp;singular_quadrature =</div>
<div class="line">    get_singular_quadrature(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, singular_index);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v_singular(</div>
<div class="line">    <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">    <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">    singular_quadrature,</div>
<div class="line">    <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa9e3f2944ebdadf4409dc11f8fc0afe14">update_jacobians</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">      <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line">  fe_v_singular.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;Vector&lt;double&gt;&gt; singular_cell_wind(</div>
<div class="line">    singular_quadrature.size(), <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;singular_normals =</div>
<div class="line">    fe_v_singular.get_normal_vectors();</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;singular_q_points =</div>
<div class="line">    fe_v_singular.get_quadrature_points();</div>
<div class="line"> </div>
<div class="line">  wind.vector_value_list(singular_q_points, singular_cell_wind);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; singular_quadrature.size(); ++q)</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R =</div>
<div class="line">        singular_q_points[q] - support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line">      <span class="keywordtype">double</span> normal_wind = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        normal_wind +=</div>
<div class="line">          (singular_cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) * singular_normals[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">      system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) *</div>
<div class="line">                        normal_wind * fe_v_singular.JxW(q));</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">        {</div>
<div class="line">          local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) -=</div>
<div class="line">            ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) *</div>
<div class="line">              singular_normals[q]) *</div>
<div class="line">             fe_v_singular.shape_value(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) *</div>
<div class="line">             fe_v_singular.JxW(q));</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Finally, we need to add the contributions of the current cell to the global matrix.</p>
<div class="fragment"><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">        system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]) += local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The second part of the integral operator is the term \(\alpha(\mathbf{x}_i) \phi_j(\mathbf{x}_i)\). Since we use a collocation scheme, \(\phi_j(\mathbf{x}_i)=\delta_{ij}\) and the corresponding matrix is a diagonal one with entries equal to \(\alpha(\mathbf{x}_i)\).</p>
<p>One quick way to compute this diagonal matrix of the solid angles, is to use the Neumann matrix itself. It is enough to multiply the matrix with a vector of elements all equal to -1, to get the diagonal matrix of the alpha angles, or solid angles (see the formula in the introduction for this). The result is then added back onto the system matrix object to yield the final form of the matrix:</p>
<div class="fragment"><div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>(dof_handler.n_dofs());</div>
<div class="line">  <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>.add(-1.);</div>
<div class="line"> </div>
<div class="line">  system_matrix.vmult(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>, <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>);</div>
<div class="line">  <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.add(1);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemsolve_system"></a> </p><h4>BEMProblem::solve_system</h4>
<p>The next function simply solves the linear system.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::solve_system()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classSolverGMRES.html">SolverGMRES&lt;Vector&lt;double&gt;</a>&gt; <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>(solver_control);</div>
<div class="line">  <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>.solve(system_matrix, phi, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemcompute_errors"></a> </p><h4>BEMProblem::compute_errors</h4>
<p>The computation of the errors is exactly the same in all other example programs, and we won't comment too much. Notice how the same methods that are used in the finite element methods can be used here.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::compute_errors(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;float&gt;</a> difference_per_cell(tria.n_active_cells());</div>
<div class="line">  <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                    dof_handler,</div>
<div class="line">                                    phi,</div>
<div class="line">                                    <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>,</div>
<div class="line">                                    difference_per_cell,</div>
<div class="line">                                    <a class="code" href="classQGauss.html">QGauss</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1)&gt;(2 * <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a> + 1),</div>
<div class="line">                                    <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> L2_error =</div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a21eb62d70953182dcc2b15c4e14dd533">VectorTools::compute_global_error</a>(tria,</div>
<div class="line">                                      difference_per_cell,</div>
<div class="line">                                      <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
</div><!-- fragment --><p>The error in the alpha vector can be computed directly using the <a class="el" href="classVector.html#a9f6b7f7afb05aaff7e1ab8f9942b6dae">Vector::linfty_norm()</a> function, since on each node, the value should be \(\frac 12\). All errors are then output and appended to our <a class="el" href="classConvergenceTable.html">ConvergenceTable</a> object for later computation of convergence rates:</p>
<div class="fragment"><div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> difference_per_node(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>);</div>
<div class="line">  difference_per_node.add(-.5);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>       alpha_error    = difference_per_node.linfty_norm();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a> = tria.n_active_cells();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs         = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span> &lt;&lt; <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a></div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; n_dofs &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;cycle&quot;</span>, <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;cells&quot;</span>, <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a>);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;dofs&quot;</span>, n_dofs);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;L2(phi)&quot;</span>, L2_error);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, alpha_error);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Singular integration requires a careful selection of the quadrature rules. In particular the deal.II library provides quadrature rules which are tailored for logarithmic singularities (<a class="el" href="classQGaussLog.html">QGaussLog</a>, <a class="el" href="classQGaussLogR.html">QGaussLogR</a>), as well as for 1/R singularities (<a class="el" href="classQGaussOneOverR.html">QGaussOneOverR</a>).</p>
<p>Singular integration is typically obtained by constructing weighted quadrature formulas with singular weights, so that it is possible to write</p>
<p class="formulaDsp">
\[ \int_K f(x) s(x) dx = \sum_{i=1}^N w_i f(q_i) \]
</p>
<p>where \(s(x)\) is a given singularity, and the weights and quadrature points \(w_i,q_i\) are carefully selected to make the formula above an equality for a certain class of functions \(f(x)\).</p>
<p>In all the finite element examples we have seen so far, the weight of the quadrature itself (namely, the function \(s(x)\)), was always constantly equal to 1. For singular integration, we have two choices: we can use the definition above, factoring out the singularity from the integrand (i.e., integrating \(f(x)\) with the special quadrature rule), or we can ask the quadrature rule to "normalize" the weights \(w_i\) with \(s(q_i)\):</p>
<p class="formulaDsp">
\[ \int_K f(x) s(x) dx = \int_K g(x) dx = \sum_{i=1}^N \frac{w_i}{s(q_i)} g(q_i) \]
</p>
<p>We use this second option, through the <code>factor_out_singularity</code> parameter of both <a class="el" href="classQGaussLogR.html">QGaussLogR</a> and <a class="el" href="classQGaussOneOverR.html">QGaussOneOverR</a>.</p>
<p>These integrals are somewhat delicate, especially in two dimensions, due to the transformation from the real to the reference cell, where the variable of integration is scaled with the determinant of the transformation.</p>
<p>In two dimensions this process does not result only in a factor appearing as a constant factor on the entire integral, but also on an additional integral altogether that needs to be evaluated:</p>
<p class="formulaDsp">
\[ \int_0^1 f(x)\ln(x/\alpha) dx = \int_0^1 f(x)\ln(x) dx - \int_0^1 f(x) \ln(\alpha) dx. \]
</p>
<p>This process is taken care of by the constructor of the <a class="el" href="classQGaussLogR.html">QGaussLogR</a> class, which adds additional quadrature points and weights to take into consideration also the second part of the integral.</p>
<p>A similar reasoning should be done in the three dimensional case, since the singular quadrature is tailored on the inverse of the radius \(r\) in the reference cell, while our singular function lives in real space, however in the three dimensional case everything is simpler because the singularity scales linearly with the determinant of the transformation. This allows us to build the singular two dimensional quadrature rules only once and, reuse them over all cells.</p>
<p>In the one dimensional singular integration this is not possible, since we need to know the scaling parameter for the quadrature, which is not known a priori. Here, the quadrature rule itself depends also on the size of the current cell. For this reason, it is necessary to create a new quadrature for each singular integration.</p>
<p>The different quadrature rules are built inside the get_singular_quadrature, which is specialized for dim=2 and dim=3, and they are retrieved inside the assemble_system function. The index given as an argument is the index of the unit support point where the singularity is located.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;2&gt;</a> &amp;BEMProblem&lt;3&gt;::get_singular_quadrature(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;2, 3&gt;::active_cell_iterator</a> &amp;,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> std::vector&lt;QGaussOneOverR&lt;2&gt;&gt; quadratures;</div>
<div class="line">  <span class="keywordflow">if</span> (quadratures.size() == 0)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      quadratures.emplace_back(singular_quadrature_order,</div>
<div class="line">                               <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line">                               <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">return</span> quadratures[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> &amp;BEMProblem&lt;2&gt;::get_singular_quadrature(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;1, 2&gt;::active_cell_iterator</a> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                            <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> *q_pointer = <span class="keyword">nullptr</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (q_pointer)</div>
<div class="line">    <span class="keyword">delete</span> q_pointer;</div>
<div class="line"> </div>
<div class="line">  q_pointer = <span class="keyword">new</span> <a class="code" href="classQGaussLogR.html">QGaussLogR&lt;1&gt;</a>(singular_quadrature_order,</div>
<div class="line">                                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>],</div>
<div class="line">                                1. / <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;measure(),</div>
<div class="line">                                <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">return</span> (*q_pointer);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemcompute_exterior_solution"></a> </p><h4>BEMProblem::compute_exterior_solution</h4>
<p>We'd like to also know something about the value of the potential \(\phi\) in the exterior domain: after all our motivation to consider the boundary integral problem was that we wanted to know the velocity in the exterior domain!</p>
<p>To this end, let us assume here that the boundary element domain is contained in the box \([-2,2]^{\text{dim}}\), and we extrapolate the actual solution inside this box using the convolution with the fundamental solution. The formula for this is given in the introduction.</p>
<p>The reconstruction of the solution in the entire space is done on a continuous finite element grid of dimension dim. These are the usual ones, and we don't comment any further on them. At the end of the function, we output this exterior solution in, again, much the usual way.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::compute_exterior_solution()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> external_tria;</div>
<div class="line">  <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(external_tria, -2, 2);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>       external_fe(1);</div>
<div class="line">  <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> external_dh(external_tria);</div>
<div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a>  external_phi;</div>
<div class="line"> </div>
<div class="line">  external_tria.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a>(external_refinement);</div>
<div class="line">  external_dh.distribute_dofs(external_fe);</div>
<div class="line">  external_phi.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(external_dh.n_dofs());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                              <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                              *<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                              <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;types::global_dof_index&gt; <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;double&gt;         local_phi(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">  std::vector&lt;double&gt;         normal_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">  std::vector&lt;Vector&lt;double&gt;&gt; local_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;Point&lt;dim&gt;&gt; external_support_points(external_dh.n_dofs());</div>
<div class="line">  DoFTools::map_dofs_to_support_points&lt;dim&gt;(<a class="code" href="structStaticMappingQ1.html">StaticMappingQ1&lt;dim&gt;::mapping</a>,</div>
<div class="line">                                            external_dh,</div>
<div class="line">                                            external_support_points);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">    {</div>
<div class="line">      fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">      <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>);</div>
<div class="line">      fe_v.<a class="code" href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">get_function_values</a>(phi, local_phi);</div>
<div class="line"> </div>
<div class="line">      wind.vector_value_list(q_points, local_wind);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">        {</div>
<div class="line">          normal_wind[q] = 0;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            normal_wind[q] += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * local_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; external_dh.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q] - external_support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">            external_phi(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) +=</div>
<div class="line">              ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) * normal_wind[q] +</div>
<div class="line">                (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) * <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q]) *</div>
<div class="line">                  local_phi[q]) *</div>
<div class="line">               fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">          }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line"> </div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(external_dh);</div>
<div class="line">  data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(external_phi, <span class="stringliteral">&quot;external_phi&quot;</span>);</div>
<div class="line">  data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_external.vtk&quot;</span>;</div>
<div class="line">  std::ofstream     <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line"> </div>
<div class="line">  data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a>(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemoutput_results"></a> </p><h4>BEMProblem::output_results</h4>
<p>Outputting the results of our computations is a rather mechanical tasks. All the components of this function have been discussed before.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; dataout;</div>
<div class="line"> </div>
<div class="line">  dataout.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">  dataout.add_data_vector(phi, <span class="stringliteral">&quot;phi&quot;</span>, <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::type_dof_data</a>);</div>
<div class="line">  dataout.add_data_vector(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>,</div>
<div class="line">                          <span class="stringliteral">&quot;alpha&quot;</span>,</div>
<div class="line">                          <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::type_dof_data</a>);</div>
<div class="line">  dataout.build_patches(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                        <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>.get_degree(),</div>
<div class="line">                        <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_boundary_solution_&quot;</span> +</div>
<div class="line">                               <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line">  std::ofstream <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line"> </div>
<div class="line">  dataout.write_vtk(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> == n_cycles - 1)</div>
<div class="line">    {</div>
<div class="line">      convergence_table.set_precision(<span class="stringliteral">&quot;L2(phi)&quot;</span>, 3);</div>
<div class="line">      convergence_table.set_precision(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, 3);</div>
<div class="line"> </div>
<div class="line">      convergence_table.set_scientific(<span class="stringliteral">&quot;L2(phi)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">      convergence_table.set_scientific(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">      convergence_table.evaluate_convergence_rates(</div>
<div class="line">        <span class="stringliteral">&quot;L2(phi)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">      convergence_table.evaluate_convergence_rates(</div>
<div class="line">        <span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl;</div>
<div class="line">      convergence_table.write_text(std::cout);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemrun"></a> </p><h4>BEMProblem::run</h4>
<p>This is the main function. It should be self explanatory in its briefness:</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">BEMProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    read_parameters(<span class="stringliteral">&quot;parameters.prm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (run_in_this_dimension == <span class="keyword">false</span>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Run in dimension &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; explicitly disabled in parameter file. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    read_domain();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> = 0; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt; n_cycles; ++<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">      {</div>
<div class="line">        refine_and_resize();</div>
<div class="line">        assemble_system();</div>
<div class="line">        solve_system();</div>
<div class="line">        compute_errors(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">        output_results(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (extend_solution == <span class="keyword">true</span>)</div>
<div class="line">      compute_exterior_solution();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step34</span></div>
</div><!-- fragment --><p><a class="anchor" id="Themainfunction"></a> </p><h3>The <a class="el" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a> function</h3>
<p>This is the main function of this program. It is exactly like all previous tutorial programs:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep34.html">Step34</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(3);</div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;2&gt;</a> laplace_problem_2d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_2d.run();</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;3&gt;</a> laplace_problem_3d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_3d.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>We ran the program using the following <code>parameters.prm</code> file (which can also be found in the directory in which all the other source files are): </p><pre class="fragment"># Listing of Parameters
# ---------------------
set Extend solution on the -2,2 box = true
set External refinement             = 5
set Number of cycles                = 4
set Run 2d simulation               = true
set Run 3d simulation               = true


subsection Exact solution 2d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =

  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = x+y   # default: 0

  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,t
end


subsection Exact solution 3d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =

  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = .5*(x+y+z)   # default: 0

  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,z,t
end


subsection Quadrature rules
  set Quadrature order          = 4
  set Quadrature type           = gauss
  set Singular quadrature order = 5
end


subsection Solver
  set Log frequency = 1
  set Log history   = false
  set Log result    = true
  set Max steps     = 100
  set Tolerance     = 1.e-10
end


subsection Wind function 2d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =

  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = 1; 1  # default: 0; 0

  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,t
end


subsection Wind function 3d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =

  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = 1; 1; 1 # default: 0; 0; 0

  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,z,t
end
</pre><p>When we run the program, the following is printed on screen: </p><pre class="fragment">DEAL::
DEAL::Parsing parameter file parameters.prm
DEAL::for a 2 dimensional simulation.
DEAL:GMRES::Starting value 2.21576
DEAL:GMRES::Convergence step 1 value 2.37635e-13
DEAL::Cycle 0:
DEAL::   Number of active cells:       20
DEAL::   Number of degrees of freedom: 20
DEAL:GMRES::Starting value 3.15543
DEAL:GMRES::Convergence step 1 value 2.89310e-13
DEAL::Cycle 1:
DEAL::   Number of active cells:       40
DEAL::   Number of degrees of freedom: 40
DEAL:GMRES::Starting value 4.46977
DEAL:GMRES::Convergence step 1 value 3.11815e-13
DEAL::Cycle 2:
DEAL::   Number of active cells:       80
DEAL::   Number of degrees of freedom: 80
DEAL:GMRES::Starting value 6.32373
DEAL:GMRES::Convergence step 1 value 3.22474e-13
DEAL::Cycle 3:
DEAL::   Number of active cells:       160
DEAL::   Number of degrees of freedom: 160
DEAL::
cycle cells dofs    L2(phi)     Linfty(alpha)
    0    20   20 4.465e-02    - 5.000e-02    -
    1    40   40 1.081e-02 2.05 2.500e-02 1.00
    2    80   80 2.644e-03 2.03 1.250e-02 1.00
    3   160  160 6.529e-04 2.02 6.250e-03 1.00
DEAL::
DEAL::Parsing parameter file parameters.prm
DEAL::for a 3 dimensional simulation.
DEAL:GMRES::Starting value 2.84666
DEAL:GMRES::Convergence step 3 value 8.68638e-18
DEAL::Cycle 0:
DEAL::   Number of active cells:       24
DEAL::   Number of degrees of freedom: 26
DEAL:GMRES::Starting value 6.34288
DEAL:GMRES::Convergence step 5 value 1.38740e-11
DEAL::Cycle 1:
DEAL::   Number of active cells:       96
DEAL::   Number of degrees of freedom: 98
DEAL:GMRES::Starting value 12.9780
DEAL:GMRES::Convergence step 5 value 3.29225e-11
DEAL::Cycle 2:
DEAL::   Number of active cells:       384
DEAL::   Number of degrees of freedom: 386
DEAL:GMRES::Starting value 26.0874
DEAL:GMRES::Convergence step 6 value 1.47271e-12
DEAL::Cycle 3:
DEAL::   Number of active cells:       1536
DEAL::   Number of degrees of freedom: 1538
DEAL::
cycle cells dofs    L2(phi)     Linfty(alpha)
    0    24   26 3.437e-01    - 2.327e-01    -
    1    96   98 9.794e-02 1.81 1.239e-01 0.91
    2   384  386 2.417e-02 2.02 6.319e-02 0.97
    3  1536 1538 5.876e-03 2.04 3.176e-02 0.99
</pre><p>As we can see from the convergence table in 2d, if we choose quadrature formulas which are accurate enough, then the error we obtain for \(\alpha(\mathbf{x})\) should be exactly the inverse of the number of elements. The approximation of the circle with N segments of equal size generates a regular polygon with N faces, whose angles are exactly \(\pi-\frac {2\pi}{N}\), therefore the error we commit should be exactly \(\frac 12 - (\frac 12 -\frac 1N) = \frac 1N\). In fact this is a very good indicator that we are performing the singular integrals in an appropriate manner.</p>
<p>The error in the approximation of the potential \(\phi\) is largely due to approximation of the domain. A much better approximation could be obtained by using higher order mappings.</p>
<p>If we modify the <a class="el" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a> function, setting fe_degree and mapping_degree to two, and raise the order of the quadrature formulas in the parameter file, we obtain the following convergence table for the two dimensional simulation</p>
<pre class="fragment">cycle cells dofs    L2(phi)     Linfty(alpha)
    0    20   40 5.414e-05    - 2.306e-04    -
    1    40   80 3.623e-06 3.90 1.737e-05 3.73
    2    80  160 2.690e-07 3.75 1.253e-05 0.47
    3   160  320 2.916e-08 3.21 7.670e-06 0.71
</pre><p>and</p>
<pre class="fragment">cycle cells dofs    L2(phi)     Linfty(alpha)
    0    24   98 3.770e-03    - 8.956e-03    -
    1    96  386 1.804e-04 4.39 1.182e-03 2.92
    2   384 1538 9.557e-06 4.24 1.499e-04 2.98
    3  1536 6146 6.617e-07 3.85 1.892e-05 2.99
</pre><p>for the three dimensional case. As we can see, convergence results are much better with higher order mapping, mainly due to a better resolution of the curved geometry. Notice that, given the same number of degrees of freedom, for example in step 3 of the Q1 case and step 2 of Q2 case in the three dimensional simulation, the error is roughly three orders of magnitude lower.</p>
<p>The result of running these computations is a bunch of output files that we can pass to our visualization program of choice. The output files are of two kind: the potential on the boundary element surface, and the potential extended to the outer and inner domain. The combination of the two for the two dimensional case looks like</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-34_2d.png" alt="" class="inline"/></p>
<p>while in three dimensions we show first the potential on the surface, together with a contour plot,</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-34_3d.png" alt="" class="inline"/></p>
<p>and then the external contour plot of the potential, with opacity set to 25%:</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-34_3d-2.png" alt="" class="inline"/></p>
<p><a class="anchor" id="extensions"></a> <a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>This is the first tutorial program that considers solving equations defined on surfaces embedded in higher dimensional spaces. But the equation discussed here was relatively simple because it only involved an integral operator, not derivatives which are more difficult to define on the surface. The <a class="el" href="step_38.html">step-38</a> tutorial program considers such problems and provides the necessary tools.</p>
<p>From a practical perspective, the Boundary Element Method (BEM) used here suffers from two bottlenecks. The first is that assembling the matrix has a cost that is <em>quadratic</em> in the number of unknowns, that is \({\cal O}(N^2)\) where \(N\) is the total number of unknowns. This can be seen by looking at the <code>assemble_system()</code> function, which has this structure: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">  {</div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      ...</div>
</div><!-- fragment --><p> Here, the first loop walks over all cells (one factor of \(N\)) whereas the inner loop contributes another factor of \(N\).</p>
<p>This has to be contrasted with the finite element method for <em>local</em> differential operators: There, we loop over all cells (one factor of \(N\)) and on each cell do an amount of work that is independent of how many cells or unknowns there are. This clearly presents a bottleneck.</p>
<p>The second bottleneck is that the system matrix is dense (i.e., is of type <a class="el" href="classFullMatrix.html">FullMatrix</a>) because every degree of freedom couples with every other degree of freedom. As pointed out above, just <em>computing</em> this matrix with its \(N^2\) nonzero entries necessarily requires at least \({\cal O}(N^2)\) operations, but it's worth pointing out that it also costs this many operations to just do one matrix-vector product. If the GMRES method used to solve the linear system requires a number of iterations that grows with the size of the problem, as is typically the case, then solving the linear system will require a number of operations that grows even faster than just \({\cal O}(N^2)\).</p>
<p>"Real" boundary element methods address these issues by strategies that determine which entries of the matrix will be small and can consequently be neglected (at the cost of introducing an additional error, of course). This is possible by recognizing that the matrix entries decay with the (physical) distance between the locations where degrees of freedom \(i\) and \(j\) are defined. This can be exploited in methods such as the Fast Multipole Method (FMM) that control which matrix entries must be stored and computed to achieve a certain accuracy, and &ndash; if done right &ndash; result in methods in which both assembly and solution of the linear system requires less than \({\cal O}(N^2)\) operations.</p>
<p>Implementing these methods clearly presents opportunities to extend the current program.</p>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2009 - 2021 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Luca Heltai, Cataldo Manigrasso, 2009</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2smartpointer_8h.html">deal.II/base/smartpointer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2convergence__table_8h.html">deal.II/base/convergence_table.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__selector_8h.html">deal.II/base/quadrature_selector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2full__matrix_8h.html">deal.II/lac/full_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__control_8h.html">deal.II/lac/solver_control.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__gmres_8h.html">deal.II/lac/solver_gmres.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__in_8h.html">deal.II/grid/grid_in.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__out_8h.html">deal.II/grid/grid_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2manifold__lib_8h.html">deal.II/grid/manifold_lib.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__values_8h.html">deal.II/fe/fe_values.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q_8h.html">deal.II/fe/mapping_q.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep34.html">Step34</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">namespace </span>LaplaceKernel</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">single_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> 2:</div>
<div class="line">            <span class="keywordflow">return</span> (-std::log(R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>()) / (2 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> 3:</div>
<div class="line">            <span class="keywordflow">return</span> (1. / (R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>() * 4 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">            <span class="keywordflow">return</span> 0.;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">double_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> 2:</div>
<div class="line">            <span class="keywordflow">return</span> R / (-2 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>());</div>
<div class="line">          <span class="keywordflow">case</span> 3:</div>
<div class="line">            <span class="keywordflow">return</span> R / (-4 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>() * R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>());</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a>();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  } <span class="comment">// namespace LaplaceKernel</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span><a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem</a></div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>      = 1,</div>
<div class="line">               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> read_parameters(<span class="keyword">const</span> std::string &amp;filename);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> read_domain();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> refine_and_resize();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> assemble_system();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> solve_system();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> compute_errors(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> compute_exterior_solution();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt; &amp;get_singular_quadrature(</div>
<div class="line">      <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim - 1, dim&gt;::active_cell_iterator &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; tria;</div>
<div class="line">    <a class="code" href="classFE__Q.html">FE_Q</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;          <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="group__dofs.html#ga768cd565b5c25f1ac235586e36ac94d6">DoFHandler</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;    dof_handler;</div>
<div class="line">    <a class="code" href="classMappingQ.html">MappingQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> system_matrix;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     system_rhs;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> phi;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConvergenceTable.html">ConvergenceTable</a> convergence_table;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> wind;</div>
<div class="line">    <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         singular_quadrature_order;</div>
<div class="line">    std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;&gt; <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSolverControl.html">SolverControl</a> solver_control;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cycles;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> external_refinement;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> run_in_this_dimension;</div>
<div class="line">    <span class="keywordtype">bool</span> extend_solution;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classStep34_1_1BEMProblem.html#a9e7bc122afd983144f27ea9c28eb6d68">BEMProblem&lt;dim&gt;::BEMProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>,</div>
<div class="line">                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree)</div>
<div class="line">    : <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(tria)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(mapping_degree, <a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">    , wind(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">    , singular_quadrature_order(5)</div>
<div class="line">    , n_cycles(4)</div>
<div class="line">    , external_refinement(5)</div>
<div class="line">    , run_in_this_dimension(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">    , extend_solution(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::read_parameters</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Parsing parameter file &quot;</span> &lt;&lt; filename &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;for a &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &lt;&lt; <span class="stringliteral">&quot; dimensional simulation. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterHandler.html">ParameterHandler</a> prm;</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;External refinement&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Extend solution on the -2,2 box&quot;</span>,</div>
<div class="line">                      <span class="stringliteral">&quot;true&quot;</span>,</div>
<div class="line">                      <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 2d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 3d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(</div>
<div class="line">        <span class="stringliteral">&quot;Quadrature type&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;gauss&quot;</span>,</div>
<div class="line">        <a class="code" href="classPatterns_1_1Selection.html">Patterns::Selection</a>(</div>
<div class="line">          <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1)&gt;::get_quadrature_names()));</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 2d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm, 2);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 3d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm, 3);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1; 1&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 2d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 3d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y+z&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line">    <a class="code" href="classSolverControl.html#a0bb6dc567e07e9f7b0a9d09f801bf149">SolverControl::declare_parameters</a>(prm);</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a0ddaa05c5463c6c0b7701e18005717a9">parse_input</a>(filename);</div>
<div class="line"> </div>
<div class="line">    n_cycles            = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>);</div>
<div class="line">    external_refinement = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;External refinement&quot;</span>);</div>
<div class="line">    extend_solution     = prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Extend solution on the -2,2 box&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> = std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;(prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a>(<span class="stringliteral">&quot;Quadrature type&quot;</span>),</div>
<div class="line">                                        prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>)));</div>
<div class="line">      singular_quadrature_order = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      wind.parse_parameters(prm);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>.parse_parameters(prm);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line">    solver_control.parse_parameters(prm);</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    run_in_this_dimension =</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Run &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d simulation&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::read_domain</a>()</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>                      <a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a> = <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>();</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classSphericalManifold.html">SphericalManifold</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>(<a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a>);</div>
<div class="line"> </div>
<div class="line">    std::ifstream <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>;</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_circle.inp&quot;</span>);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_sphere.inp&quot;</span>);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classGridIn.html">GridIn</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; gi;</div>
<div class="line">    gi.<a class="code" href="classGridIn.html#a82ac1c03b0efe87204ad45d2f1d87f7e">attach_triangulation</a>(tria);</div>
<div class="line">    gi.read_ucd(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>);</div>
<div class="line"> </div>
<div class="line">    tria.set_all_manifold_ids(1);</div>
<div class="line">    tria.set_manifold(1, <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::refine_and_resize</a>()</div>
<div class="line">  {</div>
<div class="line">    tria.refine_global(1);</div>
<div class="line"> </div>
<div class="line">    dof_handler.distribute_dofs(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">    system_matrix.reinit(n_dofs, n_dofs);</div>
<div class="line"> </div>
<div class="line">    system_rhs.reinit(n_dofs);</div>
<div class="line">    phi.reinit(n_dofs);</div>
<div class="line">    <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.reinit(n_dofs);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::assemble_system</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                                *<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                                <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;types::global_dof_index&gt; <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>(</div>
<div class="line">      <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Vector&lt;double&gt;&gt; cell_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line">    <span class="keywordtype">double</span>                      normal_wind;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> local_matrix_row_i(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Point&lt;dim&gt;&gt; support_points(dof_handler.n_dofs());</div>
<div class="line">    <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                                       dof_handler,</div>
<div class="line">                                                       support_points);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">      {</div>
<div class="line">        fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line">        wind.vector_value_list(q_points, cell_wind);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">          {</div>
<div class="line">            local_matrix_row_i = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">bool</span>         is_singular    = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> singular_index = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">              <span class="keywordflow">if</span> (<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] == <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                {</div>
<div class="line">                  singular_index = <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>;</div>
<div class="line">                  is_singular    = <span class="keyword">true</span>;</div>
<div class="line">                  <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (is_singular == <span class="keyword">false</span>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">                  {</div>
<div class="line">                    normal_wind = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      normal_wind += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q] - support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">                    system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) *</div>
<div class="line">                                      normal_wind * fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"> </div>
<div class="line">                      local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) -=</div>
<div class="line">                        ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) * <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q]) *</div>
<div class="line">                         fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) * fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">                  }</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(singular_index != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line">                       <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt; &amp;singular_quadrature =</div>
<div class="line">                  get_singular_quadrature(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, singular_index);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v_singular(</div>
<div class="line">                  <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                  <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                  singular_quadrature,</div>
<div class="line">                  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa9e3f2944ebdadf4409dc11f8fc0afe14">update_jacobians</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                    <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line">                fe_v_singular.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">                std::vector&lt;Vector&lt;double&gt;&gt; singular_cell_wind(</div>
<div class="line">                  singular_quadrature.size(), <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;singular_normals =</div>
<div class="line">                  fe_v_singular.get_normal_vectors();</div>
<div class="line">                <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;singular_q_points =</div>
<div class="line">                  fe_v_singular.get_quadrature_points();</div>
<div class="line"> </div>
<div class="line">                wind.vector_value_list(singular_q_points, singular_cell_wind);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; singular_quadrature.size(); ++q)</div>
<div class="line">                  {</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R =</div>
<div class="line">                      singular_q_points[q] - support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line">                    <span class="keywordtype">double</span> normal_wind = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      normal_wind +=</div>
<div class="line">                        (singular_cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) * singular_normals[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">                    system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) *</div>
<div class="line">                                      normal_wind * fe_v_singular.JxW(q));</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">                      {</div>
<div class="line">                        local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) -=</div>
<div class="line">                          ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) *</div>
<div class="line">                            singular_normals[q]) *</div>
<div class="line">                           fe_v_singular.shape_value(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) *</div>
<div class="line">                           fe_v_singular.JxW(q));</div>
<div class="line">                      }</div>
<div class="line">                  }</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">              system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]) += local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>(dof_handler.n_dofs());</div>
<div class="line">    <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>.add(-1.);</div>
<div class="line"> </div>
<div class="line">    system_matrix.vmult(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>, <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>);</div>
<div class="line">    <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.add(1);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::solve_system</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classSolverGMRES.html">SolverGMRES&lt;Vector&lt;double&gt;</a>&gt; <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>(solver_control);</div>
<div class="line">    <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>.solve(system_matrix, phi, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::compute_errors</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;float&gt;</a> difference_per_cell(tria.n_active_cells());</div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                      dof_handler,</div>
<div class="line">                                      phi,</div>
<div class="line">                                      <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>,</div>
<div class="line">                                      difference_per_cell,</div>
<div class="line">                                      <a class="code" href="classQGauss.html">QGauss</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1)&gt;(2 * <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a> + 1),</div>
<div class="line">                                      <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> L2_error =</div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#a21eb62d70953182dcc2b15c4e14dd533">VectorTools::compute_global_error</a>(tria,</div>
<div class="line">                                        difference_per_cell,</div>
<div class="line">                                        <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> difference_per_node(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>);</div>
<div class="line">    difference_per_node.add(-.5);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>       alpha_error    = difference_per_node.linfty_norm();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a> = tria.n_active_cells();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs         = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span> &lt;&lt; <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a></div>
<div class="line">            &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; n_dofs &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;cycle&quot;</span>, <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;cells&quot;</span>, <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a>);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;dofs&quot;</span>, n_dofs);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;L2(phi)&quot;</span>, L2_error);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, alpha_error);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;&gt;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;2&gt;</a> &amp;<a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;3&gt;::get_singular_quadrature</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;2, 3&gt;::active_cell_iterator</a> &amp;,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> std::vector&lt;QGaussOneOverR&lt;2&gt;&gt; quadratures;</div>
<div class="line">    <span class="keywordflow">if</span> (quadratures.size() == 0)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">        quadratures.emplace_back(singular_quadrature_order,</div>
<div class="line">                                 <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line">                                 <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">return</span> quadratures[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;&gt;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> &amp;<a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;2&gt;::get_singular_quadrature</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;1, 2&gt;::active_cell_iterator</a> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                            <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> *q_pointer = <span class="keyword">nullptr</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (q_pointer)</div>
<div class="line">      <span class="keyword">delete</span> q_pointer;</div>
<div class="line"> </div>
<div class="line">    q_pointer = <span class="keyword">new</span> <a class="code" href="classQGaussLogR.html">QGaussLogR&lt;1&gt;</a>(singular_quadrature_order,</div>
<div class="line">                                  <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>],</div>
<div class="line">                                  1. / <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;measure(),</div>
<div class="line">                                  <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">return</span> (*q_pointer);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::compute_exterior_solution</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> external_tria;</div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(external_tria, -2, 2);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>       external_fe(1);</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> external_dh(external_tria);</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>  external_phi;</div>
<div class="line"> </div>
<div class="line">    external_tria.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a>(external_refinement);</div>
<div class="line">    external_dh.distribute_dofs(external_fe);</div>
<div class="line">    external_phi.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(external_dh.n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                                *<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                                <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;types::global_dof_index&gt; <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;double&gt;         local_phi(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">    std::vector&lt;double&gt;         normal_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">    std::vector&lt;Vector&lt;double&gt;&gt; local_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Point&lt;dim&gt;&gt; external_support_points(external_dh.n_dofs());</div>
<div class="line">    DoFTools::map_dofs_to_support_points&lt;dim&gt;(<a class="code" href="structStaticMappingQ1.html">StaticMappingQ1&lt;dim&gt;::mapping</a>,</div>
<div class="line">                                              external_dh,</div>
<div class="line">                                              external_support_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">      {</div>
<div class="line">        fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>);</div>
<div class="line">        fe_v.<a class="code" href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">get_function_values</a>(phi, local_phi);</div>
<div class="line"> </div>
<div class="line">        wind.vector_value_list(q_points, local_wind);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">          {</div>
<div class="line">            normal_wind[q] = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              normal_wind[q] += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * local_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; external_dh.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q] - external_support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">              external_phi(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) +=</div>
<div class="line">                ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) * normal_wind[q] +</div>
<div class="line">                  (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) * <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q]) *</div>
<div class="line">                    local_phi[q]) *</div>
<div class="line">                 fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">            }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(external_dh);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(external_phi, <span class="stringliteral">&quot;external_phi&quot;</span>);</div>
<div class="line">    data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_external.vtk&quot;</span>;</div>
<div class="line">    std::ofstream     <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a>(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::output_results</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; dataout;</div>
<div class="line"> </div>
<div class="line">    dataout.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">    dataout.add_data_vector(phi, <span class="stringliteral">&quot;phi&quot;</span>, <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::type_dof_data</a>);</div>
<div class="line">    dataout.add_data_vector(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>,</div>
<div class="line">                            <span class="stringliteral">&quot;alpha&quot;</span>,</div>
<div class="line">                            <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::type_dof_data</a>);</div>
<div class="line">    dataout.build_patches(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                          <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>.get_degree(),</div>
<div class="line">                          <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_boundary_solution_&quot;</span> +</div>
<div class="line">                                 <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line">    std::ofstream <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line"> </div>
<div class="line">    dataout.write_vtk(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> == n_cycles - 1)</div>
<div class="line">      {</div>
<div class="line">        convergence_table.set_precision(<span class="stringliteral">&quot;L2(phi)&quot;</span>, 3);</div>
<div class="line">        convergence_table.set_precision(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, 3);</div>
<div class="line"> </div>
<div class="line">        convergence_table.set_scientific(<span class="stringliteral">&quot;L2(phi)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">        convergence_table.set_scientific(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        convergence_table.evaluate_convergence_rates(</div>
<div class="line">          <span class="stringliteral">&quot;L2(phi)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">        convergence_table.evaluate_convergence_rates(</div>
<div class="line">          <span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">        <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl;</div>
<div class="line">        convergence_table.write_text(std::cout);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">BEMProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    read_parameters(<span class="stringliteral">&quot;parameters.prm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (run_in_this_dimension == <span class="keyword">false</span>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Run in dimension &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; explicitly disabled in parameter file. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    read_domain();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> = 0; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt; n_cycles; ++<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">      {</div>
<div class="line">        refine_and_resize();</div>
<div class="line">        assemble_system();</div>
<div class="line">        solve_system();</div>
<div class="line">        compute_errors(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">        output_results(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (extend_solution == <span class="keyword">true</span>)</div>
<div class="line">      compute_exterior_solution();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step34</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep34.html">Step34</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(3);</div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;2&gt;</a> laplace_problem_2d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_2d.run();</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;3&gt;</a> laplace_problem_3d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_3d.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><br  />
 This tutorial depends on <a class="el" href="step_4.html">step-4</a> .  
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a><a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#Irrotationalflow"> Irrotational flow </a><a href="#Irrotationalflow"> Irrotational flow </a>
        <li><a href="#Thenumericalapproximation">The numerical approximation</a><a href="#Thenumericalapproximation">The numerical approximation</a>
        <li><a href="#Collocationboundaryelementmethod"> Collocation boundary element method </a><a href="#Collocationboundaryelementmethod"> Collocation boundary element method </a>
        <li><a href="#Treatingthesingularintegrals"> Treating the singular integrals. </a><a href="#Treatingthesingularintegrals"> Treating the singular integrals. </a>
        <li><a href="#Implementation">Implementation</a><a href="#Implementation">Implementation</a>
        <li><a href="#Testcase">Testcase</a><a href="#Testcase">Testcase</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a><a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Includefiles">Include files</a><a href="#Includefiles">Include files</a>
        <li><a href="#Singleanddoublelayeroperatorkernels">Single and double layer operator kernels</a><a href="#Singleanddoublelayeroperatorkernels">Single and double layer operator kernels</a>
        <li><a href="#TheBEMProblemclass">The BEMProblem class</a><a href="#TheBEMProblemclass">The BEMProblem class</a>
      <ul>
        <li><a href="#BEMProblemBEMProblemandBEMProblemread_parameters">BEMProblem::BEMProblem and BEMProblem::read_parameters</a><a href="#BEMProblemBEMProblemandBEMProblemread_parameters">BEMProblem::BEMProblem and BEMProblem::read_parameters</a>
        <li><a href="#BEMProblemread_domain">BEMProblem::read_domain</a><a href="#BEMProblemread_domain">BEMProblem::read_domain</a>
        <li><a href="#BEMProblemrefine_and_resize">BEMProblem::refine_and_resize</a><a href="#BEMProblemrefine_and_resize">BEMProblem::refine_and_resize</a>
        <li><a href="#BEMProblemassemble_system">BEMProblem::assemble_system</a><a href="#BEMProblemassemble_system">BEMProblem::assemble_system</a>
        <li><a href="#BEMProblemsolve_system">BEMProblem::solve_system</a><a href="#BEMProblemsolve_system">BEMProblem::solve_system</a>
        <li><a href="#BEMProblemcompute_errors">BEMProblem::compute_errors</a><a href="#BEMProblemcompute_errors">BEMProblem::compute_errors</a>
        <li><a href="#BEMProblemcompute_exterior_solution">BEMProblem::compute_exterior_solution</a><a href="#BEMProblemcompute_exterior_solution">BEMProblem::compute_exterior_solution</a>
        <li><a href="#BEMProblemoutput_results">BEMProblem::output_results</a><a href="#BEMProblemoutput_results">BEMProblem::output_results</a>
        <li><a href="#BEMProblemrun">BEMProblem::run</a><a href="#BEMProblemrun">BEMProblem::run</a>
      </ul>
        <li><a href="#Themainfunction">The main() function</a><a href="#Themainfunction">The main() function</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a><a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a><a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 <br  />
 <br  />
 <em>This program was contributed by Luca Heltai (thanks to Michael Gratton for pointing out what the exact solution should have been in the three dimensional case). </em> </p><dl class="section note"><dt>Note</dt><dd>If you use this program as a basis for your own work, please consider citing it in your list of references. The initial version of this work was contributed to the deal.II project by the authors listed in the following citation: <a href="https://doi.org/10.5281/zenodo.495473"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.495473.svg" alt="10.5281/zenodo.495473"/></a>  <br  />
 <a class="anchor" id="Intro"></a> <a class="anchor" id="Introduction"></a><h1>Introduction</h1>
</dd></dl>
<p><a class="anchor" id="Irrotationalflow"></a></p><h3>Irrotational flow </h3>
<p>The incompressible motion of an inviscid fluid past a body (forexample air past an airplane wing, or air or water past a propeller) isusually modeled by the Euler equations of fluid dynamics: </p><p class="formulaDsp">
\begin{align*} \frac{\partial }{\partial t}\mathbf{v} + (\mathbf{v}\cdot\nabla)\mathbf{v} &amp;= -\frac{1}{\rho}\nabla p + \mathbf{g} \qquad &amp;\text{in } \mathbb{R}^n \backslash \Omega \\ \nabla \cdot \mathbf{v}&amp;=0 &amp;\text{in } \mathbb{R}^n\backslash\Omega \end{align*}
</p>
<p>@_fakenlwhere the fluid density \(\rho\) and the acceleration \(\mathbf{g}\) dueto external forces are given and the velocity \(\mathbf{v}\) and thepressure \(p\) are the unknowns. Here \(\Omega\) is a closed boundedregion representing the body around which the fluid moves. The above equations can be derived from Navier-Stokes equationsassuming that the effects due to viscosity are negligible compared tothose due to the pressure gradient, inertial forces and the externalforces. This is the opposite case of the Stokes equations discussed in <a class="el" href="step_22.html">step-22</a> which are the limit case of dominant viscosity,i.e. where the velocity is so small that inertia forces can beneglected. On the other hand, owing to the assumed incompressibility,the equations are not suited for very high speed gas flows wherecompressibility and the equation of state of the gas have to be takeninto account, leading to the Euler equations of gas dynamics, ahyperbolic system. For the purpose of this tutorial program, we will consider only stationaryflow without external forces: </p><p class="formulaDsp">
\begin{align*} (\mathbf{v}\cdot\nabla)\mathbf{v} &amp;= -\frac{1}{\rho}\nabla p \qquad &amp;\text{in } \mathbb{R}^n \backslash \Omega \\ \nabla \cdot \mathbf{v}&amp;=0 &amp;\text{in } \mathbb{R}^n\backslash\Omega \end{align*}
</p>
<p>Uniqueness of the solution of the Euler equations is ensured by adding theboundary conditions </p><p class="formulaDsp">
\[ \label{eq:boundary-conditions} \begin{aligned} \mathbf{n}\cdot\mathbf{v}&amp; = 0 \qquad &amp;&amp; \text{ on } \partial\Omega \\ \mathbf{v}&amp; = \mathbf{v}_\infty &amp;&amp; \text{ when } |\mathbf{x}| \to \infty, \end{aligned} \]
</p>
<p> which is to say that the body is at rest in our coordinate systems andis not permeable, and that the fluid has (constant) velocity \(\mathbf{v}_\infty\) at infinity. An alternative viewpoint is that ourcoordinate system moves along with the body whereas the backgroundfluid is at rest at infinity. Notice that we define the normal \(\mathbf{n}\) as the <em>outer</em> normal to the domain \(\Omega\) , whichis the opposite of the outer normal to the integration domain. For both stationary and non stationary flow, the solution processstarts by solving for the velocity in the second equation andsubstituting in the first equation in order to find the pressure.The solution of the stationary Euler equations is typically performedin order to understand the behavior of the given (possibly complex)geometry when a prescribed motion is enforced on the system. The first step in this process is to change the frame of reference from acoordinate system moving along with the body to one in which the body movesthrough a fluid that is at rest at infinity. This can be expressed byintroducing a new velocity \(\mathbf{\tilde{v}}=\mathbf{v}-\mathbf{v}_\infty\) forwhich we find that the same equations hold (because \(\nabla\cdot \mathbf{v}_\infty=0\) ) and we have boundary conditions </p><p class="formulaDsp">
\[ \label{eq:boundary-conditions-tilde} \begin{aligned} \mathbf{n}\cdot\mathbf{\tilde{v}}&amp; = -\mathbf{n}\cdot\mathbf{v}_\infty \qquad &amp;&amp; \text{ on } \partial\Omega \\ \mathbf{\tilde{v}}&amp; = 0 &amp;&amp; \text{ when } |\mathbf{x}| \to \infty, \end{aligned} \]
</p>
<p> If we assume that the fluid is irrotational, i.e., \(\nabla \times \mathbf{v}=0\) in \(\mathbb{R}^n\backslash\Omega\) , we can represent thevelocity, and consequently also the perturbation velocity, as thegradient of a scalar function: </p><p class="formulaDsp">
\[ \mathbf{\tilde{v}}=\nabla\phi, \]
</p>
<p>@_fakenland so the second part of Euler equations above can be rewrittenas the homogeneous Laplace equation for the unknown \(\phi\) : </p><p class="formulaDsp">
\begin{align*} \label{laplace} \Delta\phi &amp;= 0 \qquad &amp;&amp;\text{in}\ \mathbb{R}^n\backslash\Omega, \\ \mathbf{n}\cdot\nabla\phi &amp;= -\mathbf{n}\cdot\mathbf{v}_\infty &amp;&amp; \text{on}\ \partial\Omega \end{align*}
</p>
<p>@_fakenlwhile the momentum equation reduces to Bernoulli's equation that expresses thepressure \(p\) as a function of the potential \(\phi\) : </p><p class="formulaDsp">
\[ \frac{p}{\rho} +\frac{1}{2} | \nabla \phi |^2 = 0 \in \Omega. \]
</p>
<p> So we can solve the problem by solving the Laplace equation for thepotential. We recall that the following functions, called fundamentalsolutions of the Laplace equation, </p><p class="formulaDsp">
\[ \begin{aligned} \label{eq:3} G(\mathbf{y}-\mathbf{x}) = &amp; -\frac{1}{2\pi}\ln|\mathbf{y}-\mathbf{x}| \qquad &amp;&amp; \text{for } n=2 \\ G(\mathbf{y}-\mathbf{x}) = &amp; \frac{1}{4\pi}\frac{1}{|\mathbf{y}-\mathbf{x}|}&amp;&amp; \text{for } n=3, \end{aligned} \]
</p>
<p> satisfy in a distributional sense the equation: </p><p class="formulaDsp">
\[ -\Delta_y G(\mathbf{y}-\mathbf{x}) = \delta(\mathbf{y}-\mathbf{x}), \]
</p>
<p> where the derivative is done in the variable \(\mathbf{y}\) . By usingthe usual Green identities, our problem can be written on the boundary \(\partial\Omega = \Gamma\) only. We recall the general definition ofthe second Green identity: </p><p class="formulaDsp">
\[\label{green} \int_{\omega} (-\Delta u)v\,dx + \int_{\partial\omega} \frac{\partial u}{\partial \tilde{\mathbf{n}} }v \,ds = \int_{\omega} (-\Delta v)u\,dx + \int_{\partial\omega} u\frac{\partial v}{\partial \tilde{\mathbf{n}}} \,ds, \]
</p>
<p> where \(\tilde{\mathbf{n}}\) is the normal to the surface of \(\omega\) pointingoutwards from the domain of integration \(\omega\) . In our case the domain of integration is the domain \(\mathbb{R}^n\backslash\Omega\) , whose boundary is \( \Gamma_\infty \cup \Gamma\) , where the "boundary" at infinity is defined as </p><p class="formulaDsp">
\[ \Gamma_\infty \dealcoloneq \lim_{r\to\infty} \partial B_r(0). \]
</p>
<p> In our program the normals are defined as <em>outer</em> to the domain \(\Omega\) , that is, they are in fact <em>inner</em> to the integrationdomain, and some care is required in defining the various integralswith the correct signs for the normals, i.e. replacing \(\tilde{\mathbf{n}}\) by \(-\mathbf{n}\) . If we substitute \(u\) and \(v\) in the Green identity with the solution \(\phi\) and with the fundamental solution of the Laplace equationrespectively, as long as \(\mathbf{x}\) is chosen in the region \(\mathbb{R}^n\backslash\Omega\) , we obtain: </p><p class="formulaDsp">
\[ \phi(\mathbf{x}) - \int_{\Gamma\cup\Gamma_\infty}\frac{\partial G(\mathbf{y}-\mathbf{x})}{\partial \mathbf{n}_y}\phi(\mathbf{y})\,ds_y = -\int_{\Gamma\cup\Gamma_\infty}G(\mathbf{y}-\mathbf{x})\frac{\partial \phi}{\partial \mathbf{n}_y}(\mathbf{y})\,ds_y \qquad \forall\mathbf{x}\in \mathbb{R}^n\backslash\Omega \]
</p>
<p> where the normals are now pointing <em>inward</em> the domain ofintegration. Notice that in the above equation, we also have the integrals on theportion of the boundary at \(\Gamma_\infty\) . Using the boundaryconditions of our problem, we have that \(\nabla \phi\) is zero atinfinity (which simplifies the integral on \(\Gamma_\infty\) on theright hand side). The integral on \(\Gamma_\infty\) that appears on the left hand side canbe treated by observing that \(\nabla\phi=0\) implies that \(\phi\) atinfinity is necessarily constant. We define its value to be \(\phi_\infty\) . It is an easy exercise to prove that </p><p class="formulaDsp">
\[ -\int_{\Gamma_\infty} \frac{\partial G(\mathbf{y}-\mathbf{x})} {\partial \mathbf{n}_y}\phi_\infty \,ds_y = \lim_{r\to\infty} \int_{\partial B_r(0)} \frac{\mathbf{r}}{r} \cdot \nabla G(\mathbf{y}-\mathbf{x}) \phi_\infty \,ds_y = -\phi_\infty. \]
</p>
<p> Using this result, we can reduce the above equation only on theboundary \(\Gamma\) using the so-called Single and Double LayerPotential operators: </p><p class="formulaDsp">
\[\label{integral} \phi(\mathbf{x}) - (D\phi)(\mathbf{x}) = \phi_\infty -\left(S \frac{\partial \phi}{\partial n_y}\right)(\mathbf{x}) \qquad \forall\mathbf{x}\in \mathbb{R}^n\backslash\Omega. \]
</p>
<p> (The name of these operators comes from the fact that they describe theelectric potential in \(\mathbb{R}^n\) due to a single thin sheet of chargesalong a surface, and due to a double sheet of charges and anti-charges alongthe surface, respectively.) In our case, we know the Neumann values of \(\phi\) on the boundary: \(\mathbf{n}\cdot\nabla\phi = -\mathbf{n}\cdot\mathbf{v}_\infty\) .Consequently, </p><p class="formulaDsp">
\[ \phi(\mathbf{x}) - (D\phi)(\mathbf{x}) = \phi_\infty + \left(S[\mathbf{n}\cdot\mathbf{v}_\infty]\right)(\mathbf{x}) \qquad \forall\mathbf{x} \in \mathbb{R}^n\backslash\Omega. \]
</p>
<p>@_fakenlIf we take the limit for \(\mathbf{x}\) tending to \(\Gamma\) ofthe above equation, using well known properties of the single and double layeroperators, we obtain an equation for \(\phi\) just on the boundary \(\Gamma\) of \(\Omega\) : </p><p class="formulaDsp">
\[\label{SD} \alpha(\mathbf{x})\phi(\mathbf{x}) - (D\phi)(\mathbf{x}) = \phi_\infty + \left(S [\mathbf{n}\cdot\mathbf{v}_\infty]\right)(\mathbf{x}) \quad \mathbf{x}\in \partial\Omega, \]
</p>
<p> which is the Boundary Integral Equation (BIE) we were looking for,where the quantity \(\alpha(\mathbf{x})\) is the fraction of angle orsolid angle by which the point \(\mathbf{x}\) sees the domain ofintegration \(\mathbb{R}^n\backslash\Omega\) . In particular, at points \(\mathbf{x}\) where the boundary \(\partial\Omega\) is differentiable (i.e. smooth) we have \(\alpha(\mathbf{x})=\frac 12\) , but the value may be smaller or largerat points where the boundary has a corner or an edge. Substituting the single and double layer operators we get: </p><p class="formulaDsp">
\[ \alpha(\mathbf{x}) \phi(\mathbf{x}) + \frac{1}{2\pi}\int_{\partial \Omega} \frac{ (\mathbf{y}-\mathbf{x})\cdot\mathbf{n}_y }{ |\mathbf{y}-\mathbf{x}|^2 } \phi(\mathbf{y}) \,ds_y = \phi_\infty -\frac{1}{2\pi}\int_{\partial \Omega} \ln|\mathbf{y}-\mathbf{x}| \, \mathbf{n}\cdot\mathbf{v_\infty}\,ds_y \]
</p>
<p>@_fakenlfor two dimensional flows and </p><p class="formulaDsp">
\[ \alpha(\mathbf{x}) \phi(\mathbf{x}) + \frac{1}{4\pi}\int_{\partial \Omega} \frac{ (\mathbf{y}-\mathbf{x})\cdot\mathbf{n}_y }{ |\mathbf{y}-\mathbf{x}|^3 }\phi(\mathbf{y})\,ds_y = \phi_\infty + \frac{1}{4\pi}\int_{\partial \Omega} \frac{1}{|\mathbf{y}-\mathbf{x}|} \, \mathbf{n}\cdot\mathbf{v_\infty}\,ds_y \]
</p>
<p>@_fakenlfor three dimensional flows, where the normal derivatives of the fundamentalsolutions have been written in a form that makes computation easier. In eithercase, \(\phi\) is the solution of an integral equation posed entirely on theboundary since both \(\mathbf{x},\mathbf{y}\in\partial\Omega\) . Notice that the fraction of angle (in 2d) or solid angle (in 3d) \(\alpha(\mathbf{x})\) by which the point \(\mathbf{x}\) sees the domain \(\Omega\) can be defined using the double layer potential itself: </p><p class="formulaDsp">
\[ \alpha(\mathbf{x}) \dealcoloneq 1 - \frac{1}{2(n-1)\pi}\int_{\partial \Omega} \frac{ (\mathbf{y}-\mathbf{x})\cdot\mathbf{n}_y } { |\mathbf{y}-\mathbf{x}|^{n} }\phi(\mathbf{y})\,ds_y = 1+ \int_{\partial \Omega} \frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y. \]
</p>
<p> The reason why this is possible can be understood if we consider thefact that the solution of a pure Neumann problem is known up to anarbitrary constant \(c\) , which means that, if we set the Neumann datato be zero, then any constant \(\phi = \phi_\infty\) will be a solution.Inserting the constant solution and the Neumann boundary condition in theboundary integral equation, we have </p><p class="formulaDsp">
\begin{align*} \alpha\left(\mathbf{x}\right)\phi\left(\mathbf{x}\right) &amp;=\int_{\Omega}\phi\left(\mathbf{y}\right)\delta\left(\mathbf{y}-\mathbf{x}\right)\, dy\\ \Rightarrow \alpha\left(\mathbf{x}\right)\phi_\infty &amp;=\phi_\infty\int_{\Gamma\cup\Gamma_\infty}\frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y =\phi_\infty\left[\int_{\Gamma_\infty}\frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y +\int_{\Gamma}\frac{ \partial G(\mathbf{y}-\mathbf{x}) }{\partial \mathbf{n}_y} \, ds_y \right] \end{align*}
</p>
<p> The integral on \(\Gamma_\infty\) is unity, see above, so division by the constant \(\phi_\infty\) gives us the explicitexpression above for \(\alpha(\mathbf{x})\) . While this example program is really only focused on the solution of theboundary integral equation, in a realistic setup one would still need to solvefor the velocities. To this end, note that we have just computed \(\phi(\mathbf{x})\) for all \(\mathbf{x}\in\partial\Omega\) . In the next step, wecan compute (analytically, if we want) the solution \(\phi(\mathbf{x})\) in allof \(\mathbb{R}^n\backslash\Omega\) . To this end, recall that we had </p><p class="formulaDsp">
\[ \phi(\mathbf{x}) = \phi_\infty + (D\phi)(\mathbf{x}) + \left(S[\mathbf{n}\cdot\mathbf{v}_\infty]\right)(\mathbf{x}) \qquad \forall\mathbf{x}\in \mathbb{R}^n\backslash\Omega. \]
</p>
<p>@_fakenlwhere now we have everything that is on the right hand side ( \(S\) and \(D\) areintegrals we can evaluate, the normal velocity on the boundary is given, and \(\phi\) on the boundary we have just computed). Finally, we can then recoverthe velocity as \(\mathbf{\tilde v}=\nabla \phi\) . Notice that the evaluation of the above formula for \(\mathbf{x} \in \Omega\) should yield zero as a result, since the integration of theDirac delta \(\delta(\mathbf{x})\) in the domain \(\mathbb{R}^n\backslash\Omega\) is always zero by definition. As a final test, let us verify that this velocity indeed satisfies themomentum balance equation for a stationary flow field, i.e., whether \(\mathbf{v}\cdot\nabla\mathbf{v} = -\frac 1\rho \nabla p\) where \(\mathbf{v}=\mathbf{\tilde v}+\mathbf{v}_\infty=\nabla\phi+\mathbf{v}_\infty\) for some (unknown) pressure \(p\) and a given constant \(\rho\) . In other words, we would like to verify thatBernoulli's law as stated above indeed holds. To show this, we use thatthe left hand side of this equation equates to </p><p class="formulaDsp">
\begin{align*} \mathbf{v}\cdot\nabla\mathbf{v} &amp;= [(\nabla\phi+\mathbf{v}_\infty)\cdot\nabla] (\nabla\phi+\mathbf{v}_\infty) \\ &amp;= [(\nabla\phi+\mathbf{v}_\infty)\cdot\nabla] (\nabla\phi) \end{align*}
</p>
<p> where we have used that \(\mathbf{v}_\infty\) is constant. We would like towrite this expression as the gradient of something (remember that \(\rho\) is aconstant). The next step is moreconvenient if we consider the components of the equation individually(summation over indices that appear twice is implied): </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= (\partial_j\phi+v_{\infty,j}) \partial_j \partial_i\phi \\ &amp;= \partial_j [(\partial_j\phi+v_{\infty,j}) \partial_i\phi] - \partial_j [(\partial_j\phi+v_{\infty,j})] \partial_i\phi \\ &amp;= \partial_j [(\partial_j\phi+v_{\infty,j}) \partial_i\phi] \end{align*}
</p>
<p> because \(\partial_j \partial_j\phi = \Delta \phi = 0\) and \(\textrm{div} \ \mathbf{v}_\infty=0\) . Next, </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= \partial_j [(\partial_j\phi+v_{\infty,j}) \partial_i\phi] \\ &amp;= \partial_j [(\partial_j\phi) (\partial_i\phi)] + \partial_j [v_{\infty,j} \partial_i\phi] \\ &amp;= \partial_j [(\partial_j\phi) (\partial_i\phi)] + \partial_j [v_{\infty,j}] \partial_i\phi + v_{\infty,j} \partial_j \partial_i\phi \\ &amp;= \partial_j [(\partial_j\phi) (\partial_i\phi)] + v_{\infty,j} \partial_j \partial_i\phi \\ &amp;= \partial_i \partial_j [(\partial_j\phi) \phi] - \partial_j [\partial_i (\partial_j\phi) \phi] + \partial_i [v_{\infty,j} \partial_j \phi] - \partial_i [v_{\infty,j}] \partial_j \phi \end{align*}
</p>
<p> Again, the last term disappears because \(\mathbf{v}_\infty\) is constant and wecan merge the first and third term into one: </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= \partial_i (\partial_j [(\partial_j\phi) \phi + v_{\infty,j} \partial_j \phi]) - \partial_j [\partial_i (\partial_j\phi) \phi] \\ &amp;= \partial_i [(\partial_j\phi)(\partial_j \phi) + v_{\infty,j} \partial_j \phi] - \partial_j [\partial_i (\partial_j\phi) \phi] \end{align*}
</p>
<p>We now only need to massage that last term a bit more. Using the product rule,we get </p><p class="formulaDsp">
\begin{align*} \partial_j [\partial_i (\partial_j\phi) \phi] &amp;= \partial_i [\partial_j \partial_j\phi] \phi + \partial_i [\partial_j \phi] (\partial_j \phi). \end{align*}
</p>
<p> The first of these terms is zero (because, again, the summation over \(j\) gives \(\Delta\phi\) , which is zero). The last term can be written as \(\frac 12 \partial_i [(\partial_j\phi)(\partial_j\phi)]\) which is in the desired gradientform. As a consequence, we can now finally state that </p><p class="formulaDsp">
\begin{align*} [\mathbf{v}\cdot\nabla\mathbf{v}]_i &amp;= \partial_i (\partial_j [(\partial_j\phi) \phi + v_{\infty,j} \partial_j \phi]) - \partial_j [\partial_i (\partial_j\phi) \phi] \\ &amp;= \partial_i \left[ (\partial_j\phi)(\partial_j \phi) + v_{\infty,j} \partial_j \phi - \frac 12 (\partial_j\phi)(\partial_j\phi) \right], \\ &amp;= \partial_i \left[ \frac 12 (\partial_j\phi)(\partial_j \phi) + v_{\infty,j} \partial_j \phi \right], \end{align*}
</p>
<p> or in vector form: </p><p class="formulaDsp">
\[ \mathbf{v}\cdot\nabla\mathbf{v} = \nabla \left[ \frac 12 \mathbf{\tilde v}^2 + \mathbf{v}_{\infty} \cdot \mathbf{\tilde v} \right], \]
</p>
<p>@_fakenlor in other words: </p><p class="formulaDsp">
\[ p = -\rho \left[ \frac 12 \mathbf{\tilde v}^2 + \mathbf{v}_{\infty} \cdot \mathbf{\tilde v} \right] = -\rho \left[ \frac 12 \mathbf{v}^2 - \frac 12 \mathbf{v}_{\infty}^2 \right] . \]
</p>
<p>@_fakenlBecause the pressure is only determined up to a constant (it appears only witha gradient in the equations), an equally valid definition is </p><p class="formulaDsp">
\[ p = -\frac 12 \rho \mathbf{v}^2 . \]
</p>
<p>@_fakenlThis is exactly Bernoulli's law mentioned above.</p>
<p><a class="anchor" id="Thenumericalapproximation"></a></p><h3>The numerical approximation</h3>
<p>Numerical approximations of Boundary Integral Equations (BIE) are commonlyreferred to as the boundary element method or panel method (the latterexpression being used mostly in the computational fluid dynamics community).The goal of the following test problem is to solve the integralformulation of the Laplace equation with Neumann boundary conditions,using a circle and a sphere respectively in two and three spacedimensions, illustrating along the way the features that allow one totreat boundary element problems almost as easily as finite elementproblems using the deal.II library. To this end, let \(\mathcal{T}_h = \bigcup_i K_i\) be a subdivision of themanifold \(\Gamma = \partial \Omega\) into \(M\) line segments if \(n=2\) , or \(M\) quadrilaterals if \(n=3\) . We will call each individual segment orquadrilateral an <em>element</em> or <em>cell</em>, independently of thedimension \(n\) of the surrounding space \(\mathbb{R}^n\) .We define the finite dimensional space \(V_h\) as </p><p class="formulaDsp">
\[ \label{eq:definition-Vh} V_h \dealcoloneq \{ v \in C^0(\Gamma) \text{ s.t. } v|_{K_i} \in \mathcal{Q}^1(K_i), \forall i\}, \]
</p>
<p>@_fakenlwith basis functions \(\psi_i(\mathbf{x})\) for which we will use the usual FE_Qfinite element, with the catch that this time it is defined on a manifold ofcodimension one (which we do by using the second template argument that isusually defaulted to equal the first; here, we will create objects <code><a class="el" href="classFE__Q.html">FE_Q</a>&lt;dim-1,dim&gt;</code> to indicate that we have <code>dim-1</code> dimensional cells in a <code>dim</code> dimensional space).An element \(\phi_h\) of \(V_h\) is uniquelyidentified by the vector \(\boldsymbol{\phi}\) of its coefficients \(\phi_i\) , that is: </p><p class="formulaDsp">
\[ \label{eq:definition-of-element} \phi_h(\mathbf{x}) \dealcoloneq \phi_i \psi_i(\mathbf{x}), \qquad \boldsymbol{\phi} \dealcoloneq \{ \phi_i \}, \]
</p>
<p>@_fakenlwhere summation is implied over repeated indexes. Note that we could usediscontinuous elements here &mdash; in fact, there is no real reason to usecontinuous ones since the integral formulation does notimply any derivatives on our trial functions so continuity is unnecessary,and often in the literature only piecewise constant elements are used. <a class="anchor" id="Collocationboundaryelementmethod"></a></p><h3>Collocation boundary element method </h3>
<p>By far, the most common approximation of boundary integral equationsis by use of the collocation based boundary element method. This method requires the evaluation of the boundary integral equationat a number of collocation points which is equal to the number ofunknowns of the system. The choice of these points is a delicatematter, that requires a careful study. Assume that these points areknown for the moment, and call them \(\mathbf x_i\) with \(i=0...n\_dofs\) . The problem then becomes:Given the datum \(\mathbf{v}_\infty\) , find a function \(\phi_h\) in \(V_h\) such that the following \(n\_dofs\) equations are satisfied: </p><p class="formulaDsp">
\begin{align*} \alpha(\mathbf{x}_i) \phi_h(\mathbf{x}_i) - \int_{\Gamma_y} \frac{ \partial G(\mathbf{y}-\mathbf{x}_i)}{\partial\mathbf{n}_y } \phi_h(\mathbf{y}) \,ds_y = \int_{\Gamma_y} G(\mathbf{y}-\mathbf{x}_i) \, \mathbf{n}_y\cdot\mathbf{v_\infty} \,ds_y , \end{align*}
</p>
<p> where the quantity \(\alpha(\mathbf{x}_i)\) is the fraction of (solid)angle by which the point \(\mathbf{x}_i\) sees the domain \(\Omega\) , asexplained above, and we set \(\phi_\infty\) to be zero. If the supportpoints \(\mathbf{x}_i\) are chosen appropriately, then the problem canbe written as the following linear system: </p><p class="formulaDsp">
\[ \label{eq:linear-system} (\mathbf{A}+\mathbf{N})\boldsymbol\phi = \mathbf{b}, \]
</p>
<p> where </p><p class="formulaDsp">
\[ \begin{aligned} \mathbf{A}_{ij}&amp;= \alpha(\mathbf{x}_i) \psi_j(\mathbf{x}_i) = 1+\int_\Gamma \frac{\partial G(\mathbf{y}-\mathbf{x}_i)}{\partial \mathbf{n}_y}\,ds_y \psi_j(\mathbf{x}_i) \\ \mathbf{N}_{ij}&amp;= - \int_\Gamma \frac{\partial G(\mathbf{y}-\mathbf{x}_i)}{\partial \mathbf{n}_y} \psi_j(\mathbf{y}) \,ds_y \\ \mathbf{b}_i&amp;= \int_\Gamma G(\mathbf{y}-\mathbf{x}_i) \, \mathbf{n}_y\cdot\mathbf{v_\infty} ds_y. \end{aligned} \]
</p>
<p> From a linear algebra point of view, the best possible choice of thecollocation points is the one that renders the matrix \(\mathbf{A}+\mathbf{N}\) the most diagonally dominant. A natural choiceis then to select the \(\mathbf{x}_i\) collocation points to be thesupport points of the nodal basis functions \(\psi_i(\mathbf{x})\) . In thatcase, \(\psi_j(\mathbf{x}_i)=\delta_{ij}\) , and as a consequence the matrix \(\mathbf{A}\) is diagonal with entries </p><p class="formulaDsp">
\[ \mathbf{A}_{ii} = 1+\int_\Gamma \frac{\partial G(\mathbf{y}-\mathbf{x}_i)}{\partial \mathbf{n}_y}\,ds_y = 1-\sum_j N_{ij}, \]
</p>
<p>@_fakenlwhere we have used that \(\sum_j \psi_j(\mathbf{y})=1\) for the usual Lagrangeelements.With this choice of collocation points, the computation of the entriesof the matrices \(\mathbf{A}\) , \(\mathbf{N}\) and of the right hand side \(\mathbf{b}\) requires the evaluation of singular integrals on theelements \(K_i\) of the triangulation \(\mathcal{T}_h\) .As usual in these cases, all integrations are performed on a referencesimple domain, i.e., we assume that each element \(K_i\) of \(\mathcal{T}_h\) can be expressed as a linear (in two dimensions) orbi-linear (in three dimensions) transformation of the referenceboundary element \(\hat K \dealcoloneq [0,1]^{n-1}\) , and we perform the integrations after achange of variables from the real element \(K_i\) to the referenceelement \(\hat K\) . <a class="anchor" id="Treatingthesingularintegrals"></a></p><h3>Treating the singular integrals. </h3>
<p>In two dimensions it is not necessary to compute the diagonal elements \(\mathbf{N}_{ii}\) of the system matrix, since, even if the denominatorgoes to zero when \(\mathbf{x}=\mathbf{y}\) , the numerator is alwayszero because \(\mathbf{n}_y\) and \((\mathbf{y}-\mathbf{x})\) areorthogonal (on our polygonal approximation of the boundary of \(\Omega\) ), andthe only singular integral arises in the computationof \(\mathbf{b}_i\) on the i-th element of \(\mathcal{T}_h\) : </p><p class="formulaDsp">
\[ \frac{1}{\pi} \int_{K_i} \ln|\mathbf{y}-\mathbf{x}_i| \, \mathbf{n}_y\cdot\mathbf{v_\infty} \,ds_y. \]
</p>
<p> This can be easily treated by the <a class="el" href="classQGaussLogR.html">QGaussLogR</a> quadratureformula. Similarly, it is possible to use the <a class="el" href="classQGaussOneOverR.html">QGaussOneOverR</a> quadrature formulato perform the singular integrations in three dimensions. Theinterested reader will find detailed explanations on how thesequadrature rules work in their documentation. The resulting matrix \(\mathbf{A}+\mathbf{N}\) is full. Depending on itssize, it might be convenient to use a direct solver or an iterativeone. For the purpose of this example code, we chose to use only aniterative solver, without providing any preconditioner. If this were a production code rather than a demonstration of principles,there are techniques that are available to not store full matrices but insteadstore only those entries that are large and/or relevant. In the literature onboundary element methods, a plethora of methods is available that allows todetermine which elements are important and which are not, leading to asignificantly sparser representation of these matrices that also facilitatesrapid evaluations of the scalar product between vectors and matrices. This notbeing the goal of this program, we leave this for more sophisticatedimplementations.</p>
<p><a class="anchor" id="Implementation"></a></p><h3>Implementation</h3>
<p>The implementation is rather straight forward. The main point that hasn't beenused in any of the previous tutorial programs is that most classes in deal.IIare not only templated on the dimension, but in fact on the dimension of themanifold on which we pose the differential equation as well as the dimensionof the space into which this manifold is embedded. By default, the secondtemplate argument equals the first, meaning for example that we want to solveon a two-dimensional region of two-dimensional space. The triangulation classto use in this case would be <code><a class="el" href="classTriangulation.html">Triangulation</a>&lt;2&gt;</code> , which is anequivalent way of writing <code><a class="el" href="classTriangulation.html">Triangulation</a>&lt;2,2&gt;</code> . However, this doesn't have to be so: in the current example, we will forexample want to solve on the surface of a sphere, which is a two-dimensionalmanifold embedded in a three-dimensional space. Consequently, the right classwill be <code><a class="el" href="classTriangulation.html">Triangulation</a>&lt;2,3&gt;</code> , and correspondingly we will use <code><a class="el" href="classDoFHandler.html">DoFHandler</a>&lt;2,3&gt;</code> as the DoF handler class and <code><a class="el" href="classFE__Q.html">FE_Q</a>&lt;2,3&gt;</code> for finite elements. Some further details on what one can do with things that live oncurved manifolds can be found in the report<a href="http://www.dealii.org/reports/codimension-one/desimone-heltai-manigrasso.pdf" target="_top"><em>Tools for the Solution of PDEs Defined on Curved Manifolds with the deal.II Library</em><em>Tools for the Solution of PDEs Defined on Curved Manifolds with the deal.II Library</em> by A. DeSimone, L. Heltai, C. Manigrasso</a>. In addition, the <a class="el" href="step_38.html">step-38</a> tutorial program extends what we show here to cases where the equationposed on the manifold is not an integral operator but in fact involvesderivatives.</p>
<p><a class="anchor" id="Testcase"></a></p><h3>Testcase</h3>
<p>The testcase we will be solving is for a circular (in 2d) or spherical(in 3d) obstacle. Meshes for these geometries will be read in fromfiles in the current directory and an object of type SphericalManifoldwill then be attached to the triangulation to allow mesh refinementthat respects the continuous geometry behind the discrete initialmesh. For a sphere of radius \(a\) translating at a velocity of \(U\) in the \(x\) direction, the potential reads </p><p class="formulaDsp">
\begin{align*} \phi = -\frac{1}{2}U \left(\frac{a}{r}\right)3 r \cos\theta \end{align*}
</p>
<p> see, e.g. J. N. Newman, <em>Marine Hydrodynamics</em>, 1977,pp. 127. For unit speed and radius, and restricting \((x,y,z)\) to lieon the surface of the sphere, \(\phi = -x/2\) . In the test problem,the flow is \((1,1,1)\) , so the appropriate exact solution on thesurface of the sphere is the superposition of the above solution withthe analogous solution along the \(y\) and \(z\) axes, or \(\phi = \frac{1}{2}(x + y + z)\) .</p>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p><a class="anchor" id="Includefiles"></a> </p><h3>Include files</h3>
<p>The program starts with including a bunch of include files that we will use in the various parts of the program. Most of them have been discussed in previous tutorials already:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2smartpointer_8h.html">deal.II/base/smartpointer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2convergence__table_8h.html">deal.II/base/convergence_table.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__selector_8h.html">deal.II/base/quadrature_selector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2full__matrix_8h.html">deal.II/lac/full_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__control_8h.html">deal.II/lac/solver_control.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__gmres_8h.html">deal.II/lac/solver_gmres.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__in_8h.html">deal.II/grid/grid_in.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__out_8h.html">deal.II/grid/grid_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2manifold__lib_8h.html">deal.II/grid/manifold_lib.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__values_8h.html">deal.II/fe/fe_values.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q_8h.html">deal.II/fe/mapping_q.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
</div><!-- fragment --><p>And here are a few C++ standard header files that we will need:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
</div><!-- fragment --><p>The last part of this preamble is to import everything in the dealii namespace into the one into which everything in this program will go:</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep34.html">Step34</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p><a class="anchor" id="Singleanddoublelayeroperatorkernels"></a> </p><h3>Single and double layer operator kernels</h3>
<p>First, let us define a bit of the boundary integral equation machinery.</p>
<p>The following two functions are the actual calculations of the single and double layer potential kernels, that is \(G\) and \(\nabla G\) . They are well defined only if the vector \(R = \mathbf{y}-\mathbf{x}\) is different from zero.</p>
<div class="fragment"><div class="line"><span class="keyword">namespace </span>LaplaceKernel</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">single_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          <span class="keywordflow">return</span> (-std::log(R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>()) / (2 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          <span class="keywordflow">return</span> (1. / (R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>() 4 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">          <span class="keywordflow">return</span> 0.;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">double_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          <span class="keywordflow">return</span> R / (-2 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>());</div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          <span class="keywordflow">return</span> R / (-4 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>() R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>());</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">          <span class="keywordflow">return</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a>();</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace LaplaceKernel</span></div>
</div><!-- fragment --><p><a class="anchor" id="TheBEMProblemclass"></a> </p><h3>The BEMProblem class</h3>
<p>The structure of a boundary element method code is very similar to the structure of a finite element code, and so the member functions of this class are like those of most of the other tutorial programs. In particular, by now you should be familiar with reading parameters from an external file, and with the splitting of the different tasks into different modules. The same applies to boundary element methods, and we won't comment too much on them, except on the differences.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>BEMProblem</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  BEMProblem(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>      = 1,</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keywordtype">void</span> read_parameters(<span class="keyword">const</span> std::string &amp;filename);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> read_domain();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> refine_and_resize();</div>
</div><!-- fragment --><p>The only really different function that we find here is the assembly routine. We wrote this function in the most possible general way, in order to allow for easy generalization to higher order methods and to different fundamental solutions (e.g., Stokes or Maxwell). <br  />
 The most noticeable difference is the fact that the final matrix is full, and that we have a nested loop inside the usual loop on cells that visits all support points of the degrees of freedom. Moreover, when the support point lies inside the cell which we are visiting, then the integral we perform becomes singular. <br  />
 The practical consequence is that we have two sets of quadrature formulas, finite element values and temporary storage, one for standard integration and one for the singular integration, which are used where necessary.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> assemble_system();</div>
</div><!-- fragment --><p>There are two options for the solution of this problem. The first is to use a direct solver, and the second is to use an iterative solver. We opt for the second option. <br  />
 The matrix that we assemble is not symmetric, and we opt to use the GMRES method; however the construction of an efficient preconditioner for boundary element methods is not a trivial issue. Here we use a non preconditioned GMRES solver. The options for the iterative solver, such as the tolerance, the maximum number of iterations, are selected through the parameter file.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> solve_system();</div>
</div><!-- fragment --><p>Once we obtained the solution, we compute the \(L^2\) error of the computed potential as well as the \(L^\infty\) error of the approximation of the solid angle. The mesh we are using is an approximation of a smooth curve, therefore the computed diagonal matrix of fraction of angles or solid angles \(\alpha(\mathbf{x})\) should be constantly equal to \(\frac 12\) . In this routine we output the error on the potential and the error in the approximation of the computed angle. Notice that the latter error is actually not the error in the computation of the angle, but a measure of how well we are approximating the sphere and the circle. <br  />
 Experimenting a little with the computation of the angles gives very accurate results for simpler geometries. To verify this you can comment out, in the read_domain() method, the tria.set_manifold(1, manifold) line, and check the alpha that is generated by the program. By removing this call, whenever the mesh is refined new nodes will be placed along the straight lines that made up the coarse mesh, rather than be pulled onto the surface that we really want to approximate. In the three dimensional case, the coarse grid of the sphere is obtained starting from a cube, and the obtained values of alphas are exactly \(\frac 12\) on the nodes of the faces, \(\frac 34\) on the nodes of the edges and \(\frac 78\) on the 8 nodes of the vertices.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> compute_errors(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
</div><!-- fragment --><p>Once we obtained a solution on the codimension one domain, we want to interpolate it to the rest of the space. This is done by performing again the convolution of the solution with the kernel in the compute_exterior_solution() function. <br  />
 We would like to plot the velocity variable which is the gradient of the potential solution. The potential solution is only known on the boundary, but we use the convolution with the fundamental solution to interpolate it on a standard dim dimensional continuous finite element space. The plot of the gradient of the extrapolated solution will give us the velocity we want. <br  />
 In addition to the solution on the exterior domain, we also output the solution on the domain's boundary in the output_results() function, of course.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> compute_exterior_solution();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
</div><!-- fragment --><p>To allow for dimension independent programming, we specialize this single function to extract the singular quadrature formula needed to integrate the singular kernels in the interior of the cells.</p>
<div class="fragment"><div class="line">     <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1&gt; &amp;get_singular_quadrature(</div>
<div class="line">       <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classDoFHandler.html">DoFHandler</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;::active_cell_iterator &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>) <span class="keyword">const</span>;</div>
</div><!-- fragment --><p>The usual deal.II classes can be used for boundary element methods by specifying the "codimension" of the problem. This is done by setting the optional second template arguments to <a class="el" href="classTriangulation.html">Triangulation</a>, <a class="el" href="classFiniteElement.html">FiniteElement</a> and <a class="el" href="classDoFHandler.html">DoFHandler</a> to the dimension of the embedding space. In our case we generate either 1 or 2 dimensional meshes embedded in 2 or 3 dimensional spaces. <br  />
 The optional argument by default is equal to the first argument, and produces the usual finite element classes that we saw in all previous examples. <br  />
 The class is constructed in a way to allow for arbitrary order of approximation of both the domain (through high order mapping) and the finite element space. The order of the finite element space and of the mapping can be selected in the constructor of the class.</p>
<div class="fragment"><div class="line">     <a class="code" href="classTriangulation.html">Triangulation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; tria;</div>
<div class="line">     <a class="code" href="classFE__Q.html">FE_Q</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;          <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">     <a class="code" href="classDoFHandler.html">DoFHandler</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;    dof_handler;</div>
<div class="line">     <a class="code" href="classMappingQ.html">MappingQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
</div><!-- fragment --><p>In BEM methods, the matrix that is generated is dense. Depending on the size of the problem, the final system might be solved by direct LU decomposition, or by iterative methods. In this example we use an unpreconditioned GMRES method. Building a preconditioner for BEM method is non trivial, and we don't treat this subject here.</p>
<div class="fragment"><div class="line"><a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> system_matrix;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a>     system_rhs;</div>
</div><!-- fragment --><p>The next two variables will denote the solution \(\phi\) as well as a vector that will hold the values of \(\alpha(\mathbf x)\) (the fraction of \(\Omega\) visible from a point \(\mathbf x\) ) at the support points of our shape functions.</p>
<div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> phi;</div>
<div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>;</div>
</div><!-- fragment --><p>The convergence table is used to output errors in the exact solution and in the computed alphas.</p>
<div class="fragment"><div class="line"><a class="code" href="classConvergenceTable.html">ConvergenceTable</a> convergence_table;</div>
</div><!-- fragment --><p>The following variables are the ones that we fill through a parameter file. The new objects that we use in this example are the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> object and the <a class="el" href="classQuadratureSelector.html">QuadratureSelector</a> object. <br  />
 The <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> class allows us to easily and quickly define new function objects via parameter files, with custom definitions which can be very complex (see the documentation of that class for all the available options). <br  />
 We will allocate the quadrature object using the <a class="el" href="classQuadratureSelector.html">QuadratureSelector</a> class that allows us to generate quadrature formulas based on an identifying string and on the possible degree of the formula itself. We used this to allow custom selection of the quadrature formulas for the standard integration, and to define the order of the singular quadrature rule. <br  />
 We also define a couple of parameters which are used in case we wanted to extend the solution to the entire domain.</p>
<div class="fragment"><div class="line">     <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> wind;</div>
<div class="line">     <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         singular_quadrature_order;</div>
<div class="line">     std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1&gt;&gt; <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>;</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classSolverControl.html">SolverControl</a> solver_control;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cycles;</div>
<div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> external_refinement;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordtype">bool</span> run_in_this_dimension;</div>
<div class="line">     <span class="keywordtype">bool</span> extend_solution;</div>
<div class="line">   };</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemBEMProblemandBEMProblemread_parameters"></a> </p><h4>BEMProblem::BEMProblem and BEMProblem::read_parameters</h4>
<p>The constructor initializes the various object in much the same way as done in the finite element programs such as <a class="el" href="step_4.html">step-4</a> or <a class="el" href="step_6.html">step-6</a> . The only new ingredient here is the ParsedFunction object, which needs, at construction time, the specification of the number of components. <br  />
 For the exact solution the number of vector components is one, and no action is required since one is the default value for a ParsedFunction object. The wind, however, requires dim components to be specified. Notice that when declaring entries in a parameter file for the expression of the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a>, we need to specify the number of components explicitly, since the function <a class="el" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction::declare_parameters</a> is static, and has no knowledge of the number of components.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   BEMProblem&lt;dim&gt;::BEMProblem(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>,</div>
<div class="line">                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree)</div>
<div class="line">     : <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">     , dof_handler(tria)</div>
<div class="line">     , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(mapping_degree, <a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">     , wind(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">     , singular_quadrature_order(5)</div>
<div class="line">     , n_cycles(4)</div>
<div class="line">     , external_refinement(5)</div>
<div class="line">     , run_in_this_dimension(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">     , extend_solution(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">   {}</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::read_parameters(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;Parsing parameter file &quot;</span> &lt;&lt; filename &lt;&lt; std::endl</div>
<div class="line">             &lt;&lt; <span class="stringliteral">&quot;for a &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &lt;&lt; <span class="stringliteral">&quot; dimensional simulation. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classParameterHandler.html">ParameterHandler</a> prm;</div>
<div class="line">  </div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;External refinement&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Extend solution on the</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">-2,2 box&quot;</span>,</div>
<div class="line">                       <span class="stringliteral">&quot;true&quot;</span>,</div>
<div class="line">                       <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 2d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 3d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">  </div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">     {</div>
<div class="line">       prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(</div>
<div class="line">         <span class="stringliteral">&quot;Quadrature type&quot;</span>,</div>
<div class="line">         <span class="stringliteral">&quot;gauss&quot;</span>,</div>
<div class="line">         <a class="code" href="classPatterns_1_1Selection.html">Patterns::Selection</a>(</div>
<div class="line">           <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1)&gt;::get_quadrature_names()));</div>
<div class="line">       prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">       prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">     }</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>For both two and three dimensions, we set the default input data to be such that the solution is \(x+y\) or \(x+y+z\) . The actually computed solution will have value zero at infinity. In this case, this coincide with the exact solution, and no additional corrections are needed, but you should be aware of the fact that we arbitrarily set \(\phi_\infty\) , and the exact solution we pass to the program needs to have the same value at infinity for the error to be computed correctly. <br  />
 The use of the <a class="el" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a> object is pretty straight forward. The <a class="el" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction::declare_parameters</a> function takes an additional integer argument that specifies the number of components of the given function. Its default value is one. When the corresponding <a class="el" href="classFunctions_1_1ParsedFunction.html#ad63dc7cf2f447d3acfec839f28416914">Functions::ParsedFunction::parse_parameters</a> method is called, the calling object has to have the same number of components defined here, otherwise an exception is thrown. <br  />
 When declaring entries, we declare both 2 and three dimensional functions. However only the dim-dimensional one is ultimately parsed. This allows us to have only one parameter file for both 2 and 3 dimensional problems. <br  />
 Notice that from a mathematical point of view, the wind function on the boundary should satisfy the condition \(\int_{\partial\Omega} \mathbf{v}\cdot \mathbf{n} d \Gamma = 0\) , for the problem to have a solution. If this condition is not satisfied, then no solution can be found, and the solver will not converge.</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 2d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm, 2);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 3d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm, 3);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1; 1&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 2d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 3d&quot;</span>);</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm);</div>
<div class="line">  prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y+z&quot;</span>);</div>
<div class="line">}</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>In the solver section, we set all <a class="el" href="classSolverControl.html">SolverControl</a> parameters. The object will then be fed to the GMRES solver in the solve_system() function.</p>
<div class="fragment"><div class="line">prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line"><a class="code" href="classSolverControl.html#a0bb6dc567e07e9f7b0a9d09f801bf149">SolverControl::declare_parameters</a>(prm);</div>
<div class="line">prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>After declaring all these parameters to the <a class="el" href="classParameterHandler.html">ParameterHandler</a> object, let's read an input file that will give the parameters their values. We then proceed to extract these values from the <a class="el" href="classParameterHandler.html">ParameterHandler</a> object:</p>
<div class="fragment"><div class="line">     prm.<a class="code" href="classParameterHandler.html#a0ddaa05c5463c6c0b7701e18005717a9">parse_input</a>(filename);</div>
<div class="line">  </div>
<div class="line">     n_cycles            = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>);</div>
<div class="line">     external_refinement = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;External refinement&quot;</span>);</div>
<div class="line">     extend_solution     = prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Extend solution on the</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">-2,2 box&quot;</span>);</div>
<div class="line">  </div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> = std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1&gt;&gt;(</div>
<div class="line">         <span class="keyword">new</span> <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1&gt;(prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a>(<span class="stringliteral">&quot;Quadrature type&quot;</span>),</div>
<div class="line">                                         prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>)));</div>
<div class="line">       singular_quadrature_order = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>);</div>
<div class="line">     }</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">  </div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">     {</div>
<div class="line">       wind.parse_parameters(prm);</div>
<div class="line">     }</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">  </div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>.parse_parameters(prm);</div>
<div class="line">     }</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line">  </div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line">     solver_control.parse_parameters(prm);</div>
<div class="line">     prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
</div><!-- fragment --><p>Finally, here's another example of how to use parameter files in dimension independent programming. If we wanted to switch off one of the two simulations, we could do this by setting the corresponding "Run 2d simulation" or "Run 3d simulation" flag to false:</p>
<div class="fragment"><div class="line">  run_in_this_dimension =</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Run &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d simulation&quot;</span>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemread_domain"></a> </p><h4>BEMProblem::read_domain</h4>
<p>A boundary element method triangulation is basically the same as a (dim-1) dimensional triangulation, with the difference that the vertices belong to a (dim) dimensional space. <br  />
 Some of the mesh formats supported in deal.II use by default three dimensional points to describe meshes. These are the formats which are compatible with the boundary element method capabilities of deal.II. In particular we can use either UCD or GMSH formats. In both cases, we have to be particularly careful with the orientation of the mesh, because, unlike in the standard finite element case, no reordering or compatibility check is performed here. All meshes are considered as oriented, because they are embedded in a higher dimensional space. (See the documentation of the <a class="el" href="classGridIn.html">GridIn</a> and of the <a class="el" href="classTriangulation.html">Triangulation</a> for further details on orientation of cells in a triangulation.) In our case, the normals to the mesh are external to both the circle in 2d or the sphere in 3d. <br  />
 The other detail that is required for appropriate refinement of the boundary element mesh is an accurate description of the manifold that the mesh approximates. We already saw this several times for the boundary of standard finite element meshes (for example in <a class="el" href="step_5.html">step-5</a> and <a class="el" href="step_6.html">step-6</a> ), and here the principle and usage is the same, except that the <a class="el" href="classSphericalManifold.html">SphericalManifold</a> class takes an additional template parameter that specifies the embedding space dimension.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::read_domain()</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>                      <a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a> = <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>();</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classSphericalManifold.html">SphericalManifold</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>(<a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a>);</div>
<div class="line">  </div>
<div class="line">     std::ifstream <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>;</div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> 2:</div>
<div class="line">           <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_circle.inp&quot;</span>);</div>
<div class="line">           <span class="keywordflow">break</span>;</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> 3:</div>
<div class="line">           <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_sphere.inp&quot;</span>);</div>
<div class="line">           <span class="keywordflow">break</span>;</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classGridIn.html">GridIn</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; gi;</div>
<div class="line">     gi.<a class="code" href="classGridIn.html#a82ac1c03b0efe87204ad45d2f1d87f7e">attach_triangulation</a>(tria);</div>
<div class="line">     gi.read_ucd(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>);</div>
<div class="line">  </div>
<div class="line">     tria.set_all_manifold_ids(1);</div>
</div><!-- fragment --><p>The call to <a class="el" href="group__manifold.html#ga9f9d720f5fbdcdf3dcbb445feefbdb9f">Triangulation::set_manifold</a> copies the manifold (via <a class="el" href="classManifold.html#a140e1b7c7334d16f99aa7ad0dbabb44a">Manifold::clone()</a>), so we do not need to worry about invalid pointers to <code>manifold</code> :</p>
<div class="fragment"><div class="line">  tria.set_manifold(1, <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemrefine_and_resize"></a> </p><h4>BEMProblem::refine_and_resize</h4>
<p>This function globally refines the mesh, distributes degrees of freedom, and resizes matrices and vectors.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::refine_and_resize()</div>
<div class="line">{</div>
<div class="line">  tria.refine_global(1);</div>
<div class="line"> </div>
<div class="line">  dof_handler.distribute_dofs(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">  system_matrix.reinit(n_dofs, n_dofs);</div>
<div class="line"> </div>
<div class="line">  system_rhs.reinit(n_dofs);</div>
<div class="line">  phi.reinit(n_dofs);</div>
<div class="line">  <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.reinit(n_dofs);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemassemble_system"></a> </p><h4>BEMProblem::assemble_system</h4>
<p>The following is the main function of this program, assembling the matrix that corresponds to the boundary integral equation.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::assemble_system()</div>
<div class="line">{</div>
</div><!-- fragment --><p>First we initialize an <a class="el" href="classFEValues.html">FEValues</a> object with the quadrature formula for the integration of the kernel in non singular cells. This quadrature is selected with the parameter file, and needs to be quite precise, since the functions we are integrating are not polynomial functions.</p>
<div class="fragment"><div class="line">     <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                 <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                                <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                                 <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                   <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line">  </div>
<div class="line">     std::vector&lt;types::global_dof_index&gt; <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>(</div>
<div class="line">       <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line">  </div>
<div class="line">     std::vector&lt;Vector&lt;double&gt;&gt; cell_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line">     <span class="keywordtype">double</span>                      normal_wind;</div>
</div><!-- fragment --><p>Unlike in finite element methods, if we use a collocation boundary element method, then in each assembly loop we only assemble the information that refers to the coupling between one degree of freedom (the degree associated with support point \(i\) ) and the current cell. This is done using a vector of fe.dofs_per_cell elements, which will then be distributed to the matrix in the global row \(i\) . The following object will hold this information:</p>
<div class="fragment"><div class="line"><a class="code" href="classVector.html">Vector&lt;double&gt;</a> local_matrix_row_i(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
</div><!-- fragment --><p>The index \(i\) runs on the collocation points, which are the support points of the \(i\) th basis function, while \(j\) runs on inner integration points.</p>
<p>We construct a vector of support points which will be used in the local integrations:</p>
<div class="fragment"><div class="line">     std::vector&lt;Point&lt;dim&gt;&gt; support_points(dof_handler.n_dofs());</div>
<div class="line">     <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                                        dof_handler,</div>
<div class="line">                                                        support_points);</div>
</div><!-- fragment --><p>After doing so, we can start the integration loop over all cells, where we first initialize the <a class="el" href="classFEValues.html">FEValues</a> object and get the values of \(\mathbf{\tilde v}\) at the quadrature points (this vector field should be constant, but it doesn't hurt to be more general):</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">  {</div>
<div class="line">    fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">    <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line">    wind.vector_value_list(q_points, cell_wind);</div>
</div><!-- fragment --><p>We then form the integral over the current cell for all degrees of freedom (note that this includes degrees of freedom not located on the current cell, a deviation from the usual finite element integrals). The integral that we need to perform is singular if one of the local degrees of freedom is the same as the support point \(i\) . A the beginning of the loop we therefore check whether this is the case, and we store which one is the singular index:</p>
<div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">  {</div>
<div class="line">    local_matrix_row_i = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span>         is_singular    = <span class="keyword">false</span>;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> singular_index = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] == <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">        {</div>
<div class="line">          singular_index = <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>;</div>
<div class="line">          is_singular    = <span class="keyword">true</span>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
</div><!-- fragment --><p>We then perform the integral. If the index \(i\) is not one of the local degrees of freedom, we simply have to add the single layer terms to the right hand side, and the double layer terms to the matrix:</p>
<div class="fragment"><div class="line">             <span class="keywordflow">if</span> (is_singular == <span class="keyword">false</span>)</div>
<div class="line">               {</div>
<div class="line">                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">                   {</div>
<div class="line">                     normal_wind = 0;</div>
<div class="line">                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                       normal_wind += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">  </div>
<div class="line">                     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q]</div>
<div class="line">  </div>
<div class="line">- support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line">  </div>
<div class="line">                     system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R)</div>
<div class="line">                                       normal_wind fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">  </div>
<div class="line">                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">  </div>
<div class="line">                       local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">  </div>
<div class="line">-=</div>
<div class="line">                         ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q])</div>
<div class="line">                          fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">                   }</div>
<div class="line">               }</div>
<div class="line">             <span class="keywordflow">else</span></div>
<div class="line">               {</div>
</div><!-- fragment --><p>Now we treat the more delicate case. If we are here, this means that the cell that runs on the \(j\) index contains support_point[i]. In this case both the single and the double layer potential are singular, and they require special treatment. <br  />
 Whenever the integration is performed with the singularity inside the given cell, then a special quadrature formula is used that allows one to integrate arbitrary functions against a singular weight on the reference cell. <br  />
 The correct quadrature formula is selected by the get_singular_quadrature function, which is explained in detail below.</p>
<div class="fragment"><div class="line">                 <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(singular_index != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line">                        <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  </div>
<div class="line">                 <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1&gt; &amp;singular_quadrature =</div>
<div class="line">                   get_singular_quadrature(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, singular_index);</div>
<div class="line">  </div>
<div class="line">                 <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v_singular(</div>
<div class="line">                   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                   <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                   singular_quadrature,</div>
<div class="line">                   <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa9e3f2944ebdadf4409dc11f8fc0afe14">update_jacobians</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line">  </div>
<div class="line">                 fe_v_singular.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">  </div>
<div class="line">                 std::vector&lt;Vector&lt;double&gt;&gt; singular_cell_wind(</div>
<div class="line">                   singular_quadrature.size(), <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line">  </div>
<div class="line">                 <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;singular_normals =</div>
<div class="line">                   fe_v_singular.get_normal_vectors();</div>
<div class="line">                 <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;singular_q_points =</div>
<div class="line">                   fe_v_singular.get_quadrature_points();</div>
<div class="line">  </div>
<div class="line">                 wind.vector_value_list(singular_q_points, singular_cell_wind);</div>
<div class="line">  </div>
<div class="line">                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; singular_quadrature.size(); ++q)</div>
<div class="line">                   {</div>
<div class="line">                     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R =</div>
<div class="line">                       singular_q_points[q]</div>
<div class="line">  </div>
<div class="line">- support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line">                     <span class="keywordtype">double</span> normal_wind = 0;</div>
<div class="line">                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                       normal_wind +=</div>
<div class="line">                         (singular_cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) singular_normals[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line">  </div>
<div class="line">                     system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R)</div>
<div class="line">                                       normal_wind fe_v_singular.JxW(q));</div>
<div class="line">  </div>
<div class="line">                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">                       {</div>
<div class="line">                         local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">  </div>
<div class="line">-=</div>
<div class="line">                           ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R)</div>
<div class="line">                             singular_normals[q])</div>
<div class="line">                            fe_v_singular.shape_value(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q)</div>
<div class="line">                            fe_v_singular.JxW(q));</div>
<div class="line">                       }</div>
<div class="line">                   }</div>
<div class="line">               }</div>
</div><!-- fragment --><p>Finally, we need to add the contributions of the current cell to the global matrix.</p>
<div class="fragment"><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">        system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]) += local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The second part of the integral operator is the term \(\alpha(\mathbf{x}_i) \phi_j(\mathbf{x}_i)\) . Since we use a collocation scheme, \(\phi_j(\mathbf{x}_i)=\delta_{ij}\) and the corresponding matrix is a diagonal one with entries equal to \(\alpha(\mathbf{x}_i)\) .</p>
<p>One quick way to compute this diagonal matrix of the solid angles, is to use the Neumann matrix itself. It is enough to multiply the matrix with a vector of elements all equal to</p>
<ul>
<li>, to get the diagonal matrix of the alpha angles, or solid angles (see the formula in the introduction for this). The result is then added back onto the system matrix object to yield the final form of the matrix:</li>
</ul>
<div class="fragment"><div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>(dof_handler.n_dofs());</div>
<div class="line">  <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>.add(-1.);</div>
<div class="line"> </div>
<div class="line">  system_matrix.vmult(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>, <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>);</div>
<div class="line">  <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.add(1);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">    system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemsolve_system"></a> </p><h4>BEMProblem::solve_system</h4>
<p>The next function simply solves the linear system.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::solve_system()</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classSolverGMRES.html">SolverGMRES&lt;Vector&lt;double&gt;</a>&gt; <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>(solver_control);</div>
<div class="line">  <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>.solve(system_matrix, phi, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemcompute_errors"></a> </p><h4>BEMProblem::compute_errors</h4>
<p>The computation of the errors is exactly the same in all other example programs, and we won't comment too much. Notice how the same methods that are used in the finite element methods can be used here.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::compute_errors(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="classVector.html">Vector&lt;float&gt;</a> difference_per_cell(tria.n_active_cells());</div>
<div class="line">     <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                       dof_handler,</div>
<div class="line">                                       phi,</div>
<div class="line">                                       <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>,</div>
<div class="line">                                       difference_per_cell,</div>
<div class="line">                                       <a class="code" href="classQGauss.html">QGauss</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1)&gt;(2 <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a> + 1),</div>
<div class="line">                                       <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">double</span> L2_error =</div>
<div class="line">       <a class="code" href="namespaceVectorTools.html#a21eb62d70953182dcc2b15c4e14dd533">VectorTools::compute_global_error</a>(tria,</div>
<div class="line">                                         difference_per_cell,</div>
<div class="line">                                         <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
</div><!-- fragment --><p>The error in the alpha vector can be computed directly using the <a class="el" href="classVector.html#a9f6b7f7afb05aaff7e1ab8f9942b6dae">Vector::linfty_norm()</a> function, since on each node, the value should be \(\frac 12\) . All errors are then output and appended to our <a class="el" href="classConvergenceTable.html">ConvergenceTable</a> object for later computation of convergence rates:</p>
<div class="fragment"><div class="line">  <a class="code" href="classVector.html">Vector&lt;double&gt;</a> difference_per_node(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>);</div>
<div class="line">  difference_per_node.add(-.5);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>       alpha_error    = difference_per_node.linfty_norm();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a> = tria.n_active_cells();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs         = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span> &lt;&lt; <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a></div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; n_dofs &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;cycle&quot;</span>, <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;cells&quot;</span>, <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a>);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;dofs&quot;</span>, n_dofs);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;L2(phi)&quot;</span>, L2_error);</div>
<div class="line">  convergence_table.add_value(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, alpha_error);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Singular integration requires a careful selection of the quadrature rules. In particular the deal.II library provides quadrature rules which are tailored for logarithmic singularities (<a class="el" href="classQGaussLog.html">QGaussLog</a>, <a class="el" href="classQGaussLogR.html">QGaussLogR</a>), as well as for 1/R singularities (<a class="el" href="classQGaussOneOverR.html">QGaussOneOverR</a>). <br  />
 Singular integration is typically obtained by constructing weighted quadrature formulas with singular weights, so that it is possible to write <br  />
 </p><p class="formulaDsp">
\[ \int_K f(x) s(x) dx = \sum_{i=1}^N w_i f(q_i) \]
</p>
<p> <br  />
 where \(s(x)\) is a given singularity, and the weights and quadrature points \(w_i,q_i\) are carefully selected to make the formula above an equality for a certain class of functions \(f(x)\) . <br  />
 In all the finite element examples we have seen so far, the weight of the quadrature itself (namely, the function \(s(x)\) ), was always constantly equal to 1. For singular integration, we have two choices: we can use the definition above, factoring out the singularity from the integrand (i.e., integrating \(f(x)\) with the special quadrature rule), or we can ask the quadrature rule to "normalize" the weights \(w_i\) with \(s(q_i)\) : <br  />
 </p><p class="formulaDsp">
\[ \int_K f(x) s(x) dx = \int_K g(x) dx = \sum_{i=1}^N \frac{w_i}{s(q_i)} g(q_i) \]
</p>
<p> We use this second option, through the <code>factor_out_singularity</code> parameter of both <a class="el" href="classQGaussLogR.html">QGaussLogR</a> and <a class="el" href="classQGaussOneOverR.html">QGaussOneOverR</a>. <br  />
 These integrals are somewhat delicate, especially in two dimensions, due to the transformation from the real to the reference cell, where the variable of integration is scaled with the determinant of the transformation. <br  />
 In two dimensions this process does not result only in a factor appearing as a constant factor on the entire integral, but also on an additional integral altogether that needs to be evaluated: <br  />
 </p><p class="formulaDsp">
\[ \int_0^1 f(x)\ln(x/\alpha) dx = \int_0^1 f(x)\ln(x) dx - \int_0^1 f(x) \ln(\alpha) dx. \]
</p>
<p> This process is taken care of by the constructor of the <a class="el" href="classQGaussLogR.html">QGaussLogR</a> class, which adds additional quadrature points and weights to take into consideration also the second part of the integral. <br  />
 A similar reasoning should be done in the three dimensional case, since the singular quadrature is tailored on the inverse of the radius \(r\) in the reference cell, while our singular function lives in real space, however in the three dimensional case everything is simpler because the singularity scales linearly with the determinant of the transformation. This allows us to build the singular two dimensional quadrature rules only once and, reuse them over all cells. <br  />
 In the one dimensional singular integration this is not possible, since we need to know the scaling parameter for the quadrature, which is not known a priori. Here, the quadrature rule itself depends also on the size of the current cell. For this reason, it is necessary to create a new quadrature for each singular integration. <br  />
 The different quadrature rules are built inside the get_singular_quadrature, which is specialized for dim=2 and dim=3, and they are retrieved inside the assemble_system function. The index given as an argument is the index of the unit support point where the singularity is located.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;2&gt;</a> &amp;BEMProblem&lt;3&gt;::get_singular_quadrature(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;2, 3&gt;::active_cell_iterator</a> &amp;,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> std::vector&lt;QGaussOneOverR&lt;2&gt;&gt; quadratures;</div>
<div class="line">  <span class="keywordflow">if</span> (quadratures.size() == 0)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      quadratures.emplace_back(singular_quadrature_order,</div>
<div class="line">                               <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line">                               <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">return</span> quadratures[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> &amp;BEMProblem&lt;2&gt;::get_singular_quadrature(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;1, 2&gt;::active_cell_iterator</a> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                            <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a>q_pointer = <span class="keyword">nullptr</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (q_pointer)</div>
<div class="line">    <span class="keyword">delete</span> q_pointer;</div>
<div class="line"> </div>
<div class="line">  q_pointer = <span class="keyword">new</span> <a class="code" href="classQGaussLogR.html">QGaussLogR&lt;1&gt;</a>(singular_quadrature_order,</div>
<div class="line">                                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>],</div>
<div class="line">                                1. / <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;measure(),</div>
<div class="line">                                <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">return</span> (*q_pointer);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemcompute_exterior_solution"></a> </p><h4>BEMProblem::compute_exterior_solution</h4>
<p>We'd like to also know something about the value of the potential \(\phi\) in the exterior domain: after all our motivation to consider the boundary integral problem was that we wanted to know the velocity in the exterior domain! <br  />
 To this end, let us assume here that the boundary element domain is contained in the box \([-2,2]^{\text{dim}}\) , and we extrapolate the actual solution inside this box using the convolution with the fundamental solution. The formula for this is given in the introduction. <br  />
 The reconstruction of the solution in the entire space is done on a continuous finite element grid of dimension dim. These are the usual ones, and we don't comment any further on them. At the end of the function, we output this exterior solution in, again, much the usual way.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::compute_exterior_solution()</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> external_tria;</div>
<div class="line">     <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(external_tria,</div>
<div class="line">  </div>
<div class="line">-2, 2);</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>       external_fe(1);</div>
<div class="line">     <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> external_dh(external_tria);</div>
<div class="line">     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>  external_phi;</div>
<div class="line">  </div>
<div class="line">     external_tria.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a>(external_refinement);</div>
<div class="line">     external_dh.distribute_dofs(external_fe);</div>
<div class="line">     external_phi.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(external_dh.n_dofs());</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                 <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                                <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                                 <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                   <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line">  </div>
<div class="line">     std::vector&lt;types::global_dof_index&gt; <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line">  </div>
<div class="line">     std::vector&lt;double&gt;         local_phi(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">     std::vector&lt;double&gt;         normal_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">     std::vector&lt;Vector&lt;double&gt;&gt; local_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line">  </div>
<div class="line">     std::vector&lt;Point&lt;dim&gt;&gt; external_support_points(external_dh.n_dofs());</div>
<div class="line">     DoFTools::map_dofs_to_support_points&lt;dim&gt;(<a class="code" href="structStaticMappingQ1.html">StaticMappingQ1&lt;dim&gt;::mapping</a>,</div>
<div class="line">                                               external_dh,</div>
<div class="line">                                               external_support_points);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">       {</div>
<div class="line">         fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">  </div>
<div class="line">         <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">         <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line">  </div>
<div class="line">         <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>);</div>
<div class="line">         fe_v.<a class="code" href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">get_function_values</a>(phi, local_phi);</div>
<div class="line">  </div>
<div class="line">         wind.vector_value_list(q_points, local_wind);</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">           {</div>
<div class="line">             normal_wind[q] = 0;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               normal_wind[q] += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] local_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; external_dh.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">             {</div>
<div class="line">               <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q]</div>
<div class="line">  </div>
<div class="line">- external_support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line">  </div>
<div class="line">               external_phi(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) +=</div>
<div class="line">                 ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) normal_wind[q] +</div>
<div class="line">                   (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q])</div>
<div class="line">                     local_phi[q])</div>
<div class="line">                  fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">             }</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line">  </div>
<div class="line">     data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(external_dh);</div>
<div class="line">     data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(external_phi, <span class="stringliteral">&quot;external_phi&quot;</span>);</div>
<div class="line">     data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_external.vtk&quot;</span>;</div>
<div class="line">     std::ofstream     <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line">  </div>
<div class="line">     data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a>(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line">   }</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemoutput_results"></a> </p><h4>BEMProblem::output_results</h4>
<p>Outputting the results of our computations is a rather mechanical tasks. All the components of this function have been discussed before.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> BEMProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">   {</div>
<div class="line">     <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; dataout;</div>
<div class="line">  </div>
<div class="line">     dataout.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">     dataout.add_data_vector(phi, <span class="stringliteral">&quot;phi&quot;</span>, <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;::type_dof_data);</div>
<div class="line">     dataout.add_data_vector(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>,</div>
<div class="line">                             <span class="stringliteral">&quot;alpha&quot;</span>,</div>
<div class="line">                             <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;::type_dof_data);</div>
<div class="line">     dataout.build_patches(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                           <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>.get_degree(),</div>
<div class="line">                           <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">  </div>
<div class="line">- 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;::curved_inner_cells);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_boundary_solution_&quot;</span> +</div>
<div class="line">                                  <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line">     std::ofstream <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line">  </div>
<div class="line">     dataout.write_vtk(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">if</span> (<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> == n_cycles</div>
<div class="line">  </div>
<div class="line">- 1)</div>
<div class="line">       {</div>
<div class="line">         convergence_table.set_precision(<span class="stringliteral">&quot;L2(phi)&quot;</span>, 3);</div>
<div class="line">         convergence_table.set_precision(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, 3);</div>
<div class="line">  </div>
<div class="line">         convergence_table.set_scientific(<span class="stringliteral">&quot;L2(phi)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">         convergence_table.set_scientific(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">  </div>
<div class="line">         convergence_table.evaluate_convergence_rates(</div>
<div class="line">           <span class="stringliteral">&quot;L2(phi)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">         convergence_table.evaluate_convergence_rates(</div>
<div class="line">           <span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">         <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl;</div>
<div class="line">         convergence_table.write_text(std::cout);</div>
<div class="line">       }</div>
<div class="line">   }</div>
</div><!-- fragment --><p><a class="anchor" id="BEMProblemrun"></a> </p><h4>BEMProblem::run</h4>
<p>This is the main function. It should be self explanatory in its briefness:</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">BEMProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    read_parameters(<span class="stringliteral">&quot;parameters.prm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (run_in_this_dimension == <span class="keyword">false</span>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Run in dimension &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; explicitly disabled in parameter file. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    read_domain();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> = 0; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt; n_cycles; ++<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">      {</div>
<div class="line">        refine_and_resize();</div>
<div class="line">        assemble_system();</div>
<div class="line">        solve_system();</div>
<div class="line">        compute_errors(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">        output_results(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (extend_solution == <span class="keyword">true</span>)</div>
<div class="line">      compute_exterior_solution();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step34</span></div>
</div><!-- fragment --><p><a class="anchor" id="Themainfunction"></a> </p><h3>The <a class="el" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a> function</h3>
<p>This is the main function of this program. It is exactly like all previous tutorial programs:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep34.html">Step34</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(3);</div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;2&gt;</a> laplace_problem_2d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_2d.run();</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;3&gt;</a> laplace_problem_3d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_3d.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p>We ran the program using the following <code>parameters.prm</code> file (whichcan also be found in the directory in which all the other source files are): </p><pre class="fragment"># Listing of Parameters
#
* 
---------------------
set Extend solution on the
* 
-2,2 box = true
set External refinement             = 5
set Number of cycles                = 4
set Run 2d simulation               = true
set Run 3d simulation               = true
* 


* 
subsection Exact solution 2d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =
* 
  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = x+y   # default: 0
* 
  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,t
end
* 


* 
subsection Exact solution 3d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =
* 
  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = .5*(x+y+z)   # default: 0
* 
  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,z,t
end
* 


* 
subsection Quadrature rules
  set Quadrature order          = 4
  set Quadrature type           = gauss
  set Singular quadrature order = 5
end
* 


* 
subsection Solver
  set Log frequency = 1
  set Log history   = false
  set Log result    = true
  set Max steps     = 100
  set Tolerance     = 1.e-10
end
* 


* 
subsection Wind function 2d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =
* 
  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = 1; 1  # default: 0; 0
* 
  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,t
end
* 


* 
subsection Wind function 3d
  # Any constant used inside the function which is not a variable name.
  set Function constants  =
* 
  # Separate vector valued expressions by ';' as ',' is used internally by the
  # function parser.
  set Function expression = 1; 1; 1 # default: 0; 0; 0
* 
  # The name of the variables as they will be used in the function, separated
  # by ','.
  set Variable names      = x,y,z,t
end
</pre><p>When we run the program, the following is printed on screen: </p><pre class="fragment">DEAL::
DEAL::Parsing parameter file parameters.prm
DEAL::for a 2 dimensional simulation.
DEAL:GMRES::Starting value 2.21576
DEAL:GMRES::Convergence step 1 value 2.37635e-13
DEAL::Cycle 0:
DEAL::   Number of active cells:       20
DEAL::   Number of degrees of freedom: 20
DEAL:GMRES::Starting value 3.15543
DEAL:GMRES::Convergence step 1 value 2.89310e-13
DEAL::Cycle 1:
DEAL::   Number of active cells:       40
DEAL::   Number of degrees of freedom: 40
DEAL:GMRES::Starting value 4.46977
DEAL:GMRES::Convergence step 1 value 3.11815e-13
DEAL::Cycle 2:
DEAL::   Number of active cells:       80
DEAL::   Number of degrees of freedom: 80
DEAL:GMRES::Starting value 6.32373
DEAL:GMRES::Convergence step 1 value 3.22474e-13
DEAL::Cycle 3:
DEAL::   Number of active cells:       160
DEAL::   Number of degrees of freedom: 160
DEAL::
cycle cells dofs    L2(phi)     Linfty(alpha)
    0    20   20 4.465e-02
* 


* 
* 


* 
* 


* 
* 
- 5.000e-02
* 


* 
* 


* 
* 


* 
* 
-
    1    40   40 1.081e-02 2.05 2.500e-02 1.00
    2    80   80 2.644e-03 2.03 1.250e-02 1.00
    3   160  160 6.529e-04 2.02 6.250e-03 1.00
DEAL::
DEAL::Parsing parameter file parameters.prm
DEAL::for a 3 dimensional simulation.
DEAL:GMRES::Starting value 2.84666
DEAL:GMRES::Convergence step 3 value 8.68638e-18
DEAL::Cycle 0:
DEAL::   Number of active cells:       24
DEAL::   Number of degrees of freedom: 26
DEAL:GMRES::Starting value 6.34288
DEAL:GMRES::Convergence step 5 value 1.38740e-11
DEAL::Cycle 1:
DEAL::   Number of active cells:       96
DEAL::   Number of degrees of freedom: 98
DEAL:GMRES::Starting value 12.9780
DEAL:GMRES::Convergence step 5 value 3.29225e-11
DEAL::Cycle 2:
DEAL::   Number of active cells:       384
DEAL::   Number of degrees of freedom: 386
DEAL:GMRES::Starting value 26.0874
DEAL:GMRES::Convergence step 6 value 1.47271e-12
DEAL::Cycle 3:
DEAL::   Number of active cells:       1536
DEAL::   Number of degrees of freedom: 1538
DEAL::
cycle cells dofs    L2(phi)     Linfty(alpha)
    0    24   26 3.437e-01
* 


* 
* 


* 
* 


* 
* 
- 2.327e-01
* 


* 
* 


* 
* 


* 
* 
-
    1    96   98 9.794e-02 1.81 1.239e-01 0.91
    2   384  386 2.417e-02 2.02 6.319e-02 0.97
    3  1536 1538 5.876e-03 2.04 3.176e-02 0.99
</pre><p>As we can see from the convergence table in 2d, if we choosequadrature formulas which are accurate enough, then the error weobtain for \(\alpha(\mathbf{x})\) should be exactly the inverse of thenumber of elements. The approximation of the circle with N segments ofequal size generates a regular polygon with N faces, whose angles areexactly \(\pi-\frac {2\pi}{N}\) , therefore the error we commit should beexactly \(\frac 12 - (\frac 12 -\frac 1N) = \frac 1N\) . In fact this isa very good indicator that we are performing the singular integrals inan appropriate manner. The error in the approximation of the potential \(\phi\) is largely dueto approximation of the domain. A much better approximation could beobtained by using higher order mappings. If we modify the <a class="el" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a> function, setting fe_degree and mapping_degreeto two, and raise the order of the quadrature formulas inthe parameter file, we obtain the following convergence table for thetwo dimensional simulation </p><pre class="fragment">cycle cells dofs    L2(phi)     Linfty(alpha)
    0    20   40 5.414e-05
* 


* 
* 


* 
* 


* 
* 
- 2.306e-04
* 


* 
* 


* 
* 


* 
* 
-
    1    40   80 3.623e-06 3.90 1.737e-05 3.73
    2    80  160 2.690e-07 3.75 1.253e-05 0.47
    3   160  320 2.916e-08 3.21 7.670e-06 0.71
</pre><p>and </p><pre class="fragment">cycle cells dofs    L2(phi)     Linfty(alpha)
    0    24   98 3.770e-03
* 


* 
* 


* 
* 


* 
* 
- 8.956e-03
* 


* 
* 


* 
* 


* 
* 
-
    1    96  386 1.804e-04 4.39 1.182e-03 2.92
    2   384 1538 9.557e-06 4.24 1.499e-04 2.98
    3  1536 6146 6.617e-07 3.85 1.892e-05 2.99
</pre><p>for the three dimensional case. As we can see, convergence results aremuch better with higher order mapping, mainly due to a betterresolution of the curved geometry. Notice that, given the same numberof degrees of freedom, for example in step 3 of the Q1 case and step 2of Q2 case in the three dimensional simulation, the error is roughlythree orders of magnitude lower. The result of running these computations is a bunch of output files that wecan pass to our visualization program of choice.The output files are of two kind: the potential on the boundaryelement surface, and the potential extended to the outer and innerdomain. The combination of the two for the two dimensional case lookslike <img src="https://www.dealii.org/images/steps/developer/step-34_2d.png" alt="" class="inline"/> <br  />
 while in three dimensions we show first the potential on the surface,together with a contour plot, <img src="https://www.dealii.org/images/steps/developer/step-34_3d.png" alt="" class="inline"/> <br  />
 and then the external contour plot of the potential, with opacity set to 25%: <img src="https://www.dealii.org/images/steps/developer/step-34_3d-2.png" alt="" class="inline"/> <br  />
</p>
<p><a class="anchor" id="extensions"></a><a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>This is the first tutorial program that considers solving equations defined onsurfaces embedded in higher dimensional spaces. But the equation discussedhere was relatively simple because it only involved an integral operator, notderivatives which are more difficult to define on the surface. The <a class="el" href="step_38.html">step-38</a> tutorial program considers such problems and provides the necessary tools. From a practical perspective, the Boundary Element Method (BEM) usedhere suffers from two bottlenecks. The first is that assembling thematrix has a cost that isquadratic* in the number of unknowns, thatis \({\cal O}(N^2)\) where \(N\) is the total number of unknowns. This canbe seen by looking at the <code>assemble_system()</code> function, which has thisstructure: </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">  {</div>
<div class="line">    ...</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      ...</div>
</div><!-- fragment --><p> Here, the first loop walks over all cells (one factor of \(N\) ) whereasthe inner loop contributes another factor of \(N\) . This has to be contrasted with the finite element method forlocal* differential operators: There, we loop over all cells (one factor of \(N\) ) and on each cell do an amount of work that is independent of howmany cells or unknowns there are. This clearly presents abottleneck. The second bottleneck is that the system matrix is dense (i.e., is oftype <a class="el" href="classFullMatrix.html">FullMatrix</a>) because every degree of freedom couples with everyother degree of freedom. As pointed out above, justcomputing* thismatrix with its \(N^2\) nonzero entries necessarily requires at least \({\cal O}(N^2)\) operations, but it's worth pointing out that it alsocosts this many operations to just do one matrix-vector product. Ifthe GMRES method used to solve the linear system requires a number ofiterations that grows with the size of the problem, as is typicallythe case, then solving the linear system will require a number ofoperations that grows even faster than just \({\cal O}(N^2)\) . "Real" boundary element methods address these issues by strategiesthat determine which entries of the matrix will be small and canconsequently be neglected (at the cost of introducing an additionalerror, of course). This is possible by recognizing that the matrixentries decay with the (physical) distance between the locations wheredegrees of freedom \(i\) and \(j\) are defined. This can be exploited inmethods such as the Fast Multipole Method (FMM) that control whichmatrix entries must be stored and computed to achieve a certainaccuracy, and</p>
<ul>
<li>if done right</li>
<li>result in methods in which bothassembly and solution of the linear system requires less than \({\cal O}(N^2)\) operations. Implementing these methods clearly presents opportunities to extendthe current program.</li>
</ul>
<p><a class="anchor" id="PlainProg"></a></p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2009 - 2021 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Luca Heltai, Cataldo Manigrasso, 2009</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2smartpointer_8h.html">deal.II/base/smartpointer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2convergence__table_8h.html">deal.II/base/convergence_table.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__lib_8h.html">deal.II/base/quadrature_lib.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2quadrature__selector_8h.html">deal.II/base/quadrature_selector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2parsed__function_8h.html">deal.II/base/parsed_function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2full__matrix_8h.html">deal.II/lac/full_matrix.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__control_8h.html">deal.II/lac/solver_control.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2solver__gmres_8h.html">deal.II/lac/solver_gmres.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2precondition_8h.html">deal.II/lac/precondition.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__in_8h.html">deal.II/grid/grid_in.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__out_8h.html">deal.II/grid/grid_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2manifold__lib_8h.html">deal.II/grid/manifold_lib.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__tools_8h.html">deal.II/dofs/dof_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__q_8h.html">deal.II/fe/fe_q.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__values_8h.html">deal.II/fe/fe_values.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2mapping__q_8h.html">deal.II/fe/mapping_q.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2vector__tools_8h.html">deal.II/numerics/vector_tools.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceStep34.html">Step34</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">namespace </span>LaplaceKernel</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">single_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> 2:</div>
<div class="line">            <span class="keywordflow">return</span> (-std::log(R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>()) / (2 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> 3:</div>
<div class="line">            <span class="keywordflow">return</span> (1. / (R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>() * 4 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">            <span class="keywordflow">return</span> 0.;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">double_layer</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;R)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> 2:</div>
<div class="line">            <span class="keywordflow">return</span> R / (-2 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>());</div>
<div class="line">          <span class="keywordflow">case</span> 3:</div>
<div class="line">            <span class="keywordflow">return</span> R / (-4 * <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * R.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>() * R.<a class="code" href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">norm</a>());</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a>();</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">  } <span class="comment">// namespace LaplaceKernel</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span><a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem</a></div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>      = 1,</div>
<div class="line">               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> read_parameters(<span class="keyword">const</span> std::string &amp;filename);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> read_domain();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> refine_and_resize();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> assemble_system();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> solve_system();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> compute_errors(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> compute_exterior_solution();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt; &amp;get_singular_quadrature(</div>
<div class="line">      <span class="keyword">const</span> <span class="keyword">typename</span> DoFHandler&lt;dim - 1, dim&gt;::active_cell_iterator &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; tria;</div>
<div class="line">    <a class="code" href="classFE__Q.html">FE_Q</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;          <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="group__dofs.html#ga768cd565b5c25f1ac235586e36ac94d6">DoFHandler</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;    dof_handler;</div>
<div class="line">    <a class="code" href="classMappingQ.html">MappingQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> system_matrix;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     system_rhs;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> phi;</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConvergenceTable.html">ConvergenceTable</a> convergence_table;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> wind;</div>
<div class="line">    <a class="code" href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction&lt;dim&gt;</a> <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         singular_quadrature_order;</div>
<div class="line">    std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;&gt; <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classSolverControl.html">SolverControl</a> solver_control;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_cycles;</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> external_refinement;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> run_in_this_dimension;</div>
<div class="line">    <span class="keywordtype">bool</span> extend_solution;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classStep34_1_1BEMProblem.html#a9e7bc122afd983144f27ea9c28eb6d68">BEMProblem&lt;dim&gt;::BEMProblem</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>,</div>
<div class="line">                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree)</div>
<div class="line">    : <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(tria)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(mapping_degree, <a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">    , wind(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">    , singular_quadrature_order(5)</div>
<div class="line">    , n_cycles(4)</div>
<div class="line">    , external_refinement(5)</div>
<div class="line">    , run_in_this_dimension(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">    , extend_solution(<a class="code" href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a>)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::read_parameters</a>(<span class="keyword">const</span> std::string &amp;filename)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Parsing parameter file &quot;</span> &lt;&lt; filename &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;for a &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &lt;&lt; <span class="stringliteral">&quot; dimensional simulation. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classParameterHandler.html">ParameterHandler</a> prm;</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;External refinement&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Extend solution on the -2,2 box&quot;</span>,</div>
<div class="line">                      <span class="stringliteral">&quot;true&quot;</span>,</div>
<div class="line">                      <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 2d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Run 3d simulation&quot;</span>, <span class="stringliteral">&quot;true&quot;</span>, <a class="code" href="classPatterns_1_1Bool.html">Patterns::Bool</a>());</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(</div>
<div class="line">        <span class="stringliteral">&quot;Quadrature type&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;gauss&quot;</span>,</div>
<div class="line">        <a class="code" href="classPatterns_1_1Selection.html">Patterns::Selection</a>(</div>
<div class="line">          <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1)&gt;::get_quadrature_names()));</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>, <span class="stringliteral">&quot;4&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">declare_entry</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>, <span class="stringliteral">&quot;5&quot;</span>, <a class="code" href="classPatterns_1_1Integer.html">Patterns::Integer</a>());</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 2d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm, 2);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function 3d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm, 3);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;1; 1; 1&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 2d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;2&gt;::declare_parameters</a>(prm);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution 3d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction&lt;3&gt;::declare_parameters</a>(prm);</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">set</a>(<span class="stringliteral">&quot;Function expression&quot;</span>, <span class="stringliteral">&quot;x+y+z&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line">    <a class="code" href="classSolverControl.html#a0bb6dc567e07e9f7b0a9d09f801bf149">SolverControl::declare_parameters</a>(prm);</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a0ddaa05c5463c6c0b7701e18005717a9">parse_input</a>(filename);</div>
<div class="line"> </div>
<div class="line">    n_cycles            = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Number of cycles&quot;</span>);</div>
<div class="line">    external_refinement = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;External refinement&quot;</span>);</div>
<div class="line">    extend_solution     = prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Extend solution on the -2,2 box&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Quadrature rules&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a> = std::shared_ptr&lt;<a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="classQuadratureSelector.html">QuadratureSelector</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt;(prm.<a class="code" href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">get</a>(<span class="stringliteral">&quot;Quadrature type&quot;</span>),</div>
<div class="line">                                        prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Quadrature order&quot;</span>)));</div>
<div class="line">      singular_quadrature_order = prm.<a class="code" href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">get_integer</a>(<span class="stringliteral">&quot;Singular quadrature order&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Wind function &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      wind.parse_parameters(prm);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Exact solution &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>.parse_parameters(prm);</div>
<div class="line">    }</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">enter_subsection</a>(<span class="stringliteral">&quot;Solver&quot;</span>);</div>
<div class="line">    solver_control.parse_parameters(prm);</div>
<div class="line">    prm.<a class="code" href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">leave_subsection</a>();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    run_in_this_dimension =</div>
<div class="line">      prm.<a class="code" href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">get_bool</a>(<span class="stringliteral">&quot;Run &quot;</span> + <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d simulation&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::read_domain</a>()</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>                      <a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a> = <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>();</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classSphericalManifold.html">SphericalManifold</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>(<a class="code" href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a>);</div>
<div class="line"> </div>
<div class="line">    std::ifstream <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>;</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 2:</div>
<div class="line">          <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_circle.inp&quot;</span>);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 3:</div>
<div class="line">          <a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>.open(<span class="stringliteral">&quot;coarse_sphere.inp&quot;</span>);</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classGridIn.html">GridIn</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; gi;</div>
<div class="line">    gi.<a class="code" href="classGridIn.html#a82ac1c03b0efe87204ad45d2f1d87f7e">attach_triangulation</a>(tria);</div>
<div class="line">    gi.read_ucd(<a class="code" href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a>);</div>
<div class="line"> </div>
<div class="line">    tria.set_all_manifold_ids(1);</div>
<div class="line">    tria.set_manifold(1, <a class="code" href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::refine_and_resize</a>()</div>
<div class="line">  {</div>
<div class="line">    tria.refine_global(1);</div>
<div class="line"> </div>
<div class="line">    dof_handler.distribute_dofs(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">    system_matrix.reinit(n_dofs, n_dofs);</div>
<div class="line"> </div>
<div class="line">    system_rhs.reinit(n_dofs);</div>
<div class="line">    phi.reinit(n_dofs);</div>
<div class="line">    <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.reinit(n_dofs);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::assemble_system</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                                *<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                                <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;types::global_dof_index&gt; <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>(</div>
<div class="line">      <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Vector&lt;double&gt;&gt; cell_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line">    <span class="keywordtype">double</span>                      normal_wind;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> local_matrix_row_i(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Point&lt;dim&gt;&gt; support_points(dof_handler.n_dofs());</div>
<div class="line">    <a class="code" href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                                       dof_handler,</div>
<div class="line">                                                       support_points);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">      {</div>
<div class="line">        fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line">        wind.vector_value_list(q_points, cell_wind);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">          {</div>
<div class="line">            local_matrix_row_i = 0;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">bool</span>         is_singular    = <span class="keyword">false</span>;</div>
<div class="line">            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> singular_index = <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">              <span class="keywordflow">if</span> (<a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] == <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                {</div>
<div class="line">                  singular_index = <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>;</div>
<div class="line">                  is_singular    = <span class="keyword">true</span>;</div>
<div class="line">                  <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (is_singular == <span class="keyword">false</span>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">                  {</div>
<div class="line">                    normal_wind = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      normal_wind += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q] - support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">                    system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) *</div>
<div class="line">                                      normal_wind * fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"> </div>
<div class="line">                      local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) -=</div>
<div class="line">                        ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) * <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q]) *</div>
<div class="line">                         fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) * fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">                  }</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(singular_index != <a class="code" href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a>,</div>
<div class="line">                       <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1&gt; &amp;singular_quadrature =</div>
<div class="line">                  get_singular_quadrature(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>, singular_index);</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v_singular(</div>
<div class="line">                  <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                  <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                  singular_quadrature,</div>
<div class="line">                  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa9e3f2944ebdadf4409dc11f8fc0afe14">update_jacobians</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                    <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a>);</div>
<div class="line"> </div>
<div class="line">                fe_v_singular.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">                std::vector&lt;Vector&lt;double&gt;&gt; singular_cell_wind(</div>
<div class="line">                  singular_quadrature.size(), <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;singular_normals =</div>
<div class="line">                  fe_v_singular.get_normal_vectors();</div>
<div class="line">                <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;singular_q_points =</div>
<div class="line">                  fe_v_singular.get_quadrature_points();</div>
<div class="line"> </div>
<div class="line">                wind.vector_value_list(singular_q_points, singular_cell_wind);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; singular_quadrature.size(); ++q)</div>
<div class="line">                  {</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R =</div>
<div class="line">                      singular_q_points[q] - support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line">                    <span class="keywordtype">double</span> normal_wind = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      normal_wind +=</div>
<div class="line">                        (singular_cell_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) * singular_normals[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">                    system_rhs(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) *</div>
<div class="line">                                      normal_wind * fe_v_singular.JxW(q));</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">                      {</div>
<div class="line">                        local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>) -=</div>
<div class="line">                          ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) *</div>
<div class="line">                            singular_normals[q]) *</div>
<div class="line">                           fe_v_singular.shape_value(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>, q) *</div>
<div class="line">                           fe_v_singular.JxW(q));</div>
<div class="line">                      }</div>
<div class="line">                  }</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line">              system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]) += local_matrix_row_i(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>(dof_handler.n_dofs());</div>
<div class="line">    <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>.add(-1.);</div>
<div class="line"> </div>
<div class="line">    system_matrix.vmult(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>, <a class="code" href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a>);</div>
<div class="line">    <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>.add(1);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; dof_handler.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">      system_matrix(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>, <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) += <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::solve_system</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classSolverGMRES.html">SolverGMRES&lt;Vector&lt;double&gt;</a>&gt; <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>(solver_control);</div>
<div class="line">    <a class="code" href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a>.solve(system_matrix, phi, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::compute_errors</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;float&gt;</a> difference_per_cell(tria.n_active_cells());</div>
<div class="line">    <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                      dof_handler,</div>
<div class="line">                                      phi,</div>
<div class="line">                                      <a class="code" href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">exact_solution</a>,</div>
<div class="line">                                      difference_per_cell,</div>
<div class="line">                                      <a class="code" href="classQGauss.html">QGauss</a>&lt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1)&gt;(2 * <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a> + 1),</div>
<div class="line">                                      <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> L2_error =</div>
<div class="line">      <a class="code" href="namespaceVectorTools.html#a21eb62d70953182dcc2b15c4e14dd533">VectorTools::compute_global_error</a>(tria,</div>
<div class="line">                                        difference_per_cell,</div>
<div class="line">                                        <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> difference_per_node(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>);</div>
<div class="line">    difference_per_node.add(-.5);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>       alpha_error    = difference_per_node.linfty_norm();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a> = tria.n_active_cells();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_dofs         = dof_handler.n_dofs();</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span> &lt;&lt; <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a></div>
<div class="line">            &lt;&lt; std::endl</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; n_dofs &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;cycle&quot;</span>, <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;cells&quot;</span>, <a class="code" href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">n_active_cells</a>);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;dofs&quot;</span>, n_dofs);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;L2(phi)&quot;</span>, L2_error);</div>
<div class="line">    convergence_table.add_value(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, alpha_error);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;&gt;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;2&gt;</a> &amp;<a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;3&gt;::get_singular_quadrature</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;2, 3&gt;::active_cell_iterator</a> &amp;,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> std::vector&lt;QGaussOneOverR&lt;2&gt;&gt; quadratures;</div>
<div class="line">    <span class="keywordflow">if</span> (quadratures.size() == 0)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">        quadratures.emplace_back(singular_quadrature_order,</div>
<div class="line">                                 <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line">                                 <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">return</span> quadratures[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;&gt;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> &amp;<a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;2&gt;::get_singular_quadrature</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler&lt;1, 2&gt;::active_cell_iterator</a> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                            <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a> &lt; <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(0, <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>(), <a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">static</span> <a class="code" href="classQuadrature.html">Quadrature&lt;1&gt;</a> *q_pointer = <span class="keyword">nullptr</span>;</div>
<div class="line">    <span class="keywordflow">if</span> (q_pointer)</div>
<div class="line">      <span class="keyword">delete</span> q_pointer;</div>
<div class="line"> </div>
<div class="line">    q_pointer = <span class="keyword">new</span> <a class="code" href="classQGaussLogR.html">QGaussLogR&lt;1&gt;</a>(singular_quadrature_order,</div>
<div class="line">                                  <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">get_unit_support_points</a>()[<a class="code" href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a>],</div>
<div class="line">                                  1. / <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;measure(),</div>
<div class="line">                                  <span class="keyword">true</span>);</div>
<div class="line">    <span class="keywordflow">return</span> (*q_pointer);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::compute_exterior_solution</a>()</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> external_tria;</div>
<div class="line">    <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(external_tria, -2, 2);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>       external_fe(1);</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> external_dh(external_tria);</div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a>  external_phi;</div>
<div class="line"> </div>
<div class="line">    external_tria.<a class="code" href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">refine_global</a>(external_refinement);</div>
<div class="line">    external_dh.distribute_dofs(external_fe);</div>
<div class="line">    external_phi.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(external_dh.n_dofs());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFEValues.html">FEValues</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; fe_v(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                                <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>,</div>
<div class="line">                                *<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>,</div>
<div class="line">                                <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">                                  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a> = fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;types::global_dof_index&gt; <a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">n_dofs_per_cell</a>());</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;double&gt;         local_phi(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">    std::vector&lt;double&gt;         normal_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>);</div>
<div class="line">    std::vector&lt;Vector&lt;double&gt;&gt; local_wind(<a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>, <a class="code" href="classVector.html">Vector&lt;double&gt;</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>));</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;Point&lt;dim&gt;&gt; external_support_points(external_dh.n_dofs());</div>
<div class="line">    DoFTools::map_dofs_to_support_points&lt;dim&gt;(<a class="code" href="structStaticMappingQ1.html">StaticMappingQ1&lt;dim&gt;::mapping</a>,</div>
<div class="line">                                              external_dh,</div>
<div class="line">                                              external_support_points);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line">      {</div>
<div class="line">        fe_v.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Point&lt;dim&gt;&gt; &amp;q_points = fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>();</div>
<div class="line">        <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;<a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a> = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_indices(<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>);</div>
<div class="line">        fe_v.<a class="code" href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">get_function_values</a>(phi, local_phi);</div>
<div class="line"> </div>
<div class="line">        wind.vector_value_list(q_points, local_wind);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">          {</div>
<div class="line">            normal_wind[q] = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              normal_wind[q] += <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * local_wind[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; external_dh.n_dofs(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; <a class="code" href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a>; ++q)</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> R = q_points[q] - external_support_points[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"> </div>
<div class="line">              external_phi(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) +=</div>
<div class="line">                ((<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">LaplaceKernel::single_layer</a>(R) * normal_wind[q] +</div>
<div class="line">                  (<a class="code" href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">LaplaceKernel::double_layer</a>(R) * <a class="code" href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a>[q]) *</div>
<div class="line">                    local_phi[q]) *</div>
<div class="line">                 fe_v.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q));</div>
<div class="line">            }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(external_dh);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(external_phi, <span class="stringliteral">&quot;external_phi&quot;</span>);</div>
<div class="line">    data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_external.vtk&quot;</span>;</div>
<div class="line">    std::ofstream     <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a>(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;dim&gt;::output_results</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> - 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt; dataout;</div>
<div class="line"> </div>
<div class="line">    dataout.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">    dataout.add_data_vector(phi, <span class="stringliteral">&quot;phi&quot;</span>, <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::type_dof_data</a>);</div>
<div class="line">    dataout.add_data_vector(<a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">alpha</a>,</div>
<div class="line">                            <span class="stringliteral">&quot;alpha&quot;</span>,</div>
<div class="line">                            <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::type_dof_data</a>);</div>
<div class="line">    dataout.build_patches(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                          <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>.get_degree(),</div>
<div class="line">                          <a class="code" href="classDataOut.html">DataOut&lt;dim - 1, dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename = <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) + <span class="stringliteral">&quot;d_boundary_solution_&quot;</span> +</div>
<div class="line">                                 <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line">    std::ofstream <a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>(filename);</div>
<div class="line"> </div>
<div class="line">    dataout.write_vtk(<a class="code" href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> == n_cycles - 1)</div>
<div class="line">      {</div>
<div class="line">        convergence_table.set_precision(<span class="stringliteral">&quot;L2(phi)&quot;</span>, 3);</div>
<div class="line">        convergence_table.set_precision(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, 3);</div>
<div class="line"> </div>
<div class="line">        convergence_table.set_scientific(<span class="stringliteral">&quot;L2(phi)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">        convergence_table.set_scientific(<span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        convergence_table.evaluate_convergence_rates(</div>
<div class="line">          <span class="stringliteral">&quot;L2(phi)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">        convergence_table.evaluate_convergence_rates(</div>
<div class="line">          <span class="stringliteral">&quot;Linfty(alpha)&quot;</span>, <a class="code" href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a>);</div>
<div class="line">        <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; std::endl;</div>
<div class="line">        convergence_table.write_text(std::cout);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">BEMProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    read_parameters(<span class="stringliteral">&quot;parameters.prm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (run_in_this_dimension == <span class="keyword">false</span>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a> &lt;&lt; <span class="stringliteral">&quot;Run in dimension &quot;</span> &lt;&lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; explicitly disabled in parameter file. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    read_domain();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> = 0; <a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a> &lt; n_cycles; ++<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>)</div>
<div class="line">      {</div>
<div class="line">        refine_and_resize();</div>
<div class="line">        assemble_system();</div>
<div class="line">        solve_system();</div>
<div class="line">        compute_errors(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">        output_results(<a class="code" href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (extend_solution == <span class="keyword">true</span>)</div>
<div class="line">      compute_exterior_solution();</div>
<div class="line">  }</div>
<div class="line">} <span class="comment">// namespace Step34</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">using namespace </span><a class="code" href="namespaceStep34.html">Step34</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>         = 1;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> mapping_degree = 1;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(3);</div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;2&gt;</a> laplace_problem_2d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_2d.run();</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classStep34_1_1BEMProblem.html">BEMProblem&lt;3&gt;</a> laplace_problem_3d(<a class="code" href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a>, mapping_degree);</div>
<div class="line">      laplace_problem_3d.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespaceStep39_html_a96c639817aca832b553e773b22b70e3c"><div class="ttname"><a href="namespaceStep39.html#a96c639817aca832b553e773b22b70e3c">Step39::exact_solution</a></div><div class="ttdeci">Functions::SlitSingularityFunction&lt; 2 &gt; exact_solution</div><div class="ttdef"><b>Definition:</b> <a href="step-39_8cc_source.html#l00062">step-39.cc:62</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_a1dd48cb744013c448d57f8f77640c08d"><div class="ttname"><a href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">FEValuesBase&lt; dim, dim &gt;::shape_value</a></div><div class="ttdeci">const double &amp; shape_value(const unsigned int function_no, const unsigned int point_no) const</div></div>
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="alac_2solver__gmres_8h_html"><div class="ttname"><a href="lac_2solver__gmres_8h.html">solver_gmres.h</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out__dof__data_8h_source.html#l01096">data_out_dof_data.h:1096</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a91cfbaca954f444047302446a4e87125"><div class="ttname"><a href="classParameterHandler.html#a91cfbaca954f444047302446a4e87125">ParameterHandler::get</a></div><div class="ttdeci">std::string get(const std::string &amp;entry_string) const</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l00987">parameter_handler.cc:987</a></div></div>
<div class="ttc" id="afe_2fe__values_8h_html"><div class="ttname"><a href="fe_2fe__values_8h.html">fe_values.h</a></div></div>
<div class="ttc" id="aclassMappingQ_html"><div class="ttname"><a href="classMappingQ.html">MappingQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2mapping__manifold_8h_source.html#l00033">mapping_manifold.h:33</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ad207fe81a5be05e18534713c2677da7b"><div class="ttname"><a href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data error input in integration This is because in these one typically needs access not only to[2.x.39] locally owned dofs but also to[2.x.40] locally active dofs and sometimes to[2.x.41] locally relevant dofs</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="aevent__0_8txt_html_a60053d8ff825674cfcc1321aba229cd7"><div class="ttname"><a href="event__0_8txt.html#a60053d8ff825674cfcc1321aba229cd7">true</a></div><div class="ttdeci">*Objects of this kind are used to notify interior applications of changes provoked by an outer loop They are handed to the application through[2.x.0] and it is up to the actual application how to handle them Event is organized as an extensible binary enumerator Every class can add its own events using here is how to retrieve it knowing the name generating a clear Event **Clear all flags **Set all flags **Add the flags of the other event **Clear the flags of the other event **Test whether all the flags set in the other Event are also set in this one **Return&lt; tt &gt; true&lt;/tt &gt; if any event is set **List the flags to a stream **List all assigned events actions have to be taken by all means if this value is true</div><div class="ttdef"><b>Definition:</b> <a href="event__0_8txt_source.html#l00028">event_0.txt:28</a></div></div>
<div class="ttc" id="agroup__Iterators_html_ga6b8bbcafed8847f3030ea30c6990eb2d"><div class="ttname"><a href="group__Iterators.html#ga6b8bbcafed8847f3030ea30c6990eb2d">DoFHandler::active_cell_iterator</a></div><div class="ttdeci">typename ActiveSelector::active_cell_iterator active_cell_iterator</div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00366">dof_handler.h:366</a></div></div>
<div class="ttc" id="abase_2smartpointer_8h_html"><div class="ttname"><a href="base_2smartpointer_8h.html">smartpointer.h</a></div></div>
<div class="ttc" id="aclassStep34_1_1BEMProblem_html"><div class="ttname"><a href="classStep34_1_1BEMProblem.html">Step34::BEMProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="step-34_8cc_source.html#l00104">step-34.cc:104</a></div></div>
<div class="ttc" id="aclassFunctions_1_1ParsedFunction_html_a57fd4a680441ae940812431a421c9c40"><div class="ttname"><a href="classFunctions_1_1ParsedFunction.html#a57fd4a680441ae940812431a421c9c40">Functions::ParsedFunction::declare_parameters</a></div><div class="ttdeci">static void declare_parameters(ParameterHandler &amp;prm, const unsigned int n_components=1)</div><div class="ttdef"><b>Definition:</b> <a href="parsed__function_8cc_source.html#l00036">parsed_function.cc:36</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_a8fba07b9a84b89e6be225f5f95c3e355"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a></div><div class="ttdeci">the program is just and one can not intelligently work around that *It is sometimes useful to change the behavior of the[2.x.6] macro from aborting a program to throwing exceptions On the other exceptions are not allowed to propagate out of destructors of classes For this there is a variant of the called[2.x.7] that can be used in destructors These use cases are discussed further down below on this page **Dynamic such as whether an output file can be written to *These are things that shouldn t be checked because it is not guaranteed that a program for which the condition is satisfied in a debug mode run</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00022">exceptions_0.txt:22</a></div></div>
<div class="ttc" id="aclassFE__Q_html"><div class="ttname"><a href="classFE__Q.html">FE_Q</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__q_8h_source.html#l00587">fe_q.h:587</a></div></div>
<div class="ttc" id="astructStaticMappingQ1_html"><div class="ttname"><a href="structStaticMappingQ1.html">StaticMappingQ1</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2mapping__q1_8h_source.html#l00093">mapping_q1.h:93</a></div></div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="doc_2doxygen_2headers_2namespace__dealii_8h_source.html#l00026">namespace_dealii.h:26</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00070">fe_update_flags.h:70</a></div></div>
<div class="ttc" id="aclassGridIn_html_a82ac1c03b0efe87204ad45d2f1d87f7e"><div class="ttname"><a href="classGridIn.html#a82ac1c03b0efe87204ad45d2f1d87f7e">GridIn::attach_triangulation</a></div><div class="ttdeci">void attach_triangulation(Triangulation&lt; dim, spacedim &gt; &amp;tria)</div><div class="ttdef"><b>Definition:</b> <a href="grid__in_8cc_source.html#l00119">grid_in.cc:119</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_a80d39b9aea51af573ded84342b8b330d"><div class="ttname"><a href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">FEValuesBase&lt; dim, dim &gt;::get_normal_vectors</a></div><div class="ttdeci">const std::vector&lt; Tensor&lt; 1, spacedim &gt; &gt; &amp; get_normal_vectors() const</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8cc_source.html#l04150">fe_values.cc:4150</a></div></div>
<div class="ttc" id="ageodynamics__0_8txt_html_a47b3a2cd492d04754f4796002e14ed13"><div class="ttname"><a href="geodynamics__0_8txt.html#a47b3a2cd492d04754f4796002e14ed13">solver</a></div><div class="ttdeci">all others have started as modifications of one of the tutorial programs *The tutorial programs we propose to write will provide students and researchers with a reference implementation of current numerical technology such as higher order sophisticated linear and nonlinear stabilization etc Providing these as starting points for further development by others will also serve the goal of training a new generation of geodynamicists in modern numerical algorithms *In deal it is fairly simple to extend a set of equations by another for example an additional advected quantity that enters the existing equations as a right hand side or in one of the coefficients Since applications typically use blocked matrices rather than the one big matrix for everything it is also not complicated to find suitable linear solvers for augmented equations deal II is a good tool for trying out more complex formulations of or more complete models and their effects on the accuracy of solutions *deal II provides many interchangeable components that allow rapid prototyping of finite element kinds and stabilization or linear solvers For typically only a few lines of code have to be changed to replace low order by high order elements Through it becomes relatively simple to try out higher order a different block elimination solver</div><div class="ttdef"><b>Definition:</b> <a href="geodynamics__0_8txt_source.html#l00033">geodynamics_0.txt:33</a></div></div>
<div class="ttc" id="astep-1_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="step-1_8cc_source.html#l00086">step-1.cc:86</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a6bb45dc67787e3fab7882461929b5fbe"><div class="ttname"><a href="classParameterHandler.html#a6bb45dc67787e3fab7882461929b5fbe">ParameterHandler::get_bool</a></div><div class="ttdeci">bool get_bool(const std::string &amp;entry_name) const</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l01113">parameter_handler.cc:1113</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l01033">tria.h:1033</a></div></div>
<div class="ttc" id="agrid_2tria_8h_html"><div class="ttname"><a href="grid_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_a5873b8f7eeaefb5e7a99005c6c93b175"><div class="ttname"><a href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a></div><div class="ttdeci">and a mapping object that provides the Jacobian as well as its determinant Dealing with all these objects would be cumbersome and error prone *On the other these three kinds of objects almost always appear and it is in fact very rare for deal II application codes to do anything with quadrature</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00019">update_flags_0.txt:19</a></div></div>
<div class="ttc" id="afe_2fe__q_8h_html"><div class="ttname"><a href="fe_2fe__q_8h.html">fe_q.h</a></div></div>
<div class="ttc" id="ampi__remote__point__evaluation__0_8txt_html_a45c57074a631760cdab557f450e880e0"><div class="ttname"><a href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a></div><div class="ttdeci">*Helper class to access values on non matching grids *The name of the fields are chosen with the method quantities are computed at specified arbitrary positioned which receive the result and resort the result according to the points **Constructor[2.x.1] tolerance Tolerance in terms of unit cell coordinates for determining all cells around a point passed to the class during it might be necessary to adjust the tolerance in order to be able to identify a cell Floating point arithmetic implies that a point in not lie exactly on a or face[2.x.2] enforce_unique_mapping Enforce unique mapping</div><div class="ttdef"><b>Definition:</b> <a href="mpi__remote__point__evaluation__0_8txt_source.html#l00005">mpi_remote_point_evaluation_0.txt:5</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a6d65f458be69e23a348221cb67fc411d"><div class="ttname"><a href="classParameterHandler.html#a6d65f458be69e23a348221cb67fc411d">ParameterHandler::declare_entry</a></div><div class="ttdeci">void declare_entry(const std::string &amp;entry, const std::string &amp;default_value, const Patterns::PatternBase &amp;pattern=Patterns::Anything(), const std::string &amp;documentation=&quot;&quot;, const bool has_to_be_set=false)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l00796">parameter_handler.cc:796</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2base_2utilities_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2utilities_8h.html">utilities.h</a></div></div>
<div class="ttc" id="anamespaceStep34_html"><div class="ttname"><a href="namespaceStep34.html">Step34</a></div><div class="ttdef"><b>Definition:</b> <a href="step-34_8cc_source.html#l00056">step-34.cc:56</a></div></div>
<div class="ttc" id="aclassTriangulation_html_a6ad0b3fb24aae17f4668427a433dea19"><div class="ttname"><a href="classTriangulation.html#a6ad0b3fb24aae17f4668427a433dea19">Triangulation::refine_global</a></div><div class="ttdeci">void refine_global(const unsigned int times=1)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l10781">tria.cc:10781</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l02413">patterns.h:2413</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Bool_html"><div class="ttname"><a href="classPatterns_1_1Bool.html">Patterns::Bool</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l01054">patterns.h:1054</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_a676190d2c897ac5da68a9c460fa95832"><div class="ttname"><a href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a></div><div class="ttdeci">void integrate_difference(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const InVector &amp;fe_function, const Function&lt; spacedim, typename InVector::value_type &gt; &amp;exact_solution, OutVector &amp;difference, const Quadrature&lt; dim &gt; &amp;q, const NormType &amp;norm, const Function&lt; spacedim, double &gt; *weight=nullptr, const double exponent=2.)</div></div>
<div class="ttc" id="aclassSphericalManifold_html"><div class="ttname"><a href="classSphericalManifold.html">SphericalManifold</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2manifold__lib_8h_source.html#l00214">manifold_lib.h:214</a></div></div>
<div class="ttc" id="aclassSolverControl_html_a0bb6dc567e07e9f7b0a9d09f801bf149"><div class="ttname"><a href="classSolverControl.html#a0bb6dc567e07e9f7b0a9d09f801bf149">SolverControl::declare_parameters</a></div><div class="ttdeci">static void declare_parameters(ParameterHandler &amp;param)</div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8cc_source.html#l00204">solver_control.cc:204</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_a21eb62d70953182dcc2b15c4e14dd533"><div class="ttname"><a href="namespaceVectorTools.html#a21eb62d70953182dcc2b15c4e14dd533">VectorTools::compute_global_error</a></div><div class="ttdeci">double compute_global_error(const Triangulation&lt; dim, spacedim &gt; &amp;tria, const InVector &amp;cellwise_error, const NormType &amp;norm, const double exponent=2.)</div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a93f65b0385560a34ec1d3c5ec5a882b8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="aparameter__handler__0_8txt_html_ad919e2b915d8e8226aef004c2d8399a8"><div class="ttname"><a href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">exception</a></div><div class="ttdeci">since default values may change in the process of program you cannot know the values of parameters not specified in the input file ****It is often convenient to have something happen as soon as a parameter value is read This could be a check that it is valid that a file that is listed in the parameter file exists **or to initiate something else in such as setting a variable outside the this action could also be initiated once all parameters are read via but it is sometimes[1.x.19] to do it right away *This is facilitated by the and can then do whatever they want with it **e save it somewhere outside the ParameterHandler in C one doesn t usually pass around the address of a but an action can be a function like object(taking a string as argument) that results from calling such as a[1.x.20] that has the form **[1.x.21] *and that is attached to a specific parameter. *A typical example of such an action would be as follows the content of the file equals the default value of the parameter the contents of files are never changed after declaration of a parameter a directory in this file system may not have a file called[2.x.20] in it In that the directory represents a subsection as declared and the directory s name will correspond to the name of the subsection It will then have no files in it at but it may have further directories in the code above will lead to a hierarchical representation of data that looks like this(the content of files is indicated at the right in a different font) this is only used when creating output for exceptions If non empty[2.x.35] is the ParameterHandler object will stop parsing lines after encountering[2.x.36] This is handy when adding extra data that shall be parsed manually If[2.x.37] the parameter handler will skip undefined sections and entries This is useful for partially parsing a parameter for example to obtain only the spatial dimension of the problem By default all entries and subsections are expected to be declared The function sets the value of all parameters it encounters in the input file to the provided value Parameters not explicitly listed in the input file are left at the value they previously which will be the default value provided to and for each parameter all associated actions that may previously have been set by or if an associated action throws an exception</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler__0_8txt_source.html#l00241">parameter_handler_0.txt:241</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="aimmersed__surface__quadrature__0_8txt_html_a360657e6cb44fff4238198db413bb10f"><div class="ttname"><a href="immersed__surface__quadrature__0_8txt.html#a360657e6cb44fff4238198db413bb10f">normals</a></div><div class="ttdeci">*This class defines a quadrature formula for integration over an oriented immersed in the unit cell By immersed it is meant that the surface may intersect the unit cell in an arbitrary way The quadrature formula is described by a set of quadrature and normalized surface normals</div><div class="ttdef"><b>Definition:</b> <a href="immersed__surface__quadrature__0_8txt_source.html#l00002">immersed_surface_quadrature_0.txt:2</a></div></div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00266">dof_handler.h:266</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_a553ca864aaf70330d9be86bc78f36d1e"><div class="ttname"><a href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">DoFHandler::distribute_dofs</a></div><div class="ttdeci">void distribute_dofs(const FiniteElement&lt; dim, spacedim &gt; &amp;fe)</div></div>
<div class="ttc" id="aclassFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00038">fe.h:38</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdeci">@ update_quadrature_points</div><div class="ttdoc">Transformed quadrature points.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00116">fe_update_flags.h:116</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a2cbf5ad6b464871261dbd054bced18a8"><div class="ttname"><a href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">FiniteElementData::degree</a></div><div class="ttdeci">const unsigned int degree</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__base_8h_source.html#l00428">fe_base.h:428</a></div></div>
<div class="ttc" id="anamespaceinternal_1_1TriangulationImplementation_html_a3344398031a9e10cb9eef0784f8da1be"><div class="ttname"><a href="namespaceinternal_1_1TriangulationImplementation.html#a3344398031a9e10cb9eef0784f8da1be">internal::TriangulationImplementation::n_active_cells</a></div><div class="ttdeci">unsigned int n_active_cells(const internal::TriangulationImplementation::NumberCache&lt; 1 &gt; &amp;c)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l12595">tria.cc:12595</a></div></div>
<div class="ttc" id="anumerics_2vector__tools_8h_html"><div class="ttname"><a href="numerics_2vector__tools_8h.html">vector_tools.h</a></div></div>
<div class="ttc" id="aclassPreconditionIdentity_html"><div class="ttname"><a href="classPreconditionIdentity.html">PreconditionIdentity</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2precondition_8h_source.html#l00082">precondition.h:82</a></div></div>
<div class="ttc" id="aclassVector_html_ac4a4dbef7dd65ef8ad35ae56b57d7c05"><div class="ttname"><a href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">Vector::reinit</a></div><div class="ttdeci">virtual void reinit(const size_type N, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="anamespaceStep34_1_1LaplaceKernel_html_a3d34a8c42f74e8deb03c414972af9920"><div class="ttname"><a href="namespaceStep34_1_1LaplaceKernel.html#a3d34a8c42f74e8deb03c414972af9920">Step34::LaplaceKernel::double_layer</a></div><div class="ttdeci">Tensor&lt; 1, dim &gt; double_layer(const Tensor&lt; 1, dim &gt; &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="step-34_8cc_source.html#l00085">step-34.cc:85</a></div></div>
<div class="ttc" id="aclassDataOutInterface_html_acad99726038e4fca7f605fdffb3317e4"><div class="ttname"><a href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">DataOutInterface::write_vtk</a></div><div class="ttdeci">void write_vtk(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07221">data_out_base.cc:7221</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga0d685aad996180f9851183ae3e29019a"><div class="ttname"><a href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">StandardExceptions::ExcIndexRange</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcIndexRange(int arg1, int arg2, int arg3)</div></div>
<div class="ttc" id="abase_2convergence__table_8h_html"><div class="ttname"><a href="base_2convergence__table_8h.html">convergence_table.h</a></div></div>
<div class="ttc" id="aclassTensor_html_afd0934b4edd71063f66a9c67540e79fc"><div class="ttname"><a href="classTensor.html#afd0934b4edd71063f66a9c67540e79fc">Tensor::norm</a></div><div class="ttdeci">numbers::NumberTraits&lt; Number &gt;::real_type norm() const</div></div>
<div class="ttc" id="aclassParameterHandler_html_a61fa98fdc0c52980a5b1de0ee1fc5bb2"><div class="ttname"><a href="classParameterHandler.html#a61fa98fdc0c52980a5b1de0ee1fc5bb2">ParameterHandler::get_integer</a></div><div class="ttdeci">long int get_integer(const std::string &amp;entry_string) const</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l01025">parameter_handler.cc:1025</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdeci">@ update_normal_vectors</div><div class="ttdoc">Normal vectors.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00132">fe_update_flags.h:132</a></div></div>
<div class="ttc" id="aclassSolverGMRES_html"><div class="ttname"><a href="classSolverGMRES.html">SolverGMRES</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__gmres_8h_source.html#l00168">solver_gmres.h:168</a></div></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor&lt; 1, dim &gt;</a></div></div>
<div class="ttc" id="aclassDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="afunction__level__set__0_8txt_html_a4ddc91faf724f1bf45831525942c64a3"><div class="ttname"><a href="function__level__set__0_8txt.html#a4ddc91faf724f1bf45831525942c64a3">center</a></div><div class="ttdeci">*Signed distance level set function of a is the center of the sphere and[2.x.2] is its radius This function is thus zero on the negative inside the ball having the sphere as its and positive in the rest of[2.x.3] This function has gradient and Hessian equal where[2.x.6] is the Kronecker delta function takes the center and radius of the sphere ***The gradient is singular at the center of the sphere If the incoming[2.x.11] is too close to the center</div><div class="ttdef"><b>Definition:</b> <a href="function__level__set__0_8txt_source.html#l00008">function_level_set_0.txt:8</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a30a552b07accf65da90f851e25d14d1c"><div class="ttname"><a href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div><div class="ttdeci">3, where it offers following possibilities:a face(quad) being refined in x- or y-direction(in the face-intern coordinate system) separately,([2.x.79] or([2.x.80] which corresponds to([2.x.81]). Additionally, it offers the possibilities a face can have through repeated anisotropic refinement steps performed on one of the two neighboring cells. It might be possible for example, that a face(quad) is refined with[2.x.82] and afterwards the left child is again refined with[2.x.83], so that there are three active subfaces. Note, however, that only refinement cases are allowed such that each line on a face between two hexes has not more than one hanging node. Furthermore, it is not allowed that two neighboring hexes are refined such that one of the hexes refines the common face with[2.x.84] and the other hex refines that face with[2.x.85] . In fact,[2.x.86] takes care of this situation and ensures that each face of a refined cell is completely contained in a single face of neighboring cells. The following drawings explain the SubfacePossibilities and give the corresponding subface numbers:*[1.x.4] **[2.x.87] *[0.x.68] *Possible cases of faces being subdivided into subface. See documentation to the SubfacePossibilities&lt; 3 &gt; for more details on the subface possibilities. *[0.x.69] *A class that provides all possible cases a face(in the current space dimension[2.x.88] might be subdivided into subfaces. *[2.x.89] *[0.x.70] *Constructor. Take and store a value indicating a particular subface possibility in the list of possible situations specified in the base class. *[0.x.71] *Return the numeric value stored by this class. While the presence of this operator might seem dangerous, it is useful in cases where one would like to have code like&lt; code &gt;switch(subface_case)... case[2.x.90] ...&lt;/code &gt;, which can be written as&lt; code &gt;switch[2.x.91] Another application is to use an object of the current type as an index into an array dim</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00202">geometry_info_0.txt:202</a></div></div>
<div class="ttc" id="aclassQGaussLogR_html"><div class="ttname"><a href="classQGaussLogR.html">QGaussLogR</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00252">quadrature_lib.h:252</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
<div class="ttc" id="aclassFunctions_1_1ParsedFunction_html"><div class="ttname"><a href="classFunctions_1_1ParsedFunction.html">Functions::ParsedFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2parsed__function_8h_source.html#l00077">parsed_function.h:77</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_ae41b67cfd48e02f6035e39c84f0fb47a"><div class="ttname"><a href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">FEValuesBase&lt; dim, dim &gt;::get_quadrature_points</a></div><div class="ttdeci">const std::vector&lt; Point&lt; spacedim &gt; &gt; &amp; get_quadrature_points() const</div></div>
<div class="ttc" id="aclassTensor_html_a7a3169a68a27cc04f2ad1fd9790b874c"><div class="ttname"><a href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">Tensor::norm_square</a></div><div class="ttdeci">constexpr numbers::NumberTraits&lt; Number &gt;::real_type norm_square() const</div></div>
<div class="ttc" id="alac_2solver__control_8h_html"><div class="ttname"><a href="lac_2solver__control_8h.html">solver_control.h</a></div></div>
<div class="ttc" id="anamespaceStep20_1_1PrescribedSolution_html_a6142e18d25af27882714d1787af4ee59"><div class="ttname"><a href="namespaceStep20_1_1PrescribedSolution.html#a6142e18d25af27882714d1787af4ee59">Step20::PrescribedSolution::alpha</a></div><div class="ttdeci">constexpr double alpha</div><div class="ttdef"><b>Definition:</b> <a href="step-20_8cc_source.html#l00087">step-20.cc:87</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_abade89efb068b71b7ced7082012a2441"><div class="ttname"><a href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">FEValuesBase&lt; dim, dim &gt;::JxW</a></div><div class="ttdeci">double JxW(const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="anamespaceVectorTools_html_a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754"><div class="ttname"><a href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa1c3faef4996eebe57acc218bf21d754">VectorTools::L2_norm</a></div><div class="ttdeci">@ L2_norm</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__common_8h_source.html#l00089">vector_tools_common.h:89</a></div></div>
<div class="ttc" id="adofs_2dof__tools_8h_html"><div class="ttname"><a href="dofs_2dof__tools_8h.html">dof_tools.h</a></div></div>
<div class="ttc" id="alac_2precondition_8h_html"><div class="ttname"><a href="lac_2precondition_8h.html">precondition.h</a></div></div>
<div class="ttc" id="agrid_2grid__out_8h_html"><div class="ttname"><a href="grid_2grid__out_8h.html">grid_out.h</a></div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_a03a2f48682e29e39f7bccc11a7d1c4d1"><div class="ttname"><a href="polynomial__space__0_8txt.html#a03a2f48682e29e39f7bccc11a7d1c4d1">degree</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has degree[1.x.4]</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00003">polynomial_space_0.txt:3</a></div></div>
<div class="ttc" id="abase_2quadrature__lib_8h_html"><div class="ttname"><a href="base_2quadrature__lib_8h.html">quadrature_lib.h</a></div></div>
<div class="ttc" id="agrid_2manifold__lib_8h_html"><div class="ttname"><a href="grid_2manifold__lib_8h.html">manifold_lib.h</a></div></div>
<div class="ttc" id="aclassStep34_1_1BEMProblem_html_a9e7bc122afd983144f27ea9c28eb6d68"><div class="ttname"><a href="classStep34_1_1BEMProblem.html#a9e7bc122afd983144f27ea9c28eb6d68">Step34::BEMProblem::BEMProblem</a></div><div class="ttdeci">BEMProblem(const unsigned int fe_degree=1, const unsigned int mapping_degree=1)</div><div class="ttdef"><b>Definition:</b> <a href="step-34_8cc_source.html#l00170">step-34.cc:170</a></div></div>
<div class="ttc" id="aclassQuadratureSelector_html"><div class="ttname"><a href="classQuadratureSelector.html">QuadratureSelector</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__selector_8h_source.html#l00043">quadrature_selector.h:43</a></div></div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_a8f384576a64c89a6fa8352847523e340"><div class="ttname"><a href="fe__evaluation__0_8txt.html#a8f384576a64c89a6fa8352847523e340">n_q_points</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for n_q_points</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00537">fe_evaluation_0.txt:537</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdeci">@ update_JxW_values</div><div class="ttdoc">Transformed quadrature weights.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00124">fe_update_flags.h:124</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="alac_2full__matrix_8h_html"><div class="ttname"><a href="lac_2full__matrix_8h.html">full_matrix.h</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_a357b422e374f2f2207af3512093f3907"><div class="ttname"><a href="classFEValuesBase.html#a357b422e374f2f2207af3512093f3907">FEValuesBase&lt; dim, dim &gt;::get_function_values</a></div><div class="ttdeci">void get_function_values(const InputVector &amp;fe_function, std::vector&lt; typename InputVector::value_type &gt; &amp;values) const</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8cc_source.html#l03523">fe_values.cc:3523</a></div></div>
<div class="ttc" id="anamespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga5b35a290aa7dd7562911a92a13b11fee"><div class="ttname"><a href="group__Exceptions.html#ga5b35a290aa7dd7562911a92a13b11fee">FiniteElement::get_unit_support_points</a></div><div class="ttdeci">const std::vector&lt; Point&lt; dim &gt; &gt; &amp; get_unit_support_points() const</div><div class="ttdef"><b>Definition:</b> <a href="fe_8cc_source.html#l01049">fe.cc:1049</a></div></div>
<div class="ttc" id="adofs_2dof__handler_8h_html"><div class="ttname"><a href="dofs_2dof__handler_8h.html">dof_handler.h</a></div></div>
<div class="ttc" id="aclassGridIn_html"><div class="ttname"><a href="classGridIn.html">GridIn</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__in_8h_source.html#l00248">grid_in.h:248</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a8ae36952c7e0cc778b47b5371b3aeff1"><div class="ttname"><a href="namespacenumbers.html#a8ae36952c7e0cc778b47b5371b3aeff1">numbers::invalid_unsigned_int</a></div><div class="ttdeci">static const unsigned int invalid_unsigned_int</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00179">types.h:179</a></div></div>
<div class="ttc" id="astep-69_8cc_html_a66a64d07b4db87c87b639bdcf7b18c82"><div class="ttname"><a href="step-69_8cc.html#a66a64d07b4db87c87b639bdcf7b18c82">local_dof_indices</a></div><div class="ttdeci">std::vector&lt; types::global_dof_index &gt; local_dof_indices</div><div class="ttdef"><b>Definition:</b> <a href="step-69_8cc_source.html#l00534">step-69.cc:534</a></div></div>
<div class="ttc" id="alac_2vector_8h_html"><div class="ttname"><a href="lac_2vector_8h.html">vector.h</a></div></div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_ad3b9cdeadeb3bcdb52af5db70c041a6e"><div class="ttname"><a href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **Constructor Takes all data stored in MatrixFree If applied to problems with more than one finite element or more than one quadrature formula selected during construction of[2.x.343] the appropriate component can be selected by the optional arguments[2.x.344] matrix_free Data object that contains all data[2.x.345] dof_no If matrix_free was set up with multiple DoFHandler this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.346] quad_no If matrix_free was set up with multiple Quadrature this parameter selects the appropriate number of the quadrature formula[2.x.347] first_selected_component If the dof_handler selected by dof_no uses an FESystem consisting of more than one this parameter allows for selecting the component where the current evaluation routine should start Note that one evaluator does not support combining different shape functions in different components In other the same base element of a FESystem needs to be set for the components between[2.x.348] and[2.x.349][2.x.350] active_fe_index If matrix_free was set up with DoFHandler objects with[2.x.351] this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.352] active_quad_index If matrix_free was set up with[2.x.353] this parameter selects the appropriate number of the quadrature formula **Constructor Takes all data stored in MatrixFree for a given cell which allows to automatically identify the active_fe_index and active_quad_index in case of a p adaptive strategy The rest of the arguments are the same as in the constructor above **Constructor that comes with reduced functionality and works similar as FEValues The arguments are similar to the ones passed to the constructor of with the notable difference that FEEvaluation expects a one dimensional quadrature instead of a[2.x.354] dimensional one The finite element can be both scalar or vector but this method always only selects a scalar base element at a the optional argument[2.x.356] allows to specify the index of the base element to be used for evaluation Note that the internal data structures always assume that the base element is non primitive are not supported currently As known from a call to the reinit method with a[2.x.357] is necessary to make the geometry and degrees of freedom of the current class known::If the iterator includes DoFHandler the initialization allows to also read from or write to vectors in the standard way for[2.x.359] types for one cell at a time this approach is much slower than the path with MatrixFree with MPI since index translation has to be done As only one cell at a time is this method does not vectorize over several but only possibly within the element if the evaluate integrate routines are combined inside user an object of type i the underlying mapping and quadrature points do only need to be evaluated once Make sure to not pass an optional object around when you intend to use the FEEvaluation object in parallel to the given one because otherwise the intended sharing may create race conditions **Copy constructor If FEEvaluationBase was constructed from a fe</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00555">fe_evaluation_0.txt:555</a></div></div>
<div class="ttc" id="aclassFEValuesBase_html_a807c3049bfe81743fc0f237dfc2fbdea"><div class="ttname"><a href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">FEValuesBase&lt; dim, dim &gt;::n_quadrature_points</a></div><div class="ttdeci">const unsigned int n_quadrature_points</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02405">fe_values.h:2405</a></div></div>
<div class="ttc" id="aclassParameterHandler_html"><div class="ttname"><a href="classParameterHandler.html">ParameterHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2parameter__handler_8h_source.html#l00820">parameter_handler.h:820</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_af29c20cde6d44186806d559beb468696"><div class="ttname"><a href="classParameterHandler.html#af29c20cde6d44186806d559beb468696">ParameterHandler::enter_subsection</a></div><div class="ttdeci">void enter_subsection(const std::string &amp;subsection)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l00939">parameter_handler.cc:939</a></div></div>
<div class="ttc" id="aclassFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ad83f9d9d8b603ed71c3483de199bc7a7"><div class="ttname"><a href="coding__conventions__0_8txt.html#ad83f9d9d8b603ed71c3483de199bc7a7">in</a></div><div class="ttdeci">their purpose is merely to keepdeal II as uniform as possible Uniformity reduces the number of bugs weproduce because we for always assume that input arguments comebefore output arguments of a function call They also simplify reading codebecause some things become clear already by looking at the style a piece ofcode is without having to look up the exact definition of something **deal II uses[2.x.2] to normalize indentation Astyle file is provided at ***Before a you should run **on each of your files This will make sure indentation is conforming to thestyle guidelines outlined in this page *This is cumbersome and more you can just run **in whatever directory you set up the library to be compiled in</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00013">coding_conventions_0.txt:13</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed"><div class="ttname"><a href="group__Exceptions.html#gae1ef1c23deebd739950f52b0740ecaaba18773d481c366b3c7500bb5220eb03ed">ConvergenceTable::reduction_rate_log2</a></div><div class="ttdeci">@ reduction_rate_log2</div><div class="ttdef"><b>Definition:</b> <a href="base_2convergence__table_8h_source.html#l00084">convergence_table.h:84</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="ascalapack__0_8txt_html_abc6ecee32660d1fa6d6157325220179a"><div class="ttname"><a href="scalapack__0_8txt.html#abc6ecee32660d1fa6d6157325220179a">index</a></div><div class="ttdeci">[2.x.71] and column index=[2.x.72] . **************- The global row and column index of the first element of the submatrix B is provided by[2.x.73] with row index=[2.x.74] and column index=[2.x.75] . **************- The dimension of the submatrix to be copied is given by[2.x.76] with number of rows=[2.x.77] and number of columns=[2.x.78] . If it is necessary to copy complete matrices with an identical block-cyclic distribution, use[2.x.79] &amp;dest) with only one argument to avoid communication. The underlying process grids of the matrices[2.x.80] and[2.x.81] must have been built with the same MPI communicator. *[0.x.17] *Transposing assignment:[2.x.82] The matrices[2.x.83] and[2.x.84] must have the same process grid. The following alignment conditions have to be fulfilled:[2.x.85] and[2.x.86] . *[0.x.18] *The operations based on the input parameter[2.x.87] and the alignment conditions are summarized in the following table:|transpose_B|Block Sizes|Operation||:---------:|:--------------------------:|:-------------------------------------------:||false|[2.x.88][2.x.89][2.x.90]|[2.x.91]||true|[2.x.92][2.x.93][2.x.94]|[2.x.95]|The matrices[2.x.96] and[2.x.97] must have the same process grid. *[0.x.19] *Matrix-addition:[2.x.98] The matrices[2.x.99] and[2.x.100] must have the same process grid. The following alignment conditions have to be fulfilled:[2.x.101] and[2.x.102] . *[0.x.20] *Matrix-addition:[2.x.103] The matrices[2.x.104] and[2.x.105] must have the same process grid. The following alignment conditions have to be fulfilled:[2.x.106] and[2.x.107] . *[0.x.21] *Matrix-matrix-multiplication:The operations based on the input parameters and the alignment conditions are summarized in the following table:|transpose_A|transpose_B|Block Sizes|Operation||:---------:|:---------:|:-------------------------------------------:|:-------------------------------------------------------------:||false|false|[2.x.108][2.x.109][2.x.110][2.x.111][2.x.112]|[2.x.113]||false|true|[2.x.114][2.x.115][2.x.116][2.x.117][2.x.118]|[2.x.119]||true|false|[2.x.120][2.x.121][2.x.122][2.x.123][2.x.124]|[2.x.125]||true|true|[2.x.126][2.x.127][2.x.128][2.x.129][2.x.130]|[2.x.131]|It is assumed that[2.x.132] and[2.x.133] have compatible sizes and that[2.x.134] already has the right size. The matrices[2.x.135],[2.x.136] and[2.x.137] must have the same process grid. *[0.x.22] *Matrix-matrix-multiplication. The optional parameter[2.x.138] determines whether the result is stored in[2.x.139] or added to[2.x.140] . if([2.x.141][2.x.142] else[2.x.143] It is assumed that[2.x.144] and[2.x.145] have compatible sizes and that[2.x.146] already has the right size. The following alignment conditions have to be fulfilled:[2.x.147],[2.x.148] and[2.x.149] . *[0.x.23] *Matrix-matrix-multiplication using transpose of[2.x.150] . The optional parameter[2.x.151] determines whether the result is stored in[2.x.152] or added to[2.x.153] . if([2.x.154][2.x.155] else[2.x.156] It is assumed that[2.x.157] and[2.x.158] have compatible sizes and that[2.x.159] already has the right size. The following alignment conditions have to be fulfilled:[2.x.160],[2.x.161] and[2.x.162] . *[0.x.24] *Matrix-matrix-multiplication using the transpose of[2.x.163] . The optional parameter[2.x.164] determines whether the result is stored in[2.x.165] or added to[2.x.166] . if([2.x.167][2.x.168] else[2.x.169] It is assumed that[2.x.170] and[2.x.171] have compatible sizes and that[2.x.172] already has the right size. The following alignment conditions have to be fulfilled:[2.x.173],[2.x.174] and[2.x.175] . *[0.x.25] *Matrix-matrix-multiplication using transpose of[2.x.176] and[2.x.177] . The optional parameter[2.x.178] determines whether the result is stored in[2.x.179] or added to[2.x.180] . if([2.x.181][2.x.182] else[2.x.183] It is assumed that[2.x.184] and[2.x.185] have compatible sizes and that[2.x.186] already has the right size. The following alignment conditions have to be fulfilled:[2.x.187],[2.x.188] and[2.x.189] . *[0.x.26] *Stores the distributed matrix in[2.x.190] using HDF5. In case that deal.II was built without HDF5 a call to this function will cause an exception to be thrown. If HDF5 was built with MPI, parallel I/O is used to save the matrix. Otherwise, just one process will do the output. This means that internally the distributed matrix is copied to one process, which does the output. Therefore, the matrix has to fit into the memory of one process. To tweak the I/O performance, especially for parallel I/O, the user may define the optional parameter[2.x.191] All MPI processes need to call the function with the same value. The matrix is written in chunks to the file, therefore the properties of the system define the optimal chunk size. Internally, HDF5 splits the matrix into&lt; tt &gt;chunk_size.first&lt;/tt &gt; x&lt; tt &gt;chunk_size.second&lt;/tt &gt; sized blocks, with&lt; tt &gt;chunk_size.first&lt;/tt &gt; being the number of rows of a chunk and&lt; tt &gt;chunk_size.second&lt;/tt &gt; the number of columns. *[0.x.27] *Loads the distributed matrix from file[2.x.192] using HDF5. In case that deal.II was built without HDF5 a call to this function will cause an exception to be thrown. The matrix must have the same dimensions as the matrix stored in the file. If HDF5 was build with MPI, parallel I/O is used to load the matrix. Otherwise, just one process will load the matrix from storage and distribute the content to the other processes subsequently. *[0.x.28] *Compute the Cholesky factorization of the matrix using ScaLAPACK function[2.x.193] . The result of the factorization is stored in this object. *[0.x.29] *Compute the LU factorization of the matrix using ScaLAPACK function[2.x.194] and partial pivoting with row interchanges. The result of the factorization is stored in this object. *[0.x.30] *Invert the matrix by first computing a Cholesky for symmetric matrices or a LU factorization for general matrices and then building the actual inverse using[2.x.195] or[2.x.196] . If the matrix is triangular, the LU factorization step is skipped, and[2.x.197] is used directly. If a Cholesky or LU factorization has been applied previously,[2.x.198] are called directly. The inverse is stored in this object. *[0.x.31] *Computing selected eigenvalues and, optionally, the eigenvectors of the real symmetric matrix[2.x.199] . The eigenvalues/eigenvectors are selected by prescribing a range of indices[2.x.200] If successful, the computed eigenvalues are arranged in ascending order. The eigenvectors are stored in the columns of the matrix, thereby overwriting the original content of the matrix. If all eigenvalues/eigenvectors have to be computed, pass the closed interval[2.x.201] in[2.x.202] Pass the closed interval[2.x.203] if the[2.x.204] largest eigenvalues/eigenvectors are desired. *[0.x.32] *Computing selected eigenvalues and, optionally, the eigenvectors. The eigenvalues/eigenvectors are selected by prescribing a range of values[2.x.205] for the eigenvalues. If successful, the computed eigenvalues are arranged in ascending order. The eigenvectors are stored in the columns of the matrix, thereby overwriting the original content of the matrix. *[0.x.33] *Computing selected eigenvalues and, optionally, the eigenvectors of the real symmetric matrix[2.x.206] using the MRRR algorithm. The eigenvalues/eigenvectors are selected by prescribing a range of indices[2.x.207] If successful, the computed eigenvalues are arranged in ascending order. The eigenvectors are stored in the columns of the matrix, thereby overwriting the original content of the matrix. If all eigenvalues/eigenvectors have to be computed, pass the closed interval[2.x.208] in[2.x.209] Pass the closed interval[2.x.210] if the[2.x.211] largest eigenvalues/eigenvectors are desired. *[0.x.34] *Computing selected eigenvalues and, optionally, the eigenvectors of the real symmetric matrix[2.x.212] using the MRRR algorithm. The eigenvalues/eigenvectors are selected by prescribing a range of values[2.x.213] for the eigenvalues. If successful, the computed eigenvalues are arranged in ascending order. The eigenvectors are stored in the columns of the matrix, thereby overwriting the original content of the matrix. *[0.x.35] *Computing the singular value decomposition(SVD) of a matrix[2.x.214], optionally computing the left and/or right singular vectors. The SVD is written as[2.x.215] with[2.x.216] as a diagonal matrix,[2.x.217] and[2.x.218] as orthogonal matrices. The diagonal elements of[2.x.219] are the singular values of[2.x.220] and the columns of[2.x.221] and[2.x.222] are the corresponding left and right singular vectors, respectively. The singular values are returned in decreasing order and only the first[2.x.223] columns of[2.x.224] and rows of[2.x.225] are computed. Upon return the content of the matrix is unusable. The matrix[2.x.226] must have identical block cyclic distribution for the rows and column. If left singular vectors are required matrices[2.x.227] and[2.x.228] have to be constructed with the same process grid and block cyclic distribution. If right singular vectors are required matrices[2.x.229] and[2.x.230] have to be constructed with the same process grid and block cyclic distribution. To avoid computing the left and/or right singular vectors the function accepts[2.x.231] for[2.x.232] and/or[2.x.233] *[0.x.36] *Solving overdetermined or underdetermined real linear systems involving matrix[2.x.234], or its transpose[2.x.235], using a QR or LQ factorization of[2.x.236] for[2.x.237] RHS vectors in the columns of matrix[2.x.238] It is assumed that[2.x.239] has full rank:[2.x.240] . The following options are supported:********- If(!transpose) and[2.x.241] :least squares solution of overdetermined system[2.x.242] .\n Upon exit the rows[2.x.243] to[2.x.244] of[2.x.245] contain the least square solution vectors. The residual sum of squares for each column is given by the sum of squares of elements[2.x.246] to[2.x.247] in that column. **************- If(!transpose) and[2.x.248] :find minimum norm solutions of underdetermined systems[2.x.249] .\n Upon exit the columns of[2.x.250] contain the minimum norm solution vectors. **************- If(transpose) and[2.x.251] :find minimum norm solutions of underdetermined system[2.x.252] .\n Upon exit the columns of[2.x.253] contain the minimum norm solution vectors. **************- If(transpose) and[2.x.254] :least squares solution of overdetermined system[2.x.255] .\n Upon exit the rows[2.x.256] to[2.x.257] contain the least square solution vectors. The residual sum of squares for each column is given by the sum of squares of elements[2.x.258] to[2.x.259] in that column. If(!tranpose) then[2.x.260], otherwise[2.x.261] . The matrices[2.x.262] and[2.x.263] must have an identical block cyclic distribution for rows and columns. *[0.x.37] *Compute the pseudoinverse[2.x.264](Moore-Penrose inverse) of a real matrix[2.x.265] using the singular value decomposition[2.x.266] . Unlike the inverse, the pseudoinverse[2.x.267] exists for both rectangular as well as singular matrices[2.x.268] . For a rectangular[2.x.269] the pseudoinverse is computed by taking the reciprocal of each non-zero element on the diagonal, leaving the zeros in place, and then transposing[2.x.270] . For the numerical computation only the singular values[2.x.271] are taken into account. Upon successful exit, the function returns the number of singular values fulfilling that condition. That value can be interpreted as the rank of[2.x.272] . Upon return this object contains the pseudoinverse[2.x.273] . The following alignment conditions have to be fulfilled:[2.x.274] . *[0.x.38] *Estimate the condition number of a SPD matrix in the[2.x.275] -norm. The matrix has to be in the Cholesky state(see compute_cholesky_factorization()). The reciprocal of the condition number is returned in order to avoid the possibility of overflow when the condition number is very large.[2.x.276] must contain the[2.x.277] -norm of the matrix prior to calling Cholesky factorization(see l1_norm()). *[2.x.278] An alternative is to compute the inverse of the matrix explicitly and manually construct[2.x.279] . *[0.x.39] *Compute the[2.x.280] -norm of the matrix. *[0.x.40] *Compute the[2.x.281] norm of the matrix. *[0.x.41] *Compute the Frobenius norm of the matrix. *[0.x.42] *Number of rows of the[2.x.282] matrix. *[0.x.43] *Number of columns of the[2.x.283] matrix. *[0.x.44] *Number of local rows on this MPI processes. *[0.x.45] *Number of local columns on this MPI process. *[0.x.46] *Return the global row number for the given local row[2.x.284] . *[0.x.47] *Return the global column number for the given local column[2.x.285] *[0.x.48] *Read access to local element. *[0.x.49] *Write access to local element. *[0.x.50] *Scale the columns of the distributed matrix by the scalars provided in the array[2.x.286] The array[2.x.287] must have as many entries as the matrix columns. Copies of[2.x.288] have to be available on all processes of the underlying MPI communicator. *[2.x.289] The fundamental prerequisite for the[2.x.290] is that it must be possible to create an ArrayView from it index</div><div class="ttdef"><b>Definition:</b> <a href="scalapack__0_8txt_source.html#l00250">scalapack_0.txt:250</a></div></div>
<div class="ttc" id="aclassSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2solver__control_8h_source.html#l00052">solver_control.h:52</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Selection_html"><div class="ttname"><a href="classPatterns_1_1Selection.html">Patterns::Selection</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l00400">patterns.h:400</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa9e3f2944ebdadf4409dc11f8fc0afe14"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa9e3f2944ebdadf4409dc11f8fc0afe14">update_jacobians</a></div><div class="ttdeci">@ update_jacobians</div><div class="ttdoc">Volume element.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00139">fe_update_flags.h:139</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_ac00ea19562c135512a6ff275a3cf0d8f"><div class="ttname"><a href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has this class generates all dim dimensional polynomials of the where the sum and[1.x.8] is less than or equal *[1.x.9] The i e for each dim dimensional polynomial in the polynomial space it gives the indices j</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00004">polynomial_space_0.txt:4</a></div></div>
<div class="ttc" id="amg__0_8txt_html_a1dadc108ee1520717957789de4b76416"><div class="ttname"><a href="mg__0_8txt.html#a1dadc108ee1520717957789de4b76416">cycle</a></div><div class="ttdeci">****Classes that have to do with multigrid algorithms *The main class with implementation of the multigrid scheme is Multigrid with its function[2.x.1] It uses the abstract following classes in order to perform the multigrid cycle</div><div class="ttdef"><b>Definition:</b> <a href="mg__0_8txt_source.html#l00007">mg_0.txt:7</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_aa6418ea655b1b550b9dcf63513030196"><div class="ttname"><a href="classParameterHandler.html#aa6418ea655b1b550b9dcf63513030196">ParameterHandler::set</a></div><div class="ttdeci">void set(const std::string &amp;entry_name, const std::string &amp;new_value)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l01152">parameter_handler.cc:1152</a></div></div>
<div class="ttc" id="afe_2mapping__q_8h_html"><div class="ttname"><a href="fe_2mapping__q_8h.html">mapping_q.h</a></div></div>
<div class="ttc" id="agrid_2grid__in_8h_html"><div class="ttname"><a href="grid_2grid__in_8h.html">grid_in.h</a></div></div>
<div class="ttc" id="abase_2quadrature__selector_8h_html"><div class="ttname"><a href="base_2quadrature__selector_8h.html">quadrature_selector.h</a></div></div>
<div class="ttc" id="anamespaceDoFTools_html_a5514e4f59ea659f63953d62ca429eaff"><div class="ttname"><a href="namespaceDoFTools.html#a5514e4f59ea659f63953d62ca429eaff">DoFTools::map_dofs_to_support_points</a></div><div class="ttdeci">void map_dofs_to_support_points(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, std::vector&lt; Point&lt; spacedim &gt;&gt; &amp;support_points, const ComponentMask &amp;mask=ComponentMask())</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8cc_source.html#l02222">dof_tools.cc:2222</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a599462cacd492e2f712bf7369507dcff"><div class="ttname"><a href="classParameterHandler.html#a599462cacd492e2f712bf7369507dcff">ParameterHandler::leave_subsection</a></div><div class="ttdeci">void leave_subsection()</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l00953">parameter_handler.cc:953</a></div></div>
<div class="ttc" id="aA-headers_2manifold__0_8txt_html_adeaaf04b7a13c42b6a6c7ff87ce84306"><div class="ttname"><a href="A-headers_2manifold__0_8txt.html#adeaaf04b7a13c42b6a6c7ff87ce84306">ones</a></div><div class="ttdeci">*****The classes in this module are concerned with the description of the manifold in which the domain that a Triangulation describes lives This manifold description is necessary in several it is necessary to introduce new vertices in the Triangulation In the simplest one assumes that the objects that make up the Triangulation are straight line a bi linear surface or a tri linear volume The next vertex is then simply put into the middle of the old ones(where &quot;middle&quot; means a suitable average of the locations of the pre-existing vertices). This is the default behavior of the Triangulation class</div></div>
<div class="ttc" id="anumerics_2data__out_8h_html"><div class="ttname"><a href="numerics_2data__out_8h.html">data_out.h</a></div></div>
<div class="ttc" id="aclassQuadrature_html"><div class="ttname"><a href="classQuadrature.html">Quadrature</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2quadrature_8h_source.html#l00075">quadrature.h:75</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a33b522422da89e5c080e7405ad49d7c7"><div class="ttname"><a href="classFiniteElementData.html#a33b522422da89e5c080e7405ad49d7c7">FiniteElementData::n_dofs_per_cell</a></div><div class="ttdeci">unsigned int n_dofs_per_cell() const</div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut&lt; dim &gt;</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="base_2numbers_8h_source.html#l00237">numbers.h:237</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_a66b432045b82ed9b1c850f6407d4b1ca"><div class="ttname"><a href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if fe_degree</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00537">fe_evaluation_0.txt:537</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassConvergenceTable_html"><div class="ttname"><a href="classConvergenceTable.html">ConvergenceTable</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2convergence__table_8h_source.html#l00054">convergence_table.h:54</a></div></div>
<div class="ttc" id="aclassParameterHandler_html_a0ddaa05c5463c6c0b7701e18005717a9"><div class="ttname"><a href="classParameterHandler.html#a0ddaa05c5463c6c0b7701e18005717a9">ParameterHandler::parse_input</a></div><div class="ttdeci">virtual void parse_input(std::istream &amp;input, const std::string &amp;filename=&quot;input file&quot;, const std::string &amp;last_line=&quot;&quot;, const bool skip_undefined=false)</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler_8cc_source.html#l00399">parameter_handler.cc:399</a></div></div>
<div class="ttc" id="abase_2parsed__function_8h_html"><div class="ttname"><a href="base_2parsed__function_8h.html">parsed_function.h</a></div></div>
<div class="ttc" id="agrid__0_8txt_html_abc4bc3849dde2110dfa9e18bf7ae1b8c"><div class="ttname"><a href="grid__0_8txt.html#abc4bc3849dde2110dfa9e18bf7ae1b8c">file</a></div><div class="ttdeci">triangles and tetrahedra are not supported *This collection of cells is managed by the Triangulation class and derived classes such as[2.x.1] and[2.x.2] It holds the relevant data in memory and offers interfaces to query it Most things you want to do on cells are performed in loops over all cells For this the Triangulation class offers the concept of iterators(see[2.x.3])[2.x.7] Reading from a file</div><div class="ttdef"><b>Definition:</b> <a href="grid__0_8txt_source.html#l00007">grid_0.txt:7</a></div></div>
<div class="ttc" id="agrid_2grid__generator_8h_html"><div class="ttname"><a href="grid_2grid__generator_8h.html">grid_generator.h</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_aa5b8d3c4b9deb0774dde5c2851e07e1e"><div class="ttname"><a href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">DoFHandler::n_dofs</a></div><div class="ttdeci">types::global_dof_index n_dofs() const</div></div>
<div class="ttc" id="amapping__q__generic__0_8txt_html_a4c0fe461b64bd7f9780546240681dc41"><div class="ttname"><a href="mapping__q__generic__0_8txt.html#a4c0fe461b64bd7f9780546240681dc41">manifold</a></div><div class="ttdeci">a full discussion of manifolds is provided in *[2.x.8] ***If you are working on meshes that describe i if then every cell is at the boundary of the domain you will likely already have attached a manifold object to all cells that can then also be used by the mapping classes for higher order mappings **As described one often only knows a manifold description of a surface but not the interior of the computational domain In such a a FlatManifold object will be assigned to the interior entities that describes a usual planar coordinate system where the additional points for the higher order mapping are placed exactly according to a bi trilinear mapping When combined with a non flat manifold on the for example a circle bulging into the interior of a square the two manifold descriptions are in general incompatible For a FlatManifold defined solely through the cell s vertices would put an interior point located at some small distance epsilon away from the boundary along a straight line and thus in general outside the concave part of a circle If the polynomial degree of MappingQ is sufficiently the transformation from the reference cell to such a cell would in general contain inverted regions close to the boundary *In order to avoid this this class applies an algorithm for making this transition smooth using a so called transfinite interpolation that is essentially a linear blend between the descriptions along the surrounding entities In the algorithm that computes additional points the all the entities of the cells are passed through starting from the lines to the quads and finally hexes Points on objects higher up in the hierarchy are obtained from the manifold associated with that taking into account all the points previously computed by the manifolds associated with the lower dimensional not just the vertices If only a line is assigned a curved boundary but the adjacent quad is on a flat manifold</div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__generic__0_8txt_source.html#l00019">mapping_q_generic_0.txt:19</a></div></div>
<div class="ttc" id="anamespaceStep34_1_1LaplaceKernel_html_a497b8b8e5442be8b6ebd22475129dec7"><div class="ttname"><a href="namespaceStep34_1_1LaplaceKernel.html#a497b8b8e5442be8b6ebd22475129dec7">Step34::LaplaceKernel::single_layer</a></div><div class="ttdeci">double single_layer(const Tensor&lt; 1, dim &gt; &amp;R)</div><div class="ttdef"><b>Definition:</b> <a href="step-34_8cc_source.html#l00066">step-34.cc:66</a></div></div>
<div class="ttc" id="aclassPatterns_1_1Integer_html"><div class="ttname"><a href="classPatterns_1_1Integer.html">Patterns::Integer</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l00198">patterns.h:198</a></div></div>
<div class="ttc" id="agroup__dofs_html_ga768cd565b5c25f1ac235586e36ac94d6"><div class="ttname"><a href="group__dofs.html#ga768cd565b5c25f1ac235586e36ac94d6">hp::DoFHandler</a></div><div class="ttdeci">::DoFHandler&lt; dim, spacedim &gt; DoFHandler</div><div class="ttdef"><b>Definition:</b> <a href="hp_2dof__handler_8h_source.html#l00066">dof_handler.h:66</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
