<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/smoothness__estimator_8cc_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: source/numerics/smoothness_estimator.cc Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_c371c8e3c4a27917e93effe7d4bd6cc8.html">numerics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">smoothness_estimator.cc</div>  </div>
</div><!--header-->
<div class="contents">
<a href="smoothness__estimator_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">// Copyright (C) 2018 - 2021 by the deal.II authors</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2quadrature_8h.html">deal.II/base/quadrature.h</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="base_2signaling__nan_8h.html">deal.II/base/signaling_nan.h</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__series_8h.html">deal.II/fe/fe_series.h</a>&gt;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="hp_2dof__handler_8h.html">deal.II/hp/dof_handler.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="hp_2q__collection_8h.html">deal.II/hp/q_collection.h</a>&gt;</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2block__vector_8h.html">deal.II/lac/block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__block__vector_8h.html">deal.II/lac/la_parallel_block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2la__vector_8h.html">deal.II/lac/la_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2petsc__block__vector_8h.html">deal.II/lac/petsc_block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2petsc__vector_8h.html">deal.II/lac/petsc_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2trilinos__epetra__vector_8h.html">deal.II/lac/trilinos_epetra_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2trilinos__parallel__block__vector_8h.html">deal.II/lac/trilinos_parallel_block_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2trilinos__vector_8h.html">deal.II/lac/trilinos_vector.h</a>&gt;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="lac_2vector_8h.html">deal.II/lac/vector.h</a>&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="numerics_2smoothness__estimator_8h.html">deal.II/numerics/smoothness_estimator.h</a>&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &lt;algorithm&gt;</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;limits&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;utility&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160; </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160; </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceSmoothnessEstimator.html">SmoothnessEstimator</a></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keyword">namespace</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  {</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> CoefficientType&gt;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <a class="code" href="table__0_8txt.html#af635aebc3d99e710d018581b47f69a15">resize</a>(<a class="code" href="classTable.html">Table&lt;dim, CoefficientType&gt;</a> &amp;coeff, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>++)</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      coeff.reinit(<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  } <span class="comment">// namespace</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160; </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160; </div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keyword">namespace </span>Legendre</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">namespace</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;      <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      std::pair&lt;bool, unsigned int&gt;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      index_sum_less_than_N(<span class="keyword">const</span> <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> &amp;ind, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>)</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;          <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> += ind[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <span class="keywordflow">return</span> std::make_pair((<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>), <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    } <span class="comment">// namespace</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim, <span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="namespaceSmoothnessEstimator_1_1Legendre.html#af6d025a69f8a4d1e9fc5914e5d648463">  100</a></span>&#160;    <a class="code" href="namespaceSmoothnessEstimator_1_1Legendre.html#af6d025a69f8a4d1e9fc5914e5d648463">coefficient_decay</a>(<a class="code" href="classFESeries_1_1Legendre.html">FESeries::Legendre&lt;dim, spacedim&gt;</a> &amp;fe_legendre,</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;                      <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp;  dof_handler,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                      <span class="keyword">const</span> VectorType &amp;                 <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                      <a class="code" href="classVector.html">Vector&lt;float&gt;</a> &amp;                    smoothness_indicators,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                      <span class="keyword">const</span> <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1">VectorTools::NormType</a>        regression_strategy,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> smallest_abs_coefficient,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">bool</span>   only_flagged_cells)</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    {</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;      <span class="keyword">using</span> <a class="code" href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a> = <span class="keyword">typename</span> VectorType::value_type;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;      <span class="keyword">using</span> number_coeff =</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keyword">typename</span> <a class="code" href="classFESeries_1_1Legendre.html#a345a0ac48c40e9e321b7e4cbe2673bbb">FESeries::Legendre&lt;dim, spacedim&gt;::CoefficientType</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      smoothness_indicators.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        dof_handler.get_triangulation().n_active_cells());</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_modes;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <a class="code" href="classTable.html">Table&lt;dim, number_coeff&gt;</a> expansion_coefficients;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="classVector.html">Vector&lt;number&gt;</a>      local_dof_values;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      std::vector&lt;double&gt; converted_indices;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;      std::pair&lt;std::vector&lt;unsigned int&gt;, std::vector&lt;double&gt;&gt; res;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">if</span> (!only_flagged_cells || <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;refine_flag_set() ||</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;              {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                n_modes = fe_legendre.<a class="code" href="classFESeries_1_1Legendre.html#aa9a1bd0dbb9e5e4e3984d7feb36d7f40">get_n_coefficients_per_direction</a>(</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                  <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <a class="code" href="table__0_8txt.html#af635aebc3d99e710d018581b47f69a15">resize</a>(expansion_coefficients, n_modes);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                local_dof_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, local_dof_values);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                fe_legendre.<a class="code" href="classFESeries_1_1Legendre.html#ae2dae601bf1167c237969be15c66d7fd">calculate</a>(local_dof_values,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                      <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index(),</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                      expansion_coefficients);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                <span class="comment">// We fit our exponential decay of expansion coefficients to the</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                <span class="comment">// provided regression_strategy on each possible value of |k|.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                <span class="comment">// To this end, we use FESeries::process_coefficients() to</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="comment">// rework coefficients into the desired format.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                res = FESeries::process_coefficients&lt;dim&gt;(</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                  expansion_coefficients,</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                  [n_modes](<span class="keyword">const</span> <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> &amp;<a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a>) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                    <span class="keywordflow">return</span> index_sum_less_than_N(<a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a>, n_modes);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                  },</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                  regression_strategy,</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                  smallest_abs_coefficient);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(res.first.size() == res.second.size(),</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                       <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                <span class="comment">// Last, do the linear regression.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                <span class="keywordtype">float</span> regularity = std::numeric_limits&lt;float&gt;::infinity();</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                <span class="keywordflow">if</span> (res.first.size() &gt; 1)</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                  {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    <span class="comment">// Prepare linear equation for the logarithmic least squares</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                    <span class="comment">// fit.</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    converted_indices.assign(res.first.begin(),</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                             res.first.end());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;residual_element : res.second)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                      residual_element = std::log(residual_element);</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                    <span class="keyword">const</span> std::pair&lt;double, double&gt; <a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a> =</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                      <a class="code" href="namespaceFESeries.html#afa42058db3555536415fae91822d27e3">FESeries::linear_regression</a>(converted_indices,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                  res.second);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    regularity = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(-<a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a>.first);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                  }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) = regularity;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;              }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;              smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) =</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;                numbers::signaling_nan&lt;float&gt;();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          }</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim, <span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00183"></a><span class="lineno"><a class="line" href="namespaceSmoothnessEstimator_1_1Legendre.html#a6eea95238b34ae80bafcc82bd1e7c64f">  183</a></span>&#160;    <a class="code" href="namespaceSmoothnessEstimator_1_1Legendre.html#a6eea95238b34ae80bafcc82bd1e7c64f">coefficient_decay_per_direction</a>(</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <a class="code" href="classFESeries_1_1Legendre.html">FESeries::Legendre&lt;dim, spacedim&gt;</a> &amp;fe_legendre,</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp;  dof_handler,</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="keyword">const</span> VectorType &amp;                 <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <a class="code" href="classVector.html">Vector&lt;float&gt;</a> &amp;                    smoothness_indicators,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a> &amp;              coefficients_predicate,</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>                       smallest_abs_coefficient,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span>                         only_flagged_cells)</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(smallest_abs_coefficient &gt;= 0.,</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;             <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;smallest_abs_coefficient should be non-negative.&quot;</span>));</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keyword">using</span> <a class="code" href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a> = <span class="keyword">typename</span> VectorType::value_type;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="keyword">using</span> number_coeff =</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">typename</span> <a class="code" href="classFESeries_1_1Legendre.html#a345a0ac48c40e9e321b7e4cbe2673bbb">FESeries::Legendre&lt;dim, spacedim&gt;::CoefficientType</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      smoothness_indicators.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        dof_handler.get_triangulation().n_active_cells());</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_modes;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      <a class="code" href="classTable.html">Table&lt;dim, number_coeff&gt;</a> expansion_coefficients;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      <a class="code" href="classVector.html">Vector&lt;number&gt;</a>           local_dof_values;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      <span class="comment">// auxiliary vector to do linear regression</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_degree =</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        dof_handler.get_fe_collection().max_degree();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      std::vector&lt;double&gt; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.reserve(max_degree);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>.reserve(max_degree);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;          {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">if</span> (!only_flagged_cells || <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;refine_flag_set() ||</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;              {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                n_modes = fe_legendre.<a class="code" href="classFESeries_1_1Legendre.html#aa9a1bd0dbb9e5e4e3984d7feb36d7f40">get_n_coefficients_per_direction</a>(</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                  <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                <a class="code" href="table__0_8txt.html#af635aebc3d99e710d018581b47f69a15">resize</a>(expansion_coefficients, n_modes);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pe = <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().degree;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(pe &gt; 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                <span class="comment">// since we use coefficients with indices [1,pe] in each</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                <span class="comment">// direction, the number of coefficients we need to calculate is</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                <span class="comment">// at least N=pe+1</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(pe, n_modes);</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                local_dof_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell());</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, local_dof_values);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                fe_legendre.<a class="code" href="classFESeries_1_1Legendre.html#ae2dae601bf1167c237969be15c66d7fd">calculate</a>(local_dof_values,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                      <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index(),</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                      expansion_coefficients);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                <span class="comment">// choose the smallest decay of coefficients in each direction,</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="comment">// i.e. the maximum decay slope k_v as in exp(-k_v)</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                <span class="keywordtype">double</span> k_v = std::numeric_limits&lt;double&gt;::infinity();</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                  {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                    <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.resize(0);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>.resize(0);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    <span class="comment">// will use all non-zero coefficients allowed by the</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    <span class="comment">// predicate function</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt;= pe; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                      <span class="keywordflow">if</span> (coefficients_predicate[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>])</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                        {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                          <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> ind;</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                          ind[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span> coeff_abs =</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                            std::abs(expansion_coefficients(ind));</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                          <span class="keywordflow">if</span> (coeff_abs &gt; smallest_abs_coefficient)</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                            {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                              <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.push_back(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                              <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>.push_back(std::log(coeff_abs));</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                            }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                        }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                    <span class="comment">// in case we don&#39;t have enough non-zero coefficient to fit,</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                    <span class="comment">// skip this direction</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.size() &lt; 2)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                    <span class="keyword">const</span> std::pair&lt;double, double&gt; <a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a> =</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                      <a class="code" href="namespaceFESeries.html#afa42058db3555536415fae91822d27e3">FESeries::linear_regression</a>(<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    <span class="comment">// decay corresponds to negative slope</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    <span class="comment">// take the lesser negative slope along each direction</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    k_v = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(k_v, -<a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a>.first);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                  }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) =</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                  <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(k_v);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;              }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) =</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                numbers::signaling_nan&lt;float&gt;();</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;          }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    }</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <a class="code" href="classFESeries_1_1Legendre.html">FESeries::Legendre&lt;dim, spacedim&gt;</a></div>
<div class="line"><a name="l00290"></a><span class="lineno"><a class="line" href="namespaceSmoothnessEstimator_1_1Legendre.html#adabe60025f0ce97091bb35eb8fc4c600">  290</a></span>&#160;    <a class="code" href="namespaceSmoothnessEstimator_1_1Legendre.html#adabe60025f0ce97091bb35eb8fc4c600">default_fe_series</a>(<span class="keyword">const</span> <a class="code" href="classhp_1_1FECollection.html">hp::FECollection&lt;dim, spacedim&gt;</a> &amp;fe_collection,</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="comment">// Default number of coefficients per direction.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;      <span class="comment">// With a number of modes equal to the polynomial degree plus two for each</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="comment">// finite element, the smoothness estimation algorithm tends to produce</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;      <span class="comment">// stable results.</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      std::vector&lt;unsigned int&gt; n_coefficients_per_direction;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; fe_collection.<a class="code" href="classhp_1_1Collection.html#a9e51c9371e925145c42840d72f4a0bf7">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        n_coefficients_per_direction.push_back(fe_collection[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].degree + 2);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      <span class="comment">// Default quadrature collection.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;      <span class="comment">// We initialize a FESeries::Legendre expansion object object which will</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      <span class="comment">// be used to calculate the expansion coefficients. In addition to the</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;      <span class="comment">// hp::FECollection, we need to provide quadrature rules hp::QCollection</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;      <span class="comment">// for integration on the reference cell.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;      <span class="comment">// We will need to assemble the expansion matrices for each of the finite</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      <span class="comment">// elements we deal with, i.e. the matrices F_k,j. We have to do that for</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="comment">// each of the finite elements in use. To that end we need a quadrature</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      <span class="comment">// rule. As a default, we use the same quadrature formula for each finite</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      <span class="comment">// element, namely a Gauss formula that yields exact results for the</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;      <span class="comment">// highest order Legendre polynomial used.</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;      <span class="comment">// We start with the zeroth Legendre polynomial which is just a constant,</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;      <span class="comment">// so the highest Legendre polynomial will be of order (n_modes - 1).</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;      <a class="code" href="classhp_1_1QCollection.html">hp::QCollection&lt;dim&gt;</a> q_collection;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; fe_collection.<a class="code" href="classhp_1_1Collection.html#a9e51c9371e925145c42840d72f4a0bf7">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;          <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>  <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>(n_coefficients_per_direction[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;          <span class="keyword">const</span> <a class="code" href="classQSorted.html">QSorted&lt;dim&gt;</a> quadrature_sorted(<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;          q_collection.<a class="code" href="classhp_1_1QCollection.html#a87ec95076ccc4b7c10fa24523bb926df">push_back</a>(quadrature_sorted);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classFESeries_1_1Legendre.html">FESeries::Legendre&lt;dim, spacedim&gt;</a>(n_coefficients_per_direction,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                               fe_collection,</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                               q_collection,</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                               <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    }</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  } <span class="comment">// namespace Legendre</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keyword">namespace </span>Fourier</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">namespace</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;      std::pair&lt;bool, unsigned int&gt;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      index_norm_greater_than_zero_and_less_than_N_squared(</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        <span class="keyword">const</span> <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> &amp;ind,</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>       <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>)</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      {</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;          <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> += ind[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] * ind[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160; </div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">return</span> std::make_pair((<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &gt; 0 &amp;&amp; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a> * <a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>), <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      }</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    } <span class="comment">// namespace</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160; </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim, <span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="namespaceSmoothnessEstimator_1_1Fourier.html#aae63069820e030e1f012e3e84d28e6f8">  370</a></span>&#160;    <a class="code" href="namespaceSmoothnessEstimator_1_1Fourier.html#aae63069820e030e1f012e3e84d28e6f8">coefficient_decay</a>(<a class="code" href="classFESeries_1_1Fourier.html">FESeries::Fourier&lt;dim, spacedim&gt;</a> &amp;fe_fourier,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                      <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp; dof_handler,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                      <span class="keyword">const</span> VectorType &amp;                <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                      <a class="code" href="classVector.html">Vector&lt;float&gt;</a> &amp;                   smoothness_indicators,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                      <span class="keyword">const</span> <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1">VectorTools::NormType</a>       regression_strategy,</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">double</span> smallest_abs_coefficient,</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">bool</span>   only_flagged_cells)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keyword">using</span> <a class="code" href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a> = <span class="keyword">typename</span> VectorType::value_type;</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      <span class="keyword">using</span> number_coeff =</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        <span class="keyword">typename</span> <a class="code" href="classFESeries_1_1Fourier.html#a5594a41d6635561fa67e489936f3356b">FESeries::Fourier&lt;dim, spacedim&gt;::CoefficientType</a>;</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160; </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      smoothness_indicators.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;        dof_handler.get_triangulation().n_active_cells());</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_modes;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      <a class="code" href="classTable.html">Table&lt;dim, number_coeff&gt;</a> expansion_coefficients;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      <a class="code" href="classVector.html">Vector&lt;number&gt;</a>      local_dof_values;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      std::vector&lt;double&gt; ln_k;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      std::pair&lt;std::vector&lt;unsigned int&gt;, std::vector&lt;double&gt;&gt; res;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;          {</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <span class="keywordflow">if</span> (!only_flagged_cells || <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;refine_flag_set() ||</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;              {</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                n_modes = fe_fourier.<a class="code" href="classFESeries_1_1Fourier.html#a959c74597f27e549994f3ba834bbc4b2">get_n_coefficients_per_direction</a>(</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                  <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                <a class="code" href="table__0_8txt.html#af635aebc3d99e710d018581b47f69a15">resize</a>(expansion_coefficients, n_modes);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                <span class="comment">// Inside the loop, we first need to get the values of the local</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                <span class="comment">// degrees of freedom and then need to compute the series</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <span class="comment">// expansion by multiplying this vector with the matrix @f${\cal</span></div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="comment">// F}@f$ corresponding to this finite element.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                local_dof_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell());</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, local_dof_values);</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160; </div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                fe_fourier.<a class="code" href="classFESeries_1_1Fourier.html#a1c5d64a4fad5a77c0fda37730e62e30b">calculate</a>(local_dof_values,</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                                     <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index(),</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                                     expansion_coefficients);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                <span class="comment">// We fit our exponential decay of expansion coefficients to the</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                <span class="comment">// provided regression_strategy on each possible value of |k|.</span></div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                <span class="comment">// To this end, we use FESeries::process_coefficients() to</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                <span class="comment">// rework coefficients into the desired format.</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                res = FESeries::process_coefficients&lt;dim&gt;(</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                  expansion_coefficients,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                  [n_modes](<span class="keyword">const</span> <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> &amp;<a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a>) {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                    <span class="keywordflow">return</span> index_norm_greater_than_zero_and_less_than_N_squared(</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                      <a class="code" href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a>, n_modes);</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                  },</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                  regression_strategy,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                  smallest_abs_coefficient);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(res.first.size() == res.second.size(),</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                       <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                <span class="comment">// Last, do the linear regression.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                <span class="keywordtype">float</span> regularity = std::numeric_limits&lt;float&gt;::infinity();</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                <span class="keywordflow">if</span> (res.first.size() &gt; 1)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                  {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                    <span class="comment">// Prepare linear equation for the logarithmic least squares</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                    <span class="comment">// fit.</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                    <span class="comment">// First, calculate ln(|k|).</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                    <span class="comment">// For Fourier expansion, this translates to</span></div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                    <span class="comment">// ln(2*pi*sqrt(predicate)) = ln(2*pi) + 0.5*ln(predicate).</span></div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                    <span class="comment">// Since we are just interested in the slope of a linear</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                    <span class="comment">// regression later, we omit the ln(2*pi) factor.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                    ln_k.resize(res.first.size());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a> = 0; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a> &lt; res.first.size(); ++<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                      ln_k[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>] =</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                        0.5 * std::log(<span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(res.first[<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a>]));</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                    <span class="comment">// Second, calculate ln(U_k).</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;residual_element : res.second)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                      residual_element = std::log(residual_element);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                    <span class="keyword">const</span> std::pair&lt;double, double&gt; <a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a> =</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                      <a class="code" href="namespaceFESeries.html#afa42058db3555536415fae91822d27e3">FESeries::linear_regression</a>(ln_k, res.second);</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                    <span class="comment">// Compute regularity s = mu - dim/2</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;                    regularity = <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(-<a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a>.first) -</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;                                 ((<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> &gt; 1) ? (.5 * <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) : 0);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;                  }</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                <span class="comment">// Store result in the vector of estimated values for each cell.</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) = regularity;</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;              }</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;              smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) =</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                numbers::signaling_nan&lt;float&gt;();</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          }</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160; </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim, <span class="keyword">typename</span> VectorType&gt;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="namespaceSmoothnessEstimator_1_1Fourier.html#a6d8ab53058217f739eec4280e5f52e96">  470</a></span>&#160;    <a class="code" href="namespaceSmoothnessEstimator_1_1Fourier.html#a6d8ab53058217f739eec4280e5f52e96">coefficient_decay_per_direction</a>(</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <a class="code" href="classFESeries_1_1Fourier.html">FESeries::Fourier&lt;dim, spacedim&gt;</a> &amp;fe_fourier,</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keyword">const</span> DoFHandler&lt;dim, spacedim&gt; &amp; dof_handler,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;      <span class="keyword">const</span> VectorType &amp;                <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      <a class="code" href="classVector.html">Vector&lt;float&gt;</a> &amp;                   smoothness_indicators,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a> &amp;             coefficients_predicate,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span>                      smallest_abs_coefficient,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">bool</span>                        only_flagged_cells)</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(smallest_abs_coefficient &gt;= 0.,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;             <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;smallest_abs_coefficient should be non-negative.&quot;</span>));</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;      <span class="keyword">using</span> <a class="code" href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a> = <span class="keyword">typename</span> VectorType::value_type;</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keyword">using</span> number_coeff =</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keyword">typename</span> <a class="code" href="classFESeries_1_1Fourier.html#a5594a41d6635561fa67e489936f3356b">FESeries::Fourier&lt;dim, spacedim&gt;::CoefficientType</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      smoothness_indicators.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        dof_handler.get_triangulation().n_active_cells());</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>             n_modes;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;      <a class="code" href="classTable.html">Table&lt;dim, number_coeff&gt;</a> expansion_coefficients;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      <a class="code" href="classVector.html">Vector&lt;number&gt;</a>           local_dof_values;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="comment">// auxiliary vector to do linear regression</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_degree =</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        dof_handler.get_fe_collection().max_degree();</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;      std::vector&lt;double&gt; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.reserve(max_degree);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>.reserve(max_degree);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : dof_handler.active_cell_iterators())</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;          {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            <span class="keywordflow">if</span> (!only_flagged_cells || <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;refine_flag_set() ||</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;coarsen_flag_set())</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;              {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                n_modes = fe_fourier.<a class="code" href="classFESeries_1_1Fourier.html#a959c74597f27e549994f3ba834bbc4b2">get_n_coefficients_per_direction</a>(</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                  <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index());</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                <a class="code" href="table__0_8txt.html#af635aebc3d99e710d018581b47f69a15">resize</a>(expansion_coefficients, n_modes);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pe = <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().degree;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(pe &gt; 0, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                <span class="comment">// since we use coefficients with indices [1,pe] in each</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                <span class="comment">// direction, the number of coefficients we need to calculate is</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="comment">// at least N=pe+1</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                <a class="code" href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a>(pe, n_modes);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                local_dof_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_fe().n_dofs_per_cell());</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;get_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, local_dof_values);</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                fe_fourier.<a class="code" href="classFESeries_1_1Fourier.html#a1c5d64a4fad5a77c0fda37730e62e30b">calculate</a>(local_dof_values,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                     <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_fe_index(),</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;                                     expansion_coefficients);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                <span class="comment">// choose the smallest decay of coefficients in each direction,</span></div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                <span class="comment">// i.e. the maximum decay slope k_v as in exp(-k_v)</span></div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                <span class="keywordtype">double</span> k_v = std::numeric_limits&lt;double&gt;::infinity();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                  {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;                    <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.resize(0);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                    <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>.resize(0);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                    <span class="comment">// will use all non-zero coefficients allowed by the</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;                    <span class="comment">// predicate function</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                    <span class="comment">//</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;                    <span class="comment">// skip i=0 because of logarithm</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 1; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt;= pe; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                      <span class="keywordflow">if</span> (coefficients_predicate[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>])</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                        {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                          <a class="code" href="classTableIndices.html">TableIndices&lt;dim&gt;</a> ind;</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                          ind[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">double</span> coeff_abs =</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                            std::abs(expansion_coefficients(ind));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                          <span class="keywordflow">if</span> (coeff_abs &gt; smallest_abs_coefficient)</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                            {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                              <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.push_back(std::log(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>));</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                              <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>.push_back(std::log(coeff_abs));</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                            }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                        }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                    <span class="comment">// in case we don&#39;t have enough non-zero coefficient to fit,</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    <span class="comment">// skip this direction</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <span class="keywordflow">if</span> (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>.size() &lt; 2)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                    <span class="keyword">const</span> std::pair&lt;double, double&gt; <a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a> =</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                      <a class="code" href="namespaceFESeries.html#afa42058db3555536415fae91822d27e3">FESeries::linear_regression</a>(<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a>);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                    <span class="comment">// decay corresponds to negative slope</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                    <span class="comment">// take the lesser negative slope along each direction</span></div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                    k_v = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(k_v, -<a class="code" href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a>.first);</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                  }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) =</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(k_v);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;              }</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;              smoothness_indicators(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;active_cell_index()) =</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                numbers::signaling_nan&lt;float&gt;();</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;          }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> spacedim&gt;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <a class="code" href="classFESeries_1_1Fourier.html">FESeries::Fourier&lt;dim, spacedim&gt;</a></div>
<div class="line"><a name="l00579"></a><span class="lineno"><a class="line" href="namespaceSmoothnessEstimator_1_1Fourier.html#a748faa704c9dfb67a074d11316e777b4">  579</a></span>&#160;    <a class="code" href="namespaceSmoothnessEstimator_1_1Fourier.html#a748faa704c9dfb67a074d11316e777b4">default_fe_series</a>(<span class="keyword">const</span> <a class="code" href="classhp_1_1FECollection.html">hp::FECollection&lt;dim, spacedim&gt;</a> &amp;fe_collection,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                     <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="comment">// Default number of coefficients per direction.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="comment">// Since we omit the zero-th mode in the Fourier decay strategy, make sure</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="comment">// that we have at least two modes to work with per finite element. With a</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <span class="comment">// number of modes equal to the polynomial degree plus two for each finite</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="comment">// element, the smoothness estimation algorithm tends to produce stable</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="comment">// results.</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      std::vector&lt;unsigned int&gt; n_coefficients_per_direction;</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; fe_collection.<a class="code" href="classhp_1_1Collection.html#a9e51c9371e925145c42840d72f4a0bf7">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        n_coefficients_per_direction.push_back(fe_collection[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].degree + 2);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="comment">// Default quadrature collection.</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      <span class="comment">//</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="comment">// We initialize a series expansion object object which will be used to</span></div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;      <span class="comment">// calculate the expansion coefficients. In addition to the</span></div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;      <span class="comment">// hp::FECollection, we need to provide quadrature rules hp::QCollection</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="comment">// for integration on the reference cell.</span></div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="comment">// We will need to assemble the expansion matrices for each of the finite</span></div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">// elements we deal with, i.e. the matrices F_k,j. We have to do that for</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">// each of the finite elements in use. To that end we need a quadrature</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="comment">// rule. As a default, we use the same quadrature formula for each finite</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      <span class="comment">// element, namely one that is obtained by iterating a 5-point Gauss</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="comment">// formula as many times as the maximal exponent we use for the term</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;      <span class="comment">// exp(ikx). Since the first mode corresponds to k = 0, the maximal wave</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <span class="comment">// number is k = n_modes - 1.</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>      base_quadrature(5);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <a class="code" href="classhp_1_1QCollection.html">hp::QCollection&lt;dim&gt;</a> q_collection;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; fe_collection.<a class="code" href="classhp_1_1Collection.html#a9e51c9371e925145c42840d72f4a0bf7">size</a>(); ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="keyword">const</span> <a class="code" href="classQIterated.html">QIterated&lt;dim&gt;</a> <a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>(base_quadrature,</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                          n_coefficients_per_direction[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] - 1);</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <span class="keyword">const</span> <a class="code" href="classQSorted.html">QSorted&lt;dim&gt;</a>   quadrature_sorted(<a class="code" href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          q_collection.<a class="code" href="classhp_1_1QCollection.html#a87ec95076ccc4b7c10fa24523bb926df">push_back</a>(quadrature_sorted);</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; </div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classFESeries_1_1Fourier.html">FESeries::Fourier&lt;dim, spacedim&gt;</a>(n_coefficients_per_direction,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                                              fe_collection,</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                                              q_collection,</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                                              <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  } <span class="comment">// namespace Fourier</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;} <span class="comment">// namespace SmoothnessEstimator</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment">// explicit instantiations</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="preprocessor">#include &quot;smoothness_estimator.inst&quot;</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="ahp_2q__collection_8h_html"><div class="ttname"><a href="hp_2q__collection_8h.html">q_collection.h</a></div></div>
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="anewton__0_8txt_html_af4dc1cb00f59a52e48df46a4c205a8e6"><div class="ttname"><a href="newton__0_8txt.html#af4dc1cb00f59a52e48df46a4c205a8e6">number</a></div><div class="ttdeci">*Operator class performing Newton s iteration with standard step size control and adaptive matrix generation This class performs a Newton iteration up to convergence determined by control If after an update the norm of the residual has become larger then step size control is activated and the update is subsequently divided by two until the residual actually becomes depending on the tends to be this method applies an adaptive reassembling strategy Only if the reduction factor for the residual is more than receiving the applications computing the residual and solving the linear respectively **Declare the parameters applicable to Newton s method **Read the parameters in the ParameterHandler **Initialize the pointer data_out for debugging **The actual Newton iteration The initial value is in&lt; tt &gt; which also contains the result after convergence Values in&lt; tt &gt; in&lt;/tt &gt; are not used by but will be handed down to the objects **Set the maximal residual reduction allowed without triggering assembling in the next step Return the previous value **Control object for the Newton iteration **The indicating that the matrix must be assembled anew upon start **A flag used to decide how many stepsize iteration should be made Default is the original value of Enter zero here to turn off stepsize control *Controlled by&lt; tt &gt; Stepsize iterations&lt;/tt &gt; in parameter file **Threshold for re assembling matrix If the quotient of two consecutive residuals is smaller than this the system matrix is not assembled in this step *This parameter should be adjusted to the residual gain of the inner solver The default values is resulting in reassembling in every Newton step **Print update and updated solution after each step into file&lt; tt &gt; Newton_NNN&lt;/tt &gt; **Write debug output to[2.x.3] the higher the number</div><div class="ttdef"><b>Definition:</b> <a href="newton__0_8txt_source.html#l00034">newton_0.txt:34</a></div></div>
<div class="ttc" id="aclassFESeries_1_1Legendre_html_a345a0ac48c40e9e321b7e4cbe2673bbb"><div class="ttname"><a href="classFESeries_1_1Legendre.html#a345a0ac48c40e9e321b7e4cbe2673bbb">FESeries::Legendre::CoefficientType</a></div><div class="ttdeci">double CoefficientType</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__series_8h_source.html#l00253">fe_series.h:253</a></div></div>
<div class="ttc" id="aclassFESeries_1_1Fourier_html_a5594a41d6635561fa67e489936f3356b"><div class="ttname"><a href="classFESeries_1_1Fourier.html#a5594a41d6635561fa67e489936f3356b">FESeries::Fourier::CoefficientType</a></div><div class="ttdeci">typename std::complex&lt; double &gt; CoefficientType</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__series_8h_source.html#l00078">fe_series.h:78</a></div></div>
<div class="ttc" id="aclassFESeries_1_1Legendre_html_aa9a1bd0dbb9e5e4e3984d7feb36d7f40"><div class="ttname"><a href="classFESeries_1_1Legendre.html#aa9a1bd0dbb9e5e4e3984d7feb36d7f40">FESeries::Legendre::get_n_coefficients_per_direction</a></div><div class="ttdeci">unsigned int get_n_coefficients_per_direction(const unsigned int index) const</div><div class="ttdef"><b>Definition:</b> <a href="fe__series__legendre_8cc_source.html#l00285">fe_series_legendre.cc:285</a></div></div>
<div class="ttc" id="aclassTableIndices_html"><div class="ttname"><a href="classTableIndices.html">TableIndices</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2table__indices_8h_source.html#l00045">table_indices.h:45</a></div></div>
<div class="ttc" id="alac_2trilinos__epetra__vector_8h_html"><div class="ttname"><a href="lac_2trilinos__epetra__vector_8h.html">trilinos_epetra_vector.h</a></div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_a5873b8f7eeaefb5e7a99005c6c93b175"><div class="ttname"><a href="update__flags__0_8txt.html#a5873b8f7eeaefb5e7a99005c6c93b175">quadrature</a></div><div class="ttdeci">and a mapping object that provides the Jacobian as well as its determinant Dealing with all these objects would be cumbersome and error prone *On the other these three kinds of objects almost always appear and it is in fact very rare for deal II application codes to do anything with quadrature</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00019">update_flags_0.txt:19</a></div></div>
<div class="ttc" id="aclassQSorted_html"><div class="ttname"><a href="classQSorted.html">QSorted</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00407">quadrature_lib.h:407</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_aa2626b9a8731384418b99aaadfc1d365"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#aa2626b9a8731384418b99aaadfc1d365">y</a></div><div class="ttdeci">this leads to a degree of flexibility in computations that cannot be matched by auto differentiation For one could perform the permanent substitution[2.x.86] and then recompute[2.x.87] for several different values of[2.x.88] One could also post factum express an interdependency between x and y</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00347">automatic_and_symbolic_differentiation_0.txt:347</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gaafbb69cc2a791ae55880fd8d57d0c1b0"><div class="ttname"><a href="group__Exceptions.html#gaafbb69cc2a791ae55880fd8d57d0c1b0">AssertIndexRange</a></div><div class="ttdeci">#define AssertIndexRange(index, range)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01827">exceptions.h:1827</a></div></div>
<div class="ttc" id="aclasshp_1_1QCollection_html"><div class="ttname"><a href="classhp_1_1QCollection.html">hp::QCollection</a></div><div class="ttdef"><b>Definition:</b> <a href="hp_2q__collection_8h_source.html#l00044">q_collection.h:44</a></div></div>
<div class="ttc" id="anamespaceVectorTools_html_a69967cb7a148a7169963126249213db1"><div class="ttname"><a href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1">VectorTools::NormType</a></div><div class="ttdeci">NormType</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__common_8h_source.html#l00043">vector_tools_common.h:43</a></div></div>
<div class="ttc" id="aclassComponentMask_html"><div class="ttname"><a href="classComponentMask.html">ComponentMask</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2component__mask_8h_source.html#l00080">component_mask.h:80</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a93f65b0385560a34ec1d3c5ec5a882b8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="adistributed__0_8txt_html_ac2b339f054fd752a401e197097db8cfe"><div class="ttname"><a href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a></div><div class="ttdeci">********clusters ***deal II can use multiple machines connected via MPI to parallelize in addition to the parallelization within a shared memory machine discussed in the[2.x.4] module There are essentially two ways to utilize multiple but only a share of the global sparsity and solution vector is stored on each machine ****The mesh and DoF handler are also i e each processor stores only a share of the cells and degrees of freedom No processor has knowledge of the entire or solution</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00025">distributed_0.txt:25</a></div></div>
<div class="ttc" id="anumerics_2smoothness__estimator_8h_html"><div class="ttname"><a href="numerics_2smoothness__estimator_8h.html">smoothness_estimator.h</a></div></div>
<div class="ttc" id="aclassFESeries_1_1Fourier_html"><div class="ttname"><a href="classFESeries_1_1Fourier.html">FESeries::Fourier</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__series_8h_source.html#l00075">fe_series.h:75</a></div></div>
<div class="ttc" id="aclassQIterated_html"><div class="ttname"><a href="classQIterated.html">QIterated</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2quadrature_8h_source.html#l00380">quadrature.h:380</a></div></div>
<div class="ttc" id="aclassTable_html"><div class="ttname"><a href="classTable.html">Table</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2array__view_8h_source.html#l00033">array_view.h:33</a></div></div>
<div class="ttc" id="alac_2la__parallel__vector_8h_html"><div class="ttname"><a href="lac_2la__parallel__vector_8h.html">la_parallel_vector.h</a></div></div>
<div class="ttc" id="aclassFESeries_1_1Fourier_html_a959c74597f27e549994f3ba834bbc4b2"><div class="ttname"><a href="classFESeries_1_1Fourier.html#a959c74597f27e549994f3ba834bbc4b2">FESeries::Fourier::get_n_coefficients_per_direction</a></div><div class="ttdeci">unsigned int get_n_coefficients_per_direction(const unsigned int index) const</div><div class="ttdef"><b>Definition:</b> <a href="fe__series__fourier_8cc_source.html#l00278">fe_series_fourier.cc:278</a></div></div>
<div class="ttc" id="aclassVector_html_ac4a4dbef7dd65ef8ad35ae56b57d7c05"><div class="ttname"><a href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">Vector::reinit</a></div><div class="ttdeci">virtual void reinit(const size_type N, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="aclassFESeries_1_1Fourier_html_a1c5d64a4fad5a77c0fda37730e62e30b"><div class="ttname"><a href="classFESeries_1_1Fourier.html#a1c5d64a4fad5a77c0fda37730e62e30b">FESeries::Fourier::calculate</a></div><div class="ttdeci">void calculate(const ::Vector&lt; Number &gt; &amp;local_dof_values, const unsigned int cell_active_fe_index, Table&lt; dim, CoefficientType &gt; &amp;fourier_coefficients)</div></div>
<div class="ttc" id="alac_2trilinos__vector_8h_html"><div class="ttname"><a href="lac_2trilinos__vector_8h.html">trilinos_vector.h</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_1_1Legendre_html_adabe60025f0ce97091bb35eb8fc4c600"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Legendre.html#adabe60025f0ce97091bb35eb8fc4c600">SmoothnessEstimator::Legendre::default_fe_series</a></div><div class="ttdeci">FESeries::Legendre&lt; dim, spacedim &gt; default_fe_series(const hp::FECollection&lt; dim, spacedim &gt; &amp;fe_collection, const unsigned int component=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00290">smoothness_estimator.cc:290</a></div></div>
<div class="ttc" id="atable__0_8txt_html_af635aebc3d99e710d018581b47f69a15"><div class="ttname"><a href="table__0_8txt.html#af635aebc3d99e710d018581b47f69a15">resize</a></div><div class="ttdeci">examples are data tables that are loaded at start up time and then used over the course of the run time of the program In such the start up cost of running this function can be amortized over and the potential memory savings from not having to store the table on each process may be substantial on machines with large core counts on which many MPI processes run on the same machine *This function only makes sense if the data type T is self i all of its information is stored in its member and if none of the member variables are pointers to other parts of the memory This is because if a type T does have pointers to other parts of then moving T into a shared memory space does not result in the other processes having access to data that the object points to with its member variable and are typically in memory areas not accessible to the other processes As a the usual use case for this function is to share arrays of simple objects such as double s or int s *After calling this objects on different MPI processes share a common state That means that certain operations become i they must be called on all participating processors at the same time In you can no longer call resize()</div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="aclassFESeries_1_1Legendre_html"><div class="ttname"><a href="classFESeries_1_1Legendre.html">FESeries::Legendre</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__series_8h_source.html#l00250">fe_series.h:250</a></div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="avector__0_8txt_html_aaf255149898cc5cea8c1fa1e76fffe6f"><div class="ttname"><a href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a></div><div class="ttdeci">0 v</div><div class="ttdef"><b>Definition:</b> <a href="vector__0_8txt_source.html#l00062">vector_0.txt:62</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_1_1Legendre_html_a6eea95238b34ae80bafcc82bd1e7c64f"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Legendre.html#a6eea95238b34ae80bafcc82bd1e7c64f">SmoothnessEstimator::Legendre::coefficient_decay_per_direction</a></div><div class="ttdeci">void coefficient_decay_per_direction(FESeries::Legendre&lt; dim, spacedim &gt; &amp;fe_legendre, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const VectorType &amp;solution, Vector&lt; float &gt; &amp;smoothness_indicators, const ComponentMask &amp;coefficients_predicate=ComponentMask(), const double smallest_abs_coefficient=1e-10, const bool only_flagged_cells=false)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00183">smoothness_estimator.cc:183</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a30a552b07accf65da90f851e25d14d1c"><div class="ttname"><a href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div><div class="ttdeci">3, where it offers following possibilities:a face(quad) being refined in x- or y-direction(in the face-intern coordinate system) separately,([2.x.79] or([2.x.80] which corresponds to([2.x.81]). Additionally, it offers the possibilities a face can have through repeated anisotropic refinement steps performed on one of the two neighboring cells. It might be possible for example, that a face(quad) is refined with[2.x.82] and afterwards the left child is again refined with[2.x.83], so that there are three active subfaces. Note, however, that only refinement cases are allowed such that each line on a face between two hexes has not more than one hanging node. Furthermore, it is not allowed that two neighboring hexes are refined such that one of the hexes refines the common face with[2.x.84] and the other hex refines that face with[2.x.85] . In fact,[2.x.86] takes care of this situation and ensures that each face of a refined cell is completely contained in a single face of neighboring cells. The following drawings explain the SubfacePossibilities and give the corresponding subface numbers:*[1.x.4] **[2.x.87] *[0.x.68] *Possible cases of faces being subdivided into subface. See documentation to the SubfacePossibilities&lt; 3 &gt; for more details on the subface possibilities. *[0.x.69] *A class that provides all possible cases a face(in the current space dimension[2.x.88] might be subdivided into subfaces. *[2.x.89] *[0.x.70] *Constructor. Take and store a value indicating a particular subface possibility in the list of possible situations specified in the base class. *[0.x.71] *Return the numeric value stored by this class. While the presence of this operator might seem dangerous, it is useful in cases where one would like to have code like&lt; code &gt;switch(subface_case)... case[2.x.90] ...&lt;/code &gt;, which can be written as&lt; code &gt;switch[2.x.91] Another application is to use an object of the current type as an index into an array dim</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00202">geometry_info_0.txt:202</a></div></div>
<div class="ttc" id="abase_2signaling__nan_8h_html"><div class="ttname"><a href="base_2signaling__nan_8h.html">signaling_nan.h</a></div></div>
<div class="ttc" id="aclasshp_1_1QCollection_html_a87ec95076ccc4b7c10fa24523bb926df"><div class="ttname"><a href="classhp_1_1QCollection.html#a87ec95076ccc4b7c10fa24523bb926df">hp::QCollection::push_back</a></div><div class="ttdeci">void push_back(const Quadrature&lt; dim_in &gt; &amp;new_quadrature)</div><div class="ttdef"><b>Definition:</b> <a href="hp_2q__collection_8h_source.html#l00228">q_collection.h:228</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_a2b24e414d1a0d32deea919c5e8899811"><div class="ttname"><a href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div><div class="ttdeci">([1.x.8]&lt; sub &gt;1&lt;/sub &gt;, [1.x.9]&lt; sub &gt;2&lt;/sub &gt;, [1.x.10]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt; and[1.x.11] accordingly. Then, we can write the simplified equation in coordinates as[1.x.12] We see, that this is just three copies of the bilinear form of the Laplacian, one applied to each component(this is where the formulation with the[2.x.33] is more exciting, and we want to derive a framework that applies to that one as well). We can make this weak form a system of differential equations again by choosing special test functions:first, choose[1.x.13]=([1.x.14]&lt; sub &gt;1&lt;/sub &gt;, 0, 0)&lt; sup &gt;T&lt;/sup &gt;, then[1.x.15]=(0, [1.x.16]&lt; sub &gt;2&lt;/sub &gt;, 0)&lt; sup &gt;T&lt;/sup &gt;, and finally[1.x.17]=(0, 0, [1.x.18]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt;. writing the outcomes below each other, we obtain the system[1.x.19] where we used the standard inner product notation[2.x.34] . It is important for our understanding, that we keep in mind that the latter form as a system of PDE is completely equivalent to the original definition of the bilinear form[1.x.20]([1.x.21], [1.x.22]), which does not immediately exhibit this system structure. Let us close by writing the full system of the elastic equation with symmetric gradient[1.x.23]:[1.x.24] Very formally, if we believe in operator valued matrices, we can rewrite this in the form[1.x.25]&lt; sup &gt;T&lt;/sup &gt;[1.x.26]=[1.x.27]&lt; sup &gt;T&lt;/sup &gt;[1.x.28] or[1.x.29] *[1.x.30] Now, let us consider a more complex example, the mixed Laplace equations discussed in[2.x.35] in three dimensions:[1.x.31] **Here, we have four solution components:the scalar pressure[2.x.36] and the vector-valued velocity[2.x.37] with three vector components. Note as important difference to the previous example, that the vector space[1.x.32] is not just simply a copy of three identical spaces/*A systematic way to get a weak or variational form for this and other vector problems is to first consider it as a problem where the operators and solution variables are written in vector and matrix form. For the example, this would read as follows:[1.x.33] **This makes it clear that the solution[1.x.34] *indeed has four components. We note that we could change the ordering of the solution components[2.x.38] and[2.x.39] inside[2.x.40] if we also change columns of the matrix operator.*Next, we need to think about test functions[2.x.41] . We want to multiply both sides of the equation with them, then integrate over[2.x.42] . The result should be a scalar equality. We can achieve this by choosing[2.x.43] also vector valued as[1.x.35] **It is convenient to multiply the matrix-vector equation by the test function from the left, since this way we automatically get the correct matrix later on(in the linear system, the matrix is also multiplied from the right with the solution variable, not from the left), whereas if we multiplied from the right then the matrix so assembled is the transpose of the one we really want. *With this in mind, let us multiply by[2.x.44] and integrate to get the following equation which has to hold for all test functions[2.x.45] :[1.x.36] *or equivalently:[1.x.37] ***We get the final form by integrating by part the second term:[1.x.38] **It is this form that we will later use in assembling the discrete weak form into a matrix and a right hand side vector:the form in which we have solution and test functions[2.x.46] that each consist of a number of vector components that we can extract. **[2.x.47] VVFEs[1.x.39] *Once we have settled on a bilinear form and a functional setting, we need to find a way to describe the vector-valued finite element spaces from which we draw solution and test functions. This is where the FESystem class comes in:it composes vector-valued finite element spaces from simpler ones. In the example of the elasticity problem, we need[2.x.48] copies of the same element, for instance **[1.x.40] *This will generate a vector valued space of dimension[2.x.49], where each component is a continuous bilinear element of type FE_Q. It will have[2.x.50] times as many basis functions as the corresponding FE_Q, and each of these basis functions is a basis function of FE_Q, lifted into one of the components of the vector. *For the mixed Laplacian, the situation is more complex. First, we have to settle on a pair of discrete spaces[2.x.51] . One option would be the stable Raviart-Thomas pair **[1.x.41] *The first element in this system is already a vector valued element of dimension[2.x.52], while the second is a regular scalar element. *Alternatively to using the stable Raviart-Thomas pair, we could consider a stabilized formulation for the mixed Laplacian, for instance the LDG method. There, we have the option of using the same spaces for velocity components and pressure, namely **[1.x.42] *This system just has[2.x.53] equal copies of the same discontinuous element, which not really reflects the structure of the system. Therefore, we prefer **[1.x.43] *Here, we have a system of two elements, one vector-valued and one scalar, very much like with the[2.x.54] . Indeed, in many codes, the two can be interchanged. This element also allows us easily to switch to an LDG method with lower order approximation in the velocity, namely **[1.x.44] *It must be pointed out, that this element is different from **[1.x.45] *While the constructor call is very similar to[2.x.55], the result actually resembles more[2.x.56] in that this element produces[2.x.57] independent components. A more detailed comparison of the resulting FESystem objects is below. *[1.x.46] *FESystem has a few internal variables which reflect the internal structure set up by the constructor. These can then also be used by application programs to give structure to matrix assembling and linear algebra. We give the names and values of these variables for the examples above in the following table:&lt; table border=&quot;1&quot;&gt;&lt; tr &gt;&lt; th &gt;System Element&lt;/th &gt;[2.x.58][2.x.59][2.x.60]&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.61]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.62]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.63]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.64]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.65]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt;/table &gt; *From this table, it is clear that the FESystem reflects a lot of the structure of the system of differential equations in the cases of the[2.x.66] and the[2.x.67], in that we have a vector valued and a scalar variable. On the other hand, the convoluted elements do not have this structure and we have to reconstruct it somehow when assembling systems, as described below. *At this point, it is important to note that nesting of two FESystem object can give the whole FESystem a richer structure than just concatenating them. This structure can be exploited by application programs, but is not automatically so. *[2.x.68] VVAssembling[1.x.47] The next step is to assemble the linear system. How to do this for the simple case of a scalar problem has been shown in many tutorial programs, starting with[2.x.69] . Here we will show how to do it for vector problems. Corresponding to the different characterizations of weak formulations above and the different system elements created, we have a few options which are outlined below. *The whole concept is probably best explained by showing an example illustrating how the local contribution of a cell to the weak form of above mixed Laplace equations could be assembled. *[1.x.48] This is essentially how[2.x.70] does it:**[1.x.49] **So here 's what is happening:[2.x.71][2.x.72] The first thing we do is to declare &quot;extractors&quot;(see the FEValuesExtractors namespace). These are objects that don 't do much except store which components of a vector-valued finite element constitute a single scalar component, or a tensor of rank 1(i.e. what we call a &quot;physical vector&quot;, always consisting of[2.x.73] components). Here, we declare an object that represents the velocities consisting of[2.x.74] components starting at component zero, and the extractor for the pressure, which is a scalar component at position[2.x.75] . *[2.x.76] We then do our usual loop over all cells, shape functions, and quadrature points. In the innermost loop, we compute the local contribution of a pair of shape functions to the global matrix and right hand side vector. Recall that the cell contributions to the bilinear form(i.e. neglecting boundary terms) looked as follows, based on shape functions[2.x.77] :[1.x.50] *whereas the implementation looked like this:*[1.x.51] *The similarities are pretty obvious. *[2.x.78] Essentially, what happens in above code is this:when you do[2.x.79], a so-called &quot;view&quot; is created, i.e. an object that unlike the full FEValues object represents not all components of a finite element, but only the one(s) represented by the extractor object[2.x.80] or[2.x.81] . *[2.x.82] These views can then be asked for information about these individual components. For example, when you write[2.x.83] you get the value of the pressure component of the[2.x.84] th shape function[2.x.85] at the[2.x.86] th quadrature point. Because the extractor[2.x.87] represents a scalar component, the results of the operator[2.x.88] is a scalar number. On the other hand, the call[2.x.89] would produce the value of a whole set of[2.x.90] components, which would be of type[2.x.91] . *[2.x.92] Other things that can be done with views is to ask for the gradient of a particular shape function 's components described by an extractor. For example,[2.x.93] would represent the gradient of the scalar pressure component, which is of type[2.x.94], whereas the gradient of the velocities components,[2.x.95] is a[2.x.96], i.e. a matrix[2.x.97] that consists of entries[2.x.98] . Finally, both scalar and vector views can be asked for the second derivatives(&quot;Hessians&quot;) and vector views can be asked for the symmetric gradient, defined as[2.x.99] as well as the divergence[2.x.100] .[2.x.101] Other examples of using extractors and views are shown in tutorial programs[2.x.102],[2.x.103],[2.x.104] and several other programs. ***[2.x.105] In the current context, when we talk about a vector(for example in extracting the velocity components above), we mean the word in the sense physics uses it:it has[2.x.106] components that behave in specific ways under coordinate system transformations. Examples include velocity or displacement fields. This is opposed to how mathematics uses the word &quot;vector&quot;(and how we use this word in other contexts in the library, for example in the Vector class), where it really stands for a collection of numbers. An example of this latter use of the word could be the set of concentrations of chemical species in a flame x</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00090">vector_valued_0.txt:90</a></div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_html"><div class="ttname"><a href="namespaceSmoothnessEstimator.html">SmoothnessEstimator</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2smoothness__estimator_8h_source.html#l00069">smoothness_estimator.h:69</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_1_1Legendre_html_af6d025a69f8a4d1e9fc5914e5d648463"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Legendre.html#af6d025a69f8a4d1e9fc5914e5d648463">SmoothnessEstimator::Legendre::coefficient_decay</a></div><div class="ttdeci">void coefficient_decay(FESeries::Legendre&lt; dim, spacedim &gt; &amp;fe_legendre, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const VectorType &amp;solution, Vector&lt; float &gt; &amp;smoothness_indicators, const VectorTools::NormType regression_strategy=VectorTools::Linfty_norm, const double smallest_abs_coefficient=1e-10, const bool only_flagged_cells=false)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00100">smoothness_estimator.cc:100</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a4874d3f2becad91b2bdda53a5539ff54"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a4874d3f2becad91b2bdda53a5539ff54">f</a></div><div class="ttdeci">pow(2x+1, y)` and computing the derivatives `diff(f, x)` and `diff(f, y)`. At this point there is no assumption of what `x` and `y` represent f</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00347">automatic_and_symbolic_differentiation_0.txt:347</a></div></div>
<div class="ttc" id="afe_2fe__series_8h_html"><div class="ttname"><a href="fe_2fe__series_8h.html">fe_series.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="aclassFESeries_1_1Legendre_html_ae2dae601bf1167c237969be15c66d7fd"><div class="ttname"><a href="classFESeries_1_1Legendre.html#ae2dae601bf1167c237969be15c66d7fd">FESeries::Legendre::calculate</a></div><div class="ttdeci">void calculate(const ::Vector&lt; Number &gt; &amp;local_dof_values, const unsigned int cell_active_fe_index, Table&lt; dim, CoefficientType &gt; &amp;legendre_coefficients)</div><div class="ttdef"><b>Definition:</b> <a href="fe__series__legendre_8cc_source.html#l00296">fe_series_legendre.cc:296</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="alac_2block__vector_8h_html"><div class="ttname"><a href="lac_2block__vector_8h.html">block_vector.h</a></div></div>
<div class="ttc" id="anamespaceFESeries_html_afa42058db3555536415fae91822d27e3"><div class="ttname"><a href="namespaceFESeries.html#afa42058db3555536415fae91822d27e3">FESeries::linear_regression</a></div><div class="ttdeci">std::pair&lt; double, double &gt; linear_regression(const std::vector&lt; double &gt; &amp;x, const std::vector&lt; double &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="fe__series_8cc_source.html#l00030">fe_series.cc:30</a></div></div>
<div class="ttc" id="alac_2vector_8h_html"><div class="ttname"><a href="lac_2vector_8h.html">vector.h</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2base_2quadrature_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2quadrature_8h.html">quadrature.h</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_1_1Fourier_html_aae63069820e030e1f012e3e84d28e6f8"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Fourier.html#aae63069820e030e1f012e3e84d28e6f8">SmoothnessEstimator::Fourier::coefficient_decay</a></div><div class="ttdeci">void coefficient_decay(FESeries::Fourier&lt; dim, spacedim &gt; &amp;fe_fourier, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const VectorType &amp;solution, Vector&lt; float &gt; &amp;smoothness_indicators, const VectorTools::NormType regression_strategy=VectorTools::Linfty_norm, const double smallest_abs_coefficient=1e-10, const bool only_flagged_cells=false)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00370">smoothness_estimator.cc:370</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_1_1Fourier_html_a748faa704c9dfb67a074d11316e777b4"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Fourier.html#a748faa704c9dfb67a074d11316e777b4">SmoothnessEstimator::Fourier::default_fe_series</a></div><div class="ttdeci">FESeries::Fourier&lt; dim, spacedim &gt; default_fe_series(const hp::FECollection&lt; dim, spacedim &gt; &amp;fe_collection, const unsigned int component=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00579">smoothness_estimator.cc:579</a></div></div>
<div class="ttc" id="anamespaceSmoothnessEstimator_1_1Fourier_html_a6d8ab53058217f739eec4280e5f52e96"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Fourier.html#a6d8ab53058217f739eec4280e5f52e96">SmoothnessEstimator::Fourier::coefficient_decay_per_direction</a></div><div class="ttdeci">void coefficient_decay_per_direction(FESeries::Fourier&lt; dim, spacedim &gt; &amp;fe_fourier, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const VectorType &amp;solution, Vector&lt; float &gt; &amp;smoothness_indicators, const ComponentMask &amp;coefficients_predicate=ComponentMask(), const double smallest_abs_coefficient=1e-10, const bool only_flagged_cells=false)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00470">smoothness_estimator.cc:470</a></div></div>
<div class="ttc" id="aclasshp_1_1Collection_html_a9e51c9371e925145c42840d72f4a0bf7"><div class="ttname"><a href="classhp_1_1Collection.html#a9e51c9371e925145c42840d72f4a0bf7">hp::Collection&lt; FiniteElement&lt; dim, dim &gt; &gt;::size</a></div><div class="ttdeci">unsigned int size() const</div><div class="ttdef"><b>Definition:</b> <a href="hp_2collection_8h_source.html#l00114">collection.h:114</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">VectorTools::EvaluationFlags::min</a></div><div class="ttdeci">@ min</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00062">vector_tools_evaluate.h:62</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="anamespaceLAPACKSupport_html_a8edacd69ab93285f82b7f63c733a86b7"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">LAPACKSupport::N</a></div><div class="ttdeci">static const char N</div><div class="ttdef"><b>Definition:</b> <a href="lac_2lapack__support_8h_source.html#l00167">lapack_support.h:167</a></div></div>
<div class="ttc" id="alac_2la__vector_8h_html"><div class="ttname"><a href="lac_2la__vector_8h.html">la_vector.h</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="amapping__q__internal__0_8txt_html_a525dea93c24422745c2f3689c27e7ab6"><div class="ttname"><a href="mapping__q__internal__0_8txt.html#a525dea93c24422745c2f3689c27e7ab6">fit</a></div><div class="ttdeci">namespace to implement methods of MappingQGeneric such as the evaluation of the mapping and the transformation between real and unit cell **This function generates the reference cell support points from the support points by expanding the tensor product **This function is needed by the constructor of&lt; tt &gt; MappingQ&lt; dim, spacedim &gt;&lt;/tt &gt; for&lt; tt &gt; compute the mapped location of that point in real space **Implementation of transform_real_to_unit_cell for either type double or VectorizedArray&lt; double &gt; **Implementation of transform_real_to_unit_cell for which is generally a rational function This allows for a very cheap evaluation of the inverse map by a simple polynomial which can be used as a better initial guess for transforming points from real to unit coordinates than an affine approximation Far away outside the unit this approximation can become inaccurate for non affine cell shapes This must be expected from a fit of a polynomial to a rational and due to the fact that the region of the least squares fit</div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__internal__0_8txt_source.html#l00023">mapping_q_internal_0.txt:23</a></div></div>
<div class="ttc" id="alac_2la__parallel__block__vector_8h_html"><div class="ttname"><a href="lac_2la__parallel__block__vector_8h.html">la_parallel_block_vector.h</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; float &gt;</a></div></div>
<div class="ttc" id="alac_2trilinos__parallel__block__vector_8h_html"><div class="ttname"><a href="lac_2trilinos__parallel__block__vector_8h.html">trilinos_parallel_block_vector.h</a></div></div>
<div class="ttc" id="alac_2petsc__block__vector_8h_html"><div class="ttname"><a href="lac_2petsc__block__vector_8h.html">petsc_block_vector.h</a></div></div>
<div class="ttc" id="aclasshp_1_1FECollection_html"><div class="ttname"><a href="classhp_1_1FECollection.html">hp::FECollection</a></div><div class="ttdef"><b>Definition:</b> <a href="hp_2fe__collection_8h_source.html#l00048">fe_collection.h:48</a></div></div>
<div class="ttc" id="alac_2petsc__vector_8h_html"><div class="ttname"><a href="lac_2petsc__vector_8h.html">petsc_vector.h</a></div></div>
<div class="ttc" id="atable__0_8txt_html_aa889bb34debce4db8c9ace2f875bdf0d"><div class="ttname"><a href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a></div><div class="ttdeci">tables that store three or more dimensional then there is nothing you can do about the size of these if your program is parallelized via then a typical first implementation would create a table object on every process and fill it on every MPI process by reading the data from a file This is inefficient from two the data stored on every process is the and while every process needs to be able to read from a it is not necessary that every process stores its own either by re creating a copy of the table in the other processes memory space if by creating copies in shared memory once for all processes located on each of the machines used by the MPI job ******Integer type used to count the number of elements in this container **Default constructor Set all dimensions to zero **Constructor Initialize the array with the given dimensions in each index component **Constructor Initialize the array with the given dimensions in each index component</div><div class="ttdef"><b>Definition:</b> <a href="table__0_8txt_source.html#l00083">table_0.txt:83</a></div></div>
<div class="ttc" id="afunction__0_8txt_html_a4f780342f2d5d632f82cf7fd90158a66"><div class="ttname"><a href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a></div><div class="ttdeci">it defaults to i e the first component **Return all components of a vector valued function at a given point&lt; tt &gt; values&lt;/tt &gt; shall have the right size i e **Set&lt; tt &gt; values&lt;/tt &gt; to the point values of the specified component of the function at the&lt; tt &gt; points&lt;/tt &gt; It is assumed that&lt; tt &gt; values&lt;/tt &gt; already has the right size</div><div class="ttdef"><b>Definition:</b> <a href="function__0_8txt_source.html#l00052">function_0.txt:52</a></div></div>
<div class="ttc" id="ahp_2dof__handler_8h_html"><div class="ttname"><a href="hp_2dof__handler_8h.html">dof_handler.h</a></div></div>
<div class="ttc" id="agraph__coloring__0_8txt_html_a068d28578c03dd6b6bb6b32bf268eafd"><div class="ttname"><a href="graph__coloring__0_8txt.html#a068d28578c03dd6b6bb6b32bf268eafd">indices</a></div><div class="ttdeci">namespace containing functions that can color graphs ***Given two sets of indices that are assumed to be determine whether they will have a nonempty intersection The actual intersection is not computed[2.x.0] indices1 A set of indices</div><div class="ttdef"><b>Definition:</b> <a href="graph__coloring__0_8txt_source.html#l00006">graph_coloring_0.txt:6</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
