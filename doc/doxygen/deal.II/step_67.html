<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/step_67.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: The step-67 tutorial program</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The step-67 tutorial program </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This tutorial depends on <a class="el" href="step_33.html">step-33</a>, <a class="el" href="step_48.html">step-48</a>, <a class="el" href="step_59.html">step-59</a>.</p>
<p> 
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#TheEulerequations">The Euler equations</a>
        <li><a href="#HighorderdiscontinuousGalerkindiscretization">High-order discontinuous Galerkin discretization</a>
        <li><a href="#Explicittimeintegration">Explicit time integration</a>
        <li><a href="#Fastevaluationofintegralsbymatrixfreetechniques">Fast evaluation of integrals by matrix-free techniques</a>
        <li><a href="#Evaluationoftheinversemassmatrixwithmatrixfreetechniques">Evaluation of the inverse mass matrix with matrix-free techniques</a>
        <li><a href="#Thetestcase">The test case</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Equationdata">Equation data</a>
        <li><a href="#LowstorageexplicitRungeKuttatimeintegrators">Low-storage explicit Runge&mdash;Kutta time integrators</a>
        <li><a href="#ImplementationofpointwiseoperationsoftheEulerequations">Implementation of point-wise operations of the Euler equations</a>
        <li><a href="#TheEulerOperationclass">The EulerOperation class</a>
      <ul>
        <li><a href="#Localevaluators">Local evaluators</a>
        <li><a href="#Theapplyandrelatedfunctions">The apply() and related functions</a>
      </ul>
        <li><a href="#TheEulerProblemclass">The EulerProblem class</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Programoutput">Program output</a>
        <li><a href="#Convergenceratesfortheanalyticaltestcase">Convergence rates for the analytical test case</a>
        <li><a href="#Resultsforflowinchannelaroundcylinderin2D">Results for flow in channel around cylinder in 2D</a>
        <li><a href="#Resultsforflowinchannelaroundcylinderin3D">Results for flow in channel around cylinder in 3D</a>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
      <ul>
        <li><a href="#Moreadvancednumericalfluxfunctionsandskewsymmetricformulations">More advanced numerical flux functions and skew-symmetric formulations</a>
        <li><a href="#Equippingthecodeforsupersoniccalculations">Equipping the code for supersonic calculations</a>
        <li><a href="#ExtensiontothelinearizedEulerequations">Extension to the linearized Euler equations</a>
        <li><a href="#ExtensiontothecompressibleNavierStokesequations">Extension to the compressible Navier-Stokes equations</a>
        <li><a href="#Usingcellcentricloopsandsharedmemory">Using cell-centric loops and shared memory</a>
    </ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
</p>
<p><br  />
</p>
<p><em> This program was contributed by Martin Kronbichler. Many ideas presented here are the result of common code development with Niklas Fehn, Katharina Kormann, Peter Munch, and Svenja Schoeder.</em></p>
<p><em>This work was partly supported by the German Research Foundation (DFG) through the project "High-order discontinuous Galerkin for the exa-scale" (ExaDG) within the priority program "Software for Exascale Computing" (SPPEXA). </em></p>
<p><a class="anchor" id="Intro"></a> <a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p>This tutorial program solves the Euler equations of fluid dynamics using an explicit time integrator with the matrix-free framework applied to a high-order discontinuous Galerkin discretization in space. For details about the Euler system and an alternative implicit approach, we also refer to the <a class="el" href="step_33.html">step-33</a> tutorial program. You might also want to look at <a class="el" href="step_69.html">step-69</a> for an alternative approach to solving these equations.</p>
<p><a class="anchor" id="TheEulerequations"></a></p><h3>The Euler equations</h3>
<p>The Euler equations are a conservation law, describing the motion of a compressible inviscid gas, </p><p class="formulaDsp">
\[ \frac{\partial \mathbf{w}}{\partial t} + \nabla \cdot \mathbf{F}(\mathbf{w}) = \mathbf{G}(\mathbf w), \]
</p>
<p> where the \(d+2\) components of the solution vector are \(\mathbf{w}=(\rho, \rho u_1,\ldots,\rho u_d,E)^{\mathrm T}\). Here, \(\rho\) denotes the fluid density, \({\mathbf u}=(u_1,\ldots, u_d)^\mathrm T\) the fluid velocity, and \(E\) the energy density of the gas. The velocity is not directly solved for, but rather the variable \(\rho \mathbf{u}\), the linear momentum (since this is the conserved quantity).</p>
<p>The Euler flux function, a \((d+2)\times d\) matrix, is defined as </p><p class="formulaDsp">
\[ \mathbf F(\mathbf w) = \begin{pmatrix} \rho \mathbf{u}\\ \rho \mathbf{u} \otimes \mathbf{u} + \mathbb{I}p\\ (E+p)\mathbf{u} \end{pmatrix} \]
</p>
<p> with \(\mathbb{I}\) the \(d\times d\) identity matrix and \(\otimes\) the outer product; its components denote the mass, momentum, and energy fluxes, respectively. The right hand side forcing is given by </p><p class="formulaDsp">
\[ \mathbf G(\mathbf w) = \begin{pmatrix} 0\\ \rho\mathbf{g}\\ \rho \mathbf{u} \cdot \mathbf{g} \end{pmatrix}, \]
</p>
<p> where the vector \(\mathbf g\) denotes the direction and magnitude of gravity. It could, however, also denote any other external force per unit mass that is acting on the fluid. (Think, for example, of the electrostatic forces exerted by an external electric field on charged particles.)</p>
<p>The three blocks of equations, the second involving \(d\) components, describe the conservation of mass, momentum, and energy. The pressure is not a solution variable but needs to be expressed through a "closure relationship" by the other variables; we here choose the relationship appropriate for a gas with molecules composed of two atoms, which at moderate temperatures is given by \(p=(\gamma - 1) \left(E-\frac 12 \rho \mathbf{u}\cdot \mathbf{u}\right)\) with the constant \(\gamma = 1.4\).</p>
<p><a class="anchor" id="HighorderdiscontinuousGalerkindiscretization"></a></p><h3>High-order discontinuous Galerkin discretization</h3>
<p>For spatial discretization, we use a high-order discontinuous Galerkin (DG) discretization, using a solution expansion of the form </p><p class="formulaDsp">
\[ \mathbf{w}_h(\mathbf{x}, t) = \sum_{j=1}^{n_\mathbf{dofs}} \boldsymbol{\varphi}_j(\mathbf{x}) {w}_j(t). \]
</p>
<p> Here, \(\boldsymbol{\varphi}_j\) denotes the \(j\)th basis function, written in vector form with separate shape functions for the different components and letting \(w_j(t)\) go through the density, momentum, and energy variables, respectively. In this form, the space dependence is contained in the shape functions and the time dependence in the unknown coefficients \(w_j\). As opposed to the continuous finite element method where some shape functions span across element boundaries, the shape functions are local to a single element in DG methods, with a discontinuity from one element to the next. The connection of the solution from one cell to its neighbors is instead imposed by the numerical fluxes specified below. This allows for some additional flexibility, for example to introduce directionality in the numerical method by, e.g., upwinding.</p>
<p>DG methods are popular methods for solving problems of transport character because they combine low dispersion errors with controllable dissipation on barely resolved scales. This makes them particularly attractive for simulation in the field of fluid dynamics where a wide range of active scales needs to be represented and inadequately resolved features are prone to disturb the important well-resolved features. Furthermore, high-order DG methods are well-suited for modern hardware with the right implementation. At the same time, DG methods are no silver bullet. In particular when the solution develops discontinuities (shocks), as is typical for the Euler equations in some flow regimes, high-order DG methods tend to oscillatory solutions, like all high-order methods when not using flux- or slope-limiters. This is a consequence of <a href="https://en.wikipedia.org/wiki/Godunov%27s_theorem">Godunov's theorem</a> that states that any total variation limited (TVD) scheme that is linear (like a basic DG discretization) can at most be first-order accurate. Put differently, since DG methods aim for higher order accuracy, they cannot be TVD on solutions that develop shocks. Even though some communities claim that the numerical flux in DG methods can control dissipation, this is of limited value unless <b>all</b> shocks in a problem align with cell boundaries. Any shock that passes through the interior of cells will again produce oscillatory components due to the high-order polynomials. In the finite element and DG communities, there exist a number of different approaches to deal with shocks, for example the introduction of artificial diffusion on troubled cells (using a troubled-cell indicator based e.g. on a modal decomposition of the solution), a switch to dissipative low-order finite volume methods on a subgrid, or the addition of some limiting procedures. Given the ample possibilities in this context, combined with the considerable implementation effort, we here refrain from the regime of the Euler equations with pronounced shocks, and rather concentrate on the regime of subsonic flows with wave-like phenomena. For a method that works well with shocks (but is more expensive per unknown), we refer to the <a class="el" href="step_69.html">step-69</a> tutorial program.</p>
<p>For the derivation of the DG formulation, we multiply the Euler equations with test functions \(\mathbf{v}\) and integrate over an individual cell \(K\), which gives </p><p class="formulaDsp">
\[ \left(\mathbf{v}, \frac{\partial \mathbf{w}}{\partial t}\right)_{K} + \left(\mathbf{v}, \nabla \cdot \mathbf{F}(\mathbf{w})\right)_{K} = \left(\mathbf{v},\mathbf{G}(\mathbf w)\right)_{K}. \]
</p>
<p>We then integrate the second term by parts, moving the divergence from the solution slot to the test function slot, and producing an integral over the element boundary: </p><p class="formulaDsp">
\[ \left(\mathbf{v}, \frac{\partial \mathbf{w}}{\partial t}\right)_{K} - \left(\nabla \mathbf{v}, \mathbf{F}(\mathbf{w})\right)_{K} + \left&lt;\mathbf{v}, \mathbf{n} \cdot \widehat{\mathbf{F}}(\mathbf{w}) \right&gt;_{\partial K} = \left(\mathbf{v},\mathbf{G}(\mathbf w)\right)_{K}. \]
</p>
<p> In the surface integral, we have replaced the term \(\mathbf{F}(\mathbf w)\) by the term \(\widehat{\mathbf{F}}(\mathbf w)\), the numerical flux. The role of the numerical flux is to connect the solution on neighboring elements and weakly impose continuity of the solution. This ensures that the global coupling of the PDE is reflected in the discretization, despite independent basis functions on the cells. The connectivity to the neighbor is included by defining the numerical flux as a function \(\widehat{\mathbf{F}}(\mathbf w^-, \mathbf w^+)\) of the solution from both sides of an interior face, \(\mathbf w^-\) and \(\mathbf w^+\). A basic property we require is that the numerical flux needs to be <b>conservative</b>. That is, we want all information (i.e., mass, momentum, and energy) that leaves a cell over a face to enter the neighboring cell in its entirety and vice versa. This can be expressed as \(\widehat{\mathbf{F}}(\mathbf w^-, \mathbf w^+) = \widehat{\mathbf{F}}(\mathbf w^+, \mathbf w^-)\), meaning that the numerical flux evaluates to the same result from either side. Combined with the fact that the numerical flux is multiplied by the unit outer normal vector on the face under consideration, which points in opposite direction from the two sides, we see that the conservation is fulfilled. An alternative point of view of the numerical flux is as a single-valued intermediate state that links the solution weakly from both sides.</p>
<p>There is a large number of numerical flux functions available, also called Riemann solvers. For the Euler equations, there exist so-called exact Riemann solvers &ndash; meaning that the states from both sides are combined in a way that is consistent with the Euler equations along a discontinuity &ndash; and approximate Riemann solvers, which violate some physical properties and rely on other mechanisms to render the scheme accurate overall. Approximate Riemann solvers have the advantage of beging cheaper to compute. Most flux functions have their origin in the finite volume community, which are similar to DG methods with polynomial degree 0 within the cells (called volumes). As the volume integral of the Euler operator \(\mathbf{F}\) would disappear for constant solution and test functions, the numerical flux must fully represent the physical operator, explaining why there has been a large body of research in that community. For DG methods, consistency is guaranteed by higher order polynomials within the cells, making the numerical flux less of an issue and usually affecting only the convergence rate, e.g., whether the solution converges as \(\mathcal O(h^p)\), \(\mathcal O(h^{p+1/2})\) or \(\mathcal O(h^{p+1})\) in the \(L_2\) norm for polynomials of degree \(p\). The numerical flux can thus be seen as a mechanism to select more advantageous dissipation/dispersion properties or regarding the extremal eigenvalue of the discretized and linearized operator, which affect the maximal admissible time step size in explicit time integrators.</p>
<p>In this tutorial program, we implement two variants of fluxes that can be controlled via a switch in the program (of course, it would be easy to make them a run time parameter controlled via an input file). The first flux is the local Lax&ndash;Friedrichs flux </p><p class="formulaDsp">
\[ \hat{\mathbf{F}}(\mathbf{w}^-,\mathbf{w}^+) = \frac{\mathbf{F}(\mathbf{w}^-)+\mathbf{F}(\mathbf{w}^+)}{2} + \frac{\lambda}{2}\left[\mathbf{w}^--\mathbf{w}^+\right]\otimes \mathbf{n^-}. \]
</p>
<p>In the original definition of the Lax&ndash;Friedrichs flux, a factor \(\lambda = \max\left(\|\mathbf{u}^-\|+c^-, \|\mathbf{u}^+\|+c^+\right)\) is used (corresponding to the maximal speed at which information is moving on the two sides of the interface), stating that the difference between the two states, \([\![\mathbf{w}]\!]\) is penalized by the largest eigenvalue in the Euler flux, which is \(\|\mathbf{u}\|+c\), where \(c=\sqrt{\gamma p / \rho}\) is the speed of sound. In the implementation below, we modify the penalty term somewhat, given that the penalty is of approximate nature anyway. We use </p><p class="formulaDsp">
\begin{align*} \lambda &amp;= \frac{1}{2}\max\left(\sqrt{\|\mathbf{u^-}\|^2+(c^-)^2}, \sqrt{\|\mathbf{u}^+\|^2+(c^+)^2}\right) \\ &amp;= \frac{1}{2}\sqrt{\max\left(\|\mathbf{u^-}\|^2+(c^-)^2, \|\mathbf{u}^+\|^2+(c^+)^2\right)}. \end{align*}
</p>
<p> The additional factor \(\frac 12\) reduces the penalty strength (which results in a reduced negative real part of the eigenvalues, and thus increases the admissible time step size). Using the squares within the sums allows us to reduce the number of expensive square root operations, which is 4 for the original Lax&ndash;Friedrichs definition, to a single one. This simplification leads to at most a factor of 2 in the reduction of the parameter \(\lambda\), since \(\|\mathbf{u}\|^2+c^2 \leq \|\mathbf{u}\|^2+2 c |\mathbf{u}\| + c^2 = \left(\|\mathbf{u}\|+c\right)^2 \leq 2 \left(\|\mathbf{u}\|^2+c^2\right)\), with the last inequality following from Young's inequality.</p>
<p>The second numerical flux is one proposed by Harten, Lax and van Leer, called the HLL flux. It takes the different directions of propagation of the Euler equations into account, depending on the speed of sound. It utilizes some intermediate states \(\bar{\mathbf{u}}\) and \(\bar{c}\) to define the two branches \(s^\mathrm{p} = \max\left(0, \bar{\mathbf{u}}\cdot \mathbf{n} + \bar{c}\right)\) and \(s^\mathrm{n} = \min\left(0, \bar{\mathbf{u}}\cdot \mathbf{n} - \bar{c}\right)\). From these branches, one then defines the flux </p><p class="formulaDsp">
\[ \hat{\mathbf{F}}(\mathbf{w}^-,\mathbf{w}^+) = \frac{s^\mathrm{p} \mathbf{F}(\mathbf{w}^-)-s^\mathrm{n} \mathbf{F}(\mathbf{w}^+)} {s^\mathrm p - s^\mathrm{n} } + \frac{s^\mathrm{p} s^\mathrm{n}}{s^\mathrm{p}-s^\mathrm{n}} \left[\mathbf{w}^--\mathbf{w}^+\right]\otimes \mathbf{n^-}. \]
</p>
<p> Regarding the definition of the intermediate state \(\bar{\mathbf{u}}\) and \(\bar{c}\), several variants have been proposed. The variant originally proposed uses a density-averaged definition of the velocity, \(\bar{\mathbf{u}} = \frac{\sqrt{\rho^-} \mathbf{u}^- + \sqrt{\rho^+}\mathbf{u}^+}{\sqrt{\rho^-} + \sqrt{\rho^+}}\). Since we consider the Euler equations without shocks, we simply use arithmetic means, \(\bar{\mathbf{u}} = \frac{\mathbf{u}^- + \mathbf{u}^+}{2}\) and \(\bar{c} = \frac{c^- + c^+}{2}\), with \(c^{\pm} = \sqrt{\gamma p^{\pm} / \rho^{\pm}}\), in this tutorial program, and leave other variants to a possible extension. We also note that the HLL flux has been extended in the literature to the so-called HLLC flux, where C stands for the ability to represent contact discontinuities.</p>
<p>At the boundaries with no neighboring state \(\mathbf{w}^+\) available, it is common practice to deduce suitable exterior values from the boundary conditions (see the general literature on DG methods for details). In this tutorial program, we consider three types of boundary conditions, namely <b>inflow boundary conditions</b> where all components are prescribed, </p><p class="formulaDsp">
\[ \mathbf{w}^+ = \begin{pmatrix} \rho_\mathrm{D}(t)\\ (\rho \mathbf u)_{\mathrm D}(t) \\ E_\mathrm{D}(t)\end{pmatrix} \quad \text{(Dirichlet)}, \]
</p>
<p> <b>subsonic outflow boundaries</b>, where we do not prescribe exterior solutions as the flow field is leaving the domain and use the interior values instead; we still need to prescribe the energy as there is one incoming characteristic left in the Euler flux, </p><p class="formulaDsp">
\[ \mathbf{w}^+ = \begin{pmatrix} \rho^-\\ (\rho \mathbf u)^- \\ E_\mathrm{D}(t)\end{pmatrix} \quad \text{(mixed Neumann/Dirichlet)}, \]
</p>
<p> and <b>wall boundary condition</b> which describe a no-penetration configuration: </p><p class="formulaDsp">
\[ \mathbf{w}^+ = \begin{pmatrix} \rho^-\\ (\rho \mathbf u)^- - 2 [(\rho \mathbf u)^-\cdot \mathbf n] \mathbf{n} \\ E^-\end{pmatrix}. \]
</p>
<p>The polynomial expansion of the solution is finally inserted to the weak form and test functions are replaced by the basis functions. This gives a discrete in space, continuous in time nonlinear system with a finite number of unknown coefficient values \(w_j\), \(j=1,\ldots,n_\text{dofs}\). Regarding the choice of the polynomial degree in the DG method, there is no consensus in literature as of 2019 as to what polynomial degrees are most efficient and the decision is problem-dependent. Higher order polynomials ensure better convergence rates and are thus superior for moderate to high accuracy requirements for <b>smooth</b> solutions. At the same time, the volume-to-surface ratio of where degrees of freedom are located, increases with higher degrees, and this makes the effect of the numerical flux weaker, typically reducing dissipation. However, in most of the cases the solution is not smooth, at least not compared to the resolution that can be afforded. This is true for example in incompressible fluid dynamics, compressible fluid dynamics, and the related topic of wave propagation. In this pre-asymptotic regime, the error is approximately proportional to the numerical resolution, and other factors such as dispersion errors or the dissipative behavior become more important. Very high order methods are often ruled out because they come with more restrictive CFL conditions measured against the number of unknowns, and they are also not as flexible when it comes to representing complex geometries. Therefore, polynomial degrees between two and six are most popular in practice, see e.g. the efficiency evaluation in <b>[FehnWallKronbichler2019]</b> and references cited therein.</p>
<p><a class="anchor" id="Explicittimeintegration"></a></p><h3>Explicit time integration</h3>
<p>To discretize in time, we slightly rearrange the weak form and sum over all cells: </p><p class="formulaDsp">
\[ \sum_{K \in \mathcal T_h} \left(\boldsymbol{\varphi}_i, \frac{\partial \mathbf{w}}{\partial t}\right)_{K} = \sum_{K\in \mathcal T_h} \left[ \left(\nabla \boldsymbol{\varphi}_i, \mathbf{F}(\mathbf{w})\right)_{K} -\left&lt;\boldsymbol{\varphi}_i, \mathbf{n} \cdot \widehat{\mathbf{F}}(\mathbf{w})\right&gt;_{\partial K} + \left(\boldsymbol{\varphi}_i,\mathbf{G}(\mathbf w)\right)_{K} \right], \]
</p>
<p> where \(\boldsymbol{\varphi}_i\) runs through all basis functions with from 1 to \(n_\text{dofs}\).</p>
<p>We now denote by \(\mathcal M\) the mass matrix with entries \(\mathcal M_{ij} = \sum_{K} \left(\boldsymbol{\varphi}_i, \boldsymbol{\varphi}_j\right)_K\), and by </p><p class="formulaDsp">
\[ \mathcal L_h(t,\mathbf{w}_h) = \left[\sum_{K\in \mathcal T_h} \left[ \left(\nabla \boldsymbol{\varphi}_i, \mathbf{F}(\mathbf{w}_h)\right)_{K} - \left&lt;\boldsymbol{\varphi}_i, \mathbf{n} \cdot \widehat{\mathbf{F}}(\mathbf{w}_h)\right&gt;_{\partial K} + \left(\boldsymbol{\varphi}_i,\mathbf{G}(\mathbf w_h)\right)_{K} \right]\right]_{i=1,\ldots,n_\text{dofs}}. \]
</p>
<p> the operator evaluating the right-hand side of the Euler operator, given a function \(\mathbf{w}_h\) associated with a global vector of unknowns and the finite element in use. This function \(\mathcal L_h\) is explicitly time-dependent as the numerical flux evaluated at the boundary will involve time-dependent data \(\rho_\mathrm{D}\), \((\rho \mathbf{u})_\mathrm{D}\), and \(E_\mathbf{D}\) on some parts of the boundary, depending on the assignment of boundary conditions. With this notation, we can write the discrete in space, continuous in time system compactly as </p><p class="formulaDsp">
\[ \mathcal M \frac{\partial \mathbf{w}_h}{\partial t} = \mathcal L_h(t, \mathbf{w}_h), \]
</p>
<p> where we have taken the liberty to also denote the global solution vector by \(\mathbf{w}_h\) (in addition to the the corresponding finite element function). Equivalently, the system above has the form </p><p class="formulaDsp">
\[ \frac{\partial \mathbf{w}_h}{\partial t} = \mathcal M^{-1} \mathcal L_h(t, \mathbf{w}_h). \]
</p>
<p>For hyperbolic systems discretized by high-order discontinuous Galerkin methods, explicit time integration of this system is very popular. This is due to the fact that the mass matrix \(\mathcal M\) is block-diagonal (with each block corresponding to only variables of the same kind defined on the same cell) and thus easily inverted. In each time step &ndash; or stage of a Runge&ndash;Kutta scheme &ndash; one only needs to evaluate the differential operator once using the given data and subsequently apply the inverse of the mass matrix. For implicit time stepping, on the other hand, one would first have to linearize the equations and then iteratively solve the linear system, which involves several residual evaluations and at least a dozen applications of the linearized operator, as has been demonstrated in the <a class="el" href="step_33.html">step-33</a> tutorial program.</p>
<p>Of course, the simplicity of explicit time stepping comes with a price, namely conditional stability due to the so-called Courant&ndash;Friedrichs&ndash;Lewy (CFL) condition. It states that the time step cannot be larger than the fastest propagation of information by the discretized differential operator. In more modern terms, the speed of propagation corresponds to the largest eigenvalue in the discretized operator, and in turn depends on the mesh size, the polynomial degree \(p\) and the physics of the Euler operator, i.e., the eigenvalues of the linearization of \(\mathbf F(\mathbf w)\) with respect to \(\mathbf{w}\). In this program, we set the time step as follows: </p><p class="formulaDsp">
\[ \Delta t = \frac{\mathrm{Cr}}{p^{1.5}}\left(\frac{1} {\max\left[\frac{\|\mathbf{u}\|}{h_u} + \frac{c}{h_c}\right]}\right), \]
</p>
<p>with the maximum taken over all quadrature points and all cells. The dimensionless number \(\mathrm{Cr}\) denotes the Courant number and can be chosen up to a maximally stable number \(\mathrm{Cr}_\text{max}\), whose value depends on the selected time stepping method and its stability properties. The power \(p^{1.5}\) used for the polynomial scaling is heuristic and represents the closest fit for polynomial degrees between 1 and 8, see e.g. <b>[SchoederKormann2018]</b>. In the limit of higher degrees, \(p&gt;10\), a scaling of \(p^2\) is more accurate, related to the inverse estimates typically used for interior penalty methods. Regarding the <em>effective</em> mesh sizes \(h_u\) and \(h_c\) used in the formula, we note that the convective transport is directional. Thus an appropriate scaling is to use the element length in the direction of the velocity \(\mathbf u\). The code below derives this scaling from the inverse of the Jacobian from the reference to real cell, i.e., we approximate \(\frac{\|\mathbf{u}\|}{h_u} \approx \|J^{-1} \mathbf u\|_{\infty}\). The acoustic waves, instead, are isotropic in character, which is why we use the smallest feature size, represented by the smallest singular value of \(J\), for the acoustic scaling \(h_c\). Finally, we need to add the convective and acoustic limits, as the Euler equations can transport information with speed \(\|\mathbf{u}\|+c\).</p>
<p>In this tutorial program, we use a specific variant of <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">explicit Runge&ndash;Kutta methods</a>, which in general use the following update procedure from the state \(\mathbf{w}_h^{n}\) at time \(t^n\) to the new time \(t^{n+1}\) with \(\Delta t = t^{n+1}-t^n\): </p><p class="formulaDsp">
\[ \begin{aligned} \mathbf{k}_1 &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n, \mathbf{w}_h^n\right), \\ \mathbf{k}_2 &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n+c_2\Delta t, \mathbf{w}_h^n + a_{21} \Delta t \mathbf{k}_1\right), \\ &amp;\vdots \\ \mathbf{k}_s &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n+c_s\Delta t, \mathbf{w}_h^n + \sum_{j=1}^{s-1} a_{sj} \Delta t \mathbf{k}_j\right), \\ \mathbf{w}_h^{n+1} &amp;= \mathbf{w}_h^n + \Delta t\left(b_1 \mathbf{k}_1 + b_2 \mathbf{k}_2 + \ldots + b_s \mathbf{k}_s\right). \end{aligned} \]
</p>
<p> The vectors \(\mathbf{k}_i\), \(i=1,\ldots,s\), in an \(s\)-stage scheme are evaluations of the operator at some intermediate state and used to define the end-of-step value \(\mathbf{w}_h^{n+1}\) via some linear combination. The scalar coefficients in this scheme, \(c_i\), \(a_{ij}\), and \(b_j\), are defined such that certain conditions are satisfied for higher order schemes, the most basic one being \(c_i = \sum_{j=1}^{i-1}a_{ij}\). The parameters are typically collected in the form of a so-called <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Explicit_Runge%E2%80%93Kutta_methods">Butcher tableau</a> that collects all of the coefficients that define the scheme. For a five-stage scheme, it would look like this: </p><p class="formulaDsp">
\[ \begin{array}{c|ccccc} 0 \\ c_2 &amp; a_{21} \\ c_3 &amp; a_{31} &amp; a_{32} \\ c_4 &amp; a_{41} &amp; a_{42} &amp; a_{43} \\ c_5 &amp; a_{51} &amp; a_{52} &amp; a_{53} &amp; a_{54} \\ \hline &amp; b_1 &amp; b_2 &amp; b_3 &amp; b_4 &amp; b_5 \end{array} \]
</p>
<p>In this tutorial program, we use a subset of explicit Runge&ndash;Kutta methods, so-called low-storage Runge&ndash;Kutta methods (LSRK), which assume additional structure in the coefficients. In the variant used by reference <b>[KennedyCarpenterLewis2000]</b>, the assumption is to use Butcher tableaus of the form </p><p class="formulaDsp">
\[ \begin{array}{c|ccccc} 0 \\ c_2 &amp; a_1 \\ c_3 &amp; b_1 &amp; a_2 \\ c_4 &amp; b_1 &amp; b_2 &amp; a_3 \\ c_5 &amp; b_1 &amp; b_2 &amp; b_3 &amp; a_4 \\ \hline &amp; b_1 &amp; b_2 &amp; b_3 &amp; b_4 &amp; b_5 \end{array} \]
</p>
<p> With such a definition, the update to \(\mathbf{w}_h^n\) shares the storage with the information for the intermediate values \(\mathbf{k}_i\). Starting with \(\mathbf{w}^{n+1}=\mathbf{w}^n\) and \(\mathbf{r}_1 = \mathbf{w}^n\), the update in each of the \(s\) stages simplifies to </p><p class="formulaDsp">
\[ \begin{aligned} \mathbf{k}_i &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n+c_i\Delta t, \mathbf{r}_{i} \right),\\ \mathbf{r}_{i+1} &amp;= \mathbf{w}_h^{n+1} + \Delta t \, a_i \mathbf{k}_i,\\ \mathbf{w}_h^{n+1} &amp;= \mathbf{w}_h^{n+1} + \Delta t \, b_i \mathbf{k}_i. \end{aligned} \]
</p>
<p> Besides the vector \(\mathbf w_h^{n+1}\) that is successively updated, this scheme only needs two auxiliary vectors, namely the vector \(\mathbf{k}_i\) to hold the evaluation of the differential operator, and the vector \(\mathbf{r}_i\) that holds the right-hand side for the differential operator application. In subsequent stages \(i\), the values \(\mathbf{k}_i\) and \(\mathbf{r}_i\) can use the same storage.</p>
<p>The main advantages of low-storage variants are the reduced memory consumption on the one hand (if a very large number of unknowns must be fit in memory, holding all \(\mathbf{k}_i\) to compute subsequent updates can be a limit already for \(s\) in between five and eight &ndash; recall that we are using an explicit scheme, so we do not need to store any matrices that are typically much larger than a few vectors), and the reduced memory access on the other. In this program, we are particularly interested in the latter aspect. Since cost of operator evaluation is only a small multiple of the cost of simply streaming the input and output vector from memory with the optimized matrix-free methods of deal.II, we must consider the cost of vector updates, and low-storage variants can deliver up to twice the throughput of conventional explicit Runge&ndash;Kutta methods for this reason, see e.g. the analysis in <b>[SchoederKormann2018]</b>.</p>
<p>Besides three variants for third, fourth and fifth order accuracy from the reference <b>[KennedyCarpenterLewis2000]</b>, we also use a fourth-order accurate variant with seven stages that was optimized for acoustics setups from <b>[TseliosSimos2007]</b>. Acoustic problems are one of the interesting aspects of the subsonic regime of the Euler equations where compressibility leads to the transmission of sound waves; often, one uses further simplifications of the linearized Euler equations around a background state or the acoustic wave equation around a fixed frame.</p>
<p><a class="anchor" id="Fastevaluationofintegralsbymatrixfreetechniques"></a></p><h3>Fast evaluation of integrals by matrix-free techniques</h3>
<p>The major ingredients used in this program are the fast matrix-free techniques we use to evaluate the operator \(\mathcal L_h\) and the inverse mass matrix \(\mathcal M\). Actually, the term <em>matrix-free</em> is a slight misnomer, because we are working with a nonlinear operator and do not linearize the operator that in turn could be represented by a matrix. However, fast evaluation of integrals has become popular as a replacement of sparse matrix-vector products, as shown in <a class="el" href="step_37.html">step-37</a> and <a class="el" href="step_59.html">step-59</a>, and we have coined this infrastructure <em>matrix-free functionality</em> in deal.II for this reason. Furthermore, the inverse mass matrix is indeed applied in a matrix-free way, as detailed below.</p>
<p>The matrix-free infrastructure allows us to quickly evaluate the integrals in the weak forms. The ingredients are the fast interpolation from solution coefficients into values and derivatives at quadrature points, point-wise operations at quadrature points (where we implement the differential operator as derived above), as well as multiplication by all test functions and summation over quadrature points. The first and third component make use of sum factorization and have been extensively discussed in the <a class="el" href="step_37.html">step-37</a> tutorial program for the cell integrals and <a class="el" href="step_59.html">step-59</a> for the face integrals. The only difference is that we now deal with a system of \(d+2\) components, rather than the scalar systems in previous tutorial programs. In the code, all that changes is a template argument of the <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> classes, the one to set the number of components. The access to the vector is the same as before, all handled transparently by the evaluator. We also note that the variant with a single evaluator chosen in the code below is not the only choice &ndash; we could also have used separate evalators for the separate components \(\rho\), \(\rho \mathbf u\), and \(E\); given that we treat all components similarly (also reflected in the way we state the equation as a vector system), this would be more complicated here. As before, the <a class="el" href="classFEEvaluation.html">FEEvaluation</a> class provides explicit vectorization by combining the operations on several cells (and faces), involving data types called <a class="el" href="classVectorizedArray.html">VectorizedArray</a>. Since the arithmetic operations are overloaded for this type, we do not have to bother with it all that much, except for the evaluation of functions through the <a class="el" href="classFunction.html">Function</a> interface, where we need to provide particular <em>vectorized</em> evaluations for several quadrature point locations at once.</p>
<p>A more substantial change in this program is the operation at quadrature points: Here, the multi-component evaluators provide us with return types not discussed before. Whereas FEEvaluation::get_value() would return a scalar (more precisely, a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> type due to vectorization across cells) for the Laplacian of <a class="el" href="step_37.html">step-37</a>, it now returns a type that is <code><a class="el" href="classTensor.html">Tensor</a>&lt;1,dim+2,<a class="el" href="classVectorizedArray.html">VectorizedArray</a>&lt;Number&gt;&gt;</code>. Likewise, the gradient type is now <code><a class="el" href="classTensor.html">Tensor</a>&lt;1,dim+2,<a class="el" href="classTensor.html">Tensor</a>&lt;1,dim,<a class="el" href="classVectorizedArray.html">VectorizedArray</a>&lt;Number&gt;&gt;&gt;</code>, where the outer tensor collects the <code>dim+2</code> components of the Euler system, and the inner tensor the partial derivatives in the various directions. For example, the flux \(\mathbf{F}(\mathbf{w})\) of the Euler system is of this type. In order to reduce the amount of code we have to write for spelling out these types, we use the C++ <code>auto</code> keyword where possible.</p>
<p>From an implementation point of view, the nonlinearity is not a big difficulty: It is introduced naturally as we express the terms of the Euler weak form, for example in the form of the momentum term \(\rho \mathbf{u} \otimes \mathbf{u}\). To obtain this expression, we first deduce the velocity \(\mathbf{u}\) from the momentum variable \(\rho \mathbf{u}\). Given that \(\rho \mathbf{u}\) is represented as a \(p\)-degree polynomial, as is \(\rho\), the velocity \(\mathbf{u}\) is a rational expression in terms of the reference coordinates \(\hat{\mathbf{x}}\). As we perform the multiplication \((\rho \mathbf{u})\otimes \mathbf{u}\), we obtain an expression that is the ratio of two polynomials, with polynomial degree \(2p\) in the numerator and polynomial degree \(p\) in the denominator. Combined with the gradient of the test function, the integrand is of degree \(3p\) in the numerator and \(p\) in the denominator already for affine cells, i.e., for parallelograms/ parallelepipeds. For curved cells, additional polynomial and rational expressions appear when multiplying the integrand by the determinant of the Jacobian of the mapping. At this point, one usually needs to give up on insisting on exact integration, and take whatever accuracy the Gaussian (more precisely, Gauss&ndash;Legrende) quadrature provides. The situation is then similar to the one for the Laplace equation, where the integrand contains rational expressions on non-affince cells and is also only integrated approximately. As these formulas only integrate polynomials exactly, we have to live with the <a href="https://mathoverflow.net/questions/26018/what-are-variational-crimes-and-who-coined-the-term">variational crime</a> in the form of an integration error.</p>
<p>While inaccurate integration is usually tolerable for elliptic problems, for hyperbolic problems inexact integration causes some headache in the form of an effect called <b>aliasing</b>. The term comes from signal processing and expresses the situation of inappropriate, too coarse sampling. In terms of quadrature, the inappropriate sampling means that we use too few quadrature points compared to what would be required to accurately sample the variable-coefficient integrand. It has been shown in the DG literature that aliasing errors can introduce unphysical oscillations in the numerical solution for <em>barely</em> resolved simulations. The fact that aliasing mostly affects coarse resolutions &ndash; whereas finer meshes with the same scheme work fine &ndash; is not surprising because well-resolved simulations tend to be smooth on length-scales of a cell (i.e., they have small coefficients in the higher polynomial degrees that are missed by too few quadrature points, whereas the main solution contribution in the lower polynomial degrees is still well-captured &ndash; this is simply a consequence of Taylor's theorem). To address this topic, various approaches have been proposed in the DG literature. One technique is filtering which damps the solution components pertaining to higher polynomial degrees. As the chosen nodal basis is not hierarchical, this would mean to transform from the nodal basis into a hierarchical one (e.g., a modal one based on Legendre polynomials) where the contributions within a cell are split by polynomial degrees. In that basis, one could then multiply the solution coefficients associated with higher degrees by a small number, keep the lower ones intact (to not destroy consistency), and then transform back to the nodal basis. However, filters reduce the accuracy of the method. Another, in some sense simpler, strategy is to use more quadrature points to capture non-linear terms more accurately. Using more than \(p+1\) quadrature points per coordinate directions is sometimes called over-integration or consistent integration. The latter name is most common in the context of the incompressible Navier-Stokes equations, where the \(\mathbf{u}\otimes \mathbf{u}\) nonlinearity results in polynomial integrands of degree \(3p\) (when also considering the test function), which can be integrated exactly with \(\textrm{floor}\left(\frac{3p}{2}\right)+1\) quadrature points per direction as long as the element geometry is affine. In the context of the Euler equations with non-polynomial integrands, the choice is less clear. Depending on the variation in the various variables both \(\textrm{floor}\left(\frac{3p}{2}\right)+1\) or \(2p+1\) points (integrating exactly polynomials of degree \(3p\) or \(4p\), respectively) are common.</p>
<p>To reflect this variability in the choice of quadrature in the program, we keep the number of quadrature points a variable to be specified just as the polynomial degree, and note that one would make different choices depending also on the flow configuration. The default choice is \(p+2\) points &ndash; a bit more than the minimum possible of \(p+1\) points. The <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> classes allow to seamlessly change the number of points by a template parameter, such that the program does not get more complicated because of that.</p>
<p><a class="anchor" id="Evaluationoftheinversemassmatrixwithmatrixfreetechniques"></a></p><h3>Evaluation of the inverse mass matrix with matrix-free techniques</h3>
<p>The last ingredient is the evaluation of the inverse mass matrix \(\mathcal M^{-1}\). In DG methods with explicit time integration, mass matrices are block-diagonal and thus easily inverted &ndash; one only needs to invert the diagonal blocks. However, given the fact that matrix-free evaluation of integrals is closer in cost to the access of the vectors only, even the application of a block-diagonal matrix (e.g. via an array of LU factors) would be several times more expensive than evaluation of \(\mathcal L_h\) simply because just storing and loading matrices of size <code>dofs_per_cell</code> times <code>dofs_per_cell</code> for higher order finite elements repeatedly is expensive. As this is clearly undesirable, part of the community has moved to bases where the mass matrix is diagonal, for example the <em>L<sub>2</sub></em>-orthogonal Legendre basis using hierarchical polynomials or Lagrange polynomials on the points of the Gaussian quadrature (which is just another way of utilizing Legendre information). While the diagonal property breaks down for deformed elements, the error made by taking a diagonal mass matrix and ignoring the rest (a variant of mass lumping, though not the one with an additional integration error as utilized in <a class="el" href="step_48.html">step-48</a>) has been shown to not alter discretization accuracy. The Lagrange basis in the points of Gaussian quadrature is sometimes also referred to as a collocation setup, as the nodal points of the polynomials coincide (= are "co-located") with the points of quadrature, obviating some interpolation operations. Given the fact that we want to use more quadrature points for nonlinear terms in \(\mathcal L_h\), however, the collocation property is lost. (More precisely, it is still used in <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> after a change of basis, see the matrix-free paper <b>[KronbichlerKormann2019]</b>.)</p>
<p>In this tutorial program, we use the collocation idea for the application of the inverse mass matrix, but with a slight twist. Rather than using the collocation via Lagrange polynomials in the points of Gaussian quadrature, we prefer a conventional Lagrange basis in Gauss-Lobatto points as those make the evaluation of face integrals cheap. This is because for Gauss-Lobatto points, some of the node points are located on the faces of the cell and it is not difficult to show that on any given face, the only shape functions with non-zero values are exactly the ones whose node points are in fact located on that face. One could of course also use the Gauss-Lobatto quadrature (with some additional integration error) as was done in <a class="el" href="step_48.html">step-48</a>, but we do not want to sacrifice accuracy as these quadrature formulas are generally of lower order than the general Gauss quadrature formulas. Instead, we use an idea described in the reference <b>[KronbichlerSchoeder2016]</b> where it was proposed to change the basis for the sake of applying the inverse mass matrix. Let us denote by \(S\) the matrix of shape functions evaluated at quadrature points, with shape functions in the row of the matrix and quadrature points in columns. Then, the mass matrix on a cell \(K\) is given by </p><p class="formulaDsp">
\[ \mathcal M^K = S J^K S^\mathrm T. \]
</p>
<p> Here, \(J^K\) is the diagonal matrix with the determinant of the Jacobian times the quadrature weight (JxW) as entries. The matrix \(S\) is constructed as the Kronecker product (tensor product) of one-dimensional matrices, e.g. in 3D as </p><p class="formulaDsp">
\[ S = S_{\text{1D}}\otimes S_{\text{1D}}\otimes S_{\text{1D}}, \]
</p>
<p> which is the result of the basis functions being a tensor product of one-dimensional shape functions and the quadrature formula being the tensor product of 1D quadrature formulas. For the case that the number of polynomials equals the number of quadrature points, all matrices in \(S J^K S^\mathrm T\) are square, and also the ingredients to \(S\) in the Kronecker product are square. Thus, one can invert each matrix to form the overall inverse, </p><p class="formulaDsp">
\[ \left(\mathcal M^K\right)^{-1} = S_{\text{1D}}^{-\mathrm T}\otimes S_{\text{1D}}^{-\mathrm T}\otimes S_{\text{1D}}^{-\mathrm T} \left(J^K\right)^{-1} S_{\text{1D}}^{-1}\otimes S_{\text{1D}}^{-1}\otimes S_{\text{1D}}^{-1}. \]
</p>
<p> This formula is of exactly the same structure as the steps in the forward evaluation of integrals with sum factorization techniques (i.e., the <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and <a class="el" href="classMatrixFree.html">MatrixFree</a> framework of deal.II). Hence, we can utilize the same code paths with a different interpolation matrix, \(S_{\mathrm{1D}}^{-\mathrm{T}}\) rather than \(S_{\mathrm{1D}}\).</p>
<p>The class <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a> implements this operation: It changes from the basis contained in the finite element (in this case, <a class="el" href="classFE__DGQ.html">FE_DGQ</a>) to the Lagrange basis in Gaussian quadrature points. Here, the inverse of a diagonal mass matrix can be evaluated, which is simply the inverse of the <code>JxW</code> factors (i.e., the quadrature weight times the determinant of the Jacobian from reference to real coordinates). Once this is done, we can change back to the standard nodal Gauss-Lobatto basis.</p>
<p>The advantage of this particular way of applying the inverse mass matrix is a cost similar to the forward application of a mass matrix, which is cheaper than the evaluation of the spatial operator \(\mathcal L_h\) with over-integration and face integrals. (We will demonstrate this with detailed timing information in the <a href="#Results">results section</a>.) In fact, it is so cheap that it is limited by the bandwidth of reading the source vector, reading the diagonal, and writing into the destination vector on most modern architectures. The hardware used for the result section allows to do the computations at least twice as fast as the streaming of the vectors from memory.</p>
<p><a class="anchor" id="Thetestcase"></a></p><h3>The test case</h3>
<p>In this tutorial program, we implement two test cases. The first case is a convergence test limited to two space dimensions. It runs a so-called isentropic vortex which is transported via a background flow field. The second case uses a more exciting setup: We start with a cylinder immersed in a channel, using the <a class="el" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder()</a> function. Here, we impose a subsonic initial field at Mach number of \(\mathrm{Ma}=0.307\) with a constant velocity in \(x\) direction. At the top and bottom walls as well as at the cylinder, we impose a no-penetration (i.e., tangential flow) condition. This setup forces the flow to re-orient as compared to the initial condition, which results in a big sound wave propagating away from the cylinder. In upstream direction, the wave travels more slowly (as it has to move against the oncoming gas), including a discontinuity in density and pressure. In downstream direction, the transport is faster as sound propagation and fluid flow go in the same direction, which smears out the discontinuity somewhat. Once the sound wave hits the upper and lower walls, the sound is reflected back, creating some nice shapes as illustrated in the <a href="#Results">results section</a> below.</p>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p>The include files are similar to the previous matrix-free tutorial programs <a class="el" href="step_37.html">step-37</a>, <a class="el" href="step_48.html">step-48</a>, and <a class="el" href="step_59.html">step-59</a></p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
</div><!-- fragment --><p>The following file includes the CellwiseInverseMassMatrix data structure that we will use for the mass matrix inversion, the only new include file for this tutorial program:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p>Similarly to the other matrix-free tutorial programs, we collect all parameters that control the execution of the program at the top of the file. Besides the dimension and polynomial degree we want to run with, we also specify a number of points in the Gaussian quadrature formula we want to use for the nonlinear terms in the Euler equations. Furthermore, we specify the time interval for the time-dependent problem, and implement two different test cases. The first one is an analytical solution in 2D, whereas the second is a channel flow around a cylinder as described in the introduction. Depending on the test case, we also change the final time up to which we run the simulation, and a variable <code>output_tick</code> that specifies in which intervals we want to write output (assuming that the tick is larger than the time step size).</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 0;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceStep37.html#a92034819b3a2b370b456b2e415e24f55">dimension</a>            = 2;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 3;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>            = 5;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 2;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
<div class="line"> </div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
</div><!-- fragment --><p>Next off are some details of the time integrator, namely a Courant number that scales the time step size in terms of the formula \(\Delta t = \text{Cr} n_\text{stages} \frac{h}{(p+1)^{1.5} (\|\mathbf{u} + c)_\text{max}}\), as well as a selection of a few low-storage Runge&ndash;Kutta methods. We specify the Courant number per stage of the Runge&ndash;Kutta scheme, as this gives a more realistic expression of the numerical cost for schemes of various numbers of stages.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>, 1.5);</div>
<div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>, <span class="comment">/* Tselios, Simos, 2007 */</span></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">};</div>
<div class="line">constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
</div><!-- fragment --><p>Eventually, we select a detail of the spatial discretization, namely the numerical flux (Riemann solver) at the faces between cells. For this program, we have implemented a modified variant of the Lax&ndash;Friedrichs flux and the Harten&ndash;Lax&ndash;van Leer (HLL) flux.</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">};</div>
<div class="line">constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
</div><!-- fragment --><p><a class="anchor" id="Equationdata"></a> </p><h3>Equation data</h3>
<p>We now define a class with the exact solution for the test case 0 and one with a background flow field for test case 1 of the channel. Given that the Euler equations are a problem with \(d+2\) equations in \(d\) dimensions, we need to tell the <a class="el" href="classFunction.html">Function</a> base class about the correct number of components.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><p>As far as the actual function implemented is concerned, the analytical test case is an isentropic vortex case (see e.g. the book by Hesthaven and Warburton, Example 6.1 in Section 6.6 on page 209) which fulfills the Euler equations with zero force term on the right hand side. Given that definition, we return either the density, the momentum, or the energy depending on which component is requested. Note that the original definition of the density involves the \(\frac{1}{\gamma -1}\)-th power of some expression. Since <code><a class="el" href="base_2numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow()</a></code> has pretty slow implementations on some systems, we replace it by logarithm followed by exponentiation (of base 2), which is mathematically equivalent but usually much better optimized. This formula might lose accuracy in the last digits for very small numbers compared to <code><a class="el" href="base_2numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow()</a></code>, but we are happy with it anyway, since small numbers map to data close to 1.</p>
<p>For the channel test case, we simply select a density of 1, a velocity of 0.4 in \(x\) direction and zero in the other directions, and an energy that corresponds to a speed of sound of 1.3 measured against the background velocity field, computed from the relation \(E = \frac{c^2}{\gamma (\gamma -1)} + \frac 12 \rho \|u\|^2\).</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> 0:</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">          x0[0] = 5.;</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">            (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> - x0).norm_square() - 2. * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - x0[0]) * t + t * t;</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">            <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">            std::abs(1. - (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * 0.25 * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log * (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1] - x0[1]);</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - t - x0[0]);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                std::exp2(density_log * (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) +</div>
<div class="line">                     0.5 * (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u * u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">case</span> 1:</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">            <span class="keywordflow">return</span> 1.;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">            <span class="keywordflow">return</span> 0.4;</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">            <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">return</span> 0.;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">        <span class="keywordflow">return</span> 0.;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="LowstorageexplicitRungeKuttatimeintegrators"></a> </p><h3>Low-storage explicit Runge&ndash;Kutta time integrators</h3>
<p>The next few lines implement a few low-storage variants of Runge&ndash;Kutta methods. These methods have specific Butcher tableaux with coefficients \(b_i\) and \(a_i\) as shown in the introduction. As usual in Runge&ndash;Kutta method, we can deduce time steps, \(c_i = \sum_{j=1}^{i-2} b_i + a_{i-1}\) from those coefficients. The main advantage of this kind of scheme is the fact that only two vectors are needed per stage, namely the accumulated part of the solution \(\mathbf{w}\) (that will hold the solution \(\mathbf{w}^{n+1}\) at the new time \(t^{n+1}\) after the last stage), the update vector \(\mathbf{r}_i\) that gets evaluated during the stages, plus one vector \(\mathbf{k}_i\) to hold the evaluation of the operator. Such a Runge&ndash;Kutta setup reduces the memory storage and memory access. As the memory bandwidth is often the performance-limiting factor on modern hardware when the evaluation of the differential operator is well-optimized, performance can be improved over standard time integrators. This is true also when taking into account that a conventional Runge&ndash;Kutta scheme might allow for slightly larger time steps as more free parameters allow for better stability properties.</p>
<p>In this tutorial programs, we concentrate on a few variants of low-storage schemes defined in the article by Kennedy, Carpenter, and Lewis (2000), as well as one variant described by Tselios and Simos (2007). There is a large series of other schemes available, which could be addressed by additional sets of coefficients or slightly different update formulas.</p>
<p>We define a single class for the four integrators, distinguished by the enum described above. To each scheme, we then fill the vectors for the \(b_i\) and \(a_i\) to the given variables in the class.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
</div><!-- fragment --><p>First comes the three-stage scheme of order three by Kennedy et al. (2000). While its stability region is significantly smaller than for the other schemes, it only involves three stages, so it is very competitive in terms of the work per stage.</p>
<div class="fragment"><div class="line"><span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">      {</div>
<div class="line">        lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
</div><!-- fragment --><p>The next scheme is a five-stage scheme of order four, again defined in the paper by Kennedy et al. (2000).</p>
<div class="fragment"><div class="line"><span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">  {</div>
<div class="line">    lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p>The following scheme of seven stages and order four has been explicitly derived for acoustics problems. It is a balance of accuracy for imaginary eigenvalues among fourth order schemes, combined with a large stability region. Since DG schemes are dissipative among the highest frequencies, this does not necessarily translate to the highest possible time step per stage. In the context of the present tutorial program, the numerical flux plays a crucial role in the dissipation and thus also the maximal stable time step size. For the modified Lax&ndash;Friedrichs flux, this scheme is similar to the <code>stage_5_order_4</code> scheme in terms of step size per stage if only stability is considered, but somewhat less efficient for the HLL flux.</p>
<div class="fragment"><div class="line"><span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">  {</div>
<div class="line">    lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p>The last scheme included here is the nine-stage scheme of order five from Kennedy et al. (2000). It is the most accurate among the schemes used here, but the higher order of accuracy sacrifices some stability, so the step length normalized per stage is less than for the fourth order schemes.</p>
<div class="fragment"><div class="line">      <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">        {</div>
<div class="line">          lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">    rk_integrator(lsrk);</div>
<div class="line">  rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">return</span> bi.size();</div>
<div class="line">}</div>
</div><!-- fragment --><p>The main function of the time integrator is to go through the stages, evaluate the operator, prepare the \(\mathbf{r}_i\) vector for the next evaluation, and update the solution vector \(\mathbf{w}\). We hand off the work to the <code>pde_operator</code> involved in order to be able to merge the vector operations of the Runge&ndash;Kutta setup with the evaluation of the differential operator for better performance, so all we do here is to delegate the vectors and coefficients.</p>
<p>We separately call the operator for the first stage because we need slightly modified arguments there: We evaluate the solution from the old solution \(\mathbf{w}^n\) rather than a \(\mathbf r_i\) vector, so the first argument is <code>solution</code>. We here let the stage vector \(\mathbf{r}_i\) also hold the temporary result of the evaluation, as it is not used otherwise. For all subsequent stages, we use the vector <code>vec_ki</code> as the second vector argument to store the result of the operator evaluation. Finally, when we are at the last stage, we must skip the computation of the vector \(\mathbf{r}_{s+1}\) as there is no coefficient \(a_s\) available (nor will it be used).</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">  <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                         VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                         VectorType &amp;    vec_ri,</div>
<div class="line">                         VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"> </div>
<div class="line">    pde_operator.perform_stage(current_time,</div>
<div class="line">                               bi[0] * time_step,</div>
<div class="line">                               ai[0] * time_step,</div>
<div class="line">                               <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                               vec_ri,</div>
<div class="line">                               <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                               vec_ri);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 1; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = ci[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>];</div>
<div class="line">        pde_operator.perform_stage(current_time + c_i * time_step,</div>
<div class="line">                                   bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step,</div>
<div class="line">                                   (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size() - 1 ?</div>
<div class="line">                                      0 :</div>
<div class="line">                                      ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step),</div>
<div class="line">                                   vec_ri,</div>
<div class="line">                                   vec_ki,</div>
<div class="line">                                   <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                   vec_ri);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::vector&lt;double&gt; bi;</div>
<div class="line">  std::vector&lt;double&gt; ai;</div>
<div class="line">  std::vector&lt;double&gt; ci;</div>
<div class="line">};</div>
</div><!-- fragment --><p><a class="anchor" id="ImplementationofpointwiseoperationsoftheEulerequations"></a> </p><h3>Implementation of point-wise operations of the Euler equations</h3>
<p>In the following functions, we implement the various problem-specific operators pertaining to the Euler equations. Each function acts on the vector of conserved variables \([\rho, \rho\mathbf{u}, E]\) that we hold in the solution vectors, and computes various derived quantities.</p>
<p>First out is the computation of the velocity, that we derive from the momentum variable \(\rho \mathbf{u}\) by division by \(\rho\). One thing to note here is that we decorate all those functions with the keyword <code>DEAL_II_ALWAYS_INLINE</code>. This is a special macro that maps to a compiler-specific keyword that tells the compiler to never create a function call for any of those functions, and instead move the implementation <a href="https://en.wikipedia.org/wiki/Inline_function">inline</a> to where they are called. This is critical for performance because we call into some of those functions millions or billions of times: For example, we both use the velocity for the computation of the flux further down, but also for the computation of the pressure, and both of these places are evaluated at every quadrature point of every cell. Making sure these functions are inlined ensures not only that the processor does not have to execute a jump instruction into the function (and the corresponding return jump), but also that the compiler can re-use intermediate information from one function's context in code that comes after the place where the function was called. (We note that compilers are generally quite good at figuring out which functions to inline by themselves. Here is a place where compilers may or may not have figured it out by themselves but where we know for sure that inlining is a win.)</p>
<p>Another trick we apply is a separate variable for the inverse density \(\frac{1}{\rho}\). This enables the compiler to only perform a single division for the flux, despite the division being used at several places. As divisions are around ten to twenty times as expensive as multiplications or additions, avoiding redundant divisions is crucial for performance. We note that taking the inverse first and later multiplying with it is not equivalent to a division in floating point arithmetic due to roundoff effects, so the compiler is not allowed to exchange one way by the other with standard optimization flags. However, it is also not particularly difficult to write the code in the right way.</p>
<p>To summarize, the chosen strategy of always inlining and careful definition of expensive arithmetic operations allows us to write compact code without passing all intermediate results around, despite making sure that the code maps to excellent machine code.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * inverse_density;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function computes the pressure from the vector of conserved variables, using the formula \(p = (\gamma - 1) \left(E - \frac 12 \rho \mathbf{u}\cdot \mathbf{u}\right)\). As explained above, we use the velocity from the <code><a class="el" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity()</a></code> function. Note that we need to specify the first template argument <code>dim</code> here because the compiler is not able to deduce it from the arguments of the tensor, whereas the second argument (number type) can be automatically deduced.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">    euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] - 0.5 * rho_u_dot_u);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Here is the definition of the Euler flux function, i.e., the definition of the actual equation. Given the velocity and pressure (that the compiler optimization will make sure are done only once), this is straight-forward given the equation stated in the introduction.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">    euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">        <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This next function is a helper to simplify the implementation of the numerical flux, implementing the action of a tensor of tensors (with non-standard outer dimension of size <code>dim + 2</code>, so the standard overloads provided by deal.II's tensor classes do not apply here) with another tensor of the same inner dimension, i.e., a matrix-vector product.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">  <a class="code" href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This function implements the numerical flux (Riemann solver). It gets the state from the two sides of an interface and the normal vector, oriented from the side of the solution \(\mathbf{w}^-\) towards the solution \(\mathbf{w}^+\). In finite volume methods which rely on piece-wise constant data, the numerical flux is the central ingredient as it is the only place where the physical information is entered. In DG methods, the numerical flux is less central due to the polynomials within the elements and the physical flux used there. As a result of higher-degree interpolation with consistent values from both sides in the limit of a continuous solution, the numerical flux can be seen as a control of the jump of the solution from both sides to weakly impose continuity. It is important to realize that a numerical flux alone cannot stabilize a high-order DG method in the presence of shocks, and thus any DG method must be combined with further shock-capturing techniques to handle those cases. In this tutorial, we focus on wave-like solutions of the Euler equations in the subsonic regime without strong discontinuities where our basic scheme is sufficient.</p>
<p>Nonetheless, the numerical flux is decisive in terms of the numerical dissipation of the overall scheme and influences the admissible time step size with explicit Runge&ndash;Kutta methods. We consider two choices, a modified Lax&ndash;Friedrichs scheme and the widely used Harten&ndash;Lax&ndash;van Leer (HLL) flux. For both variants, we first need to get the velocities and pressures from both sides of the interface and evaluate the physical Euler flux.</p>
<p>For the local Lax&ndash;Friedrichs flux, the definition is \(\hat{\mathbf{F}} =\frac{\mathbf{F}(\mathbf{w}^-)+\mathbf{F}(\mathbf{w}^+)}{2} + \frac{\lambda}{2}\left[\mathbf{w}^--\mathbf{w}^+\right]\otimes \mathbf{n^-}\), where the factor \(\lambda = \max\left(\|\mathbf{u}^-\|+c^-, \|\mathbf{u}^+\|+c^+\right)\) gives the maximal wave speed and \(c = \sqrt{\gamma p / \rho}\) is the speed of sound. Here, we choose two modifications of that expression for reasons of computational efficiency, given the small impact of the flux on the solution. For the above definition of the factor \(\lambda\), we would need to take four square roots, two for the two velocity norms and two for the speed of sound on either side. The first modification is hence to rather use \(\sqrt{\|\mathbf{u}\|^2+c^2}\) as an estimate of the maximal speed (which is at most a factor of 2 away from the actual maximum, as shown in the introduction). This allows us to pull the square root out of the maximum and get away with a single square root computation. The second modification is to further relax on the parameter \(\lambda\)&mdash;the smaller it is, the smaller the dissipation factor (which is multiplied by the jump in \(\mathbf{w}\), which might result in a smaller or bigger dissipation in the end). This allows us to fit the spectrum into the stability region of the explicit Runge&ndash;Kutta integrator with bigger time steps. However, we cannot make dissipation too small because otherwise imaginary eigenvalues grow larger. Finally, the current conservative formulation is not energy-stable in the limit of \(\lambda\to 0\) as it is not skew-symmetric, and would need additional measures such as split-form DG schemes in that case.</p>
<p>For the HLL flux, we follow the formula from literature, introducing an additional weighting of the two states from Lax&ndash;Friedrichs by a parameter \(s\). It is derived from the physical transport directions of the Euler equations in terms of the current direction of velocity and sound speed. For the velocity, we here choose a simple arithmetic average which is sufficient for DG scenarios and moderate jumps in material parameters.</p>
<p>Since the numerical flux is multiplied by the normal vector in the weak form, we multiply by the result by the normal vector for all terms in the equation. In these multiplications, the <code>operator*</code> defined above enables a compact notation similar to the mathematical definition.</p>
<p>In this and the following functions, we use variable suffixes <code>_m</code> and <code>_p</code> to indicate quantities derived from \(\mathbf{w}^-\) and \(\mathbf{w}^+\), i.e., values "here" and "there" relative to the current cell when looking at a neighbor cell.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">            0.5 * <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                       <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line">                                     velocity_m.norm_square() +</div>
<div class="line">                                       <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> 0.5 * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                 0.5 * <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> * (u_m - u_p);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">            0.5 * ((velocity_m + velocity_p) * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">            0.5 * <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> *</div>
<div class="line">            (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">            <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">            <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal - avg_c);</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos - s_neg);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> inverse_s *</div>
<div class="line">                 ((s_pos * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) - s_neg * (flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)) -</div>
<div class="line">                  s_pos * s_neg * (u_m - u_p));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> {};</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>This and the next function are helper functions to provide compact evaluation calls as multiple points get batched together via a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> argument (see the <a class="el" href="step_37.html">step-37</a> tutorial for details). This function is used for the subsonic outflow boundary conditions where we need to set the energy component to a prescribed value. The next one requests the solution on all components and is used for inflow boundaries where all components of the solution are set.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized,</div>
<div class="line">                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line"><a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt;</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="TheEulerOperationclass"></a> </p><h3>The EulerOperation class</h3>
<p>This class implements the evaluators for the Euler problem, in analogy to the <code>LaplaceOperator</code> class of <a class="el" href="step_37.html">step-37</a> or <a class="el" href="step_59.html">step-59</a>. Since the present operator is non-linear and does not require a matrix interface (to be handed over to preconditioners), we skip the various <code>vmult</code> functions otherwise present in matrix-free operators and only implement an <code>apply</code> function as well as the combination of <code>apply</code> with the required vector updates for the low-storage Runge&ndash;Kutta time integrator mentioned above (called <code>perform_stage</code>). Furthermore, we have added three additional functions involving matrix-free routines, namely one to compute an estimate of the time step scaling (that is combined with the Courant number for the actual time step size) based on the velocity and speed of sound in the elements, one for the projection of solutions (specializing <a class="el" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project()</a> for the DG case), and one to compute the errors against a possible analytical solution or norms against some background state.</p>
<p>The rest of the class is similar to other matrix-free tutorials. As discussed in the introduction, we provide a few functions to allow a user to pass in various forms of boundary conditions on different parts of the domain boundary marked by <a class="el" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> variables, as well as possible body forces.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keyword">class </span>EulerOperator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">  EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                           std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">             <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  perform_stage(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> cur_time,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_solution,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_ai,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;next_ri) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">               <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">    inflow_boundaries;</div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                 subsonic_outflow_boundaries;</div>
<div class="line">  std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">  std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_inverse_mass_matrix(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_cell(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_boundary_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">  : timer(timer)</div>
<div class="line">{}</div>
</div><!-- fragment --><p>For the initialization of the Euler operator, we set up the <a class="el" href="classMatrixFree.html">MatrixFree</a> variable contained in the class. This can be done given a mapping to describe possible curved boundaries as well as a <a class="el" href="classDoFHandler.html">DoFHandler</a> object describing the degrees of freedom. Since we use a discontinuous Galerkin discretization in this tutorial program where no constraints are imposed strongly on the solution field, we do not need to pass in an <a class="el" href="classAffineConstraints.html">AffineConstraints</a> object and rather use a dummy for the construction. With respect to quadrature, we want to select two different ways of computing the underlying integrals: The first is a flexible one, based on a template parameter <code>n_points_1d</code> (that will be assigned the <code>n_q_points_1d</code> value specified at the top of this file). More accurate integration is necessary to avoid the aliasing problem due to the variable coefficients in the Euler operator. The second less accurate quadrature formula is a tight one based on <code>fe_degree+1</code> and needed for the inverse mass matrix. While that formula provides an exact inverse only on affine element shapes and not on deformed elements, it enables the fast inversion of the mass matrix by tensor product techniques, necessary to ensure optimal computational efficiency overall.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                  <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line">  additional_data.mapping_update_flags =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.mapping_update_flags_inner_faces =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.mapping_update_flags_boundary_faces =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.tasks_parallel_scheme =</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData::none</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">    <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The subsequent four member functions are the ones that must be called from outside to specify the various types of boundaries. For an inflow boundary, we must specify all components in terms of density \(\rho\), momentum \(\rho \mathbf{u}\) and energy \(E\). Given this information, we then store the function alongside the respective boundary id in a map member variable of this class. Likewise, we proceed for the subsonic outflow boundaries (where we request a function as well, which we use to retrieve the energy) and for wall (no-penetration) boundaries where we impose zero normal velocity (no function necessary, so we only request the boundary id). For the present DG code where boundary conditions are solely applied as part of the weak form (during time integration), the call to set the boundary conditions can appear both before or after the <code><a class="el" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit()</a></code> call to this class. This is different from continuous finite element codes where the boundary conditions determine the content of the <a class="el" href="classAffineConstraints.html">AffineConstraints</a> object that is sent into <a class="el" href="classMatrixFree.html">MatrixFree</a> for initialization, thus requiring to be set before the initialization of the matrix-free data structures.</p>
<p>The checks added in each of the four function are used to ensure that boundary conditions are mutually exclusive on the various parts of the boundary, i.e., that a user does not accidentally designate a boundary as both an inflow and say a subsonic outflow boundary.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">  std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                         <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                         <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                         <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">  std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                         <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                         <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                         <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  subsonic_outflow_boundaries.end(),</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                         <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                         <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                         <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">  std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">  this-&gt;body_force = std::move(body_force);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Localevaluators"></a> </p><h4>Local evaluators</h4>
<p>Now we proceed to the local evaluators for the Euler problem. The evaluators are relatively simple and follow what has been presented in <a class="el" href="step_37.html">step-37</a>, <a class="el" href="step_48.html">step-48</a>, or <a class="el" href="step_59.html">step-59</a>. The first notable difference is the fact that we use an <a class="el" href="classFEEvaluation.html">FEEvaluation</a> with a non-standard number of quadrature points. Whereas we previously always set the number of quadrature points to equal the polynomial degree plus one (ensuring exact integration on affine element shapes), we now set the number quadrature points as a separate variable (e.g. the polynomial degree plus two or three halves of the polynomial degree) to more accurately handle nonlinear terms. Since the evaluator is fed with the appropriate loop lengths via the template argument and keeps the number of quadrature points in the whole cell in the variable <a class="el" href="classFEEvaluation.html#a1b8934d6ae273d7b3f91994eddcad239">FEEvaluation::n_q_points</a>, we now automatically operate on the more accurate formula without further changes.</p>
<p>The second difference is due to the fact that we are now evaluating a multi-component system, as opposed to the scalar systems considered previously. The matrix-free framework provides several ways to handle the multi-component case. The variant shown here utilizes an <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object with multiple components embedded into it, specified by the fourth template argument <code>dim + 2</code> for the components in the Euler system. As a consequence, the return type of FEEvaluation::get_value() is not a scalar any more (that would return a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> type, collecting data from several elements), but a <a class="el" href="classTensor.html">Tensor</a> of <code>dim+2</code> components. The functionality is otherwise similar to the scalar case; it is handled by a template specialization of a base class, called <a class="el" href="classFEEvaluationAccess.html">FEEvaluationAccess</a>. An alternative variant would have been to use several <a class="el" href="classFEEvaluation.html">FEEvaluation</a> objects, a scalar one for the density, a vector-valued one with <code>dim</code> components for the momentum, and another scalar evaluator for the energy. To ensure that those components point to the correct part of the solution, the constructor of <a class="el" href="classFEEvaluation.html">FEEvaluation</a> takes three optional integer arguments after the required <a class="el" href="classMatrixFree.html">MatrixFree</a> field, namely the number of the <a class="el" href="classDoFHandler.html">DoFHandler</a> for multi-DoFHandler systems (taking the first by default), the number of the quadrature point in case there are multiple <a class="el" href="classQuadrature.html">Quadrature</a> objects (see more below), and as a third argument the component within a vector system. As we have a single vector for all components, we would go with the third argument, and set it to <code>0</code> for the density, <code>1</code> for the vector-valued momentum, and <code>dim+1</code> for the energy slot. <a class="el" href="classFEEvaluation.html">FEEvaluation</a> then picks the appropriate subrange of the solution vector during <a class="el" href="classFEEvaluationBase.html#a5c3bf28ebceb0271addfba5b92f475ce">FEEvaluationBase::read_dof_values()</a> and FEEvaluation::distributed_local_to_global() or the more compact <a class="el" href="classFEEvaluation.html#ab53d5c08f460cfe6c9830ac14a427115">FEEvaluation::gather_evaluate()</a> and <a class="el" href="classFEEvaluation.html#a491779be7bd032d277e41f1dda8dc584">FEEvaluation::integrate_scatter()</a> calls.</p>
<p>When it comes to the evaluation of the body force vector, we distinguish between two cases for efficiency reasons: In case we have a constant function (derived from <a class="el" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction</a>), we can precompute the value outside the loop over quadrature points and simply use the value everywhere. For a more general function, we instead need to call the <code><a class="el" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function()</a></code> method we provided above; this path is more expensive because we need to access the memory associated with the quadrature point data.</p>
<p>The rest follows the other tutorial programs. Since we have implemented all physics for the Euler equations in the separate <code><a class="el" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux()</a></code> function, all we have to do here is to call this function given the current solution evaluated at quadrature points, returned by <code>phi.get_value(q)</code>, and tell the <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object to queue the flux for testing it by the gradients of the shape functions (which is a <a class="el" href="classTensor.html">Tensor</a> of outer <code>dim+2</code> components, each holding a tensor of <code>dim</code> components for the \(x,y,z\) component of the Euler flux). One final thing worth mentioning is the order in which we queue the data for testing by the value of the test function, <code>phi.submit_value()</code>, in case we are given an external function: We must do this after calling <code>phi.get_value(q)</code>, because <code>get_value()</code> (reading the solution) and <code>submit_value()</code> (queuing the value for multiplication by the test function and summation over quadrature points) access the same underlying data field. Here it would be easy to achieve also without temporary variable <code>w_q</code> since there is no mixing between values and gradients. For more complicated setups, one has to first copy out e.g. both the value and gradient at a quadrature point and then queue results again by <a class="el" href="classFEEvaluationBase.html#a2c0efc6f70b305c0585001632063c98b">FEEvaluationBase::submit_value()</a> and <a class="el" href="classFEEvaluationBase.html#a2a78655d119bd1bde992619c52b2d2f8">FEEvaluationBase::submit_gradient()</a>.</p>
<p>As a final note, we mention that we do not use the first <a class="el" href="classMatrixFree.html">MatrixFree</a> argument of this function, which is a call-back from <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>. The interfaces imposes the present list of arguments, but since we are in a member function where the <a class="el" href="classMatrixFree.html">MatrixFree</a> object is already available as the <code>data</code> variable, we stick with that to avoid confusion.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_cell(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; constant_body_force;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">    constant_body_force = evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">      *constant_function, <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt;());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">          phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">          <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; force =</div>
<div class="line">                constant_function ? constant_body_force :</div>
<div class="line">                                    evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">                                      *body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">              <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; forcing;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">              phi.submit_value(forcing, q);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      phi.integrate_scatter(((body_force.get() != <span class="keyword">nullptr</span>) ?</div>
<div class="line">                               <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a> :</div>
<div class="line">                               <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea84d99583fd787b7e846f9e4b6f7c97c0">EvaluationFlags::nothing</a>) |</div>
<div class="line">                              <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeadde91684ebb2c6ec5c5c5293123f6a04">EvaluationFlags::gradients</a>,</div>
<div class="line">                            <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function concerns the computation of integrals on interior faces, where we need evaluators from both cells adjacent to the face. We associate the variable <code>phi_m</code> with the solution component \(\mathbf{w}^-\) and the variable <code>phi_p</code> with the solution component \(\mathbf{w}^+\). We distinguish the two sides in the constructor of <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> by the second argument, with <code>true</code> for the interior side and <code>false</code> for the exterior side, with interior and exterior denoting the orientation with respect to the normal vector.</p>
<p>Note that the calls <a class="el" href="classFEFaceEvaluation.html#a4ac53fde2eab227ef45c7d29a5ed33fe">FEFaceEvaluation::gather_evaluate()</a> and <a class="el" href="classFEFaceEvaluation.html#ad8963360c30a43aca90a764443fc954f">FEFaceEvaluation::integrate_scatter()</a> combine the access to the vectors and the sum factorization parts. This combined operation not only saves a line of code, but also contains an important optimization: Given that we use a nodal basis in terms of the Lagrange polynomials in the points of the Gauss-Lobatto quadrature formula, only \((p+1)^{d-1}\) out of the \((p+1)^d\) basis functions evaluate to non-zero on each face. Thus, the evaluator only accesses the necessary data in the vector and skips the parts which are multiplied by zero. If we had first read the vector, we would have needed to load all data from the vector, as the call in isolation would not know what data is required in subsequent operations. If the subsequent <a class="el" href="classFEFaceEvaluation.html#a92f84b8ad276ca9866f30c6f789cf3a4">FEFaceEvaluation::evaluate()</a> call requests values and derivatives, indeed all \((p+1)^d\) vector entries for each component are needed, as the normal derivative is nonzero for all basis functions.</p>
<p>The arguments to the evaluators as well as the procedure is similar to the cell evaluation. We again use the more accurate (over-)integration scheme due to the nonlinear terms, specified as the third template argument in the list. At the quadrature points, we then go to our free-standing function for the numerical flux. It receives the solution evaluated at quadrature points from both sides (i.e., \(\mathbf{w}^-\) and \(\mathbf{w}^+\)), as well as the normal vector onto the minus side. As explained above, the numerical flux is already multiplied by the normal vector from the minus side. We need to switch the sign because the boundary term comes with a minus sign in the weak form derived in the introduction. The flux is then queued for testing both on the minus sign and on the plus sign, with switched sign as the normal vector from the plus side is exactly opposed to the one from the minus side.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_face(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                    <span class="keyword">true</span>);</div>
<div class="line">  <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                    <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">    {</div>
<div class="line">      phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">      phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">      phi_m.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">            euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                      phi_p.get_value(q),</div>
<div class="line">                                      phi_m.get_normal_vector(q));</div>
<div class="line">          phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">          phi_p.submit_value(numerical_flux, q);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      phi_p.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      phi_m.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>For faces located at the boundary, we need to impose the appropriate boundary conditions. In this tutorial program, we implement four cases as mentioned above. (A fifth case, for supersonic outflow conditions is discussed in the "Results" section below.) The discontinuous Galerkin method imposes boundary conditions not as constraints, but only weakly. Thus, the various conditions are imposed by finding an appropriate <em>exterior</em> quantity \(\mathbf{w}^+\) that is then handed to the numerical flux function also used for the interior faces. In essence, we "pretend" a state on the outside of the domain in such a way that if that were reality, the solution of the PDE would satisfy the boundary conditions we want.</p>
<p>For wall boundaries, we need to impose a no-normal-flux condition on the momentum variable, whereas we use a Neumann condition for the density and energy with \(\rho^+ = \rho^-\) and \(E^+ = E^-\). To achieve the no-normal flux condition, we set the exterior values to the interior values and subtract two times the velocity in wall-normal direction, i.e., in the direction of the normal vector.</p>
<p>For inflow boundaries, we simply set the given Dirichlet data \(\mathbf{w}_\mathrm{D}\) as a boundary value. An alternative would have been to use \(\mathbf{w}^+ = -\mathbf{w}^- + 2 \mathbf{w}_\mathrm{D}\), the so-called mirror principle.</p>
<p>The imposition of outflow is essentially a Neumann condition, i.e., setting \(\mathbf{w}^+ = \mathbf{w}^-\). For the case of subsonic outflow, we still need to impose a value for the energy, which we derive from the respective function. A special step is needed for the case of <em>backflow</em>, i.e., the case where there is a momentum flux into the domain on the Neumann portion. According to the literature (a fact that can be derived by appropriate energy arguments), we must switch to another variant of the flux on inflow parts, see Gravemeier, Comerford, Yoshihara, Ismail, Wall, "A novel formulation for Neumann inflow
 conditions in biomechanics", Int. J. Numer. Meth. Biomed. Eng., vol. 28 (2012). Here, the momentum term needs to be added once again, which corresponds to removing the flux contribution on the momentum variables. We do this in a post-processing step, and only for the case when we both are at an outflow boundary and the dot product between the normal vector and the momentum (or, equivalently, velocity) is negative. As we work on data of several quadrature points at once for SIMD vectorizations, we here need to explicitly loop over the array entries of the SIMD array.</p>
<p>In the implementation below, we check for the various types of boundaries at the level of quadrature points. Of course, we could also have moved the decision out of the quadrature point loop and treat entire faces as of the same kind, which avoids some map/set lookups in the inner loop over quadrature points. However, the loss of efficiency is hardly noticeable, so we opt for the simpler code here. Also note that the final <code>else</code> clause will catch the case when some part of the boundary was not assigned any boundary condition via <code>EulerOperator::set_..._boundary(...)</code>.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_boundary_face(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">      phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi.get_value(q);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi.get_normal_vector(q);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; w_p;</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">          <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) != wall_boundaries.end())</div>
<div class="line">            {</div>
<div class="line">              w_p[0] = w_m[0];</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] - 2. * rho_u_dot_n * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">              w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                   inflow_boundaries.end())</div>
<div class="line">            w_p =</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                                phi.quadrature_point(q));</div>
<div class="line">          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                   subsonic_outflow_boundaries.end())</div>
<div class="line">            {</div>
<div class="line">              w_p          = w_m;</div>
<div class="line">              w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                *subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                phi.quadrature_point(q),</div>
<div class="line">                <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">              at_outflow = <span class="keyword">true</span>;</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                        <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                   <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                   <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt; -1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                    <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">          phi.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function implements the inverse mass matrix operation. The algorithms and rationale have been discussed extensively in the introduction, so we here limit ourselves to the technicalities of the <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a> class. It does similar operations as the forward evaluation of the mass matrix, except with a different interpolation matrix, representing the inverse \(S^{-1}\) factors. These represent a change of basis from the specified basis (in this case, the Lagrange basis in the points of the Gauss&ndash;Lobatto quadrature formula) to the Lagrange basis in the points of the Gauss quadrature formula. In the latter basis, we can apply the inverse of the point-wise <code>JxW</code> factor, i.e., the quadrature weight times the determinant of the Jacobian of the mapping from reference to real coordinates. Once this is done, the basis is changed back to the nodal Gauss-Lobatto basis again. All of these operations are done by the <code><a class="el" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply()</a></code> function below. What we need to provide is the local fields to operate on (which we extract from the global vector by an <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object) and write the results back to the destination vector of the mass matrix operation.</p>
<p>One thing to note is that we added two integer arguments (that are optional) to the constructor of <a class="el" href="classFEEvaluation.html">FEEvaluation</a>, the first being 0 (selecting among the <a class="el" href="classDoFHandler.html">DoFHandler</a> in multi-DoFHandler systems; here, we only have one) and the second being 1 to make the quadrature formula selection. As we use the quadrature formula 0 for the over-integration of nonlinear terms, we use the formula 1 with the default \(p+1\) (or <code>fe_degree+1</code> in terms of the variable name) points for the mass matrix. This leads to square contributions to the mass matrix and ensures exact integration, as explained in the introduction.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_inverse_mass_matrix(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">  <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.apply(phi.begin_dof_values(), phi.begin_dof_values());</div>
<div class="line"> </div>
<div class="line">      phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Theapplyandrelatedfunctions"></a> </p><h4>The <a class="el" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply()</a> and related functions</h4>
<p>We now come to the function which implements the evaluation of the Euler operator as a whole, i.e., \(\mathcal M^{-1} \mathcal L(t, \mathbf{w})\), calling into the local evaluators presented above. The steps should be clear from the previous code. One thing to note is that we need to adjust the time in the functions we have associated with the various parts of the boundary, in order to be consistent with the equation in case the boundary data is time-dependent. Then, we call <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a> to perform the cell and face integrals, including the necessary ghost data exchange in the <code>src</code> vector. The seventh argument to the function, <code>true</code>, specifies that we want to zero the <code>dst</code> vector as part of the loop, before we start accumulating integrals into it. This variant is preferred over explicitly calling <code>dst = 0.;</code> before the loop as the zeroing operation is done on a subrange of the vector in parts that are written by the integrals nearby. This enhances data locality and allows for caching, saving one roundtrip of vector data to main memory and enhancing performance. The last two arguments to the loop determine which data is exchanged: Since we only access the values of the shape functions one faces, typical of first-order hyperbolic problems, and since we have a nodal basis with nodes at the reference element surface, we only need to exchange those parts. This again saves precious memory bandwidth.</p>
<p>Once the spatial operator \(\mathcal L\) is applied, we need to make a second round and apply the inverse mass matrix. Here, we call <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a> since only cell integrals appear. The cell loop is cheaper than the full loop as access only goes to the degrees of freedom associated with the locally owned cells, which is simply the locally owned degrees of freedom for DG discretizations. Thus, no ghost exchange is needed here.</p>
<p>Around all these functions, we put timer scopes to record the computational time for statistics about the contributions of the various parts.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">EulerOperator&lt;dim, degree, n_points_1d&gt;::apply</a>(</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - integrals&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">              &amp;EulerOperator::local_apply_face,</div>
<div class="line">              &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">              <span class="keyword">this</span>,</div>
<div class="line">              <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">              src,</div>
<div class="line">              <span class="keyword">true</span>,</div>
<div class="line">              <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">              <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - inverse mass&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(&amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">                   <span class="keyword">this</span>,</div>
<div class="line">                   <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                   <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Let us move to the function that does an entire stage of a Runge&ndash;Kutta update. It calls EulerOperator::apply() followed by some updates to the vectors, namely <code>next_ri = solution + factor_ai * k_i</code> and <code>solution += factor_solution * k_i</code>. Rather than performing these steps through the vector interfaces, we here present an alternative strategy that is faster on cache-based architectures. As the memory consumed by the vectors is often much larger than what fits into caches, the data has to effectively come from the slow RAM memory. The situation can be improved by loop fusion, i.e., performing both the updates to <code>next_ki</code> and <code>solution</code> within a single sweep. In that case, we would read the two vectors <code>rhs</code> and <code>solution</code> and write into <code>next_ki</code> and <code>solution</code>, compared to at least 4 reads and two writes in the baseline case. Here, we go one step further and perform the loop immediately when the mass matrix inversion has finished on a part of the vector. <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a> provides a mechanism to attach an <code>std::function</code> both before the loop over cells first touches a vector entry (which we do not use here, but is e.g. used for zeroing the vector) and a second <code>std::function</code> to be called after the loop last touches an entry. The callback is in form of a range over the given vector (in terms of the local index numbering in the MPI universe) that can be addressed by <code>local_element()</code> functions.</p>
<p>For this second callback, we create a lambda that works on a range and write the respective update on this range. Ideally, we would add the <code>DEAL_II_OPENMP_SIMD_PRAGMA</code> before the local loop to suggest to the compiler to SIMD parallelize this loop (which means in practice that we ensure that there is no overlap, also called aliasing, between the index ranges of the pointers we use inside the loops). It turns out that at the time of this writing, GCC 7.2 fails to compile an OpenMP pragma inside a lambda function, so we comment this pragma out below. If your compiler is newer, you should be able to uncomment these lines again.</p>
<p>Note that we select a different code path for the last Runge&ndash;Kutta stage when we do not need to update the <code>next_ri</code> vector. This strategy gives a considerable speedup. Whereas the inverse mass matrix and vector updates take more than 60% of the computational time with default vector updates on a 40-core machine, the percentage is around 35% with the more optimized variant. In other words, this is a speedup of around a third.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_solution,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_ai,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      next_ri)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - integrals L_h&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">      <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">              &amp;EulerOperator::local_apply_face,</div>
<div class="line">              &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">              <span class="keyword">this</span>,</div>
<div class="line">              vec_ki,</div>
<div class="line">              current_ri,</div>
<div class="line">              <span class="keyword">true</span>,</div>
<div class="line">              <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">              <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - inv mass + vec upd&quot;</span>);</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(</div>
<div class="line">      &amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">      <span class="keyword">this</span>,</div>
<div class="line">      next_ri,</div>
<div class="line">      vec_ki,</div>
<div class="line">      <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)&gt;(),</div>
<div class="line">      [&amp;](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start_range, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> end_range) {</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> ai = factor_ai;</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> bi = factor_solution;</div>
<div class="line">        <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">          {</div>
<div class="line">            <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi * k_i;</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">          {</div>
<div class="line">            <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi * k_i;</div>
<div class="line">                next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)  = sol_i + ai * k_i;</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line">      });</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>Having discussed the implementation of the functions that deal with advancing the solution by one time step, let us now move to functions that implement other, ancillary operations. Specifically, these are functions that compute projections, evaluate errors, and compute the speed of information transport on a cell.</p>
<p>The first of these functions is essentially equivalent to <a class="el" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project()</a>, just much faster because it is specialized for DG elements where there is no need to set up and solve a linear system, as each element has independent basis functions. The reason why we show the code here, besides a small speedup of this non-critical operation, is that it shows additional functionality provided by <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>.</p>
<p>The projection operation works as follows: If we denote the matrix of shape functions evaluated at quadrature points by \(S\), the projection on cell \(K\) is an operation of the form \(\underbrace{S J^K S^\mathrm T}_{\mathcal M^K} \mathbf{w}^K = S J^K \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\), where \(J^K\) is the diagonal matrix containing the determinant of the Jacobian times the quadrature weight (JxW), \(\mathcal M^K\) is the cell-wise mass matrix, and \(\tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\) is the evaluation of the field to be projected onto quadrature points. (In reality the matrix \(S\) has additional structure through the tensor product, as explained in the introduction.) This system can now equivalently be written as \(\mathbf{w}^K = \left(S J^K S^\mathrm T\right)^{-1} S J^K \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q} = S^{-\mathrm T} \left(J^K\right)^{-1} S^{-1} S J^K \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\). Now, the term \(S^{-1} S\) and then \(\left(J^K\right)^{-1} J^K\) cancel, resulting in the final expression \(\mathbf{w}^K = S^{-\mathrm T} \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\). This operation is implemented by <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html#a5e95a87a9c63b321c77c72b8d762b760">MatrixFreeOperators::CellwiseInverseMassMatrix::transform_from_q_points_to_basis()</a>. The name is derived from the fact that this projection is simply the multiplication by \(S^{-\mathrm T}\), a basis change from the nodal basis in the points of the Gaussian quadrature to the given finite element basis. Note that we call FEEvaluation::set_dof_values() to write the result into the vector, overwriting previous content, rather than accumulating the results as typical in integration tasks &ndash; we can do this because every vector entry has contributions from only a single cell for discontinuous Galerkin discretizations.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">  <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                               phi.quadrature_point(q)),</div>
<div class="line">                             q);</div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                               phi.begin_dof_values(),</div>
<div class="line">                                               phi.begin_dof_values());</div>
<div class="line">      phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function again repeats functionality also provided by the deal.II library, namely <a class="el" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference()</a>. We here show the explicit code to highlight how the vectorization across several cells works and how to accumulate results via that interface: Recall that each <em>lane</em> of the vectorized array holds data from a different cell. By the loop over all cell batches that are owned by the current MPI process, we could then fill a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> of results; to obtain a global sum, we would need to further go on and sum across the entries in the SIMD array. However, such a procedure is not stable as the SIMD array could in fact not hold valid data for all its lanes. This happens when the number of locally owned cells is not a multiple of the SIMD width. To avoid invalid data, we must explicitly skip those invalid lanes when accessing the data. While one could imagine that we could make it work by simply setting the empty lanes to zero (and thus, not contribute to a sum), the situation is more complicated than that: What if we were to compute a velocity out of the momentum? Then, we would need to divide by the density, which is zero &ndash; the result would consequently be NaN and contaminate the result. This trap is avoided by accumulating the results from the valid SIMD range as we loop through the cell batches, using the function <a class="el" href="classMatrixFree.html#a1d516071d20e633dc9efcadb7852ce15">MatrixFree::n_active_entries_per_cell_batch()</a> to give us the number of lanes with valid data. It equals <a class="el" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray::size()</a> on most cells, but can be less on the last cell batch if the number of cells has a remainder compared to the SIMD width.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">  <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">      <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_errors_squared[3] = {};</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line">            phi.get_value(q);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line"> </div>
<div class="line">          local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">           ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This final function of the EulerOperator class is used to estimate the transport speed, scaled by the mesh size, that is relevant for setting the time step size in the explicit time integrator. In the Euler equations, there are two speeds of transport, namely the convective velocity \(\mathbf{u}\) and the propagation of sound waves with sound speed \(c = \sqrt{\gamma p/\rho}\) relative to the medium moving at velocity \(\mathbf u\).</p>
<p>In the formula for the time step size, we are interested not by these absolute speeds, but by the amount of time it takes for information to cross a single cell. For information transported along with the medium, \(\mathbf u\) is scaled by the mesh size, so an estimate of the maximal velocity can be obtained by computing \(\|J^{-\mathrm T} \mathbf{u}\|_\infty\), where \(J\) is the Jacobian of the transformation from real to the reference domain. Note that <a class="el" href="classFEEvaluationBaseData.html#adad456112f01b19291e7781fb5efee55">FEEvaluationBase::inverse_jacobian()</a> returns the inverse and transpose Jacobian, representing the metric term from real to reference coordinates, so we do not need to transpose it again. We store this limit in the variable <code>convective_limit</code> in the code below.</p>
<p>The sound propagation is isotropic, so we need to take mesh sizes in any direction into account. The appropriate mesh size scaling is then given by the minimal singular value of \(J\) or, equivalently, the maximal singular value of \(J^{-1}\). Note that one could approximate this quantity by the minimal distance between vertices of a cell when ignoring curved cells. To get the maximal singular value of the Jacobian, the general strategy would be some LAPACK function. Since all we need here is an estimate, we can avoid the hassle of decomposing a tensor of <a class="el" href="classVectorizedArray.html">VectorizedArray</a> numbers into several matrices and go into an (expensive) eigenvalue function without vectorization, and instead use a few iterations (five in the code below) of the power method applied to \(J^{-1}J^{-\mathrm T}\). The speed of convergence of this method depends on the ratio of the largest to the next largest eigenvalue and the initial guess, which is the vector of all ones. This might suggest that we get slow convergence on cells close to a cube shape where all lengths are almost the same. However, this slow convergence means that the result will sit between the two largest singular values, which both are close to the maximal value anyway. In all other cases, convergence will be quick. Thus, we can merely hardcode 5 iterations here and be confident that the result is good.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">      <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_max = 0.;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> convective_speed = inverse_jacobian * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">          <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> convective_limit = 0.;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            convective_limit =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">            <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> * (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">            {</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(inverse_jacobian) *</div>
<div class="line">                            (inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> eigenvector_norm = 0.;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                eigenvector_norm =</div>
<div class="line">                  <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">            }</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">            (jac_times_ev * jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">          local_max =</div>
<div class="line">            <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                     max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line">        }</div>
</div><!-- fragment --><p>Similarly to the previous function, we must make sure to accumulate speed only on the valid cells of a cell batch.</p>
<div class="fragment"><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">           ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> max_transport;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="TheEulerProblemclass"></a> </p><h3>The EulerProblem class</h3>
<p>This class combines the EulerOperator class with the time integrator and the usual global data structures such as <a class="el" href="classFiniteElement.html">FiniteElement</a> and <a class="el" href="classDoFHandler.html">DoFHandler</a>, to actually run the simulations of the Euler problem.</p>
<p>The member variables are a triangulation, a finite element, a mapping (to create high-order curved surfaces, see e.g. <a class="el" href="step_10.html">step-10</a>), and a <a class="el" href="classDoFHandler.html">DoFHandler</a> to describe the degrees of freedom. In addition, we keep an instance of the EulerOperator described above around, which will do all heavy lifting in terms of integrals, and some parameters for time integration like the current time or the time step size.</p>
<p>Furthermore, we use a PostProcessor instance to write some additional information to the output file, in similarity to what was done in <a class="el" href="step_33.html">step-33</a>. The interface of the <a class="el" href="classDataPostprocessor.html">DataPostprocessor</a> class is intuitive, requiring us to provide information about what needs to be evaluated (typically only the values of the solution, except for the Schlieren plot that we only enable in 2D where it makes sense), and the names of what gets evaluated. Note that it would also be possible to extract most information by calculator tools within visualization programs such as ParaView, but it is so much more convenient to do it already when writing the output.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    EulerProblem();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
</div><!-- fragment --><p>For the main evaluation of the field variables, we first check that the lengths of the arrays equal the expected values (the lengths <code>2*dim+4</code> or <code>2*dim+5</code> are derived from the sizes of the names we specify in the <a class="el" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names()</a> function below). Then we loop over all evaluation points and fill the respective information: First we fill the primal solution variables of density \(\rho\), momentum \(\rho \mathbf{u}\) and energy \(E\), then we compute the derived velocity \(\mathbf u\), the pressure \(p\), the speed of sound \(c=\sqrt{\gamma p / \rho}\), as well as the Schlieren plot showing \(s = |\nabla \rho|^2\) in case it is enabled. (See <a class="el" href="step_69.html">step-69</a> for another example where we create a Schlieren plot.)</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">  <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">           <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">      computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">          inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] * inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">  <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">  <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>For the interpretation of quantities, we have scalar density, energy, pressure, speed of sound, and the Schlieren plot, and vectors for the momentum and the velocity.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">    interpretation;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    interpretation.push_back(</div>
<div class="line">      <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">  interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">  interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    interpretation.push_back(</div>
<div class="line">      <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> interpretation;</div>
<div class="line">}</div>
</div><!-- fragment --><p>With respect to the necessary update flags, we only need the values for all quantities but the Schlieren plot, which is based on the density gradient.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The constructor for this class is unsurprising: We set up a parallel triangulation based on the <code>MPI_COMM_WORLD</code> communicator, a vector finite element with <code>dim+2</code> components for density, momentum, and energy, a high-order mapping of the same degree as the underlying finite element, and initialize the time and time step to zero.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::EulerProblem()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
</div><!-- fragment --><p>As a mesh, this tutorial program implements two options, depending on the global variable <code>testcase</code>: For the analytical variant (<code>testcase==0</code>), the domain is \((0, 10) \times (-5, 5)\), with Dirichlet boundary conditions (inflow) all around the domain. For <code>testcase==1</code>, we set the domain to a cylinder in a rectangular box, derived from the flow past cylinder testcase for incompressible viscous flow by Sch&auml;fer and Turek (1996). Here, we have a larger variety of boundaries. The inflow part at the left of the channel is given the inflow type, for which we choose a constant inflow profile, whereas we set a subsonic outflow at the right. For the boundary around the cylinder (boundary id equal to 2) as well as the channel walls (boundary id equal to 3) we use the wall boundary type, which is no-normal flow. Furthermore, for the 3D cylinder we also add a gravity force in vertical direction. Having the base mesh in place (including the manifolds set by <a class="el" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder()</a>), we can then perform the specified number of global refinements, create the unknown numbering from the <a class="el" href="classDoFHandler.html">DoFHandler</a>, and hand the <a class="el" href="classDoFHandler.html">DoFHandler</a> and <a class="el" href="classMapping.html" title="Abstract base class for mapping classes. This class declares the interface for the functionality to d...">Mapping</a> objects to the initialization of the EulerOperator.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordflow">case</span> 0:</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = -5;</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">          upper_right[0] = 10;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                         lower_left,</div>
<div class="line">                                         upper_right);</div>
<div class="line">          <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line"> </div>
<div class="line">          euler_operator.set_inflow_boundary(</div>
<div class="line">            0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">case</span> 1:</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">            <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">          euler_operator.set_inflow_boundary(</div>
<div class="line">            0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">          euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">            1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">          euler_operator.set_wall_boundary(2);</div>
<div class="line">          euler_operator.set_wall_boundary(3);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">            euler_operator.set_body_force(</div>
<div class="line">              std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line"> </div>
<div class="line">  dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">  euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">  euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
</div><!-- fragment --><p>In the following, we output some statistics about the problem. Because we often end up with quite large numbers of cells or degrees of freedom, we would like to print them with a comma to separate each set of three digits. This can be done via "locales", although the way this works is not particularly intuitive. <a class="el" href="step_32.html">step-32</a> explains this in slightly more detail.</p>
<div class="fragment"><div class="line">  std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.get_stream().getloc();</div>
<div class="line">  pcout.get_stream().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">  pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">        &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">        &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line">  pcout.get_stream().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>For output, we first let the Euler operator compute the errors of the numerical results. More precisely, we compute the error against the analytical result for the analytical solution case, whereas we compute the deviation against the background field with constant density and energy and constant velocity in \(x\) direction for the second test case.</p>
<p>The next step is to create output. This is similar to what is done in <a class="el" href="step_33.html">step-33</a>: We let the postprocessor defined above control most of the output, except for the primal field that we write directly. For the analytical solution test case, we also perform another projection of the analytical solution and print the difference between that field and the numerical solution. Once we have defined all quantities to be written, we build the patches for output. Similarly to <a class="el" href="step_65.html">step-65</a>, we create a high-order VTK output by setting the appropriate flag, which enables us to visualize fields of high polynomial degrees. Finally, we call the <code><a class="el" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel()</a></code> function to write the result to the given file name. This function uses special MPI parallel write facilities, which are typically more optimized for parallel file systems than the standard library's <code>std::ofstream</code> variants used in most other tutorial programs. A particularly nice feature of the <code>write_vtu_in_parallel()</code> function is the fact that it can combine output from all MPI ranks into a single file, making it unnecessary to have a central record of all such files (namely, the "pvtu" file).</p>
<p>For parallel programs, it is often instructive to look at the partitioning of cells among processors. To this end, one can pass a vector of numbers to <a class="el" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut::add_data_vector()</a> that contains as many entries as the current processor has active cells; these numbers should then be the rank of the processor that owns each of these cells. Such a vector could, for example, be obtained from <a class="el" href="namespaceGridTools.html#ac41d959ae1723a898b616c3320241ffe">GridTools::get_subdomain_association()</a>. On the other hand, on each MPI process, <a class="el" href="classDataOut.html">DataOut</a> will only read those entries that correspond to locally owned cells, and these of course all have the same value: namely, the rank of the current process. What is in the remaining entries of the vector doesn't actually matter, and so we can just get away with a cheap trick: We just fill <em>all</em> values of the vector we give to <a class="el" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut::add_data_vector()</a> with the rank of the current MPI process. The key is that on each process, only the entries corresponding to the locally owned cells will be read, ignoring the (wrong) values in other entries. The fact that every process submits a vector in which the correct subset of entries is correct is all that is necessary.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">    euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">        &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">        &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">        &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">    <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">    data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">    {</div>
<div class="line">      std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">        interpretation;</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">    }</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">        <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                 <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                 <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                 interpretation);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">    mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                           <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                           <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename =</div>
<div class="line">      <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">    data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The EulerProblem::run() function puts all pieces together. It starts off by calling the function that creates the mesh and sets up data structures, and then initializing the time integrator and the two temporary vectors of the low-storage integrator. We call these vectors <code>rk_register_1</code> and <code>rk_register_2</code>, and use the first vector to represent the quantity \(\mathbf{r}_i\) and the second one for \(\mathbf{k}_i\) in the formulas for the Runge&ndash;Kutta scheme outlined in the introduction. Before we start the time loop, we compute the time step size by the <code>EulerOperator::compute_cell_transport_speed()</code> function. For reasons of comparison, we compare the result obtained there with the minimal mesh size and print them to screen. For velocities and speeds of sound close to unity as in this tutorial program, the predicted effective mesh size will be close, but they could vary if scaling were different.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">{</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number&gt;::size</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) * n_vect_number;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">          &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">  rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">  euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">      min_vertex_distance =</div>
<div class="line">        <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">  min_vertex_distance =</div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">  time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">        &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">        &lt;&lt; std::endl</div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  output_results(0);</div>
</div><!-- fragment --><p>Now we are ready to start the time loop, which we run until the time has reached the desired end time. Every 5 time steps, we compute a new estimate for the time step &ndash; since the solution is nonlinear, it is most effective to adapt the value during the course of the simulation. In case the Courant number was chosen too aggressively, the simulation will typically blow up with time step NaN, so that is easy to detect here. One thing to note is that roundoff errors might propagate to the leading digits due to an interaction of slightly different time step selections that in turn lead to slightly different solutions. To decrease this sensitivity, it is common practice to round or truncate the time step size to a few digits, e.g. 3 in this case. In case the current time is near the prescribed 'tick' value for output (e.g. 0.02), we also write the output. After the end of the time loop, we summarize the computation by printing some statistics, which is mostly done by the <a class="el" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics()</a> function.</p>
<div class="fragment"><div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">      {</div>
<div class="line">        ++timestep_number;</div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">          time_step =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">            <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">          integrator.perform_time_step(euler_operator,</div>
<div class="line">                                       <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                       time_step,</div>
<div class="line">                                       <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                       rk_register_1,</div>
<div class="line">                                       rk_register_2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> - time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">          output_results(</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    timer.print_wall_time_statistics(MPI_COMM_WORLD);</div>
<div class="line">    pcout &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace Euler_DG</span></div>
</div><!-- fragment --><p>The <a class="el" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a> function is not surprising and follows what was done in all previous MPI programs: As we run an MPI program, we need to call <code>MPI_Init()</code> and <code>MPI_Finalize()</code>, which we do through the <a class="el" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> data structure. Note that we run the program only with MPI, and set the thread count to 1.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p><a class="anchor" id="Programoutput"></a></p><h3>Program output</h3>
<p>Running the program with the default settings on a machine with 40 processes produces the following output: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 147,456 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 1,024 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 0.00689325, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.3125, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.102759</div>
<div class="line"> </div>
<div class="line">Time:       0, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:   2.76<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho * u:  1.259<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 2.987<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    1.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:   1.37<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho * u:  2.252<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.153<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    2.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.561<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho * u:   2.43<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.493<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    3.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.714<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho * u:  2.591<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.762<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    4.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.843<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho * u:  2.625<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.985<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    5.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.496<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho * u:  1.961<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.142<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       6, dt:   0.0083, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.007<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho * u:  7.119<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.972<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       7, dt:   0.0095, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  9.096<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho * u:  3.786<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.626<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       8, dt:   0.0096, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  8.439<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho * u:  3.338<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy:  2.43<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       9, dt:   0.0096, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  7.822<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho * u:  2.984<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.248<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:      10, dt:   0.0096, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  7.231<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho * u:  2.666<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.074<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line"> </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     2.249<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    30 |     2.249<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     2.249<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     8 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        11 |  0.008066s    13 |   0.00952s |   0.01041s    20 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |       258 |   0.01012s    13 |   0.05392s |   0.08574s    25 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        11 |    0.9597s    13 |    0.9613s |    0.9623s     6 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |      1283 |    0.9827s    25 |     1.015s |      1.06s    13 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |      6415 |    0.8803s    26 |    0.9198s |    0.9619s    14 |</div>
<div class="line">| rk_stage - inv mass + vec upd |      6415 |   0.05677s    15 |   0.06487s |   0.07597s    13 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The program output shows that all errors are small. This is due to the fact that we use a relatively fine mesh of \(32^2\) cells with polynomials of degree 5 for a solution that is smooth. An interesting pattern shows for the time step size: whereas it is 0.0069 up to time 5, it increases to 0.0096 for later times. The step size increases once the vortex with some motion on top of the speed of sound (and thus faster propagation) leaves the computational domain between times 5 and 6.5. After that point, the flow is simply uniform in the same direction, and the maximum velocity of the gas is reduced compared to the previous state where the uniform velocity was overlaid by the vortex. Our time step formula recognizes this effect.</p>
<p>The final block of output shows detailed information about the timing of individual parts of the programs; it breaks this down by showing the time taken by the fastest and the slowest processor, and the average time &ndash; this is often useful in very large computations to find whether there are processors that are consistently overheated (and consequently are throttling their clock speed) or consistently slow for other reasons. The summary shows that 1283 time steps have been performed in 1.02 seconds (looking at the average time among all MPI processes), while the output of 11 files has taken additional 0.96 seconds. Broken down per time step and into the five Runge&ndash;Kutta stages, the compute time per evaluation is 0.16 milliseconds. This high performance is typical of matrix-free evaluators and a reason why explicit time integration is very competitive against implicit solvers, especially for large-scale simulations. The breakdown of computational times at the end of the program run shows that the evaluation of integrals in \(\mathcal L_h\) contributes with around 0.92 seconds and the application of the inverse mass matrix with 0.06 seconds. Furthermore, the estimation of the transport speed for the time step size computation contributes with another 0.05 seconds of compute time.</p>
<p>If we use three more levels of global refinement and 9.4 million DoFs in total, the final statistics are as follows (for the modified Lax&ndash;Friedrichs flux, \(p=5\), and the same system of 40 cores of dual-socket Intel Xeon Gold 6230): </p><div class="fragment"><div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     244.9s    12 |     244.9s |     244.9s    34 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        11 |    0.4239s    12 |    0.4318s |    0.4408s     9 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      2053 |     3.962s    12 |     6.727s |     10.12s     7 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        11 |     30.35s    12 |     30.36s |     30.37s     9 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     10258 |     201.7s     7 |     205.1s |     207.8s    12 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |     51290 |     121.3s     6 |     126.6s |     136.3s    16 |</div>
<div class="line">| rk_stage - inv mass + vec upd |     51290 |     66.19s    16 |     77.52s |     81.84s    10 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>Per time step, the solver now takes 0.02 seconds, about 25 times as long as for the small problem with 147k unknowns. Given that the problem involves 64 times as many unknowns, the increase in computing time is not surprising. Since we also do 8 times as many time steps, the compute time should in theory increase by a factor of 512. The actual increase is 205 s / 1.02 s = 202. This is because the small problem size cannot fully utilize the 40 cores due to communication overhead. This becomes clear if we look into the details of the operations done per time step. The evaluation of the differential operator \(\mathcal L_h\) with nearest neighbor communication goes from 0.92 seconds to 127 seconds, i.e., it increases with a factor of 138. On the other hand, the cost for application of the inverse mass matrix and the vector updates, which do not need to communicate between the MPI processes at all, has increased by a factor of 1195. The increase is more than the theoretical factor of 512 because the operation is limited by the bandwidth from RAM memory for the larger size while for the smaller size, all vectors fit into the caches of the CPU. The numbers show that the mass matrix evaluation and vector update part consume almost 40% of the time spent by the Runge&ndash;Kutta stages &ndash; despite using a low-storage Runge&ndash;Kutta integrator and merging of vector operations! And despite using over-integration for the \(\mathcal L_h\) operator. For simpler differential operators and more expensive time integrators, the proportion spent in the mass matrix and vector update part can also reach 70%. If we compute a throughput number in terms of DoFs processed per second and Runge&ndash;Kutta stage, we obtain </p><p class="formulaDsp">
\[ \text{throughput} = \frac{n_\mathrm{time steps} n_\mathrm{stages} n_\mathrm{dofs}}{t_\mathrm{compute}} = \frac{10258 \cdot 5 \cdot 9.4\,\text{MDoFs}}{205s} = 2360\, \text{MDoFs/s} \]
</p>
<p> This throughput number is very high, given that simply copying one vector to another one runs at only around 10,000 MDoFs/s.</p>
<p>If we go to the next-larger size with 37.7 million DoFs, the overall simulation time is 2196 seconds, with 1978 seconds spent in the time stepping. The increase in run time is a factor of 9.3 for the L_h operator (1179 versus 127 seconds) and a factor of 10.3 for the inverse mass matrix and vector updates (797 vs 77.5 seconds). The reason for this non-optimal increase in run time can be traced back to cache effects on the given hardware (with 40 MB of L2 cache and 55 MB of L3 cache): While not all of the relevant data fits into caches for 9.4 million DoFs (one vector takes 75 MB and we have three vectors plus some additional data in <a class="el" href="classMatrixFree.html">MatrixFree</a>), there is capacity for one and a half vector nonetheless. Given that modern caches are more sophisticated than the naive least-recently-used strategy (where we would have little re-use as the data is used in a streaming-like fashion), we can assume that a sizeable fraction of data can indeed be delivered from caches for the 9.4 million DoFs case. For the larger case, even with optimal caching less than 10 percent of data would fit into caches, with an associated loss in performance.</p>
<p><a class="anchor" id="Convergenceratesfortheanalyticaltestcase"></a></p><h3>Convergence rates for the analytical test case</h3>
<p>For the modified Lax&ndash;Friedrichs flux and measuring the error in the momentum variable, we obtain the following convergence table (the rates are very similar for the density and energy variables):</p>
<table align="center" class="doxtable">
<tr>
<th>&#160; </th><th colspan="3"><em>p</em>=2 </th><th colspan="3"><em>p</em>=3 </th><th colspan="3"><em>p</em>=5  </th></tr>
<tr>
<th>n_cells </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate  </th></tr>
<tr>
<td align="right">16 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">2,304 </td><td align="center">1.373e-01 </td><td>&#160;  </td></tr>
<tr>
<td align="right">64 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">4,096 </td><td align="center">9.130e-02 </td><td>&#160; </td><td align="right">9,216 </td><td align="center">8.899e-03 </td><td>3.94  </td></tr>
<tr>
<td align="right">256 </td><td align="right">9,216 </td><td align="center">5.577e-02 </td><td>&#160; </td><td align="right">16,384 </td><td align="center">7.381e-03 </td><td>3.64 </td><td align="right">36,864 </td><td align="center">2.082e-04 </td><td>5.42  </td></tr>
<tr>
<td align="right">1024 </td><td align="right">36,864 </td><td align="center">4.724e-03 </td><td>3.56 </td><td align="right">65,536 </td><td align="center">3.072e-04 </td><td>4.59 </td><td align="right">147,456 </td><td align="center">2.625e-06 </td><td>6.31  </td></tr>
<tr>
<td align="right">4096 </td><td align="right">147,456 </td><td align="center">6.205e-04 </td><td>2.92 </td><td align="right">262,144 </td><td align="center">1.880e-05 </td><td>4.03 </td><td align="right">589,824 </td><td align="center">3.268e-08 </td><td>6.33  </td></tr>
<tr>
<td align="right">16,384 </td><td align="right">589,824 </td><td align="center">8.279e-05 </td><td>2.91 </td><td align="right">1,048,576 </td><td align="center">1.224e-06 </td><td>3.94 </td><td align="right">2,359,296 </td><td align="center">9.252e-10 </td><td>5.14  </td></tr>
<tr>
<td align="right">65,536 </td><td align="right">2,359,296 </td><td align="center">1.105e-05 </td><td>2.91 </td><td align="right">4,194,304 </td><td align="center">7.871e-08 </td><td>3.96 </td><td align="right">9,437,184 </td><td align="center">1.369e-10 </td><td>2.77  </td></tr>
<tr>
<td align="right">262,144 </td><td align="right">9,437,184 </td><td align="center">1.615e-06 </td><td>2.77 </td><td align="right">16,777,216 </td><td align="center">4.961e-09 </td><td>3.99 </td><td align="right">37,748,736 </td><td align="center">7.091e-11 </td><td>0.95  </td></tr>
</table>
<p>If we switch to the Harten-Lax-van Leer flux, the results are as follows: </p><table align="center" class="doxtable">
<tr>
<th>&#160; </th><th colspan="3"><em>p</em>=2 </th><th colspan="3"><em>p</em>=3 </th><th colspan="3"><em>p</em>=5  </th></tr>
<tr>
<th>n_cells </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate  </th></tr>
<tr>
<td align="right">16 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">2,304 </td><td align="center">1.339e-01 </td><td>&#160;  </td></tr>
<tr>
<td align="right">64 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">4,096 </td><td align="center">9.037e-02 </td><td>&#160; </td><td align="right">9,216 </td><td align="center">8.849e-03 </td><td>3.92  </td></tr>
<tr>
<td align="right">256 </td><td align="right">9,216 </td><td align="center">4.204e-02 </td><td>&#160; </td><td align="right">16,384 </td><td align="center">9.143e-03 </td><td>3.31 </td><td align="right">36,864 </td><td align="center">2.501e-04 </td><td>5.14  </td></tr>
<tr>
<td align="right">1024 </td><td align="right">36,864 </td><td align="center">4.913e-03 </td><td>3.09 </td><td align="right">65,536 </td><td align="center">3.257e-04 </td><td>4.81 </td><td align="right">147,456 </td><td align="center">3.260e-06 </td><td>6.26  </td></tr>
<tr>
<td align="right">4096 </td><td align="right">147,456 </td><td align="center">7.862e-04 </td><td>2.64 </td><td align="right">262,144 </td><td align="center">1.588e-05 </td><td>4.36 </td><td align="right">589,824 </td><td align="center">2.953e-08 </td><td>6.79  </td></tr>
<tr>
<td align="right">16,384 </td><td align="right">589,824 </td><td align="center">1.137e-04 </td><td>2.79 </td><td align="right">1,048,576 </td><td align="center">9.400e-07 </td><td>4.08 </td><td align="right">2,359,296 </td><td align="center">4.286e-10 </td><td>6.11  </td></tr>
<tr>
<td align="right">65,536 </td><td align="right">2,359,296 </td><td align="center">1.476e-05 </td><td>2.95 </td><td align="right">4,194,304 </td><td align="center">5.799e-08 </td><td>4.02 </td><td align="right">9,437,184 </td><td align="center">2.789e-11 </td><td>3.94  </td></tr>
<tr>
<td align="right">262,144 </td><td align="right">9,437,184 </td><td align="center">2.038e-06 </td><td>2.86 </td><td align="right">16,777,216 </td><td align="center">3.609e-09 </td><td>4.01 </td><td align="right">37,748,736 </td><td align="center">5.730e-11 </td><td>-1.04  </td></tr>
</table>
<p>The tables show that we get optimal \(\mathcal O\left(h^{p+1}\right)\) convergence rates for both numerical fluxes. The errors are slightly smaller for the Lax&ndash;Friedrichs flux for \(p=2\), but the picture is reversed for \(p=3\); in any case, the differences on this testcase are relatively small.</p>
<p>For \(p=5\), we reach the roundoff accuracy of \(10^{-11}\) with both fluxes on the finest grids. Also note that the errors are absolute with a domain length of \(10^2\), so relative errors are below \(10^{-12}\). The HLL flux is somewhat better for the highest degree, which is due to a slight inaccuracy of the Lax&ndash;Friedrichs flux: The Lax&ndash;Friedrichs flux sets a Dirichlet condition on the solution that leaves the domain, which results in a small artificial reflection, which is accentuated for the Lax&ndash;Friedrichs flux. Apart from that, we see that the influence of the numerical flux is minor, as the polynomial part inside elements is the main driver of the accucary. The limited influence of the flux also has consequences when trying to approach more challenging setups with the higher-order DG setup: Taking for example the parameters and grid of <a class="el" href="step_33.html">step-33</a>, we get oscillations (which in turn make density negative and make the solution explode) with both fluxes once the high-mass part comes near the boundary, as opposed to the low-order finite volume case ( \(p=0\)). Thus, any case that leads to shocks in the solution necessitates some form of limiting or artificial dissipation. For another alternative, see the <a class="el" href="step_69.html">step-69</a> tutorial program.</p>
<p><a class="anchor" id="Resultsforflowinchannelaroundcylinderin2D"></a></p><h3>Results for flow in channel around cylinder in 2D</h3>
<p>For the test case of the flow around a cylinder in a channel, we need to change the first code line to </p><div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> = 1;</div>
</div><!-- fragment --><p> This test case starts with a background field of a constant velocity of Mach number 0.31 and a constant initial density; the flow will have to go around an obstacle in the form of a cylinder. Since we impose a no-penetration condition on the cylinder walls, the flow that initially impinges head-on onto to cylinder has to rearrange, which creates a big sound wave. The following pictures show the pressure at times 0.1, 0.25, 0.5, and 1.0 (top left to bottom right) for the 2D case with 5 levels of global refinement, using 102,400 cells with polynomial degree of 5 and 14.7 million degrees of freedom over all 4 solution variables. We clearly see the discontinuity that propagates slowly in the upstream direction and more quickly in downstream direction in the first snapshot at time 0.1. At time 0.25, the sound wave has reached the top and bottom walls and reflected back to the interior. From the different distances of the reflected waves from lower and upper walls we can see the slight asymmetry of the Sch&auml;fer-Turek test case represented by <a class="el" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder()</a> with somewhat more space above the cylinder compared to below. At later times, the picture is more chaotic with many sound waves all over the place.</p>
<table align="center" class="doxtable" style="width:85%">
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_010.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_025.png" alt="" width="100%" class="inline"/>   </td></tr>
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_050.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_100.png" alt="" width="100%" class="inline"/>   </td></tr>
</table>
<p>The next picture shows an elevation plot of the pressure at time 1.0 looking from the channel inlet towards the outlet at the same resolution &ndash; here, we can see the large number of reflections. In the figure, two types of waves are visible. The larger-amplitude waves correspond to various reflections that happened as the initial discontinuity hit the walls, whereas the small-amplitude waves of size similar to the elements correspond to numerical artifacts. They have their origin in the finite resolution of the scheme and appear as the discontinuity travels through elements with high-order polynomials. This effect can be cured by increasing resolution. Apart from this effect, the rich wave structure is the result of the transport accuracy of the high-order DG method.</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_elevated.jpg" alt="" width="40%" class="inline"/></p>
<p>With 2 levels of global refinement with 1,600 cells, the mesh and its partitioning on 40 MPI processes looks as follows:</p>
<p><img src="https://www.dealii.org/images/steps/developer/step-67.grid-owner.png" alt="" width="70%" class="inline"/></p>
<p>When we run the code with 4 levels of global refinements on 40 cores, we get the following output: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 3,686,400 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 25,600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 7.39876<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.001875, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00110294</div>
<div class="line"> </div>
<div class="line">Time:       0, dt:  7.4<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:   4.17<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, rho * u:  1.629<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, energy: 1.381<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-15</div>
<div class="line">Time:    0.05, dt:  6.3<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02075, rho * u:    0.03801, energy:   0.08772</div>
<div class="line">Time:     0.1, dt:  5.9<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02211, rho * u:    0.04515, energy:   0.08953</div>
<div class="line">Time:    0.15, dt:  5.7<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02261, rho * u:    0.04592, energy:   0.08967</div>
<div class="line">Time:     0.2, dt:  5.8<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02058, rho * u:    0.04361, energy:   0.08222</div>
<div class="line">Time:    0.25, dt:  5.9<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01695, rho * u:    0.04203, energy:   0.06873</div>
<div class="line">Time:     0.3, dt:  5.9<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01653, rho * u:     0.0401, energy:   0.06604</div>
<div class="line">Time:    0.35, dt:  5.7<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01774, rho * u:    0.04264, energy:    0.0706</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">Time:    1.95, dt:  5.8<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01488, rho * u:    0.03923, energy:   0.05185</div>
<div class="line">Time:       2, dt:  5.7<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01432, rho * u:    0.03969, energy:   0.04889</div>
<div class="line"> </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     273.6<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    13 |     273.6<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     273.6<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |   0.01112s    35 |    0.0672s |    0.1337s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      6914 |     5.422s    35 |     15.96s |     29.99s     1 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |     37.24s    35 |      37.3s |     37.37s     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     34564 |     205.4s     1 |     219.5s |     230.1s    35 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    172820 |     153.6s     1 |     164.9s |     175.6s    27 |</div>
<div class="line">| rk_stage - inv mass + vec upd |    172820 |     47.13s    13 |     53.09s |     64.05s    33 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The norms shown here for the various quantities are the deviations \(\rho&#39;\), \((\rho u)&#39;\), and \(E&#39;\) against the background field (namely, the initial condition). The distribution of run time is overall similar as in the previous test case. The only slight difference is the larger proportion of time spent in \(\mathcal L_h\) as compared to the inverse mass matrix and vector updates. This is because the geometry is deformed and the matrix-free framework needs to load additional arrays for the geometry from memory that are compressed in the affine mesh case.</p>
<p>Increasing the number of global refinements to 5, the output becomes: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 14,745,600 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 102,400 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |      2693<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |      2693<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      2693<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    23 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |   0.04537s    32 |     0.173s |    0.3489s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |     13858 |     40.75s    32 |     85.99s |     149.8s     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |     153.8s    32 |     153.9s |     154.1s     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     69284 |      2386<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |      2450<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      2496<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    346420 |      1365<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |      1574<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      1718<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    19 |</div>
<div class="line">| rk_stage - inv mass + vec upd |    346420 |     722.5s    10 |     870.7s |      1125<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The effect on performance is similar to the analytical test case &ndash; in theory, computation times should increase by a factor of 8, but we actually see an increase by a factor of 11 for the time steps (219.5 seconds versus 2450 seconds). This can be traced back to caches, with the small case mostly fitting in caches. An interesting effect, typical of programs with a mix of local communication (integrals \(\mathcal L_h\)) and global communication (computation of transport speed) with some load imbalance, can be observed by looking at the MPI ranks that encounter the minimal and maximal time of different phases, respectively. Rank 0 reports the fastest throughput for the "rk time stepping
total" part. At the same time, it appears to be slowest for the "compute
transport speed" part, almost a factor of 2 slower than the average and almost a factor of 4 compared to the faster rank. Since the latter involves global communication, we can attribute the slowness in this part to the fact that the local Runge&ndash;Kutta stages have advanced more quickly on this rank and need to wait until the other processors catch up. At this point, one can wonder about the reason for this imbalance: The number of cells is almost the same on all MPI processes. However, the matrix-free framework is faster on affine and Cartesian cells located towards the outlet of the channel, to which the lower MPI ranks are assigned. On the other hand, rank 32, which reports the highest run time for the Runga&ndash;Kutta stages, owns the curved cells near the cylinder, for which no data compression is possible. To improve throughput, we could assign different weights to different cell types when partitioning the <a class="el" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a> object, or even measure the run time for a few time steps and try to rebalance then.</p>
<p>The throughput per Runge&ndash;Kutta stage can be computed to 2085 MDoFs/s for the 14.7 million DoFs test case over the 346,000 Runge&ndash;Kutta stages, slightly slower than the Cartesian mesh throughput of 2360 MDoFs/s reported above.</p>
<p>Finally, if we add one additional refinement, we record the following output: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 58,982,400 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 409,600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">Time:    1.95, dt:  1.4<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01488, rho * u:    0.03923, energy:   0.05183</div>
<div class="line">Time:       2, dt:  1.4<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01431, rho * u:    0.03969, energy:   0.04887</div>
<div class="line"> </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              | 2.166<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    26 | 2.166<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 2.166<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    24 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |    0.1758s    30 |     0.672s |     1.376s     1 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |     27748 |     321.3s    34 |     678.8s |      1202<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     1 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |     616.3s    32 |     616.4s |     616.4s    34 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |    138733 | 1.983e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     1 | 2.036e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 2.072e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    693665 | 1.052e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 | 1.248e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.387e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    19 |</div>
<div class="line">| rk_stage - inv mass + vec upd |    693665 |      6404<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    10 |      7868<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.018e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The "rk time stepping total" part corresponds to a throughput of 2010 MDoFs/s. The overall run time to perform 139k time steps is 20k seconds (5.7 hours) or 7 time steps per second &ndash; not so bad for having nearly 60 million unknowns. More throughput can be achieved by adding more cores to the computation.</p>
<p><a class="anchor" id="Resultsforflowinchannelaroundcylinderin3D"></a></p><h3>Results for flow in channel around cylinder in 3D</h3>
<p>Switching the channel test case to 3D with 3 global refinements, the output is </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 221,184,000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 204,800 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">Time:    1.95, dt:  0.00011, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01131, rho * u:    0.03056, energy:   0.04091</div>
<div class="line">Time:       2, dt:  0.00011, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:     0.0119, rho * u:    0.03142, energy:   0.04425</div>
<div class="line"> </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              | 1.734<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     4 | 1.734<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.734<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    38 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |    0.6551s    34 |     3.216s |     7.281s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      3546 |       160<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |     393.2s |     776.9s     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |      1350<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |      1353<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      1357<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     17723 | 1.519e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 | 1.558e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.582e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |     88615 | 1.005e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 | 1.126e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |  1.23e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    11 |</div>
<div class="line">| rk_stage - inv mass + vec upd |     88615 |      3056<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    11 |      4322<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      5759<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The physics are similar to the 2D case, with a slight motion in the z direction due to the gravitational force. The throughput per Runge&ndash;Kutta stage in this case is </p><p class="formulaDsp">
\[ \text{throughput} = \frac{n_\mathrm{time steps} n_\mathrm{stages} n_\mathrm{dofs}}{t_\mathrm{compute}} = \frac{17723 \cdot 5 \cdot 221.2\,\text{M}}{15580s} = 1258\, \text{MDoFs/s}. \]
</p>
<p>The throughput is lower than in 2D because the computation of the \(\mathcal L_h\) term is more expensive. This is due to over-integration with <code>degree+2</code> points and the larger fraction of face integrals (worse volume-to-surface ratio) with more expensive flux computations. If we only consider the inverse mass matrix and vector update part, we record a throughput of 4857 MDoFs/s for the 2D case of the isentropic vortex with 37.7 million unknowns, whereas the 3D case runs with 4535 MDoFs/s. The performance is similar because both cases are in fact limited by the memory bandwidth.</p>
<p>If we go to four levels of global refinement, we need to increase the number of processes to fit everything in memory &ndash; the computation needs around 350 GB of RAM memory in this case. Also, the time it takes to complete 35k time steps becomes more tolerable by adding additional resources. We therefore use 6 nodes with 40 cores each, resulting in a computation with 240 MPI processes: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 240 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 1,769,472,000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 1,638,400 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line"> </div>
<div class="line">...</div>
<div class="line"> </div>
<div class="line">Time:    1.95, dt:  5.6<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01129, rho * u:     0.0306, energy:   0.04086</div>
<div class="line">Time:       2, dt:  5.6<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01189, rho * u:    0.03145, energy:   0.04417</div>
<div class="line"> </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              | 5.396<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   151 | 5.396<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 5.396<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |     2.632s   178 |     7.221s |     16.56s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      7072 |       714<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   193 |      1553<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      3351<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |      8065<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   176 |      8070<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      8079<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     35350 |  4.25e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |  4.43e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 4.515e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   193 |</div>
<div class="line">| rk_stage - <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    176750 | 2.936e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   134 | 3.222e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |  3.67e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    99 |</div>
<div class="line">| rk_stage - inv mass + vec upd |    176750 |      7004<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    99 | 1.207e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |  1.55e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   132 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p> This simulation had nearly 2 billion unknowns &ndash; quite a large computation indeed, and still only needed around 1.5 seconds per time step.</p>
<p><a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>The code presented here straight-forwardly extends to adaptive meshes, given appropriate indicators for setting the refinement flags. Large-scale adaptivity of a similar solver in the context of the acoustic wave equation has been achieved by the <a href="https://github.com/kronbichler/exwave">exwave project</a>. However, in the present context, the benefits of adaptivity are often limited to early times and effects close to the origin of sound waves, as the waves eventually reflect and diffract. This leads to steep gradients all over the place, similar to turbulent flow, and a more or less globally refined mesh.</p>
<p>Another topic that we did not discuss in the results section is a comparison of different time integration schemes. The program provides four variants of low-storage Runga&ndash;Kutta integrators that each have slightly different accuracy and stability behavior. Among the schemes implemented here, the higher-order ones provide additional accuracy but come with slightly lower efficiency in terms of step size per stage before they violate the CFL condition. An interesting extension would be to compare the low-storage variants proposed here with standard Runge&ndash;Kutta integrators or to use vector operations that are run separate from the mass matrix operation and compare performance.</p>
<p><a class="anchor" id="Moreadvancednumericalfluxfunctionsandskewsymmetricformulations"></a></p><h4>More advanced numerical flux functions and skew-symmetric formulations</h4>
<p>As mentioned in the introduction, the modified Lax&ndash;Friedrichs flux and the HLL flux employed in this program are only two variants of a large body of numerical fluxes available in the literature on the Euler equations. One example is the HLLC flux (Harten-Lax-van Leer-Contact) flux which adds the effect of rarefaction waves missing in the HLL flux, or the Roe flux. As mentioned in the introduction, the effect of numerical fluxes on high-order DG schemes is debatable (unlike for the case of low-order discretizations).</p>
<p>A related improvement to increase the stability of the solver is to also consider the spatial integral terms. A shortcoming in the rather naive implementation used above is the fact that the energy conservation of the original Euler equations (in the absence of shocks) only holds up to a discretization error. If the solution is under-resolved, the discretization error can give rise to an increase in the numerical energy and eventually render the discretization unstable. This is because of the inexact numerical integration of the terms in the Euler equations, which both contain rational nonlinearities and higher-degree content from curved cells. A way out of this dilemma are so-called skew-symmetric formulations, see <b>[Gassner2013]</b> for a simple variant. Skew symmetry means that switching the role of the solution \(\mathbf{w}\) and test functions \(\mathbf{v}\) in the weak form produces the exact negative of the original quantity, apart from some boundary terms. In the discrete setting, the challenge is to keep this skew symmetry also when the integrals are only computed approximately (in the continuous case, skew-symmetry is a consequence of integration by parts). Skew-symmetric numerical schemes balance spatial derivatives in the conservative form \((\nabla \mathbf v, \mathbf{F}(\mathbf w))_{K}\) with contributions in the convective form \((\mathbf v, \tilde{\mathbf{F}}(\mathbf w)\nabla \mathbf{w})_{K}\) for some \(\tilde{\mathbf{F}}\). The precise terms depend on the equation and the integration formula, and can in some cases by understood by special skew-symmetric finite difference schemes.</p>
<p>To get started, interested readers could take a look at <a href="https://github.com/kronbichler/advection_miniapp,">https://github.com/kronbichler/advection_miniapp,</a> where a skew-symmetric DG formulation is implemented with deal.II for a simple advection equation.</p>
<p><a class="anchor" id="Equippingthecodeforsupersoniccalculations"></a></p><h4>Equipping the code for supersonic calculations</h4>
<p>As mentioned in the introduction, the solution to the Euler equations develops shocks as the Mach number increases, which require additional mechanisms to stabilize the scheme, e.g. in the form of limiters. The main challenge besides actually implementing the limiter or artificial viscosity approach would be to load-balance the computations, as the additional computations involved for limiting the oscillations in troubled cells would make them more expensive than the plain DG cells without limiting. Furthermore, additional numerical fluxes that better cope with the discontinuities would also be an option.</p>
<p>One ingredient also necessary for supersonic flows are appropriate boundary conditions. As opposed to the subsonic outflow boundaries discussed in the introduction and implemented in the program, all characteristics are outgoing for supersonic outflow boundaries, so we do not want to prescribe any external data, </p><p class="formulaDsp">
\[ \mathbf{w}^+ = \mathbf{w}^- = \begin{pmatrix} \rho^-\\ (\rho \mathbf u)^- \\ E^-\end{pmatrix} \quad \text{(Neumann)}. \]
</p>
<p>In the code, we would simply add the additional statement </p><div class="fragment"><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (supersonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">         supersonic_outflow_boundaries.end())</div>
<div class="line">  {</div>
<div class="line">    w_p        = w_m;</div>
<div class="line">    at_outflow = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p> in the <code>local_apply_boundary_face()</code> function.</p>
<p><a class="anchor" id="ExtensiontothelinearizedEulerequations"></a></p><h4>Extension to the linearized Euler equations</h4>
<p>When the interest with an Euler solution is mostly in the propagation of sound waves, it often makes sense to linearize the Euler equations around a background state, i.e., a given density, velocity and energy (or pressure) field, and only compute the change against these fields. This is the setting of the wide field of aeroacoustics. Even though the resolution requirements are sometimes considerably reduced, implementation gets somewhat more complicated as the linearization gives rise to additional terms. From a code perspective, in the operator evaluation we also need to equip the code with the state to linearize against. This information can be provided either by analytical functions (that are evaluated in terms of the position of the quadrature points) or by a vector similar to the solution. Based on that vector, we would create an additional <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object to read from it and provide the values of the field at quadrature points. If the background velocity is zero and the density is constant, the linearized Euler equations further simplify and can equivalently be written in the form of the acoustic wave equation.</p>
<p>A challenge in the context of sound propagation is often the definition of boundary conditions, as the computational domain needs to be of finite size, whereas the actual simulation often spans an infinite (or at least much larger) physical domain. Conventional Dirichlet or Neumann boundary conditions give rise to reflections of the sound waves that eventually propagate back to the region of interest and spoil the solution. Therefore, various variants of non-reflecting boundary conditions or sponge layers, often in the form of <a href="https://en.wikipedia.org/wiki/Perfectly_matched_layer">perfectly matched layers</a> &ndash; where the solution is damped without reflection &ndash; are common.</p>
<p><a class="anchor" id="ExtensiontothecompressibleNavierStokesequations"></a></p><h4>Extension to the compressible Navier-Stokes equations</h4>
<p>The solver presented in this tutorial program can also be extended to the compressible Navier&ndash;Stokes equations by adding viscous terms, as described in <b>[FehnWallKronbichler2019]</b>. To keep as much of the performance obtained here despite the additional cost of elliptic terms, e.g. via an interior penalty method, one can switch the basis from <a class="el" href="classFE__DGQ.html">FE_DGQ</a> to <a class="el" href="classFE__DGQHermite.html">FE_DGQHermite</a> like in the <a class="el" href="step_59.html">step-59</a> tutorial program.</p>
<p><a class="anchor" id="Usingcellcentricloopsandsharedmemory"></a></p><h4>Using cell-centric loops and shared memory</h4>
<p>In this tutorial, we used face-centric loops. Here, cell and face integrals are treated in separate loops, resulting in multiple writing accesses into the result vector, which is relatively expensive on modern hardware since writing operations generally result also in an implicit read operation. Element-centric loops, on the other hand, are processing a cell and in direct succession processing all its 2d faces. Although this kind of loop implies that fluxes have to be computed twice (for each side of an interior face), the fact that the result vector has to accessed only once might - and the fact that the resulting algorithm is free of race-conditions and as such perfectly suitable for shared memory - already give a performance boost. If you are interested in these advanced topics, you can take a look at <a class="el" href="step_76.html">step-76</a> where we take the present tutorial and modify it so that we can use these features.</p>
<p><a class="anchor" id="PlainProg"></a> </p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2020 - 2021 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Martin Kronbichler, 2020</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 0;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#adc634dce0c07c9dbb94d367c8d97afd3">dimension</a>            = 2;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 3;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>            = 5;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a> + 2;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>, 1.5);</div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>, <span class="comment">/* Tselios, Simos, 2007 */</span></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">      : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    {}</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="classEuler__DG_1_1ExactSolution.html#a16ae78e70f688acd015b407649997f1b">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">            x0[0] = 5.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">              (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> - x0).norm_square() - 2. * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - x0[0]) * t + t * t;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">              <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">              std::abs(1. - (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * 0.25 * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log * (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1] - x0[1]);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - t - x0[0]);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                  std::exp2(density_log * (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) +</div>
<div class="line">                       0.5 * (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u * u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> 1.;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> 0.4;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">              <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              <span class="keywordflow">return</span> 0.;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> 0.;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">        }</div>
<div class="line">      <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">        <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">        rk_integrator(lsrk);</div>
<div class="line">      rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <span class="keywordflow">return</span> bi.size();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">    <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                           VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                           VectorType &amp;    vec_ri,</div>
<div class="line">                           VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"> </div>
<div class="line">      pde_operator.perform_stage(current_time,</div>
<div class="line">                                 bi[0] * time_step,</div>
<div class="line">                                 ai[0] * time_step,</div>
<div class="line">                                 <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                 vec_ri,</div>
<div class="line">                                 <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                 vec_ri);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 1; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = ci[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>];</div>
<div class="line">          pde_operator.perform_stage(current_time + c_i * time_step,</div>
<div class="line">                                     bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step,</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size() - 1 ?</div>
<div class="line">                                        0 :</div>
<div class="line">                                        ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step),</div>
<div class="line">                                     vec_ri,</div>
<div class="line">                                     vec_ki,</div>
<div class="line">                                     <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                     vec_ri);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    std::vector&lt;double&gt; bi;</div>
<div class="line">    std::vector&lt;double&gt; ai;</div>
<div class="line">    std::vector&lt;double&gt; ci;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * inverse_density;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] - 0.5 * rho_u_dot_u);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">          <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">          <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aec42034f53f838aafe42fb93b273eb92">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">              0.5 * <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line">                                       velocity_m.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 0.5 * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                   0.5 * lambda * (u_m - u_p);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">              0.5 * ((velocity_m + velocity_p) * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">              0.5 * <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> *</div>
<div class="line">              (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal - avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos - s_neg);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> inverse_s *</div>
<div class="line">                   ((s_pos * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) - s_neg * (flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)) -</div>
<div class="line">                    s_pos * s_neg * (u_m - u_p));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keywordflow">return</span> {};</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerOperator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">    EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                             std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">      std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">               <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">               <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    perform_stage(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> cur_time,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_solution,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_ai,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;next_ri) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">                 <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">      inflow_boundaries;</div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                   subsonic_outflow_boundaries;</div>
<div class="line">    std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">    std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_inverse_mass_matrix(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_cell(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_face(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_boundary_face(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerOperator.html#aae07d964990108d9f0b51995835e4a10">EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator</a>(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">    : timer(timer)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                    <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line">    additional_data.mapping_update_flags =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.mapping_update_flags_inner_faces =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.mapping_update_flags_boundary_faces =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.tasks_parallel_scheme =</div>
<div class="line">      <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData::none</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">    this-&gt;body_force = std::move(body_force);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_cell(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; constant_body_force;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">      constant_body_force = evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">        *constant_function, <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt;());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">            phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">            <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; force =</div>
<div class="line">                  constant_function ? constant_body_force :</div>
<div class="line">                                      evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">                                        *body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; forcing;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">                phi.submit_value(forcing, q);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(((body_force.get() != <span class="keyword">nullptr</span>) ?</div>
<div class="line">                                 <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a> :</div>
<div class="line">                                 <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea84d99583fd787b7e846f9e4b6f7c97c0">EvaluationFlags::nothing</a>) |</div>
<div class="line">                                <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeadde91684ebb2c6ec5c5c5293123f6a04">EvaluationFlags::gradients</a>,</div>
<div class="line">                              <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                      <span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                      <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_m.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">              euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                        phi_p.get_value(q),</div>
<div class="line">                                        phi_m.get_normal_vector(q));</div>
<div class="line">            phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">            phi_p.submit_value(numerical_flux, q);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        phi_p.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">        phi_m.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_boundary_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi.get_normal_vector(q);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; w_p;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) != wall_boundaries.end())</div>
<div class="line">              {</div>
<div class="line">                w_p[0] = w_m[0];</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] - 2. * rho_u_dot_n * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                     inflow_boundaries.end())</div>
<div class="line">              w_p =</div>
<div class="line">                <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                                  phi.quadrature_point(q));</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                     subsonic_outflow_boundaries.end())</div>
<div class="line">              {</div>
<div class="line">                w_p          = w_m;</div>
<div class="line">                w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                  *subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                  phi.quadrature_point(q),</div>
<div class="line">                  <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">                at_outflow = <span class="keyword">true</span>;</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                          <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                     <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                     <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt; -1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            phi.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_inverse_mass_matrix(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.apply(phi.begin_dof_values(), phi.begin_dof_values());</div>
<div class="line"> </div>
<div class="line">        phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">EulerOperator&lt;dim, degree, n_points_1d&gt;::apply</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - integrals&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">                &amp;EulerOperator::local_apply_face,</div>
<div class="line">                &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">                <span class="keyword">this</span>,</div>
<div class="line">                <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                src,</div>
<div class="line">                <span class="keyword">true</span>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - inverse mass&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(&amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">                     <span class="keyword">this</span>,</div>
<div class="line">                     <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                     <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_solution,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_ai,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      next_ri)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - integrals L_h&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">                &amp;EulerOperator::local_apply_face,</div>
<div class="line">                &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">                <span class="keyword">this</span>,</div>
<div class="line">                vec_ki,</div>
<div class="line">                current_ri,</div>
<div class="line">                <span class="keyword">true</span>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - inv mass + vec upd&quot;</span>);</div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(</div>
<div class="line">        &amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">        <span class="keyword">this</span>,</div>
<div class="line">        next_ri,</div>
<div class="line">        vec_ki,</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)&gt;(),</div>
<div class="line">        [&amp;](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start_range, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> end_range) {</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> ai = factor_ai;</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> bi = factor_solution;</div>
<div class="line">          <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">            {</div>
<div class="line">              <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi * k_i;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">              <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi * k_i;</div>
<div class="line">                  next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)  = sol_i + ai * k_i;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                                 phi.quadrature_point(q)),</div>
<div class="line">                               q);</div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                 phi.begin_dof_values(),</div>
<div class="line">                                                 phi.begin_dof_values());</div>
<div class="line">        phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_errors_squared[3] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line">              phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line"> </div>
<div class="line">            local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_max = 0.;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> convective_speed = inverse_jacobian * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">            <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> convective_limit = 0.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              convective_limit =</div>
<div class="line">                <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">              <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> * (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="chunk__sparse__matrix__0_8txt.html#ad43ded305d7756c82052fec150fdf5dd">transpose</a>(inverse_jacobian) *</div>
<div class="line">                              (inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">                <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> eigenvector_norm = 0.;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  eigenvector_norm =</div>
<div class="line">                    <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">              }</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">              (jac_times_ev * jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">            local_max =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                       max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> max_transport;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span><a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a></div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor</a>()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">    <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">             <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">            inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] * inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">      interpretation;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> interpretation;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::EulerProblem</a>()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::make_grid_and_dofs</a>()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = -5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">            upper_right[0] = 10;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                           lower_left,</div>
<div class="line">                                           upper_right);</div>
<div class="line">            <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">              <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">            euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">              1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_wall_boundary(2);</div>
<div class="line">            euler_operator.set_wall_boundary(3);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">              euler_operator.set_body_force(</div>
<div class="line">                std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                  std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line"> </div>
<div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">    euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.get_stream().getloc();</div>
<div class="line">    pcout.get_stream().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">    pcout.get_stream().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::output_results</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">      euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">      <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">      {</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">      }</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">            interpretation;</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            interpretation.push_back(</div>
<div class="line">              <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">          data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                   <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                   <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                   interpretation);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">      mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                             <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                             <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> std::string filename =</div>
<div class="line">        <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number&gt;::size</a>();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) * n_vect_number;</div>
<div class="line"> </div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">    rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">        min_vertex_distance =</div>
<div class="line">          <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">    min_vertex_distance =</div>
<div class="line">      <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">                euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">          &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    output_results(0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">      {</div>
<div class="line">        ++timestep_number;</div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">          time_step =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">            <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">          integrator.perform_time_step(euler_operator,</div>
<div class="line">                                       <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                       time_step,</div>
<div class="line">                                       <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                       rk_register_1,</div>
<div class="line">                                       rk_register_2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> - time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">          output_results(</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    timer.print_wall_time_statistics(MPI_COMM_WORLD);</div>
<div class="line">    pcout &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace Euler_DG</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p><br  />
 This tutorial depends on <a class="el" href="step_33.html">step-33</a> , <a class="el" href="step_48.html">step-48</a> , <a class="el" href="step_59.html">step-59</a> .  
<table class="tutorial" width="50%">
<tr><th colspan="2"><b><small>Table of contents</small></b><b><small>Table of contents</small></b></th></tr>
<tr><td width="50%" valign="top">
<ol>
  <li> <a href="#Intro" class=bold>Introduction</a><a href="#Intro" class=bold>Introduction</a>
    <ul>
        <li><a href="#TheEulerequations">The Euler equations</a><a href="#TheEulerequations">The Euler equations</a>
        <li><a href="#HighorderdiscontinuousGalerkindiscretization">High-order discontinuous Galerkin discretization</a><a href="#HighorderdiscontinuousGalerkindiscretization">High-order discontinuous Galerkin discretization</a>
        <li><a href="#Explicittimeintegration">Explicit time integration</a><a href="#Explicittimeintegration">Explicit time integration</a>
        <li><a href="#Fastevaluationofintegralsbymatrixfreetechniques">Fast evaluation of integrals by matrix-free techniques</a><a href="#Fastevaluationofintegralsbymatrixfreetechniques">Fast evaluation of integrals by matrix-free techniques</a>
        <li><a href="#Evaluationoftheinversemassmatrixwithmatrixfreetechniques">Evaluation of the inverse mass matrix with matrix-free techniques</a><a href="#Evaluationoftheinversemassmatrixwithmatrixfreetechniques">Evaluation of the inverse mass matrix with matrix-free techniques</a>
        <li><a href="#Thetestcase">The test case</a><a href="#Thetestcase">The test case</a>
    </ul>
  <li> <a href="#CommProg" class=bold>The commented program</a><a href="#CommProg" class=bold>The commented program</a>
    <ul>
        <li><a href="#Equationdata">Equation data</a><a href="#Equationdata">Equation data</a>
        <li><a href="#LowstorageexplicitRungeKuttatimeintegrators">Low-storage explicit Runge&mdash;Kutta time integrators</a><a href="#LowstorageexplicitRungeKuttatimeintegrators">Low-storage explicit Runge&mdash;Kutta time integrators</a>
        <li><a href="#ImplementationofpointwiseoperationsoftheEulerequations">Implementation of point-wise operations of the Euler equations</a><a href="#ImplementationofpointwiseoperationsoftheEulerequations">Implementation of point-wise operations of the Euler equations</a>
        <li><a href="#TheEulerOperationclass">The EulerOperation class</a><a href="#TheEulerOperationclass">The EulerOperation class</a>
      <ul>
        <li><a href="#Localevaluators">Local evaluators</a><a href="#Localevaluators">Local evaluators</a>
        <li><a href="#Theapplyandrelatedfunctions">The apply() and related functions</a><a href="#Theapplyandrelatedfunctions">The apply() and related functions</a>
      </ul>
        <li><a href="#TheEulerProblemclass">The EulerProblem class</a><a href="#TheEulerProblemclass">The EulerProblem class</a>
      </ul>
</ol></td><td width="50%" valign="top"><ol>
  <li value="3"> <a href="#Results" class=bold>Results</a><a href="#Results" class=bold>Results</a>
    <ul>
        <li><a href="#Programoutput">Program output</a><a href="#Programoutput">Program output</a>
        <li><a href="#Convergenceratesfortheanalyticaltestcase">Convergence rates for the analytical test case</a><a href="#Convergenceratesfortheanalyticaltestcase">Convergence rates for the analytical test case</a>
        <li><a href="#Resultsforflowinchannelaroundcylinderin2D">Results for flow in channel around cylinder in 2D</a><a href="#Resultsforflowinchannelaroundcylinderin2D">Results for flow in channel around cylinder in 2D</a>
        <li><a href="#Resultsforflowinchannelaroundcylinderin3D">Results for flow in channel around cylinder in 3D</a><a href="#Resultsforflowinchannelaroundcylinderin3D">Results for flow in channel around cylinder in 3D</a>
        <li><a href="#Possibilitiesforextensions">Possibilities for extensions</a><a href="#Possibilitiesforextensions">Possibilities for extensions</a>
      <ul>
        <li><a href="#Moreadvancednumericalfluxfunctionsandskewsymmetricformulations">More advanced numerical flux functions and skew-symmetric formulations</a><a href="#Moreadvancednumericalfluxfunctionsandskewsymmetricformulations">More advanced numerical flux functions and skew-symmetric formulations</a>
        <li><a href="#Equippingthecodeforsupersoniccalculations">Equipping the code for supersonic calculations</a><a href="#Equippingthecodeforsupersoniccalculations">Equipping the code for supersonic calculations</a>
        <li><a href="#ExtensiontothelinearizedEulerequations">Extension to the linearized Euler equations</a><a href="#ExtensiontothelinearizedEulerequations">Extension to the linearized Euler equations</a>
        <li><a href="#ExtensiontothecompressibleNavierStokesequations">Extension to the compressible Navier-Stokes equations</a><a href="#ExtensiontothecompressibleNavierStokesequations">Extension to the compressible Navier-Stokes equations</a>
        <li><a href="#Usingcellcentricloopsandsharedmemory">Using cell-centric loops and shared memory</a><a href="#Usingcellcentricloopsandsharedmemory">Using cell-centric loops and shared memory</a>
    </ul>
    </ul>
  <li> <a href="#PlainProg" class=bold>The plain program</a><a href="#PlainProg" class=bold>The plain program</a>
</ol> </td> </tr> </table>
 </p><pre class="fragment">&lt;br&gt;  
</pre><p> <em> This program was contributed by Martin Kronbichler. Many ideas presented here are the result of common code development with Niklas Fehn, Katharina Kormann, Peter Munch, and Svenja Schoeder.</em></p>
<p><em>This work was partly supported by the German Research Foundation (DFG) through the project "High-order discontinuous Galerkin for the exa-scale" (ExaDG) within the priority program "Software for Exascale Computing" (SPPEXA). </em> <a class="anchor" id="Intro"></a><a class="anchor" id="Introduction"></a></p><h1>Introduction</h1>
<p>This tutorial program solves the Euler equations of fluid dynamics using anexplicit time integrator with the matrix-free framework applied to ahigh-order discontinuous Galerkin discretization in space. For details aboutthe Euler system and an alternative implicit approach, we also refer to the <a class="el" href="step_33.html">step-33</a> tutorial program. You might also want to look at <a class="el" href="step_69.html">step-69</a> foran alternative approach to solving these equations.</p>
<p><a class="anchor" id="TheEulerequations"></a></p><h3>The Euler equations</h3>
<p>The Euler equations are a conservation law, describing the motion of acompressible inviscid gas, </p><p class="formulaDsp">
\[ \frac{\partial \mathbf{w}}{\partial t} + \nabla \cdot \mathbf{F}(\mathbf{w}) = \mathbf{G}(\mathbf w), \]
</p>
<p>@_fakenlwhere the \(d+2\) components of the solution vector are \(\mathbf{w}=(\rho, \rho u_1,\ldots,\rho u_d,E)^{\mathrm T}\) . Here, \(\rho\) denotes the fluid density, \({\mathbf u}=(u_1,\ldots, u_d)^\mathrm T\) the fluid velocity, and \(E\) theenergy density of the gas. The velocity is not directly solved for, but ratherthe variable \(\rho \mathbf{u}\) , the linear momentum (since this is theconserved quantity). The Euler flux function, a \((d+2)\times d\) matrix, is defined as </p><p class="formulaDsp">
\[ \mathbf F(\mathbf w) = \begin{pmatrix} \rho \mathbf{u}\\ \rho \mathbf{u} \otimes \mathbf{u} + \mathbb{I}p\\ (E+p)\mathbf{u} \end{pmatrix} \]
</p>
<p>@_fakenlwith \(\mathbb{I}\) the \(d\times d\) identity matrix and \(\otimes\) the outerproduct; its components denote the mass, momentum, and energy fluxes, respectively.The right hand side forcing is given by </p><p class="formulaDsp">
\[ \mathbf G(\mathbf w) = \begin{pmatrix} 0\\ \rho\mathbf{g}\\ \rho \mathbf{u} \cdot \mathbf{g} \end{pmatrix}, \]
</p>
<p>@_fakenlwhere the vector \(\mathbf g\) denotes the direction and magnitude ofgravity. It could, however, also denote any other external force per unit massthat is acting on the fluid. (Think, for example, of the electrostaticforces exerted by an external electric field on charged particles.) The three blocks of equations, the second involving \(d\) components, describethe conservation of mass, momentum, and energy. The pressure is not asolution variable but needs to be expressed through a "closure relationship"by the other variables; we here choose the relationship appropriatefor a gas with molecules composed of two atoms, which at moderatetemperatures is given by \(p=(\gamma - 1) \left(E-\frac 12 \rho \mathbf{u}\cdot \mathbf{u}\right)\) with the constant \(\gamma = 1.4\) .</p>
<p><a class="anchor" id="HighorderdiscontinuousGalerkindiscretization"></a></p><h3>High-order discontinuous Galerkin discretization</h3>
<p>For spatial discretization, we use a high-order discontinuous Galerkin (DG)discretization, using a solution expansion of the form </p><p class="formulaDsp">
\[ \mathbf{w}_h(\mathbf{x}, t) = \sum_{j=1}^{n_\mathbf{dofs}} \boldsymbol{\varphi}_j(\mathbf{x}) {w}_j(t). \]
</p>
<p>@_fakenlHere, \(\boldsymbol{\varphi}_j\) denotes the \(j\) th basis function, writtenin vector form with separate shape functions for the different components andletting \(w_j(t)\) go through the density, momentum, and energy variables,respectively. In this form, the space dependence is contained in the shapefunctions and the time dependence in the unknown coefficients \(w_j\) . Asopposed to the continuous finite element method where some shape functionsspan across element boundaries, the shape functions are local to a singleelement in DG methods, with a discontinuity from one element to the next. Theconnection of the solution from one cell to its neighbors is insteadimposed by the numerical fluxesspecified below. This allows for some additional flexibility, for example tointroduce directionality in the numerical method by, e.g., upwinding. DG methods are popular methods for solving problems of transport characterbecause they combine low dispersion errors with controllable dissipation onbarely resolved scales. This makes them particularly attractive for simulationin the field of fluid dynamics where a wide range of active scales needs to berepresented and inadequately resolved features are prone to disturb theimportant well-resolved features. Furthermore, high-order DG methods arewell-suited for modern hardware with the right implementation. At the sametime, DG methods are no silver bullet. In particular when the solutiondevelops discontinuities (shocks), as is typical for the Euler equations insome flow regimes, high-order DG methods tend to oscillatory solutions, likeall high-order methods when not using flux- or slope-limiters. This is a consequence of <a href="https://en.wikipedia.org/wiki/Godunov%27s_theorem">Godunov's theorem</a>that states that any total variation limited (TVD) scheme that is linear (likea basic DG discretization) can at most be first-order accurate. Putdifferently, since DG methods aim for higher order accuracy, they cannot beTVD on solutions that develop shocks. Even though some communities claim thatthe numerical flux in DG methods can control dissipation, this is of limitedvalue unless <b>all</b> shocks in a problem align with cell boundaries. Anyshock that passes through the interior of cells will again produce oscillatorycomponents due to the high-order polynomials. In the finite element and DGcommunities, there exist a number of different approaches to deal with shocks,for example the introduction of artificial diffusion on troubled cells (usinga troubled-cell indicator based e.g. on a modal decomposition of thesolution), a switch to dissipative low-order finite volume methods on asubgrid, or the addition of some limiting procedures. Given the amplepossibilities in this context, combined with the considerable implementationeffort, we here refrain from the regime of the Euler equations with pronouncedshocks, and rather concentrate on the regime of subsonic flows with wave-likephenomena. For a method that works well with shocks (but is more expensive perunknown), we refer to the <a class="el" href="step_69.html">step-69</a> tutorial program. For the derivation of the DG formulation, we multiply the Euler equations withtest functions \(\mathbf{v}\) and integrate over an individual cell \(K\) , whichgives </p><p class="formulaDsp">
\[ \left(\mathbf{v}, \frac{\partial \mathbf{w}}{\partial t}\right)_{K} + \left(\mathbf{v}, \nabla \cdot \mathbf{F}(\mathbf{w})\right)_{K} = \left(\mathbf{v},\mathbf{G}(\mathbf w)\right)_{K}. \]
</p>
<p> We then integrate the second term by parts, moving the divergencefrom the solution slot to the test function slot, and producing an integralover the element boundary: </p><p class="formulaDsp">
\[ \left(\mathbf{v}, \frac{\partial \mathbf{w}}{\partial t}\right)_{K} - \left(\nabla \mathbf{v}, \mathbf{F}(\mathbf{w})\right)_{K} + \left&lt;\mathbf{v}, \mathbf{n} \cdot \widehat{\mathbf{F}}(\mathbf{w}) \right&gt;_{\partial K} = \left(\mathbf{v},\mathbf{G}(\mathbf w)\right)_{K}. \]
</p>
<p>@_fakenlIn the surface integral, we have replaced the term \(\mathbf{F}(\mathbf w)\) bythe term \(\widehat{\mathbf{F}}(\mathbf w)\) , the numerical flux. The role ofthe numerical flux is to connect the solution on neighboring elements andweakly impose continuity of the solution. This ensures that the globalcoupling of the PDE is reflected in the discretization, despite independentbasis functions on the cells. The connectivity to the neighbor is included bydefining the numerical flux as a function \(\widehat{\mathbf{F}}(\mathbf w^-, \mathbf w^+)\) of the solution from both sides of an interior face, \(\mathbf w^-\) and \(\mathbf w^+\) . A basic property we require is that the numerical fluxneeds to be <b>conservative</b>. That is, we want all information (i.e.,mass, momentum, and energy) that leaves a cell overa face to enter the neighboring cell in its entirety and vice versa. This canbe expressed as \(\widehat{\mathbf{F}}(\mathbf w^-, \mathbf w^+) = \widehat{\mathbf{F}}(\mathbf w^+, \mathbf w^-)\) , meaning that the numericalflux evaluates to the same result from either side. Combined with the factthat the numerical flux is multiplied by the unit outer normal vector on theface under consideration, which points in opposite direction from the twosides, we see that the conservation is fulfilled. An alternative point of viewof the numerical flux is as a single-valued intermediate state that links thesolution weakly from both sides. There is a large number of numerical flux functions available, also calledRiemann solvers. For the Euler equations, there exist so-called exact Riemannsolvers</p>
<ul>
<li>meaning that the states from both sides are combined in a way thatis consistent with the Euler equations along a discontinuity</li>
<li>andapproximate Riemann solvers, which violate some physical properties and relyon other mechanisms to render the scheme accurate overall. Approximate Riemannsolvers have the advantage of beging cheaper to compute. Most flux functionshave their origin in the finite volume community, which are similar to DGmethods with polynomial degree 0 within the cells (called volumes). As thevolume integral of the Euler operator \(\mathbf{F}\) would disappear forconstant solution and test functions, the numerical flux must fully representthe physical operator, explaining why there has been a large body of researchin that community. For DG methods, consistency is guaranteed by higher orderpolynomials within the cells, making the numerical flux less of an issue andusually affecting only the convergence rate, e.g., whether the solutionconverges as \(\mathcal O(h^p)\) , \(\mathcal O(h^{p+1/2})\) or \(\mathcal O(h^{p+1})\) in the \(L_2\) norm for polynomials of degree \(p\) . The numericalflux can thus be seen as a mechanism to select more advantageousdissipation/dispersion properties or regarding the extremal eigenvalue of thediscretized and linearized operator, which affect the maximal admissible timestep size in explicit time integrators. In this tutorial program, we implement two variants of fluxes that can becontrolled via a switch in the program (of course, it would be easy to makethem a run time parameter controlled via an input file). The first flux isthe local Lax&ndash;Friedrichs flux <p class="formulaDsp">
\[ \hat{\mathbf{F}}(\mathbf{w}^-,\mathbf{w}^+) = \frac{\mathbf{F}(\mathbf{w}^-)+\mathbf{F}(\mathbf{w}^+)}{2} + \frac{\lambda}{2}\left[\mathbf{w}^--\mathbf{w}^+\right]\otimes \mathbf{n^-}. \]
</p>
 In the original definition of the Lax&ndash;Friedrichs flux, a factor \(\lambda = \max\left(\|\mathbf{u}^-\|+c^-, \|\mathbf{u}^+\|+c^+\right)\) is used(corresponding to the maximal speed at which information is moving onthe two sides of the interface), statingthat the difference between the two states, \([\![\mathbf{w}]\!]\) is penalizedby the largest eigenvalue in the Euler flux, which is \(\|\mathbf{u}\|+c\) ,where \(c=\sqrt{\gamma p / \rho}\) is the speed of sound. In the implementationbelow, we modify the penalty term somewhat, given that the penalty is ofapproximate nature anyway. We use <p class="formulaDsp">
\begin{align*} \lambda &amp;= \frac{1}{2}\max\left(\sqrt{\|\mathbf{u^-}\|^2+(c^-)^2}, \sqrt{\|\mathbf{u}^+\|^2+(c^+)^2}\right) \\ &amp;= \frac{1}{2}\sqrt{\max\left(\|\mathbf{u^-}\|^2+(c^-)^2, \|\mathbf{u}^+\|^2+(c^+)^2\right)}. \end{align*}
</p>
 The additional factor \(\frac 12\) reduces the penalty strength (which resultsin a reduced negative real part of the eigenvalues, and thus increases theadmissible time step size). Using the squares within the sums allows us toreduce the number of expensive square root operations, which is 4 for theoriginal Lax&ndash;Friedrichs definition, to a single one.This simplification leads to at most a factor of2 in the reduction of the parameter \(\lambda\) , since \(\|\mathbf{u}\|^2+c^2 \leq \|\mathbf{u}\|^2+2 c |\mathbf{u}\| + c^2 = \left(\|\mathbf{u}\|+c\right)^2 \leq 2 \left(\|\mathbf{u}\|^2+c^2\right)\) , with the last inequality followingfrom Young's inequality. The second numerical flux is one proposed by Harten, Lax and van Leer, calledthe HLL flux. It takes the different directions of propagation of the Eulerequations into account, depending on the speed of sound. It utilizes someintermediate states \(\bar{\mathbf{u}}\) and \(\bar{c}\) to define the twobranches \(s^\mathrm{p} = \max\left(0, \bar{\mathbf{u}}\cdot \mathbf{n} + \bar{c}\right)\) and \(s^\mathrm{n} = \min\left(0, \bar{\mathbf{u}}\cdot \mathbf{n} - \bar{c}\right)\) . From these branches, one then defines the flux <p class="formulaDsp">
\[ \hat{\mathbf{F}}(\mathbf{w}^-,\mathbf{w}^+) = \frac{s^\mathrm{p} \mathbf{F}(\mathbf{w}^-)-s^\mathrm{n} \mathbf{F}(\mathbf{w}^+)} {s^\mathrm p - s^\mathrm{n} } + \frac{s^\mathrm{p} s^\mathrm{n}}{s^\mathrm{p}-s^\mathrm{n}} \left[\mathbf{w}^--\mathbf{w}^+\right]\otimes \mathbf{n^-}. \]
</p>
@_fakenlRegarding the definition of the intermediate state \(\bar{\mathbf{u}}\) and \(\bar{c}\) , several variants have been proposed. The variant originallyproposed uses a density-averaged definition of the velocity, \(\bar{\mathbf{u}} = \frac{\sqrt{\rho^-} \mathbf{u}^- + \sqrt{\rho^+}\mathbf{u}^+}{\sqrt{\rho^-} + \sqrt{\rho^+}}\) . Since we consider the Euler equations without shocks, wesimply use arithmetic means, \(\bar{\mathbf{u}} = \frac{\mathbf{u}^- + \mathbf{u}^+}{2}\) and \(\bar{c} = \frac{c^- + c^+}{2}\) , with \(c^{\pm} = \sqrt{\gamma p^{\pm} / \rho^{\pm}}\) , in this tutorial program, and leave othervariants to a possible extension. We also note that the HLL flux has beenextended in the literature to the so-called HLLC flux, where C stands for theability to represent contact discontinuities. At the boundaries with no neighboring state \(\mathbf{w}^+\) available, it iscommon practice to deduce suitable exterior values from the boundaryconditions (see the general literature on DG methods for details). In thistutorial program, we consider three types of boundary conditions, namely<b>inflow boundary conditions</b> where all components are prescribed, <p class="formulaDsp">
\[ \mathbf{w}^+ = \begin{pmatrix} \rho_\mathrm{D}(t)\\ (\rho \mathbf u)_{\mathrm D}(t) \\ E_\mathrm{D}(t)\end{pmatrix} \quad \text{(Dirichlet)}, \]
</p>
<b>subsonic outflow boundaries</b>, where we do not prescribe exteriorsolutions as the flow field is leaving the domain and use the interior valuesinstead; we still need to prescribe the energy as there is one incomingcharacteristic left in the Euler flux, <p class="formulaDsp">
\[ \mathbf{w}^+ = \begin{pmatrix} \rho^-\\ (\rho \mathbf u)^- \\ E_\mathrm{D}(t)\end{pmatrix} \quad \text{(mixed Neumann/Dirichlet)}, \]
</p>
@_fakenland <b>wall boundary condition</b> which describe a no-penetrationconfiguration: <p class="formulaDsp">
\[ \mathbf{w}^+ = \begin{pmatrix} \rho^-\\ (\rho \mathbf u)^- - 2 [(\rho \mathbf u)^-\cdot \mathbf n] \mathbf{n} \\ E^-\end{pmatrix}. \]
</p>
 The polynomial expansion of the solution is finally inserted to the weak formand test functions are replaced by the basis functions. This gives a discretein space, continuous in time nonlinear system with a finite number of unknowncoefficient values \(w_j\) , \(j=1,\ldots,n_\text{dofs}\) . Regarding the choice ofthe polynomial degree in the DG method, there is no consensus in literature asof 2019 as to what polynomial degrees are most efficient and the decision isproblem-dependent. Higher order polynomials ensure better convergence ratesand are thus superior for moderate to high accuracy requirements for<b>smooth</b> solutions. At the same time, the volume-to-surface ratioof where degrees of freedom are located,increases with higher degrees, and this makes the effect of the numerical fluxweaker, typically reducing dissipation. However, in most of the cases thesolution is not smooth, at least not compared to the resolution that can beafforded. This is true for example in incompressible fluid dynamics,compressible fluid dynamics, and the related topic of wave propagation. In thispre-asymptotic regime, the error is approximately proportional to thenumerical resolution, and other factors such as dispersion errors or thedissipative behavior become more important. Very high order methods are oftenruled out because they come with more restrictive CFL conditions measuredagainst the number of unknowns, and they are also not as flexible when itcomes to representing complex geometries. Therefore, polynomial degreesbetween two and six are most popular in practice, see e.g. the efficiencyevaluation in <b>[FehnWallKronbichler2019]</b> and references cited therein. <a class="anchor" id="Explicittimeintegration"></a><h3>Explicit time integration</h3>
</li>
</ul>
<p>To discretize in time, we slightly rearrange the weak form and sum over allcells: </p><p class="formulaDsp">
\[ \sum_{K \in \mathcal T_h} \left(\boldsymbol{\varphi}_i, \frac{\partial \mathbf{w}}{\partial t}\right)_{K} = \sum_{K\in \mathcal T_h} \left[ \left(\nabla \boldsymbol{\varphi}_i, \mathbf{F}(\mathbf{w})\right)_{K} -\left&lt;\boldsymbol{\varphi}_i, \mathbf{n} \cdot \widehat{\mathbf{F}}(\mathbf{w})\right&gt;_{\partial K} + \left(\boldsymbol{\varphi}_i,\mathbf{G}(\mathbf w)\right)_{K} \right], \]
</p>
<p>@_fakenlwhere \(\boldsymbol{\varphi}_i\) runs through all basis functions with from 1 to \(n_\text{dofs}\) . We now denote by \(\mathcal M\) the mass matrix with entries \(\mathcal M_{ij} = \sum_{K} \left(\boldsymbol{\varphi}_i, \boldsymbol{\varphi}_j\right)_K\) , and by </p><p class="formulaDsp">
\[ \mathcal L_h(t,\mathbf{w}_h) = \left[\sum_{K\in \mathcal T_h} \left[ \left(\nabla \boldsymbol{\varphi}_i, \mathbf{F}(\mathbf{w}_h)\right)_{K} - \left&lt;\boldsymbol{\varphi}_i, \mathbf{n} \cdot \widehat{\mathbf{F}}(\mathbf{w}_h)\right&gt;_{\partial K} + \left(\boldsymbol{\varphi}_i,\mathbf{G}(\mathbf w_h)\right)_{K} \right]\right]_{i=1,\ldots,n_\text{dofs}}. \]
</p>
<p>@_fakenlthe operator evaluating the right-hand side of the Euler operator, given afunction \(\mathbf{w}_h\) associated with a global vector of unknownsand the finite element in use. This function \(\mathcal L_h\) is explicitly time-dependent as thenumerical flux evaluated at the boundary will involve time-dependent data \(\rho_\mathrm{D}\) , \((\rho \mathbf{u})_\mathrm{D}\) , and \(E_\mathbf{D}\) on someparts of the boundary, depending on the assignment of boundaryconditions. With this notation, we can write the discrete in space, continuousin time system compactly as </p><p class="formulaDsp">
\[ \mathcal M \frac{\partial \mathbf{w}_h}{\partial t} = \mathcal L_h(t, \mathbf{w}_h), \]
</p>
<p>@_fakenlwhere we have taken the liberty to also denote the global solutionvector by \(\mathbf{w}_h\) (in addition to the the corresponding finiteelement function). Equivalently, the system above has the form </p><p class="formulaDsp">
\[ \frac{\partial \mathbf{w}_h}{\partial t} = \mathcal M^{-1} \mathcal L_h(t, \mathbf{w}_h). \]
</p>
<p> For hyperbolic systems discretized by high-order discontinuous Galerkinmethods, explicit time integration of this system is very popular. This is dueto the fact that the mass matrix \(\mathcal M\) is block-diagonal (with eachblock corresponding to only variables of the same kind defined on the samecell) and thus easily inverted. In each time step</p>
<ul>
<li>or stage of aRunge&ndash;Kutta scheme</li>
<li>one only needs to evaluate the differential operatoronce using the given data and subsequently apply the inverse of the massmatrix. For implicit time stepping, on the other hand, one would first have tolinearize the equations and then iteratively solve the linear system, whichinvolves several residual evaluations and at least a dozen applications ofthe linearized operator, as has been demonstrated in the <a class="el" href="step_33.html">step-33</a> tutorialprogram. Of course, the simplicity of explicit time stepping comes with a price, namelyconditional stability due to the so-called Courant&ndash;Friedrichs&ndash;Lewy (CFL)condition. It states that the time step cannot be larger than the fastestpropagation of information by the discretized differential operator. In moremodern terms, the speed of propagation corresponds to the largest eigenvaluein the discretized operator, and in turn depends on the mesh size, thepolynomial degree \(p\) and the physics of the Euler operator, i.e., theeigenvalues of the linearization of \(\mathbf F(\mathbf w)\) with respect to \(\mathbf{w}\) . In this program, we set the time step as follows: <p class="formulaDsp">
\[ \Delta t = \frac{\mathrm{Cr}}{p^{1.5}}\left(\frac{1} {\max\left[\frac{\|\mathbf{u}\|}{h_u} + \frac{c}{h_c}\right]}\right), \]
</p>
 with the maximum taken over all quadrature points and all cells. Thedimensionless number \(\mathrm{Cr}\) denotes the Courant number and can bechosen up to a maximally stable number \(\mathrm{Cr}_\text{max}\) , whose valuedepends on the selected time stepping method and its stability properties. Thepower \(p^{1.5}\) used for the polynomial scaling is heuristic and representsthe closest fit for polynomial degrees between 1 and 8, see e.g. <b>[SchoederKormann2018]</b> . In the limit of higher degrees, \(p&gt;10\) , a scaling of \(p^2\) is more accurate, related to the inverse estimates typically used forinterior penalty methods. Regarding the <em>effective</em> mesh sizes \(h_u\) and \(h_c\) used in the formula, we note that the convective transport isdirectional. Thus an appropriate scaling is to use the element length in thedirection of the velocity \(\mathbf u\) . The code below derives this scalingfrom the inverse of the Jacobian from the reference to real cell, i.e., weapproximate \(\frac{\|\mathbf{u}\|}{h_u} \approx \|J^{-1} \mathbf u\|_{\infty}\) . The acoustic waves, instead, are isotropic in character, whichis why we use the smallest feature size, represented by the smallest singularvalue of \(J\) , for the acoustic scaling \(h_c\) . Finally, we need to add theconvective and acoustic limits, as the Euler equations can transportinformation with speed \(\|\mathbf{u}\|+c\) . In this tutorial program, we use a specific variant of <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">explicit Runge&ndash;Kutta methods</a>, which in general use the following update procedurefrom the state \(\mathbf{w}_h^{n}\) at time \(t^n\) to the new time \(t^{n+1}\) with \(\Delta t = t^{n+1}-t^n\) : <p class="formulaDsp">
\[ \begin{aligned} \mathbf{k}_1 &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n, \mathbf{w}_h^n\right), \\ \mathbf{k}_2 &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n+c_2\Delta t, \mathbf{w}_h^n + a_{21} \Delta t \mathbf{k}_1\right), \\ &amp;\vdots \\ \mathbf{k}_s &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n+c_s\Delta t, \mathbf{w}_h^n + \sum_{j=1}^{s-1} a_{sj} \Delta t \mathbf{k}_j\right), \\ \mathbf{w}_h^{n+1} &amp;= \mathbf{w}_h^n + \Delta t\left(b_1 \mathbf{k}_1 + b_2 \mathbf{k}_2 + \ldots + b_s \mathbf{k}_s\right). \end{aligned} \]
</p>
@_fakenlThe vectors \(\mathbf{k}_i\) , \(i=1,\ldots,s\) , in an \(s\) -stage scheme areevaluations of the operator at some intermediate state and used to define theend-of-step value \(\mathbf{w}_h^{n+1}\) via some linear combination. The scalarcoefficients in this scheme, \(c_i\) , \(a_{ij}\) , and \(b_j\) , are defined such thatcertain conditions are satisfied for higher order schemes, the most basic onebeing \(c_i = \sum_{j=1}^{i-1}a_{ij}\) . The parameters are typically collected inthe form of a so-called <a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods#Explicit_Runge%E2%80%93Kutta_methods">Butcher tableau</a> that collects all of the coefficients that define thescheme. For a five-stage scheme, it would look like this: <p class="formulaDsp">
\[ \begin{array}{c|ccccc} 0 \\ c_2 &amp; a_{21} \\ c_3 &amp; a_{31} &amp; a_{32} \\ c_4 &amp; a_{41} &amp; a_{42} &amp; a_{43} \\ c_5 &amp; a_{51} &amp; a_{52} &amp; a_{53} &amp; a_{54} \\ \hline &amp; b_1 &amp; b_2 &amp; b_3 &amp; b_4 &amp; b_5 \end{array} \]
</p>
 In this tutorial program, we use a subset of explicit Runge&ndash;Kutta methods,so-called low-storage Runge&ndash;Kutta methods (LSRK), which assume additionalstructure in the coefficients. In the variant used by reference <b>[KennedyCarpenterLewis2000]</b> , the assumption is to use Butcher tableaus ofthe form <p class="formulaDsp">
\[ \begin{array}{c|ccccc} 0 \\ c_2 &amp; a_1 \\ c_3 &amp; b_1 &amp; a_2 \\ c_4 &amp; b_1 &amp; b_2 &amp; a_3 \\ c_5 &amp; b_1 &amp; b_2 &amp; b_3 &amp; a_4 \\ \hline &amp; b_1 &amp; b_2 &amp; b_3 &amp; b_4 &amp; b_5 \end{array} \]
</p>
@_fakenlWith such a definition, the update to \(\mathbf{w}_h^n\) shares the storage withthe information for the intermediate values \(\mathbf{k}_i\) . Starting with \(\mathbf{w}^{n+1}=\mathbf{w}^n\) and \(\mathbf{r}_1 = \mathbf{w}^n\) , the updatein each of the \(s\) stages simplifies to <p class="formulaDsp">
\[ \begin{aligned} \mathbf{k}_i &amp;= \mathcal M^{-1} \mathcal L_h\left(t^n+c_i\Delta t, \mathbf{r}_{i} \right),\\ \mathbf{r}_{i+1} &amp;= \mathbf{w}_h^{n+1} + \Delta t \, a_i \mathbf{k}_i,\\ \mathbf{w}_h^{n+1} &amp;= \mathbf{w}_h^{n+1} + \Delta t \, b_i \mathbf{k}_i. \end{aligned} \]
</p>
@_fakenlBesides the vector \(\mathbf w_h^{n+1}\) that is successively updated, this schemeonly needs two auxiliary vectors, namely the vector \(\mathbf{k}_i\) to hold theevaluation of the differential operator, and the vector \(\mathbf{r}_i\) thatholds the right-hand side for the differential operator application. Insubsequent stages \(i\) , the values \(\mathbf{k}_i\) and \(\mathbf{r}_i\) can usethe same storage. The main advantages of low-storage variants are the reduced memory consumptionon the one hand (if a very large number of unknowns must be fit in memory,holding all \(\mathbf{k}_i\) to compute subsequent updates can be a limitalready for \(s\) in between five and eight</li>
<li>recall that we are usingan explicit scheme, so we do not need to store any matrices that aretypically much larger than a few vectors), and the reduced memory access onthe other. In this program, we are particularly interested in the latteraspect. Since cost of operator evaluation is only a small multiple of the costof simply streaming the input and output vector from memory with the optimizedmatrix-free methods of deal.II, we must consider the cost of vector updates,and low-storage variants can deliver up to twice the throughput ofconventional explicit Runge&ndash;Kutta methods for this reason, see e.g. theanalysis in <b>[SchoederKormann2018]</b> . Besides three variants for third, fourth and fifth order accuracy from thereference <b>[KennedyCarpenterLewis2000]</b> , we also use a fourth-order accuratevariant with seven stages that was optimized for acoustics setups from <b>[TseliosSimos2007]</b> . Acoustic problems are one of the interesting aspects ofthe subsonic regime of the Euler equations where compressibility leads to thetransmission of sound waves; often, one uses further simplifications of thelinearized Euler equations around a background state or the acoustic waveequation around a fixed frame.</li>
</ul>
<p><a class="anchor" id="Fastevaluationofintegralsbymatrixfreetechniques"></a></p><h3>Fast evaluation of integrals by matrix-free techniques</h3>
<p>The major ingredients used in this program are the fast matrix-free techniqueswe use to evaluate the operator \(\mathcal L_h\) and the inverse mass matrix \(\mathcal M\) . Actually, the term <em>matrix-free</em> is a slight misnomer,because we are working with a nonlinear operator and do not linearize theoperator that in turn could be represented by a matrix. However, fastevaluation of integrals has become popular as a replacement of sparsematrix-vector products, as shown in <a class="el" href="step_37.html">step-37</a> and <a class="el" href="step_59.html">step-59</a> , and we have coinedthis infrastructure <em>matrix-free functionality</em> in deal.II for thisreason. Furthermore, the inverse mass matrix is indeed applied in amatrix-free way, as detailed below. The matrix-free infrastructure allows us to quickly evaluate the integrals inthe weak forms. The ingredients are the fast interpolation from solutioncoefficients into values and derivatives at quadrature points, point-wiseoperations at quadrature points (where we implement the differential operatoras derived above), as well as multiplication by all test functions andsummation over quadrature points. The first and third component make use ofsum factorization and have been extensively discussed in the <a class="el" href="step_37.html">step-37</a> tutorialprogram for the cell integrals and <a class="el" href="step_59.html">step-59</a> for the face integrals. The onlydifference is that we now deal with a system of \(d+2\) components, rather thanthe scalar systems in previous tutorial programs. In the code, all thatchanges is a template argument of the <a class="el" href="classFEEvaluation.html">FEEvaluation</a> and FEFaceEvaluationclasses, the one to set the number of components. The access to the vector isthe same as before, all handled transparently by the evaluator. We also notethat the variant with a single evaluator chosen in the code below is not theonly choice</p>
<ul>
<li>we could also have used separate evalators for the separatecomponents \(\rho\) , \(\rho \mathbf u\) , and \(E\) ; given that we treat allcomponents similarly (also reflected in the way we state the equation as avector system), this would be more complicated here. As before, theFEEvaluation class provides explicit vectorization by combining the operationson several cells (and faces), involving data types calledVectorizedArray. Since the arithmetic operations are overloaded for this type,we do not have to bother with it all that much, except for the evaluation offunctions through the <a class="el" href="classFunction.html">Function</a> interface, where we need to provide particular<em>vectorized</em> evaluations for several quadrature point locations at once. A more substantial change in this program is the operation at quadraturepoints: Here, the multi-component evaluators provide us with return types notdiscussed before. Whereas FEEvaluation::get_value() would return a scalar(more precisely, a VectorizedArray type due to vectorization across cells) forthe Laplacian of <a class="el" href="step_37.html">step-37</a> , it now returns a type that is<code><a class="el" href="classTensor.html">Tensor</a>&lt;1,dim+2,<a class="el" href="classVectorizedArray.html">VectorizedArray</a>&lt;Number&gt;&gt;</code>. Likewise, the gradient type is now<code><a class="el" href="classTensor.html">Tensor</a>&lt;1,dim+2,<a class="el" href="classTensor.html">Tensor</a>&lt;1,dim,<a class="el" href="classVectorizedArray.html">VectorizedArray</a>&lt;Number&gt;&gt;&gt;</code>, where the outertensor collects the <code>dim+2</code> components of the Euler system, and the innertensor the partial derivatives in the various directions. For example, theflux \(\mathbf{F}(\mathbf{w})\) of the Euler system is of this type. In order to reduce the amount ofcode we have to write for spelling out these types, we use the C++ <code>auto</code>keyword where possible. From an implementation point of view, the nonlinearity is not a bigdifficulty: It is introduced naturally as we express the terms of the Eulerweak form, for example in the form of the momentum term \(\rho \mathbf{u} \otimes \mathbf{u}\) . To obtain this expression, we first deduce the velocity \(\mathbf{u}\) from the momentum variable \(\rho \mathbf{u}\) . Given that \(\rho \mathbf{u}\) is represented as a \(p\) -degree polynomial, as is \(\rho\) , thevelocity \(\mathbf{u}\) is a rational expression in terms of the referencecoordinates \(\hat{\mathbf{x}}\) . As we perform the multiplication \((\rho \mathbf{u})\otimes \mathbf{u}\) , we obtain an expression that is theratio of two polynomials, with polynomial degree \(2p\) in thenumerator and polynomial degree \(p\) in the denominator. Combined with thegradient of the test function, the integrand is of degree \(3p\) in thenumerator and \(p\) in the denominator already for affine cells, i.e.,for parallelograms/ parallelepipeds.For curved cells, additional polynomial and rational expressionsappear when multiplying the integrand by the determinant of the Jacobian ofthe mapping. At this point, one usually needs to give up on insisting on exactintegration, and take whatever accuracy the Gaussian (more precisely,Gauss&ndash;Legrende) quadrature provides. The situation is then similar to the onefor the Laplace equation, where the integrand contains rational expressions onnon-affince cells and is also only integrated approximately. As these formulasonly integrate polynomials exactly, we have to live with the <a href="https://mathoverflow.net/questions/26018/what-are-variational-crimes-and-who-coined-the-term">variational crime</a> in the form of an integration error. While inaccurate integration is usually tolerable for elliptic problems, forhyperbolic problems inexact integration causes some headache in the form of aneffect called <b>aliasing</b>. The term comes from signal processing andexpresses the situation of inappropriate, too coarse sampling. In terms ofquadrature, the inappropriate sampling means that we use too few quadraturepoints compared to what would be required to accurately sample thevariable-coefficient integrand. It has been shown in the DG literature thataliasing errors can introduce unphysical oscillations in the numericalsolution for <em>barely</em> resolved simulations. The fact that aliasing mostlyaffects coarse resolutions</li>
<li>whereas finer meshes with the same schemework fine</li>
<li>is not surprising because well-resolved simulationstend to be smooth on length-scales of a cell (i.e., they havesmall coefficients in the higher polynomial degrees that are missed bytoo few quadrature points, whereas the main solution contribution in the lowerpolynomial degrees is still well-captured</li>
<li>this is simply a consequence of Taylor'stheorem). To address this topic, various approaches have been proposed in theDG literature. One technique is filtering which damps the solution componentspertaining to higher polynomial degrees. As the chosen nodal basis is nothierarchical, this would mean to transform from the nodal basis into ahierarchical one (e.g., a modal one based on Legendre polynomials) where thecontributions within a cell are split by polynomial degrees. In that basis,one could then multiply the solution coefficients associated with higherdegrees by a small number, keep the lower ones intact (to not destroy consistency), andthen transform back to the nodal basis. However, filters reduce the accuracy of themethod. Another, in some sense simpler, strategy is to use more quadraturepoints to capture non-linear terms more accurately. Using more than \(p+1\) quadrature points per coordinate directions is sometimes calledover-integration or consistent integration. The latter name is most common inthe context of the incompressible Navier-Stokes equations, where the \(\mathbf{u}\otimes \mathbf{u}\) nonlinearity results in polynomial integrandsof degree \(3p\) (when also considering the test function), which can beintegrated exactly with \(\textrm{floor}\left(\frac{3p}{2}\right)+1\) quadraturepoints per direction as long as the element geometry is affine. In the contextof the Euler equations with non-polynomial integrands, the choice is lessclear. Depending on the variation in the various variables both \(\textrm{floor}\left(\frac{3p}{2}\right)+1\) or \(2p+1\) points (integratingexactly polynomials of degree \(3p\) or \(4p\) , respectively) are common. To reflect this variability in the choice of quadrature in the program, wekeep the number of quadrature points a variable to be specified just as thepolynomial degree, and note that one would make different choices dependingalso on the flow configuration. The default choice is \(p+2\) points</li>
<li>a bitmore than the minimum possible of \(p+1\) points. The <a class="el" href="classFEEvaluation.html">FEEvaluation</a> andFEFaceEvaluation classes allow to seamlessly change the number of points by atemplate parameter, such that the program does not get more complicatedbecause of that.</li>
</ul>
<p><a class="anchor" id="Evaluationoftheinversemassmatrixwithmatrixfreetechniques"></a></p><h3>Evaluation of the inverse mass matrix with matrix-free techniques</h3>
<p>The last ingredient is the evaluation of the inverse mass matrix \(\mathcal M^{-1}\) . In DG methods with explicit time integration, mass matrices areblock-diagonal and thus easily inverted</p>
<ul>
<li>one only needs to invert thediagonal blocks. However, given the fact that matrix-free evaluation ofintegrals is closer in cost to the access of the vectors only, even theapplication of a block-diagonal matrix (e.g. via an array of LU factors) wouldbe several times more expensive than evaluation of \(\mathcal L_h\) simply because just storing and loading matrices of size<code>dofs_per_cell</code> times <code>dofs_per_cell</code> for higher order finite elementsrepeatedly is expensive. As this isclearly undesirable, part of the community has moved to bases where the massmatrix is diagonal, for example the <em>L<sub>2</sub></em>-orthogonal Legendre basis usinghierarchical polynomials or Lagrange polynomials on the points of the Gaussianquadrature (which is just another way of utilizing Legendreinformation). While the diagonal property breaks down for deformed elements,the error made by taking a diagonal mass matrix and ignoring the rest (avariant of mass lumping, though not the one with an additional integrationerror as utilized in <a class="el" href="step_48.html">step-48</a> ) has been shown to not alter discretizationaccuracy. The Lagrange basis in the points of Gaussian quadrature is sometimesalso referred to as a collocation setup, as the nodal points of thepolynomials coincide (= are "co-located") with the points of quadrature, obviating someinterpolation operations. Given the fact that we want to use more quadraturepoints for nonlinear terms in \(\mathcal L_h\) , however, the collocationproperty is lost. (More precisely, it is still used in <a class="el" href="classFEEvaluation.html">FEEvaluation</a> andFEFaceEvaluation after a change of basis, see the matrix-free paper <b>[KronbichlerKormann2019]</b> .) In this tutorial program, we use the collocation idea for the application ofthe inverse mass matrix, but with a slight twist. Rather than using thecollocation via Lagrange polynomials in the points of Gaussian quadrature, weprefer a conventional Lagrange basis in Gauss-Lobatto points as those make theevaluation of face integrals cheap. This is because for Gauss-Lobattopoints, some of the node points are located on the faces of the celland it is not difficult to show that on any given face, the only shapefunctions with non-zero values are exactly the ones whose node pointsare in fact located on that face. One could of course also use theGauss-Lobatto quadrature (with some additional integration error) as was donein <a class="el" href="step_48.html">step-48</a> , but we do not want to sacrifice accuracy as thesequadrature formulas are generally of lower order than the generalGauss quadrature formulas. Instead, we use an idea described in the reference <b>[KronbichlerSchoeder2016]</b> where it was proposed to change the basis for thesake of applying the inverse mass matrix. Let us denote by \(S\) the matrix ofshape functions evaluated at quadrature points, with shape functions in the rowof the matrix and quadrature points in columns. Then, the mass matrix on a cell \(K\) is given by <p class="formulaDsp">
\[ \mathcal M^K = S J^K S^\mathrm T. \]
</p>
@_fakenlHere, \(J^K\) is the diagonal matrix with the determinant of the Jacobian timesthe quadrature weight (JxW) as entries. The matrix \(S\) is constructed as theKronecker product (tensor product) of one-dimensional matrices, e.g. in 3D as <p class="formulaDsp">
\[ S = S_{\text{1D}}\otimes S_{\text{1D}}\otimes S_{\text{1D}}, \]
</p>
@_fakenlwhich is the result of the basis functions being a tensor product ofone-dimensional shape functions and the quadrature formula being the tensorproduct of 1D quadrature formulas. For the case that the number of polynomialsequals the number of quadrature points, all matrices in \(S J^K S^\mathrm T\) are square, and also the ingredients to \(S\) in the Kronecker product aresquare. Thus, one can invert each matrix to form the overall inverse, <p class="formulaDsp">
\[ \left(\mathcal M^K\right)^{-1} = S_{\text{1D}}^{-\mathrm T}\otimes S_{\text{1D}}^{-\mathrm T}\otimes S_{\text{1D}}^{-\mathrm T} \left(J^K\right)^{-1} S_{\text{1D}}^{-1}\otimes S_{\text{1D}}^{-1}\otimes S_{\text{1D}}^{-1}. \]
</p>
@_fakenlThis formula is of exactly the same structure as the steps in the forwardevaluation of integrals with sum factorization techniques (i.e., theFEEvaluation and <a class="el" href="classMatrixFree.html">MatrixFree</a> framework of deal.II). Hence, we can utilize thesame code paths with a different interpolation matrix, \(S_{\mathrm{1D}}^{-\mathrm{T}}\) rather than \(S_{\mathrm{1D}}\) . The class <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a> implements thisoperation: It changes from the basis contained in the finite element (in thiscase, <a class="el" href="classFE__DGQ.html">FE_DGQ</a>) to the Lagrange basis in Gaussian quadrature points. Here, theinverse of a diagonal mass matrix can be evaluated, which is simply the inverseof the <code>JxW</code> factors (i.e., the quadrature weight times the determinant of theJacobian from reference to real coordinates). Once this is done, we can changeback to the standard nodal Gauss-Lobatto basis. The advantage of this particular way of applying the inverse mass matrix isa cost similar to the forward application of a mass matrix, which is cheaperthan the evaluation of the spatial operator \(\mathcal L_h\) with over-integration and face integrals. (Wewill demonstrate this with detailed timing information in the<a href="#Results">results section</a>.) In fact, itis so cheap that it is limited by the bandwidth of reading the source vector,reading the diagonal, and writing into the destination vector on most modernarchitectures. The hardware used for the result section allows to do thecomputations at least twice as fast as the streaming of the vectors frommemory.</li>
</ul>
<p><a class="anchor" id="Thetestcase"></a></p><h3>The test case</h3>
<p>In this tutorial program, we implement two test cases. The first case is aconvergence test limited to two space dimensions. It runs a so-calledisentropic vortex which is transported via a background flow field. The secondcase uses a more exciting setup: We start with a cylinder immersed in achannel, using the <a class="el" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder()</a> function. Here, weimpose a subsonic initial field at Mach number of \(\mathrm{Ma}=0.307\) with aconstant velocity in \(x\) direction. At the top and bottom walls as well as atthe cylinder, we impose a no-penetration (i.e., tangential flow)condition. This setup forces the flow to re-orient as compared to the initialcondition, which results in a big sound wave propagating away from thecylinder. In upstream direction, the wave travels more slowly (as ithas to move against the oncoming gas), including adiscontinuity in density and pressure. In downstream direction, the transportis faster as sound propagation and fluid flow go in the same direction, which smearsout the discontinuity somewhat. Once the sound wave hits the upper and lowerwalls, the sound is reflected back, creating some nice shapes as illustratedin the <a href="#Results">results section</a> below.</p>
<p><a class="anchor" id="CommProg"></a> </p><h1>The commented program</h1>
<p>The include files are similar to the previous matrix-free tutorial programs <a class="el" href="step_37.html">step-37</a> , <a class="el" href="step_48.html">step-48</a> , and <a class="el" href="step_59.html">step-59</a> <br  />
</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
</div><!-- fragment --><p>The following file includes the CellwiseInverseMassMatrix data structure that we will use for the mass matrix inversion, the only new include file for this tutorial program:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
</div><!-- fragment --><p>Similarly to the other matrix-free tutorial programs, we collect all parameters that control the execution of the program at the top of the file. Besides the dimension and polynomial degree we want to run with, we also specify a number of points in the Gaussian quadrature formula we want to use for the nonlinear terms in the Euler equations. Furthermore, we specify the time interval for the time-dependent problem, and implement two different test cases. The first one is an analytical solution in 2D, whereas the second is a channel flow around a cylinder as described in the introduction. Depending on the test case, we also change the final time up to which we run the simulation, and a variable <code>output_tick</code> that specifies in which intervals we want to write output (assuming that the tick is larger than the time step size).</p>
<div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 0;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceStep37.html#a92034819b3a2b370b456b2e415e24f55">dimension</a>            = 2;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 3;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>            = 5;</div>
<div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 2;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
<div class="line"> </div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
</div><!-- fragment --><p>Next off are some details of the time integrator, namely a Courant number that scales the time step size in terms of the formula \(\Delta t = \text{Cr} n_\text{stages} \frac{h}{(p+1)^{1.5} (\|\mathbf{u} + c)_\text{max}}\) , as well as a selection of a few low-storage Runge&ndash;Kutta methods. We specify the Courant number per stage of the Runge&ndash;Kutta scheme, as this gives a more realistic expression of the numerical cost for schemes of various numbers of stages.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>, 1.5);</div>
<div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>,  <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>,  <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>,  <span class="comment">/* Tselios, Simos, 2007 */</span> </div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>,  <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span> </div>
<div class="line">};</div>
<div class="line">constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
</div><!-- fragment --><p>Eventually, we select a detail of the spatial discretization, namely the numerical flux (Riemann solver) at the faces between cells. For this program, we have implemented a modified variant of the Lax&ndash;Friedrichs flux and the Harten&ndash;Lax&ndash;van Leer (HLL) flux.</p>
<div class="fragment"><div class="line"><span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">{</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">};</div>
<div class="line">constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
</div><!-- fragment --><p><a class="anchor" id="Equationdata"></a> </p><h3>Equation data</h3>
<p>We now define a class with the exact solution for the test case 0 and one with a background flow field for test case 1 of the channel. Given that the Euler equations are a problem with \(d+2\) equations in \(d\) dimensions, we need to tell the <a class="el" href="classFunction.html">Function</a> base class about the correct number of components.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">};</div>
</div><!-- fragment --><p>As far as the actual function implemented is concerned, the analytical test case is an isentropic vortex case (see e.g. the book by Hesthaven and Warburton, Example 6.1 in Section 6.6 on page 209) which fulfills the Euler equations with zero force term on the right hand side. Given that definition, we return either the density, the momentum, or the energy depending on which component is requested. Note that the original definition of the density involves the \(\frac{1}{\gamma -1}\) -th power of some expression. Since <code><a class="el" href="base_2numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow()</a></code> has pretty slow implementations on some systems, we replace it by logarithm followed by exponentiation (of base 2), which is mathematically equivalent but usually much better optimized. This formula might lose accuracy in the last digits for very small numbers compared to <code><a class="el" href="base_2numbers_8h.html#af44aee1db5cdcd0bab54e3c011d2be66">std::pow()</a></code>, but we are happy with it anyway, since small numbers map to data close to 1. For the channel test case, we simply select a density of 1, a velocity of 0.4 in \(x\) direction and zero in the other directions, and an energy that corresponds to a speed of sound of 1.3 measured against the background velocity field, computed from the relation \(E = \frac{c^2}{\gamma (\gamma -1)} + \frac 12 \rho \|u\|^2\) .</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> 0:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">             x0[0] = 5.;</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">               (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div>
<div class="line">  </div>
<div class="line">- x0).norm_square()</div>
<div class="line">  </div>
<div class="line">- 2. (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0]</div>
<div class="line">  </div>
<div class="line">- x0[0]) t + t t;</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">               <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> 2) std::exp(1.</div>
<div class="line">  </div>
<div class="line">- radius_sqr);</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">               std::abs(1.</div>
<div class="line">  </div>
<div class="line">- (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> 0.25 <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.)));</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1.</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1]</div>
<div class="line">  </div>
<div class="line">- x0[1]);</div>
<div class="line">             <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0]</div>
<div class="line">  </div>
<div class="line">- t</div>
<div class="line">  </div>
<div class="line">- x0[0]);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">               <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">               <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> u;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">               <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">             <span class="keywordflow">else</span></div>
<div class="line">               {</div>
<div class="line">                 <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                   std::exp2(density_log (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.)));</div>
<div class="line">                 <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.) +</div>
<div class="line">                        0.5 (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> u u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">               }</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> 1:</div>
<div class="line">           {</div>
<div class="line">             <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">               <span class="keywordflow">return</span> 1.;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">               <span class="keywordflow">return</span> 0.4;</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">               <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">             <span class="keywordflow">else</span></div>
<div class="line">               <span class="keywordflow">return</span> 0.;</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">           <span class="keywordflow">return</span> 0.;</div>
<div class="line">       }</div>
<div class="line">   }</div>
</div><!-- fragment --><p><a class="anchor" id="LowstorageexplicitRungeKuttatimeintegrators"></a> </p><h3>Low-storage explicit Runge&ndash;Kutta time integrators</h3>
<p>The next few lines implement a few low-storage variants of Runge&ndash;Kutta methods. These methods have specific Butcher tableaux with coefficients \(b_i\) and \(a_i\) as shown in the introduction. As usual in Runge&ndash;Kutta method, we can deduce time steps, \(c_i = \sum_{j=1}^{i-2} b_i + a_{i-1}\) from those coefficients. The main advantage of this kind of scheme is the fact that only two vectors are needed per stage, namely the accumulated part of the solution \(\mathbf{w}\) (that will hold the solution \(\mathbf{w}^{n+1}\) at the new time \(t^{n+1}\) after the last stage), the update vector \(\mathbf{r}_i\) that gets evaluated during the stages, plus one vector \(\mathbf{k}_i\) to hold the evaluation of the operator. Such a Runge&ndash;Kutta setup reduces the memory storage and memory access. As the memory bandwidth is often the performance-limiting factor on modern hardware when the evaluation of the differential operator is well-optimized, performance can be improved over standard time integrators. This is true also when taking into account that a conventional Runge&ndash;Kutta scheme might allow for slightly larger time steps as more free parameters allow for better stability properties. <br  />
 In this tutorial programs, we concentrate on a few variants of low-storage schemes defined in the article by Kennedy, Carpenter, and Lewis (2000), as well as one variant described by Tselios and Simos (2007). There is a large series of other schemes available, which could be addressed by additional sets of coefficients or slightly different update formulas. <br  />
 We define a single class for the four integrators, distinguished by the enum described above. To each scheme, we then fill the vectors for the \(b_i\) and \(a_i\) to the given variables in the class.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
</div><!-- fragment --><p>First comes the three-stage scheme of order three by Kennedy et al. (2000). While its stability region is significantly smaller than for the other schemes, it only involves three stages, so it is very competitive in terms of the work per stage.</p>
<div class="fragment"><div class="line"><span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">      {</div>
<div class="line">        lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      }</div>
</div><!-- fragment --><p>The next scheme is a five-stage scheme of order four, again defined in the paper by Kennedy et al. (2000).</p>
<div class="fragment"><div class="line"><span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">  {</div>
<div class="line">    lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p>The following scheme of seven stages and order four has been explicitly derived for acoustics problems. It is a balance of accuracy for imaginary eigenvalues among fourth order schemes, combined with a large stability region. Since DG schemes are dissipative among the highest frequencies, this does not necessarily translate to the highest possible time step per stage. In the context of the present tutorial program, the numerical flux plays a crucial role in the dissipation and thus also the maximal stable time step size. For the modified Lax&ndash;Friedrichs flux, this scheme is similar to the <code>stage_5_order_4</code> scheme in terms of step size per stage if only stability is considered, but somewhat less efficient for the HLL flux.</p>
<div class="fragment"><div class="line"><span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">  {</div>
<div class="line">    lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p>The last scheme included here is the nine-stage scheme of order five from Kennedy et al. (2000). It is the most accurate among the schemes used here, but the higher order of accuracy sacrifices some stability, so the step length normalized per stage is less than for the fourth order schemes.</p>
<div class="fragment"><div class="line">      <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">        {</div>
<div class="line">          lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">    }</div>
<div class="line">  <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">    rk_integrator(lsrk);</div>
<div class="line">  rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">return</span> bi.size();</div>
<div class="line">}</div>
</div><!-- fragment --><p>The main function of the time integrator is to go through the stages, evaluate the operator, prepare the \(\mathbf{r}_i\) vector for the next evaluation, and update the solution vector \(\mathbf{w}\) . We hand off the work to the <code>pde_operator</code> involved in order to be able to merge the vector operations of the Runge&ndash;Kutta setup with the evaluation of the differential operator for better performance, so all we do here is to delegate the vectors and coefficients. <br  />
 We separately call the operator for the first stage because we need slightly modified arguments there: We evaluate the solution from the old solution \(\mathbf{w}^n\) rather than a \(\mathbf r_i\) vector, so the first argument is <code>solution</code>. We here let the stage vector \(\mathbf{r}_i\) also hold the temporary result of the evaluation, as it is not used otherwise. For all subsequent stages, we use the vector <code>vec_ki</code> as the second vector argument to store the result of the operator evaluation. Finally, when we are at the last stage, we must skip the computation of the vector \(\mathbf{r}_{s+1}\) as there is no coefficient \(a_s\) available (nor will it be used).</p>
<div class="fragment"><div class="line">     <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">     <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                            <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                            <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                            VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                            VectorType &amp;    vec_ri,</div>
<div class="line">                            VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">     </span>{</div>
<div class="line">       <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line">  </div>
<div class="line">       pde_operator.perform_stage(current_time,</div>
<div class="line">                                  bi[0] time_step,</div>
<div class="line">                                  ai[0] time_step,</div>
<div class="line">                                  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                  vec_ri,</div>
<div class="line">                                  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                  vec_ri);</div>
<div class="line">  </div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 1; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">         {</div>
<div class="line">           <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = ci[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>];</div>
<div class="line">           pde_operator.perform_stage(current_time + c_i time_step,</div>
<div class="line">                                      bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] time_step,</div>
<div class="line">                                      (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size()</div>
<div class="line">  </div>
<div class="line">- 1 ?</div>
<div class="line">                                         0 :</div>
<div class="line">                                         ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] time_step),</div>
<div class="line">                                      vec_ri,</div>
<div class="line">                                      vec_ki,</div>
<div class="line">                                      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                      vec_ri);</div>
<div class="line">         }</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">   <span class="keyword">private</span>:</div>
<div class="line">     std::vector&lt;double&gt; bi;</div>
<div class="line">     std::vector&lt;double&gt; ai;</div>
<div class="line">     std::vector&lt;double&gt; ci;</div>
<div class="line">   };</div>
</div><!-- fragment --><p><a class="anchor" id="ImplementationofpointwiseoperationsoftheEulerequations"></a> </p><h3>Implementation of point-wise operations of the Euler equations</h3>
<p>In the following functions, we implement the various problem-specific operators pertaining to the Euler equations. Each function acts on the vector of conserved variables \([\rho, \rho\mathbf{u}, E]\) that we hold in the solution vectors, and computes various derived quantities. <br  />
 First out is the computation of the velocity, that we derive from the momentum variable \(\rho \mathbf{u}\) by division by \(\rho\) . One thing to note here is that we decorate all those functions with the keyword <code>DEAL_II_ALWAYS_INLINE</code>. This is a special macro that maps to a compiler-specific keyword that tells the compiler to never create a function call for any of those functions, and instead move the implementation <a href="https://en.wikipedia.org/wiki/Inline_function">inline</a> to where they are called. This is critical for performance because we call into some of those functions millions or billions of times: For example, we both use the velocity for the computation of the flux further down, but also for the computation of the pressure, and both of these places are evaluated at every quadrature point of every cell. Making sure these functions are inlined ensures not only that the processor does not have to execute a jump instruction into the function (and the corresponding return jump), but also that the compiler can re-use intermediate information from one function's context in code that comes after the place where the function was called. (We note that compilers are generally quite good at figuring out which functions to inline by themselves. Here is a place where compilers may or may not have figured it out by themselves but where we know for sure that inlining is a win.) <br  />
 Another trick we apply is a separate variable for the inverse density \(\frac{1}{\rho}\) . This enables the compiler to only perform a single division for the flux, despite the division being used at several places. As divisions are around ten to twenty times as expensive as multiplications or additions, avoiding redundant divisions is crucial for performance. We note that taking the inverse first and later multiplying with it is not equivalent to a division in floating point arithmetic due to roundoff effects, so the compiler is not allowed to exchange one way by the other with standard optimization flags. However, it is also not particularly difficult to write the code in the right way. <br  />
 To summarize, the chosen strategy of always inlining and careful definition of expensive arithmetic operations allows us to write compact code without passing all intermediate results around, despite making sure that the code maps to excellent machine code.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] inverse_density;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function computes the pressure from the vector of conserved variables, using the formula \(p = (\gamma - 1) \left(E - \frac 12 \rho \mathbf{u}\cdot \mathbf{u}\right)\) . As explained above, we use the velocity from the <code><a class="el" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity()</a></code> function. Note that we need to specify the first template argument <code>dim</code> here because the compiler is not able to deduce it from the arguments of the tensor, whereas the second argument (number type) can be automatically deduced.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">       euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">  </div>
<div class="line">- 1.) (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]</div>
<div class="line">  </div>
<div class="line">- 0.5 rho_u_dot_u);</div>
<div class="line">   }</div>
</div><!-- fragment --><p>Here is the definition of the Euler flux function, i.e., the definition of the actual equation. Given the velocity and pressure (that the compiler optimization will make sure are done only once), this is straight-forward given the equation stated in the introduction.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">    euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">        <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This next function is a helper to simplify the implementation of the numerical flux, implementing the action of a tensor of tensors (with non-standard outer dimension of size <code>dim + 2</code>, so the standard overloads provided by deal.II's tensor classes do not apply here) with another tensor of the same inner dimension, i.e., a matrix-vector product.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">  <a class="code" href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>This function implements the numerical flux (Riemann solver). It gets the state from the two sides of an interface and the normal vector, oriented from the side of the solution \(\mathbf{w}^-\) towards the solution \(\mathbf{w}^+\) . In finite volume methods which rely on piece-wise constant data, the numerical flux is the central ingredient as it is the only place where the physical information is entered. In DG methods, the numerical flux is less central due to the polynomials within the elements and the physical flux used there. As a result of higher-degree interpolation with consistent values from both sides in the limit of a continuous solution, the numerical flux can be seen as a control of the jump of the solution from both sides to weakly impose continuity. It is important to realize that a numerical flux alone cannot stabilize a high-order DG method in the presence of shocks, and thus any DG method must be combined with further shock-capturing techniques to handle those cases. In this tutorial, we focus on wave-like solutions of the Euler equations in the subsonic regime without strong discontinuities where our basic scheme is sufficient. <br  />
 Nonetheless, the numerical flux is decisive in terms of the numerical dissipation of the overall scheme and influences the admissible time step size with explicit Runge&ndash;Kutta methods. We consider two choices, a modified Lax&ndash;Friedrichs scheme and the widely used Harten&ndash;Lax&ndash;van Leer (HLL) flux. For both variants, we first need to get the velocities and pressures from both sides of the interface and evaluate the physical Euler flux. <br  />
 For the local Lax&ndash;Friedrichs flux, the definition is \(\hat{\mathbf{F}} =\frac{\mathbf{F}(\mathbf{w}^-)+\mathbf{F}(\mathbf{w}^+)}{2} + \frac{\lambda}{2}\left[\mathbf{w}^--\mathbf{w}^+\right]\otimes \mathbf{n^-}\) , where the factor \(\lambda = \max\left(\|\mathbf{u}^-\|+c^-, \|\mathbf{u}^+\|+c^+\right)\) gives the maximal wave speed and \(c = \sqrt{\gamma p / \rho}\) is the speed of sound. Here, we choose two modifications of that expression for reasons of computational efficiency, given the small impact of the flux on the solution. For the above definition of the factor \(\lambda\) , we would need to take four square roots, two for the two velocity norms and two for the speed of sound on either side. The first modification is hence to rather use \(\sqrt{\|\mathbf{u}\|^2+c^2}\) as an estimate of the maximal speed (which is at most a factor of 2 away from the actual maximum, as shown in the introduction). This allows us to pull the square root out of the maximum and get away with a single square root computation. The second modification is to further relax on the parameter \(\lambda\) &mdash;the smaller it is, the smaller the dissipation factor (which is multiplied by the jump in \(\mathbf{w}\) , which might result in a smaller or bigger dissipation in the end). This allows us to fit the spectrum into the stability region of the explicit Runge&ndash;Kutta integrator with bigger time steps. However, we cannot make dissipation too small because otherwise imaginary eigenvalues grow larger. Finally, the current conservative formulation is not energy-stable in the limit of \(\lambda\to 0\) as it is not skew-symmetric, and would need additional measures such as split-form DG schemes in that case. For the HLL flux, we follow the formula from literature, introducing an additional weighting of the two states from Lax&ndash;Friedrichs by a parameter \(s\) . It is derived from the physical transport directions of the Euler equations in terms of the current direction of velocity and sound speed. For the velocity, we here choose a simple arithmetic average which is sufficient for DG scenarios and moderate jumps in material parameters. <br  />
 Since the numerical flux is multiplied by the normal vector in the weak form, we multiply by the result by the normal vector for all terms in the equation. In these multiplications, the <code>operator*</code> defined above enables a compact notation similar to the mathematical definition. <br  />
 In this and the following functions, we use variable suffixes <code>_m</code> and <code>_p</code> to indicate quantities derived from \(\mathbf{w}^-\) and \(\mathbf{w}^+\) , i.e., values "here" and "there" relative to the current cell when looking at a neighbor cell.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">   <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">     <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">     <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                          <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">   {</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line">  </div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">     <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">               0.5 <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                          <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> pressure_p (1. / u_p[0]),</div>
<div class="line">                                        velocity_m.norm_square() +</div>
<div class="line">                                          <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> pressure_m (1. / u_m[0])));</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">return</span> 0.5 (flux_m <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                    0.5 <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> (u_m</div>
<div class="line">  </div>
<div class="line">- u_p);</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">               0.5 ((velocity_m + velocity_p) <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">               0.5 <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a></div>
<div class="line">               (pressure_p (1. / u_p[0]) + pressure_m (1. / u_m[0]))));</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">               <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal</div>
<div class="line">  </div>
<div class="line">- avg_c);</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos</div>
<div class="line">  </div>
<div class="line">- s_neg);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">return</span> inverse_s</div>
<div class="line">                    ((s_pos (flux_m <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">  </div>
<div class="line">- s_neg (flux_p <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>))</div>
<div class="line">  </div>
<div class="line">-</div>
<div class="line">                     s_pos s_neg (u_m</div>
<div class="line">  </div>
<div class="line">- u_p));</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">             <span class="keywordflow">return</span> {};</div>
<div class="line">           }</div>
<div class="line">       }</div>
<div class="line">   }</div>
</div><!-- fragment --><p>This and the next function are helper functions to provide compact evaluation calls as multiple points get batched together via a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> argument (see the <a class="el" href="step_37.html">step-37</a> tutorial for details). This function is used for the subsonic outflow boundary conditions where we need to set the energy component to a prescribed value. The next one requests the solution on all components and is used for inflow boundaries where all components of the solution are set.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line"><a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized,</div>
<div class="line">                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line"><a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt;</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="TheEulerOperationclass"></a> </p><h3>The EulerOperation class</h3>
<p>This class implements the evaluators for the Euler problem, in analogy to the <code>LaplaceOperator</code> class of <a class="el" href="step_37.html">step-37</a> or <a class="el" href="step_59.html">step-59</a> . Since the present operator is non-linear and does not require a matrix interface (to be handed over to preconditioners), we skip the various <code>vmult</code> functions otherwise present in matrix-free operators and only implement an <code>apply</code> function as well as the combination of <code>apply</code> with the required vector updates for the low-storage Runge&ndash;Kutta time integrator mentioned above (called <code>perform_stage</code>). Furthermore, we have added three additional functions involving matrix-free routines, namely one to compute an estimate of the time step scaling (that is combined with the Courant number for the actual time step size) based on the velocity and speed of sound in the elements, one for the projection of solutions (specializing <a class="el" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project()</a> for the DG case), and one to compute the errors against a possible analytical solution or norms against some background state. <br  />
 The rest of the class is similar to other matrix-free tutorials. As discussed in the introduction, we provide a few functions to allow a user to pass in various forms of boundary conditions on different parts of the domain boundary marked by <a class="el" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> variables, as well as possible body forces.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keyword">class </span>EulerOperator</div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">  EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                           std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">             <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">             <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  perform_stage(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> cur_time,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_solution,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_ai,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;next_ri) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">               <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span></div>
<div class="line">  initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">    inflow_boundaries;</div>
<div class="line">  std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                 subsonic_outflow_boundaries;</div>
<div class="line">  std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">  std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_inverse_mass_matrix(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_cell(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">void</span> local_apply_boundary_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">  : timer(timer)</div>
<div class="line">{}</div>
</div><!-- fragment --><p>For the initialization of the Euler operator, we set up the <a class="el" href="classMatrixFree.html">MatrixFree</a> variable contained in the class. This can be done given a mapping to describe possible curved boundaries as well as a <a class="el" href="classDoFHandler.html">DoFHandler</a> object describing the degrees of freedom. Since we use a discontinuous Galerkin discretization in this tutorial program where no constraints are imposed strongly on the solution field, we do not need to pass in an <a class="el" href="classAffineConstraints.html">AffineConstraints</a> object and rather use a dummy for the construction. With respect to quadrature, we want to select two different ways of computing the underlying integrals: The first is a flexible one, based on a template parameter <code>n_points_1d</code> (that will be assigned the <code>n_q_points_1d</code> value specified at the top of this file). More accurate integration is necessary to avoid the aliasing problem due to the variable coefficients in the Euler operator. The second less accurate quadrature formula is a tight one based on <code>fe_degree+1</code> and needed for the inverse mass matrix. While that formula provides an exact inverse only on affine element shapes and not on deformed elements, it enables the fast inversion of the mass matrix by tensor product techniques, necessary to ensure optimal computational efficiency overall.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt;&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt;&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">  <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                  <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line">  additional_data.mapping_update_flags =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.mapping_update_flags_inner_faces =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.mapping_update_flags_boundary_faces =</div>
<div class="line">    (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">     <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">  additional_data.tasks_parallel_scheme =</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData::none</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">    <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>The subsequent four member functions are the ones that must be called from outside to specify the various types of boundaries. For an inflow boundary, we must specify all components in terms of density \(\rho\) , momentum \(\rho \mathbf{u}\) and energy \(E\) . Given this information, we then store the function alongside the respective boundary id in a map member variable of this class. Likewise, we proceed for the subsonic outflow boundaries (where we request a function as well, which we use to retrieve the energy) and for wall (no-penetration) boundaries where we impose zero normal velocity (no function necessary, so we only request the boundary id). For the present DG code where boundary conditions are solely applied as part of the weak form (during time integration), the call to set the boundary conditions can appear both before or after the <code><a class="el" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit()</a></code> call to this class. This is different from continuous finite element codes where the boundary conditions determine the content of the <a class="el" href="classAffineConstraints.html">AffineConstraints</a> object that is sent into <a class="el" href="classMatrixFree.html">MatrixFree</a> for initialization, thus requiring to be set before the initialization of the matrix-free data structures. The checks added in each of the four function are used to ensure that boundary conditions are mutually exclusive on the various parts of the boundary, i.e., that a user does not accidentally designate a boundary as both an inflow and say a subsonic outflow boundary.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">  std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                         <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                         <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                         <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">  std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                         <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                         <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                         <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                  subsonic_outflow_boundaries.end(),</div>
<div class="line">              <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                         <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                         <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                         <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">  wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">  std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">{</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">  this-&gt;body_force = std::move(body_force);</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Localevaluators"></a> </p><h4>Local evaluators</h4>
<p>Now we proceed to the local evaluators for the Euler problem. The evaluators are relatively simple and follow what has been presented in <a class="el" href="step_37.html">step-37</a> , <a class="el" href="step_48.html">step-48</a> , or <a class="el" href="step_59.html">step-59</a> . The first notable difference is the fact that we use an <a class="el" href="classFEEvaluation.html">FEEvaluation</a> with a non-standard number of quadrature points. Whereas we previously always set the number of quadrature points to equal the polynomial degree plus one (ensuring exact integration on affine element shapes), we now set the number quadrature points as a separate variable (e.g. the polynomial degree plus two or three halves of the polynomial degree) to more accurately handle nonlinear terms. Since the evaluator is fed with the appropriate loop lengths via the template argument and keeps the number of quadrature points in the whole cell in the variable <a class="el" href="classFEEvaluation.html#a1b8934d6ae273d7b3f91994eddcad239">FEEvaluation::n_q_points</a>, we now automatically operate on the more accurate formula without further changes. <br  />
 The second difference is due to the fact that we are now evaluating a multi-component system, as opposed to the scalar systems considered previously. The matrix-free framework provides several ways to handle the multi-component case. The variant shown here utilizes an <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object with multiple components embedded into it, specified by the fourth template argument <code>dim + 2</code> for the components in the Euler system. As a consequence, the return type of FEEvaluation::get_value() is not a scalar any more (that would return a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> type, collecting data from several elements), but a <a class="el" href="classTensor.html">Tensor</a> of <code>dim+2</code> components. The functionality is otherwise similar to the scalar case; it is handled by a template specialization of a base class, called <a class="el" href="classFEEvaluationAccess.html">FEEvaluationAccess</a>. An alternative variant would have been to use several <a class="el" href="classFEEvaluation.html">FEEvaluation</a> objects, a scalar one for the density, a vector-valued one with <code>dim</code> components for the momentum, and another scalar evaluator for the energy. To ensure that those components point to the correct part of the solution, the constructor of <a class="el" href="classFEEvaluation.html">FEEvaluation</a> takes three optional integer arguments after the required <a class="el" href="classMatrixFree.html">MatrixFree</a> field, namely the number of the <a class="el" href="classDoFHandler.html">DoFHandler</a> for multi-DoFHandler systems (taking the first by default), the number of the quadrature point in case there are multiple <a class="el" href="classQuadrature.html">Quadrature</a> objects (see more below), and as a third argument the component within a vector system. As we have a single vector for all components, we would go with the third argument, and set it to <code>0</code> for the density, <code>1</code> for the vector-valued momentum, and <code>dim+1</code> for the energy slot. <a class="el" href="classFEEvaluation.html">FEEvaluation</a> then picks the appropriate subrange of the solution vector during <a class="el" href="classFEEvaluationBase.html#a5c3bf28ebceb0271addfba5b92f475ce">FEEvaluationBase::read_dof_values()</a> and FEEvaluation::distributed_local_to_global() or the more compact <a class="el" href="classFEEvaluation.html#ab53d5c08f460cfe6c9830ac14a427115">FEEvaluation::gather_evaluate()</a> and <a class="el" href="classFEEvaluation.html#a491779be7bd032d277e41f1dda8dc584">FEEvaluation::integrate_scatter()</a> calls. <br  />
 When it comes to the evaluation of the body force vector, we distinguish between two cases for efficiency reasons: In case we have a constant function (derived from <a class="el" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction</a>), we can precompute the value outside the loop over quadrature points and simply use the value everywhere. For a more general function, we instead need to call the <code><a class="el" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function()</a></code> method we provided above; this path is more expensive because we need to access the memory associated with the quadrature point data. <br  />
 The rest follows the other tutorial programs. Since we have implemented all physics for the Euler equations in the separate <code><a class="el" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux()</a></code> function, all we have to do here is to call this function given the current solution evaluated at quadrature points, returned by <code>phi.get_value(q)</code>, and tell the <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object to queue the flux for testing it by the gradients of the shape functions (which is a <a class="el" href="classTensor.html">Tensor</a> of outer <code>dim+2</code> components, each holding a tensor of <code>dim</code> components for the \(x,y,z\) component of the Euler flux). One final thing worth mentioning is the order in which we queue the data for testing by the value of the test function, <code>phi.submit_value()</code>, in case we are given an external function: We must do this after calling <code>phi.get_value(q)</code>, because <code>get_value()</code> (reading the solution) and <code>submit_value()</code> (queuing the value for multiplication by the test function and summation over quadrature points) access the same underlying data field. Here it would be easy to achieve also without temporary variable <code>w_q</code> since there is no mixing between values and gradients. For more complicated setups, one has to first copy out e.g. both the value and gradient at a quadrature point and then queue results again by <a class="el" href="classFEEvaluationBase.html#a2c0efc6f70b305c0585001632063c98b">FEEvaluationBase::submit_value()</a> and <a class="el" href="classFEEvaluationBase.html#a2a78655d119bd1bde992619c52b2d2f8">FEEvaluationBase::submit_gradient()</a>. <br  />
 As a final note, we mention that we do not use the first <a class="el" href="classMatrixFree.html">MatrixFree</a> argument of this function, which is a call-back from <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a>. The interfaces imposes the present list of arguments, but since we are in a member function where the <a class="el" href="classMatrixFree.html">MatrixFree</a> object is already available as the <code>data</code> variable, we stick with that to avoid confusion.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_cell(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; constant_body_force;</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>constant_function =</div>
<div class="line">    <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a><span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">    constant_body_force = evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">     constant_function, <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt;());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">          phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">          <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">            {</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; force =</div>
<div class="line">                constant_function ? constant_body_force :</div>
<div class="line">                                    evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">                                     body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">              <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; forcing;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">              phi.submit_value(forcing, q);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      phi.integrate_scatter(((body_force.get() != <span class="keyword">nullptr</span>) ?</div>
<div class="line">                               <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a> :</div>
<div class="line">                               <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea84d99583fd787b7e846f9e4b6f7c97c0">EvaluationFlags::nothing</a>) |</div>
<div class="line">                              <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeadde91684ebb2c6ec5c5c5293123f6a04">EvaluationFlags::gradients</a>,</div>
<div class="line">                            <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function concerns the computation of integrals on interior faces, where we need evaluators from both cells adjacent to the face. We associate the variable <code>phi_m</code> with the solution component \(\mathbf{w}^-\) and the variable <code>phi_p</code> with the solution component \(\mathbf{w}^+\) . We distinguish the two sides in the constructor of <a class="el" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> by the second argument, with <code>true</code> for the interior side and <code>false</code> for the exterior side, with interior and exterior denoting the orientation with respect to the normal vector. <br  />
 Note that the calls <a class="el" href="classFEFaceEvaluation.html#a4ac53fde2eab227ef45c7d29a5ed33fe">FEFaceEvaluation::gather_evaluate()</a> and <a class="el" href="classFEFaceEvaluation.html#ad8963360c30a43aca90a764443fc954f">FEFaceEvaluation::integrate_scatter()</a> combine the access to the vectors and the sum factorization parts. This combined operation not only saves a line of code, but also contains an important optimization: Given that we use a nodal basis in terms of the Lagrange polynomials in the points of the Gauss-Lobatto quadrature formula, only \((p+1)^{d-1}\) out of the \((p+1)^d\) basis functions evaluate to non-zero on each face. Thus, the evaluator only accesses the necessary data in the vector and skips the parts which are multiplied by zero. If we had first read the vector, we would have needed to load all data from the vector, as the call in isolation would not know what data is required in subsequent operations. If the subsequent <a class="el" href="classFEFaceEvaluation.html#a92f84b8ad276ca9866f30c6f789cf3a4">FEFaceEvaluation::evaluate()</a> call requests values and derivatives, indeed all \((p+1)^d\) vector entries for each component are needed, as the normal derivative is nonzero for all basis functions. <br  />
 The arguments to the evaluators as well as the procedure is similar to the cell evaluation. We again use the more accurate (over-)integration scheme due to the nonlinear terms, specified as the third template argument in the list. At the quadrature points, we then go to our free-standing function for the numerical flux. It receives the solution evaluated at quadrature points from both sides (i.e., \(\mathbf{w}^-\) and \(\mathbf{w}^+\) ), as well as the normal vector onto the minus side. As explained above, the numerical flux is already multiplied by the normal vector from the minus side. We need to switch the sign because the boundary term comes with a minus sign in the weak form derived in the introduction. The flux is then queued for testing both on the minus sign and on the plus sign, with switched sign as the normal vector from the plus side is exactly opposed to the one from the minus side.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_face(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                    <span class="keyword">true</span>);</div>
<div class="line">  <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                    <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">    {</div>
<div class="line">      phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">      phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">      phi_m.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">            euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                      phi_p.get_value(q),</div>
<div class="line">                                      phi_m.get_normal_vector(q));</div>
<div class="line">          phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">          phi_p.submit_value(numerical_flux, q);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      phi_p.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      phi_m.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>For faces located at the boundary, we need to impose the appropriate boundary conditions. In this tutorial program, we implement four cases as mentioned above. (A fifth case, for supersonic outflow conditions is discussed in the "Results" section below.) The discontinuous Galerkin method imposes boundary conditions not as constraints, but only weakly. Thus, the various conditions are imposed by finding an appropriate <em>exterior</em> quantity \(\mathbf{w}^+\) that is then handed to the numerical flux function also used for the interior faces. In essence, we "pretend" a state on the outside of the domain in such a way that if that were reality, the solution of the PDE would satisfy the boundary conditions we want. <br  />
 For wall boundaries, we need to impose a no-normal-flux condition on the momentum variable, whereas we use a Neumann condition for the density and energy with \(\rho^+ = \rho^-\) and \(E^+ = E^-\) . To achieve the no-normal flux condition, we set the exterior values to the interior values and subtract two times the velocity in wall-normal direction, i.e., in the direction of the normal vector. <br  />
 For inflow boundaries, we simply set the given Dirichlet data \(\mathbf{w}_\mathrm{D}\) as a boundary value. An alternative would have been to use \(\mathbf{w}^+ = -\mathbf{w}^- + 2 \mathbf{w}_\mathrm{D}\) , the so-called mirror principle. The imposition of outflow is essentially a Neumann condition, i.e., setting \(\mathbf{w}^+ = \mathbf{w}^-\) . For the case of subsonic outflow, we still need to impose a value for the energy, which we derive from the respective function. A special step is needed for the case of <em>backflow</em>, i.e., the case where there is a momentum flux into the domain on the Neumann portion. According to the literature (a fact that can be derived by appropriate energy arguments), we must switch to another variant of the flux on inflow parts, see Gravemeier, Comerford, Yoshihara, Ismail, Wall, "A novel formulation for Neumann inflow conditions in biomechanics", Int. J. Numer. Meth. Biomed. Eng., vol. 28 (2012). Here, the momentum term needs to be added once again, which corresponds to removing the flux contribution on the momentum variables. We do this in a post-processing step, and only for the case when we both are at an outflow boundary and the dot product between the normal vector and the momentum (or, equivalently, velocity) is negative. As we work on data of several quadrature points at once for SIMD vectorizations, we here need to explicitly loop over the array entries of the SIMD array. <br  />
 In the implementation below, we check for the various types of boundaries at the level of quadrature points. Of course, we could also have moved the decision out of the quadrature point loop and treat entire faces as of the same kind, which avoids some map/set lookups in the inner loop over quadrature points. However, the loss of efficiency is hardly noticeable, so we opt for the simpler code here. Also note that the final <code>else</code> clause will catch the case when some part of the boundary was not assigned any boundary condition via <code>EulerOperator::set_..._boundary(...)</code>. <br  />
</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_boundary_face(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">       {</div>
<div class="line">         phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">         phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi.get_value(q);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi.get_normal_vector(q);</div>
<div class="line">  </div>
<div class="line">             <span class="keyword">auto</span> rho_u_dot_n = w_m[1] <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">  </div>
<div class="line">             <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; w_p;</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">             <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) != wall_boundaries.end())</div>
<div class="line">               {</div>
<div class="line">                 w_p[0] = w_m[0];</div>
<div class="line">                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                   w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]</div>
<div class="line">  </div>
<div class="line">- 2. rho_u_dot_n <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                 w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">               }</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                      inflow_boundaries.end())</div>
<div class="line">               w_p =</div>
<div class="line">                 <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                                   phi.quadrature_point(q));</div>
<div class="line">             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                      subsonic_outflow_boundaries.end())</div>
<div class="line">               {</div>
<div class="line">                 w_p          = w_m;</div>
<div class="line">                 w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                  subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                   phi.quadrature_point(q),</div>
<div class="line">                   <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">                 at_outflow = <span class="keyword">true</span>;</div>
<div class="line">               }</div>
<div class="line">             <span class="keywordflow">else</span></div>
<div class="line">               <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                      <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                      <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line">  </div>
<div class="line">             <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">                 {</div>
<div class="line">                   <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt;</div>
<div class="line">  </div>
<div class="line">-1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                       <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">                 }</div>
<div class="line">  </div>
<div class="line">             phi.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">       }</div>
<div class="line">   }</div>
</div><!-- fragment --><p>The next function implements the inverse mass matrix operation. The algorithms and rationale have been discussed extensively in the introduction, so we here limit ourselves to the technicalities of the <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a> class. It does similar operations as the forward evaluation of the mass matrix, except with a different interpolation matrix, representing the inverse \(S^{-1}\) factors. These represent a change of basis from the specified basis (in this case, the Lagrange basis in the points of the Gauss&ndash;Lobatto quadrature formula) to the Lagrange basis in the points of the Gauss quadrature formula. In the latter basis, we can apply the inverse of the point-wise <code>JxW</code> factor, i.e., the quadrature weight times the determinant of the Jacobian of the mapping from reference to real coordinates. Once this is done, the basis is changed back to the nodal Gauss-Lobatto basis again. All of these operations are done by the <code><a class="el" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply()</a></code> function below. What we need to provide is the local fields to operate on (which we extract from the global vector by an <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object) and write the results back to the destination vector of the mass matrix operation. <br  />
 One thing to note is that we added two integer arguments (that are optional) to the constructor of <a class="el" href="classFEEvaluation.html">FEEvaluation</a>, the first being 0 (selecting among the <a class="el" href="classDoFHandler.html">DoFHandler</a> in multi-DoFHandler systems; here, we only have one) and the second being 1 to make the quadrature formula selection. As we use the quadrature formula 0 for the over-integration of nonlinear terms, we use the formula 1 with the default \(p+1\) (or <code>fe_degree+1</code> in terms of the variable name) points for the mass matrix. This leads to square contributions to the mass matrix and ensures exact integration, as explained in the introduction.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_inverse_mass_matrix(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">  <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">  <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.apply(phi.begin_dof_values(), phi.begin_dof_values());</div>
<div class="line"> </div>
<div class="line">      phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="Theapplyandrelatedfunctions"></a> </p><h4>The <a class="el" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply()</a> and related functions</h4>
<p>We now come to the function which implements the evaluation of the Euler operator as a whole, i.e., \(\mathcal M^{-1} \mathcal L(t, \mathbf{w})\) , calling into the local evaluators presented above. The steps should be clear from the previous code. One thing to note is that we need to adjust the time in the functions we have associated with the various parts of the boundary, in order to be consistent with the equation in case the boundary data is time-dependent. Then, we call <a class="el" href="classMatrixFree.html#a0e9669e4a5cfaceac78f5e26c285c2ea">MatrixFree::loop()</a> to perform the cell and face integrals, including the necessary ghost data exchange in the <code>src</code> vector. The seventh argument to the function, <code>true</code>, specifies that we want to zero the <code>dst</code> vector as part of the loop, before we start accumulating integrals into it. This variant is preferred over explicitly calling <code>dst = 0.;</code> before the loop as the zeroing operation is done on a subrange of the vector in parts that are written by the integrals nearby. This enhances data locality and allows for caching, saving one roundtrip of vector data to main memory and enhancing performance. The last two arguments to the loop determine which data is exchanged: Since we only access the values of the shape functions one faces, typical of first-order hyperbolic problems, and since we have a nodal basis with nodes at the reference element surface, we only need to exchange those parts. This again saves precious memory bandwidth. <br  />
 Once the spatial operator \(\mathcal L\) is applied, we need to make a second round and apply the inverse mass matrix. Here, we call <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a> since only cell integrals appear. The cell loop is cheaper than the full loop as access only goes to the degrees of freedom associated with the locally owned cells, which is simply the locally owned degrees of freedom for DG discretizations. Thus, no ghost exchange is needed here. <br  />
 Around all these functions, we put timer scopes to record the computational time for statistics about the contributions of the various parts.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">EulerOperator&lt;dim, degree, n_points_1d&gt;::apply</a>(</div>
<div class="line">     <span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">- integrals&quot;</span>);</div>
<div class="line">  </div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">         <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">         <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">                 &amp;EulerOperator::local_apply_face,</div>
<div class="line">                 &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">                 <span class="keyword">this</span>,</div>
<div class="line">                 <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                 src,</div>
<div class="line">                 <span class="keyword">true</span>,</div>
<div class="line">                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">- inverse mass&quot;</span>);</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(&amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">                      <span class="keyword">this</span>,</div>
<div class="line">                      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">     }</div>
<div class="line">   }</div>
</div><!-- fragment --><p>Let us move to the function that does an entire stage of a Runge&ndash;Kutta update. It calls EulerOperator::apply() followed by some updates to the vectors, namely <code>next_ri = solution + factor_ai k_i</code> and <code>solution += factor_solution k_i</code>. Rather than performing these steps through the vector interfaces, we here present an alternative strategy that is faster on cache-based architectures. As the memory consumed by the vectors is often much larger than what fits into caches, the data has to effectively come from the slow RAM memory. The situation can be improved by loop fusion, i.e., performing both the updates to <code>next_ki</code> and <code>solution</code> within a single sweep. In that case, we would read the two vectors <code>rhs</code> and <code>solution</code> and write into <code>next_ki</code> and <code>solution</code>, compared to at least 4 reads and two writes in the baseline case. Here, we go one step further and perform the loop immediately when the mass matrix inversion has finished on a part of the vector. <a class="el" href="classMatrixFree.html#abc204ec41ead1b5060f47ef3a5a066d7">MatrixFree::cell_loop()</a> provides a mechanism to attach an <code>std::function</code> both before the loop over cells first touches a vector entry (which we do not use here, but is e.g. used for zeroing the vector) and a second <code>std::function</code> to be called after the loop last touches an entry. The callback is in form of a range over the given vector (in terms of the local index numbering in the MPI universe) that can be addressed by <code>local_element()</code> functions. <br  />
 For this second callback, we create a lambda that works on a range and write the respective update on this range. Ideally, we would add the <code>DEAL_II_OPENMP_SIMD_PRAGMA</code> before the local loop to suggest to the compiler to SIMD parallelize this loop (which means in practice that we ensure that there is no overlap, also called aliasing, between the index ranges of the pointers we use inside the loops). It turns out that at the time of this writing, GCC 7.2 fails to compile an OpenMP pragma inside a lambda function, so we comment this pragma out below. If your compiler is newer, you should be able to uncomment these lines again. <br  />
 Note that we select a different code path for the last Runge&ndash;Kutta stage when we do not need to update the <code>next_ri</code> vector. This strategy gives a considerable speedup. Whereas the inverse mass matrix and vector updates take more than 60% of the computational time with default vector updates on a 40-core machine, the percentage is around 35% with the more optimized variant. In other words, this is a speedup of around a third.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_solution,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_ai,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      next_ri)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">- integrals L_h&quot;</span>);</div>
<div class="line">  </div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">         <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">       <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">         <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">  </div>
<div class="line">       <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">                 &amp;EulerOperator::local_apply_face,</div>
<div class="line">                 &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">                 <span class="keyword">this</span>,</div>
<div class="line">                 vec_ki,</div>
<div class="line">                 current_ri,</div>
<div class="line">                 <span class="keyword">true</span>,</div>
<div class="line">                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">                 <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">     }</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">     {</div>
<div class="line">       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage</span></div>
<div class="line"><span class="stringliteral">  </span></div>
<div class="line"><span class="stringliteral">- inv mass + vec upd&quot;</span>);</div>
<div class="line">       <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(</div>
<div class="line">         &amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">         <span class="keyword">this</span>,</div>
<div class="line">         next_ri,</div>
<div class="line">         vec_ki,</div>
<div class="line">         <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)&gt;(),</div>
<div class="line">         [&amp;](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start_range, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> end_range) {</div>
<div class="line">           <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> ai = factor_ai;</div>
<div class="line">           <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> bi = factor_solution;</div>
<div class="line">           <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">             {</div>
<div class="line">                <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span> </div>
<div class="line">               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                 {</div>
<div class="line">                   <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                   <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                   <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi k_i;</div>
<div class="line">                 }</div>
<div class="line">             }</div>
<div class="line">           <span class="keywordflow">else</span></div>
<div class="line">             {</div>
<div class="line">                <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span> </div>
<div class="line">               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                 {</div>
<div class="line">                   <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                   <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                   <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi k_i;</div>
<div class="line">                   next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)  = sol_i + ai k_i;</div>
<div class="line">                 }</div>
<div class="line">             }</div>
<div class="line">         });</div>
<div class="line">     }</div>
<div class="line">   }</div>
</div><!-- fragment --><p>Having discussed the implementation of the functions that deal with advancing the solution by one time step, let us now move to functions that implement other, ancillary operations. Specifically, these are functions that compute projections, evaluate errors, and compute the speed of information transport on a cell. <br  />
 The first of these functions is essentially equivalent to <a class="el" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project()</a>, just much faster because it is specialized for DG elements where there is no need to set up and solve a linear system, as each element has independent basis functions. The reason why we show the code here, besides a small speedup of this non-critical operation, is that it shows additional functionality provided by <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a>. <br  />
 The projection operation works as follows: If we denote the matrix of shape functions evaluated at quadrature points by \(S\) , the projection on cell \(K\) is an operation of the form \(\underbrace{S J^K S^\mathrm T}_{\mathcal M^K} \mathbf{w}^K = S J^K \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\) , where \(J^K\) is the diagonal matrix containing the determinant of the Jacobian times the quadrature weight (JxW), \(\mathcal M^K\) is the cell-wise mass matrix, and \(\tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\) is the evaluation of the field to be projected onto quadrature points. (In reality the matrix \(S\) has additional structure through the tensor product, as explained in the introduction.) This system can now equivalently be written as \(\mathbf{w}^K = \left(S J^K S^\mathrm T\right)^{-1} S J^K \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q} = S^{-\mathrm T} \left(J^K\right)^{-1} S^{-1} S J^K \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\) . Now, the term \(S^{-1} S\) and then \(\left(J^K\right)^{-1} J^K\) cancel, resulting in the final expression \(\mathbf{w}^K = S^{-\mathrm T} \tilde{\mathbf{w}}(\mathbf{x}_q)_{q=1:n_q}\) . This operation is implemented by <a class="el" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html#a5e95a87a9c63b321c77c72b8d762b760">MatrixFreeOperators::CellwiseInverseMassMatrix::transform_from_q_points_to_basis()</a>. The name is derived from the fact that this projection is simply the multiplication by \(S^{-\mathrm T}\) , a basis change from the nodal basis in the points of the Gaussian quadrature to the given finite element basis. Note that we call FEEvaluation::set_dof_values() to write the result into the vector, overwriting previous content, rather than accumulating the results as typical in integration tasks</p>
<ul>
<li>we can do this because every vector entry has contributions from only a single cell for discontinuous Galerkin discretizations.</li>
</ul>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">  <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                               phi.quadrature_point(q)),</div>
<div class="line">                             q);</div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                               phi.begin_dof_values(),</div>
<div class="line">                                               phi.begin_dof_values());</div>
<div class="line">      phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The next function again repeats functionality also provided by the deal.II library, namely <a class="el" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference()</a>. We here show the explicit code to highlight how the vectorization across several cells works and how to accumulate results via that interface: Recall that each <em>lane</em> of the vectorized array holds data from a different cell. By the loop over all cell batches that are owned by the current MPI process, we could then fill a <a class="el" href="classVectorizedArray.html">VectorizedArray</a> of results; to obtain a global sum, we would need to further go on and sum across the entries in the SIMD array. However, such a procedure is not stable as the SIMD array could in fact not hold valid data for all its lanes. This happens when the number of locally owned cells is not a multiple of the SIMD width. To avoid invalid data, we must explicitly skip those invalid lanes when accessing the data. While one could imagine that we could make it work by simply setting the empty lanes to zero (and thus, not contribute to a sum), the situation is more complicated than that: What if we were to compute a velocity out of the momentum? Then, we would need to divide by the density, which is zero</p>
<ul>
<li>the result would consequently be NaN and contaminate the result. This trap is avoided by accumulating the results from the valid SIMD range as we loop through the cell batches, using the function <a class="el" href="classMatrixFree.html#a1d516071d20e633dc9efcadb7852ce15">MatrixFree::n_active_entries_per_cell_batch()</a> to give us the number of lanes with valid data. It equals <a class="el" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray::size()</a> on most cells, but can be less on the last cell batch if the number of cells has a remainder compared to the SIMD width.</li>
</ul>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">   std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">   </span>{</div>
<div class="line">     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">     <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">       {</div>
<div class="line">         phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">         phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">         <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_errors_squared[3] = {};</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">           {</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">               <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q))</div>
<div class="line">  </div>
<div class="line">-</div>
<div class="line">               phi.get_value(q);</div>
<div class="line">             <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line">  </div>
<div class="line">             local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">             local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">           }</div>
<div class="line">         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">              ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">             errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line">  </div>
<div class="line">     std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">       <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">   }</div>
</div><!-- fragment --><p>This final function of the EulerOperator class is used to estimate the transport speed, scaled by the mesh size, that is relevant for setting the time step size in the explicit time integrator. In the Euler equations, there are two speeds of transport, namely the convective velocity \(\mathbf{u}\) and the propagation of sound waves with sound speed \(c = \sqrt{\gamma p/\rho}\) relative to the medium moving at velocity \(\mathbf u\) . <br  />
 In the formula for the time step size, we are interested not by these absolute speeds, but by the amount of time it takes for information to cross a single cell. For information transported along with the medium, \(\mathbf u\) is scaled by the mesh size, so an estimate of the maximal velocity can be obtained by computing \(\|J^{-\mathrm T} \mathbf{u}\|_\infty\) , where \(J\) is the Jacobian of the transformation from real to the reference domain. Note that <a class="el" href="classFEEvaluationBaseData.html#adad456112f01b19291e7781fb5efee55">FEEvaluationBase::inverse_jacobian()</a> returns the inverse and transpose Jacobian, representing the metric term from real to reference coordinates, so we do not need to transpose it again. We store this limit in the variable <code>convective_limit</code> in the code below. <br  />
 The sound propagation is isotropic, so we need to take mesh sizes in any direction into account. The appropriate mesh size scaling is then given by the minimal singular value of \(J\) or, equivalently, the maximal singular value of \(J^{-1}\) . Note that one could approximate this quantity by the minimal distance between vertices of a cell when ignoring curved cells. To get the maximal singular value of the Jacobian, the general strategy would be some LAPACK function. Since all we need here is an estimate, we can avoid the hassle of decomposing a tensor of <a class="el" href="classVectorizedArray.html">VectorizedArray</a> numbers into several matrices and go into an (expensive) eigenvalue function without vectorization, and instead use a few iterations (five in the code below) of the power method applied to \(J^{-1}J^{-\mathrm T}\) . The speed of convergence of this method depends on the ratio of the largest to the next largest eigenvalue and the initial guess, which is the vector of all ones. This might suggest that we get slow convergence on cells close to a cube shape where all lengths are almost the same. However, this slow convergence means that the result will sit between the two largest singular values, which both are close to the maximal value anyway. In all other cases, convergence will be quick. Thus, we can merely hardcode 5 iterations here and be confident that the result is good.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line"><span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">  <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">    {</div>
<div class="line">      phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">      phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">      <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_max = 0.;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> convective_speed = inverse_jacobian <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">          <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> convective_limit = 0.;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            convective_limit =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">            <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">            {</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(inverse_jacobian)</div>
<div class="line">                            (inverse_jacobian <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">              <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> eigenvector_norm = 0.;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                eigenvector_norm =</div>
<div class="line">                  <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">            }</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">            (jac_times_ev jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">          local_max =</div>
<div class="line">            <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                     max_eigenvalue speed_of_sound + convective_limit);</div>
<div class="line">        }</div>
</div><!-- fragment --><p>Similarly to the previous function, we must make sure to accumulate speed only on the valid cells of a cell batch.</p>
<div class="fragment"><div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">           ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> max_transport;</div>
<div class="line">}</div>
</div><!-- fragment --><p><a class="anchor" id="TheEulerProblemclass"></a> </p><h3>The EulerProblem class</h3>
<p>This class combines the EulerOperator class with the time integrator and the usual global data structures such as <a class="el" href="classFiniteElement.html">FiniteElement</a> and <a class="el" href="classDoFHandler.html">DoFHandler</a>, to actually run the simulations of the Euler problem. <br  />
 The member variables are a triangulation, a finite element, a mapping (to create high-order curved surfaces, see e.g. <a class="el" href="step_10.html">step-10</a> ), and a <a class="el" href="classDoFHandler.html">DoFHandler</a> to describe the degrees of freedom. In addition, we keep an instance of the EulerOperator described above around, which will do all heavy lifting in terms of integrals, and some parameters for time integration like the current time or the time step size. <br  />
 Furthermore, we use a PostProcessor instance to write some additional information to the output file, in similarity to what was done in <a class="el" href="step_33.html">step-33</a> . The interface of the <a class="el" href="classDataPostprocessor.html">DataPostprocessor</a> class is intuitive, requiring us to provide information about what needs to be evaluated (typically only the values of the solution, except for the Schlieren plot that we only enable in 2D where it makes sense), and the names of what gets evaluated. Note that it would also be possible to extract most information by calculator tools within visualization programs such as ParaView, but it is so much more convenient to do it already when writing the output.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerProblem</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    EulerProblem();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
</div><!-- fragment --><p>For the main evaluation of the field variables, we first check that the lengths of the arrays equal the expected values (the lengths <code>2*dim+4</code> or <code>2*dim+5</code> are derived from the sizes of the names we specify in the <a class="el" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names()</a> function below). Then we loop over all evaluation points and fill the respective information: First we fill the primal solution variables of density \(\rho\) , momentum \(\rho \mathbf{u}\) and energy \(E\) , then we compute the derived velocity \(\mathbf u\) , the pressure \(p\) , the speed of sound \(c=\sqrt{\gamma p / \rho}\) , as well as the Schlieren plot showing \(s = |\nabla \rho|^2\) in case it is enabled. (See <a class="el" href="step_69.html">step-69</a> for another example where we create a Schlieren plot.)</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field(</div>
<div class="line">  <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">  <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">  <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">           <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">         <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">      computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">      computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">          inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">  <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">  <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>For the interpretation of quantities, we have scalar density, energy, pressure, speed of sound, and the Schlieren plot, and vectors for the momentum and the velocity.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">    interpretation;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">    interpretation.push_back(</div>
<div class="line">      <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">  interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">  interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    interpretation.push_back(</div>
<div class="line">      <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> interpretation;</div>
<div class="line">}</div>
</div><!-- fragment --><p>With respect to the necessary update flags, we only need the values for all quantities but the Schlieren plot, which is based on the density gradient.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword"></span>{</div>
<div class="line">  <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">}</div>
</div><!-- fragment --><p>The constructor for this class is unsurprising: We set up a parallel triangulation based on the <code>MPI_COMM_WORLD</code> communicator, a vector finite element with <code>dim+2</code> components for density, momentum, and energy, a high-order mapping of the same degree as the underlying finite element, and initialize the time and time step to zero.</p>
<div class="fragment"><div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  EulerProblem&lt;dim&gt;::EulerProblem()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
</div><!-- fragment --><p>As a mesh, this tutorial program implements two options, depending on the global variable <code>testcase</code>: For the analytical variant (<code>testcase==0</code>), the domain is \((0, 10) \times (-5, 5)\) , with Dirichlet boundary conditions (inflow) all around the domain. For <code>testcase==1</code>, we set the domain to a cylinder in a rectangular box, derived from the flow past cylinder testcase for incompressible viscous flow by Sch&auml;fer and Turek (1996). Here, we have a larger variety of boundaries. The inflow part at the left of the channel is given the inflow type, for which we choose a constant inflow profile, whereas we set a subsonic outflow at the right. For the boundary around the cylinder (boundary id equal to 2) as well as the channel walls (boundary id equal to 3) we use the wall boundary type, which is no-normal flow. Furthermore, for the 3D cylinder we also add a gravity force in vertical direction. Having the base mesh in place (including the manifolds set by <a class="el" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder()</a>), we can then perform the specified number of global refinements, create the unknown numbering from the <a class="el" href="classDoFHandler.html">DoFHandler</a>, and hand the <a class="el" href="classDoFHandler.html">DoFHandler</a> and <a class="el" href="classMapping.html" title="Abstract base class for mapping classes. This class declares the interface for the functionality to d...">Mapping</a> objects to the initialization of the EulerOperator.</p>
<div class="fragment"><div class="line">   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">   <span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::make_grid_and_dofs()</div>
<div class="line">   {</div>
<div class="line">     <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">       {</div>
<div class="line">         <span class="keywordflow">case</span> 0:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">  </div>
<div class="line">-5;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">             upper_right[0] = 10;</div>
<div class="line">             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">               upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line">  </div>
<div class="line">             <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                            lower_left,</div>
<div class="line">                                            upper_right);</div>
<div class="line">             <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line">  </div>
<div class="line">             euler_operator.set_inflow_boundary(</div>
<div class="line">               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">case</span> 1:</div>
<div class="line">           {</div>
<div class="line">             <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">               <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line">  </div>
<div class="line">             euler_operator.set_inflow_boundary(</div>
<div class="line">               0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">             euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">               1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">  </div>
<div class="line">             euler_operator.set_wall_boundary(2);</div>
<div class="line">             euler_operator.set_wall_boundary(3);</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">               euler_operator.set_body_force(</div>
<div class="line">                 std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                   std::vector&lt;double&gt;({0., 0.,</div>
<div class="line">  </div>
<div class="line">-0.2})));</div>
<div class="line">  </div>
<div class="line">             <span class="keywordflow">break</span>;</div>
<div class="line">           }</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">default</span>:</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line">  </div>
<div class="line">     dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line">  </div>
<div class="line">     euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">     euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
</div><!-- fragment --><p>In the following, we output some statistics about the problem. Because we often end up with quite large numbers of cells or degrees of freedom, we would like to print them with a comma to separate each set of three digits. This can be done via "locales", although the way this works is not particularly intuitive. <a class="el" href="step_32.html">step-32</a> explains this in slightly more detail.</p>
<div class="fragment"><div class="line">  std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.get_stream().getloc();</div>
<div class="line">  pcout.get_stream().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">  pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">        &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">        &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line">  pcout.get_stream().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">}</div>
</div><!-- fragment --><p>For output, we first let the Euler operator compute the errors of the numerical results. More precisely, we compute the error against the analytical result for the analytical solution case, whereas we compute the deviation against the background field with constant density and energy and constant velocity in \(x\) direction for the second test case. <br  />
 The next step is to create output. This is similar to what is done in <a class="el" href="step_33.html">step-33</a> : We let the postprocessor defined above control most of the output, except for the primal field that we write directly. For the analytical solution test case, we also perform another projection of the analytical solution and print the difference between that field and the numerical solution. Once we have defined all quantities to be written, we build the patches for output. Similarly to <a class="el" href="step_65.html">step-65</a> , we create a high-order VTK output by setting the appropriate flag, which enables us to visualize fields of high polynomial degrees. Finally, we call the <code><a class="el" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel()</a></code> function to write the result to the given file name. This function uses special MPI parallel write facilities, which are typically more optimized for parallel file systems than the standard library's <code>std::ofstream</code> variants used in most other tutorial programs. A particularly nice feature of the <code>write_vtu_in_parallel()</code> function is the fact that it can combine output from all MPI ranks into a single file, making it unnecessary to have a central record of all such files (namely, the "pvtu" file). <br  />
 For parallel programs, it is often instructive to look at the partitioning of cells among processors. To this end, one can pass a vector of numbers to <a class="el" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut::add_data_vector()</a> that contains as many entries as the current processor has active cells; these numbers should then be the rank of the processor that owns each of these cells. Such a vector could, for example, be obtained from <a class="el" href="namespaceGridTools.html#ac41d959ae1723a898b616c3320241ffe">GridTools::get_subdomain_association()</a>. On the other hand, on each MPI process, <a class="el" href="classDataOut.html">DataOut</a> will only read those entries that correspond to locally owned cells, and these of course all have the same value: namely, the rank of the current process. What is in the remaining entries of the vector doesn't actually matter, and so we can just get away with a cheap trick: We just fillall* values of the vector we give to <a class="el" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut::add_data_vector()</a> with the rank of the current MPI process. The key is that on each process, only the entries corresponding to the locally owned cells will be read, ignoring the (wrong) values in other entries. The fact that every process submits a vector in which the correct subset of entries is correct is all that is necessary.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> EulerProblem&lt;dim&gt;::output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">    euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">        &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">        &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">        &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">    <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">    <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">    data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">    {</div>
<div class="line">      std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">        interpretation;</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">    }</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">        <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                 <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                 <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                 interpretation);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">    mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">    data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                           <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                           <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> std::string filename =</div>
<div class="line">      <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">    data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>The EulerProblem::run() function puts all pieces together. It starts off by calling the function that creates the mesh and sets up data structures, and then initializing the time integrator and the two temporary vectors of the low-storage integrator. We call these vectors <code>rk_register_1</code> and <code>rk_register_2</code>, and use the first vector to represent the quantity \(\mathbf{r}_i\) and the second one for \(\mathbf{k}_i\) in the formulas for the Runge&ndash;Kutta scheme outlined in the introduction. Before we start the time loop, we compute the time step size by the <code>EulerOperator::compute_cell_transport_speed()</code> function. For reasons of comparison, we compare the result obtained there with the minimal mesh size and print them to screen. For velocities and speeds of sound close to unity as in this tutorial program, the predicted effective mesh size will be close, but they could vary if scaling were different.</p>
<div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">{</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number&gt;::size</a>();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) n_vect_number;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">          &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">  rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">  euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">      min_vertex_distance =</div>
<div class="line">        <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">  min_vertex_distance =</div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">  time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> integrator.n_stages() /</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">  pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">        &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">        &lt;&lt; std::endl</div>
<div class="line">        &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">  output_results(0);</div>
</div><!-- fragment --><p>Now we are ready to start the time loop, which we run until the time has reached the desired end time. Every 5 time steps, we compute a new estimate for the time step</p>
<ul>
<li>since the solution is nonlinear, it is most effective to adapt the value during the course of the simulation. In case the Courant number was chosen too aggressively, the simulation will typically blow up with time step NaN, so that is easy to detect here. One thing to note is that roundoff errors might propagate to the leading digits due to an interaction of slightly different time step selections that in turn lead to slightly different solutions. To decrease this sensitivity, it is common practice to round or truncate the time step size to a few digits, e.g. 3 in this case. In case the current time is near the prescribed 'tick' value for output (e.g. 0.02), we also write the output. After the end of the time loop, we summarize the computation by printing some statistics, which is mostly done by the <a class="el" href="classTimerOutput.html#ae7673798226de7731e3ecdf7c0fb7568">TimerOutput::print_wall_time_statistics()</a> function.</li>
</ul>
<div class="fragment"><div class="line">     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line">  </div>
<div class="line">     <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a></div>
<div class="line">  </div>
<div class="line">- 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">       {</div>
<div class="line">         ++timestep_number;</div>
<div class="line">         <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">           time_step =</div>
<div class="line">             <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> integrator.n_stages() /</div>
<div class="line">             <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">               euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line">  </div>
<div class="line">         {</div>
<div class="line">           <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">           integrator.perform_time_step(euler_operator,</div>
<div class="line">                                        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                        time_step,</div>
<div class="line">                                        <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                        rk_register_1,</div>
<div class="line">                                        rk_register_2);</div>
<div class="line">         }</div>
<div class="line">  </div>
<div class="line">         <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line">  </div>
<div class="line">         <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">               <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">  </div>
<div class="line">- time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">             <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a></div>
<div class="line">  </div>
<div class="line">- 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">           output_results(</div>
<div class="line">             <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">       }</div>
<div class="line">  </div>
<div class="line">     timer.print_wall_time_statistics(MPI_COMM_WORLD);</div>
<div class="line">     pcout &lt;&lt; std::endl;</div>
<div class="line">   }</div>
<div class="line">  </div>
<div class="line"> } <span class="comment">// namespace Euler_DG</span></div>
</div><!-- fragment --><p>The <a class="el" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main()</a> function is not surprising and follows what was done in all previous MPI programs: As we run an MPI program, we need to call <code>MPI_Init()</code> and <code>MPI_Finalize()</code>, which we do through the <a class="el" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> data structure. Note that we run the program only with MPI, and set the thread count to 1.</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>*argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <a class="anchor" id="Results"></a></p><h1>Results</h1>
<p><a class="anchor" id="Programoutput"></a></p><h3>Program output</h3>
<p>Running the program with the default settings on a machine with 40 processesproduces the following output: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 147,456 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 1,024 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 0.00689325, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.3125, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.102759</div>
<div class="line">  </div>
<div class="line">Time:       0, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:   2.76<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho u:  1.259<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 2.987<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    1.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:   1.37<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho u:  2.252<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.153<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    2.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.561<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho u:   2.43<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.493<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    3.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.714<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho u:  2.591<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.762<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    4.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.843<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho u:  2.625<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.985<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:    5.01, dt:   0.0069, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.496<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho u:  1.961<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, energy: 4.142<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       6, dt:   0.0083, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  1.007<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06, rho u:  7.119<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.972<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       7, dt:   0.0095, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  9.096<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho u:  3.786<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.626<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       8, dt:   0.0096, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  8.439<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho u:  3.338<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy:  2.43<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:       9, dt:   0.0096, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  7.822<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho u:  2.984<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.248<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">Time:      10, dt:   0.0096, <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> rho:  7.231<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, rho u:  2.666<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-07, energy: 2.074<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-06</div>
<div class="line">  </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     2.249<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    30 |     2.249<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     2.249<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     8 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        11 |  0.008066s    13 |   0.00952s |   0.01041s    20 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |       258 |   0.01012s    13 |   0.05392s |   0.08574s    25 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        11 |    0.9597s    13 |    0.9613s |    0.9623s     6 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |      1283 |    0.9827s    25 |     1.015s |      1.06s    13 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |      6415 |    0.8803s    26 |    0.9198s |    0.9619s    14 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |      6415 |   0.05677s    15 |   0.06487s |   0.07597s    13 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The program output shows that all errors are small. This is due to the factthat we use a relatively fine mesh of \(32^2\) cells with polynomials of degree5 for a solution that is smooth. An interesting pattern shows for the timestep size: whereas it is 0.0069 up to time 5, it increases to 0.0096 for latertimes. The step size increases once the vortex with some motion on top of thespeed of sound (and thus faster propagation) leaves the computational domainbetween times 5 and 6.5. After that point, the flow is simply uniformin the same direction, and the maximum velocity of the gas is reducedcompared to the previous state where the uniform velocity was overlaidby the vortex. Our time step formula recognizes this effect. The final block of output shows detailed information about the timingof individual parts of the programs; it breaks this down by showingthe time taken by the fastest and the slowest processor, and theaverage time</p>
<ul>
<li>this is often useful in very large computations tofind whether there are processors that are consistently overheated(and consequently are throttling their clock speed) or consistentlyslow for other reasons.The summary shows that 1283 time steps have been performedin 1.02 seconds (looking at the average time among all MPI processes), whilethe output of 11 files has taken additional 0.96 seconds. Broken down per timestep and into the five Runge&ndash;Kutta stages, the compute time per evaluation is0.16 milliseconds. This high performance is typical of matrix-free evaluatorsand a reason why explicit time integration is very competitive againstimplicit solvers, especially for large-scale simulations. The breakdown ofcomputational times at the end of the program run shows that the evaluation ofintegrals in \(\mathcal L_h\) contributes with around 0.92 seconds and theapplication of the inverse mass matrix with 0.06 seconds. Furthermore, theestimation of the transport speed for the time step size computationcontributes with another 0.05 seconds of compute time. If we use three more levels of global refinement and 9.4 million DoFs in total,the final statistics are as follows (for the modified Lax&ndash;Friedrichs flux, \(p=5\) , and the same system of 40 cores of dual-socket Intel Xeon Gold 6230): <div class="fragment"><div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     244.9s    12 |     244.9s |     244.9s    34 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        11 |    0.4239s    12 |    0.4318s |    0.4408s     9 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      2053 |     3.962s    12 |     6.727s |     10.12s     7 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        11 |     30.35s    12 |     30.36s |     30.37s     9 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     10258 |     201.7s     7 |     205.1s |     207.8s    12 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |     51290 |     121.3s     6 |     126.6s |     136.3s    16 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |     51290 |     66.19s    16 |     77.52s |     81.84s    10 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --></li>
</ul>
<p>Per time step, the solver now takes 0.02 seconds, about 25 times as long asfor the small problem with 147k unknowns. Given that the problem involves 64times as many unknowns, the increase in computing time is notsurprising. Since we also do 8 times as many time steps, the compute timeshould in theory increase by a factor of 512. The actual increase is 205 s /1.02 s = 202. This is because the small problem size cannot fully utilize the40 cores due to communication overhead. This becomes clear if we look into thedetails of the operations done per time step. The evaluation of thedifferential operator \(\mathcal L_h\) with nearest neighbor communication goesfrom 0.92 seconds to 127 seconds, i.e., it increases with a factor of 138. Onthe other hand, the cost for application of the inverse mass matrix and thevector updates, which do not need to communicate between the MPI processes atall, has increased by a factor of 1195. The increase is more than thetheoretical factor of 512 because the operation is limited by the bandwidthfrom RAM memory for the larger size while for the smaller size, all vectorsfit into the caches of the CPU. The numbers show that the mass matrixevaluation and vector update part consume almost 40% of the time spent by theRunge&ndash;Kutta stages</p>
<ul>
<li>despite using a low-storage Runge&ndash;Kutta integrator andmerging of vector operations! And despite using over-integration for the \(\mathcal L_h\) operator. For simpler differential operators and more expensivetime integrators, the proportion spent in the mass matrix and vector updatepart can also reach 70%. If we compute a throughput number in terms of DoFsprocessed per second and Runge&ndash;Kutta stage, we obtain <p class="formulaDsp">
\[ \text{throughput} = \frac{n_\mathrm{time steps} n_\mathrm{stages} n_\mathrm{dofs}}{t_\mathrm{compute}} = \frac{10258 \cdot 5 \cdot 9.4\,\text{MDoFs}}{205s} = 2360\, \text{MDoFs/s} \]
</p>
 This throughput number isvery high, given that simply copying one vector to another one runs atonly around 10,000 MDoFs/s. If we go to the next-larger size with 37.7 million DoFs, the overallsimulation time is 2196 seconds, with 1978 seconds spent in the timestepping. The increase in run time is a factor of 9.3 for the L_h operator(1179 versus 127 seconds) and a factor of 10.3 for the inverse mass matrix andvector updates (797 vs 77.5 seconds). The reason for this non-optimal increasein run time can be traced back to cache effects on the given hardware (with 40MB of L2 cache and 55 MB of L3 cache): While not all of the relevant data fitsinto caches for 9.4 million DoFs (one vector takes 75 MB and we have threevectors plus some additional data in <a class="el" href="classMatrixFree.html">MatrixFree</a>), there is capacity for one anda half vector nonetheless. Given that modern caches are more sophisticated thanthe naive least-recently-used strategy (where we would have little re-use asthe data is used in a streaming-like fashion), we can assume that a sizeablefraction of data can indeed be delivered from caches for the 9.4 million DoFscase. For the larger case, even with optimal caching less than 10 percent ofdata would fit into caches, with an associated loss in performance.</li>
</ul>
<p><a class="anchor" id="Convergenceratesfortheanalyticaltestcase"></a></p><h3>Convergence rates for the analytical test case</h3>
<p>For the modified Lax&ndash;Friedrichs flux and measuring the error in the momentumvariable, we obtain the following convergence table (the rates are verysimilar for the density and energy variables): </p><table align="center" class="doxtable">
<tr>
<th>&#160; </th><th colspan="3"><em>p</em>=2 </th><th colspan="3"><em>p</em>=3 </th><th colspan="3"><em>p</em>=5  </th></tr>
<tr>
<th>n_cells </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate  </th></tr>
<tr>
<td align="right">16 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">2,304 </td><td align="center">1.373e-01 </td><td>&#160;  </td></tr>
<tr>
<td align="right">64 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">4,096 </td><td align="center">9.130e-02 </td><td>&#160; </td><td align="right">9,216 </td><td align="center">8.899e-03 </td><td>3.94  </td></tr>
<tr>
<td align="right">256 </td><td align="right">9,216 </td><td align="center">5.577e-02 </td><td>&#160; </td><td align="right">16,384 </td><td align="center">7.381e-03 </td><td>3.64 </td><td align="right">36,864 </td><td align="center">2.082e-04 </td><td>5.42  </td></tr>
<tr>
<td align="right">1024 </td><td align="right">36,864 </td><td align="center">4.724e-03 </td><td>3.56 </td><td align="right">65,536 </td><td align="center">3.072e-04 </td><td>4.59 </td><td align="right">147,456 </td><td align="center">2.625e-06 </td><td>6.31  </td></tr>
<tr>
<td align="right">4096 </td><td align="right">147,456 </td><td align="center">6.205e-04 </td><td>2.92 </td><td align="right">262,144 </td><td align="center">1.880e-05 </td><td>4.03 </td><td align="right">589,824 </td><td align="center">3.268e-08 </td><td>6.33  </td></tr>
<tr>
<td align="right">16,384 </td><td align="right">589,824 </td><td align="center">8.279e-05 </td><td>2.91 </td><td align="right">1,048,576 </td><td align="center">1.224e-06 </td><td>3.94 </td><td align="right">2,359,296 </td><td align="center">9.252e-10 </td><td>5.14  </td></tr>
<tr>
<td align="right">65,536 </td><td align="right">2,359,296 </td><td align="center">1.105e-05 </td><td>2.91 </td><td align="right">4,194,304 </td><td align="center">7.871e-08 </td><td>3.96 </td><td align="right">9,437,184 </td><td align="center">1.369e-10 </td><td>2.77  </td></tr>
<tr>
<td align="right">262,144 </td><td align="right">9,437,184 </td><td align="center">1.615e-06 </td><td>2.77 </td><td align="right">16,777,216 </td><td align="center">4.961e-09 </td><td>3.99 </td><td align="right">37,748,736 </td><td align="center">7.091e-11 </td><td>0.95  </td></tr>
</table>
<p><br  />
 If we switch to the Harten-Lax-van Leer flux, the results are as follows: </p><table align="center" class="doxtable">
<tr>
<th>&#160; </th><th colspan="3"><em>p</em>=2 </th><th colspan="3"><em>p</em>=3 </th><th colspan="3"><em>p</em>=5  </th></tr>
<tr>
<th>n_cells </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate </th><th>n_dofs </th><th>error mom </th><th>rate  </th></tr>
<tr>
<td align="right">16 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">2,304 </td><td align="center">1.339e-01 </td><td>&#160;  </td></tr>
<tr>
<td align="right">64 </td><td>&#160; </td><td>&#160; </td><td>&#160; </td><td align="right">4,096 </td><td align="center">9.037e-02 </td><td>&#160; </td><td align="right">9,216 </td><td align="center">8.849e-03 </td><td>3.92  </td></tr>
<tr>
<td align="right">256 </td><td align="right">9,216 </td><td align="center">4.204e-02 </td><td>&#160; </td><td align="right">16,384 </td><td align="center">9.143e-03 </td><td>3.31 </td><td align="right">36,864 </td><td align="center">2.501e-04 </td><td>5.14  </td></tr>
<tr>
<td align="right">1024 </td><td align="right">36,864 </td><td align="center">4.913e-03 </td><td>3.09 </td><td align="right">65,536 </td><td align="center">3.257e-04 </td><td>4.81 </td><td align="right">147,456 </td><td align="center">3.260e-06 </td><td>6.26  </td></tr>
<tr>
<td align="right">4096 </td><td align="right">147,456 </td><td align="center">7.862e-04 </td><td>2.64 </td><td align="right">262,144 </td><td align="center">1.588e-05 </td><td>4.36 </td><td align="right">589,824 </td><td align="center">2.953e-08 </td><td>6.79  </td></tr>
<tr>
<td align="right">16,384 </td><td align="right">589,824 </td><td align="center">1.137e-04 </td><td>2.79 </td><td align="right">1,048,576 </td><td align="center">9.400e-07 </td><td>4.08 </td><td align="right">2,359,296 </td><td align="center">4.286e-10 </td><td>6.11  </td></tr>
<tr>
<td align="right">65,536 </td><td align="right">2,359,296 </td><td align="center">1.476e-05 </td><td>2.95 </td><td align="right">4,194,304 </td><td align="center">5.799e-08 </td><td>4.02 </td><td align="right">9,437,184 </td><td align="center">2.789e-11 </td><td>3.94  </td></tr>
<tr>
<td align="right">262,144 </td><td align="right">9,437,184 </td><td align="center">2.038e-06 </td><td>2.86 </td><td align="right">16,777,216 </td><td align="center">3.609e-09 </td><td>4.01 </td><td align="right">37,748,736 </td><td align="center">5.730e-11 </td><td>-1.04  </td></tr>
</table>
<p><br  />
 The tables show that we get optimal \(\mathcal O\left(h^{p+1}\right)\) convergence rates for both numerical fluxes. The errors are slightly smallerfor the Lax&ndash;Friedrichs flux for \(p=2\) , but the picture is reversed for \(p=3\) ; in any case, the differences on this testcase are relativelysmall. For \(p=5\) , we reach the roundoff accuracy of \(10^{-11}\) with bothfluxes on the finest grids. Also note that the errors are absolute with adomain length of \(10^2\) , so relative errors are below \(10^{-12}\) . The HLL fluxis somewhat better for the highest degree, which is due to a slight inaccuracyof the Lax&ndash;Friedrichs flux: The Lax&ndash;Friedrichs flux sets a Dirichletcondition on the solution that leaves the domain, which results in a smallartificial reflection, which is accentuated for the Lax&ndash;Friedrichsflux. Apart from that, we see that the influence of the numerical flux isminor, as the polynomial part inside elements is the main driver of theaccucary. The limited influence of the flux also has consequences when tryingto approach more challenging setups with the higher-order DG setup: Taking forexample the parameters and grid of <a class="el" href="step_33.html">step-33</a> , we get oscillations (which in turnmake density negative and make the solution explode) with both fluxes once thehigh-mass part comes near the boundary, as opposed to the low-order finitevolume case ( \(p=0\) ). Thus, any case that leads to shocks in the solutionnecessitates some form of limiting or artificial dissipation. For anotheralternative, see the <a class="el" href="step_69.html">step-69</a> tutorial program.</p>
<p><a class="anchor" id="Resultsforflowinchannelaroundcylinderin2D"></a></p><h3>Results for flow in channel around cylinder in 2D</h3>
<p>For the test case of the flow around a cylinder in a channel, we need tochange the first code line to </p><div class="fragment"><div class="line">constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> = 1;</div>
</div><!-- fragment --><p> This test case starts with a background field of a constant velocityof Mach number 0.31 and a constant initial density; the flow will haveto go around an obstacle in the form of a cylinder. Since we impose ano-penetration condition on the cylinder walls, the flow thatinitially impinges head-on onto to cylinder has to rearrange,which creates a big sound wave. The following pictures show the pressure attimes 0.1, 0.25, 0.5, and 1.0 (top left to bottom right) for the 2D case with5 levels of global refinement, using 102,400 cells with polynomial degree of5 and 14.7 million degrees of freedom over all 4 solution variables.We clearly see the discontinuity thatpropagates slowly in the upstream direction and more quickly in downstreamdirection in the first snapshot at time 0.1. At time 0.25, the sound wave hasreached the top and bottom walls and reflected back to the interior. From thedifferent distances of the reflected waves from lower and upper walls we cansee the slight asymmetry of the Sch&auml;fer-Turek test case represented by <a class="el" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder()</a> with somewhat more space above thecylinder compared to below. At later times, the picture is more chaotic withmany sound waves all over the place. </p><table align="center" class="doxtable" style="width:85%">
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_010.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_025.png" alt="" width="100%" class="inline"/>   </td></tr>
<tr>
<td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_050.png" alt="" width="100%" class="inline"/>  </td><td><img src="https://www.dealii.org/images/steps/developer/step-67.pressure_100.png" alt="" width="100%" class="inline"/>   </td></tr>
</table>
<p><br  />
 The next picture shows an elevation plot of the pressure at time 1.0 lookingfrom the channel inlet towards the outlet at the same resolution</p>
<ul>
<li>here,we can see the large numberof reflections. In the figure, two types of waves are visible. Thelarger-amplitude waves correspond to various reflections that happened as theinitial discontinuity hit the walls, whereas the small-amplitude waves ofsize similar to the elements correspond to numerical artifacts. They have theirorigin in the finite resolution of the scheme and appear as the discontinuitytravels through elements with high-order polynomials. This effect can be curedby increasing resolution. Apart from this effect, the rich wave structure isthe result of the transport accuracy of the high-order DG method. <img src="https://www.dealii.org/images/steps/developer/step-67.pressure_elevated.jpg" alt="" width="40%" class="inline"/> <br  />
 With 2 levels of global refinement with 1,600 cells, the mesh and itspartitioning on 40 MPI processes looks as follows: <img src="https://www.dealii.org/images/steps/developer/step-67.grid-owner.png" alt="" width="70%" class="inline"/> <br  />
 When we run the code with 4 levels of global refinements on 40 cores, we getthe following output: <div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 3,686,400 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 25,600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">Time <a class="code" href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a> <a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>: 7.39876<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, minimal <a class="code" href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a>: 0.001875, <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> transport scaling: 0.00110294</div>
<div class="line">  </div>
<div class="line">Time:       0, dt:  7.4<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:   4.17<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, rho u:  1.629<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-16, energy: 1.381<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-15</div>
<div class="line">Time:    0.05, dt:  6.3<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02075, rho u:    0.03801, energy:   0.08772</div>
<div class="line">Time:     0.1, dt:  5.9<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02211, rho u:    0.04515, energy:   0.08953</div>
<div class="line">Time:    0.15, dt:  5.7<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02261, rho u:    0.04592, energy:   0.08967</div>
<div class="line">Time:     0.2, dt:  5.8<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.02058, rho u:    0.04361, energy:   0.08222</div>
<div class="line">Time:    0.25, dt:  5.9<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01695, rho u:    0.04203, energy:   0.06873</div>
<div class="line">Time:     0.3, dt:  5.9<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01653, rho u:     0.0401, energy:   0.06604</div>
<div class="line">Time:    0.35, dt:  5.7<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01774, rho u:    0.04264, energy:    0.0706</div>
<div class="line">  </div>
<div class="line">...</div>
<div class="line">  </div>
<div class="line">Time:    1.95, dt:  5.8<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01488, rho u:    0.03923, energy:   0.05185</div>
<div class="line">Time:       2, dt:  5.7<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01432, rho u:    0.03969, energy:   0.04889</div>
<div class="line">  </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |     273.6<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    13 |     273.6<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |     273.6<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |   0.01112s    35 |    0.0672s |    0.1337s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      6914 |     5.422s    35 |     15.96s |     29.99s     1 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |     37.24s    35 |      37.3s |     37.37s     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     34564 |     205.4s     1 |     219.5s |     230.1s    35 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    172820 |     153.6s     1 |     164.9s |     175.6s    27 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |    172820 |     47.13s    13 |     53.09s |     64.05s    33 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --></li>
</ul>
<p>The norms shown here for the various quantities are the deviations \(\rho&#39;\) , \((\rho u)&#39;\) , and \(E&#39;\) against the background field (namely, theinitial condition). The distribution of run time is overall similar as in theprevious test case. The only slight difference is the larger proportion oftime spent in \(\mathcal L_h\) as compared to the inverse mass matrix and vectorupdates. This is because the geometry is deformed and the matrix-freeframework needs to load additional arrays for the geometry from memory thatare compressed in the affine mesh case. Increasing the number of global refinements to 5, the output becomes: </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 14,745,600 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 102,400 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">  </div>
<div class="line">...</div>
<div class="line">  </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              |      2693<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |      2693<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      2693<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    23 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |   0.04537s    32 |     0.173s |    0.3489s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |     13858 |     40.75s    32 |     85.99s |     149.8s     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |     153.8s    32 |     153.9s |     154.1s     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     69284 |      2386<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |      2450<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      2496<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    346420 |      1365<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |      1574<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      1718<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    19 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |    346420 |     722.5s    10 |     870.7s |      1125<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The effect on performance is similar to the analytical test case</p>
<ul>
<li>intheory, computation times should increase by a factor of 8, but we actuallysee an increase by a factor of 11 for the time steps (219.5 seconds versus2450 seconds). This can be traced back to caches, with the small case mostlyfitting in caches. An interesting effect, typical of programs with a mix oflocal communication (integrals \(\mathcal L_h\) ) and global communication (computation oftransport speed) with some load imbalance, can be observed by looking at theMPI ranks that encounter the minimal and maximal time of different phases,respectively. Rank 0 reports the fastest throughput for the "rk time steppingtotal" part. At the same time, it appears to be slowest for the "computetransport speed" part, almost a factor of 2 slower than theaverage and almost a factor of 4 compared to the faster rank.Since the latter involves global communication, we can attribute theslowness in this part to the fact that the local Runge&ndash;Kutta stages haveadvanced more quickly on this rank and need to wait until the other processorscatch up. At this point, one can wonder about the reason for this imbalance:The number of cells is almost the same on all MPI processes.However, the matrix-free framework is faster on affine and Cartesiancells located towards the outlet of the channel, to which the lower MPI ranksare assigned. On the other hand, rank 32, which reports the highest run timefor the Runga&ndash;Kutta stages, owns the curved cells near the cylinder, forwhich no data compression is possible. To improve throughput, we could assigndifferent weights to different cell types when partitioning the <a class="el" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a> object, or even measure the run time for afew time steps and try to rebalance then. The throughput per Runge&ndash;Kutta stage can be computed to 2085 MDoFs/s for the14.7 million DoFs test case over the 346,000 Runge&ndash;Kutta stages, slightly slowerthan the Cartesian mesh throughput of 2360 MDoFs/s reported above. Finally, if we add one additional refinement, we record the following output: <div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 58,982,400 ( = 4 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 409,600 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 36 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">  </div>
<div class="line">...</div>
<div class="line">  </div>
<div class="line">Time:    1.95, dt:  1.4<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01488, rho u:    0.03923, energy:   0.05183</div>
<div class="line">Time:       2, dt:  1.4<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01431, rho u:    0.03969, energy:   0.04887</div>
<div class="line">  </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              | 2.166<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    26 | 2.166<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 2.166<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    24 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |    0.1758s    30 |     0.672s |     1.376s     1 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |     27748 |     321.3s    34 |     678.8s |      1202<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     1 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |     616.3s    32 |     616.4s |     616.4s    34 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |    138733 | 1.983e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     1 | 2.036e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 2.072e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    693665 | 1.052e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 | 1.248e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.387e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    19 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |    693665 |      6404<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    10 |      7868<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.018e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --></li>
</ul>
<p>The "rk time stepping total" part corresponds to a throughput of 2010 MDoFs/s. Theoverall run time to perform 139k time steps is 20k seconds (5.7 hours) or 7time steps per second</p>
<ul>
<li>not so bad for having nearly 60 millionunknowns. More throughput can be achieved by adding more cores tothe computation.</li>
</ul>
<p><a class="anchor" id="Resultsforflowinchannelaroundcylinderin3D"></a></p><h3>Results for flow in channel around cylinder in 3D</h3>
<p>Switching the channel test case to 3D with 3 global refinements, the output is </p><div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 40 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 221,184,000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 204,800 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">  </div>
<div class="line">...</div>
<div class="line">  </div>
<div class="line">Time:    1.95, dt:  0.00011, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01131, rho u:    0.03056, energy:   0.04091</div>
<div class="line">Time:       2, dt:  0.00011, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:     0.0119, rho u:    0.03142, energy:   0.04425</div>
<div class="line">  </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              | 1.734<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     4 | 1.734<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.734<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    38 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |    0.6551s    34 |     3.216s |     7.281s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      3546 |       160<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |     393.2s |     776.9s     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |      1350<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |      1353<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      1357<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     17723 | 1.519e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 | 1.558e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 1.582e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    34 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |     88615 | 1.005e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 | 1.126e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |  1.23e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    11 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |     88615 |      3056<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    11 |      4322<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      5759<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    32 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --><p>The physics are similar to the 2D case, with a slight motion in the zdirection due to the gravitational force. The throughput per Runge&ndash;Kuttastage in this case is </p><p class="formulaDsp">
\[ \text{throughput} = \frac{n_\mathrm{time steps} n_\mathrm{stages} n_\mathrm{dofs}}{t_\mathrm{compute}} = \frac{17723 \cdot 5 \cdot 221.2\,\text{M}}{15580s} = 1258\, \text{MDoFs/s}. \]
</p>
<p> The throughput is lower than in 2D because the computation of the \(\mathcal L_h\) termis more expensive. This is due to over-integration with <code>degree+2</code> points andthe larger fraction of face integrals (worse volume-to-surface ratio) withmore expensive flux computations. If we only consider the inverse mass matrixand vector update part, we record a throughput of 4857 MDoFs/s for the 2D caseof the isentropic vortex with 37.7 million unknowns, whereas the 3D caseruns with 4535 MDoFs/s. The performance is similar because both cases are infact limited by the memory bandwidth. If we go to four levels of global refinement, we need to increase the numberof processes to fit everything in memory</p>
<ul>
<li>the computation needs around 350GB of RAM memory in this case. Also, the time it takes to complete 35k timesteps becomes more tolerable by adding additional resources. We therefore use6 nodes with 40 cores each, resulting in a computation with 240 MPI processes: <div class="fragment"><div class="line">Running <a class="code" href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a> 240 <a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a> <a class="code" href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div>
<div class="line">Vectorization over 8 doubles = 512 bits (AVX512)</div>
<div class="line"><a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a> <a class="code" href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a> <a class="code" href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a>: 1,769,472,000 ( = 5 [vars] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 1,638,400 [<a class="code" href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a>] <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> 216 [<a class="code" href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a>/<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>/var] )</div>
<div class="line">  </div>
<div class="line">...</div>
<div class="line">  </div>
<div class="line">Time:    1.95, dt:  5.6<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01129, rho u:     0.0306, energy:   0.04086</div>
<div class="line">Time:       2, dt:  5.6<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-05, <a class="code" href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a> rho:    0.01189, rho u:    0.03145, energy:   0.04417</div>
<div class="line">  </div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| Total wallclock <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> elapsed              | 5.396<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   151 | 5.396<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 5.396<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">|                                           |                  |                               |</div>
<div class="line">| <a class="code" href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a>                       | <a class="code" href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a>. <a class="code" href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a> |   <a class="code" href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">min</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |   <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">avg</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> |   <a class="code" href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">max</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>  <a class="code" href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a> |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>                |        41 |     2.632s   178 |     7.221s |     16.56s     0 |</div>
<div class="line">| <a class="code" href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a> transport speed       |      7072 |       714<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   193 |      1553<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      3351<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">| <a class="code" href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a>                        |        41 |      8065<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   176 |      8070<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |      8079<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |</div>
<div class="line">| rk <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> stepping total        |     35350 |  4.25e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>     0 |  4.43e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> | 4.515e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   193 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- <a class="code" href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a> L_h      |    176750 | 2.936e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   134 | 3.222e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |  3.67e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    99 |</div>
<div class="line">| rk_stage</div>
<div class="line">  </div>
<div class="line">- inv mass + vec upd |    176750 |      7004<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>    99 | 1.207e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> |  1.55e+04<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>   132 |</div>
<div class="line">+-------------------------------------------+------------------+------------+------------------+</div>
</div><!-- fragment --> This simulation had nearly 2 billion unknowns</li>
<li>quite a largecomputation indeed, and still only needed around 1.5 seconds per timestep.</li>
</ul>
<p><a class="anchor" id="Possibilitiesforextensions"></a></p><h3>Possibilities for extensions</h3>
<p>The code presented here straight-forwardly extends to adaptive meshes, givenappropriate indicators for setting the refinement flags. Large-scaleadaptivity of a similar solver in the context of the acoustic wave equationhas been achieved by the <a href="https://github.com/kronbichler/exwave">exwave project</a>. However, in the present context, the benefits of adaptivity are oftenlimited to early times and effects close to the origin of sound waves, as thewaves eventually reflect and diffract. This leads to steep gradients all overthe place, similar to turbulent flow, and a more or less globallyrefined mesh. Another topic that we did not discuss in the results section is a comparisonof different time integration schemes. The program provides four variants oflow-storage Runga&ndash;Kutta integrators that each have slightly differentaccuracy and stability behavior. Among the schemes implemented here, thehigher-order ones provide additional accuracy but come with slightly lowerefficiency in terms of step size per stage before they violate the CFLcondition. An interesting extension would be to compare the low-storagevariants proposed here with standard Runge&ndash;Kutta integrators or to use vectoroperations that are run separate from the mass matrix operation and compareperformance.</p>
<p><a class="anchor" id="Moreadvancednumericalfluxfunctionsandskewsymmetricformulations"></a></p><h4>More advanced numerical flux functions and skew-symmetric formulations</h4>
<p>As mentioned in the introduction, the modified Lax&ndash;Friedrichs flux and theHLL flux employed in this program are only two variants of a large body ofnumerical fluxes available in the literature on the Euler equations. Oneexample is the HLLC flux (Harten-Lax-van Leer-Contact) flux which adds theeffect of rarefaction waves missing in the HLL flux, or the Roe flux. Asmentioned in the introduction, the effect of numerical fluxes on high-order DGschemes is debatable (unlike for the case of low-order discretizations). A related improvement to increase the stability of the solver is to alsoconsider the spatial integral terms. A shortcoming in the rather naiveimplementation used above is the fact that the energy conservation of theoriginal Euler equations (in the absence of shocks) only holds up to adiscretization error. If the solution is under-resolved, the discretizationerror can give rise to an increase in the numerical energy and eventuallyrender the discretization unstable. This is because of the inexact numericalintegration of the terms in the Euler equations, which both contain rationalnonlinearities and higher-degree content from curved cells. A way out of thisdilemma are so-called skew-symmetric formulations, see <b>[Gassner2013]</b> for asimple variant. Skew symmetry means that switching the role of the solution \(\mathbf{w}\) and test functions \(\mathbf{v}\) in the weak form produces theexact negative of the original quantity, apart from some boundary terms. Inthe discrete setting, the challenge is to keep this skew symmetry also whenthe integrals are only computed approximately (in the continuous case,skew-symmetry is a consequence of integration by parts). Skew-symmetricnumerical schemes balance spatial derivatives in the conservative form \((\nabla \mathbf v, \mathbf{F}(\mathbf w))_{K}\) with contributions in theconvective form \((\mathbf v, \tilde{\mathbf{F}}(\mathbf w)\nabla \mathbf{w})_{K}\) for some \(\tilde{\mathbf{F}}\) . The precise terms depend onthe equation and the integration formula, and can in some cases by understoodby special skew-symmetric finite difference schemes. To get started, interested readers could take a look athttps://github.com/kronbichler/advection_miniapp, where askew-symmetric DG formulation is implemented with deal.II for a simple advectionequation. <a class="anchor" id="Equippingthecodeforsupersoniccalculations"></a></p><h4>Equipping the code for supersonic calculations</h4>
<p>As mentioned in the introduction, the solution to the Euler equations developsshocks as the Mach number increases, which require additional mechanisms tostabilize the scheme, e.g. in the form of limiters. The main challenge besidesactually implementing the limiter or artificial viscosity approach would be toload-balance the computations, as the additional computations involved forlimiting the oscillations in troubled cells would make them more expensive than theplain DG cells without limiting. Furthermore, additional numerical fluxes thatbetter cope with the discontinuities would also be an option. One ingredient also necessary for supersonic flows are appropriate boundaryconditions. As opposed to the subsonic outflow boundaries discussed in theintroduction and implemented in the program, all characteristics are outgoingfor supersonic outflow boundaries, so we do not want to prescribe any externaldata, </p><p class="formulaDsp">
\[ \mathbf{w}^+ = \mathbf{w}^- = \begin{pmatrix} \rho^-\\ (\rho \mathbf u)^- \\ E^-\end{pmatrix} \quad \text{(Neumann)}. \]
</p>
<p> In the code, we would simply add the additional statement </p><div class="fragment"><div class="line"><span class="keywordflow">else</span> <span class="keywordflow">if</span> (supersonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">         supersonic_outflow_boundaries.end())</div>
<div class="line">  {</div>
<div class="line">    w_p        = w_m;</div>
<div class="line">    at_outflow = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
</div><!-- fragment --><p> in the <code>local_apply_boundary_face()</code> function. <a class="anchor" id="ExtensiontothelinearizedEulerequations"></a></p><h4>Extension to the linearized Euler equations</h4>
<p>When the interest with an Euler solution is mostly in the propagation of soundwaves, it often makes sense to linearize the Euler equations around abackground state, i.e., a given density, velocity and energy (or pressure)field, and only compute the change against these fields. This is the settingof the wide field of aeroacoustics. Even though the resolution requirementsare sometimes considerably reduced, implementation gets somewhat morecomplicated as the linearization gives rise to additional terms. From a codeperspective, in the operator evaluation we also need to equip the code withthe state to linearize against. This information can be provided either byanalytical functions (that are evaluated in terms of the position of thequadrature points) or by a vector similar to the solution. Based on thatvector, we would create an additional <a class="el" href="classFEEvaluation.html">FEEvaluation</a> object to read from it andprovide the values of the field at quadrature points. If the backgroundvelocity is zero and the density is constant, the linearized Euler equationsfurther simplify and can equivalently be written in the form of theacoustic wave equation. A challenge in the context of sound propagation is often the definition ofboundary conditions, as the computational domain needs to be of finite size,whereas the actual simulation often spans an infinite (or at least muchlarger) physical domain. Conventional Dirichlet or Neumann boundary conditionsgive rise to reflections of the sound waves that eventually propagate back tothe region of interest and spoil the solution. Therefore, various variants ofnon-reflecting boundary conditions or sponge layers, often in the form of<a href="https://en.wikipedia.org/wiki/Perfectly_matched_layer">perfectly matched layers</a></p>
<ul>
<li>where the solution is damped without reflection</li>
<li>are common.</li>
</ul>
<p><a class="anchor" id="ExtensiontothecompressibleNavierStokesequations"></a></p><h4>Extension to the compressible Navier-Stokes equations</h4>
<p>The solver presented in this tutorial program can also be extended to thecompressible Navier&ndash;Stokes equations by adding viscous terms, as described in <b>[FehnWallKronbichler2019]</b> . To keep as much of the performance obtainedhere despite the additional cost of elliptic terms, e.g. via an interiorpenalty method, one can switch the basis from <a class="el" href="classFE__DGQ.html">FE_DGQ</a> to <a class="el" href="classFE__DGQHermite.html">FE_DGQHermite</a> like inthe <a class="el" href="step_59.html">step-59</a> tutorial program.</p>
<p><a class="anchor" id="Usingcellcentricloopsandsharedmemory"></a></p><h4>Using cell-centric loops and shared memory</h4>
<p>In this tutorial, we used face-centric loops. Here, cell and face integralsare treated in separate loops, resulting in multiple writing accesses into theresult vector, which is relatively expensive on modern hardware since writingoperations generally result also in an implicit read operation. Element-centricloops, on the other hand, are processing a cell and in direct successionprocessing all its 2d faces. Although this kind of loop implies that fluxes haveto be computed twice (for each side of an interior face), the fact that theresult vector has to accessed only once might</p>
<ul>
<li>and the fact that the resultingalgorithm is free of race-conditions and as such perfectly suitable forshared memory</li>
<li>already give a performance boost. If you are interested in theseadvanced topics, you can take a look at <a class="el" href="step_76.html">step-76</a> where we take the presenttutorial and modify it so that we can use these features.</li>
</ul>
<p><a class="anchor" id="PlainProg"></a></p><h1>The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/* ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Copyright (C) 2020 - 2021 by the deal.II authors</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This file is part of the deal.II library.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><span class="comment"> * it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><span class="comment"> * Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><span class="comment"> * The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><span class="comment"> * the top level directory of deal.II.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * ---------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Author: Martin Kronbichler, 2020</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2conditional__ostream_8h.html">deal.II/base/conditional_ostream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2function_8h.html">deal.II/base/function.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2logstream_8h.html">deal.II/base/logstream.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2timer_8h.html">deal.II/base/timer.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2time__stepping_8h.html">deal.II/base/time_stepping.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="include_2deal_8II_2base_2utilities_8h.html">deal.II/base/utilities.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="base_2vectorization_8h.html">deal.II/base/vectorization.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="distributed_2tria_8h.html">deal.II/distributed/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="dofs_2dof__handler_8h.html">deal.II/dofs/dof_handler.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__dgq_8h.html">deal.II/fe/fe_dgq.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="fe_2fe__system_8h.html">deal.II/fe/fe_system.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2grid__generator_8h.html">deal.II/grid/grid_generator.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="grid_2tria_8h.html">deal.II/grid/tria.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2affine__constraints_8h.html">deal.II/lac/affine_constraints.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="lac_2la__parallel__vector_8h.html">deal.II/lac/la_parallel_vector.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2fe__evaluation_8h.html">deal.II/matrix_free/fe_evaluation.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2matrix__free_8h.html">deal.II/matrix_free/matrix_free.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="numerics_2data__out_8h.html">deal.II/numerics/data_out.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;fstream&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iomanip&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;iostream&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="matrix__free_2operators_8h.html">deal.II/matrix_free/operators.h</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a></div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>             = 0;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#adc634dce0c07c9dbb94d367c8d97afd3">dimension</a>            = 2;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a> = 3;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>            = 5;</div>
<div class="line">  constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>        = <a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a> + 2;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> = <a class="code" href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a>;</div>
<div class="line"> </div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a>       = 1.4;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a>  = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 10 : 2.0;</div>
<div class="line">  constexpr <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a> = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? 1 : 0.05;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> = 0.15 / <a class="code" href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(<a class="code" href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">fe_degree</a>, 1.5);</div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>, <span class="comment">/* Tselios, Simos, 2007 */</span></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>, <span class="comment">/* Kennedy, Carpenter, Lewis, 2000 */</span></div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a> = <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a></div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>,</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>,</div>
<div class="line">  };</div>
<div class="line">  constexpr <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">EulerNumericalFlux</a> <a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a> = <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span>ExactSolution : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    ExactSolution(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">      : <a class="code" href="classFunction.html">Function</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>)</div>
<div class="line">    {}</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>,</div>
<div class="line">                         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> = 0) <span class="keyword">const override</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="classEuler__DG_1_1ExactSolution.html#a16ae78e70f688acd015b407649997f1b">ExactSolution&lt;dim&gt;::value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; <a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>,</div>
<div class="line">                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> t = this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (testcase)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> x0;</div>
<div class="line">            x0[0] = 5.;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> radius_sqr =</div>
<div class="line">              (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a> - x0).norm_square() - 2. * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - x0[0]) * t + t * t;</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> =</div>
<div class="line">              <a class="code" href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">beta</a> / (<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> * 2) * std::exp(1. - radius_sqr);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> density_log = std::log2(</div>
<div class="line">              std::abs(1. - (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) / <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * 0.25 * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a>));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> = std::exp2(density_log * (1. / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> u       = 1. - <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[1] - x0[1]);</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>       = <a class="code" href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a> * (<a class="code" href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a>[0] - t - x0[0]);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 2)</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> =</div>
<div class="line">                  std::exp2(density_log * (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.)));</div>
<div class="line">                <span class="keywordflow">return</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) +</div>
<div class="line">                       0.5 * (<a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * u * u + <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> * <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 0)</div>
<div class="line">              <span class="keywordflow">return</span> 1.;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == 1)</div>
<div class="line">              <span class="keywordflow">return</span> 0.4;</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a> == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1)</div>
<div class="line">              <span class="keywordflow">return</span> 3.097857142857143;</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              <span class="keywordflow">return</span> 0.;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">          <span class="keywordflow">return</span> 0.;</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">class </span>LowStorageRungeKuttaIntegrator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    LowStorageRungeKuttaIntegrator(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">LowStorageRungeKuttaScheme</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a> lsrk;</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">stage_3_order_3</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">stage_5_order_4</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">stage_7_order_4</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">stage_9_order_5</a>:</div>
<div class="line">            {</div>
<div class="line">              lsrk = <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a>;</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">default</span>:</div>
<div class="line">            <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">        }</div>
<div class="line">      <a class="code" href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a>&lt;</div>
<div class="line">        <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a>&gt;</div>
<div class="line">        rk_integrator(lsrk);</div>
<div class="line">      rk_integrator.get_coefficients(ai, bi, ci);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_stages()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <span class="keywordflow">return</span> bi.size();</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> VectorType, <span class="keyword">typename</span> Operator&gt;</div>
<div class="line">    <span class="keywordtype">void</span> perform_time_step(<span class="keyword">const</span> <a class="code" href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a> &amp;pde_operator,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    current_time,</div>
<div class="line">                           <span class="keyword">const</span> <span class="keywordtype">double</span>    time_step,</div>
<div class="line">                           VectorType &amp;    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                           VectorType &amp;    vec_ri,</div>
<div class="line">                           VectorType &amp;    vec_ki)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">    </span>{</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(ai.size() + 1, bi.size());</div>
<div class="line"> </div>
<div class="line">      pde_operator.perform_stage(current_time,</div>
<div class="line">                                 bi[0] * time_step,</div>
<div class="line">                                 ai[0] * time_step,</div>
<div class="line">                                 <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                 vec_ri,</div>
<div class="line">                                 <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                 vec_ri);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> = 1; <a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> &lt; bi.size(); ++<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>)</div>
<div class="line">        {</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> c_i = ci[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>];</div>
<div class="line">          pde_operator.perform_stage(current_time + c_i * time_step,</div>
<div class="line">                                     bi[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step,</div>
<div class="line">                                     (<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a> == bi.size() - 1 ?</div>
<div class="line">                                        0 :</div>
<div class="line">                                        ai[<a class="code" href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a>] * time_step),</div>
<div class="line">                                     vec_ri,</div>
<div class="line">                                     vec_ki,</div>
<div class="line">                                     <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                     vec_ri);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    std::vector&lt;double&gt; bi;</div>
<div class="line">    std::vector&lt;double&gt; ai;</div>
<div class="line">    std::vector&lt;double&gt; ci;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">euler_velocity</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_density = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / conserved_variables[0];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * inverse_density;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">euler_pressure</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> rho_u_dot_u = conserved_variables[1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[0];</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      rho_u_dot_u += conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> (<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> - 1.) * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] - 0.5 * rho_u_dot_u);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt;</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">euler_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;conserved_variables)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> =</div>
<div class="line">      euler_velocity&lt;dim&gt;(conserved_variables);</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(conserved_variables);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Tensor&lt;1, dim, Number&gt;</a>&gt; <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[0][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>)</div>
<div class="line">          <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = conserved_variables[<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a> + 1] * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] =</div>
<div class="line">          <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * (conserved_variables[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] + <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> n_components, <span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#aec42034f53f838aafe42fb93b273eb92">operator*</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor</a>&lt;1, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a>&gt; &amp;<a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>,</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;                         <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>;</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a></div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">euler_numerical_flux</a>(<span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_m,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, Number&gt;</a> &amp;u_p,</div>
<div class="line">                         <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, Number&gt;</a> &amp;    <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_m = euler_velocity&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> velocity_p = euler_velocity&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_m = euler_pressure&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> pressure_p = euler_pressure&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_m = euler_flux&lt;dim&gt;(u_m);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> flux_p = euler_flux&lt;dim&gt;(u_p);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">numerical_flux_type</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">lax_friedrichs_modified</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a> =</div>
<div class="line">              0.5 * <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(velocity_p.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_p * (1. / u_p[0]),</div>
<div class="line">                                       velocity_m.norm_square() +</div>
<div class="line">                                         <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * pressure_m * (1. / u_m[0])));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> 0.5 * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> + flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) +</div>
<div class="line">                   0.5 * lambda * (u_m - u_p);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> <a class="code" href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">harten_lax_vanleer</a>:</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> avg_velocity_normal =</div>
<div class="line">              0.5 * ((velocity_m + velocity_p) * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span>   avg_c = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(std::abs(</div>
<div class="line">              0.5 * <a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> *</div>
<div class="line">              (pressure_p * (1. / u_p[0]) + pressure_m * (1. / u_m[0]))));</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_pos =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal + avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> s_neg =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(), avg_velocity_normal - avg_c);</div>
<div class="line">            <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> inverse_s = <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>(1.) / (s_pos - s_neg);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> inverse_s *</div>
<div class="line">                   ((s_pos * (flux_m * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>) - s_neg * (flux_p * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>)) -</div>
<div class="line">                    s_pos * s_neg * (u_m - u_p));</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">            <span class="keywordflow">return</span> {};</div>
<div class="line">          }</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number&gt;</div>
<div class="line">  <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a></div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized,</div>
<div class="line">                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>                         <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.value(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keyword">typename</span> Number, <span class="keywordtype">int</span> n_components = dim + 2&gt;</div>
<div class="line">  <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt;</div>
<div class="line">  <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                      <span class="keyword">function</span>,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt; &amp;p_vectorized)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(<span class="keyword">function</span>.<a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>, <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>);</div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, n_components, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = p_vectorized[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = <span class="keyword">function</span>.<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a>(<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keyword">class </span>EulerOperator</div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">static</span> constexpr <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_quadrature_points_1d = n_points_1d;</div>
<div class="line"> </div>
<div class="line">    EulerOperator(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer_output);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_inflow_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">                             std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_subsonic_outflow_boundary(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">      std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_energy);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_wall_boundary(<span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> set_body_force(std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">               <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">               <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    perform_stage(<span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> cur_time,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_solution,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> factor_ai,</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                  <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;next_ri) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a>(<span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">                 <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; compute_errors(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> compute_cell_transport_speed(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span></div>
<div class="line">    initialize_vector(<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer;</div>
<div class="line"> </div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">      inflow_boundaries;</div>
<div class="line">    std::map&lt;types::boundary_id, std::unique_ptr&lt;Function&lt;dim&gt;&gt;&gt;</div>
<div class="line">                                   subsonic_outflow_boundaries;</div>
<div class="line">    std::set&lt;types::boundary_id&gt;   wall_boundaries;</div>
<div class="line">    std::unique_ptr&lt;Function&lt;dim&gt;&gt; body_force;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_inverse_mass_matrix(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_cell(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_face(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> local_apply_boundary_face(</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;                   <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">      <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range) <span class="keyword">const</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerOperator.html#aae07d964990108d9f0b51995835e4a10">EulerOperator&lt;dim, degree, n_points_1d&gt;::EulerOperator</a>(<a class="code" href="classTimerOutput.html">TimerOutput</a> &amp;timer)</div>
<div class="line">    : timer(timer)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">EulerOperator&lt;dim, degree, n_points_1d&gt;::reinit</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;   <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a> &amp;dof_handler)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const DoFHandler&lt;dim&gt; *&gt; dof_handlers = {&amp;dof_handler};</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a>            dummy;</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;const AffineConstraints&lt;double&gt; *&gt; <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a> = {&amp;dummy};</div>
<div class="line">    <span class="keyword">const</span> std::vector&lt;Quadrature&lt;1&gt;&gt; quadratures = {<a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">n_q_points_1d</a>),</div>
<div class="line">                                                    <a class="code" href="classQGauss.html">QGauss&lt;1&gt;</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1)};</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">typename</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData</a> additional_data;</div>
<div class="line">    additional_data.mapping_update_flags =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.mapping_update_flags_inner_faces =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.mapping_update_flags_boundary_faces =</div>
<div class="line">      (<a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div>
<div class="line">       <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div>
<div class="line">    additional_data.tasks_parallel_scheme =</div>
<div class="line">      <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::AdditionalData::none</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.reinit(</div>
<div class="line">      <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handlers, <a class="code" href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a>, quadratures, additional_data);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::initialize_vector(</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.initialize_dof_vector(<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_inflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; inflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as inflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    inflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(inflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_subsonic_outflow_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a>       <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>,</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; outflow_function)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) == wall_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as subsonic outflow&quot;</span>));</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(outflow_function-&gt;n_components == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Expected function with dim+2 components&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    subsonic_outflow_boundaries[<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>] = std::move(outflow_function);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_wall_boundary(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    inflow_boundaries.end() &amp;&amp;</div>
<div class="line">                  subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) ==</div>
<div class="line">                    subsonic_outflow_boundaries.end(),</div>
<div class="line">                <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;You already set the boundary with id &quot;</span> +</div>
<div class="line">                           <a class="code" href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)) +</div>
<div class="line">                           <span class="stringliteral">&quot; to another type of boundary before now setting &quot;</span> +</div>
<div class="line">                           <span class="stringliteral">&quot;it as wall boundary&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    wall_boundaries.insert(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::set_body_force(</div>
<div class="line">    std::unique_ptr&lt;<a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt; body_force)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a>(body_force-&gt;n_components, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>);</div>
<div class="line"> </div>
<div class="line">    this-&gt;body_force = std::move(body_force);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_cell(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; constant_body_force;</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *constant_function =</div>
<div class="line">      <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> *<span class="keyword">&gt;</span>(body_force.get());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (constant_function)</div>
<div class="line">      constant_body_force = evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">        *constant_function, <a class="code" href="classPoint.html">Point</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>, <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a>&gt;());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> w_q = phi.get_value(q);</div>
<div class="line">            phi.submit_gradient(euler_flux&lt;dim&gt;(w_q), q);</div>
<div class="line">            <span class="keywordflow">if</span> (body_force.get() != <span class="keyword">nullptr</span>)</div>
<div class="line">              {</div>
<div class="line">                <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; force =</div>
<div class="line">                  constant_function ? constant_body_force :</div>
<div class="line">                                      evaluate_function&lt;dim, Number, dim&gt;(</div>
<div class="line">                                        *body_force, phi.quadrature_point(q));</div>
<div class="line"> </div>
<div class="line">                <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; forcing;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  forcing[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_q[0] * force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  forcing[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] += force[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * w_q[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1];</div>
<div class="line"> </div>
<div class="line">                phi.submit_value(forcing, q);</div>
<div class="line">              }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(((body_force.get() != <span class="keyword">nullptr</span>) ?</div>
<div class="line">                                 <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a> :</div>
<div class="line">                                 <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea84d99583fd787b7e846f9e4b6f7c97c0">EvaluationFlags::nothing</a>) |</div>
<div class="line">                                <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeadde91684ebb2c6ec5c5c5293123f6a04">EvaluationFlags::gradients</a>,</div>
<div class="line">                              <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_m(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                      <span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi_p(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>,</div>
<div class="line">                                                                      <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi_p.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_p.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        phi_m.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi_m.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_m.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> numerical_flux =</div>
<div class="line">              euler_numerical_flux&lt;dim&gt;(phi_m.get_value(q),</div>
<div class="line">                                        phi_p.get_value(q),</div>
<div class="line">                                        phi_m.get_normal_vector(q));</div>
<div class="line">            phi_m.submit_value(-numerical_flux, q);</div>
<div class="line">            phi_p.submit_value(numerical_flux, q);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        phi_p.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">        phi_m.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_boundary_face(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> = face_range.first; <a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a> &lt; face_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">        phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> w_m    = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a> = phi.get_normal_vector(q);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> rho_u_dot_n = w_m[1] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[0];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              rho_u_dot_n += w_m[1 + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">bool</span> at_outflow = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2, VectorizedArray&lt;Number&gt;</a>&gt; w_p;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a> = <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.get_boundary_id(<a class="code" href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (wall_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) != wall_boundaries.end())</div>
<div class="line">              {</div>
<div class="line">                w_p[0] = w_m[0];</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  w_p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] = w_m[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] - 2. * rho_u_dot_n * <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">                w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = w_m[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1];</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                     inflow_boundaries.end())</div>
<div class="line">              w_p =</div>
<div class="line">                <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(*inflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                                  phi.quadrature_point(q));</div>
<div class="line">            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>) !=</div>
<div class="line">                     subsonic_outflow_boundaries.end())</div>
<div class="line">              {</div>
<div class="line">                w_p          = w_m;</div>
<div class="line">                w_p[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] = <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(</div>
<div class="line">                  *subsonic_outflow_boundaries.find(<a class="code" href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">boundary_id</a>)-&gt;second,</div>
<div class="line">                  phi.quadrature_point(q),</div>
<div class="line">                  <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1);</div>
<div class="line">                at_outflow = <span class="keyword">true</span>;</div>
<div class="line">              }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">              <a class="code" href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a>(<span class="keyword">false</span>,</div>
<div class="line">                          <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(<span class="stringliteral">&quot;Unknown boundary id, did &quot;</span></div>
<div class="line">                                     <span class="stringliteral">&quot;you set a boundary condition for &quot;</span></div>
<div class="line">                                     <span class="stringliteral">&quot;this part of the domain boundary?&quot;</span>));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a> = euler_numerical_flux&lt;dim&gt;(w_m, w_p, <a class="code" href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (at_outflow)</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v &lt; VectorizedArray&lt;Number&gt;::size</a>(); ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keywordflow">if</span> (rho_u_dot_n[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] &lt; -1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                      <a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>] = 0.;</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">            phi.submit_value(-<a class="code" href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a>, q);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>, <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::local_apply_inverse_mass_matrix(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;</a> &amp;,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     cell_range)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = cell_range.first; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; cell_range.second; ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.read_dof_values(src);</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.apply(phi.begin_dof_values(), phi.begin_dof_values());</div>
<div class="line"> </div>
<div class="line">        phi.set_dof_values(<a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">EulerOperator&lt;dim, degree, n_points_1d&gt;::apply</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>                                      current_time,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;src,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - integrals&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">                &amp;EulerOperator::local_apply_face,</div>
<div class="line">                &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">                <span class="keyword">this</span>,</div>
<div class="line">                <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                src,</div>
<div class="line">                <span class="keyword">true</span>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;apply - inverse mass&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(&amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">                     <span class="keyword">this</span>,</div>
<div class="line">                     <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>,</div>
<div class="line">                     <a class="code" href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::perform_stage(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      current_time,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_solution,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>                                      factor_ai,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;current_ri,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      vec_ki,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;      next_ri)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - integrals L_h&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : inflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> : subsonic_outflow_boundaries)</div>
<div class="line">        <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>.second-&gt;set_time(current_time);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.loop(&amp;EulerOperator::local_apply_cell,</div>
<div class="line">                &amp;EulerOperator::local_apply_face,</div>
<div class="line">                &amp;EulerOperator::local_apply_boundary_face,</div>
<div class="line">                <span class="keyword">this</span>,</div>
<div class="line">                vec_ki,</div>
<div class="line">                current_ri,</div>
<div class="line">                <span class="keyword">true</span>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>,</div>
<div class="line">                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, Number&gt;::DataAccessOnFaces::values</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk_stage - inv mass + vec upd&quot;</span>);</div>
<div class="line">      <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.cell_loop(</div>
<div class="line">        &amp;EulerOperator::local_apply_inverse_mass_matrix,</div>
<div class="line">        <span class="keyword">this</span>,</div>
<div class="line">        next_ri,</div>
<div class="line">        vec_ki,</div>
<div class="line">        <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;<span class="keywordtype">void</span>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)&gt;(),</div>
<div class="line">        [&amp;](<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> start_range, <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> end_range) {</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> ai = factor_ai;</div>
<div class="line">          <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> bi = factor_solution;</div>
<div class="line">          <span class="keywordflow">if</span> (ai == <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>())</div>
<div class="line">            {</div>
<div class="line">              <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi * k_i;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">              <span class="comment">/* DEAL_II_OPENMP_SIMD_PRAGMA */</span></div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = start_range; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; end_range; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">                {</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> k_i          = next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <span class="keyword">const</span> <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a> sol_i        = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line">                  <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.local_element(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>) = sol_i + bi * k_i;</div>
<div class="line">                  next_ri.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">local_element</a>(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)  = sol_i + ai * k_i;</div>
<div class="line">                }</div>
<div class="line">            }</div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">EulerOperator&lt;dim, degree, n_points_1d&gt;::project</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                       <span class="keyword">function</span>,</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line">    <a class="code" href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix&lt;dim, degree, dim + 2, Number&gt;</a></div>
<div class="line">      <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>(phi);</div>
<div class="line">    <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>.zero_out_ghost_values();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          phi.submit_dof_value(<a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>,</div>
<div class="line">                                                 phi.quadrature_point(q)),</div>
<div class="line">                               q);</div>
<div class="line">        <a class="code" href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a>.transform_from_q_points_to_basis(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2,</div>
<div class="line">                                                 phi.begin_dof_values(),</div>
<div class="line">                                                 phi.begin_dof_values());</div>
<div class="line">        phi.set_dof_values(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  std::array&lt;double, 3&gt; EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_errors(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a> &amp;                             <span class="keyword">function</span>,</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute errors&quot;</span>);</div>
<div class="line">    <span class="keywordtype">double</span>             errors_squared[3] = {};</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, n_points_1d, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_errors_squared[3] = {};</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a> =</div>
<div class="line">              <a class="code" href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">evaluate_function</a>(<span class="keyword">function</span>, phi.quadrature_point(q)) -</div>
<div class="line">              phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a> = phi.JxW(q);</div>
<div class="line"> </div>
<div class="line">            local_errors_squared[0] += <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[0] * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              local_errors_squared[1] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">            local_errors_squared[2] += (<a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1] * <a class="code" href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a>[<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1]) * <a class="code" href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a>;</div>
<div class="line">          }</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] += local_errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>][<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>];</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a>(errors_squared, MPI_COMM_WORLD, errors_squared);</div>
<div class="line"> </div>
<div class="line">    std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(errors_squared[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> degree, <span class="keywordtype">int</span> n_po<span class="keywordtype">int</span>s_1d&gt;</div>
<div class="line">  <span class="keywordtype">double</span> EulerOperator&lt;dim, degree, n_points_1d&gt;::compute_cell_transport_speed(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> &amp;<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;compute transport speed&quot;</span>);</div>
<div class="line">    <a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>             max_transport = 0;</div>
<div class="line">    <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, degree, degree + 1, dim + 2, Number&gt;</a> phi(<a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>, 0, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> = 0; <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_cell_batches(); ++<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>)</div>
<div class="line">      {</div>
<div class="line">        phi.reinit(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">        phi.gather_evaluate(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a>);</div>
<div class="line">        <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> local_max = 0.;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div>
<div class="line">          {</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a> = phi.get_value(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> inverse_jacobian = phi.inverse_jacobian(q);</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> convective_speed = inverse_jacobian * <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>;</div>
<div class="line">            <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> convective_limit = 0.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              convective_limit =</div>
<div class="line">                <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(convective_limit, std::abs(convective_speed[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> speed_of_sound =</div>
<div class="line">              <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> * (1. / <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0]));</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classTensor.html">Tensor&lt;1, dim, VectorizedArray&lt;Number&gt;</a>&gt; <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 1.;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; 5; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line">              {</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> = <a class="code" href="chunk__sparse__matrix__0_8txt.html#ad43ded305d7756c82052fec150fdf5dd">transpose</a>(inverse_jacobian) *</div>
<div class="line">                              (inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>);</div>
<div class="line">                <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;Number&gt;</a> eigenvector_norm = 0.;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">                  eigenvector_norm =</div>
<div class="line">                    <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(eigenvector_norm, std::abs(<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>]));</div>
<div class="line">                <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> /= eigenvector_norm;</div>
<div class="line">              }</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> jac_times_ev   = inverse_jacobian * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>;</div>
<div class="line">            <span class="keyword">const</span> <span class="keyword">auto</span> max_eigenvalue = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(</div>
<div class="line">              (jac_times_ev * jac_times_ev) / (<a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a> * <a class="code" href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a>));</div>
<div class="line">            local_max =</div>
<div class="line">              <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(local_max,</div>
<div class="line">                       max_eigenvalue * speed_of_sound + convective_limit);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> = 0; <a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a> &lt; <a class="code" href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a>.n_active_entries_per_cell_batch(<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>);</div>
<div class="line">             ++<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; 3; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            max_transport = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::max</a>(max_transport, local_max[<a class="code" href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a>]);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    max_transport = <a class="code" href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a>(max_transport, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> max_transport;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keyword">class </span><a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a></div>
<div class="line">  {</div>
<div class="line">  <span class="keyword">public</span>:</div>
<div class="line">    <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keywordtype">void</span> make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classConditionalOStream.html">ConditionalOStream</a> pcout;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef DEAL_II_WITH_P4EST</span></div>
<div class="line">    <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFESystem.html">FESystem&lt;dim&gt;</a>        <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>;</div>
<div class="line">    <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>;</div>
<div class="line">    <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>      dof_handler;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div>
<div class="line"> </div>
<div class="line">    EulerOperator&lt;dim, fe_degree, n_q_points_1d&gt; euler_operator;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>, time_step;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>Postprocessor : <span class="keyword">public</span> <a class="code" href="classDataPostprocessor.html">DataPostprocessor</a>&lt;dim&gt;</div>
<div class="line">    {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">      Postprocessor();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> evaluate_vector_field(</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">        <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;computed_quantities) <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div>
<div class="line">      get_data_component_interpretation() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">virtual</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a>() <span class="keyword">const override</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">bool</span> do_schlieren_plot;</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::Postprocessor</a>()</div>
<div class="line">    : do_schlieren_plot(<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::evaluate_vector_field</a>(</div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector&lt;dim&gt;</a> &amp;inputs,</div>
<div class="line">    <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="classVector.html">Vector&lt;double&gt;</a>&gt; &amp;               computed_quantities)<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_evaluation_points = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>.size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>.size() == n_evaluation_points,</div>
<div class="line">             <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities.size() == n_evaluation_points,</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[0].size() == <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line">    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(computed_quantities[0].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>() ==</div>
<div class="line">             <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2 + (do_schlieren_plot == <span class="keyword">true</span> ? 1 : 0),</div>
<div class="line">           <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_evaluation_points; ++q)</div>
<div class="line">      {</div>
<div class="line">        <a class="code" href="classTensor.html">Tensor&lt;1, dim + 2&gt;</a> <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">solution_values</a>[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>  = <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>[0];</div>
<div class="line">        <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a> = euler_velocity&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span>         <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> = euler_pressure&lt;dim&gt;(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>) = <a class="code" href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a>[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>];</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>)     = <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a>;</div>
<div class="line">        computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 1) = <a class="code" href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">std::sqrt</a>(<a class="code" href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">gamma</a> * <a class="code" href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a> / <a class="code" href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">density</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">          computed_quantities[q](<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) =</div>
<div class="line">            inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0] * inputs.<a class="code" href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">solution_gradients</a>[q][0];</div>
<div class="line">      }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;std::string&gt; <a class="code" href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">EulerProblem&lt;dim&gt;::Postprocessor::get_names</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;velocity&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;pressure&quot;</span>);</div>
<div class="line">    <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;speed_of_sound&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;schlieren_plot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::Postprocessor::get_data_component_interpretation</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">      interpretation;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">    interpretation.push_back(<a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      interpretation.push_back(</div>
<div class="line">        <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> interpretation;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> <a class="code" href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">EulerProblem&lt;dim&gt;::Postprocessor::get_needed_update_flags</a>()<span class="keyword"> const</span></div>
<div class="line"><span class="keyword">  </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (do_schlieren_plot == <span class="keyword">true</span>)</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::EulerProblem</a>()</div>
<div class="line">    : pcout(std::cout, <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a>::<a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">this_mpi_process</a>(MPI_COMM_WORLD) == 0)</div>
<div class="line">#ifdef DEAL_II_WITH_P4EST</div>
<div class="line">    , <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>(MPI_COMM_WORLD)</div>
<div class="line">#endif</div>
<div class="line">    , <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>&gt;(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>), <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2)</div>
<div class="line">    , <a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a>)</div>
<div class="line">    , dof_handler(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>)</div>
<div class="line">    , timer(pcout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div>
<div class="line">    , euler_operator(timer)</div>
<div class="line">    , <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>(0)</div>
<div class="line">    , time_step(0)</div>
<div class="line">  {}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::make_grid_and_dofs</a>()</div>
<div class="line">  {</div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a>)</div>
<div class="line">      {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> lower_left;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              lower_left[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = -5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> upper_right;</div>
<div class="line">            upper_right[0] = 10;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 1; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">              upper_right[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>] = 5;</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a>(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>,</div>
<div class="line">                                           lower_left,</div>
<div class="line">                                           upper_right);</div>
<div class="line">            <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(2);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          {</div>
<div class="line">            <a class="code" href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a>(</div>
<div class="line">              <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>, 0.03, 1, 0, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_inflow_boundary(</div>
<div class="line">              0, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line">            euler_operator.set_subsonic_outflow_boundary(</div>
<div class="line">              1, std::make_unique&lt;ExactSolution&lt;dim&gt;&gt;(0));</div>
<div class="line"> </div>
<div class="line">            euler_operator.set_wall_boundary(2);</div>
<div class="line">            euler_operator.set_wall_boundary(3);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 3)</div>
<div class="line">              euler_operator.set_body_force(</div>
<div class="line">                std::make_unique&lt;<a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a>&gt;(</div>
<div class="line">                  std::vector&lt;double&gt;({0., 0., -0.2})));</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.refine_global(<a class="code" href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">n_global_refinements</a>);</div>
<div class="line"> </div>
<div class="line">    dof_handler.<a class="code" href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">distribute_dofs</a>(<a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.reinit(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>, dof_handler);</div>
<div class="line">    euler_operator.initialize_vector(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    std::locale <a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a> = pcout.get_stream().getloc();</div>
<div class="line">    pcout.get_stream().imbue(std::locale(<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.<a class="code" href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">n_dofs</a>()</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot; ( = &quot;</span> &lt;&lt; (<a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> + 2) &lt;&lt; <span class="stringliteral">&quot; [vars] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_global_active_cells() &lt;&lt; <span class="stringliteral">&quot; [cells] x &quot;</span></div>
<div class="line">          &lt;&lt; <a class="code" href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a>(<a class="code" href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a> + 1, <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>) &lt;&lt; <span class="stringliteral">&quot; [dofs/cell/var] )&quot;</span></div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line">    pcout.get_stream().imbue(<a class="code" href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dim&gt;::output_results</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> result_number)</div>
<div class="line">  {</div>
<div class="line">    <span class="keyword">const</span> std::array&lt;double, 3&gt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a> =</div>
<div class="line">      euler_operator.compute_errors(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    <span class="keyword">const</span> std::string quantity_name = <a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 ? <span class="stringliteral">&quot;error&quot;</span> : <span class="stringliteral">&quot;norm&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time:&quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(3) &lt;&lt; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, dt: &quot;</span> &lt;&lt; std::setw(8) &lt;&lt; std::setprecision(2) &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; quantity_name &lt;&lt; <span class="stringliteral">&quot; rho: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[0] &lt;&lt; <span class="stringliteral">&quot;, rho * u: &quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[1] &lt;&lt; <span class="stringliteral">&quot;, energy:&quot;</span> &lt;&lt; std::setprecision(4)</div>
<div class="line">          &lt;&lt; std::setw(10) &lt;&lt; <a class="code" href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a>[2] &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;output&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      Postprocessor <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>;</div>
<div class="line">      <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a>  data_out;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>;</div>
<div class="line">      <a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>.write_higher_order_cells = <span class="keyword">true</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(<a class="code" href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div>
<div class="line">      {</div>
<div class="line">        std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;density&quot;</span>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;momentum&quot;</span>);</div>
<div class="line">        <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">          interpretation;</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">        interpretation.push_back(</div>
<div class="line">          <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">        data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>, interpretation);</div>
<div class="line">      }</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>, <a class="code" href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">testcase</a> == 0 &amp;&amp; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a> == 2)</div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.reinit(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>);</div>
<div class="line">          <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>.sadd(-1., 1, <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">          std::vector&lt;std::string&gt; <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>;</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_density&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_momentum&quot;</span>);</div>
<div class="line">          <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>.emplace_back(<span class="stringliteral">&quot;error_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;DataComponentInterpretation::DataComponentInterpretation&gt;</div>
<div class="line">            interpretation;</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a> &lt; <a class="code" href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">d</a>)</div>
<div class="line">            interpretation.push_back(</div>
<div class="line">              <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a>);</div>
<div class="line">          interpretation.push_back(</div>
<div class="line">            <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a>);</div>
<div class="line"> </div>
<div class="line">          data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler,</div>
<div class="line">                                   <a class="code" href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a>,</div>
<div class="line">                                   <a class="code" href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a>,</div>
<div class="line">                                   interpretation);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classVector.html">Vector&lt;double&gt;</a> mpi_owner(<a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.n_active_cells());</div>
<div class="line">      mpi_owner = <a class="code" href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a>(MPI_COMM_WORLD);</div>
<div class="line">      data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(mpi_owner, <span class="stringliteral">&quot;owner&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(<a class="code" href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a>,</div>
<div class="line">                             <a class="code" href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a>.<a class="code" href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">degree</a>,</div>
<div class="line">                             <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> std::string filename =</div>
<div class="line">        <span class="stringliteral">&quot;solution_&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(result_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div>
<div class="line">      data_out.<a class="code" href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">write_vtu_in_parallel</a>(filename, MPI_COMM_WORLD);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">EulerProblem&lt;dim&gt;::run</a>()</div>
<div class="line">  {</div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_number = <a class="code" href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArray&lt;Number&gt;::size</a>();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_vect_bits   = 8 * <span class="keyword">sizeof</span>(<a class="code" href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Number</a>) * n_vect_number;</div>
<div class="line"> </div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Running with &quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a>(MPI_COMM_WORLD)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; MPI processes&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">      pcout &lt;&lt; <span class="stringliteral">&quot;Vectorization over &quot;</span> &lt;&lt; n_vect_number &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">            &lt;&lt; (<a class="code" href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">std::is_same&lt;Number, double&gt;::value</a> ? <span class="stringliteral">&quot;doubles&quot;</span> : <span class="stringliteral">&quot;floats&quot;</span>)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot; = &quot;</span> &lt;&lt; n_vect_bits &lt;&lt; <span class="stringliteral">&quot; bits (&quot;</span></div>
<div class="line">            &lt;&lt; <a class="code" href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span></div>
<div class="line">            &lt;&lt; std::endl;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    make_grid_and_dofs();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> LowStorageRungeKuttaIntegrator integrator(<a class="code" href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">lsrk_scheme</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_1;</div>
<div class="line">    <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;Number&gt;</a> rk_register_2;</div>
<div class="line">    rk_register_1.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    rk_register_2.<a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">reinit</a>(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    euler_operator.project(ExactSolution&lt;dim&gt;(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>), <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> min_vertex_distance = <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">std::numeric_limits&lt;double&gt;::max</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a> : <a class="code" href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a>.active_cell_iterators())</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;is_locally_owned())</div>
<div class="line">        min_vertex_distance =</div>
<div class="line">          <a class="code" href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">std::min</a>(min_vertex_distance, <a class="code" href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a>-&gt;minimum_vertex_distance());</div>
<div class="line">    min_vertex_distance =</div>
<div class="line">      <a class="code" href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a>(min_vertex_distance, MPI_COMM_WORLD);</div>
<div class="line"> </div>
<div class="line">    time_step = <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">                euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>);</div>
<div class="line">    pcout &lt;&lt; <span class="stringliteral">&quot;Time step size: &quot;</span> &lt;&lt; time_step</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, minimal h: &quot;</span> &lt;&lt; min_vertex_distance</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;, initial transport scaling: &quot;</span></div>
<div class="line">          &lt;&lt; 1. / euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>)</div>
<div class="line">          &lt;&lt; std::endl</div>
<div class="line">          &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">    output_results(0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timestep_number = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &lt; <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">      {</div>
<div class="line">        ++timestep_number;</div>
<div class="line">        <span class="keywordflow">if</span> (timestep_number % 5 == 0)</div>
<div class="line">          time_step =</div>
<div class="line">            <a class="code" href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">courant_number</a> * integrator.n_stages() /</div>
<div class="line">            <a class="code" href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a>(</div>
<div class="line">              euler_operator.compute_cell_transport_speed(<a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>), 3);</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line">          <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> t(timer, <span class="stringliteral">&quot;rk time stepping total&quot;</span>);</div>
<div class="line">          integrator.perform_time_step(euler_operator,</div>
<div class="line">                                       <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a>,</div>
<div class="line">                                       time_step,</div>
<div class="line">                                       <a class="code" href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a>,</div>
<div class="line">                                       rk_register_1,</div>
<div class="line">                                       rk_register_2);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> += time_step;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) !=</div>
<div class="line">              <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> - time_step) / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>) ||</div>
<div class="line">            <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> &gt;= <a class="code" href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">final_time</a> - 1<a class="code" href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a>-12)</div>
<div class="line">          output_results(</div>
<div class="line">            <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(<a class="code" href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">std::round</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a> / <a class="code" href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">output_tick</a>)));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    timer.print_wall_time_statistics(MPI_COMM_WORLD);</div>
<div class="line">    pcout &lt;&lt; std::endl;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace Euler_DG</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)</div>
<div class="line">{</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespaceEuler__DG.html">Euler_DG</a>;</div>
<div class="line">  <span class="keyword">using namespace </span><a class="code" href="namespacedealii.html">dealii</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a> mpi_initialization(argc, argv, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a>.<a class="code" href="classLogStream.html#a8028e970ad8388596d625ed463894e98">depth_console</a>(0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classEuler__DG_1_1EulerProblem.html">EulerProblem&lt;dimension&gt;</a> euler_problem;</div>
<div class="line">      euler_problem.run();</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (<a class="code" href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">std::exception</a> &amp;exc)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; exc.what() &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line">  <span class="keywordflow">catch</span> (...)</div>
<div class="line">    {</div>
<div class="line">      std::cerr &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div>
<div class="line">                &lt;&lt; std::endl;</div>
<div class="line">      <span class="keywordflow">return</span> 1;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> <br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="anamespaceEuler__DG_html_a2629567e63f50a5312110be969de47ea"><div class="ttname"><a href="namespaceEuler__DG.html#a2629567e63f50a5312110be969de47ea">Euler_DG::numerical_flux_type</a></div><div class="ttdeci">constexpr EulerNumericalFlux numerical_flux_type</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00085">step-67.cc:85</a></div></div>
<div class="ttc" id="asparse__vanka__0_8txt_html_a63f572a3b5d8c173a82cee16f5858977"><div class="ttname"><a href="sparse__vanka__0_8txt.html#a63f572a3b5d8c173a82cee16f5858977">dst</a></div><div class="ttdeci">this elimination is done by the modification of the right hand and in the end these degrees of freedom do not occur in the matrix and solution vector any more at all *This system is solved and the values are updated into the destination vector the matrices are built up such that the degree of freedom associated with the Lagrange multiplier is the first one usually the upper left entry in the matrix is zero It is not clear to so it must persist longer than the Vanka object The same is true for the matrix The matrix[2.x.11] which is passed here may or may not be the same matrix for which this object shall act as preconditioner In it is conceivable that the preconditioner is build up for one matrix but is used for subsequent steps in a nonlinear process as where the matrix changes in each step slightly **Destructor Delete all allocated matrices **Parameters for SparseVanka **Constructor For the parameters see below **Constructor For the parameters see below[2.x.12] The use of this constructor is deprecated **the second and third parameters are ignored **Indices of those degrees of freedom that we shall work on **If the default constructor is used then this function needs to be called before an object of this class is used as preconditioner For more detail about possible parameters see the class documentation and the documentation of the[2.x.13] class After this function is called the preconditioner is ready to be only values for allowed indices are written to[2.x.27] dst</div><div class="ttdef"><b>Definition:</b> <a href="sparse__vanka__0_8txt_source.html#l00060">sparse_vanka_0.txt:60</a></div></div>
<div class="ttc" id="aclassEuler__DG_1_1EulerProblem_html"><div class="ttname"><a href="classEuler__DG_1_1EulerProblem.html">Euler_DG::EulerProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l01041">step-67.cc:1041</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a0900f35b37ee122e73fb2c80bba9beb9"><div class="ttname"><a href="namespaceUtilities.html#a0900f35b37ee122e73fb2c80bba9beb9">Utilities::pow</a></div><div class="ttdeci">constexpr T pow(const T base, const int iexp)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2utilities_8h_source.html#l00464">utilities.h:464</a></div></div>
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="afe_2fe__dgq_8h_html"><div class="ttname"><a href="fe_2fe__dgq_8h.html">fe_dgq.h</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out__dof__data_8h_source.html#l01096">data_out_dof_data.h:1096</a></div></div>
<div class="ttc" id="adistributed_2tria__0_8txt_html_a372359e6a4e93d0a8d5d7c53a24c5ba0"><div class="ttname"><a href="distributed_2tria__0_8txt.html#a372359e6a4e93d0a8d5d7c53a24c5ba0">stage</a></div><div class="ttdeci">this function joins faces in the p4est forest for periodic boundary conditions As a result each pair of faces will differ by at most one refinement level and ghost neighbors will be available across these faces The vector can be filled by the function[2.x.67] For more information on periodic boundary conditions see[2.x.68][2.x.69] and *[2.x.70] Before this function can be used the Triangulation has to be initialized and must not be refined Calling this function more than once is but not this data structure holds the connectivity between the cells of the coarse grid **A data structure that holds the part of the global triangulation **A data structure that holds some information about the ghost cells of the triangulation **Go through all p4est trees and record the relations between locally owned p4est quadrants and active deal II cells in the private member vector local_cell_relations The vector contains an active cell iterator for every locally owned p4est as well as a CellStatus flag to describe their relation The stored vector will be ordered by the occurrence of quadrants in the corresponding sc_array of the parallel_forest p4est requires this specific ordering for its transfer functions the size of this vector will be equal to the number of locally owned quadrants in the parallel_forest object These relations will be established for example in the mesh refinement but before applying these changes to this we will record how cells will change in the refinement process With this we can prepare all buffers for data transfer accordingly **Two arrays that store which p4est tree corresponds to which coarse grid cell and vice versa We need these arrays because p4est goes with the original order of coarse cells when it sets up its and then applies the Morton ordering within each tree But if coarse grid cells are badly ordered this may mean that individual parts of the forest stored on a machine may be split across coarse grid cells that are not geometrically close we apply a hierarchical preordering according to[2.x.72] to ensure that the part of the forest stored by p4est is located on geometrically close coarse grid cells **Return a pointer to the p4est tree that belongs to the given because the triangulation is not updated yet The weights are sorted in the order that p4est will encounter them while iterating over them **This method returns a bit vector of length tria i the vertices touched by the locally owned level cells for use in geometric all this class does is throw an exception **dummy settings **Constructor The argument denotes the MPI communicator to be used for the triangulation **Destructor **Return a permutation vector for the order the coarse cells are handed of to p4est For example the first element i in this vector denotes that the first cell in hierarchical ordering is the ith deal cell starting from but needs to be present for the compiler **This function is not but needs to be present for the compiler **This function is not but needs to be present for the compiler **This function is not but needs to be present for the compiler **Dummy arrays This class isn t usable but the compiler wants to see these variables at a couple places anyway **This which is only implemented for needs a stub because it is used in dof_handler_policy cc **Like this which is only implemented for needs a stub because it is used in dof_handler_policy cc **Dummy class the compiler chooses for parallel distributed triangulations if we didn t actually configure deal II with the p4est library The existence of this class allows us to refer to[2.x.75] objects throughout the library even if it is disabled Since the constructor of this class is deleted no such objects can actually be created as this would be pointless given that p4est is not available **Dummy settings to allow defining the deleted constructor **Constructor Deleted to make sure that objects of this type cannot be and persists for the lifetime of an instantiation of this class The TemporarilyMatchRefineFlags class should only be used in combination with the[2.x.77] signal At this stage</div><div class="ttdef"><b>Definition:</b> <a href="distributed_2tria__0_8txt_source.html#l00144">tria_0.txt:144</a></div></div>
<div class="ttc" id="anamespaceStep31_1_1EquationData_html_aa1e9e1a7297b10cb39c2065f86acc66f"><div class="ttname"><a href="namespaceStep31_1_1EquationData.html#aa1e9e1a7297b10cb39c2065f86acc66f">Step31::EquationData::density</a></div><div class="ttdeci">constexpr double density</div><div class="ttdef"><b>Definition:</b> <a href="step-31_8cc_source.html#l00075">step-31.cc:75</a></div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a9c19e2f34c53e5e4662b0fa119e2c99d"><div class="ttname"><a href="constraints__0_8txt.html#a9c19e2f34c53e5e4662b0fa119e2c99d">flux</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal flux</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="aclassDataPostprocessor_html"><div class="ttname"><a href="classDataPostprocessor.html">DataPostprocessor</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00477">data_postprocessor.h:477</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_aa2b5a089b26d5eb6842e77a0320440b0"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#aa2b5a089b26d5eb6842e77a0320440b0">error</a></div><div class="ttdeci">precision How many digits to use when writing the error</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00041">parsed_convergence_table_0.txt:41</a></div></div>
<div class="ttc" id="amapping__q1__0_8txt_html_a45d517f8f46ad2c69e32a4cf382e3883"><div class="ttname"><a href="mapping__q1__0_8txt.html#a45d517f8f46ad2c69e32a4cf382e3883">reference</a></div><div class="ttdeci">*Implementation of a[2.x.0] linear mapping from the reference cell to a general quadrilateral hexahedron *The mapping implemented by this class maps the reference(unit) cell to a general grid cell with straight lines in[2.x.1] dimensions.(Note</div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdeci">@ update_gradients</div><div class="ttdoc">Shape function gradients.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00077">fe_update_flags.h:77</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_afec1b694405cadb2d251275096ad3563"><div class="ttname"><a href="distributed__0_8txt.html#afec1b694405cadb2d251275096ad3563">output</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data output</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="aclassFE__DGQ_html"><div class="ttname"><a href="classFE__DGQ.html">FE_DGQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__dgq_8h_source.html#l00105">fe_dgq.h:105</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ad207fe81a5be05e18534713c2677da7b"><div class="ttname"><a href="distributed__0_8txt.html#ad207fe81a5be05e18534713c2677da7b">dofs</a></div><div class="ttdeci">if we even only hold bytes per line in this sparsity we ll need GB for this object even if every single line is empty Of only million lines will be non for which we need MB plus whatever is necessary to store the actual column indices of nonzero entries Let s say we have a moderately complex problem with entries per for each of which we store the column index worth then we ll need bytes for each of the million lines that correspond to the degrees of freedom we for a total of GB And we ll need bytes for each of the million lines that we don t for a total of GB It is clear that this ratio doesn t become any better if we go to even higher numbers of processors *The solution to this problem is to really only use any memory at all for those parts of the linear system that we or need for some other reason For all other we must know that they but we can not set up any part of our data structure To this there exists a class called IndexSet that denotes a set of indices which we care for and for which we may have to allocate memory The data structures for sparsity patterns constraint matrices matrices and vector can be initialized with these IndexSet objects to really only care for those rows or entries that correspond to indices in the index set and not care about all others These objects will then ask how many indices exist in the set allocate memory for each one of and when you want to access data for global degree of freedom[2.x.28] you will be redirected to the result of calling[2.x.29] with index[2.x.30] instead Accessing data for elements[2.x.31] for which[2.x.32] is false will yield an error *The remaining question is how to identify the set of indices that correspond to degrees of freedom we need to worry about on each processor To this you can use the[2.x.33] function to get at all the indices a processor owns Note that this is a subset of the degrees of freedom that are defined on the locally owned one sometimes needs the set of all degrees of freedom on the locally owned subdomain as well as the adjacent ghost cells This information is provided by the[2.x.35] function ***A typical parallel application is dealing with two different kinds of parallel but there are of course different vector types that can each represent both ghosted vectors are typically used for data error input in integration This is because in these one typically needs access not only to[2.x.39] locally owned dofs but also to[2.x.40] locally active dofs and sometimes to[2.x.41] locally relevant dofs</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00059">distributed_0.txt:59</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_a76bc1cc7649cc416723f450d24fdd91d"><div class="ttname"><a href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">Utilities::System::get_time</a></div><div class="ttdeci">std::string get_time()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l01019">utilities.cc:1019</a></div></div>
<div class="ttc" id="ahdf5__0_8txt_html_aae153b86de45d3354cd3edd5b992435e"><div class="ttname"><a href="hdf5__0_8txt.html#aae153b86de45d3354cd3edd5b992435e">double</a></div><div class="ttdeci">*Namespace containing deal II s HDF5 interface whereas writing and reading raw data in a dataset can be done independently or double</div><div class="ttdef"><b>Definition:</b> <a href="hdf5__0_8txt_source.html#l00045">hdf5_0.txt:45</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_af35ca33203cd802325d779be7b6b41e8"><div class="ttname"><a href="multithreading__0_8txt.html#af35ca33203cd802325d779be7b6b41e8">with</a></div><div class="ttdeci">namespace are implemented the way they are More information on their implementation can be found in the[2.x.72] WorkStream paper To see the WorkStream class used in practice on tasks like the ones outlined above take a look at or[2.x.78] tutorial programs *To begin with</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00139">multithreading_0.txt:139</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4">TimeStepping::runge_kutta_method</a></div><div class="ttdeci">runge_kutta_method</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00277">time_stepping.h:277</a></div></div>
<div class="ttc" id="aclassTimerOutput_1_1Scope_html"><div class="ttname"><a href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2timer_8h_source.html#l00600">timer.h:600</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_a8fba07b9a84b89e6be225f5f95c3e355"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#a8fba07b9a84b89e6be225f5f95c3e355">run</a></div><div class="ttdeci">the program is just and one can not intelligently work around that *It is sometimes useful to change the behavior of the[2.x.6] macro from aborting a program to throwing exceptions On the other exceptions are not allowed to propagate out of destructors of classes For this there is a variant of the called[2.x.7] that can be used in destructors These use cases are discussed further down below on this page **Dynamic such as whether an output file can be written to *These are things that shouldn t be checked because it is not guaranteed that a program for which the condition is satisfied in a debug mode run</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00022">exceptions_0.txt:22</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html_a904b46a59d224ec214e4816e584cba5f"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html#a904b46a59d224ec214e4816e584cba5f">DataPostprocessorInputs::Vector::solution_values</a></div><div class="ttdeci">std::vector&lt;::Vector&lt; double &gt; &gt; solution_values</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00330">data_postprocessor.h:330</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a2e990f30e4c3b71e80e78084f073ca9b"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a2e990f30e4c3b71e80e78084f073ca9b">names</a></div><div class="ttdeci">****This class simplifies the construction of convergence tables reading the options for the generation of the table from a parameter file It provides a series of methods that can be used to compute the error given a reference exact solution or the difference between two numerical solutions or any other custom computation of the error given via[2.x.1] objects *An example usage of this class is given by ****The above code constructs a ParsedConvergenceTable that works for scalar and will produce an error table with and Linfty_norm norms of the error *Whenever a call to the methods the instance of this class inspects its parameters computes all norms specified by the parameter given at construction time possibly modified via a parameter file computes all extra column entries specified using the method and writes one row of the convergence table *Once you have finished with the a call to and to the the same code can be used to estimate the errors of mixed or multi physics e and one component for the pressure field and will produce an error table with H1 and L2 norm of the error in the velocity to write the table only to the file specified in the parameter file *By calling the method the following options will be defined in the given ParameterHandler and can be modified at run time through a parameter please cite ******Minimal constructor for ParsedConvergenceTable objects The number of components must match the number of components of the finite element space that is used to compute the errors If a component name is than it is interpreted as a vector and the errors of the repeated components are grouped together The size of the vector[2.x.3] must match the number of unique component names</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00035">parsed_convergence_table_0.txt:35</a></div></div>
<div class="ttc" id="anamespacedealii_html"><div class="ttname"><a href="namespacedealii.html">dealii</a></div><div class="ttdef"><b>Definition:</b> <a href="doc_2doxygen_2headers_2namespace__dealii_8h_source.html#l00026">namespace_dealii.h:26</a></div></div>
<div class="ttc" id="amatrix__free_2dof__info__0_8txt_html_afc846d40941f6f9934e92e469096f30f"><div class="ttname"><a href="matrix__free_2dof__info__0_8txt.html#afc846d40941f6f9934e92e469096f30f">n_components</a></div><div class="ttdeci">We set the granularity to **that is a number sufficiently large to minimize loop peel overhead within the this function always returns index If an index is not found in hp it returns *[2.x.2] *Populate the vector[2.x.3] with locally owned degrees of freedom stored on the cell block[2.x.4] If[2.x.5] is then the returned vector will contain indices required to resolve constraints The image below illustrates the output of this function for cell blocks zero and one with zero Dirichlet boundary conditions at the bottom of the domain Note that due to the presence of the DoFs returned by this function for the case i indices that are located on another get a temporary number by this and will later be assigned the correct index after all the ghost indices have been collected by the call to *[2.x.12] *This method assigns the correct indices to ghost indices from the temporary numbering employed by the[2.x.13] function The numbers are localized with respect to the MPI and ghosts start at the end of the locally owned range This we get direct access to all vector entries **This method reorders the way cells are gone through based on a given renumbering of the cells It also takes[2.x.14] cells together and interprets them as one cell as is needed for vectorization **Finds possible compression for the cell indices that we can apply for increased efficiency Run at the end of reorder_cells **Finds possible compression for the face indices that we can apply for increased efficiency Run at the end of reorder_cells **This function computes the connectivity of the currently stored indices in terms of connections between the individual cells and fills the structure into a sparsity pattern **In case face integrals are find out whether certain loops over the unknowns only access a subset of all the ghost dofs we keep in the main partitioner **Given[2.x.15] containing the index of cells of macro the index ordering can be improved for typical DG elements by interleaving the degrees of freedom from batches of which avoids the data transposition in[2.x.16] these more advanced features are not so there is only limited value of this function **Fills the array that defines how to zero selected ranges in the result vector within the cell filling the two member variables[2.x.17] vector_zero_range_list_index and[2.x.18] The intent of this pattern is to zero the vector entries in close temporal proximity to the first access and thus keeping the vector entries in cache **Return the memory consumption in bytes of this class **Prints a detailed summary of memory consumption in the different structures of this class to the given output stream **Prints a representation of the indices in the class to the given output stream **Enum for various storage variants of the indices This storage format is used to implement more efficient indexing schemes in case the underlying data structures allow for and to inform the access functions in[2.x.19] on which array to get the data from One example of more efficient storage is the enum value[2.x.20] which means that one can get the indices to all degrees of freedom of a cell by reading only the first index for each whereas all subsequent indices are merely an offset from the first index **This value indicates that no index compression was found and the only valid storage is to access all indices present on the possibly including constraints For a cell face of this index the data access in FEEvaluationBase is directed to the array[2.x.21] dof_indices with the index row_starts[cell_index *n_vectorization *n_components] first **This value indicates that the indices are interleaved for access with vectorized gather and scatter operation This storage variant is possible in case there are no constraints on the cell and the indices in the batch of cells are not pointing to the same global index in different slots of a vectorized the data access in FEEvaluationBase is directed to the array dof_indices_interleaved with the index row_starts[cell_index *n_vectorization *n_components] first **This value indicates that the indices within a cell are all and one can get the index to the cell by reading that single value for each of the cells in the cell batch For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **This value indicates that the indices with a cell are contiguous and interleaved for i the first DoF index on a cell to the four or eight cells in the vectorization batch come than the second DoF and so on the interleaving between cells implies that only the batches for vectorization can be accessed whereas there is a strided access for getting only some of the entries The two additional categories interleaved_contiguous_strided and interleaved_contiguous_mixed_strides are a consequence of this storage type The former is for faces where at least one of the two adjacent sides will break with the interleaved storage We then have to make a strided access as described in the next category The last category interleaved_contiguous_mixed_strides appears in the ghost see the more detailed description of that category below this is something that cannot be avoided in general once we interleave the indices between cells For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **Similar to interleaved_contiguous but for the case when the interleaved indices are only contiguous within the degrees of but not also over the components of a vectorized array This happens typically on faces with DG where the cells have interleaved_contiguous storage but the faces numbering is not the same as the cell s numbering For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization *n_components **Similar to interleaved_contiguous_separate but for the case when the interleaved indices are not n_vectorization apart This happens typically within the ghost layer of DG where the remote owner has applied an interleaved storage and the current processor only sees some of the cells For a cell face of this index the data access in FEEvaluationBase is directed to the array dof_indices_contiguous with the index cell_index *n_vectorization * n_components</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2dof__info__0_8txt_source.html#l00070">dof_info_0.txt:70</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdeci">@ update_values</div><div class="ttdoc">Shape function values.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00070">fe_update_flags.h:70</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a6cf0880ba2af3a1be4aacdbbd4b90f9c"><div class="ttname"><a href="iterators__0_8txt.html#a6cf0880ba2af3a1be4aacdbbd4b90f9c">triangulation</a></div><div class="ttdeci">where BaseIterator usually is one of thestandard iterators discussed above *The FilteredIterator gets an additional Predicate in its constructor and willskip all objects where this Predicate evaluates to&lt; tt &gt; false&lt;/tt &gt; Acollection of predicates already implemented can be found in the namespaceIteratorFilters ***IteratorsLoops Iterating over objects *All iterators of the same kind and iterating over thesame kind of geometrical objects traverse the mesh in the sameorder Take this code all iterators will always point to the same mesh even though&lt; tt &gt; DoFHandler&lt;/tt &gt; and&lt; tt &gt; Triangulation&lt;/tt &gt; are very different and even if the DoFHandlers are handling different finite the difference is only in the Accessor As mentioned the order in which iterators traverse the forest ofobjects is actually well but application programs should notassume any such but rather consider this an implementation detailof the library *Corresponding to above the order in which iterators traverse activeobjects is the same for all iterators in the following the difference to the previous example being that here we only consider active but theyare really rather dumb Their magic only lies in the fact that they point tosome useful in this case the Accessor For they point to anactual object that stores some data On the other the deal II when do not return a reference to an actual but returnan object that knows how to get at the data that represents cells In thisobject doesn t store itself where the vertices of a cell are or what its neighborsare it knows how to tease this sort of information from out of thearrays and tables and lists that the Triangulation class sets up to describe amesh *Accessing data that characterizes a cell is always done through the i e the expression[2.x.10] grants access to[1.x.6] attributes of this Accessor Examples of properties you can query from aniterator are ***Since dereferencing iterators yields accessor these calls are tomember etc These in turn figure out the relevant datafrom the various data structures that store this data How this is actuallydone and what data structures are used is not really of concern to authors ofapplications in deal II In by hiding the actual data structureswe are able to store data in an efficient not necessarily in a way thatmakes it easily accessible or understandable to application writers ***IteratorsTypedefs Kinds of accessors *Depending on what sort of data you want to there are different kindsof accessor and hexes that make up a triangulation</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00063">iterators_0.txt:63</a></div></div>
<div class="ttc" id="aclassLinearAlgebra_1_1distributed_1_1Vector_html"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt; Number &gt;</a></div></div>
<div class="ttc" id="astep-1_8cc_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="step-1_8cc.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="step-1_8cc_source.html#l00086">step-1.cc:86</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeadde91684ebb2c6ec5c5c5293123f6a04"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeadde91684ebb2c6ec5c5c5293123f6a04">EvaluationFlags::gradients</a></div><div class="ttdeci">@ gradients</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__flags_8h_source.html#l00060">evaluation_flags.h:60</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_aec42034f53f838aafe42fb93b273eb92"><div class="ttname"><a href="namespaceEuler__DG.html#aec42034f53f838aafe42fb93b273eb92">Euler_DG::operator*</a></div><div class="ttdeci">Tensor&lt; 1, n_components, Number &gt; operator*(const Tensor&lt; 1, n_components, Tensor&lt; 1, dim, Number &gt;&gt; &amp;matrix, const Tensor&lt; 1, dim, Number &gt; &amp;vector)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00308">step-67.cc:308</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a40a3b09f9a2f7ebc40dbae202ae7ee60"><div class="ttname"><a href="namespaceEuler__DG.html#a40a3b09f9a2f7ebc40dbae202ae7ee60">Euler_DG::n_q_points_1d</a></div><div class="ttdeci">constexpr unsigned int n_q_points_1d</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00062">step-67.cc:62</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a0759c0124e216ec36f063ad051f4dba0"><div class="ttname"><a href="multithreading__0_8txt.html#a0759c0124e216ec36f063ad051f4dba0">norm</a></div><div class="ttdeci">it should be big enough so that we don t spend more time on scheduling sub ranges to processors but small enough that processors can be efficiently load balanced A rule of thumb appears to be that a sub range is too small if it takes less than instructions to execute it *An example of how to use these functions are vector operations like the addition in[2.x.45] where all three objects are of type we used a[1.x.23] to on the a function object that takes two arguments and returns the sum of the two This is exactly what we needed when we want to add the individual elements of vectors[2.x.46] and[2.x.47] and write the sum of the two into the elements of[2.x.48] The function object that we get here is completely known to the compiler and when it expands the loop that results from[2.x.49] will be as if we had written the loop in its obvious thereby eliminating the overhead of calling an external function there are cases where it is inefficient to call some object or function within each iteration *An example for this case is sparse matrix vector multiplication If you know how data is stored in compressed row format like in the SparseMatrix then a matrix vector product function looks like we compute the dot product of a single row of the matrix with the right hand side vector[2.x.51] and write it into the corresponding element of the[2.x.52] vector The code is made more efficient by utilizing that the elements of the[1.x.28] row follow the ones of the current i e at the beginning of the loop body we do not have to re set the pointers that point to the values and column numbers of each row *Using the[2.x.53] function we could in principle write this code as leaving one argument open and thus allowing the[2.x.56] function to consider the passed function argument as unary Also note that we need to make the source and destination vectors neither of which is what we desired notice the grainsize of a minimum of rows of a matrix that should be processed by an individual CPU core *The point is that while this is it is not since now the function object to be called on each row is not a simple[1.x.32] any there is an implicit function call including argument passing in each iteration of the loop *A more efficient way is to let TBB split the original range into sub and then call a target function not on each individual element of the but on the entire range This is facilitated by the[2.x.61] we call the[2.x.62] function on sub ranges of at least elements so that the initial setup cost can amortize *A related operation is when the loops over elements each produce a result that must then be but let s assume for a moment that it is A sequential implementation would look like this for sparse each of which compute their part of the square of the norm</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00124">multithreading_0.txt:124</a></div></div>
<div class="ttc" id="aclassTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="agrid_2tria_8h_html"><div class="ttname"><a href="grid_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a2ffe4cdaef4472045fff75d609590f8a"><div class="ttname"><a href="classVectorizedArray.html#a2ffe4cdaef4472045fff75d609590f8a">VectorizedArray::max</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; max(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05765">vectorization.h:5765</a></div></div>
<div class="ttc" id="ampi__remote__point__evaluation__0_8txt_html_a45c57074a631760cdab557f450e880e0"><div class="ttname"><a href="mpi__remote__point__evaluation__0_8txt.html#a45c57074a631760cdab557f450e880e0">mapping</a></div><div class="ttdeci">*Helper class to access values on non matching grids *The name of the fields are chosen with the method quantities are computed at specified arbitrary positioned which receive the result and resort the result according to the points **Constructor[2.x.1] tolerance Tolerance in terms of unit cell coordinates for determining all cells around a point passed to the class during it might be necessary to adjust the tolerance in order to be able to identify a cell Floating point arithmetic implies that a point in not lie exactly on a or face[2.x.2] enforce_unique_mapping Enforce unique mapping</div><div class="ttdef"><b>Definition:</b> <a href="mpi__remote__point__evaluation__0_8txt_source.html#l00005">mpi_remote_point_evaluation_0.txt:5</a></div></div>
<div class="ttc" id="aclassMappingQGeneric_html"><div class="ttname"><a href="classMappingQGeneric.html">MappingQGeneric&lt; dim &gt;</a></div></div>
<div class="ttc" id="abase_2vectorization_8h_html_ae5c8b2cd70b2640bab8f1ee4ccb7f4cc"><div class="ttname"><a href="base_2vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05727">vectorization.h:5727</a></div></div>
<div class="ttc" id="ampi__compute__index__owner__internal__0_8txt_html_a556508d4f019d698d28e912ee1ef9937"><div class="ttname"><a href="mpi__compute__index__owner__internal__0_8txt.html#a556508d4f019d698d28e912ee1ef9937">rank</a></div><div class="ttdeci">namespace used for[2.x.0] and for *[2.x.1] *Specialization of[2.x.2] for setting up the Dictionary even if there are ranges in the IndexSet space not owned by any processes *Only for internal usage **Constructor **Implementation of *[2.x.4] *Implementation of *[2.x.5] *Implementation of *[2.x.6] *Dictionary class with basic partitioning in terms of a single interval of fixed size known to all MPI ranks for two stage index lookup **The minimum grain size for the intervals We choose to limit the smallest size an interval for the two stage lookup can have with the following two conflicting goals in we do not want intervals in the dictionary to become too short For uneven distributions of the lookup DoFs *dictionary then involves sending from one MPI rank to many other MPI ranks holding dictionary leading to an exceedingly high number of messages some ranks have to send fewer longer intervals are generally more efficient to look up On the other a range size too large leads to opposite effect of many messages that come into a particular dictionary owner in the lookup DoFs *dictionary With the current we get at most messages coming to a single MPI rank in case there is dof per MPI rank</div><div class="ttdef"><b>Definition:</b> <a href="mpi__compute__index__owner__internal__0_8txt_source.html#l00021">mpi_compute_index_owner_internal_0.txt:21</a></div></div>
<div class="ttc" id="ainclude_2deal_8II_2base_2utilities_8h_html"><div class="ttname"><a href="include_2deal_8II_2base_2utilities_8h.html">utilities.h</a></div></div>
<div class="ttc" id="abase_2time__stepping_8h_html"><div class="ttname"><a href="base_2time__stepping_8h.html">time_stepping.h</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html_a8402043a938d7bb8af59713a5c0cc73e"><div class="ttname"><a href="classVectorizedArray.html#a8402043a938d7bb8af59713a5c0cc73e">VectorizedArray::min</a></div><div class="ttdeci">VectorizedArray&lt; Number, width &gt; min(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;y)</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l05781">vectorization.h:5781</a></div></div>
<div class="ttc" id="abase_2timer_8h_html"><div class="ttname"><a href="base_2timer_8h.html">timer.h</a></div></div>
<div class="ttc" id="aclassFunctions_1_1ConstantFunction_html"><div class="ttname"><a href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt; dim &gt;</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_aafea668ad0c451ac7a0fae0f558c36d7"><div class="ttname"><a href="distributed__0_8txt.html#aafea668ad0c451ac7a0fae0f558c36d7">cells</a></div><div class="ttdeci">in the area occupied by these artificial cells</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00037">distributed_0.txt:37</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_abe9ea58de877eaeae1e6d493078a41c4"><div class="ttname"><a href="namespaceEuler__DG.html#abe9ea58de877eaeae1e6d493078a41c4">Euler_DG::testcase</a></div><div class="ttdeci">constexpr unsigned int testcase</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00058">step-67.cc:58</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70">Euler_DG::LowStorageRungeKuttaScheme</a></div><div class="ttdeci">LowStorageRungeKuttaScheme</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00071">step-67.cc:71</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html_a2a918d936d56f2be4cdad1b8074c3a86"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html#a2a918d936d56f2be4cdad1b8074c3a86">DataPostprocessorInputs::Vector::solution_gradients</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Tensor&lt; 1, spacedim &gt; &gt; &gt; solution_gradients</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00347">data_postprocessor.h:347</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="group__Exceptions.html#ga72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="base_2patterns_8h_source.html#l02413">patterns.h:2413</a></div></div>
<div class="ttc" id="aclassVectorizedArray_html"><div class="ttname"><a href="classVectorizedArray.html">VectorizedArray&lt; Number &gt;</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a8a6d76021c16d4c01efdab1311d0ec97">TimeStepping::LOW_STORAGE_RK_STAGE5_ORDER4</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE5_ORDER4</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00314">time_stepping.h:314</a></div></div>
<div class="ttc" id="anamespaceStep20_1_1PrescribedSolution_html_a2ec9d2a9c0f55b8fb13bd1c83c358e38"><div class="ttname"><a href="namespaceStep20_1_1PrescribedSolution.html#a2ec9d2a9c0f55b8fb13bd1c83c358e38">Step20::PrescribedSolution::beta</a></div><div class="ttdeci">constexpr double beta</div><div class="ttdef"><b>Definition:</b> <a href="step-20_8cc_source.html#l00088">step-20.cc:88</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4af4ca79e06d00bcc698b6cf908b2ea196">TimeStepping::LOW_STORAGE_RK_STAGE9_ORDER5</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE9_ORDER5</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00326">time_stepping.h:326</a></div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a9d0b8a34fe5ca58425aa1fcf0d6132f1"><div class="ttname"><a href="namespaceGridGenerator.html#a9d0b8a34fe5ca58425aa1fcf0d6132f1">GridGenerator::channel_with_cylinder</a></div><div class="ttdeci">void channel_with_cylinder(Triangulation&lt; dim &gt; &amp;tria, const double shell_region_width=0.03, const unsigned int n_shells=2, const double skewness=2.0, const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceGridGenerator_html_a56019d263ae45708302d5d7599f0d458"><div class="ttname"><a href="namespaceGridGenerator.html#a56019d263ae45708302d5d7599f0d458">GridGenerator::hyper_rectangle</a></div><div class="ttdeci">void hyper_rectangle(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Point&lt; dim &gt; &amp;p1, const Point&lt; dim &gt; &amp;p2, const bool colorize=false)</div></div>
<div class="ttc" id="anamespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad4b36353175269e4fc89f04dafb19891">Euler_DG::stage_5_order_4</a></div><div class="ttdeci">@ stage_5_order_4</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00074">step-67.cc:74</a></div></div>
<div class="ttc" id="aclassMatrixFree_html"><div class="ttname"><a href="classMatrixFree.html">MatrixFree&lt; dim, Number &gt;</a></div></div>
<div class="ttc" id="anamespacePhysics_1_1Elasticity_1_1Kinematics_html_a93f65b0385560a34ec1d3c5ec5a882b8"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a93f65b0385560a34ec1d3c5ec5a882b8">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a87493779c9eb3cd20bfda7ba815daeb4"><div class="ttname"><a href="namespaceEuler__DG.html#a87493779c9eb3cd20bfda7ba815daeb4">Euler_DG::euler_velocity</a></div><div class="ttdeci">Tensor&lt; 1, dim, Number &gt; euler_velocity(const Tensor&lt; 1, dim+2, Number &gt; &amp;conserved_variables)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00256">step-67.cc:256</a></div></div>
<div class="ttc" id="amatrix__free__0_8txt_html_a59b5310307cc6257314a3cdb8c40ab5a"><div class="ttname"><a href="matrix__free__0_8txt.html#a59b5310307cc6257314a3cdb8c40ab5a">integrals</a></div><div class="ttdeci">all[1.x.0] objects are available in any case **The loop does not involve any FEFaceEvaluation access into as is the case with only boundary integrals(but no interior face integrals) or when doing mass matrices in a[2.x.47] like setup. *[0.x.47] *The loop does only involve FEFaceEvaluation access into neighbors by function values</div></div>
<div class="ttc" id="adata__postprocessor__0_8txt_html_a80e53cb52e5dbb182dd14ee528927a77"><div class="ttname"><a href="data__postprocessor__0_8txt.html#a80e53cb52e5dbb182dd14ee528927a77">postprocessor</a></div><div class="ttdeci">the current data is generated on a coarser mesh for the background color corresponds to the magnitude of the gradient vector and the vector glyphs to the gradient itself It may be surprising at first to see that from each multiple vectors going in different directions But that is because the solution is only the gradient is discontinuous across and so the multiple vectors originating from each vertex simply represent the differing gradients of the solution at each adjacent cell *The output above the gradient[2.x.114] of the solution **corresponds to the temperature gradient if one interpreted[2.x.115] as solving a steady state heat transfer problem It is very small in the central part of the domain because in[2.x.116] we are solving an equation that has a coefficient[2.x.117] that is large in the central part and small on the outside This can be thought as a material that conducts heat and consequently the temperature gradient is small On the other the heat flux corresponds to the quantity[2.x.118] For the solution of that the flux should be continuous across the interface This is easily verified by the following modification of the postprocessor</div><div class="ttdef"><b>Definition:</b> <a href="data__postprocessor__0_8txt_source.html#l00138">data_postprocessor_0.txt:138</a></div></div>
<div class="ttc" id="alac_2affine__constraints_8h_html"><div class="ttname"><a href="lac_2affine__constraints_8h.html">affine_constraints.h</a></div></div>
<div class="ttc" id="adata__postprocessor__0_8txt_html_afb21caeba7bf26aba89ce705266fedb1"><div class="ttname"><a href="data__postprocessor__0_8txt.html#afb21caeba7bf26aba89ce705266fedb1">get_names</a></div><div class="ttdeci">note that this is only determined by the number of components in the finite element in and not by whether the data computed by a class derived from the current one is scalar or vector valued derived classes have to implement the get_names() function</div></div>
<div class="ttc" id="aconfig_8h_html_a1d1d58e8be15e5c4285f6892e5f33136"><div class="ttname"><a href="config_8h.html#a1d1d58e8be15e5c4285f6892e5f33136">DEAL_II_ALWAYS_INLINE</a></div><div class="ttdeci">#define DEAL_II_ALWAYS_INLINE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00096">config.h:96</a></div></div>
<div class="ttc" id="adistributed__0_8txt_html_ac2b339f054fd752a401e197097db8cfe"><div class="ttname"><a href="distributed__0_8txt.html#ac2b339f054fd752a401e197097db8cfe">solution</a></div><div class="ttdeci">********clusters ***deal II can use multiple machines connected via MPI to parallelize in addition to the parallelization within a shared memory machine discussed in the[2.x.4] module There are essentially two ways to utilize multiple but only a share of the global sparsity and solution vector is stored on each machine ****The mesh and DoF handler are also i e each processor stores only a share of the cells and degrees of freedom No processor has knowledge of the entire or solution</div><div class="ttdef"><b>Definition:</b> <a href="distributed__0_8txt_source.html#l00025">distributed_0.txt:25</a></div></div>
<div class="ttc" id="aparameter__handler__0_8txt_html_ad919e2b915d8e8226aef004c2d8399a8"><div class="ttname"><a href="parameter__handler__0_8txt.html#ad919e2b915d8e8226aef004c2d8399a8">exception</a></div><div class="ttdeci">since default values may change in the process of program you cannot know the values of parameters not specified in the input file ****It is often convenient to have something happen as soon as a parameter value is read This could be a check that it is valid that a file that is listed in the parameter file exists **or to initiate something else in such as setting a variable outside the this action could also be initiated once all parameters are read via but it is sometimes[1.x.19] to do it right away *This is facilitated by the and can then do whatever they want with it **e save it somewhere outside the ParameterHandler in C one doesn t usually pass around the address of a but an action can be a function like object(taking a string as argument) that results from calling such as a[1.x.20] that has the form **[1.x.21] *and that is attached to a specific parameter. *A typical example of such an action would be as follows the content of the file equals the default value of the parameter the contents of files are never changed after declaration of a parameter a directory in this file system may not have a file called[2.x.20] in it In that the directory represents a subsection as declared and the directory s name will correspond to the name of the subsection It will then have no files in it at but it may have further directories in the code above will lead to a hierarchical representation of data that looks like this(the content of files is indicated at the right in a different font) this is only used when creating output for exceptions If non empty[2.x.35] is the ParameterHandler object will stop parsing lines after encountering[2.x.36] This is handy when adding extra data that shall be parsed manually If[2.x.37] the parameter handler will skip undefined sections and entries This is useful for partially parsing a parameter for example to obtain only the spatial dimension of the problem By default all entries and subsections are expected to be declared The function sets the value of all parameters it encounters in the input file to the provided value Parameters not explicitly listed in the input file are left at the value they previously which will be the default value provided to and for each parameter all associated actions that may previously have been set by or if an associated action throws an exception</div><div class="ttdef"><b>Definition:</b> <a href="parameter__handler__0_8txt_source.html#l00241">parameter_handler_0.txt:241</a></div></div>
<div class="ttc" id="aclassDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="aclassDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00266">dof_handler.h:266</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_ae6473a4a541eccc34d7ed017da171b46"><div class="ttname"><a href="namespaceEuler__DG.html#ae6473a4a541eccc34d7ed017da171b46">Euler_DG::euler_flux</a></div><div class="ttdeci">Tensor&lt; 1, dim+2, Tensor&lt; 1, dim, Number &gt; &gt; euler_flux(const Tensor&lt; 1, dim+2, Number &gt; &amp;conserved_variables)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00285">step-67.cc:285</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70ad3020a789f5b22aad4f797dfb35d9242">Euler_DG::stage_3_order_3</a></div><div class="ttdeci">@ stage_3_order_3</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00073">step-67.cc:73</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0a9b7d9c85221484e1998f6869d98cba8b">DataComponentInterpretation::component_is_part_of_vector</a></div><div class="ttdeci">@ component_is_part_of_vector</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__component__interpretation_8h_source.html#l00062">data_component_interpretation.h:62</a></div></div>
<div class="ttc" id="asolver__cg__0_8txt_html_a557c71e94a2542d697ca3426b8843cd4"><div class="ttname"><a href="solver__cg__0_8txt.html#a557c71e94a2542d697ca3426b8843cd4">sqrt</a></div><div class="ttdeci">*This class implements the preconditioned Conjugate but is used in many other tutorial programs as well Like all other solver it can work on any kind of vector and matrix as long as they satisfy certain and defaults to *[2.x.2] **This version of CG is taken from D Braess s book Finite Elements It requires a symmetric the projected matrix[2.x.4] is tri diagonal Since the projection is the eigenvalues of[2.x.5] approximate those of the original preconditioned matrix[2.x.6] In after[2.x.7] where[2.x.8] is the dimension of the original the eigenvalues of both matrices are equal even for small numbers of iteration the condition number of[2.x.9] is a good estimate for the one of *[2.x.10] After[2.x.11] steps the matrix T_m can be written in terms of the coefficients[2.x.12] and[2.x.13] as the tri diagonal matrix with diagonal elements&lt; tt &gt;&lt; tt &gt; alpha_1 beta_0&lt; tt &gt;&lt; tt &gt; sqrt(beta_{m-2&lt;/tt &gt;)/alpha_</div><div class="ttdef"><b>Definition:</b> <a href="solver__cg__0_8txt_source.html#l00011">solver_cg_0.txt:11</a></div></div>
<div class="ttc" id="alac_2la__parallel__vector_8h_html"><div class="ttname"><a href="lac_2la__parallel__vector_8h.html">la_parallel_vector.h</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_a553ca864aaf70330d9be86bc78f36d1e"><div class="ttname"><a href="classDoFHandler.html#a553ca864aaf70330d9be86bc78f36d1e">DoFHandler::distribute_dofs</a></div><div class="ttdeci">void distribute_dofs(const FiniteElement&lt; dim, spacedim &gt; &amp;fe)</div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a9edd4487df56c4c9c516ab8f50738685">TimeStepping::LOW_STORAGE_RK_STAGE3_ORDER3</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE3_ORDER3</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00308">time_stepping.h:308</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdeci">@ update_quadrature_points</div><div class="ttdoc">Transformed quadrature points.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00116">fe_update_flags.h:116</a></div></div>
<div class="ttc" id="aclassFiniteElementData_html_a2cbf5ad6b464871261dbd054bced18a8"><div class="ttname"><a href="classFiniteElementData.html#a2cbf5ad6b464871261dbd054bced18a8">FiniteElementData::degree</a></div><div class="ttdeci">const unsigned int degree</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__base_8h_source.html#l00428">fe_base.h:428</a></div></div>
<div class="ttc" id="abase_2function_8h_html"><div class="ttname"><a href="base_2function_8h.html">function.h</a></div></div>
<div class="ttc" id="aclassTimerOutput_html"><div class="ttname"><a href="classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2timer_8h_source.html#l00591">timer.h:591</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a33468e75b7ea6d2e64b7e88c6ff1217a"><div class="ttname"><a href="multithreading__0_8txt.html#a33468e75b7ea6d2e64b7e88c6ff1217a">of</a></div><div class="ttdeci">namespace are implemented the way they are More information on their implementation can be found in the[2.x.72] WorkStream paper To see the WorkStream class used in practice on tasks like the ones outlined above take a look at or[2.x.78] tutorial programs *To begin given the brief description the way the[2.x.79] function could then be written is like this(note that this is not quite the correct syntax, as will be described below) we recycle these objects after they have been used by[2.x.101] and feed them back into another instance of[2.x.102]</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00171">multithreading_0.txt:171</a></div></div>
<div class="ttc" id="anumerical__algorithms__0_8txt_html_a852a1e245dd2de4943eeb66beeaf65b1"><div class="ttname"><a href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a></div><div class="ttdeci">****This module groups a diverse set of classes that generally implement some sort of numerical algorithm on top all the basic and finite element classes in the library They are generally unconnected to each other *Some of the like KellyErrorEstimator and act on solutions already and compute derived quantities in the first two or help transferring a set of vectors from one mesh to another *The namespaces and VectorTools provide an assortment of such as creating a Laplace projecting or interpolating a function onto the present finite element etc The difference to the functions in the DoFTools and FETools functions is that they work on the DoFTools functions only act on a given DoFHandler object without reference to a data vector</div><div class="ttdef"><b>Definition:</b> <a href="numerical__algorithms__0_8txt_source.html#l00008">numerical_algorithms_0.txt:8</a></div></div>
<div class="ttc" id="anamespacetypes_html_aaf4eb6ec214fa642dfd956f11a9cd2d7"><div class="ttname"><a href="namespacetypes.html#aaf4eb6ec214fa642dfd956f11a9cd2d7">types::boundary_id</a></div><div class="ttdeci">unsigned int boundary_id</div><div class="ttdef"><b>Definition:</b> <a href="base_2types_8h_source.html#l00117">types.h:117</a></div></div>
<div class="ttc" id="aauto__derivative__function__0_8txt_html_af5d8dd2d035de856717fb6b5c9438dd5"><div class="ttname"><a href="auto__derivative__function__0_8txt.html#af5d8dd2d035de856717fb6b5c9438dd5">h</a></div><div class="ttdeci">*This class automatically computes the gradient of a function by employing numerical difference quotients This only if the user function does not provide the gradient function himself *The following example of an user defined function overloads and implements only the where the latter function employs numerical difference quotients *****If the user overloads and implements also the gradient of the users gradient function is called that the usage of the also applies to the see e g respectively *Furthermore that an object of this class does[1.x.1] represent the derivative of a like that gives a directional derivative by calling the this class the AutoDerivativeFunction class can substitute the Function class as base class for user defined classes This class implements the gradient() functions for automatic computation of numerical difference quotients and serves as intermediate class between the base Function class and the user defined function class. ***[2.x.2] **[0.x.1] *Names of difference formulas. *[0.x.2] *The symmetric Euler formula of second order absolutely necessary in this case **Choose the difference formula See the enum DifferenceFormula for available choices **Takes the difference step size&lt; tt &gt; h&lt;/tt &gt; It s within the user s responsibility to choose an appropriate value here&lt; tt &gt; h&lt;/tt &gt; should be chosen taking into account the absolute value of as well as the amount of variation of the function Setting&lt; tt &gt; h</div><div class="ttdef"><b>Definition:</b> <a href="auto__derivative__function__0_8txt_source.html#l00034">auto_derivative_function_0.txt:34</a></div></div>
<div class="ttc" id="aclassMapping_html"><div class="ttname"><a href="classMapping.html">Mapping</a></div><div class="ttdoc">Abstract base class for mapping classes. This class declares the interface for the functionality to d...</div><div class="ttdef"><b>Definition:</b> <a href="fe_2mapping_8h_source.html#l00270">mapping.h:270</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html"><div class="ttname"><a href="base_2logstream_8h.html">logstream.h</a></div></div>
<div class="ttc" id="aclassPoint_html_a25d858964d15e04ff371d8738a17ea33"><div class="ttname"><a href="classPoint.html#a25d858964d15e04ff371d8738a17ea33">Point::operator*</a></div><div class="ttdeci">Point&lt; dim, typename ProductType&lt; Number, typename EnableIfScalar&lt; OtherNumber &gt;::type &gt;::type &gt; operator*(const OtherNumber) const</div></div>
<div class="ttc" id="aconstraints__0_8txt_html_a5abc878123b65e2a7a16e57bba0e282e"><div class="ttname"><a href="constraints__0_8txt.html#a5abc878123b65e2a7a16e57bba0e282e">constraints</a></div><div class="ttdeci">******This module deals with constraints on degrees of freedom The central class to deal with constraints is the AffineConstraints class *Constraints typically come from several for one usually enforces them by requiring that degrees of freedom on the boundary have particular for example[2.x.3] if the boundary condition[2.x.4] requires that the finite element solution[2.x.5] at the location of degree of freedom has the value Such constraints are generated by those versions of the[2.x.6] function that take a AffineConstraints for example no normal as happens in flow problems and is handled by the[2.x.11] function or prescribed tangential as happens in electromagnetic problems and is handled by the[2.x.13] function For the former imagine for example that we are at at vertex where the normal vector has the form[2.x.14] and that and[2.x.17] components of the flow field at this vertex are associated with degrees of and Then the no normal flux condition means that we need to have the condition[2.x.18] The prescribed tangential component leads to similar constraints though there is often something on the right hand side ****If you have hanging node constraints</div><div class="ttdef"><b>Definition:</b> <a href="constraints__0_8txt_source.html#l00020">constraints_0.txt:20</a></div></div>
<div class="ttc" id="anamespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="origin_2base_2event_8h_source.html#l00149">event.h:149</a></div></div>
<div class="ttc" id="amg__transfer__0_8txt_html_a6b401cd9c6154fc787311f58ab910002"><div class="ttname"><a href="mg__transfer__0_8txt.html#a6b401cd9c6154fc787311f58ab910002">pressure</a></div><div class="ttdeci">MGTransferBase is defined in mg_base h ***Implementation of transfer between the global vectors and the multigrid levels for use in the derived class MGTransferPrebuilt and other classes ***Reset the object to the state it had right after the default constructor **Transfer from a vector on the global grid to vectors defined on each of the levels separately for the active degrees of freedom In for a globally refined mesh only the finest level in[2.x.0] is filled as a plain copy of[2.x.1] All the other level objects are left untouched **Transfer from multi level vector to normal vector Copies data from active portions of an MGVector into the respective positions of a&lt; tt &gt; Vector&lt; number &gt;&lt;/tt &gt; In order to keep the result constrained degrees of freedom are set to zero **Add a multi level vector to a normal vector Works as the previous but probably not for continuous elements **If this object operates on BlockVector we need to describe how the individual vector components are mapped to the blocks of a vector For for a Stokes we have dim vector components for velocity and pressure</div><div class="ttdef"><b>Definition:</b> <a href="mg__transfer__0_8txt_source.html#l00017">mg_transfer_0.txt:17</a></div></div>
<div class="ttc" id="amatrix__free_2operators_8h_html"><div class="ttname"><a href="matrix__free_2operators_8h.html">operators.h</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa4924d31df0211f3fb9db3bbe1af0d1c">DataComponentInterpretation::component_is_scalar</a></div><div class="ttdeci">@ component_is_scalar</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__component__interpretation_8h_source.html#l00055">data_component_interpretation.h:55</a></div></div>
<div class="ttc" id="adof__tools__0_8txt_html_a9442956f28da0afe6f6e41e15e33d525"><div class="ttname"><a href="dof__tools__0_8txt.html#a9442956f28da0afe6f6e41e15e33d525">result</a></div><div class="ttdeci">namespace the creation of the sparsity pattern is done by the it needs to have a numbering of all those degrees of freedom that are on those parts of the boundary that we are interested in You can get this from the where[2.x.10] and[2.x.11] are indices into the and[2.x.12] is the global DoF number of a degree of freedom sitting on a remember that these flags are used as elements of tables of size[2.x.16] times[2.x.17] where each element indicates whether two components do or do not couple **Two components do not couple **Two components do couple **Two components couple only if their shape functions are both nonzero on a given face This flag is only used when computing integrals over faces of e in[2.x.18] Use[2.x.19] in general cases where gradients etc occur on face integrals **DoF couplings *[2.x.21] *Map a coupling table from the user friendly organization by components to the organization by blocks The return vector will be initialized to the correct length inside this function **Given a finite element and a table how the vector components of it couple with each compute and return a table that describes how the individual shape functions couple with each other **Same function as above for a collection of finite returning a collection of tables The function currently treats[2.x.22] the same as *[2.x.23] ***Sparsity pattern generation *[2.x.26] *Compute which entries of a matrix built on the given[2.x.27] may possibly be and create a sparsity pattern object that represents these nonzero locations This function computes the possible positions of non zero entries in the global system matrix by[1.x.3] which entries one would write to during the actual assembly of a matrix For the function assumes that each finite element basis function is non zero on a cell only if its degree of freedom is associated with the a an edge or a vertex of this cell As a result</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__0_8txt_source.html#l00049">dof_tools_0.txt:49</a></div></div>
<div class="ttc" id="amapping__q__cache__0_8txt_html_ad70e0fe32f41f61653b79c84cbeedbee"><div class="ttname"><a href="mapping__q__cache__0_8txt.html#ad70e0fe32f41f61653b79c84cbeedbee">lambda</a></div><div class="ttdeci">*This class implements a caching strategy for objects of the MappingQ family in terms of the[2.x.0] which is used in all operations of MappingQGeneric The information of the mapping is pre computed by the[2.x.1] function *The use of this class is discussed extensively in *[2.x.2] **Constructor[2.x.3] denotes the polynomial degree of the polynomials that are used to map cells from the reference to the real cell **Copy constructor **Destructor see *[2.x.4] *Returns[2.x.5] because the preservation of vertex locations depends on the mapping handed to the where[2.x.12] is the polynomial degree of the and it must be in the order the mapping or FE_Q sort their i all[2.x.13] vertex points then the points on the and hexes according to the usual hierarchical numbering No attempt is made to validate these points except for the number of given points *If multiple threads are this function will run in invoking the function passed in several times in case[2.x.15] the user code must make sure that the typically a lambda</div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__cache__0_8txt_source.html#l00024">mapping_q_cache_0.txt:24</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a"><div class="ttname"><a href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a052c77bc00575754b694c0b2447de92a">Euler_DG::harten_lax_vanleer</a></div><div class="ttdeci">@ harten_lax_vanleer</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00083">step-67.cc:83</a></div></div>
<div class="ttc" id="anamespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="lac_2matrix__block_8h_source.html#l00656">matrix_block.h:656</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdeci">@ update_normal_vectors</div><div class="ttdoc">Normal vectors.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00132">fe_update_flags.h:132</a></div></div>
<div class="ttc" id="aclassTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2tensor_8h_source.html#l00441">tensor.h:441</a></div></div>
<div class="ttc" id="aclassLinearAlgebra_1_1distributed_1_1Vector_html_ace027311492ed2f6e07fbd74d723e3a9"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html#ace027311492ed2f6e07fbd74d723e3a9">LinearAlgebra::distributed::Vector::reinit</a></div><div class="ttdeci">void reinit(const size_type size, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="aclassDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="avector__0_8txt_html_aaf255149898cc5cea8c1fa1e76fffe6f"><div class="ttname"><a href="vector__0_8txt.html#aaf255149898cc5cea8c1fa1e76fffe6f">v</a></div><div class="ttdeci">0 v</div><div class="ttdef"><b>Definition:</b> <a href="vector__0_8txt_source.html#l00062">vector_0.txt:62</a></div></div>
<div class="ttc" id="ageometry__info__0_8txt_html_a30a552b07accf65da90f851e25d14d1c"><div class="ttname"><a href="geometry__info__0_8txt.html#a30a552b07accf65da90f851e25d14d1c">dim</a></div><div class="ttdeci">3, where it offers following possibilities:a face(quad) being refined in x- or y-direction(in the face-intern coordinate system) separately,([2.x.79] or([2.x.80] which corresponds to([2.x.81]). Additionally, it offers the possibilities a face can have through repeated anisotropic refinement steps performed on one of the two neighboring cells. It might be possible for example, that a face(quad) is refined with[2.x.82] and afterwards the left child is again refined with[2.x.83], so that there are three active subfaces. Note, however, that only refinement cases are allowed such that each line on a face between two hexes has not more than one hanging node. Furthermore, it is not allowed that two neighboring hexes are refined such that one of the hexes refines the common face with[2.x.84] and the other hex refines that face with[2.x.85] . In fact,[2.x.86] takes care of this situation and ensures that each face of a refined cell is completely contained in a single face of neighboring cells. The following drawings explain the SubfacePossibilities and give the corresponding subface numbers:*[1.x.4] **[2.x.87] *[0.x.68] *Possible cases of faces being subdivided into subface. See documentation to the SubfacePossibilities&lt; 3 &gt; for more details on the subface possibilities. *[0.x.69] *A class that provides all possible cases a face(in the current space dimension[2.x.88] might be subdivided into subfaces. *[2.x.89] *[0.x.70] *Constructor. Take and store a value indicating a particular subface possibility in the list of possible situations specified in the base class. *[0.x.71] *Return the numeric value stored by this class. While the presence of this operator might seem dangerous, it is useful in cases where one would like to have code like&lt; code &gt;switch(subface_case)... case[2.x.90] ...&lt;/code &gt;, which can be written as&lt; code &gt;switch[2.x.91] Another application is to use an object of the current type as an index into an array dim</div><div class="ttdef"><b>Definition:</b> <a href="geometry__info__0_8txt_source.html#l00202">geometry_info_0.txt:202</a></div></div>
<div class="ttc" id="aclassVectorizedArrayBase_html_acb35404acc1693aee6e990228924cc09"><div class="ttname"><a href="classVectorizedArrayBase.html#acb35404acc1693aee6e990228924cc09">VectorizedArrayBase&lt; VectorizedArray&lt; Number, width &gt;, 1 &gt;::size</a></div><div class="ttdeci">static constexpr std::size_t size()</div><div class="ttdef"><b>Definition:</b> <a href="base_2vectorization_8h_source.html#l00272">vectorization.h:272</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a7a17f790f94a4539645c427e98239a81"><div class="ttname"><a href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">function</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each function</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00021">coding_conventions_0.txt:21</a></div></div>
<div class="ttc" id="atime__dependent__0_8txt_html_ad268335339a0d9d7af4fdc68b28d7a4a"><div class="ttname"><a href="time__dependent__0_8txt.html#ad268335339a0d9d7af4fdc68b28d7a4a">round</a></div><div class="ttdeci">uses the functions[2.x.41] and[2.x.42] of the TimeStepBase class through the[2.x.43] function of this class Look ahead and look back are determined by the[2.x.44] object given to the constructor **Do a postprocessing round</div><div class="ttdef"><b>Definition:</b> <a href="time__dependent__0_8txt_source.html#l00081">time_dependent_0.txt:81</a></div></div>
<div class="ttc" id="abase_2logstream_8h_html_ac643e79bd992f1a9bd0dca5b9f2859fb"><div class="ttname"><a href="base_2logstream_8h.html#ac643e79bd992f1a9bd0dca5b9f2859fb">deallog</a></div><div class="ttdeci">LogStream deallog</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00037">logstream.cc:37</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a69730bc7f91dd1be17fd083a66514e73"><div class="ttname"><a href="coding__conventions__0_8txt.html#a69730bc7f91dd1be17fd083a66514e73">freedom</a></div><div class="ttdeci">their purpose is merely to keepdeal II as uniform as possible Uniformity reduces the number of bugs weproduce because we for always assume that input arguments comebefore output arguments of a function call They also simplify reading codebecause some things become clear already by looking at the style a piece ofcode is without having to look up the exact definition of something **deal II uses[2.x.2] to normalize indentation Astyle file is provided at ***Before a you should run **on each of your files This will make sure indentation is conforming to thestyle guidelines outlined in this page *This is cumbersome and more you can just run **in whatever directory you set up the library to be compiled to indent allsource files that have been changed recently If you want to make sure thatthe indenting is correct for all your you might want to set up apre commit hook One way to do is to copy[2.x.4] to[2.x.5] and make sure it isexecutable *If the system you are working on has more than one version of[2.x.6] degrees of freedom</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00018">coding_conventions_0.txt:18</a></div></div>
<div class="ttc" id="aclassMatrixFreeOperators_1_1CellwiseInverseMassMatrix_html"><div class="ttname"><a href="classMatrixFreeOperators_1_1CellwiseInverseMassMatrix.html">MatrixFreeOperators::CellwiseInverseMassMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2operators_8h_source.html#l00637">operators.h:637</a></div></div>
<div class="ttc" id="aclassparallel_1_1distributed_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="aA-headers_2exceptions__0_8txt_html_af85863b31be0cbd660acba99051e0634"><div class="ttname"><a href="A-headers_2exceptions__0_8txt.html#af85863b31be0cbd660acba99051e0634">data</a></div><div class="ttdeci">****This module contains classes that are used in the exception mechanism of deal II **Exceptions are used in two different not in static assertions are typically used to check that parameters to functions satisfy certain that internal data structures are and similar assertions For static assertions are used to make sure that two vectors that are added together have the same number of components **everything else would not make any sense anyway *Such checks are performed by the[2.x.3] macro in several thousand places within the library several tutorial programs starting with[2.x.4] show how to do this *If static a assertion is the exception mechanism generates an exception of a type that indicates what exactly goes wrong displays appropriate information including the exact location where the problem was detected and then aborts the program **if you try to add two vectors of different there is nothing that can be done within the program to cope with the you have to go fix the program code instead There is generally not even a reason to[2.x.5] an exception object using the usual C exception mechanism because there is nothing a function higher up could do in such cases to rectify the situation and deal with it in a useful way **it s not that the program received bad data</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2exceptions__0_8txt_source.html#l00015">exceptions_0.txt:15</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a732aaa4c4e3d0b05e932b8fb03cd866e">Euler_DG::stage_9_order_5</a></div><div class="ttdeci">@ stage_9_order_5</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00076">step-67.cc:76</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="agroup__Exceptions_html_ga9442b63275c9ef3fab29bc222831c49c"><div class="ttname"><a href="group__Exceptions.html#ga9442b63275c9ef3fab29bc222831c49c">AssertDimension</a></div><div class="ttdeci">#define AssertDimension(dim1, dim2)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01749">exceptions.h:1749</a></div></div>
<div class="ttc" id="aA-headers_2fe__0_8txt_html_abbd000c1bb0a029706ba0d8934597f39"><div class="ttname"><a href="A-headers_2fe__0_8txt.html#abbd000c1bb0a029706ba0d8934597f39">velocity</a></div><div class="ttdeci">****All classes related to shape functions and to access to shape functions This concerns the actual values of finite elements For the numbering of degrees of freedom refer to the module on *[2.x.1] The classes and functions of this module fall into several sub groups that are discussed in their respective sub modules listed above In the FETools class provides functions that provide information on finite elements transformations between elements etc *In the grand scheme of the pieces of this module interact with a variety of other parts of the without actually implementing a concrete element For the FiniteElement base class declares the virtual functions a derived class has to implement if it wants to describe a finite element space Likewise the FiniteElementData holds variables that describe certain values characterizing a finite element such as the number of degrees of freedom per vertex line or face *On the other classes like FE_Poly and FE_PolyTensor are higher abstractions They describe finite elements that are built atop polynomial descriptions of the shape functions on the unit cell Classes derived from them then only have to provide a description of the particular polynomial from which a finite element is built For the FE_Q class that implements the usual Lagrange elements uses the FE_Poly base class to generate a finite element by providing it with a set of Lagrange interpolation polynomials corresponding to an equidistant subdivision of interpolation points the FESystem class is used for vector valued problems There one may want to couple a number of for Navier Stokes one may want to use three Q1 elements for the three components of the velocity</div><div class="ttdef"><b>Definition:</b> <a href="A-headers_2fe__0_8txt_source.html#l00021">fe_0.txt:21</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a5bee3b4914d1729bfe7d3781c2e1ecc1"><div class="ttname"><a href="namespaceEuler__DG.html#a5bee3b4914d1729bfe7d3781c2e1ecc1">Euler_DG::n_global_refinements</a></div><div class="ttdeci">constexpr unsigned int n_global_refinements</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00060">step-67.cc:60</a></div></div>
<div class="ttc" id="aclassFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="afe_2fe__0_8txt_html_a754f79d53a1f0ebfe04ff6b9ff4abb8a"><div class="ttname"><a href="fe_2fe__0_8txt.html#a754f79d53a1f0ebfe04ff6b9ff4abb8a">compute</a></div><div class="ttdeci">we cannot already compute the gradients on a concrete cell at the time the current function is but we can at least pre compute the gradients on the reference and store it in the object returned An extensive discussion of the interaction between this function and FEValues can be found in the[2.x.376] documentation module See also the documentation of the InternalDataBase class[2.x.377] update_flags A set of UpdateFlags values that describe what kind of information the FEValues object requests the finite element to compute This set of flags may also include information that the finite element can not compute</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__0_8txt_source.html#l00547">fe_0.txt:547</a></div></div>
<div class="ttc" id="afe_2fe__system_8h_html"><div class="ttname"><a href="fe_2fe__system_8h.html">fe_system.h</a></div></div>
<div class="ttc" id="aclassEuler__DG_1_1EulerOperator_html_aae07d964990108d9f0b51995835e4a10"><div class="ttname"><a href="classEuler__DG_1_1EulerOperator.html#aae07d964990108d9f0b51995835e4a10">Euler_DG::EulerOperator::EulerOperator</a></div><div class="ttdeci">EulerOperator(TimerOutput &amp;timer_output)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00502">step-67.cc:502</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_add141cdc4d28d06d71948acb7f0c7150"><div class="ttname"><a href="vector__valued__0_8txt.html#add141cdc4d28d06d71948acb7f0c7150">s</a></div><div class="ttdeci">each of these vectors has[2.x.174] elements containing the values of the[2.x.175] velocities and the one pressure at a quadrature point *We can use these values to then construct other things like residuals the construct is a bit awkward we have a[2.x.176] s</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00155">vector_valued_0.txt:155</a></div></div>
<div class="ttc" id="avector__valued__0_8txt_html_a2b24e414d1a0d32deea919c5e8899811"><div class="ttname"><a href="vector__valued__0_8txt.html#a2b24e414d1a0d32deea919c5e8899811">x</a></div><div class="ttdeci">([1.x.8]&lt; sub &gt;1&lt;/sub &gt;, [1.x.9]&lt; sub &gt;2&lt;/sub &gt;, [1.x.10]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt; and[1.x.11] accordingly. Then, we can write the simplified equation in coordinates as[1.x.12] We see, that this is just three copies of the bilinear form of the Laplacian, one applied to each component(this is where the formulation with the[2.x.33] is more exciting, and we want to derive a framework that applies to that one as well). We can make this weak form a system of differential equations again by choosing special test functions:first, choose[1.x.13]=([1.x.14]&lt; sub &gt;1&lt;/sub &gt;, 0, 0)&lt; sup &gt;T&lt;/sup &gt;, then[1.x.15]=(0, [1.x.16]&lt; sub &gt;2&lt;/sub &gt;, 0)&lt; sup &gt;T&lt;/sup &gt;, and finally[1.x.17]=(0, 0, [1.x.18]&lt; sub &gt;3&lt;/sub &gt;)&lt; sup &gt;T&lt;/sup &gt;. writing the outcomes below each other, we obtain the system[1.x.19] where we used the standard inner product notation[2.x.34] . It is important for our understanding, that we keep in mind that the latter form as a system of PDE is completely equivalent to the original definition of the bilinear form[1.x.20]([1.x.21], [1.x.22]), which does not immediately exhibit this system structure. Let us close by writing the full system of the elastic equation with symmetric gradient[1.x.23]:[1.x.24] Very formally, if we believe in operator valued matrices, we can rewrite this in the form[1.x.25]&lt; sup &gt;T&lt;/sup &gt;[1.x.26]=[1.x.27]&lt; sup &gt;T&lt;/sup &gt;[1.x.28] or[1.x.29] *[1.x.30] Now, let us consider a more complex example, the mixed Laplace equations discussed in[2.x.35] in three dimensions:[1.x.31] **Here, we have four solution components:the scalar pressure[2.x.36] and the vector-valued velocity[2.x.37] with three vector components. Note as important difference to the previous example, that the vector space[1.x.32] is not just simply a copy of three identical spaces/*A systematic way to get a weak or variational form for this and other vector problems is to first consider it as a problem where the operators and solution variables are written in vector and matrix form. For the example, this would read as follows:[1.x.33] **This makes it clear that the solution[1.x.34] *indeed has four components. We note that we could change the ordering of the solution components[2.x.38] and[2.x.39] inside[2.x.40] if we also change columns of the matrix operator.*Next, we need to think about test functions[2.x.41] . We want to multiply both sides of the equation with them, then integrate over[2.x.42] . The result should be a scalar equality. We can achieve this by choosing[2.x.43] also vector valued as[1.x.35] **It is convenient to multiply the matrix-vector equation by the test function from the left, since this way we automatically get the correct matrix later on(in the linear system, the matrix is also multiplied from the right with the solution variable, not from the left), whereas if we multiplied from the right then the matrix so assembled is the transpose of the one we really want. *With this in mind, let us multiply by[2.x.44] and integrate to get the following equation which has to hold for all test functions[2.x.45] :[1.x.36] *or equivalently:[1.x.37] ***We get the final form by integrating by part the second term:[1.x.38] **It is this form that we will later use in assembling the discrete weak form into a matrix and a right hand side vector:the form in which we have solution and test functions[2.x.46] that each consist of a number of vector components that we can extract. **[2.x.47] VVFEs[1.x.39] *Once we have settled on a bilinear form and a functional setting, we need to find a way to describe the vector-valued finite element spaces from which we draw solution and test functions. This is where the FESystem class comes in:it composes vector-valued finite element spaces from simpler ones. In the example of the elasticity problem, we need[2.x.48] copies of the same element, for instance **[1.x.40] *This will generate a vector valued space of dimension[2.x.49], where each component is a continuous bilinear element of type FE_Q. It will have[2.x.50] times as many basis functions as the corresponding FE_Q, and each of these basis functions is a basis function of FE_Q, lifted into one of the components of the vector. *For the mixed Laplacian, the situation is more complex. First, we have to settle on a pair of discrete spaces[2.x.51] . One option would be the stable Raviart-Thomas pair **[1.x.41] *The first element in this system is already a vector valued element of dimension[2.x.52], while the second is a regular scalar element. *Alternatively to using the stable Raviart-Thomas pair, we could consider a stabilized formulation for the mixed Laplacian, for instance the LDG method. There, we have the option of using the same spaces for velocity components and pressure, namely **[1.x.42] *This system just has[2.x.53] equal copies of the same discontinuous element, which not really reflects the structure of the system. Therefore, we prefer **[1.x.43] *Here, we have a system of two elements, one vector-valued and one scalar, very much like with the[2.x.54] . Indeed, in many codes, the two can be interchanged. This element also allows us easily to switch to an LDG method with lower order approximation in the velocity, namely **[1.x.44] *It must be pointed out, that this element is different from **[1.x.45] *While the constructor call is very similar to[2.x.55], the result actually resembles more[2.x.56] in that this element produces[2.x.57] independent components. A more detailed comparison of the resulting FESystem objects is below. *[1.x.46] *FESystem has a few internal variables which reflect the internal structure set up by the constructor. These can then also be used by application programs to give structure to matrix assembling and linear algebra. We give the names and values of these variables for the examples above in the following table:&lt; table border=&quot;1&quot;&gt;&lt; tr &gt;&lt; th &gt;System Element&lt;/th &gt;[2.x.58][2.x.59][2.x.60]&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.61]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.62]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.63]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.64]&lt;/td &gt;&lt; td &gt;1&lt;/td &gt;&lt;/tr &gt;&lt; tr &gt;&lt; td &gt;[2.x.65]&lt;/td &gt;&lt; td &gt;2&lt;/td &gt;&lt;/tr &gt;&lt;/table &gt; *From this table, it is clear that the FESystem reflects a lot of the structure of the system of differential equations in the cases of the[2.x.66] and the[2.x.67], in that we have a vector valued and a scalar variable. On the other hand, the convoluted elements do not have this structure and we have to reconstruct it somehow when assembling systems, as described below. *At this point, it is important to note that nesting of two FESystem object can give the whole FESystem a richer structure than just concatenating them. This structure can be exploited by application programs, but is not automatically so. *[2.x.68] VVAssembling[1.x.47] The next step is to assemble the linear system. How to do this for the simple case of a scalar problem has been shown in many tutorial programs, starting with[2.x.69] . Here we will show how to do it for vector problems. Corresponding to the different characterizations of weak formulations above and the different system elements created, we have a few options which are outlined below. *The whole concept is probably best explained by showing an example illustrating how the local contribution of a cell to the weak form of above mixed Laplace equations could be assembled. *[1.x.48] This is essentially how[2.x.70] does it:**[1.x.49] **So here 's what is happening:[2.x.71][2.x.72] The first thing we do is to declare &quot;extractors&quot;(see the FEValuesExtractors namespace). These are objects that don 't do much except store which components of a vector-valued finite element constitute a single scalar component, or a tensor of rank 1(i.e. what we call a &quot;physical vector&quot;, always consisting of[2.x.73] components). Here, we declare an object that represents the velocities consisting of[2.x.74] components starting at component zero, and the extractor for the pressure, which is a scalar component at position[2.x.75] . *[2.x.76] We then do our usual loop over all cells, shape functions, and quadrature points. In the innermost loop, we compute the local contribution of a pair of shape functions to the global matrix and right hand side vector. Recall that the cell contributions to the bilinear form(i.e. neglecting boundary terms) looked as follows, based on shape functions[2.x.77] :[1.x.50] *whereas the implementation looked like this:*[1.x.51] *The similarities are pretty obvious. *[2.x.78] Essentially, what happens in above code is this:when you do[2.x.79], a so-called &quot;view&quot; is created, i.e. an object that unlike the full FEValues object represents not all components of a finite element, but only the one(s) represented by the extractor object[2.x.80] or[2.x.81] . *[2.x.82] These views can then be asked for information about these individual components. For example, when you write[2.x.83] you get the value of the pressure component of the[2.x.84] th shape function[2.x.85] at the[2.x.86] th quadrature point. Because the extractor[2.x.87] represents a scalar component, the results of the operator[2.x.88] is a scalar number. On the other hand, the call[2.x.89] would produce the value of a whole set of[2.x.90] components, which would be of type[2.x.91] . *[2.x.92] Other things that can be done with views is to ask for the gradient of a particular shape function 's components described by an extractor. For example,[2.x.93] would represent the gradient of the scalar pressure component, which is of type[2.x.94], whereas the gradient of the velocities components,[2.x.95] is a[2.x.96], i.e. a matrix[2.x.97] that consists of entries[2.x.98] . Finally, both scalar and vector views can be asked for the second derivatives(&quot;Hessians&quot;) and vector views can be asked for the symmetric gradient, defined as[2.x.99] as well as the divergence[2.x.100] .[2.x.101] Other examples of using extractors and views are shown in tutorial programs[2.x.102],[2.x.103],[2.x.104] and several other programs. ***[2.x.105] In the current context, when we talk about a vector(for example in extracting the velocity components above), we mean the word in the sense physics uses it:it has[2.x.106] components that behave in specific ways under coordinate system transformations. Examples include velocity or displacement fields. This is opposed to how mathematics uses the word &quot;vector&quot;(and how we use this word in other contexts in the library, for example in the Vector class), where it really stands for a collection of numbers. An example of this latter use of the word could be the set of concentrations of chemical species in a flame x</div><div class="ttdef"><b>Definition:</b> <a href="vector__valued__0_8txt_source.html#l00090">vector_valued_0.txt:90</a></div></div>
<div class="ttc" id="achunk__sparse__matrix__0_8txt_html_ad43ded305d7756c82052fec150fdf5dd"><div class="ttname"><a href="chunk__sparse__matrix__0_8txt.html#ad43ded305d7756c82052fec150fdf5dd">transpose</a></div><div class="ttdeci">if any of the entries should happen to be it is counted anyway **Return the number of actually nonzero elements of this matrix that this function you should be aware that it may change if you call any nonconstant function of objects which operate on it **Determine an estimate for the memory it is allowed to store zero values in non existent fields **Add&lt; tt &gt; value&lt;/tt &gt; to the it is allowed to store zero values in non existent fields **Add an array of values given by&lt; tt &gt; values&lt;/tt &gt; in the given global matrix row at columns specified by col_indices in the sparse matrix The optional parameter&lt; tt &gt; elide_zero_values&lt;/tt &gt; can be used to specify whether zero values should be added anyway or these should be filtered away and only non zero data is added The default value is&lt; tt &gt; i zero values won t be added into the matrix **Multiply the entire matrix by a fixed factor **Divide the entire matrix by a fixed factor **Symmetrize the matrix by forming the mean value between the existing matrix and its transpose</div><div class="ttdef"><b>Definition:</b> <a href="chunk__sparse__matrix__0_8txt_source.html#l00176">chunk_sparse_matrix_0.txt:176</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a55c27d06e5e51d70be744612e5cfaf45"><div class="ttname"><a href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45">Euler_DG::EulerNumericalFlux</a></div><div class="ttdeci">EulerNumericalFlux</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00080">step-67.cc:80</a></div></div>
<div class="ttc" id="astructDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2data__out__base_8h_source.html#l01065">data_out_base.h:1065</a></div></div>
<div class="ttc" id="aclassQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="aclassEuler__DG_1_1ExactSolution_html_a16ae78e70f688acd015b407649997f1b"><div class="ttname"><a href="classEuler__DG_1_1ExactSolution.html#a16ae78e70f688acd015b407649997f1b">Euler_DG::ExactSolution::value</a></div><div class="ttdeci">virtual double value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const override</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00105">step-67.cc:105</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_adc634dce0c07c9dbb94d367c8d97afd3"><div class="ttname"><a href="namespaceEuler__DG.html#adc634dce0c07c9dbb94d367c8d97afd3">Euler_DG::dimension</a></div><div class="ttdeci">constexpr unsigned int dimension</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00059">step-67.cc:59</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a06c22b6c094649ae4190e006e4598f54"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a06c22b6c094649ae4190e006e4598f54">scheme</a></div><div class="ttdeci">in the complex step the imaginary value effectively serves this purpose The choice of the perturbation parameter determines the numerical qualities of the scheme</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00058">automatic_and_symbolic_differentiation_0.txt:58</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_ae1cc4c5ec49b9998f5dc924707c29ed4"><div class="ttname"><a href="namespaceEuler__DG.html#ae1cc4c5ec49b9998f5dc924707c29ed4">Euler_DG::final_time</a></div><div class="ttdeci">constexpr double final_time</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00067">step-67.cc:67</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_a96ecfde131843f52ee49d0e0c1180134"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#a96ecfde131843f52ee49d0e0c1180134">time</a></div><div class="ttdeci">computing derivatives of these terms is impractical in most applications in impossible to get right Higher derivatives are even more impossible to do without computer aid Automatic or symbolic differentiation is a way out of and gets compile time</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00012">automatic_and_symbolic_differentiation_0.txt:12</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeade3f4c40082ead56c7aef5e90e43242f">EvaluationFlags::values</a></div><div class="ttdeci">@ values</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__flags_8h_source.html#l00055">evaluation_flags.h:55</a></div></div>
<div class="ttc" id="aclassLogStream_html_a8028e970ad8388596d625ed463894e98"><div class="ttname"><a href="classLogStream.html#a8028e970ad8388596d625ed463894e98">LogStream::depth_console</a></div><div class="ttdeci">unsigned int depth_console(const unsigned int n)</div><div class="ttdef"><b>Definition:</b> <a href="logstream_8cc_source.html#l00350">logstream.cc:350</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="aclassDataOutInterface_html_a5df488dad82b811ceb08cb1adf9eafcd"><div class="ttname"><a href="classDataOutInterface.html#a5df488dad82b811ceb08cb1adf9eafcd">DataOutInterface::write_vtu_in_parallel</a></div><div class="ttdeci">void write_vtu_in_parallel(const std::string &amp;filename, const MPI_Comm &amp;comm) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07254">data_out_base.cc:7254</a></div></div>
<div class="ttc" id="adistributed_2tria_8h_html"><div class="ttname"><a href="distributed_2tria_8h.html">tria.h</a></div></div>
<div class="ttc" id="aclassAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints&lt; double &gt;</a></div></div>
<div class="ttc" id="aeigen__0_8txt_html_a31a872680c9082cbe8bf86c82a743059"><div class="ttname"><a href="eigen__0_8txt.html#a31a872680c9082cbe8bf86c82a743059">eigenvector</a></div><div class="ttdeci">*Power the iteration vectors will become aligned to its eigenspace and *[2.x.1] A shift parameter allows to shift the so it is possible to compute the smallest too *Convergence of this method is known to be slow ***Declare type of container size **Standardized data struct to pipe additional data to the solver **Shift parameter This parameter allows to shift the spectrum to compute a different eigenvalue **Constructor Set the shift parameter **Constructor **Power method[2.x.2] is is the approximated eigenvalue and[2.x.4] is the corresponding eigenvector</div><div class="ttdef"><b>Definition:</b> <a href="eigen__0_8txt_source.html#l00019">eigen_0.txt:19</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a9e95f82901b9cff1c83f61cc1851e876"><div class="ttname"><a href="namespaceEuler__DG.html#a9e95f82901b9cff1c83f61cc1851e876">Euler_DG::lsrk_scheme</a></div><div class="ttdeci">constexpr LowStorageRungeKuttaScheme lsrk_scheme</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00078">step-67.cc:78</a></div></div>
<div class="ttc" id="aclassTimeStepping_1_1LowStorageRungeKutta_html"><div class="ttname"><a href="classTimeStepping_1_1LowStorageRungeKutta.html">TimeStepping::LowStorageRungeKutta</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00678">time_stepping.h:678</a></div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdeci">@ update_JxW_values</div><div class="ttdoc">Transformed quadrature weights.</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00124">fe_update_flags.h:124</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html"><div class="ttname"><a href="namespaceEuler__DG.html">Euler_DG</a></div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00054">step-67.cc:54</a></div></div>
<div class="ttc" id="abase_2conditional__ostream_8h_html"><div class="ttname"><a href="base_2conditional__ostream_8h.html">conditional_ostream.h</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a895dcd8223a0ee6f0e6a80b80e2d5982"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a895dcd8223a0ee6f0e6a80b80e2d5982">Utilities::MPI::this_mpi_process</a></div><div class="ttdeci">unsigned int this_mpi_process(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00128">mpi.cc:128</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330"><div class="ttname"><a href="namespaceEuler__DG.html#a1f88889f7c8db89c0938581e6d060f70a59bc91455527f1700e3892a88deaa330">Euler_DG::stage_7_order_4</a></div><div class="ttdeci">@ stage_7_order_4</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00075">step-67.cc:75</a></div></div>
<div class="ttc" id="amatrix__free_2matrix__free_8h_html"><div class="ttname"><a href="matrix__free_2matrix__free_8h.html">matrix_free.h</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a97f5a52d591176fc9a31d4a477760a4a"><div class="ttname"><a href="namespaceEuler__DG.html#a97f5a52d591176fc9a31d4a477760a4a">Euler_DG::evaluate_function</a></div><div class="ttdeci">VectorizedArray&lt; Number &gt; evaluate_function(const Function&lt; dim &gt; &amp;function, const Point&lt; dim, VectorizedArray&lt; Number &gt;&gt; &amp;p_vectorized, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00377">step-67.cc:377</a></div></div>
<div class="ttc" id="anamespaceUtilities_html_a17955af7a4bc8771d430e622f9e732b3"><div class="ttname"><a href="namespaceUtilities.html#a17955af7a4bc8771d430e622f9e732b3">Utilities::truncate_to_n_digits</a></div><div class="ttdeci">Number truncate_to_n_digits(const Number number, const unsigned int n_digits)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00581">utilities.cc:581</a></div></div>
<div class="ttc" id="afe__q__0_8txt_html_a1a8eaafa20c4d8c9ab128b62a984738c"><div class="ttname"><a href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a></div><div class="ttdeci">*Implementation of a scalar Lagrange finite element[2.x.0] that yields the finite element space of piecewise polynomials of degree[2.x.1] in each coordinate direction This class is realized using tensor product polynomials based on D Lagrange polynomials with Gauss or given support points *The standard constructor of this class takes the degree[2.x.2] of this finite element it can take a quadrature formula[2.x.3] defining the support points of the Lagrange interpolation in one coordinate direction *For more information about the&lt; tt &gt; spacedim&lt;/tt &gt; template parameter check the documentation of FiniteElement or the one of Triangulation **The constructor creates a TensorProductPolynomials object that includes the tensor product of[2.x.4] polynomials of degree[2.x.5] This[2.x.6] object provides all values and derivatives of the shape functions In case a quadrature rule is the constructor creates a TensorProductPolynomials object that includes the tensor product of[2.x.7] polynomials with the support points from *[2.x.8] Furthermore the constructor fills the[2.x.9] the[2.x.10] equidistant support points at i where one polynomial is one and all the others are zero For higher polynomial degrees</div><div class="ttdef"><b>Definition:</b> <a href="fe__q__0_8txt_source.html#l00009">fe_q_0.txt:9</a></div></div>
<div class="ttc" id="adofs_2dof__handler_8h_html"><div class="ttname"><a href="dofs_2dof__handler_8h.html">dof_handler.h</a></div></div>
<div class="ttc" id="aupdate__flags__0_8txt_html_ac8b7167f13d273c0000a680958db42c5"><div class="ttname"><a href="update__flags__0_8txt.html#ac8b7167f13d273c0000a680958db42c5">flags</a></div><div class="ttdeci">this property does not hold for the shape functions of Raviart Thomas which must be rotated with the cell This allows further optimization of the computations underlying assembly ***Let s say you want to compute the Laplace matrix as shown above In that you need to specify the[2.x.20] the finite element requires the computation of the inverse of the full Jacobian and not just the determinant of the and to compute the inverse of the it is also necessary to compute the Jacobian matrix first *Since these are requirements that are not important to the it is not necessary to specify this in user code given a set of update flags</div><div class="ttdef"><b>Definition:</b> <a href="update__flags__0_8txt_source.html#l00026">update_flags_0.txt:26</a></div></div>
<div class="ttc" id="asparse__decomposition__0_8txt_html_aa36e69f7b51d00cbf24c899c1490950c"><div class="ttname"><a href="sparse__decomposition__0_8txt.html#aa36e69f7b51d00cbf24c899c1490950c">factor</a></div><div class="ttdeci">Preconditioners *[2.x.1] **Abstract base class for incomplete decompositions of a sparse matrix into sparse factors This class can t be used by itself but only as the base class of derived classes that actually implement particular decompositions such as SparseILU or SparseMIC *The decomposition is stored as a sparse matrix which is why this class is derived from the SparseMatrix Since it is not a matrix in the usual the derivation is&lt; tt &gt; protected&lt;/tt &gt; rather than&lt; tt &gt; public&lt;/tt &gt; ***Sparse decompositions are frequently used with additional fill i the sparsity structure of the decomposition is denser than that of the matrix to be decomposed The i e the sparsity pattern of the decomposition is a superset of the sparsity pattern in the original matrix *Such fill in can be accomplished by various one of which is the copy constructor of the SparsityPattern class that allows the addition of side diagonals to a given sparsity structure ***While objects of this class can not be used derived classes such as SparseILU and SparseMIC can be used in the usual form as preconditioners For this each it copies the sparsity of[2.x.3] and adds a specific number of extra off diagonal entries specified by *[2.x.4] By setting[2.x.5] the sparsity is not recreated but the sparsity of the previous as for example several Newton iteration steps on the same triangulation The default is *[2.x.6] It is possible to give a user defined sparsity to[2.x.7] no sparsity is created but[2.x.8] is used to store the decomposed matrix For restrictions on the sparsity see section Fill in above ***It is enough to override the like the true or the Cholesky decomposition if that decomposition needs fine tuned diagonal strengthening on a per row it may override the but only its derived classes **Deletes all member variables Leaves the class in the state that it had directly after calling the constructor **Parameters for SparseDecomposition **Constructor For the parameters see below **times the sum of absolute row entries is added to the diagonal entries Per this value is i e the diagonal is not strengthened **By the[2.x.10] function creates its own sparsity This sparsity has the same SparsityPattern as[2.x.11] with some extra off diagonals the number of which is specified by[2.x.12] The user can give a SparsityPattern to[2.x.13] Then this sparsity is used and the[2.x.14] argument is ignored **If this flag is true the as for example several Newton iteration steps on the same triangulation **When a SparsityPattern is given to this the as well as filtering out some elements in the matrix **This function needs to be called before an object of this class is used as preconditioner For more detail about possible parameters see the class documentation and the documentation of the[2.x.17] class According to this function creates a new SparsityPattern or keeps the previous sparsity or takes the sparsity given by the user to[2.x.19] this function performs the LU decomposition After this function is called the preconditioner is ready to be determines the strengthening factor(through get_strengthen_diagonal()) sf and multiplies the diagonal entry with[2.x.28] . *[0.x.23] *In the decomposition phase</div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a15a97d9432812b335c3cd599fab65eb0"><div class="ttname"><a href="namespaceEuler__DG.html#a15a97d9432812b335c3cd599fab65eb0">Euler_DG::courant_number</a></div><div class="ttdeci">const double courant_number</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00070">step-67.cc:70</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ac26de0c059200523177bb1d92cc25d00"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ac26de0c059200523177bb1d92cc25d00">Utilities::MPI::n_mpi_processes</a></div><div class="ttdeci">unsigned int n_mpi_processes(const MPI_Comm &amp;mpi_communicator)</div><div class="ttdef"><b>Definition:</b> <a href="mpi_8cc_source.html#l00117">mpi.cc:117</a></div></div>
<div class="ttc" id="abase_2vectorization_8h_html"><div class="ttname"><a href="base_2vectorization_8h.html">vectorization.h</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a2c18ee2cbc27a18e5d9d4565bf6848e8"><div class="ttname"><a href="namespaceEuler__DG.html#a2c18ee2cbc27a18e5d9d4565bf6848e8">Euler_DG::fe_degree</a></div><div class="ttdeci">constexpr unsigned int fe_degree</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00061">step-67.cc:61</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_a6365596c7d2490c474cd0b7ce9722b37"><div class="ttname"><a href="iterators__0_8txt.html#a6365596c7d2490c474cd0b7ce9722b37">calls</a></div><div class="ttdeci">it does so for both DoFHandler and[2.x.14] objects Note that the DoFAccessor class is derived from either TriaAccessor or the DoFAccessor class comes in two flavors one accessing degrees of freedom on the level of a cell and the other accessing the active dofs of an active cell **The DoFCellAccessor class has the same purpose and relation to DoFCellAccessor as the CellAccessor has to TriaAccessor *Except to look up member you will not usually have to deal withthe actual class names listed above Rather one uses the typedefs provided bythe mesh classes Triangulation DoFHandler and[2.x.15] as wellas the function that generate such buta hexahedron there are corresponding types and calls like[2.x.34] that act on thedimension independent geometric objects and hex These calls</div><div class="ttdef"><b>Definition:</b> <a href="iterators__0_8txt_source.html#l00076">iterators_0.txt:76</a></div></div>
<div class="ttc" id="acuda__matrix__free__0_8txt_html_a747ffbda88fa48702c72f4b04f9c5721"><div class="ttname"><a href="cuda__matrix__free__0_8txt.html#a747ffbda88fa48702c72f4b04f9c5721">JxW</a></div><div class="ttdeci">*This class collects all the data that is stored for the matrix free implementation The storage scheme is tailored towards several loops performed with the same data i e typically doing many matrix vector products or residual computations on the same mesh This class does not implement any operations involving finite element basis functions i e regarding the operation performed on the cells For these operations the class FEEvaluation is designed to use the data collected in this class This class implements a loop over all which implies that it is possible to write to vectors in parallel without having to explicitly synchronize access to these vectors and matrices This class does not implement any shape values all it does is to cache the respective data To implement finite element operations use the class[2.x.0] This class traverse the cells in a different order than the usual Triangulation class in deal II *Only float and double are supported ***Parallelization scheme parallelization over degrees of freedom or over cells **This flag is used to determine which quantities should be cached This class can cache data needed for gradient Jacobian quadrature points as well as data for only data for gradients and Jacobian determinants times quadrature JxW</div><div class="ttdef"><b>Definition:</b> <a href="cuda__matrix__free__0_8txt_source.html#l00014">cuda_matrix_free_0.txt:14</a></div></div>
<div class="ttc" id="aprecondition__block__base__0_8txt_html_aba039b811c123042272605d7c7c7c726"><div class="ttname"><a href="precondition__block__base__0_8txt.html#aba039b811c123042272605d7c7c7c726">inverse</a></div><div class="ttdeci">*A class storing the inverse diagonal blocks for block preconditioners and block relaxation methods *This class does the book keeping for preconditioners and relaxation methods based on inverting blocks on the diagonal of a matrix It allows us to either store all diagonal blocks and their inverses or the same block for each entry and it keeps track of the choice Thus after initializing it and filling the inverse diagonal blocks correctly a derived class can use inverse() with an integer argument referring to the block number. *Additionally</div></div>
<div class="ttc" id="amatrix__free_2fe__evaluation_8h_html"><div class="ttname"><a href="matrix__free_2fe__evaluation_8h.html">fe_evaluation.h</a></div></div>
<div class="ttc" id="aclassConditionalOStream_html"><div class="ttname"><a href="classConditionalOStream.html">ConditionalOStream</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2conditional__ostream_8h_source.html#l00083">conditional_ostream.h:83</a></div></div>
<div class="ttc" id="ascalapack__0_8txt_html_ac82ea4a38e10783662981895e0a99f43"><div class="ttname"><a href="scalapack__0_8txt.html#ac82ea4a38e10783662981895e0a99f43">processes</a></div><div class="ttdeci">*A wrapper class around ScaLAPACK parallel dense linear algebra *ScaLAPACK assumes that matrices are distributed according to the block cyclic decomposition scheme An[2.x.0] by[2.x.1] matrix is first decomposed into[2.x.2] by[2.x.3] blocks which are then uniformly distributed across the process grid with[2.x.4] processes</div><div class="ttdef"><b>Definition:</b> <a href="scalapack__0_8txt_source.html#l00002">scalapack_0.txt:2</a></div></div>
<div class="ttc" id="anamespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4a552fa44afc1945f709476f483ea8958b">TimeStepping::LOW_STORAGE_RK_STAGE7_ORDER4</a></div><div class="ttdeci">@ LOW_STORAGE_RK_STAGE7_ORDER4</div><div class="ttdef"><b>Definition:</b> <a href="base_2time__stepping_8h_source.html#l00320">time_stepping.h:320</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_a9ac5275c3c74902f8a9d6e7bdb514179"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9ac5275c3c74902f8a9d6e7bdb514179">Utilities::MPI::min</a></div><div class="ttdeci">T min(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="aclassPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="achunk__sparse__matrix__0_8txt_html_a59317914f0b63e3c2c7c6bd150b8ba3e"><div class="ttname"><a href="chunk__sparse__matrix__0_8txt.html#a59317914f0b63e3c2c7c6bd150b8ba3e">matrix</a></div><div class="ttdeci">0&lt;/tt &gt;, which sets all elements of the matrix to zero, but keep the sparsity pattern previously used. *[0.x.66] *Reinitialize the sparse matrix with the given sparsity pattern. The latter tells the matrix how many nonzero elements there need to be reserved. Regarding memory allocation, the same applies as said above. You have to make sure that the lifetime of the sparsity structure is at least as long as that of this matrix or as long as reinit(const ChunkSparsityPattern &amp;) is not called with a new sparsity structure. The elements of the matrix are set to zero by this function. *[0.x.67] *Release all memory and return to a state just like after having called the default constructor. It also forgets the sparsity pattern it was previously tied to. *[0.x.68] *[2.x.18] Information on the matrix *[0.x.69] *Return whether the object is empty. It is empty if either both dimensions are zero or no ChunkSparsityPattern is associated. *[0.x.70] *Return the dimension of the codomain(or range) space. Note that the matrix is of dimension[2.x.19] . *[0.x.71] *Return the dimension of the domain space. Note that the matrix is of dimension[2.x.20] . *[0.x.72] *Return the number of nonzero elements of this matrix. Actually, it returns the number of entries in the sparsity pattern matrix</div><div class="ttdef"><b>Definition:</b> <a href="chunk__sparse__matrix__0_8txt_source.html#l00156">chunk_sparse_matrix_0.txt:156</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1System_html_ade631a789101336840371e3b2e2851e0"><div class="ttname"><a href="namespaceUtilities_1_1System.html#ade631a789101336840371e3b2e2851e0">Utilities::System::get_current_vectorization_level</a></div><div class="ttdeci">const std::string get_current_vectorization_level()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00944">utilities.cc:944</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_ad3b9cdeadeb3bcdb52af5db70c041a6e"><div class="ttname"><a href="fe__evaluation__0_8txt.html#ad3b9cdeadeb3bcdb52af5db70c041a6e">fe</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **static The number of degrees of freedom of all components determined from the given template argument fe_degree Note that the actual number of degrees of freedom dofs_per_cell can be different if such as FE_DGP **Constructor Takes all data stored in MatrixFree If applied to problems with more than one finite element or more than one quadrature formula selected during construction of[2.x.343] the appropriate component can be selected by the optional arguments[2.x.344] matrix_free Data object that contains all data[2.x.345] dof_no If matrix_free was set up with multiple DoFHandler this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.346] quad_no If matrix_free was set up with multiple Quadrature this parameter selects the appropriate number of the quadrature formula[2.x.347] first_selected_component If the dof_handler selected by dof_no uses an FESystem consisting of more than one this parameter allows for selecting the component where the current evaluation routine should start Note that one evaluator does not support combining different shape functions in different components In other the same base element of a FESystem needs to be set for the components between[2.x.348] and[2.x.349][2.x.350] active_fe_index If matrix_free was set up with DoFHandler objects with[2.x.351] this parameter selects to which DoFHandler AffineConstraints pair the given evaluator should be attached to[2.x.352] active_quad_index If matrix_free was set up with[2.x.353] this parameter selects the appropriate number of the quadrature formula **Constructor Takes all data stored in MatrixFree for a given cell which allows to automatically identify the active_fe_index and active_quad_index in case of a p adaptive strategy The rest of the arguments are the same as in the constructor above **Constructor that comes with reduced functionality and works similar as FEValues The arguments are similar to the ones passed to the constructor of with the notable difference that FEEvaluation expects a one dimensional quadrature instead of a[2.x.354] dimensional one The finite element can be both scalar or vector but this method always only selects a scalar base element at a the optional argument[2.x.356] allows to specify the index of the base element to be used for evaluation Note that the internal data structures always assume that the base element is non primitive are not supported currently As known from a call to the reinit method with a[2.x.357] is necessary to make the geometry and degrees of freedom of the current class known::If the iterator includes DoFHandler the initialization allows to also read from or write to vectors in the standard way for[2.x.359] types for one cell at a time this approach is much slower than the path with MatrixFree with MPI since index translation has to be done As only one cell at a time is this method does not vectorize over several but only possibly within the element if the evaluate integrate routines are combined inside user an object of type i the underlying mapping and quadrature points do only need to be evaluated once Make sure to not pass an optional object around when you intend to use the FEEvaluation object in parallel to the given one because otherwise the intended sharing may create race conditions **Copy constructor If FEEvaluationBase was constructed from a fe</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00555">fe_evaluation_0.txt:555</a></div></div>
<div class="ttc" id="aglobal__dof__index__0_8txt_html_a2b84b1d42e4fde15bdf79726ce1cc907"><div class="ttname"><a href="global__dof__index__0_8txt.html#a2b84b1d42e4fde15bdf79726ce1cc907">normal</a></div><div class="ttdeci">**deal II can be configured to use bit indices for degrees of rather than the usual unsigned integers that default to bit on most current systems This is necessary since we want to be able to solve problems with more than billion we do not want to indiscriminately replace all integers in deal II with bit since this would increase memory use in many places where we represent quantities that will most definitely not be larger than billion *The data type we define for these indices to keep the bulk of the code base free of[2.x.1] s is[2.x.2] If deal II is configured as normal</div><div class="ttdef"><b>Definition:</b> <a href="global__dof__index__0_8txt_source.html#l00004">global_dof_index_0.txt:4</a></div></div>
<div class="ttc" id="atable__handler__0_8txt_html_a61e9964f9093088848525ca172895749"><div class="ttname"><a href="table__handler__0_8txt.html#a61e9964f9093088848525ca172895749">step</a></div><div class="ttdeci">the ConvergenceTable class does something like this *To support both the TableHandler class has a property called[1.x.4] By auto fill mode is but it can be enabled by calling set_auto_fill_mode(). If auto-fill mode is enabled we use the following algorithm call it *[2.x.18] ***If[2.x.19] then we add[2.x.20] copies of the object[2.x.21] to this column is the data type of the given[2.x.23] is a numeric then[2.x.24] is[2.x.25] is the empty string *[2.x.26] ***Add the given value to this column *Padding the column with default elements makes sure that after the addition the column has as many entries as the longest other column In other if we have skipped previous invocations of then the padding will enter default values into this column *The algorithm as described will fail if you try to skip adding values for a key if adding an element for this key is the first thing you want to do for a given iteration or time step</div><div class="ttdef"><b>Definition:</b> <a href="table__handler__0_8txt_source.html#l00070">table_handler_0.txt:70</a></div></div>
<div class="ttc" id="anamespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea84d99583fd787b7e846f9e4b6f7c97c0"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea84d99583fd787b7e846f9e4b6f7c97c0">EvaluationFlags::nothing</a></div><div class="ttdeci">@ nothing</div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2evaluation__flags_8h_source.html#l00050">evaluation_flags.h:50</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a286a4c601bf0caec1702358838814327"><div class="ttname"><a href="namespaceEuler__DG.html#a286a4c601bf0caec1702358838814327">Euler_DG::gamma</a></div><div class="ttdeci">constexpr double gamma</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00066">step-67.cc:66</a></div></div>
<div class="ttc" id="aclassFEEvaluation_html"><div class="ttname"><a href="classFEEvaluation.html">FEEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2fe__evaluation_8h_source.html#l00070">fe_evaluation.h:70</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_adad35057b6e70ae37d4abe7878683d90"><div class="ttname"><a href="coding__conventions__0_8txt.html#adad35057b6e70ae37d4abe7878683d90">face</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per the child indices of the child cells adjacent to face</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="adata__postprocessor__0_8txt_html_abfdf708e97518fa7ad2b849b80afddc1"><div class="ttname"><a href="data__postprocessor__0_8txt.html#abfdf708e97518fa7ad2b849b80afddc1">get_needed_update_flags</a></div><div class="ttdeci">is not the size of the solution then if the solution is real valued the solution_values variable below will be an array with as many entries as there are evaluation points on a and each entry is a vector of length[2.x.31] representing the[2.x.32] solution functions evaluated at a point On the other if the solution is complex then the solution_values member variable of this class will have[2.x.34] entries for each evaluation point The first[2.x.35] of these entries represent the real parts of the and the second[2.x.36] entries correspond to the imaginary parts of the solution evaluated at the evaluation point The same layout is used for the solution_gradients and solution_hessians then all the gradients Hessians of the imaginary components There is more information about the subject in the documentation of the DataPostprocessor class itself[2.x.37] provides an example of how this class is used in a complex valued situation Through the fields in the CommonInputs base class this class also makes available access to the locations of evaluations points normal and which cell data is currently being evaluated or other object The outer vector runs over the evaluation whereas the inner vector runs over the components of the finite element field for which output will be generated **An array of gradients of a vector valued solution at each of the evaluation points used to create graphical output from one or other object The outer vector runs over the evaluation whereas the inner vector runs over the components of the finite element field for which output will be generated This array is only filled if a user derived class overloads the[2.x.38] and the function a class derived from DataPostprocessorScalar DataPostprocessorVector or DataPostprocessorTensor may pass this flag to the constructor of these three classes **An array of second derivatives of a vector valued solution at each of the evaluation points used to create graphical output from one or other object The outer vector runs over the evaluation whereas the inner vector runs over the components of the finite element field for which output will be generated This array is only filled if a user derived class overloads the[2.x.40] and the function a class derived from DataPostprocessorScalar DataPostprocessorVector or DataPostprocessorTensor may pass this flag to the constructor of these three classes **This class provides an interface to compute derived quantities from a solution that can then be output in graphical formats for visualization using facilities such as the DataOut class *For which are calculated from the values of the solution and possibly the first and second derivatives of the solution Examples are the calculation of Mach numbers from velocity and density in supersonic flow or the computation of the magnitude of a complex valued solution as demonstrated in[2.x.42] the functions of this class can be overloaded to compute new quantities *A data vector and an object of a class derived from the current one can be given to the[2.x.46] in reality the object of your derived class has to live until the DataOut object is destroyed as the latter keeps a pointer to the former and will complain if the object pointed to is destroyed while the latter still has a pointer to it If both the data postprocessor and DataOut objects are variables of a then you can avoid this error by declaring the data postprocessor variable before the DataOut variable as objects are destroyed in reverse order of declaration *In order not to perform needless DataPostprocessor has to provide information which input data is needed for the calculation of the derived i e whether it needs the the first derivative and or the second derivative of the provided data DataPostprocessor objects which are used in combination with a DataOutFaces object can also ask for the normal vectors at each point The information which data is needed has to be provided via the UpdateFlags returned by virtual the function get_needed_update_flags(). It is your responsibility to use only those values which were updated in the calculation of derived quantities. The DataOut object will provide references to the requested data in the call to evaluate_scalar_field() or evaluate_vector_field()(DataOut decides which of the two functions to call depending on whether the finite element in use has only a single</div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdaeae4878b1e562785c1c196238a3f14e0">VectorTools::EvaluationFlags::min</a></div><div class="ttdeci">@ min</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00062">vector_tools_evaluate.h:62</a></div></div>
<div class="ttc" id="aclassFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2function_8h_source.html#l00140">function.h:140</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_ac639e1db0b03fc797eca55e266afa976"><div class="ttname"><a href="coding__conventions__0_8txt.html#ac639e1db0b03fc797eca55e266afa976">cell</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each three empty lines are expected to enable better readability One empty line occurs in functions to group blocks of since two empty lines are not enough to visibly distinguish sufficiently that the code belongs to two different functions *[2.x.21] Whenever an integer variable can only assume nonnegative it is marked as unsigned The same applies to functions that can only return positive or zero values it should be marked even if passed by value we mark input parameters as const This aids as an additional documentation tool to clarify the intent of a which is often either involuntarily or poor style *[2.x.25] Whenever a function does not change any of the member variable of the embedding class it should be marked as const  *[2.x.27] Function and variable names may not consist of only one or two unless the variable is a pure counting index *[2.x.29] Type the number of children per cell</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00027">coding_conventions_0.txt:27</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_af4e7aa3afa2e7a87c8383130df92f1f4"><div class="ttname"><a href="namespaceEuler__DG.html#af4e7aa3afa2e7a87c8383130df92f1f4">Euler_DG::output_tick</a></div><div class="ttdeci">constexpr double output_tick</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00068">step-67.cc:68</a></div></div>
<div class="ttc" id="aginkgo__solver__0_8txt_html_a3cb670365d7110cc15bb987ccf4160e6"><div class="ttname"><a href="ginkgo__solver__0_8txt.html#a3cb670365d7110cc15bb987ccf4160e6">apply</a></div><div class="ttdeci">solver apply(lend(rhs), lend(solution))</div></div>
<div class="ttc" id="anamespaceStep37_html_a92034819b3a2b370b456b2e415e24f55"><div class="ttname"><a href="namespaceStep37.html#a92034819b3a2b370b456b2e415e24f55">Step37::dimension</a></div><div class="ttdeci">const unsigned int dimension</div><div class="ttdef"><b>Definition:</b> <a href="step-37_8cc_source.html#l00060">step-37.cc:60</a></div></div>
<div class="ttc" id="aoperator__0_8txt_html_a48b6a07d6667882c8b9555b97d3a9894"><div class="ttname"><a href="operator__0_8txt.html#a48b6a07d6667882c8b9555b97d3a9894">Operator</a></div><div class="ttdeci">namespace are derived from either Operator or OutputOperator depending on whether they return a value or not See the documentation of those classes for more detailed information on how to use them ***Update this documentation and the one of Operator abstract The base class of all algorithms in this library An which transforms a set of named vectors into another set of named vectors an which could be for instance a change of a different time step size or too slow convergence of Newton s which would then trigger reassembling of a matrix or similar things[1.x.0] This is probably the most prominent use for Operator</div><div class="ttdef"><b>Definition:</b> <a href="operator__0_8txt_source.html#l00007">operator_0.txt:7</a></div></div>
<div class="ttc" id="abase_2partitioner__0_8txt_html_a6d2d0fa485d1660823c59c494fb0fb31"><div class="ttname"><a href="base_2partitioner__0_8txt.html#a6d2d0fa485d1660823c59c494fb0fb31">MPI</a></div><div class="ttdeci">*This class defines a model for the partitioning of a it includes a structure for the point to point communication patterns It allows the inclusion of ghost it also stores the other processors ghost indices belonging to the current which are the indices where other processors might require information from In a these import indices form the dual of the ghost indices This information is gathered once when constructing the which obviates subsequent global communication steps when exchanging data The figure below gives an example of index space[2.x.2] being split into four parts that are each owned by one MPI the next four lines indicate which elements of the overall array each processor wants to know about **this is generally a superset of the locally owned with the difference being what are called ghost elements To understand the remaining pieces of the remember that in MPI</div><div class="ttdef"><b>Definition:</b> <a href="base_2partitioner__0_8txt_source.html#l00004">partitioner_0.txt:4</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a143bc64b6fa6ced9f11c148a2af3ff09"><div class="ttname"><a href="namespaceEuler__DG.html#a143bc64b6fa6ced9f11c148a2af3ff09">Euler_DG::Number</a></div><div class="ttdeci">double Number</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00064">step-67.cc:64</a></div></div>
<div class="ttc" id="anamespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a></div><div class="ttdeci">DataComponentInterpretation</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__component__interpretation_8h_source.html#l00048">data_component_interpretation.h:48</a></div></div>
<div class="ttc" id="aclassFEFaceEvaluation_html"><div class="ttname"><a href="classFEFaceEvaluation.html">FEFaceEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_2fe__evaluation_8h_source.html#l03134">fe_evaluation.h:3134</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed"><div class="ttname"><a href="namespaceEuler__DG.html#a55c27d06e5e51d70be744612e5cfaf45a7123be3be63c53d685501dd0e47bffed">Euler_DG::lax_friedrichs_modified</a></div><div class="ttdeci">@ lax_friedrichs_modified</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00082">step-67.cc:82</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabaecdd1343aae63b652a2edeab0c19f9">VectorTools::EvaluationFlags::max</a></div><div class="ttdeci">@ max</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00056">vector_tools_evaluate.h:56</a></div></div>
<div class="ttc" id="anumerics_2data__out_8h_html"><div class="ttname"><a href="numerics_2data__out_8h.html">data_out.h</a></div></div>
<div class="ttc" id="anamespaceVectorTools_1_1EvaluationFlags_html_ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57"><div class="ttname"><a href="namespaceVectorTools_1_1EvaluationFlags.html#ac6721740e24732d6afabcf28ddfc1ffdabac642e2a7fa591bce14af7dffe97e57">VectorTools::EvaluationFlags::avg</a></div><div class="ttdeci">@ avg</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2vector__tools__evaluate_8h_source.html#l00050">vector_tools_evaluate.h:50</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_aa4c22a167177d2942bb11e424ff38c6c"><div class="ttname"><a href="namespaceEuler__DG.html#aa4c22a167177d2942bb11e424ff38c6c">Euler_DG::euler_pressure</a></div><div class="ttdeci">Number euler_pressure(const Tensor&lt; 1, dim+2, Number &gt; &amp;conserved_variables)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00270">step-67.cc:270</a></div></div>
<div class="ttc" id="aclassDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut&lt; dim &gt;</a></div></div>
<div class="ttc" id="anamespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="base_2numbers_8h_source.html#l00237">numbers.h:237</a></div></div>
<div class="ttc" id="agrid_2grid__refinement__0_8txt_html_a9a3fd18a091a09eb3271ac489b2ba245"><div class="ttname"><a href="grid_2grid__refinement__0_8txt.html#a9a3fd18a091a09eb3271ac489b2ba245">errors</a></div><div class="ttdeci">and others ******Return a pair of double values of which the first is adjusted refinement fraction of cells and the second is adjusted coarsening fraction of cells[2.x.1] current_n_cells The current cell number[2.x.2] max_n_cells The maximal number of cells If current cell number[2.x.3] is already exceeded maximal cell number[2.x.4] refinement fraction of cells will be set to zero and coarsening fraction of cells will be adjusted to reduce cell number to max_n_cells If cell number is going to be exceeded only upon then refinement and coarsening fractions are going to be adjusted with a same ratio in an attempt to reach the maximum number of cells Be aware though that through proliferation of refinement due to[2.x.5] this number is only an indicator The default value of this argument is to impose no limit on the number of cells[2.x.6] top_fraction_of_cells The requested fraction of active cells to be refined[2.x.7] bottom_fraction_of_cells The requested fraction of active cells to be coarsened *Usually you do not need to call this function explicitly Pass[2.x.9] max_n_cells to function refine_and_coarsen_fixed_number() or function refine_and_coarsen_fixed_fraction() and they will call this function if necessary. *[0.x.2] *This function provides a strategy to mark cells for refinement and coarsening with the goal of providing predictable growth in the size of the mesh by refining a given fraction of all cells. The function takes a vector of refinement[2.x.10] and two values between zero and one denoting the fractions of cells to be refined and coarsened. It flags cells for further processing by[2.x.11] according to the following greedy algorithm rfler this function computes the thresholds for refinement and coarsening such that the[2.x.33] of cells getting flagged for refinement make up for a certain fraction of the total error We explain its operation for coarsening works analogously Let[1.x.3] be the criterion of cell[1.x.4] Then the total error estimate is computed by the formula[1.x.5] If[1.x.6] is[2.x.34] then we refine the smallest subset[2.x.35] of the Triangulation[2.x.36] such that[1.x.7] The algorithm is performed by the greedy algorithm described in this time we really need to sort the array of criteria Just like the other strategy described this function only computes the threshold values and then passes over to no cells will be refined If it equals the result will be flagging for global refinement[2.x.42] bottom_fraction The fraction of the estimate coarsened If this number is no cells will be coarsened[2.x.43] max_n_cells This argument can be used to specify a maximal number of cells If this number is going to be exceeded upon then refinement and coarsening fractions are going to be adjusted in an attempt to reach the maximum number of cells Be aware though that through proliferation of refinement due to[2.x.44] this number is only an indicator The default value of this argument is to impose no limit on the number of cells[2.x.45] norm_type To determine combined errors on subsets of cells are calculated as norms of the criteria on these cells Different types of norms can be used for this from which[2.x.46] and[2.x.47] are currently supported **This function flags cells of a triangulation for refinement with the aim to reach a grid that is optimal with respect to an objective function that tries to balance reducing the error and increasing the numerical cost when the mesh is refined this function makes the assumption that if you refine a cell[2.x.48] with error indicator[2.x.49] provided by the second argument to this then the error on the but not for the usual Galerkin although it is approximately true for elliptic problems where the Greens function decays quickly and the error here is not too much affected by a too coarse mesh somewhere else With we can define the objective function this function tries to optimize Let us assume that the mesh currently has[2.x.52] cells if we refine the[2.x.53] cells with the largest errors</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement__0_8txt_source.html#l00024">grid_refinement_0.txt:24</a></div></div>
<div class="ttc" id="afe__evaluation__0_8txt_html_a66b432045b82ed9b1c850f6407d4b1ca"><div class="ttname"><a href="fe__evaluation__0_8txt.html#a66b432045b82ed9b1c850f6407d4b1ca">fe_degree</a></div><div class="ttdeci">FE_Q with hanging node constraints connects to more neighbors than a FE_DGQ for and cells which need data exchange are put in different positions inside the cell loop Of if the exact same and then the order is going to be the same because the algorithm is deterministic *dim Dimension in which this class is to be used *fe_degree Degree of the tensor product finite element with fe_degree degrees of freedom per coordinate direction Can be set to **if the degree is not known at compile but performance will usually be worse by a factor of *n_q_points_1d Number of points in the quadrature formula defaults to fe_degree *n_components Number of vector components when solving a system of PDEs If the same operation is applied to several components of a they can be applied simultaneously with one usually[2.x.339] or[2.x.340] Defaults to[2.x.341] double ******An alias to the base class **An underlying number type specified as template argument **The type of function e g VectorizedArrayType for e g Tensor&lt; 1, dim, VectorizedArrayType &gt; for can be different if fe_degree</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation__0_8txt_source.html#l00537">fe_evaluation_0.txt:537</a></div></div>
<div class="ttc" id="afunctions__0_8txt_html_af9f808a82e8c618e2e7a19dd08a9eae3"><div class="ttname"><a href="functions__0_8txt.html#af9f808a82e8c618e2e7a19dd08a9eae3">value</a></div><div class="ttdeci">****Functions are used in various places in deal for example to describe boundary coefficients in forcing or exact solutions Since closed form expressions for equations are often hard to pass along as function deal II uses the Function base class to describe these objects Essentially the interface of this base class requires derived classes to implement the ability to return the value of a function at one or a list of particular locations and function objects can then be used by algorithms like[2.x.1][2.x.2] and other functions *Some functions are needed again and and are therefore already provided in deal II This includes a function with a constant value</div><div class="ttdef"><b>Definition:</b> <a href="functions__0_8txt_source.html#l00007">functions_0.txt:7</a></div></div>
<div class="ttc" id="aclassVector_html"><div class="ttname"><a href="classVector.html">Vector&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassDataOutInterface_html_ac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08210">data_out_base.cc:8210</a></div></div>
<div class="ttc" id="anamespaceEuler__DG_html_abb931ad5a40604659a931a08336cad55"><div class="ttname"><a href="namespaceEuler__DG.html#abb931ad5a40604659a931a08336cad55">Euler_DG::euler_numerical_flux</a></div><div class="ttdeci">Tensor&lt; 1, dim+2, Number &gt; euler_numerical_flux(const Tensor&lt; 1, dim+2, Number &gt; &amp;u_m, const Tensor&lt; 1, dim+2, Number &gt; &amp;u_p, const Tensor&lt; 1, dim, Number &gt; &amp;normal)</div><div class="ttdef"><b>Definition:</b> <a href="step-67_8cc_source.html#l00320">step-67.cc:320</a></div></div>
<div class="ttc" id="aclassFESystem_html"><div class="ttname"><a href="classFESystem.html">FESystem&lt; dim &gt;</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gafc0ca7ad85b3ebd64e8e51689ac85caf"><div class="ttname"><a href="group__Exceptions.html#gafc0ca7ad85b3ebd64e8e51689ac85caf">AssertThrow</a></div><div class="ttdeci">#define AssertThrow(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01699">exceptions.h:1699</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a4c0a7149e1927066d2fcdb356cb90f7b"><div class="ttname"><a href="multithreading__0_8txt.html#a4c0a7149e1927066d2fcdb356cb90f7b">no</a></div><div class="ttdeci">in this it often pays off to use rather than in a program *deal II does not implement scheduling tasks to threads itself For we use the[1.x.10] for which we provide simple wrappers TBB abstracts the details of how to start or stop start tasks on individual and provides interfaces that are portable across many different systems ***MTUsing *[1.x.11] the syntax to start would be something like this for the example we would like to indicate the fact that the function call should be run on a separate task by simply prefixing the call with a as it is here *Since C does not support the creation of new we have to be a bit more creative The way chosen is to introduce a function[2.x.24] that takes as arguments the function to call as well as the arguments to the call The[2.x.25] function is overloaded to accommodate starting tasks with functions that take no</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00045">multithreading_0.txt:45</a></div></div>
<div class="ttc" id="agrid_2grid__refinement__0_8txt_html_a8bdcf8330609e043ba26a394139934f2"><div class="ttname"><a href="grid_2grid__refinement__0_8txt.html#a8bdcf8330609e043ba26a394139934f2">Section</a></div><div class="ttdeci">and W R the function uses the observation that the error behaves like[2.x.65] with some constant[2.x.66] that depends on the dimension and the finite element degree It should **given optimal mesh refinement **not depend so much on the regularity of the as it is based on the that all singularities can be resolved by refinement Mesh refinement is then based on the idea that we want to make[2.x.67] small This corresponds to the functional[2.x.68] above *This function was originally implemented by Thomas Richter It follows a strategy described in T Parallel Multigrid Method for Adaptive Finite Elements with Application to Flow PhD University of See in particular Section</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement__0_8txt_source.html#l00029">grid_refinement_0.txt:29</a></div></div>
<div class="ttc" id="aclassDerivativeForm_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="classDerivativeForm.html#a3c201452e8dd28e4f5be4a316cb9305f">DerivativeForm::transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="base_2derivative__form_8h_source.html#l00550">derivative_form.h:550</a></div></div>
<div class="ttc" id="astructDataPostprocessorInputs_1_1Vector_html"><div class="ttname"><a href="structDataPostprocessorInputs_1_1Vector.html">DataPostprocessorInputs::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__postprocessor_8h_source.html#l00319">data_postprocessor.h:319</a></div></div>
<div class="ttc" id="anamespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00030">communication_pattern_base.h:30</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a8a90f5ba57a42a3fd4c067e00f8b8aea"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a></div><div class="ttdeci">****This class simplifies the construction of convergence tables reading the options for the generation of the table from a parameter file It provides a series of methods that can be used to compute the error given a reference exact solution or the difference between two numerical solutions or any other custom computation of the error given via[2.x.1] objects *An example usage of this class is given by ****The above code constructs a ParsedConvergenceTable that works for scalar and will produce an error table with and Linfty_norm norms of the error *Whenever a call to the methods the instance of this class inspects its parameters computes all norms specified by the parameter given at construction time possibly modified via a parameter file computes all extra column entries specified using the method and writes one row of the convergence table *Once you have finished with the a call to and to the the same code can be used to estimate the errors of mixed or multi physics e and one component for the pressure field p</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00020">parsed_convergence_table_0.txt:20</a></div></div>
<div class="ttc" id="agrid_2grid__generator_8h_html"><div class="ttname"><a href="grid_2grid__generator_8h.html">grid_generator.h</a></div></div>
<div class="ttc" id="anamespaceUtilities_1_1MPI_html_ad2f716b789abe53715d6659f38aa7815"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ad2f716b789abe53715d6659f38aa7815">Utilities::MPI::max</a></div><div class="ttdeci">T max(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="afe_2fe__update__flags_8h_html_aa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="fe_2fe__update__flags_8h.html#aa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__update__flags_8h_source.html#l00057">fe_update_flags.h:57</a></div></div>
<div class="ttc" id="atable__0_8txt_html_aa889bb34debce4db8c9ace2f875bdf0d"><div class="ttname"><a href="table__0_8txt.html#aa889bb34debce4db8c9ace2f875bdf0d">component</a></div><div class="ttdeci">tables that store three or more dimensional then there is nothing you can do about the size of these if your program is parallelized via then a typical first implementation would create a table object on every process and fill it on every MPI process by reading the data from a file This is inefficient from two the data stored on every process is the and while every process needs to be able to read from a it is not necessary that every process stores its own either by re creating a copy of the table in the other processes memory space if by creating copies in shared memory once for all processes located on each of the machines used by the MPI job ******Integer type used to count the number of elements in this container **Default constructor Set all dimensions to zero **Constructor Initialize the array with the given dimensions in each index component **Constructor Initialize the array with the given dimensions in each index component</div><div class="ttdef"><b>Definition:</b> <a href="table__0_8txt_source.html#l00083">table_0.txt:83</a></div></div>
<div class="ttc" id="aclassDoFHandler_html_aa5b8d3c4b9deb0774dde5c2851e07e1e"><div class="ttname"><a href="classDoFHandler.html#aa5b8d3c4b9deb0774dde5c2851e07e1e">DoFHandler::n_dofs</a></div><div class="ttdeci">types::global_dof_index n_dofs() const</div></div>
<div class="ttc" id="afunction__0_8txt_html_a4f780342f2d5d632f82cf7fd90158a66"><div class="ttname"><a href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a></div><div class="ttdeci">it defaults to i e the first component **Return all components of a vector valued function at a given point&lt; tt &gt; values&lt;/tt &gt; shall have the right size i e **Set&lt; tt &gt; values&lt;/tt &gt; to the point values of the specified component of the function at the&lt; tt &gt; points&lt;/tt &gt; It is assumed that&lt; tt &gt; values&lt;/tt &gt; already has the right size</div><div class="ttdef"><b>Definition:</b> <a href="function__0_8txt_source.html#l00052">function_0.txt:52</a></div></div>
<div class="ttc" id="aclassUtilities_1_1MPI_1_1MPI__InitFinalize_html"><div class="ttname"><a href="classUtilities_1_1MPI_1_1MPI__InitFinalize.html">Utilities::MPI::MPI_InitFinalize</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2mpi_8h_source.html#l00836">mpi.h:836</a></div></div>
<div class="ttc" id="aclassLinearAlgebra_1_1distributed_1_1Vector_html_a1c4bc946b94f19d7e11c00f41a39db02"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html#a1c4bc946b94f19d7e11c00f41a39db02">LinearAlgebra::distributed::Vector::local_element</a></div><div class="ttdeci">Number local_element(const size_type local_index) const</div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a02f5aa616d7b0799c538fe77d6c6c795"><div class="ttname"><a href="coding__conventions__0_8txt.html#a02f5aa616d7b0799c538fe77d6c6c795">e</a></div><div class="ttdeci">i e</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00028">coding_conventions_0.txt:28</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
