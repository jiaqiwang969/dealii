<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-4_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-4.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-4.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-4_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; ) <span class="keyword">const</span></div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; {</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;   <span class="keywordtype">double</span> return_value = 0.0;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dim; ++i)</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     return_value += 4.0 std::pow(p(i), 4.0);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;* </div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;   <span class="keywordflow">return</span> return_value;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; }</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;* </div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;* </div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;*  As boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>, we choose   @f$x^2+y^2@f$   in 2D, and   @f$x^2+y^2+z^2@f$   in 3D. This happens to be <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a> to the square of the vector from the origin to the <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> at which we would like to evaluate the <span class="keyword">function</span>, irrespective of the dimension. So that is what we <span class="keywordflow">return</span>:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;* </div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;* </div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;* @code</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; <span class="keywordtype">double</span> BoundaryValues&lt;dim&gt;::value(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <span class="comment">/*component*/</span> )<span class="keyword"> const</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="keyword"> </span>{</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;   <span class="keywordflow">return</span> p.<a class="code" href="classPoint.html#a859ea7f3bf3e64be2e0f5ed1bfcc8550">square</a>();</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; }</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;* </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;* </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;* </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ImplementationofthecodeStep4codeclass&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Implementation of the &lt;code&gt;Step4&lt;/code&gt; <span class="keyword">class</span>&lt;/h3&gt;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;* </div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;* </div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;*  Next <span class="keywordflow">for</span> the implementation of the <span class="keyword">class </span>template that makes use of the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> above. As before, we will write everything as templates that have a formal parameter   &lt;code&gt;dim&lt;/code&gt;   that we assume unknown at the time we define the template <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>. Only later, the compiler will find a declaration of   &lt;code&gt;Step4@&lt;2@&gt;&lt;/code&gt; (in the &lt;code&gt;main&lt;/code&gt;   function, actually) and compile the entire class with   &lt;code&gt;dim&lt;/code&gt;   replaced by 2, a process referred to as `instantiation of a template&#39;. When doing so, it will also replace instances of   &lt;code&gt;RightHandSide@&lt;dim@&gt;&lt;/code&gt;   by   &lt;code&gt;RightHandSide@&lt;2@&gt;&lt;/code&gt;   and instantiate the latter class from the class template.</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;* </div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;* </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;*  In fact, the compiler will also find a declaration   &lt;code&gt;Step4@&lt;3@&gt;&lt;/code&gt;   in   &lt;code&gt;main()&lt;/code&gt;  . This will cause it to again go back to the general   &lt;code&gt;Step4@&lt;dim@&gt;&lt;/code&gt;   <span class="keyword">template</span>, replace all occurrences of   &lt;code&gt;dim&lt;/code&gt;  , <span class="keyword">this</span> time by 3, and compile the <span class="keyword">class </span>a <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> time. Note that the two instantiations   &lt;code&gt;Step4@&lt;2@&gt;&lt;/code&gt;   and   &lt;code&gt;Step4@&lt;3@&gt;&lt;/code&gt;   are completely independent classes; their only common feature is that they are both instantiated from the same <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> <span class="keyword">template</span>, but they are not convertible into each other, <span class="keywordflow">for</span> example, and share no code (both instantiations are compiled completely independently).</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;* </div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;* </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;*  </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;*  </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;*  &lt;a name=<span class="stringliteral">&quot;Step4Step4&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step4::Step4&lt;/h4&gt;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;* </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;* </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;*  After <span class="keyword">this</span> introduction, here is the constructor of the   &lt;code&gt;Step4&lt;/code&gt;   <span class="keyword">class</span>. It specifies the desired polynomial degree of the finite elements and associates the <a class="code" href="classDoFHandler.html">DoFHandler</a> to the <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> just as in the previous example program,   @ref step_3 <span class="stringliteral">&quot;step-3&quot;</span>  :</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;* </div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;* </div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;* @code</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160; Step4&lt;dim&gt;::Step4()</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   : fe(1)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; {}</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;* </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;* </div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step4make_grid&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step4::make_grid&lt;/h4&gt;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;* </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;* </div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;*  Grid creation is something inherently dimension dependent. However, as <span class="keywordtype">long</span> as the domains are sufficiently similar in 2D or 3D, the library can <span class="keyword">abstract</span> <span class="keywordflow">for</span> you. In our <span class="keywordflow">case</span>, we would like to again solve on the square   @f$[-1,1]\times [-1,1]@f$   in 2D, or on the cube   @f$[-1,1] \times [-1,1] \times</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; [-1,1]@f$   in 3D; both can be termed   <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(),   so we may use the same <span class="keyword">function</span> in whatever dimension we are. Of course, the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> that create a hypercube in two and three dimensions are very much different, but that is something you need not care about. Let the library handle the difficult things.</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;* </div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;* </div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;* @code</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; <span class="keywordtype">void</span> Step4&lt;dim&gt;::make_grid()</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;   <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;* </div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;-1, 1);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;   <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(4);</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;* </div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;             &lt;&lt; std::endl</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;             &lt;&lt; <span class="stringliteral">&quot;   Total number of cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_cells()</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;             &lt;&lt; std::endl;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;* </div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;* </div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step4setup_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step4::setup_system&lt;/h4&gt;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;* </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;* </div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;*  This <span class="keyword">function</span> looks exactly like in the previous example, although it performs actions that in their details are quite different if   &lt;code&gt;dim&lt;/code&gt;   happens to be 3. The only significant difference from a user<span class="stringliteral">&#39;s perspective is the number of cells resulting, which is much higher in three than in two space dimensions!</span></div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;<span class="stringliteral"> template &lt;int dim&gt;</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="stringliteral"> void Step4&lt;dim&gt;::setup_system()</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="stringliteral">   dof_handler.distribute_dofs(fe);</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="stringliteral">   std::cout &lt;&lt; &quot;   Number of degrees of freedom: &quot; &lt;&lt; dof_handler.n_dofs()</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="stringliteral">             &lt;&lt; std::endl;</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="stringliteral">   DynamicSparsityPattern dsp(dof_handler.n_dofs());</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="stringliteral">   DoFTools::make_sparsity_pattern(dof_handler, dsp);</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="stringliteral">   sparsity_pattern.copy_from(dsp);</span></div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="stringliteral">   system_matrix.reinit(sparsity_pattern);</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="stringliteral">   solution.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="stringliteral">   system_rhs.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;Step4assemble_system&quot;&gt;&lt;/a&gt;  &lt;h4&gt;Step4::assemble_system&lt;/h4&gt;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="stringliteral">*  Unlike in the previous example, we would now like to use a non-constant right hand side function and non-zero boundary values. Both are tasks that are readily achieved with only a few new lines of code in the assemblage of the matrix and right hand side.</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="stringliteral">*  More interesting, though, is the way we assemble matrix and right hand side vector dimension independently: there is simply no difference to the two-dimensional case. Since the important objects used in this function (quadrature formula, FEValues) depend on the dimension by way of a template parameter as well, they can take care of setting up properly everything for the dimension for which this function is compiled. By declaring all classes which might depend on the dimension using a template parameter, the library can make nearly all work for you and you don&#39;</span>t have to care about most things.</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;* </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;* </div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;* @code</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; <span class="keywordtype">void</span> Step4&lt;dim&gt;::assemble_system()</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> quadrature_formula(fe.degree + 1);</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;* </div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;* </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;*  We wanted to have a non-constant right hand side, so we use an <span class="keywordtype">object</span> of the <span class="keyword">class </span>declared above to generate the necessary data. Since this right hand side object is only used locally in the present function, we declare it here as a local variable:</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;* </div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;* </div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;* @code</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   RightHandSide&lt;dim&gt; right_hand_side;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;* </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;* </div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;*  Compared to the previous example, in order to evaluate the non-constant right hand side <span class="keyword">function</span> we now also need the quadrature points on the cell we are presently on (previously, we only required values and <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">gradients</a> of the shape <span class="keyword">function</span> from the <a class="code" href="classFEValues.html">FEValues</a> <span class="keywordtype">object</span>, as well as the quadrature weights,   <a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">FEValues::JxW</a>()   ). We can tell the <a class="code" href="classFEValues.html">FEValues</a> <span class="keywordtype">object</span> to <span class="keywordflow">do</span> <span class="keywordflow">for</span> us by also giving it the #<a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> flag:</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;* </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;* </div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;* @code</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;   <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values(fe,</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                           quadrature_formula,</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                           <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;* </div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;* </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;*  We then again define the same abbreviation as in the previous program. The <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> of <span class="keyword">this</span> variable of course depends on the dimension which we are presently <span class="keyword">using</span>, but the <a class="code" href="classFiniteElement.html">FiniteElement</a> <span class="keyword">class </span>does all the necessary work for you and you don&#39;t have to care about the dimension dependent parts:</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;* </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;* </div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;* @code</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   const unsigned int dofs_per_cell = fe.n_dofs_per_cell();</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;* </div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;   <a class="code" href="classFullMatrix.html">FullMatrix</a>&lt;double&gt; <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;   <a class="code" href="classVector.html">Vector</a>&lt;double&gt;     cell_rhs(dofs_per_cell);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;* </div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;   std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;* </div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;* </div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;*  Next, we again have to <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all cells and <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> local contributions.  Note, that a cell is a quadrilateral in two space dimensions, but a hexahedron in 3D. In fact, the   &lt;code&gt;active_cell_iterator&lt;/code&gt;   data type is something different, depending on the dimension we are in, but to the outside world they look alike and you will probably never see a difference. In any <span class="keywordflow">case</span>, the real type is hidden by <span class="keyword">using</span> `<span class="keyword">auto</span>`:</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;* </div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;* </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;* @code</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;       fe_values.reinit(cell);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;       <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a> = 0;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;       cell_rhs    = 0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;* </div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;* </div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;*  Now we have to <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> the local <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and right hand side. This is done exactly like in the previous example, but now we revert the order of the loops (which we can safely <span class="keywordflow">do</span> since they are independent of each other) and <a class="code" href="namespaceinternal_1_1SymmetricTensorAccessors.html#a3080af8704b3a9882a6fab3eecc63568">merge</a> the loops <span class="keywordflow">for</span> the local <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and the local vector as far as possible to make things a bit faster.       </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;*   Assembling the right hand side presents the only significant difference to how we did things in   @ref step_3 <span class="stringliteral">&quot;step-3&quot;</span>  : Instead of <span class="keyword">using</span> a constant right hand side with <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> 1, we use the <span class="keywordtype">object</span> representing the right hand side and evaluate it at the quadrature points:</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;* </div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;* </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;* @code</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_index : fe_values.quadrature_point_indices())</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : fe_values.dof_indices())</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;           {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;             <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j : fe_values.dof_indices())</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;               <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(i, j) +=</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                 (fe_values.shape_grad(i, q_index) <span class="comment">// grad phi_i(x_q)</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                  fe_values.shape_grad(j, q_index) <span class="comment">// grad phi_j(x_q)</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                  fe_values.JxW(q_index));           <span class="comment">// dx</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;* </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;             <span class="keyword">const</span> <span class="keyword">auto</span> &amp;x_q = fe_values.quadrature_point(q_index);</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;             cell_rhs(i) += (fe_values.shape_value(i, q_index) <span class="comment">// phi_i(x_q)</span></div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                             right_hand_side.value(x_q)        <span class="comment">// f(x_q)</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                             fe_values.JxW(q_index));            <span class="comment">// dx</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;           }</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;* </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;*  As a <span class="keyword">final</span> remark to these loops: when we <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> the local contributions into   &lt;code&gt;<a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(i,j)&lt;/code&gt;  , we have to multiply the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">gradients</a> of shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>   @f$i@f$   and   @f$j@f$   at <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> number q_index and multiply it with the scalar weights JxW. This is what actually happens:   &lt;code&gt;fe_values.shape_grad(i,q_index)&lt;/code&gt;   returns a   &lt;code&gt;dim&lt;/code&gt;   dimensional vector, represented by a   &lt;code&gt;<a class="code" href="classTensor.html">Tensor</a>@&lt;1,dim@&gt;&lt;/code&gt;   object, and the <span class="keyword">operator</span>* that multiplies it with the result of   &lt;code&gt;fe_values.shape_grad(j,q_index)&lt;/code&gt;   makes sure that the   &lt;code&gt;dim&lt;/code&gt;   components of the two vectors are properly contracted, and the result is a scalar floating <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> number that then is multiplied with the weights. Internally, <span class="keyword">this</span> <span class="keyword">operator</span>* makes sure that <span class="keyword">this</span> happens correctly <span class="keywordflow">for</span> all   &lt;code&gt;dim&lt;/code&gt;   components of the vectors, whether   &lt;code&gt;dim&lt;/code&gt;   be 2, 3, or any other space dimension; from a user<span class="stringliteral">&#39;s perspective, this is not something worth bothering with, however, making things a lot simpler if one wants to write code dimension independently.</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral">*  With the local systems assembled, the transfer into the global matrix and right hand side is done exactly as before, but here we have again merged some loops for efficiency:</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="stringliteral">       cell-&gt;get_dof_indices(local_dof_indices);</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="stringliteral">       for (const unsigned int i : fe_values.dof_indices())</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="stringliteral">         {</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="stringliteral">           for (const unsigned int j : fe_values.dof_indices())</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="stringliteral">             system_matrix.add(local_dof_indices[i],</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="stringliteral">                               local_dof_indices[j],</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">                               cell_matrix(i, j));</span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">           system_rhs(local_dof_indices[i]) += cell_rhs(i);</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="stringliteral">*  As the final step in this function, we wanted to have non-homogeneous boundary values in this example, unlike the one before. This is a simple task, we only have to replace the   Functions::ZeroFunction   used there by an object of the class which describes the boundary values we would like to use (i.e. the   &lt;code&gt;BoundaryValues&lt;/code&gt;   class declared above):   </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral">*   The function   VectorTools::interpolate_boundary_values()   will only work on faces that have been marked with boundary indicator 0 (because that&#39;</span>s what we say the <span class="keyword">function</span> should work on with the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> argument below). If there are faces with boundary <span class="keywordtype">id</span> other than 0, then the <span class="keyword">function</span> <a class="code" href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">interpolate_boundary_values</a> will <span class="keywordflow">do</span> <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">nothing</a> on these faces. For the Laplace equation doing <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">nothing</a> is equivalent to assuming that on those parts of the boundary a <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> Neumann boundary condition holds.</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;* </div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;* </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;* @code</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;   std::map&lt;types::global_dof_index, double&gt; boundary_values;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   <a class="code" href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a>(dof_handler,</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                                            0,</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                            BoundaryValues&lt;dim&gt;(),</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                                            boundary_values);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;   <a class="code" href="namespaceMatrixTools.html#a9ad0eb7a8662628534586716748d62fb">MatrixTools::apply_boundary_values</a>(boundary_values,</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                      system_matrix,</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                      solution,</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                      system_rhs);</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;* </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;* </div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step4solve&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step4::solve&lt;/h4&gt;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;* </div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;* </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;*  Solving the linear system of equations is something that looks almost identical in most programs. In particular, it is dimension independent, so <span class="keyword">this</span> <span class="keyword">function</span> is copied verbatim from the previous example.</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;* </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;* </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;* @code</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; <span class="keywordtype">void</span> Step4&lt;dim&gt;::solve()</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160; {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12);</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;   <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver(solver_control);</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;   solver.solve(system_matrix, solution, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;* </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;* </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;*  We have made <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> addition, though: since we suppress output from the linear solvers, we have to print the number of iterations by hand.</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;* </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;* </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;* @code</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;   &quot;</span> &lt;&lt; solver_control.last_step()</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;             &lt;&lt; <span class="stringliteral">&quot; CG iterations needed to obtain convergence.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; }</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;* </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;* </div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step4output_results&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step4::output_results&lt;/h4&gt;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;* </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;* </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;*  This <span class="keyword">function</span> also does what the respective <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> did in   @ref step_3 <span class="stringliteral">&quot;step-3&quot;</span>  . No changes here <span class="keywordflow">for</span> dimension independence either.</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;* </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;* </div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;*  Since the program will <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> both 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> and 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> versions of the Laplace solver, we use the dimension in the filename to generate distinct filenames <span class="keywordflow">for each</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> (in a better program, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> would check whether   &lt;code&gt;dim&lt;/code&gt;   can have other values than 2 or 3, but we neglect <span class="keyword">this</span> here <span class="keywordflow">for</span> the sake of brevity).</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;* </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;* </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;* @code</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; <span class="keywordtype">void</span> Step4&lt;dim&gt;::output_results()<span class="keyword"> const</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="keyword"> </span>{</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;* </div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(solution, <span class="stringliteral">&quot;solution&quot;</span>);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;* </div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;* </div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   std::ofstream output(dim == 2 ? <span class="stringliteral">&quot;solution-2d.vtk&quot;</span> : <span class="stringliteral">&quot;solution-3d.vtk&quot;</span>);</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a>(output);</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; }</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;* </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160; </div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;* </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;* </div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step4run&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">Step4::run</a>&lt;/h4&gt;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;* </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;* </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;*  This is the <span class="keyword">function</span> which has the top-<a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> control over everything. Apart from <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> line of additional output, it is the same as <span class="keywordflow">for</span> the previous example.</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;* </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;* </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;* @code</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160; <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">Step4&lt;dim&gt;::run</a>()</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160; {</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   std::cout &lt;&lt; <span class="stringliteral">&quot;Solving problem in &quot;</span> &lt;&lt; dim &lt;&lt; <span class="stringliteral">&quot; space dimensions.&quot;</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;             &lt;&lt; std::endl;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;* </div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   make_grid();</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   setup_system();</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;   assemble_system();</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   solve();</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   output_results();</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160; }</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;* </div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;* </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Thecodemaincodefunction&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The &lt;code&gt;main&lt;/code&gt; <span class="keyword">function</span>&lt;/h3&gt;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;* </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;* </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;*  And <span class="keyword">this</span> is the main <span class="keyword">function</span>. It also looks mostly like in   @ref step_3 <span class="stringliteral">&quot;step-3&quot;</span>  , but <span class="keywordflow">if</span> you look at the code below, note how we <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> create a variable of type   &lt;code&gt;Step4@&lt;2@&gt;&lt;/code&gt;   (forcing the compiler to compile the <span class="keyword">class </span>template with   &lt;code&gt;dim&lt;/code&gt; replaced by &lt;code&gt;2&lt;/code&gt;  ) and <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> a 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> simulation, and then we do the whole thing over in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>.</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;* </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;* </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;*  In practice, <span class="keyword">this</span> is probably not what you would <span class="keywordflow">do</span> very frequently (you probably either want to solve a 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> problem, or <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, but not both at the same time). However, it demonstrates the mechanism by which we can simply change which dimension we want in a single place, and thereby force the compiler to recompile the dimension independent <span class="keyword">class </span>templates for the dimension we request. The emphasis here lies on the fact that we only need to change a single place. This makes it rather trivial to debug the program in 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> where computations are fast, and then switch a single place to a 3 to <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the much more computing intensive program in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> for `real&#39; computations.</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;* </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;* </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;*  Each of the two blocks is enclosed in braces to make sure that the   &lt;code&gt;laplace_problem_2d&lt;/code&gt;   variable goes out of scope (and releases the memory it holds) before we move on to allocate memory <span class="keywordflow">for</span> the 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> <span class="keywordflow">case</span>. Without the additional braces, the   &lt;code&gt;laplace_problem_2d&lt;/code&gt;   variable would only be destroyed at the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of the <span class="keyword">function</span>, i.e. after running the 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> problem, and would needlessly hog memory <span class="keywordflow">while</span> the 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> could actually use it.</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;* </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;* </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;* @code</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; <span class="keywordtype">int</span> main()</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; {</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     Step4&lt;2&gt; laplace_problem_2d;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;     laplace_problem_2d.run();</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   }</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;* </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;     Step4&lt;3&gt; laplace_problem_3d;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;     laplace_problem_3d.run();</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;* </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;* </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;* </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;* The output of the program looks as follows (the number of iterationsmay vary by <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> or two, depending on your computer, since <span class="keyword">this</span> isoften dependent on the round-off accuracy of floating pointoperations, which differs between processors):</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;* @code</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;Solving problem in 2 space dimensions.</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;   Number of active cells: 256</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;   Total number of cells: 341</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;   Number of degrees of freedom: 289</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;   26 CG iterations needed to obtain convergence.</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;Solving problem in 3 space dimensions.</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;   Number of active cells: 4096</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   Total number of cells: 4681</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   Number of degrees of freedom: 4913</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   30 CG iterations needed to obtain convergence.</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;@endcode</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;* It is obvious that in three spatial dimensions the number of cells andtherefore also the number of degrees of freedom ismuch higher. What cannot be seen here, is that besides this highernumber of rows and columns in the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, there are also significantlymore entries per row of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> in three spacedimensions. Together, this leads to a much higher numerical effort forsolving the system of equation, which you can feel in the <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> time of the twosolution steps when you actually <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the program.</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;* </div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;* </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;* The program produces two files:   &lt;code&gt;solution-2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>.<a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1ac41fd26a6a54c90d0d2062d859b8facf">vtk</a>&lt;/code&gt;   and  &lt;code&gt;solution-3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>.<a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1ac41fd26a6a54c90d0d2062d859b8facf">vtk</a>&lt;/code&gt;  , which can be viewed using the programsVisIt or Paraview (in case you do not have these programs, you can easilychange theoutput format in the program to something which you can view moreeasily). Visualizing solutions is a bit of an art, but it can also be fun, soyou should play around with your favorite visualization tool to get familiarwith its functionality. Here<span class="stringliteral">&#39;s what I have come up with for the 2d solution:</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral">*   &lt;p align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">  &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-4.solution-2d.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">&lt;/p&gt;  </span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">* (  See also &lt;a href=&quot;http://www.math.colostate.edu/~bangerth/videos.676.11.html&quot;&gt;video lecture 11&lt;/a&gt;, &lt;a href=&quot;http://www.math.colostate.edu/~bangerth/videos.676.32.html&quot;&gt;video lecture 32&lt;/a&gt;.)  The picture shows the solution of the problem under consideration asa 3D plot. As can be seen, the solution is almost flat in the interiorof the domain and has a higher curvature near the boundary. This, ofcourse, is due to the fact that for Laplace&#39;</span>s equation the curvatureof the solution is <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a> to the right hand side and that was chosen asa quartic polynomial which is nearly <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> in the interior and is onlyrising sharply when approaching the boundaries of the domain; themaximal values of the right hand side <span class="keyword">function</span> are at the corners ofthe domain, where also the solution is moving most rapidly.It is also nice to see that the solution follows the desired quadraticboundary values along the boundaries of the domain.It can also be useful to verify a computed solution against an analyticalsolution. For an explanation of <span class="keyword">this</span> technique, see   @ref step_7 <span class="stringliteral">&quot;step-7&quot;</span>  .</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;* On the other hand, even though the picture does not show the mesh linesexplicitly, you can see them as little kinks in the solution. This clearlyindicates that the solution hasn<span class="stringliteral">&#39;t been computed to very high accuracy andthat to get a better solution, we may have to compute on a finer mesh.</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral">* In three spatial dimensions, visualization is a bit more difficult. The leftpicture shows the solution and the mesh it was computed on on the surface ofthe domain. This is nice, but it has the drawback that it completely hideswhat is happening on the inside. The picture on the right is an attempt atvisualizing the interior as well, by showing surfaces where the solution hasconstant values (as indicated by the legend at the top left). Isosurfacepictures look best if one makes the individual surfaces slightly transparentso that it is possible to see through them and see what&#39;</span>s behind.</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;*   &lt;table width=<span class="stringliteral">&quot;60%&quot;</span> align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-4.solution-3d.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;      &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-4.contours-3d.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;*   @note  <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> <span class="keyword">final</span> remark on visualization: the idea of visualization is to give insight,which is not the same as displaying information. In particular, it is easy tooverload a picture with information, but <span class="keywordflow">while</span> it shows more information itmakes it also more difficult to glean insight. As an example, the program Iused to generate these pictures, VisIt, by <span class="keywordflow">default</span> puts tick marks on everyaxis, puts a big fat label <span class="stringliteral">&quot;X Axis&quot;</span> on the   @f$x@f$   axis and similar <span class="keywordflow">for</span> the otheraxes, shows the file name from which the data was taken in the top left andthe name of the user doing so and the time and date on the bottom right. Noneof <span class="keyword">this</span> is importanthere: the axes are equally easy to make out because the tripod at the bottomleft is still visible, and we know from the program that the domain is  @f$[-1,1]^3@f$  , so there is no need <span class="keywordflow">for</span> tick marks. As a consequence, I haveswitched off all the extraneous stuff in the picture: the art of visualizationis to <a class="code" href="namespaceUtilities_1_1MPI.html#a9e963546bd81b0cdd88e1840cfa8f227">reduce</a> the picture to those parts that are important to see what onewants to see, but no more.</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;* </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;* </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;* &lt;a name=<span class="stringliteral">&quot;extensions&quot;</span>&gt;&lt;/a&gt;&lt;a name=<span class="stringliteral">&quot;Possibilitiesforextensions&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Possibilities <span class="keywordflow">for</span> extensions&lt;/h3&gt;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;* </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;* </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;* Essentially the possibilities <span class="keywordflow">for</span> playing around with the program are the sameas <span class="keywordflow">for</span> the previous <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>, except that they will now also <a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a> to the 3dcase. For inspiration read up on &lt;a href=<span class="stringliteral">&quot;step_3.html#extensions&quot;</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;target=<span class="stringliteral">&quot;body&quot;</span>&gt;possible extensions in the documentation of step 3&lt;/a&gt;.</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;* </div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;* &lt;a name=<span class="stringliteral">&quot;PlainProg&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include <span class="stringliteral">&quot;step-4.cc&quot;</span>  </div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;*</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;*/</div><div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="namespaceMatrixTools_html_a9ad0eb7a8662628534586716748d62fb"><div class="ttname"><a href="namespaceMatrixTools.html#a9ad0eb7a8662628534586716748d62fb">MatrixTools::apply_boundary_values</a></div><div class="ttdeci">void apply_boundary_values(const std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, SparseMatrix&lt; number &gt; &amp;matrix, Vector&lt; number &gt; &amp;solution, Vector&lt; number &gt; &amp;right_hand_side, const bool eliminate_columns=true)</div><div class="ttdef"><b>Definition:</b> <a href="matrix__tools_8cc_source.html#l00081">matrix_tools.cc:81</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="classDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Advection_html_a8bc7b8136646134f73a4193adefe15f8"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">LocalIntegrators::Advection::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="advection_8h_source.html#l00063">advection.h:63</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="classDataOutInterface_html_acad99726038e4fca7f605fdffb3317e4"><div class="ttname"><a href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">DataOutInterface::write_vtk</a></div><div class="ttdeci">void write_vtk(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07221">data_out_base.cc:7221</a></div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="full__matrix_8h_source.html#l00069">full_matrix.h:69</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00049">evaluation_flags.h:49</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00059">evaluation_flags.h:59</a></div></div>
<div class="ttc" id="namespacestd__cxx17_html_aa2fc1031c06af4aea4de90c5a1905473"><div class="ttname"><a href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">std_cxx17::apply</a></div><div class="ttdeci">auto apply(F &amp;&amp;fn, Tuple &amp;&amp;t) -&gt; decltype(apply_impl(std::forward&lt; F &gt;(fn), std::forward&lt; Tuple &gt;(t), std::make_index_sequence&lt; std::tuple_size&lt; typename std::remove_reference&lt; Tuple &gt;::type &gt;::value &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="tuple_8h_source.html#l00036">tuple.h:36</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a9082f945c1d289684d0bcd51ee08e11e"><div class="ttname"><a href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a></div><div class="ttdeci">unsigned int level</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04590">grid_out.cc:4590</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="classPreconditionIdentity_html"><div class="ttname"><a href="classPreconditionIdentity.html">PreconditionIdentity</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00082">precondition.h:82</a></div></div>
<div class="ttc" id="namespaceinternal_1_1SymmetricTensorAccessors_html_a3080af8704b3a9882a6fab3eecc63568"><div class="ttname"><a href="namespaceinternal_1_1SymmetricTensorAccessors.html#a3080af8704b3a9882a6fab3eecc63568">internal::SymmetricTensorAccessors::merge</a></div><div class="ttdeci">constexpr TableIndices&lt; 2 &gt; merge(const TableIndices&lt; 2 &gt; &amp;previous_indices, const unsigned int new_index, const unsigned int position)</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor_8h_source.html#l00145">symmetric_tensor.h:145</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00902">data_out_dof_data.h:902</a></div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceinternal_html_a2b3d48efdf7c94da455dc6a3553bab79"><div class="ttname"><a href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">internal::assemble</a></div><div class="ttdeci">void assemble(const MeshWorker::DoFInfoBox&lt; dim, DOFINFO &gt; &amp;dinfo, A *assembler)</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00073">loop.h:73</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00158">lapack_support.h:158</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_af27ac28c698a9ed0199faed50a204538"><div class="ttname"><a href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a></div><div class="ttdeci">void interpolate_boundary_values(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::map&lt; types::boundary_id, const Function&lt; spacedim, number &gt; *&gt; &amp;function_map, std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
<div class="ttc" id="classTensor_html"><div class="ttname"><a href="classTensor.html">Tensor</a></div><div class="ttdef"><b>Definition:</b> <a href="tensor_8h_source.html#l00396">tensor.h:396</a></div></div>
<div class="ttc" id="classFEValuesBase_html_abade89efb068b71b7ced7082012a2441"><div class="ttname"><a href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">FEValuesBase::JxW</a></div><div class="ttdeci">double JxW(const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="classDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="classPoint_html_a859ea7f3bf3e64be2e0f5ed1bfcc8550"><div class="ttname"><a href="classPoint.html#a859ea7f3bf3e64be2e0f5ed1bfcc8550">Point::square</a></div><div class="ttdeci">numbers::NumberTraits&lt; Number &gt;::real_type square() const</div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00184">dof_handler.h:184</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00039">fe.h:39</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">LAPACKSupport::general</a></div><div class="ttdoc">No special properties. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00114">lapack_support.h:114</a></div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceDataOutBase_html_aa3cbced9f1d4ae661f13018f4c980aa1ac41fd26a6a54c90d0d2062d859b8facf"><div class="ttname"><a href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1ac41fd26a6a54c90d0d2062d859b8facf">DataOutBase::vtk</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01374">data_out_base.h:1374</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_a9e963546bd81b0cdd88e1840cfa8f227"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9e963546bd81b0cdd88e1840cfa8f227">Utilities::MPI::reduce</a></div><div class="ttdeci">T reduce(const T &amp;local_value, const MPI_Comm &amp;comm, const std::function&lt; T(const T &amp;, const T &amp;)&gt; &amp;combiner, const unsigned int root_process=0)</div></div>
<div class="ttc" id="classFiniteElement_html"><div class="ttname"><a href="classFiniteElement.html">FiniteElement</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00772">fe.h:772</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
