<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-61_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-61.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-61.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-61_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; ,</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <span class="comment">/*component*/</span> ) <span class="keyword">const</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   {</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;     <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   }</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;* </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;* </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keyword">class </span>RightHandSide : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0) <span class="keyword">const override</span>;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   };</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;* </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;* </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;   <span class="keywordtype">double</span> RightHandSide&lt;dim&gt;::value(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <span class="comment">/*component*/</span> )<span class="keyword"> const</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;     <span class="keywordflow">return</span> (2 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> std::sin(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[0])</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;             std::sin(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[1]));</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   }</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;* </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;* </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;* </div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;*  The <span class="keyword">class </span>that <span class="keyword">implements</span> the exact pressure solution has an oddity in that we implement it as a vector-valued <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> with two components. (We say that it has two components in the constructor where we call the constructor of the base Function class.) In the `<a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>()` function, we do not test for the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> of the `component` argument, which implies that we return the same <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> for both components of the vector-valued function. We do this because we describe the finite element in use in this program as a vector-valued system that contains the interior and the interface pressures, and when we compute errors, we will want to use the same pressure solution to test both of these components.</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;* </div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;* </div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;* @code</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   template &lt;int dim&gt;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   class ExactPressure : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;     ExactPressure()</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;       : <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;(2)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;     {}</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;* </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component) <span class="keyword">const override</span>;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   };</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;* </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;* </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="keywordtype">double</span> ExactPressure&lt;dim&gt;::value(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <span class="comment">/*component*/</span> )<span class="keyword"> const</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;     <span class="keywordflow">return</span> <a class="code" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a>(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[0]) <a class="code" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a>(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[1]);</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   }</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;* </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;* </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="keyword">class </span>ExactVelocity : <span class="keyword">public</span> <a class="code" href="classTensorFunction.html">TensorFunction</a>&lt;1, dim&gt;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;     ExactVelocity()</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;       : <a class="code" href="classTensorFunction.html">TensorFunction</a>&lt;1, dim&gt;()</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;     {}</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;* </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;     <span class="keyword">virtual</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p) <span class="keyword">const override</span>;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   };</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;* </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;* </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> ExactVelocity&lt;dim&gt;::value(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)<span class="keyword"> const</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;     <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> return_value;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;     return_value[0] =</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;* </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;-<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> <a class="code" href="vectorization_8h.html#a11c48f86a4f2adf21555e64049ecde8c">std::cos</a>(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[0])</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                       <a class="code" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a>(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[1]);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;     return_value[1] =</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;* </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;-<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> <a class="code" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a>(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[0])</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                       <a class="code" href="vectorization_8h.html#a11c48f86a4f2adf21555e64049ecde8c">std::cos</a>(<a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a> p[1]);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;     <span class="keywordflow">return</span> return_value;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;   }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;* </div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160; </div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;* </div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;* </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationclassimplementation&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;WGDarcyEquation <span class="keyword">class </span>implementation&lt;/h3&gt;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;* </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;* </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationWGDarcyEquation&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation::WGDarcyEquation&lt;/h4&gt;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;* </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;* </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;*  In <span class="keyword">this</span> constructor, we create a finite element space <span class="keywordflow">for</span> vector valued <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, which will here include the ones used <span class="keywordflow">for</span> the interior and <span class="keyword">interface </span>pressures,   @f$p^\circ@f$   and   @f$p^\partial@f$  .</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;* </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;* </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;* @code</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;   WGDarcyEquation&lt;dim&gt;::WGDarcyEquation(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree)</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;     : fe(<a class="code" href="classFE__DGQ.html">FE_DGQ</a>&lt;dim&gt;(degree), 1, <a class="code" href="classFE__FaceQ.html">FE_FaceQ</a>&lt;dim&gt;(degree), 1)</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;     , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;     , fe_dgrt(degree)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;     , dof_handler_dgrt(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;   {}</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;* </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160; </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;* </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;* </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationmake_grid&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation::make_grid&lt;/h4&gt;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;* </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;* </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;*  We generate a mesh on the unit square domain and <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> it.</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;* </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;* </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;* @code</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::make_grid()</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, 0, 1);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(5);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;* </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;               &lt;&lt; std::endl</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;   Total number of cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_cells()</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;* </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;* </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;* </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationsetup_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation::setup_system&lt;/h4&gt;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;* </div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;* </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;*  After we have created the mesh above, we distribute degrees of freedom and resize matrices and vectors. The only piece of interest in <span class="keyword">this</span> <span class="keyword">function</span> is how we <a class="code" href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">interpolate</a> the boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="keywordflow">for</span> the pressure. Since the pressure consists of interior and <span class="keyword">interface </span>components, we need to make sure that we only <a class="code" href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">interpolate</a> onto that component of the vector-valued solution space that corresponds to the interface pressures (as these are the only ones that are defined on the boundary of the domain). We do this via a component mask object for only the interface pressures.</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;* </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;* </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;* @code</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::setup_system()</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     dof_handler.distribute_dofs(fe);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     dof_handler_dgrt.distribute_dofs(fe_dgrt);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;* </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of pressure degrees of freedom: &quot;</span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;               &lt;&lt; dof_handler.n_dofs() &lt;&lt; std::endl;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;* </div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     solution.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;     system_rhs.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;* </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;     {</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;       constraints.clear();</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;       <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a> interface_pressure(1);</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;       <span class="keyword">const</span> <a class="code" href="classComponentMask.html">ComponentMask</a>              interface_pressure_mask =</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;         fe.<a class="code" href="classComponentMask.html#a9fd6407bb6b49fc218e0f8b61c2b4231">component_mask</a>(interface_pressure);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;       <a class="code" href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a>(dof_handler,</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;                                                0,</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                                BoundaryValues&lt;dim&gt;(),</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                                constraints,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                                                interface_pressure_mask);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;       constraints.close();</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;     }</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;* </div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;* </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;*  In the bilinear form, there is no integration term over faces between two neighboring cells, so we can just use   &lt;code&gt;<a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>&lt;/code&gt;   to calculate the sparse <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>.</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;* </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;* </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;* @code</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;     <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs());</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;     <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp, constraints);</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;     sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;* </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;     system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   }</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;* </div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160; </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;* </div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;* </div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationassemble_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation::assemble_system&lt;/h4&gt;</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;* </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;* </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;*  This <span class="keyword">function</span> is more interesting. As detailed in the introduction, the assembly of the linear system requires us to evaluate the weak <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a> of the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, which is an element in the Raviart-Thomas space. As a consequence, we need to define a Raviart-Thomas finite element object, and have <a class="code" href="classFEValues.html">FEValues</a> objects that evaluate it at quadrature points. We then need to compute the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>   @f$C^K@f$   on every cell   @f$K@f$  , <span class="keywordflow">for</span> which we need the matrices   @f$M^K@f$   and   @f$G^K@f$   mentioned in the introduction.   </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;*   <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> that may not be obvious is that in all previous tutorial programs, we have <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> called   <a class="code" href="classFEValues.html#a21f914e63d588e2652a9514620653d77">FEValues::reinit</a>()   with a cell iterator from a <a class="code" href="classDoFHandler.html">DoFHandler</a>. This is so that <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> can <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> functions such as   <a class="code" href="classFEValuesBase.html">FEValuesBase</a>::get_function_values()   that <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of a finite element function (represented by a vector of DoF <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>) on the quadrature points of a cell. For this operation to work, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> needs to know which vector elements correspond to the degrees of freedom on a given cell</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;* </div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;*  -  i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., exactly the kind of information and operation provided by the <a class="code" href="classDoFHandler.html">DoFHandler</a> class.   </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;*   We could create a <a class="code" href="classDoFHandler.html">DoFHandler</a> <span class="keywordtype">object</span> for the &quot;broken&quot; Raviart-Thomas space (using the FE_DGRT class), but we really don&#39;t want to here: At least in the current function, we have no need for any globally defined degrees of freedom associated with this broken space, but really only need to reference the shape functions of such a space on the current cell. As a consequence, we use the fact that <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> can <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a>   <a class="code" href="classFEValues.html">FEValues</a>::<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>()   also with cell iterators into <a class="code" href="classTriangulation.html">Triangulation</a> objects (rather than <a class="code" href="classDoFHandler.html">DoFHandler</a> objects). In this case, <a class="code" href="classFEValues.html">FEValues</a> can of course only provide us with information that only references information about cells, rather than degrees of freedom enumerated on these cells. So we can&#39;t use   <a class="code" href="classFEValuesBase.html">FEValuesBase</a>::get_function_values(),   but we can use   <a class="code" href="classFEValues.html">FEValues</a>::shape_value()   to obtain the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of shape functions at quadrature points on the current cell. It is this kind of functionality we will make use of below. The variable that will give us this information about the Raviart-Thomas functions below is then the `fe_values_rt` (and corresponding `fe_face_values_rt`) <span class="keywordtype">object</span>.   </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;*   Given this introduction, the following declarations should be pretty obvious:</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;* </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;* </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;* @code</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::assemble_system()</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;   {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>     quadrature_formula(fe_dgrt.degree + 1);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;* </div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;- 1&gt; face_quadrature_formula(fe_dgrt.degree + 1);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;* </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a>     fe_values(fe,</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                             quadrature_formula,</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                               <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> fe_face_values(fe,</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                                      face_quadrature_formula,</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                                      <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                                        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;* </div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a>     fe_values_dgrt(fe_dgrt,</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                  quadrature_formula,</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> fe_face_values_dgrt(fe_dgrt,</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                                           face_quadrature_formula,</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                                           <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> |</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;* </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell      = fe.n_dofs_per_cell();</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell_dgrt = fe_dgrt.n_dofs_per_cell();</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;* </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points      = fe_values.get_quadrature().size();</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points_dgrt = fe_values_dgrt.get_quadrature().size();</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;* </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_face_q_points = fe_face_values.get_quadrature().size();</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;* </div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;     RightHandSide&lt;dim&gt;  right_hand_side;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;     std::vector&lt;double&gt; right_hand_side_values(n_q_points);</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;* </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;     <span class="keyword">const</span> Coefficient&lt;dim&gt;      coefficient;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;     std::vector&lt;Tensor&lt;2, dim&gt;&gt; coefficient_values(n_q_points);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;* </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;     std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;* </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;* </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;*  Next, let us declare the various cell matrices discussed in the introduction:</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;* </div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;* </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;* @code</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_M(dofs_per_cell_dgrt, dofs_per_cell_dgrt);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_G(dofs_per_cell_dgrt, dofs_per_cell);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_C(dofs_per_cell, dofs_per_cell_dgrt);</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> local_matrix(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     cell_rhs(dofs_per_cell);</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     cell_solution(dofs_per_cell);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;* </div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;* </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;*  We need   &lt;code&gt;<a class="code" href="namespaceFEValuesExtractors.html">FEValuesExtractors</a>&lt;/code&gt;   to access the   @p interior   and   @p face   component of the shape functions.</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;* </div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;* </div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;* @code</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> velocities(0);</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a> pressure_interior(0);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a> pressure_face(1);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;* </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;* </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;*  This <span class="keywordflow">finally</span> gets us in position to <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all cells. On each cell, we will <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> calculate the various cell matrices used to construct the local <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;* </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;*  -  as they depend on the cell in question, they need to be re-computed on each cell. We need shape functions <span class="keywordflow">for</span> the Raviart-Thomas space as well, <span class="keywordflow">for</span> which we need to create <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> an iterator to the cell of the <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, which we can obtain by assignment from the cell pointing into the <a class="code" href="classDoFHandler.html">DoFHandler</a>.</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;* </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;* </div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;* @code</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;       {</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;         fe_values.<a class="code" href="classDoFHandler.html#a84b803d7c74ab87a3eb2e1367611246b">reinit</a>(cell);</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;* </div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;         <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;::active_cell_iterator</a> cell_dgrt =</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;           cell;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;         fe_values_dgrt.reinit(cell_dgrt);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;* </div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;         right_hand_side.value_list(fe_values.get_quadrature_points(),</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                    right_hand_side_values);</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;         coefficient.value_list(fe_values.get_quadrature_points(),</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;                                coefficient_values);</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;* </div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;* </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;*  The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> cell <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> we will compute is the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> <span class="keywordflow">for</span> the Raviart-Thomas space.  Hence, we need to <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all the quadrature points <span class="keywordflow">for</span> the velocity <a class="code" href="classFEValues.html">FEValues</a> <span class="keywordtype">object</span>.</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;* </div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;* </div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;* @code</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;         cell_matrix_M = 0;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points_dgrt; ++q)</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell_dgrt; ++i)</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;             {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;               <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_i = fe_values_dgrt[velocities].value(i, q);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell_dgrt; ++k)</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                 {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_k =</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;                     fe_values_dgrt[velocities].value(k, q);</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;                   cell_matrix_M(i, k) += (v_i v_k fe_values_dgrt.JxW(q));</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                 }</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;             }</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;* </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;*  Next we take the inverse of <span class="keyword">this</span> <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> by <span class="keyword">using</span>   <a class="code" href="classFullMatrix.html#a898466c57e11e6f2599165071ffe5df3">FullMatrix::gauss_jordan</a>().   It will be used to calculate the coefficient <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>   @f$C^K@f$   later. It is worth recalling later that `cell_matrix_M` actually contains theinverse*</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160; of   @f$M^K@f$   after <span class="keyword">this</span> <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a>.</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;* </div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;* </div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;* @code</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;         cell_matrix_M.gauss_jordan();</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;* </div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;* </div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;*  From the introduction, we know that the right hand side   @f$G^K@f$   of the equation that defines   @f$C^K@f$   is the difference between a face integral and a cell integral. Here, we <a class="code" href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">approximate</a> the negative of the contribution in the interior. Each component of <span class="keyword">this</span> <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> is the integral of a product between a basis <span class="keyword">function</span> of the polynomial space and the divergence of a basis <span class="keyword">function</span> of the Raviart-Thomas space. These basis functions are defined in the interior.</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;* </div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;* </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;* @code</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;         cell_matrix_G = 0;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points; ++q)</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell_dgrt; ++i)</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;             {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">double</span> div_v_i =</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;                 fe_values_dgrt[velocities].divergence(i, q);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;                 {</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> phi_j_interior =</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                     fe_values[pressure_interior].value(j, q);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;* </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;                   cell_matrix_G(i, j)</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;* </div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;-=</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                     (div_v_i phi_j_interior fe_values.JxW(q));</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                 }</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;             }</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;* </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;* </div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;*  Next, we <a class="code" href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">approximate</a> the integral on faces by quadrature. Each component is the integral of a product between a basis <span class="keyword">function</span> of the polynomial space and the dot product of a basis <span class="keyword">function</span> of the Raviart-Thomas space and the normal vector. So we <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all the faces of the element and obtain the normal vector.</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;* </div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;* </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;* @code</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;face : cell-&gt;face_iterators())</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;           {</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;             fe_face_values.reinit(cell, face);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;             fe_face_values_dgrt.reinit(cell_dgrt, face);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;* </div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_face_q_points; ++q)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;               {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;normal = fe_face_values.normal_vector(q);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;* </div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell_dgrt; ++i)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                   {</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_i =</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                       fe_face_values_dgrt[velocities].value(i, q);</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                       {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">double</span> phi_j_face =</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;                           fe_face_values[pressure_face].value(j, q);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;* </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                         cell_matrix_G(i, j) +=</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;                           ((v_i normal) phi_j_face fe_face_values.JxW(q));</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                       }</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                   }</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;               }</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;           }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;* </div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;* </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;*    @p cell_matrix_C   is then the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> product between the <a class="code" href="derivative__form_8h.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a> of   @f$G^K@f$   and the inverse of the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> (where <span class="keyword">this</span> inverse is stored in   @p cell_matrix_M):  </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;* </div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;* </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;* @code</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;         cell_matrix_G.Tmmult(cell_matrix_C, cell_matrix_M);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;* </div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;* </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;*  Finally we can compute the local matrix   @f$A^K@f$  .  Element   @f$A^K_{ij}@f$   is given by   @f$\int_{<a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>} \sum_{k,<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>} C_{ik} C_{jl}</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160; (\mathbf{K} \mathbf{v}_k) \cdot \mathbf{v}_l</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160; \mathrm{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>}x@f$  . We have calculated the coefficients   @f$C@f$   in the previous step, and so obtain the following after suitably re-arranging the loops:</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;* </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;* </div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;* @code</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;         local_matrix = 0;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points_dgrt; ++q)</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;           {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell_dgrt; ++k)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;               {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_k =</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                   fe_values_dgrt[velocities].value(k, q);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> &lt; dofs_per_cell_dgrt; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                   {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_l =</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                       fe_values_dgrt[velocities].value(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>, q);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;* </div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                         local_matrix(i, j) +=</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                           (coefficient_values[q] cell_matrix_C[i][k] v_k)</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                           cell_matrix_C[j][<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>] v_l fe_values_dgrt.JxW(q);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                   }</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;               }</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;           }</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;* </div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;* </div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;*  Next, we calculate the right hand side,   @f$\int_{K} f q \mathrm{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>}x@f$  :</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;* </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;* </div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;* @code</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;         cell_rhs = 0;</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points; ++q)</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;             {</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;               cell_rhs(i) += (fe_values[pressure_interior].value(i, q)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;                               right_hand_side_values[q] fe_values.JxW(q));</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;             }</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;* </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;* </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;*  The last step is to distribute components of the local matrix into the system matrix and transfer components of the cell right hand side into the system right hand side:</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;* </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;* </div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;* @code</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;         cell-&gt;get_dof_indices(local_dof_indices);</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;         constraints.distribute_local_to_global(</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;           local_matrix, cell_rhs, local_dof_indices, system_matrix, system_rhs);</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;       }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;   }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;* </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;* </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;* </div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationdimsolve&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation&lt;dim&gt;::solve&lt;/h4&gt;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;* </div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;* </div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;*  This step is rather trivial and the same as in many previous tutorial programs:</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;* </div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;* </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;* @code</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::solve()</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   {</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1e-8 system_rhs.l2_norm());</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;     <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver(solver_control);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;     solver.solve(system_matrix, solution, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;     constraints.distribute(solution);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;   }</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;* </div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;* </div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationdimcompute_postprocessed_velocity&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation&lt;dim&gt;::compute_postprocessed_velocity&lt;/h4&gt;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;* </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;* </div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;*  In <span class="keyword">this</span> <span class="keyword">function</span>, compute the velocity field from the pressure solution previously computed. The velocity is defined as   @f$\mathbf{u}_h = \mathbf{Q}_h \left(</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;* </div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;* </div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;* </div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;-\mathbf{K}\nabla_{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>,<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>}p_h \right)@f$  , which requires us to compute many of the same terms as in the assembly of the system matrix. There are also the matrices   @f$E^K,D^K@f$   we need to <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> (see the introduction) but they really just follow the same kind of pattern.   </div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;*   Computing the same matrices here as we have already done in the `assemble_system()` <span class="keyword">function</span> is of course wasteful in terms of CPU time. Likewise, we <a class="code" href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">copy</a> some of the code from there to <span class="keyword">this</span> <span class="keyword">function</span>, and <span class="keyword">this</span> is also generally a poor idea. <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> better implementation might provide <span class="keywordflow">for</span> a <span class="keyword">function</span> that encapsulates <span class="keyword">this</span> duplicated code. One could also think of <span class="keyword">using</span> the classic trade-off between computing efficiency and memory efficiency to only compute the   @f$C^K@f$   matrices once per cell during the assembly, storing them somewhere on the side, and re-<span class="keyword">using</span> them here. (This is what   @ref step_51 <span class="stringliteral">&quot;step-51&quot;</span>   does, <span class="keywordflow">for</span> example, where the `assemble_system()` <span class="keyword">function</span> takes an argument that determines whether the local matrices are recomputed, and a similar approach</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;* </div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;* </div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;* </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;*  -  maybe with storing local matrices elsewhere</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;* </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;*  -  could be adapted <span class="keywordflow">for</span> the current program.)</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;* </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;* </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;* @code</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::compute_postprocessed_velocity()</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;   {</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;     darcy_velocity.reinit(dof_handler_dgrt.n_dofs());</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;* </div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>     quadrature_formula(fe_dgrt.degree + 1);</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;* </div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;- 1&gt; face_quadrature_formula(fe_dgrt.degree + 1);</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;* </div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values(fe,</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                             quadrature_formula,</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                               <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;* </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> fe_face_values(fe,</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                                      face_quadrature_formula,</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                                      <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;                                        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;                                        <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;* </div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values_dgrt(fe_dgrt,</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                                  quadrature_formula,</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                                  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;* </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> fe_face_values_dgrt(fe_dgrt,</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                                           face_quadrature_formula,</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                                           <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> |</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;* </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell      = fe.n_dofs_per_cell();</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell_dgrt = fe_dgrt.n_dofs_per_cell();</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;* </div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points      = fe_values.get_quadrature().size();</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points_dgrt = fe_values_dgrt.get_quadrature().size();</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;* </div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_face_q_points = fe_face_values.get_quadrature().size();</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;* </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160; </div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;     std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;     std::vector&lt;types::global_dof_index&gt; local_dof_indices_dgrt(</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;       dofs_per_cell_dgrt);</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;* </div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_M(dofs_per_cell_dgrt, dofs_per_cell_dgrt);</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_G(dofs_per_cell_dgrt, dofs_per_cell);</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_C(dofs_per_cell, dofs_per_cell_dgrt);</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_D(dofs_per_cell_dgrt, dofs_per_cell_dgrt);</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> cell_matrix_E(dofs_per_cell_dgrt, dofs_per_cell_dgrt);</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;* </div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> cell_solution(dofs_per_cell);</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> cell_velocity(dofs_per_cell_dgrt);</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;* </div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;     <span class="keyword">const</span> Coefficient&lt;dim&gt;      coefficient;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;     std::vector&lt;Tensor&lt;2, dim&gt;&gt; coefficient_values(n_q_points_dgrt);</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;* </div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> velocities(0);</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a> pressure_interior(0);</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a> pressure_face(1);</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;* </div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;* </div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;*  In the introduction, we explained how to calculate the numerical velocity on the cell. We need the pressure solution <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> on each cell, coefficients of the Gram matrix and coefficients of the   @f$L_2@f$   projection. We have already calculated the global solution, so we will <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> the cell solution from the global solution. The coefficients of the Gram matrix have been calculated when we assembled the system matrix <span class="keywordflow">for</span> the pressures. We will <span class="keywordflow">do</span> the same way here. For the coefficients of the projection, we <span class="keywordflow">do</span> matrix multiplication, i.e., the inverse of the Gram matrix times the matrix with   @f$(\mathbf{K} \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}, \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>})@f$   as components. Then, we multiply all these coefficients and <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> them beta. The numerical velocity is the product of beta and the basis functions of the Raviart-Thomas space.</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;* </div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;* </div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;* @code</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;     <span class="keyword">typename</span> <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;::active_cell_iterator</a></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;       cell = dof_handler.<a class="code" href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">begin_active</a>(),</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;       endc = dof_handler.end(), cell_dgrt = dof_handler_dgrt.<a class="code" href="classTriangulation.html#a9388e821c728eab8d0e699d0ca112482">begin_active</a>();</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;     <span class="keywordflow">for</span> (; cell != endc; ++cell, ++cell_dgrt)</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;       {</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;         fe_values.reinit(cell);</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;         fe_values_dgrt.reinit(cell_dgrt);</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;* </div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;         coefficient.value_list(fe_values_dgrt.get_quadrature_points(),</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;                                coefficient_values);</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;* </div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;* </div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;*  The component of this   &lt;code&gt;cell_matrix_E&lt;/code&gt;   is the integral of   @f$(\mathbf{K} \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>}, \mathbf{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>})@f$  .   &lt;code&gt;cell_matrix_M&lt;/code&gt;   is the Gram matrix.</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;* </div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;* </div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;* @code</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;         cell_matrix_M = 0;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;         cell_matrix_E = 0;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;         for (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points_dgrt; ++q)</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell_dgrt; ++i)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;             {</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;               <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_i = fe_values_dgrt[velocities].value(i, q);</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell_dgrt; ++k)</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;                 {</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;                   <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_k =</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;                     fe_values_dgrt[velocities].value(k, q);</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;* </div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                   cell_matrix_E(i, k) +=</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;                     (coefficient_values[q] v_i v_k fe_values_dgrt.JxW(q));</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;* </div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;                   cell_matrix_M(i, k) += (v_i v_k fe_values_dgrt.JxW(q));</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                 }</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;             }</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;* </div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;* </div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;*  To compute the matrix   @f$D@f$   mentioned in the introduction, we then need to evaluate   @f$D=M^{-1}<a class="code" href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">E</a>@f$   as explained in the introduction:</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;* </div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;* </div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;* @code</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;         cell_matrix_M.gauss_jordan();</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;         cell_matrix_M.mmult(cell_matrix_D, cell_matrix_E);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;* </div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;* </div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;*  Then we also need, again, to compute the matrix   @f$C@f$   that is used to evaluate the weak discrete <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a>. This is the exact same code as used in the assembly of the system <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, so we just <a class="code" href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">copy</a> it from there:</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;* </div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;* </div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;* @code</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;         cell_matrix_G = 0;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points; ++q)</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell_dgrt; ++i)</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;             {</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;               <span class="keyword">const</span> <span class="keywordtype">double</span> div_v_i =</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                 fe_values_dgrt[velocities].divergence(i, q);</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;                 {</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;                   <span class="keyword">const</span> <span class="keywordtype">double</span> phi_j_interior =</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;                     fe_values[pressure_interior].value(j, q);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;* </div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;                   cell_matrix_G(i, j)</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;* </div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;-=</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;                     (div_v_i phi_j_interior fe_values.JxW(q));</div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                 }</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;             }</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;* </div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;face : cell-&gt;face_iterators())</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;           {</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;             fe_face_values.reinit(cell, face);</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;             fe_face_values_dgrt.reinit(cell_dgrt, face);</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;* </div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_face_q_points; ++q)</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;               {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;normal = fe_face_values.normal_vector(q);</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;* </div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell_dgrt; ++i)</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;                   {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;                     <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> v_i =</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;                       fe_face_values_dgrt[velocities].value(i, q);</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                       {</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;                         <span class="keyword">const</span> <span class="keywordtype">double</span> phi_j_face =</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;                           fe_face_values[pressure_face].value(j, q);</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;* </div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;                         cell_matrix_G(i, j) +=</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;                           ((v_i normal) phi_j_face fe_face_values.JxW(q));</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;                       }</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                   }</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;               }</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;           }</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;         cell_matrix_G.Tmmult(cell_matrix_C, cell_matrix_M);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;* </div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;* </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;*  Finally, we need to <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> the pressure unknowns that correspond to the current cell:</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;* </div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;* </div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;* @code</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;         cell-&gt;get_dof_values(solution, cell_solution);</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;* </div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;* </div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;*  We are now in a position to compute the local velocity unknowns (with respect to the Raviart-Thomas space we are projecting the term   @f$-\mathbf K \nabla_{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">w</a>,<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>} p_h@f$   into):</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;* </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;* </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;* @code</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;         cell_velocity = 0;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell_dgrt; ++k)</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell_dgrt; ++j)</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;               cell_velocity(k) +=</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;* </div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;* </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;* </div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;* </div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;* </div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;* </div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;* </div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;* </div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;* </div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;* </div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;* </div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;* </div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;* </div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;* </div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;* </div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;* </div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;* </div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;* </div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;* </div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;</div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;* </div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;* </div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;* </div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;* </div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;* </div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;* </div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;* </div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;* </div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;* </div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;* </div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;* </div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;* </div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;* </div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;* </div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;* </div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;* </div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;-(cell_solution(i) cell_matrix_C(i, j) cell_matrix_D(k, j));</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;* </div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;* </div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;*  We compute Darcy velocity. This is same as cell_velocity but used to graph Darcy velocity.</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;* </div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;* </div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;* @code</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;         cell_dgrt-&gt;get_dof_indices(local_dof_indices_dgrt);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; dofs_per_cell_dgrt; ++k)</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell_dgrt; ++j)</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;               darcy_velocity(local_dof_indices_dgrt[k]) +=</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;* </div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;* </div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;* </div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;* </div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;* </div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;* </div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;* </div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;* </div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;* </div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;* </div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;* </div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;* </div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;* </div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;* </div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;* </div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;* </div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;* </div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;* </div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;* </div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;* </div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;* </div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;* </div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;* </div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;* </div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;* </div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;* </div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;* </div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;* </div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;* </div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;* </div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;* </div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;* </div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;* </div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;* </div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;* </div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;-(cell_solution(i) cell_matrix_C(i, j) cell_matrix_D(k, j));</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;       }</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;   }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;* </div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160; </div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;* </div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;* </div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationdimcompute_pressure_error&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation&lt;dim&gt;::compute_pressure_error&lt;/h4&gt;</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;* </div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;* </div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;*  This part is to calculate the   @f$L_2@f$   error of the pressure.  We define a vector that holds the <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> of the error on each cell. Next, we use   <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTool::integrate_difference</a>()   to compute the error in the   @f$L_2@f$   <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> on each cell. However, we really only care about the error in the interior component of the solution vector (we can&#39;t even evaluate the interface pressures at the quadrature points because these are all located in the interior of cells) and consequently have to use a weight function that ensures that the interface component of the solution variable is ignored. This is done by using the <a class="code" href="classComponentSelectFunction.html">ComponentSelectFunction</a> whose arguments indicate which component we want to select (component <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>, i.e., the interior pressures) and how many components there are in total (two).</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;* </div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;* </div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;* @code</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::compute_pressure_error()</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;   {</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;     <a class="code" href="classVector.html">Vector&lt;float&gt;</a> difference_per_cell(triangulation.n_active_cells());</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;     <span class="keyword">const</span> <a class="code" href="classComponentSelectFunction.html">ComponentSelectFunction&lt;dim&gt;</a> select_interior_pressure(0, 2);</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;     <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(dof_handler,</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;                                       solution,</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                                       ExactPressure&lt;dim&gt;(),</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;                                       difference_per_cell,</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                       <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 2),</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                       <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa3903caf348e2d5dc54d1b49e15c1e8e">VectorTools::L2_norm</a>,</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;                                       &amp;select_interior_pressure);</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;* </div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> L2_error = difference_per_cell.l2_norm();</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;L2_error_pressure &quot;</span> &lt;&lt; L2_error &lt;&lt; std::endl;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;   }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;* </div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;* </div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;* </div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationdimcompute_velocity_error&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation&lt;dim&gt;::compute_velocity_error&lt;/h4&gt;</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;* </div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;* </div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;*  In <span class="keyword">this</span> <span class="keyword">function</span>, we evaluate   @f$L_2@f$   errors <span class="keywordflow">for</span> the velocity on each cell, and   @f$L_2@f$   errors <span class="keywordflow">for</span> the flux on faces. The <span class="keyword">function</span> relies on the `compute_postprocessed_velocity()` <span class="keyword">function</span> having previous computed, which computes the velocity field based on the pressure solution that has previously been computed.   </div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;*   We are going to evaluate velocities on each cell and calculate the difference between numerical and exact velocities.</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;* </div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;* </div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;* @code</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::compute_velocity_errors()</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;   {</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>     quadrature_formula(fe_dgrt.degree + 1);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;* </div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;- 1&gt; face_quadrature_formula(fe_dgrt.degree + 1);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;* </div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values_dgrt(fe_dgrt,</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;                                  quadrature_formula,</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;                                  <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;* </div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> fe_face_values_dgrt(fe_dgrt,</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                                           face_quadrature_formula,</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                                           <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> |</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a> |</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;                                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;* </div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points_dgrt = fe_values_dgrt.get_quadrature().size();</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_face_q_points_dgrt =</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;       fe_face_values_dgrt.get_quadrature().size();</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;* </div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;     std::vector&lt;Tensor&lt;1, dim&gt;&gt; velocity_values(n_q_points_dgrt);</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;     std::vector&lt;Tensor&lt;1, dim&gt;&gt; velocity_face_values(n_face_q_points_dgrt);</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;* </div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;     <span class="keyword">const</span> <a class="code" href="structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a> velocities(0);</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;* </div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;     <span class="keyword">const</span> ExactVelocity&lt;dim&gt; exact_velocity;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;* </div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;     <span class="keywordtype">double</span> L2_err_velocity_cell_sqr_global = 0;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;     <span class="keywordtype">double</span> L2_err_flux_sqr                 = 0;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;* </div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;* </div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;*  Having previously computed the postprocessed velocity, we here only have to <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> the corresponding <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> on each cell and face and compare it to the exact <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>.</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;* </div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;* </div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;* @code</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell_dgrt : dof_handler_dgrt.<a class="code" href="group__CPP11.html#ga4288670ae5bd80367e24918d542cb2d8">active_cell_iterators</a>())</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;       {</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;         fe_values_dgrt.reinit(cell_dgrt);</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;* </div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;* </div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;*  First compute the   @f$L_2@f$   error between the postprocessed velocity field and the exact <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>:</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;* </div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;* </div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;* @code</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;         fe_values_dgrt[velocities].get_function_values(darcy_velocity,</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;                                                        velocity_values);</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;         <span class="keywordtype">double</span> L2_err_velocity_cell_sqr_local = 0;</div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_q_points_dgrt; ++q)</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;           {</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;             <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> velocity = velocity_values[q];</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;             <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> true_velocity =</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;               exact_velocity.value(fe_values_dgrt.quadrature_point(q));</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;* </div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;             L2_err_velocity_cell_sqr_local +=</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;               ((velocity</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;* </div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;- true_velocity) (velocity</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;* </div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;- true_velocity)</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                fe_values_dgrt.JxW(q));</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;           }</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;         L2_err_velocity_cell_sqr_global += L2_err_velocity_cell_sqr_local;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;* </div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;* </div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;*  For reconstructing the flux we need the size of cells and faces. Since fluxes are calculated on faces, we have the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all four faces of each cell. To calculate the face velocity, we <a class="code" href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">extract</a> <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> at the quadrature points from the `darcy_velocity` which we have computed previously. Then, we calculate the squared velocity error in normal direction. Finally, we calculate the   @f$L_2@f$   flux error on the cell by appropriately scaling with face and cell areas and add it to the global error.</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;* </div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;* </div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;* @code</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">double</span> cell_area = cell_dgrt-&gt;measure();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;face_dgrt : cell_dgrt-&gt;face_iterators())</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;           {</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> face_length = face_dgrt-&gt;measure();</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;             fe_face_values_dgrt.reinit(cell_dgrt, face_dgrt);</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;             fe_face_values_dgrt[velocities].get_function_values(</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;               darcy_velocity, velocity_face_values);</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;* </div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;             <span class="keywordtype">double</span> L2_err_flux_face_sqr_local = 0;</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; n_face_q_points_dgrt; ++q)</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;               {</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> velocity = velocity_face_values[q];</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> true_velocity =</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                   exact_velocity.value(fe_face_values_dgrt.quadrature_point(q));</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;* </div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                 <span class="keyword">const</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a> &amp;normal =</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;                   fe_face_values_dgrt.normal_vector(q);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;* </div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;                 L2_err_flux_face_sqr_local +=</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;                   ((velocity normal</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;* </div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;- true_velocity normal)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;                    (velocity normal</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;* </div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;- true_velocity normal)</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;                    fe_face_values_dgrt.JxW(q));</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;               }</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> err_flux_each_face =</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;               L2_err_flux_face_sqr_local / face_length cell_area;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;             L2_err_flux_sqr += err_flux_each_face;</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;           }</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;       }</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;* </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;* </div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;*  After adding up errors over all cells and faces, we take the square root and <span class="keyword">get</span> the   @f$L_2@f$   errors of velocity and flux. These we output to screen.</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;* </div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;* </div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;* @code</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> L2_err_velocity_cell =</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;       <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(L2_err_velocity_cell_sqr_global);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> L2_err_flux_face = <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(L2_err_flux_sqr);</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;* </div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;L2_error_vel:  &quot;</span> &lt;&lt; L2_err_velocity_cell &lt;&lt; std::endl</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;               &lt;&lt; <span class="stringliteral">&quot;L2_error_flux: &quot;</span> &lt;&lt; L2_err_flux_face &lt;&lt; std::endl;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;   }</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;* </div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;* </div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationoutput_results&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WGDarcyEquation::output_results&lt;/h4&gt;</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;* </div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;* </div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;*  We have two sets of results to output: the interior solution and the skeleton solution. We use   &lt;code&gt;<a class="code" href="classDataOut.html">DataOut</a>&lt;/code&gt;   to visualize interior results. The graphical output <span class="keywordflow">for</span> the skeleton results is done by <span class="keyword">using</span> the <a class="code" href="classDataOutFaces.html">DataOutFaces</a> <span class="keyword">class</span>.   </div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;*   In both of the output files, both the interior and the face variables are stored. For the <span class="keyword">interface </span>output, the output file simply contains the interpolation of the interior pressures onto the faces, but because it is undefined which of the two interior pressure variables you get from the two adjacent cells, it is best to ignore the interior pressure in the interface output file. Conversely, for the cell interior output file, it is of course impossible to show any interface pressures   @f$p^\partial@f$  , because these are only available on interfaces and not cell interiors. Consequently, you will see them shown as an <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">invalid</a> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> (such as an infinity).   </div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;*   For the cell interior output, we also want to output the velocity variables. This is a bit tricky since it lives on the same mesh but uses a different <a class="code" href="classDoFHandler.html">DoFHandler</a> object (the pressure variables live on the `dof_handler` <span class="keywordtype">object</span>, the Darcy velocity on the `dof_handler_dgrt` <span class="keywordtype">object</span>). Fortunately, there are variations of the   <a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut::add_data_vector</a>()   function that allow specifying which <a class="code" href="classDoFHandler.html">DoFHandler</a> a vector corresponds to, and consequently we can visualize the data from both <a class="code" href="classDoFHandler.html">DoFHandler</a> objects within the same file.</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;* </div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;* </div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;* @code</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;   <span class="keywordtype">void</span> WGDarcyEquation&lt;dim&gt;::output_results()<span class="keyword"> const</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;     {</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;       <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;* </div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;* </div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;*  First attach the pressure solution to the <a class="code" href="classDataOut.html">DataOut</a> object:</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;* </div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;* </div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;* @code</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::string&gt; solution_names = {<span class="stringliteral">&quot;interior_pressure&quot;</span>,</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;                                                        <span class="stringliteral">&quot;interface_pressure&quot;</span>};</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler, solution, solution_names);</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;* </div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;* </div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;*  Then <span class="keywordflow">do</span> the same with the Darcy velocity field, and <span class="keywordflow">continue</span> with writing everything out into a file.</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;* </div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;* </div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;* @code</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;       <span class="keyword">const</span> std::vector&lt;std::string&gt; velocity_names(dim, <span class="stringliteral">&quot;velocity&quot;</span>);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;       <span class="keyword">const</span> std::vector&lt;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;         <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a>&gt;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;         velocity_component_interpretation(</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;           dim, <a class="code" href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a>);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(dof_handler_dgrt,</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                                darcy_velocity,</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                                velocity_names,</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                                velocity_component_interpretation);</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;* </div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;       data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(fe.degree);</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;       std::ofstream output(<span class="stringliteral">&quot;solution_interior.vtu&quot;</span>);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;       data_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(output);</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;     }</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;* </div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;     {</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;       <a class="code" href="classDataOutFaces.html">DataOutFaces&lt;dim&gt;</a> data_out_faces(<span class="keyword">false</span>);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;       data_out_faces.attach_dof_handler(dof_handler);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;       data_out_faces.add_data_vector(solution, <span class="stringliteral">&quot;Pressure_Face&quot;</span>);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;       data_out_faces.build_patches(fe.degree);</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;       std::ofstream face_output(<span class="stringliteral">&quot;solution_interface.vtu&quot;</span>);</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;       data_out_faces.write_vtu(face_output);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;     }</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;   }</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;* </div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;* </div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WGDarcyEquationrun&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WGDarcyEquation::run</a>&lt;/h4&gt;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;* </div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;* </div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;*  This is the <span class="keyword">final</span> <span class="keyword">function</span> of the main <span class="keyword">class</span>. It calls the other functions of our <span class="keyword">class</span>.</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;* </div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;* </div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;* @code</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;   <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WGDarcyEquation&lt;dim&gt;::run</a>()</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;   {</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Solving problem in &quot;</span> &lt;&lt; dim &lt;&lt; <span class="stringliteral">&quot; space dimensions.&quot;</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;     make_grid();</div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;     setup_system();</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;     assemble_system();</div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;     solve();</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;     compute_postprocessed_velocity();</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;     compute_pressure_error();</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;     compute_velocity_errors();</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;     output_results();</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;   }</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;* </div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160; } <span class="comment">// namespace Step61</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;* </div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;* </div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Thecodemaincodefunction&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The &lt;code&gt;main&lt;/code&gt; <span class="keyword">function</span>&lt;/h3&gt;</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;* </div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;* </div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;*  This is the main <span class="keyword">function</span>. We can change the dimension here to <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>.</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;* </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;* </div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;* @code</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160; <span class="keywordtype">int</span> main()</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160; {</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;   <span class="keywordflow">try</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;     {</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;       Step61::WGDarcyEquation&lt;2&gt; wg_darcy(0);</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;       wg_darcy.run();</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;     }</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;   <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;     {</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;                 &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;     }</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;   <span class="keywordflow">catch</span> (...)</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;     {</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;     }</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;* </div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160; }</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;* </div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;* We <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the program with a right hand side that will produce thesolution   @f$p = \sin(\pi x) \sin(\pi y)@f$   and with homogeneous Dirichletboundary conditions in the domain   @f$\Omega = (0,1)^2@f$  . In addition, wechoose the coefficient matrix in the differential <span class="keyword">operator</span>  @f$\mathbf{K}@f$   as the <a class="code" href="structidentity.html">identity</a> matrix. We test <span class="keyword">this</span> setup <span class="keyword">using</span>  @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$  ,   @f$\mbox{WG}(Q_1,Q_1;RT_{[1]})@f$   and  @f$\mbox{WG}(Q_2,Q_2;RT_{[2]})@f$   element combinations, which <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> canselect by <span class="keyword">using</span> the appropriate constructor argument <span class="keywordflow">for</span> the`WGDarcyEquation` <span class="keywordtype">object</span> in `main()`. We will then visualize pressurevalues in interiors of cells and on faces. We want to see that thepressure maximum is around 1 and the minimum is around 0. With meshrefinement, the convergence rates of pressure, velocity and fluxshould then be around 1 <span class="keywordflow">for</span>   @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$   , 2 <span class="keywordflow">for</span>  @f$\mbox{WG}(Q_1,Q_1;RT_{[1]})@f$  , and 3 <span class="keywordflow">for</span>  @f$\mbox{WG}(Q_2,Q_2;RT_{[2]})@f$  .</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;* </div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;* &lt;a name=<span class="stringliteral">&quot;TestresultsoniWGQsub0subQsub0subRTsub0subi&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Test results on &lt;i&gt;WG(Q&lt;sub&gt;0&lt;/sub&gt;,Q&lt;sub&gt;0&lt;/sub&gt;;RT&lt;sub&gt;[0]&lt;/sub&gt;)&lt;/i&gt;&lt;i&gt;WG(Q&lt;sub&gt;0&lt;/sub&gt;,Q&lt;sub&gt;0&lt;/sub&gt;;RT&lt;sub&gt;[0]&lt;/sub&gt;)&lt;/i&gt;&lt;/h3&gt;</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;* </div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;* The following figures show interior pressures and face pressures <span class="keyword">using</span> the  @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$   element. The mesh is refined 2 times (top)and 4 times (bottom), respectively. (This number can be adjusted in the`make_grid()` <span class="keyword">function</span>.) When the mesh is coarse, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> can seethe face pressures   @f$p^\partial@f$   neatly between the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the interiorpressures   @f$p^\circ@f$   on the two adjacent cells.</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;*   &lt;table align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg000_2d_2.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg000_3d_2.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg000_2d_4.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg000_3d_4.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;* From the figures, we can see that with the mesh refinement, the maximum andminimum pressure <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> are approaching the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> we expect.Since the mesh is a rectangular mesh and <a class="code" href="namespacenumbers.html">numbers</a> of cells in each direction is even, wehave <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">symmetric</a> solutions. From the 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> figures on the right,we can see that on   @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$  , the pressure is a constantin the interior of the cell, as expected.</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Convergencetableforik0i&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Convergence table for &lt;i&gt;k=0&lt;/i&gt;&lt;i&gt;k=0&lt;/i&gt;&lt;/h4&gt;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;* </div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;* We <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the code with differently refined meshes (chosen in the `make_grid()` <span class="keyword">function</span>)and <span class="keyword">get</span> the following convergence rates of pressure,velocity, and flux (as defined in the introduction).</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;*   &lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;   &lt;th&gt;number of refinements &lt;/th&gt;&lt;th&gt;  @f$\|p-p_h^\circ\|@f$  &lt;/th&gt;&lt;th&gt;  @f$\|\mathbf{u}-\mathbf{u}_h\|@f$ &lt;/th&gt;&lt;th&gt; @f$\|(\mathbf{u}-\mathbf{u}_h) \cdot \mathbf{n}\|@f$ &lt;/th&gt;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;   &lt;td&gt;   2                  &lt;/td&gt;&lt;td&gt;    1.587e-01        &lt;/td&gt;&lt;td&gt;        5.113e-01               &lt;/td&gt;&lt;td&gt;   7.062e-01 &lt;/td&gt;</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;   &lt;td&gt;   3                  &lt;/td&gt;&lt;td&gt;    8.000e-02        &lt;/td&gt;&lt;td&gt;        2.529e-01               &lt;/td&gt;&lt;td&gt;   3.554e-01 &lt;/td&gt;</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;   &lt;td&gt;   4                  &lt;/td&gt;&lt;td&gt;    4.006e-02        &lt;/td&gt;&lt;td&gt;        1.260e-01               &lt;/td&gt;&lt;td&gt;   1.780e-01 &lt;/td&gt;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;   &lt;td&gt;   5                  &lt;/td&gt;&lt;td&gt;    2.004e-02        &lt;/td&gt;&lt;td&gt;        6.297e-02               &lt;/td&gt;&lt;td&gt;   8.902e-02 &lt;/td&gt;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;   &lt;th&gt;Conv.rate             &lt;/th&gt;&lt;th&gt;      1.00           &lt;/th&gt;&lt;th&gt;          1.00                  &lt;/th&gt;&lt;th&gt;      1.00   &lt;/th&gt;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;* We can see that the convergence rates of   @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$   are around 1.This, of course, matches our theoretical expectations.</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;* </div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;* &lt;a name=<span class="stringliteral">&quot;TestresultsoniWGQsub1subQsub1subRTsub1subi&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Test results on &lt;i&gt;WG(Q&lt;sub&gt;1&lt;/sub&gt;,Q&lt;sub&gt;1&lt;/sub&gt;;RT&lt;sub&gt;[1]&lt;/sub&gt;)&lt;/i&gt;&lt;i&gt;WG(Q&lt;sub&gt;1&lt;/sub&gt;,Q&lt;sub&gt;1&lt;/sub&gt;;RT&lt;sub&gt;[1]&lt;/sub&gt;)&lt;/i&gt;&lt;/h3&gt;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;* </div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;* We can repeat the experiment from above <span class="keyword">using</span> the next higher polynomialdegree:The following figures are interior pressures and face pressures implemented <span class="keyword">using</span>  @f$\mbox{WG}(Q_1,Q_1;RT_{[1]})@f$  . The mesh is refined 4 times.  Compared to theprevious figures <span class="keyword">using</span>  @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$  , on each cell, the solution is no longer constanton each cell, as we now use bilinear polynomials to <span class="keywordflow">do</span> the approximation.Consequently, there are 4 pressure <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> in <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> interior, 2 pressure <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> oneach face.</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;*   &lt;table align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg111_2d_4.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg111_3d_4.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;* Compared to the corresponding image <span class="keywordflow">for</span> the   @f$\mbox{WG}(Q_0,Q_0;RT_{[0]})@f$  combination, the solution is now substantially more accurate and, inparticular so close to being continuous at the interfaces that we canno longer distinguish the interface pressures   @f$p^\partial@f$   from theinterior pressures   @f$p^\circ@f$   on the adjacent cells.</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Convergencetableforik1i&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Convergence table for &lt;i&gt;k=1&lt;/i&gt;&lt;i&gt;k=1&lt;/i&gt;&lt;/h4&gt;</div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;* </div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;* The following are the convergence rates of pressure, velocity, and fluxwe obtain from <span class="keyword">using</span> the   @f$\mbox{WG}(Q_1,Q_1;RT_{[1]})@f$   element combination:</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;*   &lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;   &lt;th&gt;number of refinements &lt;/th&gt;&lt;th&gt;  @f$\|p-p_h^\circ\|@f$  &lt;/th&gt;&lt;th&gt;  @f$\|\mathbf{u}-\mathbf{u}_h\|@f$ &lt;/th&gt;&lt;th&gt; @f$\|(\mathbf{u}-\mathbf{u}_h) \cdot \mathbf{n}\|@f$ &lt;/th&gt;</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    &lt;td&gt;  2           &lt;/td&gt;&lt;td&gt;           1.613e-02      &lt;/td&gt;&lt;td&gt;          5.093e-02     &lt;/td&gt;&lt;td&gt;             7.167e-02   &lt;/td&gt;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;    &lt;td&gt;  3           &lt;/td&gt;&lt;td&gt;           4.056e-03      &lt;/td&gt;&lt;td&gt;          1.276e-02     &lt;/td&gt;&lt;td&gt;             1.802e-02    &lt;/td&gt;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    &lt;td&gt;  4           &lt;/td&gt;&lt;td&gt;           1.015e-03      &lt;/td&gt;&lt;td&gt;          3.191e-03     &lt;/td&gt;&lt;td&gt;             4.512e-03  &lt;/td&gt;</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    &lt;td&gt;  5           &lt;/td&gt;&lt;td&gt;           2.540e-04      &lt;/td&gt;&lt;td&gt;          7.979e-04     &lt;/td&gt;&lt;td&gt;             1.128e-03  &lt;/td&gt;</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    &lt;th&gt;Conv.rate     &lt;/th&gt;&lt;th&gt;              2.00        &lt;/th&gt;&lt;th&gt;             2.00       &lt;/th&gt;&lt;th&gt;                 2.00    &lt;/th&gt;</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;* The convergence rates of   @f$WG(Q_1,Q_1;RT_{[1]})@f$   are around 2, as expected.</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;* </div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;* </div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;* &lt;a name=<span class="stringliteral">&quot;TestresultsoniWGQsub2subQsub2subRTsub2subi&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Test results on &lt;i&gt;WG(Q&lt;sub&gt;2&lt;/sub&gt;,Q&lt;sub&gt;2&lt;/sub&gt;;RT&lt;sub&gt;[2]&lt;/sub&gt;)&lt;/i&gt;&lt;i&gt;WG(Q&lt;sub&gt;2&lt;/sub&gt;,Q&lt;sub&gt;2&lt;/sub&gt;;RT&lt;sub&gt;[2]&lt;/sub&gt;)&lt;/i&gt;&lt;/h3&gt;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;* </div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;* Let us go <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> polynomial degree higher.The following are interior pressures and face pressures implemented <span class="keyword">using</span>  @f$WG(Q_2,Q_2;RT_{[2]})@f$  , with mesh size   @f$h = 1/32@f$   (i.e., 5 global meshrefinement steps). In the program, we use`data_out_face.build_patches(fe.degree)` when generating graphical output(see the documentation of   <a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a>()),   which here implies thatwe divide each 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> cell interior into 4 subcells in order to provide a bettervisualization of the quadratic polynomials.  &lt;table align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg222_2d_5.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    &lt;td&gt;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-61.wg222_3d_5.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;&lt;/td&gt;</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;* </div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Convergencetableforik2i&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Convergence table for &lt;i&gt;k=2&lt;/i&gt;&lt;i&gt;k=2&lt;/i&gt;&lt;/h4&gt;</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;* </div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;* As before, we can generate convergence data <span class="keywordflow">for</span> the  @f$L_2@f$   errors of pressure, velocity, and fluxusing the   @f$\mbox{WG}(Q_2,Q_2;RT_{[2]})@f$   combination:</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;*   &lt;table align=<span class="stringliteral">&quot;center&quot;</span> <span class="keyword">class</span>=<span class="stringliteral">&quot;doxtable&quot;</span>&gt;</div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;   &lt;th&gt;number of refinements &lt;/th&gt;&lt;th&gt;  @f$\|p-p_h^\circ\|@f$  &lt;/th&gt;&lt;th&gt;  @f$\|\mathbf{u}-\mathbf{u}_h\|@f$ &lt;/th&gt;&lt;th&gt; @f$\|(\mathbf{u}-\mathbf{u}_h) \cdot \mathbf{n}\|@f$ &lt;/th&gt;</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;     &lt;td&gt;  2               &lt;/td&gt;&lt;td&gt;       1.072e-03       &lt;/td&gt;&lt;td&gt;         3.375e-03       &lt;/td&gt;&lt;td&gt;           4.762e-03   &lt;/td&gt;</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    &lt;td&gt;   3               &lt;/td&gt;&lt;td&gt;       1.347e-04       &lt;/td&gt;&lt;td&gt;         4.233e-04       &lt;/td&gt;&lt;td&gt;           5.982e-04    &lt;/td&gt;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;    &lt;td&gt;   4               &lt;/td&gt;&lt;td&gt;       1.685e-05      &lt;/td&gt;&lt;td&gt;          5.295e-05       &lt;/td&gt;&lt;td&gt;           7.487e-05  &lt;/td&gt;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    &lt;td&gt;   5               &lt;/td&gt;&lt;td&gt;       2.107e-06      &lt;/td&gt;&lt;td&gt;          6.620e-06       &lt;/td&gt;&lt;td&gt;           9.362e-06  &lt;/td&gt;</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    &lt;th&gt;Conv.rate          &lt;/th&gt;&lt;th&gt;         3.00         &lt;/th&gt;&lt;th&gt;            3.00          &lt;/th&gt;&lt;th&gt;              3.00    &lt;/th&gt;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;* Once more, the convergence rates of   @f$\mbox{WG}(Q_2,Q_2;RT_{[2]})@f$   isas expected, with <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> around 3.</div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;* </div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;* &lt;a name=<span class="stringliteral">&quot;PlainProg&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include <span class="stringliteral">&quot;step-61.cc&quot;</span>  </div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;*</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;*/</div><div class="ttc" id="vectorization_8h_html_a11c48f86a4f2adf21555e64049ecde8c"><div class="ttname"><a href="vectorization_8h.html#a11c48f86a4f2adf21555e64049ecde8c">std::cos</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; cos(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05359">vectorization.h:5359</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="namespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0aa783915dbc182d5a49e111815fd23fe0">DataComponentInterpretation::component_is_part_of_vector</a></div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00057">data_component_interpretation.h:57</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">LAPACKSupport::symmetric</a></div><div class="ttdoc">Matrix is symmetric. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00116">lapack_support.h:116</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="namespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="matrix__block_8h_source.html#l00575">matrix_block.h:575</a></div></div>
<div class="ttc" id="classFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00116">function.h:116</a></div></div>
<div class="ttc" id="classTensorFunction_html"><div class="ttname"><a href="classTensorFunction.html">TensorFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="tensor__function_8h_source.html#l00043">tensor_function.h:43</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="classDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00296">dynamic_sparsity_pattern.h:296</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classFullMatrix_html_a898466c57e11e6f2599165071ffe5df3"><div class="ttname"><a href="classFullMatrix.html#a898466c57e11e6f2599165071ffe5df3">FullMatrix::gauss_jordan</a></div><div class="ttdeci">void gauss_jordan()</div></div>
<div class="ttc" id="classComponentMask_html_a9fd6407bb6b49fc218e0f8b61c2b4231"><div class="ttname"><a href="classComponentMask.html#a9fd6407bb6b49fc218e0f8b61c2b4231">ComponentMask::component_mask</a></div><div class="ttdeci">std::vector&lt; bool &gt; component_mask</div><div class="ttdef"><b>Definition:</b> <a href="component__mask_8h_source.html#l00208">component_mask.h:208</a></div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="group__CPP11_html_ga4288670ae5bd80367e24918d542cb2d8"><div class="ttname"><a href="group__CPP11.html#ga4288670ae5bd80367e24918d542cb2d8">Triangulation::active_cell_iterators</a></div><div class="ttdeci">IteratorRange&lt; active_cell_iterator &gt; active_cell_iterators() const</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l12155">tria.cc:12155</a></div></div>
<div class="ttc" id="classFE__DGQ_html"><div class="ttname"><a href="classFE__DGQ.html">FE_DGQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__dgq_8h_source.html#l00079">fe_dgq.h:79</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="classDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="classComponentSelectFunction_html"><div class="ttname"><a href="classComponentSelectFunction.html">ComponentSelectFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00536">function.h:536</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Divergence_html_a8bcfc37d2a2be8faa18628a601ecf112"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">LocalIntegrators::Divergence::norm</a></div><div class="ttdeci">double norm(const FEValuesBase&lt; dim &gt; &amp;fe, const ArrayView&lt; const std::vector&lt; Tensor&lt; 1, dim &gt;&gt;&gt; &amp;Du)</div><div class="ttdef"><b>Definition:</b> <a href="divergence_8h_source.html#l00462">divergence.h:462</a></div></div>
<div class="ttc" id="classTriangulation_html_a9388e821c728eab8d0e699d0ca112482"><div class="ttname"><a href="classTriangulation.html#a9388e821c728eab8d0e699d0ca112482">Triangulation::begin_active</a></div><div class="ttdeci">active_cell_iterator begin_active(const unsigned int level=0) const</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l11958">tria.cc:11958</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_a69967cb7a148a7169963126249213db1aa3903caf348e2d5dc54d1b49e15c1e8e"><div class="ttname"><a href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa3903caf348e2d5dc54d1b49e15c1e8e">VectorTools::L2_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__common_8h_source.html#l00088">vector_tools_common.h:88</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="structidentity_html"><div class="ttname"><a href="structidentity.html">identity</a></div><div class="ttdef"><b>Definition:</b> <a href="template__constraints_8h_source.html#l00184">template_constraints.h:184</a></div></div>
<div class="ttc" id="classDataOutFaces_html"><div class="ttname"><a href="classDataOutFaces.html">DataOutFaces</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__faces_8h_source.html#l00080">data_out_faces.h:80</a></div></div>
<div class="ttc" id="classFE__FaceQ_html"><div class="ttname"><a href="classFE__FaceQ.html">FE_FaceQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__face_8h_source.html#l00045">fe_face.h:45</a></div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceFETools_html_ad29759cb8c51f8d369a371f63be8dde0"><div class="ttname"><a href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">FETools::interpolate</a></div><div class="ttdeci">void interpolate(const DoFHandler&lt; dim, spacedim &gt; &amp;dof1, const InVector &amp;u1, const DoFHandler&lt; dim, spacedim &gt; &amp;dof2, OutVector &amp;u2)</div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="classDoFHandler_html_a1a36dbbb4c54a7038c60ee9c8eab369a"><div class="ttname"><a href="classDoFHandler.html#a1a36dbbb4c54a7038c60ee9c8eab369a">DoFHandler::begin_active</a></div><div class="ttdeci">active_cell_iterator begin_active(const unsigned int level=0) const</div><div class="ttdef"><b>Definition:</b> <a href="dof__handler_8cc_source.html#l02225">dof_handler.cc:2225</a></div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="namespacenumbers_html_a3c7239f00d5e87dfcf6dd19cbc3ddc74"><div class="ttname"><a href="namespacenumbers.html#a3c7239f00d5e87dfcf6dd19cbc3ddc74">numbers::E</a></div><div class="ttdeci">static constexpr double E</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00193">numbers.h:193</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="namespaceTensorAccessors_html_a5798da96660fa8e6798917501d65dbd8"><div class="ttname"><a href="namespaceTensorAccessors.html#a5798da96660fa8e6798917501d65dbd8">TensorAccessors::extract</a></div><div class="ttdeci">constexpr ReturnType&lt; rank, T &gt;::value_type &amp; extract(T &amp;t, const ArrayType &amp;indices)</div><div class="ttdef"><b>Definition:</b> <a href="tensor__accessors_8h_source.html#l00244">tensor_accessors.h:244</a></div></div>
<div class="ttc" id="structFEValuesExtractors_1_1Vector_html"><div class="ttname"><a href="structFEValuesExtractors_1_1Vector.html">FEValuesExtractors::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__values__extractors_8h_source.html#l00114">fe_values_extractors.h:114</a></div></div>
<div class="ttc" id="derivative__form_8h_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="derivative__form_8h.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__form_8h_source.html#l00543">derivative_form.h:543</a></div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">TimeStepping::invalid</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00222">time_stepping.h:222</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">internal::EvaluatorQuantity::gradient</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="classPreconditionIdentity_html"><div class="ttname"><a href="classPreconditionIdentity.html">PreconditionIdentity</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00082">precondition.h:82</a></div></div>
<div class="ttc" id="classTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l00740">tria.h:740</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData&lt; dim, dim, spacedim, spacedim &gt;::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00902">data_out_dof_data.h:902</a></div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00092">data_out.h:92</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="structFEValuesExtractors_1_1Scalar_html"><div class="ttname"><a href="structFEValuesExtractors_1_1Scalar.html">FEValuesExtractors::Scalar</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__values__extractors_8h_source.html#l00078">fe_values_extractors.h:78</a></div></div>
<div class="ttc" id="namespaceinternal_html_a2b3d48efdf7c94da455dc6a3553bab79"><div class="ttname"><a href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">internal::assemble</a></div><div class="ttdeci">void assemble(const MeshWorker::DoFInfoBox&lt; dim, DOFINFO &gt; &amp;dinfo, A *assembler)</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00073">loop.h:73</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceDataComponentInterpretation_html_a0cd2da3afe902f9004c23a73dbcc8ab0"><div class="ttname"><a href="namespaceDataComponentInterpretation.html#a0cd2da3afe902f9004c23a73dbcc8ab0">DataComponentInterpretation::DataComponentInterpretation</a></div><div class="ttdeci">DataComponentInterpretation</div><div class="ttdef"><b>Definition:</b> <a href="data__component__interpretation_8h_source.html#l00045">data_component_interpretation.h:45</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a6b25dd8f005063d8d2b0a4bdb0d277f3"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a6b25dd8f005063d8d2b0a4bdb0d277f3">Physics::Elasticity::Kinematics::w</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; w(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00158">lapack_support.h:158</a></div></div>
<div class="ttc" id="classDoFHandler_html_a84b803d7c74ab87a3eb2e1367611246b"><div class="ttname"><a href="classDoFHandler.html#a84b803d7c74ab87a3eb2e1367611246b">DoFHandler::reinit</a></div><div class="ttdeci">void reinit(const Triangulation&lt; dim, spacedim &gt; &amp;tria)</div><div class="ttdef"><b>Definition:</b> <a href="dof__handler_8cc_source.html#l02172">dof_handler.cc:2172</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_af27ac28c698a9ed0199faed50a204538"><div class="ttname"><a href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a></div><div class="ttdeci">void interpolate_boundary_values(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::map&lt; types::boundary_id, const Function&lt; spacedim, number &gt; *&gt; &amp;function_map, std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
<div class="ttc" id="classTensor_html"><div class="ttname"><a href="classTensor.html">Tensor&lt; 1, dim &gt;</a></div></div>
<div class="ttc" id="namespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00223">numbers.h:223</a></div></div>
<div class="ttc" id="classComponentMask_html"><div class="ttname"><a href="classComponentMask.html">ComponentMask</a></div><div class="ttdef"><b>Definition:</b> <a href="component__mask_8h_source.html#l00072">component_mask.h:72</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdoc">Normal vectors. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00109">fe_update_flags.h:109</a></div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00184">dof_handler.h:184</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="namespacenumbers_html"><div class="ttname"><a href="namespacenumbers.html">numbers</a></div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00187">numbers.h:187</a></div></div>
<div class="ttc" id="group__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00039">fe.h:39</a></div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="classFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="classFEValuesBase_html"><div class="ttname"><a href="classFEValuesBase.html">FEValuesBase</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00037">fe.h:37</a></div></div>
<div class="ttc" id="classDataOutInterface_html_a93c780f93105e0daaa76c6c43694b4ae"><div class="ttname"><a href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">DataOutInterface::write_vtu</a></div><div class="ttdeci">void write_vtu(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07232">data_out_base.cc:7232</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_a676190d2c897ac5da68a9c460fa95832"><div class="ttname"><a href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a></div><div class="ttdeci">void integrate_difference(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const InVector &amp;fe_function, const Function&lt; spacedim, typename InVector::value_type &gt; &amp;exact_solution, OutVector &amp;difference, const Quadrature&lt; dim &gt; &amp;q, const NormType &amp;norm, const Function&lt; spacedim, double &gt; *weight=nullptr, const double exponent=2.)</div></div>
<div class="ttc" id="namespaceinternal_1_1VectorOperations_html_a40c8daa0881cff0123fbaeb08929f5cb"><div class="ttname"><a href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">internal::VectorOperations::copy</a></div><div class="ttdeci">void copy(const T *begin, const T *end, U *dest)</div><div class="ttdef"><b>Definition:</b> <a href="vector__operations__internal_8h_source.html#l00069">vector_operations_internal.h:69</a></div></div>
<div class="ttc" id="vectorization_8h_html_ad9b7aa5c50bf9ce988a0f756a3f2baa5"><div class="ttname"><a href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sin(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05334">vectorization.h:5334</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a1cf30058b31ce7f9b389e8310bb9fc54"><div class="ttname"><a href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">GridRefinement::refine</a></div><div class="ttdeci">void refine(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold, const unsigned int max_to_mark=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00168">grid_refinement.cc:168</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="classFEFaceValues_html"><div class="ttname"><a href="classFEFaceValues.html">FEFaceValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00041">fe.h:41</a></div></div>
<div class="ttc" id="vectorization_8h_html_a303f564e3c189251976da401ee2e44fa"><div class="ttname"><a href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05442">vectorization.h:5442</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_adb1b44ad6f1741fbbbecc43f95d26baf"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">Physics::Elasticity::Kinematics::l</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; l(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceFEValuesExtractors_html"><div class="ttname"><a href="namespaceFEValuesExtractors.html">FEValuesExtractors</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__values__extractors_8h_source.html#l00069">fe_values_extractors.h:69</a></div></div>
<div class="ttc" id="namespaceDerivativeApproximation_1_1internal_html_a4bea05d5ab84ca1e802db9a0217d1d6c"><div class="ttname"><a href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">DerivativeApproximation::internal::approximate</a></div><div class="ttdeci">void approximate(SynchronousIterators&lt; std::tuple&lt; typename DoFHandler&lt; dim, spacedim &gt;::active_cell_iterator, Vector&lt; float &gt;::iterator &gt;&gt; const &amp;cell, const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const InputVector &amp;solution, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__approximation_8cc_source.html#l00918">derivative_approximation.cc:918</a></div></div>
<div class="ttc" id="classFEValues_html_a21f914e63d588e2652a9514620653d77"><div class="ttname"><a href="classFEValues.html#a21f914e63d588e2652a9514620653d77">FEValues::reinit</a></div><div class="ttdeci">void reinit(const TriaIterator&lt; DoFCellAccessor&lt; dim, spacedim, level_dof_access &gt;&gt; &amp;cell)</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8cc_source.html#l04515">fe_values.cc:4515</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
