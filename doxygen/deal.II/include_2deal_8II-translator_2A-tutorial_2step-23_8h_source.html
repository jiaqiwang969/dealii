<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-23_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-23.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-23.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-23_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; ,</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0) <span class="keyword">const</span> <span class="keyword">override</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;     {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;       (void)component;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;       <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;     }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   };</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;* </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;* </div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;   <span class="keyword">class </span>InitialValuesV : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   {</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;  <span class="comment">/*p*/</span> ,</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0)<span class="keyword"> const override</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;       (void)component;</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;       <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;   };</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;* </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;* </div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;* </div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;*  Secondly, we have the right hand side forcing term. Boring as we are, we choose <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> here as well:</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;* </div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;* </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;* @code</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;   <span class="keyword">class </span>RightHandSide : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;   {</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;  <span class="comment">/*p*/</span> ,</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0)<span class="keyword"> const override</span></div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;       (void)component;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;       <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;     }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   };</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;* </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160; </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;* </div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;* </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;*  Finally, we have boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="keywordflow">for</span>   @f$u@f$   and   @f$v@f$  . They are as described in the introduction, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> being the time derivative of the other:</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;* </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;* </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;* @code</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;   <span class="keyword">class </span>BoundaryValuesU : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;   {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0)<span class="keyword"> const override</span></div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;       (void)component;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;* </div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;       <span class="keywordflow">if</span> ((this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>() &lt;= 0.5) &amp;&amp; (p[0] &lt; 0) &amp;&amp; (p[1] &lt; 1. / 3) &amp;&amp;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;           (p[1] &gt;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;* </div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;-1. / 3))</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;         <span class="keywordflow">return</span> <a class="code" href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a>(this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>() 4 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;       <span class="keywordflow">else</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;     }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   };</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;* </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;* </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <span class="keyword">class </span>BoundaryValuesV : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   {</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp; p,</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component = 0)<span class="keyword"> const override</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;       (void)component;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(component == 0, <a class="code" href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">ExcIndexRange</a>(component, 0, 1));</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;* </div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;       <span class="keywordflow">if</span> ((this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>() &lt;= 0.5) &amp;&amp; (p[0] &lt; 0) &amp;&amp; (p[1] &lt; 1. / 3) &amp;&amp;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;           (p[1] &gt;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;* </div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;-1. / 3))</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;         <span class="keywordflow">return</span> (std::cos(this-&gt;<a class="code" href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">get_time</a>() 4 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>) 4 <a class="code" href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a>);</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;       <span class="keywordflow">else</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;         <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;     }</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   };</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;* </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160; </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;* </div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;* </div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ImplementationofthecodeWaveEquationcodeclass&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Implementation of the &lt;code&gt;WaveEquation&lt;/code&gt; <span class="keyword">class</span>&lt;/h3&gt;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;* </div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;* </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;*  The implementation of the actual logic is actually fairly short, since we relegate things like assembling the matrices and right hand side vectors to the library. The rest boils down to not much more than 130 lines of actual code, a significant fraction of which is boilerplate code that can be taken from previous example programs (<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g. the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> that solve linear systems, or that generate output).   </div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;*   Let<span class="stringliteral">&#39;s start with the constructor (for an explanation of the choice of time step, see the section on Courant, Friedrichs, and Lewy in the introduction):</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="stringliteral">   WaveEquation&lt;dim&gt;::WaveEquation()</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral">     : fe(1)</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="stringliteral">     , dof_handler(triangulation)</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="stringliteral">     , time_step(1. / 64)</span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="stringliteral">     , time(time_step)</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="stringliteral">     , timestep_number(1)</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="stringliteral">     , theta(0.5)</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="stringliteral">   {}</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;WaveEquationsetup_system&quot;&gt;&lt;/a&gt;  &lt;h4&gt;WaveEquation::setup_system&lt;/h4&gt;</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="stringliteral">*  The next function is the one that sets up the mesh, DoFHandler, and matrices and vectors at the beginning of the program, i.e. before the first time step. The first few lines are pretty much standard if you&#39;</span>ve read through the tutorial programs at least up to   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>  :</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;* </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;* </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;* @code</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;   <span class="keywordtype">void</span> WaveEquation&lt;dim&gt;::setup_system()</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;     <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;* </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;-1, 1);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(7);</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;* </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Number of active cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;* </div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;     dof_handler.distribute_dofs(fe);</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;* </div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;               &lt;&lt; std::endl</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;* </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;     <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(), dof_handler.n_dofs());</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;     <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp);</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;     sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;* </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;* </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;*  Then comes a block where we have to initialize the 3 matrices we need in the course of the program: the mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, the Laplace <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, and the matrix   @f$M+k^2\theta^2<a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a>@f$   used when solving <span class="keywordflow">for</span>   @f$U^n@f$   in each time step.     </div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;*   When setting up these matrices, note that they all make use of the same sparsity pattern <span class="keywordtype">object</span>. Finally, the reason why matrices and sparsity patterns are separate objects in deal.II (unlike in many other finite element or linear algebra classes) becomes clear: in a significant fraction of applications, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> has to hold several matrices that happen to have the same sparsity pattern, and there is no reason <span class="keywordflow">for</span> them not to share <span class="keyword">this</span> information, rather than re-building and wasting memory on it several times.     </div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;*   After initializing all of these matrices, we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> library <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> that build the Laplace and mass matrices. All they need is a <a class="code" href="classDoFHandler.html">DoFHandler</a> <span class="keywordtype">object</span> and a quadrature formula <span class="keywordtype">object</span> that is to be used <span class="keywordflow">for</span> numerical integration. Note that in many respects these <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> are better than what we would usually <span class="keywordflow">do</span> in application programs, <span class="keywordflow">for</span> example because they automatically parallelize building the matrices <span class="keywordflow">if</span> multiple processors are available in a machine: <span class="keywordflow">for</span> more information see the documentation of <a class="code" href="namespaceWorkStream.html">WorkStream</a> or the   @ref threads   <span class="stringliteral">&quot;Parallel computing with multiple processors&quot;</span> module. The matrices <span class="keywordflow">for</span> solving linear systems will be filled in the <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>() method because we need to re-<a class="code" href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">apply</a> boundary conditions every time step.</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;* </div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;* </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;* @code</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;     <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(sparsity_pattern);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     laplace_matrix.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(sparsity_pattern);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;     matrix_u.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(sparsity_pattern);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;     matrix_v.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(sparsity_pattern);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;* </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;     <a class="code" href="namespaceMatrixCreator.html">MatrixCreator</a>::<a class="code" href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">create_mass_matrix</a>(dof_handler,</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                       <a class="code" href="classQGauss.html">QGauss</a>&lt;dim&gt;(fe.degree + 1),</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                       <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;     <a class="code" href="namespaceMatrixCreator.html">MatrixCreator</a>::<a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">create_laplace_matrix</a>(dof_handler,</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                          <a class="code" href="classQGauss.html">QGauss</a>&lt;dim&gt;(fe.degree + 1),</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                          laplace_matrix);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;* </div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; @endcode</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;* </div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;*  The rest of the function is spent on setting vector sizes to the correct value. The final line closes the hanging node constraints <span class="keywordtype">object</span>. Since we work on a uniformly refined mesh, no constraints exist or have been computed (i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>. there was no need to <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a>   <a class="code" href="namespaceDoFTools.html">DoFTools</a>::<a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">make_hanging_node_constraints</a>   as in other programs), but we need a constraints <span class="keywordtype">object</span> in <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> place further down below anyway.</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;* </div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;* </div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;* @code</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;     solution_u.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(dof_handler.n_dofs());</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;     solution_v.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(dof_handler.n_dofs());</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     old_solution_u.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(dof_handler.n_dofs());</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;     old_solution_v.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(dof_handler.n_dofs());</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     system_rhs.<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>(dof_handler.n_dofs());</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;* </div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;     constraints.close();</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;   }</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;* </div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;* </div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; @endcode</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;* </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;*   &lt;a name=&quot;WaveEquationsolve_uandWaveEquationsolve_v&quot;&gt;&lt;/a&gt;  &lt;h4&gt;WaveEquation::solve_u and WaveEquation::solve_v&lt;/h4&gt;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;* </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;* </div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;*  The next two <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> deal with solving the linear systems associated with the equations for   @f$U^n@f$   and   @f$V^n@f$  . Both are not particularly interesting as they pretty much follow the scheme used in all the previous tutorial programs.   </div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;*   One can make little experiments with preconditioners for the two matrices we have to <a class="code" href="symmetric__tensor_8h.html#a3656e2f6095f612536b06139a6a2ca39">invert</a>. As it turns out, however, for the matrices at hand here, using Jacobi or SSOR preconditioners reduces the number of iterations necessary to solve the linear system slightly, but due to the cost of applying the preconditioner it is no win in terms of <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>-time. It is not much of a loss either, but let&#39;s keep it simple and just do without:</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;* </div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;* </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;* @code</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;   <span class="keywordtype">void</span> WaveEquation&lt;dim&gt;::solve_u()</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;   {</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-8 system_rhs.l2_norm());</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;     <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; cg(solver_control);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;* </div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;     cg.solve(matrix_u, solution_u, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;* </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   u-equation: &quot;</span> &lt;&lt; solver_control.last_step()</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; CG iterations.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   }</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;* </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;* </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <span class="keywordtype">void</span> WaveEquation&lt;dim&gt;::solve_v()</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   {</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-8 system_rhs.l2_norm());</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;     <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; cg(solver_control);</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;* </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;     cg.solve(matrix_v, solution_v, system_rhs, <a class="code" href="classPreconditionIdentity.html">PreconditionIdentity</a>());</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;* </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   v-equation: &quot;</span> &lt;&lt; solver_control.last_step()</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;               &lt;&lt; <span class="stringliteral">&quot; CG iterations.&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   }</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;* </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;* </div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;* </div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WaveEquationoutput_results&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;WaveEquation::output_results&lt;/h4&gt;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;* </div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;* </div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;*  Likewise, the following <span class="keyword">function</span> is pretty much what we<span class="stringliteral">&#39;ve done before. The only thing worth mentioning is how here we generate a string representation of the time step number padded with leading zeros to 3 character length using the   Utilities::int_to_string   function&#39;</span>s <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> argument.</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;* </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;* </div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;* @code</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   <span class="keywordtype">void</span> WaveEquation&lt;dim&gt;::output_results()<span class="keyword"> const</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;     <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;* </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;     data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;     data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(solution_u, <span class="stringliteral">&quot;U&quot;</span>);</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;     data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(solution_v, <span class="stringliteral">&quot;V&quot;</span>);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;* </div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;     data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;* </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;     <span class="keyword">const</span> std::string filename =</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;       <span class="stringliteral">&quot;solution-&quot;</span> + <a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a>(timestep_number, 3) + <span class="stringliteral">&quot;.vtu&quot;</span>;</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;* </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;*  Like   @ref step_15 <span class="stringliteral">&quot;step-15&quot;</span>  , since we write output at every time step (and the system we have to solve is relatively easy), we instruct <a class="code" href="classDataOut.html">DataOut</a> to use the zlib compression algorithm that is optimized <span class="keywordflow">for</span> speed instead of disk usage since otherwise plotting the output becomes a bottleneck:</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;* </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;* </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;* @code</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;     <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> vtk_flags;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;     vtk_flags.<a class="code" href="structDataOutBase_1_1VtkFlags.html#a3be0d6de1c92b770e8664bce2fc7c107">compression_level</a> =</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;       DataOutBase::VtkFlags::ZlibCompressionLevel::best_speed;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;     data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(vtk_flags);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;     std::ofstream output(filename);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;     data_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(output);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;   }</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;* </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160; </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;* </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;* </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;WaveEquationrun&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WaveEquation::run</a>&lt;/h4&gt;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;* </div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;* </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;*  The following is really the only interesting <span class="keyword">function</span> of the program. It contains the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all time steps, but before we <span class="keyword">get</span> to that we have to <span class="keyword">set</span> up the grid, <a class="code" href="group__dofs.html#ga768cd565b5c25f1ac235586e36ac94d6">DoFHandler</a>, and matrices. In addition, we have to somehow <span class="keyword">get</span> started with <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>. To <span class="keyword">this</span> <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a>, we use the   <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>   <span class="keyword">function</span> that takes an <span class="keywordtype">object</span> that describes a continuous <span class="keyword">function</span> and computes the   @f$L^2@f$   projection of <span class="keyword">this</span> <span class="keyword">function</span> onto the finite element space described by the DoFHandler <span class="keywordtype">object</span>. Can<span class="stringliteral">&#39;t be any simpler than that:</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="stringliteral">   void WaveEquation&lt;dim&gt;::run()</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">     setup_system();</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="stringliteral">     VectorTools::project(dof_handler,</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="stringliteral">                          constraints,</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="stringliteral">                          QGauss&lt;dim&gt;(fe.degree + 1),</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="stringliteral">                          InitialValuesU&lt;dim&gt;(),</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="stringliteral">                          old_solution_u);</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="stringliteral">     VectorTools::project(dof_handler,</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="stringliteral">                          constraints,</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="stringliteral">                          QGauss&lt;dim&gt;(fe.degree + 1),</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="stringliteral">                          InitialValuesV&lt;dim&gt;(),</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="stringliteral">                          old_solution_v);</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="stringliteral">*  The next thing is to loop over all the time steps until we reach the end time (  @f$T=5@f$   in this case). In each time step, we first have to solve for   @f$U^n@f$  , using the equation   @f$(M^n + k^2\theta^2 A^n)U^n =@f$     @f$(M^{n,n-1}</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="stringliteral">- k^2\theta(1-\theta) A^{n,n-1})U^{n-1} + kM^{n,n-1}V^{n-1}</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="stringliteral"> +@f$     @f$k\theta \left[k \theta F^n + k(1-\theta) F^{n-1} \right]@f$  . Note that we use the same mesh for all time steps, so that   @f$M^n=M^{n,n-1}=M@f$   and   @f$A^n=A^{n,n-1}=A@f$  . What we therefore have to do first is to add up   @f$MU^{n-1}</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="stringliteral">- k^2\theta(1-\theta) AU^{n-1} + kMV^{n-1}@f$   and the forcing terms, and put the result into the   &lt;code&gt;system_rhs&lt;/code&gt;   vector. (For these additions, we need a temporary vector that we declare before the loop to avoid repeated memory allocations in each time step.)     </span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">*   The one thing to realize here is how we communicate the time variable to the object describing the right hand side: each object derived from the Function class has a time field that can be set using the   Function::set_time   and read by   Function::get_time.   In essence, using this mechanism, all functions of space and time are therefore considered functions of space evaluated at a particular time. This matches well what we typically need in finite element programs, where we almost always work on a single time step at a time, and where it never happens that, for example, one would like to evaluate a space-time function for all times at any given spatial location.</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral">     Vector&lt;double&gt; tmp(solution_u.size());</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral">     Vector&lt;double&gt; forcing_terms(solution_u.size());</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">     for (; time &lt;= 5; time += time_step, ++timestep_number)</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;Time step &quot; &lt;&lt; timestep_number &lt;&lt; &quot; at t=&quot; &lt;&lt; time</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">                   &lt;&lt; std::endl;</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral">         mass_matrix.vmult(system_rhs, old_solution_u);</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">         mass_matrix.vmult(tmp, old_solution_v);</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral">         system_rhs.add(time_step, tmp);</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral">         laplace_matrix.vmult(tmp, old_solution_u);</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">         system_rhs.add(-theta (1</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">- theta) time_step time_step, tmp);</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">         RightHandSide&lt;dim&gt; rhs_function;</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">         rhs_function.set_time(time);</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">         VectorTools::create_right_hand_side(dof_handler,</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="stringliteral">                                             QGauss&lt;dim&gt;(fe.degree + 1),</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="stringliteral">                                             rhs_function,</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="stringliteral">                                             tmp);</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="stringliteral">         forcing_terms = tmp;</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="stringliteral">         forcing_terms= theta time_step;</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="stringliteral">         rhs_function.set_time(time</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="stringliteral">- time_step);</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="stringliteral">         VectorTools::create_right_hand_side(dof_handler,</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="stringliteral">                                             QGauss&lt;dim&gt;(fe.degree + 1),</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="stringliteral">                                             rhs_function,</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="stringliteral">                                             tmp);</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="stringliteral">         forcing_terms.add((1</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="stringliteral">- theta) time_step, tmp);</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="stringliteral">         system_rhs.add(theta time_step, forcing_terms);</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">*  After so constructing the right hand side vector of the first equation, all we have to do is apply the correct boundary values. As for the right hand side, this is a space-time function evaluated at a particular time, which we interpolate at boundary nodes and then use the result to apply boundary values as we usually do. The result is then handed off to the solve_u() function:</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral">         {</span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral">           BoundaryValuesU&lt;dim&gt; boundary_values_u_function;</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="stringliteral">           boundary_values_u_function.set_time(time);</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="stringliteral">           std::map&lt;types::global_dof_index, double&gt; boundary_values;</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="stringliteral">           VectorTools::interpolate_boundary_values(dof_handler,</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="stringliteral">                                                    0,</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral">                                                    boundary_values_u_function,</span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral">                                                    boundary_values);</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral">*  The matrix for solve_u() is the same in every time steps, so one could think that it is enough to do this only once at the beginning of the simulation. However, since we need to apply boundary values to the linear system (which eliminate some matrix rows and columns and give contributions to the right hand side), we have to refill the matrix in every time steps before we actually apply boundary data. The actual content is very simple: it is the sum of the mass matrix and a weighted Laplace matrix:</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">           matrix_u.copy_from(mass_matrix);</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral">           matrix_u.add(theta theta time_step time_step, laplace_matrix);</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">           MatrixTools::apply_boundary_values(boundary_values,</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">                                              matrix_u,</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">                                              solution_u,</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral">                                              system_rhs);</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">         solve_u();</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">*  The second step, i.e. solving for   @f$V^n@f$  , works similarly, except that this time the matrix on the left is the mass matrix (which we copy again in order to be able to apply boundary conditions, and the right hand side is   @f$MV^{n-1}</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="stringliteral">- k\left[ \theta A U^n +</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="stringliteral"> (1-\theta) AU^{n-1}\right]@f$   plus forcing terms. Boundary values are applied in the same way as before, except that now we have to use the BoundaryValuesV class:</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="stringliteral">         laplace_matrix.vmult(system_rhs, solution_u);</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="stringliteral">         system_rhs=</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral">-theta time_step;</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral">         mass_matrix.vmult(tmp, old_solution_v);</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="stringliteral">         system_rhs += tmp;</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">         laplace_matrix.vmult(tmp, old_solution_u);</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">         system_rhs.add(-time_step (1</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral">- theta), tmp);</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="stringliteral">         system_rhs += forcing_terms;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="stringliteral">         {</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="stringliteral">           BoundaryValuesV&lt;dim&gt; boundary_values_v_function;</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="stringliteral">           boundary_values_v_function.set_time(time);</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="stringliteral">           std::map&lt;types::global_dof_index, double&gt; boundary_values;</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="stringliteral">           VectorTools::interpolate_boundary_values(dof_handler,</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="stringliteral">                                                    0,</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="stringliteral">                                                    boundary_values_v_function,</span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="stringliteral">                                                    boundary_values);</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="stringliteral">           matrix_v.copy_from(mass_matrix);</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">           MatrixTools::apply_boundary_values(boundary_values,</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="stringliteral">                                              matrix_v,</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="stringliteral">                                              solution_v,</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="stringliteral">                                              system_rhs);</span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="stringliteral">         solve_v();</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="stringliteral">*  Finally, after both solution components have been computed, we output the result, compute the energy in the solution, and go on to the next time step after shifting the present solution into the vectors that hold the solution at the previous time step. Note the function   SparseMatrix::matrix_norm_square   that can compute   @f$\left&lt;V^n,MV^n\right&gt;@f$   and   @f$\left&lt;U^n,AU^n\right&gt;@f$   in one step, saving us the expense of a temporary vector and several lines of code:</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="stringliteral">         output_results();</span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;   Total energy: &quot;</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral">                   &lt;&lt; (mass_matrix.matrix_norm_square(solution_v) +</span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="stringliteral">                       laplace_matrix.matrix_norm_square(solution_u)) /</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="stringliteral">                        2</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="stringliteral">                   &lt;&lt; std::endl;</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="stringliteral">         old_solution_u = solution_u;</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="stringliteral">         old_solution_v = solution_v;</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="stringliteral"> } // namespace Step23</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;Thecodemaincodefunction&quot;&gt;&lt;/a&gt;  &lt;h3&gt;The &lt;code&gt;main&lt;/code&gt; function&lt;/h3&gt;</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="stringliteral">*  What remains is the main function of the program. There is nothing here that hasn&#39;</span>t been shown in several of the previous programs:</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;* </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;* </div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;* @code</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; <span class="keywordtype">int</span> main()</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; {</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;   <span class="keywordflow">try</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;     {</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;       <span class="keyword">using namespace </span>Step23;</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;* </div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;       WaveEquation&lt;2&gt; wave_equation_solver;</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;       wave_equation_solver.run();</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;     }</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;   <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;     {</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;                 &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;* </div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;     }</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;   <span class="keywordflow">catch</span> (...)</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     {</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;     }</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;* </div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; }</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;* </div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;* When the program is <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>, it produces the following output:</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;* @code</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;Number of active cells: 16384</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;Number of degrees of freedom: 16641</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;* </div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;Time step 1 at t=0.015625</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;   u-equation: 8 CG iterations.</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;   v-equation: 22 CG iterations.</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;   Total energy: 1.17887</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;Time step 2 at t=0.03125</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   u-equation: 8 CG iterations.</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;   Total energy: 2.9655</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;Time step 3 at t=0.046875</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;   u-equation: 8 CG iterations.</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;   v-equation: 21 CG iterations.</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;   Total energy: 4.33761</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;Time step 4 at t=0.0625</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;   v-equation: 21 CG iterations.</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;   Total energy: 5.35499</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;Time step 5 at t=0.078125</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;   v-equation: 21 CG iterations.</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;   Total energy: 6.18652</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;Time step 6 at t=0.09375</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;   Total energy: 6.6799</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;* </div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;...</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;* </div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;Time step 31 at t=0.484375</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;   Total energy: 21.9068</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;Time step 32 at t=0.5</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;   Total energy: 23.3394</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;Time step 33 at t=0.515625</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;   Total energy: 23.1019</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;* </div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;...</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;* </div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;Time step 319 at t=4.98438</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;   Total energy: 23.1019</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;Time step 320 at t=5</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;   u-equation: 7 CG iterations.</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;   v-equation: 20 CG iterations.</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;   Total energy: 23.1019</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;@endcode</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;* </div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;* What we see immediately is that the energy is a constant at least after  @f$t=\frac 12@f$   (until which the boundary source term   @f$g@f$   is <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a>, injectingenergy into the system).</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;* In addition to the screen output, the program writes the solution of each timestep to an output file. If we process them adequately and paste them into amovie, we <span class="keyword">get</span> the following:</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;*   &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-23.movie.gif&quot;</span> alt=<span class="stringliteral">&quot;Animation of the solution of step 23.&quot;</span>&gt;  </div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;* The movie shows the generated wave nice traveling through the domain and back,being reflected at the clamped boundary. Some numerical noise is trailing thewave, an artifact of a too-large mesh size that can be reduced by reducing themesh width and the time step.</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;* </div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;* &lt;a name=<span class="stringliteral">&quot;extensions&quot;</span>&gt;&lt;/a&gt;&lt;a name=<span class="stringliteral">&quot;Possibilitiesforextensions&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Possibilities <span class="keywordflow">for</span> extensions&lt;/h3&gt;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;* </div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;* If you want to explore a bit, <span class="keywordflow">try</span> out some of the following things:  &lt;ul&gt;      &lt;li&gt;  Varying   @f$\theta@f$  . This gives different time stepping schemes, some of  which are stable <span class="keywordflow">while</span> others are not. Take a look at how the energy  evolves.</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;*     &lt;li&gt;  Different <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> and boundary conditions, right hand sides.</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;*     &lt;li&gt;  More complicated domains or more refined meshes. Remember that the time  step needs to be bounded by the mesh width, so changing the mesh should  <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> involve also changing the time step. We will come back to <span class="keyword">this</span> issue  in   @ref step_24 <span class="stringliteral">&quot;step-24&quot;</span>  .</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;*     &lt;li&gt;  Variable coefficients: In real media, the wave speed is often  variable. In particular, the <span class="stringliteral">&quot;real&quot;</span> wave equation in realistic media would  read  @f[</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;     \rho(x) \frac{\partial^2 u}{\partial t^2}</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;* </div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;* </div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;* </div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;* </div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;* </div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;* </div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;* </div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;* </div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;* </div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;* </div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;* </div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;-</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;     \nabla \cdot</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;     a(x) \nabla u = f,</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  @f]  where   @f$\rho(x)@f$   is the density of the material, and   @f$a(x)@f$   is related to the  stiffness coefficient. The wave speed is then   @f$c=\sqrt{a/\rho}@f$  .</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;*   To make such a change, we would have to compute the mass and Laplace  matrices with a variable coefficient. Fortunately, <span class="keyword">this</span> isn<span class="stringliteral">&#39;t too hard: the  functions   MatrixCreator::create_laplace_matrix   and    MatrixCreator::create_mass_matrix   have additional default parameters that can  be used to pass non-constant coefficient functions to them. The required  changes are therefore relatively small. On the other hand, care must be  taken again to make sure the time step is within the allowed range.</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="stringliteral">*     &lt;li&gt;  In the in-code comments, we discussed the fact that the matrices for  solving for   @f$U^n@f$   and   @f$V^n@f$   need to be reset in every time because of  boundary conditions, even though the actual content does not change. It is  possible to avoid copying by not eliminating columns in the linear systems,  which is implemented by appending a   @p false   argument to the call: </span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="stringliteral">    MatrixTools::apply_boundary_values(boundary_values,</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="stringliteral">                                       matrix_u,</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="stringliteral">                                       solution_u,</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="stringliteral">                                       system_rhs,</span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="stringliteral">                                       false);</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="stringliteral">  @endcode</span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="stringliteral">*     &lt;li&gt;  deal.II being a library that supports adaptive meshes it would of course be  nice if this program supported change the mesh every few time steps. Given the  structure of the solution &amp;mdash; a wave that travels through the domain &amp;mdash;  it would seem appropriate if we only refined the mesh where the wave currently is,  and not simply everywhere. It is intuitively clear that we should be able to  save a significant amount of cells this way. (Though upon further thought one  realizes that this is really only the case in the initial stages of the simulation.  After some time, for wave phenomena, the domain is filled with reflections of  the initial wave going in every direction and filling every corner of the domain.  At this point, there is in general little one can gain using local mesh  refinement.)</span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="stringliteral">*   To make adaptively changing meshes possible, there are basically two routes.  The &quot;correct&quot; way would be to go back to the weak form we get using Rothe&#39;</span>s  method. For example, the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> of the two equations to be solved in each time  step looked like <span class="keyword">this</span>:  \f{eqnarray*}</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;  (u^n,\varphi) + k^2\theta^2(\nabla u^n,\nabla \varphi) &amp;=&amp;</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;  (u^{n-1},\varphi)</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;* </div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;- k^2\theta(1-\theta)(\nabla u^{n-1},\nabla \varphi)</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  +</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;  k(v^{n-1},\varphi)</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;  + k^2\theta</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;  \left[</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;  \theta (f^n,\varphi) + (1-\theta) (f^{n-1},\varphi)</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  \right].</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  \f}  Now, note that we solve <span class="keywordflow">for</span>   @f$u^n@f$   on mesh   @f${\mathbb <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}^n@f$  , and  consequently the test <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>   @f$\varphi@f$   have to be from the space    @f$V_h^n@f$   as well. As discussed in the introduction, terms like    @f$(u^{n-1},\varphi)@f$   then require us to integrate the solution of the  previous step (which may have been computed on a different mesh    @f${\mathbb <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}^{n-1}@f$  ) against the test <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> of the current mesh,  leading to a matrix   @f$M^{n,n-1}@f$  . This process of integrating shape  <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> from different meshes is, at best, awkward. It can be done  but because it is difficult to ensure that   @f${\mathbb <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}^{n-1}@f$   and    @f${\mathbb <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}^{n}@f$   differ by at most <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> of refinement, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>  has to recursively match cells from both meshes. It is feasible to  <span class="keywordflow">do</span> <span class="keyword">this</span>, but it leads to lengthy and not entirely obvious code.</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;*   The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> approach is the following: whenever we change the mesh,  we simply <a class="code" href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">interpolate</a> the solution from the last time step on the old  mesh to the <span class="keyword">new</span> mesh, <span class="keyword">using</span> the <a class="code" href="classSolutionTransfer.html">SolutionTransfer</a> <span class="keyword">class</span>. In other words,  instead of the equation above, we would solve  \f{eqnarray*}</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;  (u^n,\varphi) + k^2\theta^2(\nabla u^n,\nabla \varphi) &amp;=&amp;</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  (I^n u^{n-1},\varphi)</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;* </div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;- k^2\theta(1-\theta)(\nabla I^n u^{n-1},\nabla \varphi)</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  +</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;  k(I^n v^{n-1},\varphi)</div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;  + k^2\theta</div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;  \left[</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;  \theta (f^n,\varphi) + (1-\theta) (f^{n-1},\varphi)</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  \right],</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  \f}  where   @f$I^n@f$   interpolates a given <span class="keyword">function</span> onto mesh   @f${\mathbb <a class="code" href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">T</a>}^n@f$  .  This is a much simpler approach because, in each time step, we no  longer have to worry whether   @f$u^{n-1},v^{n-1}@f$   were computed on the  same mesh as we are <span class="keyword">using</span> now or on a different mesh. Consequently,  the only changes to the code necessary are the addition of a <span class="keyword">function</span>  that computes the error, marks cells <span class="keywordflow">for</span> refinement, sets up a  <a class="code" href="classSolutionTransfer.html">SolutionTransfer</a> object, transfers the solution to the <span class="keyword">new</span> mesh, and  rebuilds matrices and right hand side vectors on the <span class="keyword">new</span> mesh. Neither  the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> building the matrices and right hand sides, nor the  solvers need to be changed.</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;*   While <span class="keyword">this</span> <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> approach is, strictly speaking,  not quite correct in the Rothe framework (it introduces an addition source  of error, namely the interpolation), it is nevertheless what  almost everyone solving time dependent equations does. We will use <span class="keyword">this</span>  method in   @ref step_31 <span class="stringliteral">&quot;step-31&quot;</span>  , <span class="keywordflow">for</span> example.  &lt;/ul&gt;  </div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;* </div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;* &lt;a name=<span class="stringliteral">&quot;PlainProg&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include <span class="stringliteral">&quot;step-23.cc&quot;</span>  </div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;*</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;*/</div><div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="namespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="matrix__block_8h_source.html#l00575">matrix_block.h:575</a></div></div>
<div class="ttc" id="structDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l00871">data_out_base.h:871</a></div></div>
<div class="ttc" id="classFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00116">function.h:116</a></div></div>
<div class="ttc" id="namespaceMatrixCreator_html_a7b8157122064151d414dc34a22a3ca9c"><div class="ttname"><a href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a></div><div class="ttdeci">void create_laplace_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; double &gt; &amp;matrix, const Function&lt; spacedim &gt; *const a=nullptr, const AffineConstraints&lt; double &gt; &amp;constraints=AffineConstraints&lt; double &gt;())</div></div>
<div class="ttc" id="classDataOutInterface_html_ac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08210">data_out_base.cc:8210</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="classDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00296">dynamic_sparsity_pattern.h:296</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="classDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="structDataOutBase_1_1VtkFlags_html_a3be0d6de1c92b770e8664bce2fc7c107"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html#a3be0d6de1c92b770e8664bce2fc7c107">DataOutBase::VtkFlags::compression_level</a></div><div class="ttdeci">ZlibCompressionLevel compression_level</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l00930">data_out_base.h:930</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="namespaceMatrixCreator_html"><div class="ttname"><a href="namespaceMatrixCreator.html">MatrixCreator</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__tools_8h_source.html#l00164">matrix_tools.h:164</a></div></div>
<div class="ttc" id="namespaceWorkStream_html"><div class="ttname"><a href="namespaceWorkStream.html">WorkStream</a></div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00079">work_stream.h:79</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga0d685aad996180f9851183ae3e29019a"><div class="ttname"><a href="group__Exceptions.html#ga0d685aad996180f9851183ae3e29019a">StandardExceptions::ExcIndexRange</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcIndexRange(int arg1, int arg2, int arg3)</div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceFETools_html_ad29759cb8c51f8d369a371f63be8dde0"><div class="ttname"><a href="namespaceFETools.html#ad29759cb8c51f8d369a371f63be8dde0">FETools::interpolate</a></div><div class="ttdeci">void interpolate(const DoFHandler&lt; dim, spacedim &gt; &amp;dof1, const InVector &amp;u1, const DoFHandler&lt; dim, spacedim &gt; &amp;dof2, OutVector &amp;u2)</div></div>
<div class="ttc" id="classSolutionTransfer_html"><div class="ttname"><a href="classSolutionTransfer.html">SolutionTransfer</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2solution__transfer_8h_source.html#l00228">solution_transfer.h:228</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">DoFTools::nonzero</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00161">dof_tools.h:161</a></div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="namespaceDoFTools_html"><div class="ttname"><a href="namespaceDoFTools.html">DoFTools</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00133">dof_tools.h:133</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1L2_html_a1c15243765304a803037988b5561627d"><div class="ttname"><a href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">LocalIntegrators::L2::mass_matrix</a></div><div class="ttdeci">void mass_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="l2_8h_source.html#l00057">l2.h:57</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a8cac1e477eff052db622c8a9a9426ea3"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8cac1e477eff052db622c8a9a9426ea3">LAPACKSupport::T</a></div><div class="ttdeci">static const char T</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00173">lapack_support.h:173</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01415">exceptions.h:1415</a></div></div>
<div class="ttc" id="namespacestd__cxx17_html_aa2fc1031c06af4aea4de90c5a1905473"><div class="ttname"><a href="namespacestd__cxx17.html#aa2fc1031c06af4aea4de90c5a1905473">std_cxx17::apply</a></div><div class="ttdeci">auto apply(F &amp;&amp;fn, Tuple &amp;&amp;t) -&gt; decltype(apply_impl(std::forward&lt; F &gt;(fn), std::forward&lt; Tuple &gt;(t), std::make_index_sequence&lt; std::tuple_size&lt; typename std::remove_reference&lt; Tuple &gt;::type &gt;::value &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="tuple_8h_source.html#l00036">tuple.h:36</a></div></div>
<div class="ttc" id="group__dofs_html_ga768cd565b5c25f1ac235586e36ac94d6"><div class="ttname"><a href="group__dofs.html#ga768cd565b5c25f1ac235586e36ac94d6">hp::DoFHandler</a></div><div class="ttdeci">::DoFHandler&lt; dim, spacedim &gt; DoFHandler</div><div class="ttdef"><b>Definition:</b> <a href="hp_2dof__handler_8h_source.html#l00054">dof_handler.h:54</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a9082f945c1d289684d0bcd51ee08e11e"><div class="ttname"><a href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a></div><div class="ttdeci">unsigned int level</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04590">grid_out.cc:4590</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="classPreconditionIdentity_html"><div class="ttname"><a href="classPreconditionIdentity.html">PreconditionIdentity</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00082">precondition.h:82</a></div></div>
<div class="ttc" id="namespaceMatrixCreator_html_aab6397f114af66efd781f7f4daba22be"><div class="ttname"><a href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">MatrixCreator::create_mass_matrix</a></div><div class="ttdeci">void create_mass_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; number &gt; &amp;matrix, const Function&lt; spacedim, number &gt; *const a=nullptr, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;())</div></div>
<div class="ttc" id="classDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00902">data_out_dof_data.h:902</a></div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00158">lapack_support.h:158</a></div></div>
<div class="ttc" id="namespacenumbers_html_a3e24f194a9cb9b6ff4442b8a7a877d4a"><div class="ttname"><a href="namespacenumbers.html#a3e24f194a9cb9b6ff4442b8a7a877d4a">numbers::PI</a></div><div class="ttdeci">static constexpr double PI</div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00223">numbers.h:223</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00184">dof_handler.h:184</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="group__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="symmetric__tensor_8h_html_a3656e2f6095f612536b06139a6a2ca39"><div class="ttname"><a href="symmetric__tensor_8h.html#a3656e2f6095f612536b06139a6a2ca39">invert</a></div><div class="ttdeci">constexpr SymmetricTensor&lt; 2, dim, Number &gt; invert(const SymmetricTensor&lt; 2, dim, Number &gt; &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor_8h_source.html#l03289">symmetric_tensor.h:3289</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="classFunction_html_acbfcab66b2fc63bfea59268f40772bb4"><div class="ttname"><a href="classFunction.html#acbfcab66b2fc63bfea59268f40772bb4">Function::value</a></div><div class="ttdeci">virtual RangeNumberType value(const Point&lt; dim &gt; &amp;p, const unsigned int component=0) const</div></div>
<div class="ttc" id="classDataOutInterface_html_a93c780f93105e0daaa76c6c43694b4ae"><div class="ttname"><a href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">DataOutInterface::write_vtu</a></div><div class="ttdeci">void write_vtu(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07232">data_out_base.cc:7232</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1System_html_a76bc1cc7649cc416723f450d24fdd91d"><div class="ttname"><a href="namespaceUtilities_1_1System.html#a76bc1cc7649cc416723f450d24fdd91d">Utilities::System::get_time</a></div><div class="ttdeci">std::string get_time()</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l01019">utilities.cc:1019</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
<div class="ttc" id="vectorization_8h_html_ad9b7aa5c50bf9ce988a0f756a3f2baa5"><div class="ttname"><a href="vectorization_8h.html#ad9b7aa5c50bf9ce988a0f756a3f2baa5">std::sin</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sin(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05334">vectorization.h:5334</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="group__constraints_html_ga3b4ea7dfd313e388d868c4e4aa685799"><div class="ttname"><a href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a></div><div class="ttdeci">void make_hanging_node_constraints(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, AffineConstraints&lt; number &gt; &amp;constraints)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__constraints_8cc_source.html#l01787">dof_tools_constraints.cc:1787</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
