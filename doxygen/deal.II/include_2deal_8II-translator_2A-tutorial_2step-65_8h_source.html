<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-65_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-65.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-65.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-65_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;  = 0) <span class="keyword">const</span> <span class="keyword">override</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;     {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;       <span class="keywordflow">if</span> (p.norm_square() &lt; 0.25)</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;         <span class="keywordflow">return</span> p.norm_square();</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;       <span class="keywordflow">else</span></div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         <span class="keywordflow">return</span> 0.1 p.norm_square() + (0.25</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;* </div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;- 0.025);</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;     }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;* </div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;     <span class="keyword">virtual</span> <a class="code" href="classTensor.html">Tensor&lt;1, dim&gt;</a></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;     <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a>(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p,</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <span class="comment">/*component*/</span>  = 0)<span class="keyword"> const override</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;       <span class="keywordflow">if</span> (p.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>() &lt; 0.25)</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;         <span class="keywordflow">return</span> 2. p;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;       <span class="keywordflow">else</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;         <span class="keywordflow">return</span> 0.2 p;</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;     }</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;   };</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;* </div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160; </div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;   <span class="keywordtype">double</span> coefficient(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;p)</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;     <span class="keywordflow">if</span> (p.<a class="code" href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">norm_square</a>() &lt; 0.25)</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;       <span class="keywordflow">return</span> 0.5;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;     <span class="keywordflow">else</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;       <span class="keywordflow">return</span> 5.0;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;   }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;* </div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160; </div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;* </div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;* </div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ThePoissonProblemclass&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The PoissonProblem <span class="keyword">class</span>&lt;/h3&gt;   </div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;*   The implementation of the Poisson problem is very similar to what we used in the   @ref step_5 <span class="stringliteral">&quot;step-5&quot;</span>   tutorial program. The two main differences are that we pass a mapping <span class="keywordtype">object</span> to the various steps in the program in order to <span class="keywordflow">switch</span> between two mapping representations as explained in the introduction, and the `timer` object (of type <a class="code" href="classTimerOutput.html">TimerOutput</a>) that will be used <span class="keywordflow">for</span> measuring the <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> times in the various cases. (The concept of mapping objects was <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> introduced in   @ref step_10 <span class="stringliteral">&quot;step-10&quot;</span>   and   @ref step_11 <span class="stringliteral">&quot;step-11&quot;</span>  , in <span class="keywordflow">case</span> you want to look up the use of these classes.)</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;* </div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;* </div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;* @code</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;   <span class="keyword">class </span>PoissonProblem</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;   {</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;     PoissonProblem();</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;     <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>();</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;* </div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;     <span class="keywordtype">void</span> create_grid();</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;     <span class="keywordtype">void</span> setup_system(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;mapping);</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;     <span class="keywordtype">void</span> assemble_system(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;mapping);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;     <span class="keywordtype">void</span> solve();</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;     <span class="keywordtype">void</span> postprocess(<span class="keyword">const</span> <a class="code" href="classMapping.html">Mapping&lt;dim&gt;</a> &amp;mapping);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;* </div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;     <a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>          fe;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;     <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>    dof_handler;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;* </div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;     <a class="code" href="classAffineConstraints.html">AffineConstraints&lt;double&gt;</a> constraints;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     <a class="code" href="classSparsityPattern.html">SparsityPattern</a>           sparsity_pattern;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;     <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a>      system_matrix;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>            solution;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>            system_rhs;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;* </div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;     <a class="code" href="classTimerOutput.html">TimerOutput</a> timer;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;   };</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;* </div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;* </div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;* </div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;*  In the constructor, we <span class="keyword">set</span> up the timer <span class="keywordtype">object</span> to record wall times but be quiet during the normal execution. We will query it <span class="keywordflow">for</span> timing details in the   `<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">PoissonProblem::run</a>()`   <span class="keyword">function</span>. Furthermore, we select a relatively high polynomial degree of three <span class="keywordflow">for</span> the finite element in use.</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;* </div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;* </div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;* @code</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;   PoissonProblem&lt;dim&gt;::PoissonProblem()</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;     : fe(3)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;     , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;     , timer(<a class="code" href="namespacestd.html">std</a>::cout, <a class="code" href="classTimerOutput.html">TimerOutput</a>::never, <a class="code" href="classTimerOutput.html">TimerOutput</a>::wall_times)</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;   {}</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;* </div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;* </div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;* </div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Gridcreationandinitializationofthemanifolds&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Grid creation and initialization of the manifolds&lt;/h3&gt;   </div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;*   The next <span class="keyword">function</span> presents the typical usage of <a class="code" href="classTransfiniteInterpolationManifold.html">TransfiniteInterpolationManifold</a>. The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> step is to create the desired grid, which can be done by composition of two grids from <a class="code" href="namespaceGridGenerator.html">GridGenerator</a>. The inner ball mesh is simple enough: We <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>   <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>()   centered at the origin with radius 0.5 (third function argument). The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> mesh is more interesting and constructed as follows: We want to have a mesh that is spherical in the interior but flat on the outer surface. Furthermore, the mesh topology of the inner ball should be compatible with the outer grid in the sense that their <a class="code" href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a> coincide so as to allow the two grid to be merged. The grid coming out of   <a class="code" href="namespaceGridGenerator.html">GridGenerator</a>::<a class="code" href="namespaceGridGenerator.html#ad85de345ccd86a53e63746709c8e1dfc">hyper_shell</a>   fulfills the requirements on the inner side in case it is created with   @f$2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$   coarse cells (6 coarse cells in 3D which we are going to use) &amp;ndash; this is the same number of cells as there are boundary faces for the ball. For the outer surface, we use the fact that the 6 faces on the surface of the shell without a manifold attached would degenerate to the surface of a cube. What we are still missing is the radius of the outer shell boundary. Since we desire a cube of extent   @f$[-1, 1]@f$   and the 6-cell shell puts its 8 outer <a class="code" href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a> at the 8 opposing diagonals, we must translate the points   @f$(\pm 1, \pm 1, \pm 1)@f$   into a radius: Clearly, the radius must be   @f$\sqrt{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>}@f$   in   @f$d@f$   dimensions, i.e.,   @f$\sqrt{3}@f$   <span class="keywordflow">for</span> the three-dimensional <span class="keywordflow">case</span> we want to consider.   </div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;*   Thus, we have a plan: After creating the inner <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> <span class="keywordflow">for</span> the ball and the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keywordflow">for</span> the outer shell, we <a class="code" href="namespaceinternal_1_1SymmetricTensorAccessors.html#a3080af8704b3a9882a6fab3eecc63568">merge</a> those two grids but <span class="keyword">remove</span> all manifolds that the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> in <a class="code" href="namespaceGridGenerator.html">GridGenerator</a> may have <span class="keyword">set</span> from the resulting <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, to ensure that we have full control over manifolds. In particular, we want additional points added on the boundary during refinement to follow a flat manifold description. To start the process of adding more appropriate manifold ids, we assign the manifold <span class="keywordtype">id</span> 0 to all mesh entities (cells, faces, lines), which will later be associated with the <a class="code" href="classTransfiniteInterpolationManifold.html">TransfiniteInterpolationManifold</a>. Then, we must identify the faces and lines that are along the sphere of radius 0.5 and mark them with a different manifold id, so as to then assign a <a class="code" href="classSphericalManifold.html">SphericalManifold</a> to those. We will choose the manifold <span class="keywordtype">id</span> of 1. Since we have thrown away all manifolds that pre-existed after calling   <a class="code" href="namespaceGridGenerator.html#a533c4778cbc9bcbed365dcab42ca4418">GridGenerator::hyper_ball</a>(),   we manually go through the cells of the mesh and all their faces. We have found a face on the sphere <span class="keywordflow">if</span> all four <a class="code" href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a> have a radius of 0.5, or, as we write in the program, have   @f$r^2-0.25 \approx 0@f$  . Note that we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> `cell-&gt;face(f)-&gt;set_all_manifold_ids(1)` to <span class="keyword">set</span> the manifold <span class="keywordtype">id</span> both on the faces and the surrounding lines. Furthermore, we want to distinguish the cells inside the ball and outside the ball by a material <span class="keywordtype">id</span> <span class="keywordflow">for</span> visualization, corresponding to the picture in the introduction.</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;* </div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;* </div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;* @code</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;   <span class="keywordtype">void</span> PoissonProblem&lt;dim&gt;::create_grid()</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;   {</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> tria_inner;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;     <a class="code" href="namespaceGridGenerator.html#a533c4778cbc9bcbed365dcab42ca4418">GridGenerator::hyper_ball</a>(tria_inner, <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(), 0.5);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;* </div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> tria_outer;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;     <a class="code" href="namespaceGridGenerator.html#ad85de345ccd86a53e63746709c8e1dfc">GridGenerator::hyper_shell</a>(</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;       tria_outer, <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(), 0.5, std::sqrt(dim), 2 dim);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;* </div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;     <a class="code" href="namespaceGridGenerator.html#a7cd88e7eacd46697dee80ad2b8438d54">GridGenerator::merge_triangulations</a>(tria_inner, tria_outer, triangulation);</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;* </div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;     triangulation.reset_all_manifolds();</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;     triangulation.set_all_manifold_ids(0);</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;* </div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : triangulation.cell_iterators())</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;       {</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;face : cell-&gt;face_iterators())</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;           {</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;             <span class="keywordtype">bool</span> face_at_sphere_boundary = <span class="keyword">true</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;             <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> v : face-&gt;vertex_indices())</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;               {</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                 <span class="keywordflow">if</span> (std::abs(face-&gt;vertex(v).norm_square()</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;* </div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;- 0.25) &gt; 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                   face_at_sphere_boundary = <span class="keyword">false</span>;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;               }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;             <span class="keywordflow">if</span> (face_at_sphere_boundary)</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;               face-&gt;set_all_manifold_ids(1);</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;           }</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;         <span class="keywordflow">if</span> (cell-&gt;center().norm_square() &lt; 0.25)</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;           cell-&gt;set_material_id(1);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;           cell-&gt;set_material_id(0);</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;       }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;* </div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;* </div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;*  With all cells, faces and lines marked appropriately, we can attach the <a class="code" href="classManifold.html">Manifold</a> objects to those <a class="code" href="namespacenumbers.html">numbers</a>. The entities with manifold <span class="keywordtype">id</span> 1 will <span class="keyword">get</span> a spherical manifold, whereas the other entities, which have the manifold <span class="keywordtype">id</span> 0, will be assigned the <a class="code" href="classTransfiniteInterpolationManifold.html">TransfiniteInterpolationManifold</a>. As mentioned in the introduction, we must explicitly initialize the manifold with the current mesh <span class="keyword">using</span> a <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> to   <a class="code" href="classTransfiniteInterpolationManifold.html#a34326a35d9ec4b6911d90c85c21847d8">TransfiniteInterpolationManifold::initialize</a>()   in order to pick up the coarse mesh cells and the manifolds attached to the boundaries of those cells. We also note that the manifold objects we create locally in this function are allowed to go out of scope (as they do at the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of the function scope), because the <a class="code" href="classTriangulation.html">Triangulation</a> <span class="keywordtype">object</span> internally copies them.     </div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;*   With all manifolds attached, we will finally go about and <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh a few times to create a sufficiently large test case.</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;* </div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;* </div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;* @code</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;     triangulation.set_manifold(1, <a class="code" href="classSphericalManifold.html">SphericalManifold</a>&lt;dim&gt;());</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;* </div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;     <a class="code" href="classTransfiniteInterpolationManifold.html">TransfiniteInterpolationManifold</a>&lt;dim&gt; transfinite_manifold;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;     transfinite_manifold.initialize(triangulation);</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;     triangulation.set_manifold(0, transfinite_manifold);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;* </div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;     triangulation.refine_global(9</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;* </div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;- 2 dim);</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;* </div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;* </div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160; @endcode</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;* </div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;*   &lt;a name=&quot;Setupofdatastructures&quot;&gt;&lt;/a&gt;  &lt;h3&gt;Setup of data structures&lt;/h3&gt;   </div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;*   The following function is well-known from other tutorials in that it enumerates the degrees of freedom, creates a constraint <span class="keywordtype">object</span> and sets up a sparse <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> for the linear system. The only thing worth mentioning is the fact that the function receives a reference to a mapping <span class="keywordtype">object</span> that we then pass to the   <a class="code" href="namespaceVectorTools.html">VectorTools</a>::<a class="code" href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">interpolate_boundary_values</a>()   function to ensure that our boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> are evaluated on the high-order mesh used for assembly. In the present example, it does not really matter because the outer surfaces are flat, but for curved outer cells this leads to more accurate approximation of the boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>.</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;* </div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;* </div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;* @code</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;   <span class="keywordtype">void</span> PoissonProblem&lt;dim&gt;::setup_system(const <a class="code" href="classMapping.html">Mapping</a>&lt;dim&gt; &amp;mapping)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;   {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;     dof_handler.distribute_dofs(fe);</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span></div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;               &lt;&lt; triangulation.n_global_active_cells() &lt;&lt; std::endl;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;* </div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;     {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Compute constraints&quot;</span>);</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;* </div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;       constraints.clear();</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;* </div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;       <a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a>(dof_handler, constraints);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;       <a class="code" href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a>(</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;         mapping, dof_handler, 0, ExactSolution&lt;dim&gt;(), constraints);</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;* </div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;       constraints.close();</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;     }</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;* </div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;     <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs());</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;     <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp, constraints, <span class="keyword">false</span>);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;* </div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;     sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;     system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;* </div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;     solution.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;     system_rhs.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;   }</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;* </div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;* </div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Assemblyofthesystemmatrixandrighthandside&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Assembly of the system <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and right hand side&lt;/h3&gt;   </div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;*   The <span class="keyword">function</span> that assembles the linear system is also well known from the previous tutorial programs. One thing to note is that we <span class="keyword">set</span> the number of quadrature points to the polynomial degree plus two, not the degree plus <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> as in most other tutorials. This is because we expect some extra accuracy as the mapping also involves a degree <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> more than the polynomials <span class="keywordflow">for</span> the solution.   </div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;*   The only somewhat unusual code in the assembly is the way we compute the cell <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>. Rather than <span class="keyword">using</span> three nested <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over the quadrature <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> index, the row, and the column of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, we <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> collect the derivatives of the shape <span class="keyword">function</span>, multiplied by the square root of the product of the coefficient and the integration factor `JxW` in a separate matrix `partial_matrix`. To compute the cell <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, we then execute `<a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a> = partial_matrix <a class="code" href="derivative__form_8h.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a>(partial_matrix)` in the line `partial_matrix.mTmult(cell_matrix, partial_matrix);`. To understand why <span class="keyword">this</span> works, we realize that the matrix-matrix multiplication performs a summation over the columns of `partial_matrix`. If we denote the coefficient by   @f$a(\mathbf{x}_q)@f$  , the entries in the temporary matrix are   @f$\sqrt{\text{det}(J) w_q a(x)} \frac{\partial \varphi_i(\boldsymbol</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; \xi_q)}{\partial x_k}@f$  . If we take the product of the &lt;i&gt;i&lt;/i&gt;th row with the &lt;i&gt;j&lt;/i&gt;th column of that <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, we compute a nested <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">sum</a> involving   @f$\sum_q \sum_{k=1}^d \sqrt{\text{det}(J) w_q a(x)} \frac{\partial</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; \varphi_i(\boldsymbol \xi_q)}{\partial x_k} \sqrt{\text{det}(J) w_q a(x)}</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; \frac{\partial \varphi_j(\boldsymbol \xi_q)}{\partial x_k} = \sum_q</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; \sum_{k=1}^d\text{det}(J) w_q a(x)\frac{\partial \varphi_i(\boldsymbol</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; \xi_q)}{\partial x_k} \frac{\partial \varphi_j(\boldsymbol</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160; \xi_q)}{\partial x_k}@f$  , which is exactly the terms needed <span class="keywordflow">for</span> the bilinear form of the Laplace equation.   </div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;*   The reason <span class="keywordflow">for</span> choosing <span class="keyword">this</span> somewhat unusual scheme is due to the heavy work involved in computing the cell matrix <span class="keywordflow">for</span> a relatively high polynomial degree in 3D. As we want to highlight the cost of the mapping in <span class="keyword">this</span> tutorial program, we better <span class="keywordflow">do</span> the assembly in an optimized way in order to not chase bottlenecks that have been solved by the community already. Matrix-matrix multiplication is <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> of the best optimized kernels in the HPC context, and the   <a class="code" href="classFullMatrix.html#ac074fc1dc416f8cd75bb01d820e74aa0">FullMatrix::mTmult</a>()   function will <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> into those optimized BLAS <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>. If the user has provided a good BLAS library when configuring deal.II (like OpenBLAS or Intel&#39;s MKL), the computation of the cell matrix will execute close to the processor&#39;s peak arithmetic performance. As a side note, we mention that despite an optimized matrix-matrix multiplication, the current strategy is sub-optimal in terms of complexity as the work to be done is proportional to   @f$(p+1)^9@f$   operations for degree   @f$p@f$   (this also applies to the usual evaluation with <a class="code" href="classFEValues.html">FEValues</a>). One could compute the cell matrix with   @f$\mathcal <a class="code" href="namespaceLAPACKSupport.html#ae4c4142bb80d7e6e5214c37fac73e1da">O</a>((p+1)^7)@f$   operations by utilizing the tensor product structure of the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, as is done by the matrix-<a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> framework in deal.II. We refer to   @ref step_37 &quot;step-37&quot;   and the documentation of the tensor-product-aware evaluators <a class="code" href="classFEEvaluation.html">FEEvaluation</a> for details on how an even more efficient cell matrix computation could be realized.</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;* </div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;* </div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;* @code</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;   <span class="keywordtype">void</span> PoissonProblem&lt;dim&gt;::assemble_system(const <a class="code" href="classMapping.html">Mapping</a>&lt;dim&gt; &amp;mapping)</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;   {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Assemble linear system&quot;</span>);</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;* </div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> quadrature_formula(fe.degree + 2);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a>     fe_values(mapping,</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                             fe,</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                             quadrature_formula,</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                               <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;* </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points    = quadrature_formula.size();</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;* </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     cell_rhs(dofs_per_cell);</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> partial_matrix(dofs_per_cell, dim n_q_points);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;     std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;* </div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;       {</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;         cell_rhs = 0.;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;         fe_values.reinit(cell);</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;* </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_index = 0; q_index &lt; n_q_points; ++q_index)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;           {</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">double</span> current_coefficient =</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;               coefficient(fe_values.quadrature_point(q_index));</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;               {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                 <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                   partial_matrix(i, q_index dim + <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) =</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                     <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(fe_values.JxW(q_index) current_coefficient)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                     fe_values.shape_grad(i, q_index)[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>];</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                 cell_rhs(i) +=</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                   (fe_values.shape_value(i, q_index) <span class="comment">// phi_i(x_q)</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                    (-dim)                            <span class="comment">// f(x_q)</span></div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                    fe_values.JxW(q_index));            <span class="comment">// dx</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;               }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;           }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;* </div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;         partial_matrix.mTmult(cell_matrix, partial_matrix);</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;* </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;         cell-&gt;get_dof_indices(local_dof_indices);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;         constraints.distribute_local_to_global(</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;           cell_matrix, cell_rhs, local_dof_indices, system_matrix, system_rhs);</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;       }</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   }</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;* </div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;* </div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;* </div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Solutionofthelinearsystem&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Solution of the linear system&lt;/h3&gt;   </div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;*   For solving the linear system, we pick a simple Jacobi-preconditioned conjugate <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a> solver, similar to the settings in the early tutorials.</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;* </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;* </div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;* @code</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;   <span class="keywordtype">void</span> PoissonProblem&lt;dim&gt;::solve()</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;   {</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;     <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Solve linear system&quot;</span>);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;* </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;     <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver(solver_control);</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;* </div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;     <a class="code" href="classPreconditionJacobi.html">PreconditionJacobi&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;     preconditioner.<a class="code" href="classPreconditionRelaxation.html#a73fb0eab08209d015a20797c19127588">initialize</a>(system_matrix);</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;* </div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     solver.solve(system_matrix, solution, system_rhs, preconditioner);</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;     constraints.distribute(solution);</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;* </div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of solver iterations:  &quot;</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;               &lt;&lt; solver_control.last_step() &lt;&lt; std::endl;</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;   }</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;* </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;* </div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;* </div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Outputofthesolutionandcomputationoferrors&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Output of the solution and computation of errors&lt;/h3&gt;   </div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;*   In the next <span class="keyword">function</span> we <span class="keywordflow">do</span> various post-processing steps with the solution, all of which involve the mapping in <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> way or the other.   </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;*   The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> operation we <span class="keywordflow">do</span> is to write the solution as well as the material ids to a VTU file. This is similar to what was done in many other tutorial programs. The <span class="keyword">new</span> ingredient presented in <span class="keyword">this</span> tutorial program is that we want to ensure that the data written to the file used <span class="keywordflow">for</span> visualization is actually a faithful representation of what is used internally by deal.II. That is because most of the visualization data formats only represent cells by their vertex coordinates, but have no way of representing the curved boundaries that are used in deal.II when <span class="keyword">using</span> higher order mappings</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;* </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;*  -  in other words, what you see in the visualization tool is not actually what you are computing on. (The same, incidentally, is <span class="keyword">true</span> when <span class="keyword">using</span> higher order shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>: Most visualization tools only render bilinear/trilinear representations. This is discussed in detail in   <a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a>().)     </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;*   So we need to ensure that a high-order representation is written to the file. We need to consider two particular topics. Firstly, we tell the <a class="code" href="classDataOut.html">DataOut</a> <span class="keywordtype">object</span> via the   <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a>   that we intend to interpret the subdivisions of the elements as a high-order Lagrange polynomial rather than a collection of bilinear patches. Recent visualization programs, like ParaView version 5.5 or newer, can then render a high-order solution (see a &lt;a</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; href=<span class="stringliteral">&quot;https://github.com/dealii/dealii/wiki/Notes-on-visualizing-high-order-output&quot;</span>&gt;wiki</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; page&lt;/a&gt; <span class="keywordflow">for</span> more details). Secondly, we need to make sure that the mapping is passed to the   <a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a>()   method. Finally, the <a class="code" href="classDataOut.html">DataOut</a> class only prints curved faces for &lt;i&gt;boundary&lt;/i&gt; cells by default, so we need to ensure that also inner cells are printed in a curved representation via the mapping.</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;* </div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;* </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;* @code</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="keywordtype">void</span> PoissonProblem&lt;dim&gt;::postprocess(const <a class="code" href="classMapping.html">Mapping</a>&lt;dim&gt; &amp;mapping)</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;     {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Write output&quot;</span>);</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;* </div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;       <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;* </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;       <a class="code" href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a> flags;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;       flags.<a class="code" href="structDataOutBase_1_1VtkFlags.html#aa9dd1830c0ff35a2431704c4d45453eb">write_higher_order_cells</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;       data_out.<a class="code" href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">set_flags</a>(flags);</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;* </div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;       data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(solution, <span class="stringliteral">&quot;solution&quot;</span>);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;* </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;       <a class="code" href="classVector.html">Vector&lt;double&gt;</a> material_ids(triangulation.n_active_cells());</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : triangulation.active_cell_iterators())</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;         material_ids[cell-&gt;active_cell_index()] = cell-&gt;material_id();</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;       data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(material_ids, <span class="stringliteral">&quot;material_ids&quot;</span>);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;* </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;       data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>(mapping,</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                              fe.degree,</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                              <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;::curved_inner_cells</a>);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;* </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;       std::ofstream file(</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         (<span class="stringliteral">&quot;solution-&quot;</span> +</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <a class="code" href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(triangulation.n_global_levels()</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;* </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;- 10 + 2 dim) +</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;          <span class="stringliteral">&quot;.vtu&quot;</span>)</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;           .c_str());</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;* </div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;       data_out.<a class="code" href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">write_vtu</a>(file);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;     }</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;* </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;* </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;*  The next operation in the postprocessing <span class="keyword">function</span> is to compute the   @f$L_2@f$   and   @f$H^1@f$   errors against the analytical solution. As the analytical solution is a quadratic polynomial, we expect a very accurate result at <span class="keyword">this</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>. If we were solving on a simple mesh with planar faces and a coefficient whose jumps are aligned with the faces between cells, then we would expect the numerical result to coincide with the analytical solution up to roundoff accuracy. However, since we are <span class="keyword">using</span> deformed cells following a sphere, which are only tracked by polynomials of degree 4 (<a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> more than the degree <span class="keywordflow">for</span> the finite elements), we will see that there is an error around   @f$10^{-7}@f$  . We could <span class="keyword">get</span> more accuracy by increasing the polynomial degree or refining the mesh.</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;* </div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;* </div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;* @code</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;     {</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Compute error norms&quot;</span>);</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;* </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;       <a class="code" href="classVector.html">Vector&lt;double&gt;</a> norm_per_cell_p(triangulation.n_active_cells());</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;* </div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;       <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(mapping,</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                         dof_handler,</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                                         solution,</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                         ExactSolution&lt;dim&gt;(),</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                         norm_per_cell_p,</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                                         <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 2),</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                                         <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa3903caf348e2d5dc54d1b49e15c1e8e">VectorTools::L2_norm</a>);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;       std::cout &lt;&lt; <span class="stringliteral">&quot;   L2 error vs exact solution:   &quot;</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                 &lt;&lt; norm_per_cell_p.l2_norm() &lt;&lt; std::endl;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;* </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;       <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>(mapping,</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                                         dof_handler,</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                         solution,</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                                         ExactSolution&lt;dim&gt;(),</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                                         norm_per_cell_p,</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                                         <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 2),</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                                         <a class="code" href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1a6a4df2311989608627aa7bff3898fd3c">VectorTools::H1_norm</a>);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;       std::cout &lt;&lt; <span class="stringliteral">&quot;   H1 error vs exact solution:   &quot;</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                 &lt;&lt; norm_per_cell_p.l2_norm() &lt;&lt; std::endl;</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;     }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;* </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;* </div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;*  The <span class="keyword">final</span> post-processing operation we <span class="keywordflow">do</span> here is to compute an error estimate with the <a class="code" href="classKellyErrorEstimator.html">KellyErrorEstimator</a>. We use the exact same settings as in the   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>   tutorial program, except <span class="keywordflow">for</span> the fact that we also hand in the mapping to ensure that errors are evaluated along the curved element, consistent with the remainder of the program. However, we <span class="keywordflow">do</span> not really use the result here to drive a mesh adaptation step (that would <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh around the material interface along the sphere), as the focus here is on the cost of <span class="keyword">this</span> operation.</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;* </div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;* </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;* @code</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;     {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;       <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Compute error estimator&quot;</span>);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;* </div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       <a class="code" href="classVector.html">Vector&lt;float&gt;</a> estimated_error_per_cell(triangulation.n_active_cells());</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;       <a class="code" href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator&lt;dim&gt;::estimate</a>(</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;         mapping,</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;         dof_handler,</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;         <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;* </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;- 1&gt;(fe.degree + 1),</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;         std::map&lt;<a class="code" href="classunsigned_01int.html">types::boundary_id</a>, <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt;(),</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         solution,</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;         estimated_error_per_cell);</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;       std::cout &lt;&lt; <span class="stringliteral">&quot;   Max cell-wise error estimate: &quot;</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                 &lt;&lt; estimated_error_per_cell.linfty_norm() &lt;&lt; std::endl;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;     }</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;   }</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;* </div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;* </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;* </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ThePoissonProblemrunfunction&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">PoissonProblem::run</a>() function&lt;/h3&gt;   </div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;*   Finally, we define the `<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>()` function that controls how we want to execute this program (which is called by the main() function in the usual way). We start by calling the `create_grid()` function that sets up our geometry with the appropriate manifolds. We then <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> two instances of a solver chain, starting from the setup of the equations, the assembly of the linear system, its solution with a simple iterative solver, and the postprocessing discussed above. The two instances differ in the way they use the mapping. The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> uses a conventional <a class="code" href="classMappingQGeneric.html">MappingQGeneric</a> mapping <span class="keywordtype">object</span> which we initialize to a degree <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> more than we use for the finite element &amp;ndash; after all, we expect the geometry representation to be the bottleneck as the analytic solution is only a quadratic polynomial. (In reality, things are interlinked to quite some extent because the evaluation of the polynomials in real coordinates involves the mapping of a higher-degree polynomials, which represent some smooth rational functions. As a consequence, higher-degree polynomials still pay off, so it does not make sense to increase the degree of the mapping further.) Once the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> pass is completed, we let the timer print a summary of the compute times of the individual stages.</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;* </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;* </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;* @code</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   <span class="keywordtype">void</span> PoissonProblem&lt;dim&gt;::<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>()</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;   {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;     create_grid();</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;* </div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;     {</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;       std::cout &lt;&lt; std::endl</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;====== Running with the basic MappingQGeneric class ====== &quot;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;* </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;       <a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a> mapping(fe.degree + 1);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;       setup_system(mapping);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;       assemble_system(mapping);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;       solve();</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;       postprocess(mapping);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;* </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;       timer.print_summary();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;       timer.reset();</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;     }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;* </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;* </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;*  For the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> instance, we instead <span class="keyword">set</span> up the <a class="code" href="classMappingQCache.html">MappingQCache</a> <span class="keyword">class</span>. Its use is very simple: After constructing it (with the degree, given that we want it to show the correct degree functionality in other contexts), we fill the cache via the   <a class="code" href="classMappingQCache.html#ab7c3ac515088ee08df64075954629314">MappingQCache::initialize</a>()   function. At this stage, we specify which mapping we want to use (obviously, the same <a class="code" href="classMappingQGeneric.html">MappingQGeneric</a> as previously in order to repeat the same computations) for the cache, and then run through the same functions again, now handing in the modified mapping. In the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a>, we again print the accumulated wall times since the reset to see how the times compare to the original setting.</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;* </div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;* </div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;* @code</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;     {</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;       std::cout</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;====== Running with the optimized MappingQCache class ====== &quot;</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;         &lt;&lt; std::endl</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;         &lt;&lt; std::endl;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;* </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;       <a class="code" href="classMappingQCache.html">MappingQCache&lt;dim&gt;</a> mapping(fe.degree + 1);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;       {</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;         <a class="code" href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a> scope(timer, <span class="stringliteral">&quot;Initialize mapping cache&quot;</span>);</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;         mapping.initialize(<a class="code" href="classMappingQGeneric.html">MappingQGeneric&lt;dim&gt;</a>(fe.degree + 1), triangulation);</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;       }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;       std::cout &lt;&lt; <span class="stringliteral">&quot;   Memory consumption cache:     &quot;</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                 &lt;&lt; 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-6 mapping.memory_consumption() &lt;&lt; <span class="stringliteral">&quot; MB&quot;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;* </div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;       setup_system(mapping);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;       assemble_system(mapping);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;       solve();</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;       postprocess(mapping);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;* </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;       timer.print_summary();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     }</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;   }</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; } <span class="comment">// namespace Step65</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;* </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;* </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; <span class="keywordtype">int</span> main()</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160; {</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;   Step65::PoissonProblem&lt;3&gt; test_program;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;   test_program.run();</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160; }</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;* </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;* </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Programoutput&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Program output&lt;/h3&gt;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;* </div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;* If we run the three-dimensional version of <span class="keyword">this</span> program with polynomials ofdegree three, we <span class="keyword">get</span> the following program output:</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;* @code</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;&gt; make run</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;Scanning dependencies of target step-65</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;[ 33%] Building CXX <span class="keywordtype">object</span> CMakeFiles/step-65.dir/step-65.cc.o</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;[ 66%] Linking CXX executable step-65</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;[ 66%] Built target step-65</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;[100%] Run step-65 with Release configuration</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;* </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;====== Running with the basic <a class="code" href="classMappingQGeneric.html">MappingQGeneric</a> <span class="keyword">class </span>======</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;* </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   Number of active cells:       6656</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   Number of degrees of freedom: 181609</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   Number of solver iterations:  285</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a> error vs exact solution:   8.99339e-08</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   H1 error vs exact solution:   6.45341e-06</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   Max cell-wise error estimate: 0.00743406</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;* </div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;* </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;+---------------------------------------------+------------+------------+</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;| Total wallclock time elapsed since start    |      49.4s |            |</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;|                                             |            |            |</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;| Section                         | no. calls |  wall time | % of total |</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;+---------------------------------+-----------+------------+------------+</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;| Assemble linear system          |         1 |       5.8s |        12% |</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;| Compute constraints             |         1 |     0.109s |      0.22% |</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;| Compute error estimator         |         1 |      16.5s |        33% |</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;| Compute error norms             |         1 |      9.11s |        18% |</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;| Solve linear system             |         1 |      9.92s |        20% |</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;| Write output                    |         1 |      4.85s |       9.8% |</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;+---------------------------------+-----------+------------+------------+</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;* </div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;====== Running with the optimized <a class="code" href="classMappingQCache.html">MappingQCache</a> <span class="keyword">class </span>======</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;* </div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;   Memory consumption cache:     22.9981 MB</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;   Number of active cells:       6656</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;   Number of degrees of freedom: 181609</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   Number of solver iterations:  285</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;   <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">L2</a> error vs exact solution:   8.99339e-08</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;   H1 error vs exact solution:   6.45341e-06</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;   Max cell-wise error estimate: 0.00743406</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;* </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;* </div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;+---------------------------------------------+------------+------------+</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;| Total wallclock time elapsed since start    |      18.4s |            |</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;|                                             |            |            |</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;| Section                         | no. calls |  wall time | % of total |</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;+---------------------------------+-----------+------------+------------+</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;| Assemble linear system          |         1 |      1.44s |       7.8% |</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;| Compute constraints             |         1 |   0.00336s |         0% |</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;| Compute error estimator         |         1 |     0.476s |       2.6% |</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;| Compute error norms             |         1 |     0.505s |       2.7% |</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;| Initialize mapping cache        |         1 |      4.96s |        27% |</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;| Solve linear system             |         1 |      9.95s |        54% |</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;| Write output                    |         1 |     0.875s |       4.8% |</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;+---------------------------------+-----------+------------+------------+</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;* </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;[100%] Built target run</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;* </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;* Before discussing the timings, we look at the memory consumption <span class="keywordflow">for</span> theMappingQCache object: Our program prints that it utilizes 23 MB ofmemory. If we relate <span class="keyword">this</span> number to the memory consumption of a single(solution or right hand side) vector,which is 1.5 MB (namely, 181,609 elements times 8 bytes per entry indouble precision), or to the memory consumed by thesystem matrix and the sparsity pattern (which is 274 MB), we realize that it isnot an overly heavy data structure, given its benefits.</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;* With respect to the timers, we see a clear improvement in the overall run timeof the program by a factor of 2.7. If we disregard the iterative solver, whichis the same in both cases (and not optimal, given the simple preconditioner weuse, and the fact that sparse matrix-vector products waste operations forcubic polynomials), the advantage is a factor of almost 5. This is prettyimpressive <span class="keywordflow">for</span> a linear stationary problem, and cost savings would indeed bemuch more prominent <span class="keywordflow">for</span> time-dependent and nonlinear problems where assemblyis called several times. If we look into the individual components, we <span class="keyword">get</span> aclearer picture of what is going on and why the cache is so efficient: In theMappingQGeneric <span class="keywordflow">case</span>, essentially every operation that involves a mapping takeat least 5 seconds to run. The <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> computation runs two  <a class="code" href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a>()   functions, which each take almost 5seconds. (The computation of constraints is cheaper because it only evaluatesthe mapping in cells at the boundary for the interpolation of boundaryconditions.) If we compare these 5 seconds to the time it takes to fill theMappingQCache, which is 5.2 seconds (for all cells, not just the active ones),it becomes obvious that the computation of the mapping support pointsdominates over everything else in the <a class="code" href="classMappingQGeneric.html">MappingQGeneric</a> case. Perhaps the moststriking result is the time for the error estimator, labeled &quot;Compute errorestimator&quot;, where the <a class="code" href="classMappingQGeneric.html">MappingQGeneric</a> implementation takes 17.3 seconds andthe <a class="code" href="classMappingQCache.html">MappingQCache</a> variant less than 0.5 seconds. The reason why the former isso expensive (three times more expensive than the assembly, for instance) isthat the error estimation involves evaluation of quantities over faces, whereeach face in the mesh requests additional points of the mapping that in turngo through the very expensive <a class="code" href="classTransfiniteInterpolationManifold.html">TransfiniteInterpolationManifold</a> class. As thereare six faces per cell, this happens much more often than in assembly. Again,<a class="code" href="classMappingQCache.html">MappingQCache</a> nicely eliminates the repeated evaluation, aggregating all theexpensive steps involving the manifold in a single initialization <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> thatgets repeatedly used.</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;* </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-65.cc&quot;  </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;*</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;*/</div><div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="classunsigned_01int_html"><div class="ttname"><a href="classunsigned_01int.html">unsigned int</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="structDataOutBase_1_1VtkFlags_html"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html">DataOutBase::VtkFlags</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l00871">data_out_base.h:871</a></div></div>
<div class="ttc" id="classFunction_html"><div class="ttname"><a href="classFunction.html">Function&lt; dim &gt;</a></div></div>
<div class="ttc" id="classTransfiniteInterpolationManifold_html"><div class="ttname"><a href="classTransfiniteInterpolationManifold.html">TransfiniteInterpolationManifold</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2manifold__lib_8h_source.html#l00815">manifold_lib.h:815</a></div></div>
<div class="ttc" id="classDataOutInterface_html_ac7280a24690b117454acfb0fa058299c"><div class="ttname"><a href="classDataOutInterface.html#ac7280a24690b117454acfb0fa058299c">DataOutInterface::set_flags</a></div><div class="ttdeci">void set_flags(const FlagType &amp;flags)</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l08210">data_out_base.cc:8210</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="classDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00296">dynamic_sparsity_pattern.h:296</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="classAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints&lt; double &gt;</a></div></div>
<div class="ttc" id="classDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Divergence_html_a8bcfc37d2a2be8faa18628a601ecf112"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">LocalIntegrators::Divergence::norm</a></div><div class="ttdeci">double norm(const FEValuesBase&lt; dim &gt; &amp;fe, const ArrayView&lt; const std::vector&lt; Tensor&lt; 1, dim &gt;&gt;&gt; &amp;Du)</div><div class="ttdef"><b>Definition:</b> <a href="divergence_8h_source.html#l00462">divergence.h:462</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="namespaceVectorTools_html_a69967cb7a148a7169963126249213db1aa3903caf348e2d5dc54d1b49e15c1e8e"><div class="ttname"><a href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1aa3903caf348e2d5dc54d1b49e15c1e8e">VectorTools::L2_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__common_8h_source.html#l00088">vector_tools_common.h:88</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Advection_html_a8bc7b8136646134f73a4193adefe15f8"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">LocalIntegrators::Advection::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="advection_8h_source.html#l00063">advection.h:63</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_ad85de345ccd86a53e63746709c8e1dfc"><div class="ttname"><a href="namespaceGridGenerator.html#ad85de345ccd86a53e63746709c8e1dfc">GridGenerator::hyper_shell</a></div><div class="ttdeci">void hyper_shell(Triangulation&lt; dim &gt; &amp;tria, const Point&lt; dim &gt; &amp;center, const double inner_radius, const double outer_radius, const unsigned int n_cells=0, bool colorize=false)</div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_ae4c4142bb80d7e6e5214c37fac73e1da"><div class="ttname"><a href="namespaceLAPACKSupport.html#ae4c4142bb80d7e6e5214c37fac73e1da">LAPACKSupport::O</a></div><div class="ttdeci">static const char O</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00168">lapack_support.h:168</a></div></div>
<div class="ttc" id="classFullMatrix_html_ac074fc1dc416f8cd75bb01d820e74aa0"><div class="ttname"><a href="classFullMatrix.html#ac074fc1dc416f8cd75bb01d820e74aa0">FullMatrix::mTmult</a></div><div class="ttdeci">void mTmult(FullMatrix&lt; number2 &gt; &amp;C, const FullMatrix&lt; number2 &gt; &amp;B, const bool adding=false) const</div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="classTransfiniteInterpolationManifold_html_a34326a35d9ec4b6911d90c85c21847d8"><div class="ttname"><a href="classTransfiniteInterpolationManifold.html#a34326a35d9ec4b6911d90c85c21847d8">TransfiniteInterpolationManifold::initialize</a></div><div class="ttdeci">void initialize(const Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2manifold__lib_8cc_source.html#l01676">manifold_lib.cc:1676</a></div></div>
<div class="ttc" id="classPreconditionJacobi_html"><div class="ttname"><a href="classPreconditionJacobi.html">PreconditionJacobi</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00513">precondition.h:513</a></div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="classMappingQCache_html_ab7c3ac515088ee08df64075954629314"><div class="ttname"><a href="classMappingQCache.html#ab7c3ac515088ee08df64075954629314">MappingQCache::initialize</a></div><div class="ttdeci">void initialize(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__cache_8cc_source.html#l00091">mapping_q_cache.cc:91</a></div></div>
<div class="ttc" id="classSparsityPattern_html"><div class="ttname"><a href="classSparsityPattern.html">SparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="sparsity__pattern_8h_source.html#l00762">sparsity_pattern.h:762</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="classManifold_html"><div class="ttname"><a href="classManifold.html">Manifold</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2grid_2manifold_8h_source.html#l00197">manifold.h:197</a></div></div>
<div class="ttc" id="classFE__Q_html"><div class="ttname"><a href="classFE__Q.html">FE_Q</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__q_8h_source.html#l00554">fe_q.h:554</a></div></div>
<div class="ttc" id="classMappingQGeneric_html"><div class="ttname"><a href="classMappingQGeneric.html">MappingQGeneric</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__generic_8h_source.html#l00084">mapping_q_generic.h:84</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html"><div class="ttname"><a href="classKellyErrorEstimator.html">KellyErrorEstimator</a></div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00131">error_estimator.h:131</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="classMapping_html"><div class="ttname"><a href="classMapping.html">Mapping&lt; dim &gt;</a></div></div>
<div class="ttc" id="derivative__form_8h_html_a3c201452e8dd28e4f5be4a316cb9305f"><div class="ttname"><a href="derivative__form_8h.html#a3c201452e8dd28e4f5be4a316cb9305f">transpose</a></div><div class="ttdeci">DerivativeForm&lt; 1, spacedim, dim, Number &gt; transpose(const DerivativeForm&lt; 1, dim, spacedim, Number &gt; &amp;DF)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__form_8h_source.html#l00543">derivative_form.h:543</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">internal::EvaluatorQuantity::gradient</a></div></div>
<div class="ttc" id="classSparseMatrix_html"><div class="ttname"><a href="classSparseMatrix.html">SparseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse__matrix_8h_source.html#l00479">sparse_matrix.h:479</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="namespacePatterns_1_1Tools_html_a72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="patterns_8h_source.html#l02231">patterns.h:2231</a></div></div>
<div class="ttc" id="data__out__base_8cc_html_accc45da40beb7ae1b485306984e904a2"><div class="ttname"><a href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a></div><div class="ttdeci">Point&lt; 3 &gt; vertices[4]</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00175">data_out_base.cc:175</a></div></div>
<div class="ttc" id="namespaceinternal_1_1SymmetricTensorAccessors_html_a3080af8704b3a9882a6fab3eecc63568"><div class="ttname"><a href="namespaceinternal_1_1SymmetricTensorAccessors.html#a3080af8704b3a9882a6fab3eecc63568">internal::SymmetricTensorAccessors::merge</a></div><div class="ttdeci">constexpr TableIndices&lt; 2 &gt; merge(const TableIndices&lt; 2 &gt; &amp;previous_indices, const unsigned int new_index, const unsigned int position)</div><div class="ttdef"><b>Definition:</b> <a href="symmetric__tensor_8h_source.html#l00145">symmetric_tensor.h:145</a></div></div>
<div class="ttc" id="classTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00902">data_out_dof_data.h:902</a></div></div>
<div class="ttc" id="classPreconditionRelaxation_html_a73fb0eab08209d015a20797c19127588"><div class="ttname"><a href="classPreconditionRelaxation.html#a73fb0eab08209d015a20797c19127588">PreconditionRelaxation::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const AdditionalData &amp;parameters=AdditionalData())</div></div>
<div class="ttc" id="classTensor_html_a7a3169a68a27cc04f2ad1fd9790b874c"><div class="ttname"><a href="classTensor.html#a7a3169a68a27cc04f2ad1fd9790b874c">Tensor::norm_square</a></div><div class="ttdeci">constexpr numbers::NumberTraits&lt; Number &gt;::real_type norm_square() const</div></div>
<div class="ttc" id="namespaceVectorTools_html"><div class="ttname"><a href="namespaceVectorTools.html">VectorTools</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools_8h_source.html#l00149">vector_tools.h:149</a></div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00092">data_out.h:92</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="classKellyErrorEstimator_html_ae2269e1c9903e9d863b7abd54948af00"><div class="ttname"><a href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator::estimate</a></div><div class="ttdeci">static void estimate(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim - 1 &gt; &amp;quadrature, const std::map&lt; types::boundary_id, const Function&lt; spacedim, typename InputVector::value_type &gt; *&gt; &amp;neumann_bc, const InputVector &amp;solution, Vector&lt; float &gt; &amp;error, const ComponentMask &amp;component_mask=ComponentMask(), const Function&lt; spacedim &gt; *coefficients=nullptr, const unsigned int n_threads=numbers::invalid_unsigned_int, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id, const types::material_id material_id=numbers::invalid_material_id, const Strategy strategy=cell_diameter_over_24)</div></div>
<div class="ttc" id="namespaceGridGenerator_html_a7cd88e7eacd46697dee80ad2b8438d54"><div class="ttname"><a href="namespaceGridGenerator.html#a7cd88e7eacd46697dee80ad2b8438d54">GridGenerator::merge_triangulations</a></div><div class="ttdeci">void merge_triangulations(const Triangulation&lt; dim, spacedim &gt; &amp;triangulation_1, const Triangulation&lt; dim, spacedim &gt; &amp;triangulation_2, Triangulation&lt; dim, spacedim &gt; &amp;result, const double duplicated_vertex_tolerance=1.0e-12, const bool copy_manifold_ids=false)</div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="classMappingQCache_html"><div class="ttname"><a href="classMappingQCache.html">MappingQCache</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q__cache_8h_source.html#l00053">mapping_q_cache.h:53</a></div></div>
<div class="ttc" id="classTimerOutput_html"><div class="ttname"><a href="classTimerOutput.html">TimerOutput</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00512">timer.h:512</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_af27ac28c698a9ed0199faed50a204538"><div class="ttname"><a href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a></div><div class="ttdeci">void interpolate_boundary_values(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::map&lt; types::boundary_id, const Function&lt; spacedim, number &gt; *&gt; &amp;function_map, std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
<div class="ttc" id="namespaceGridGenerator_html"><div class="ttname"><a href="namespaceGridGenerator.html">GridGenerator</a></div><div class="ttdef"><b>Definition:</b> <a href="grid__generator_8h_source.html#l00047">grid_generator.h:47</a></div></div>
<div class="ttc" id="classTensor_html"><div class="ttname"><a href="classTensor.html">Tensor&lt; 1, dim &gt;</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="namespacenumbers_html"><div class="ttname"><a href="namespacenumbers.html">numbers</a></div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00187">numbers.h:187</a></div></div>
<div class="ttc" id="group__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00039">fe.h:39</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_a533c4778cbc9bcbed365dcab42ca4418"><div class="ttname"><a href="namespaceGridGenerator.html#a533c4778cbc9bcbed365dcab42ca4418">GridGenerator::hyper_ball</a></div><div class="ttdeci">void hyper_ball(Triangulation&lt; dim &gt; &amp;tria, const Point&lt; dim &gt; &amp;center=Point&lt; dim &gt;(), const double radius=1., const bool attach_spherical_manifold_on_boundary_cells=false)</div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1CUDA_html_afc505a095cc4c7600f65ecb99851312e"><div class="ttname"><a href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">Utilities::CUDA::free</a></div><div class="ttdeci">void free(T *&amp;pointer)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2cuda_8h_source.html#l00107">cuda.h:107</a></div></div>
<div class="ttc" id="structDataOutBase_1_1VtkFlags_html_aa9dd1830c0ff35a2431704c4d45453eb"><div class="ttname"><a href="structDataOutBase_1_1VtkFlags.html#aa9dd1830c0ff35a2431704c4d45453eb">DataOutBase::VtkFlags::write_higher_order_cells</a></div><div class="ttdeci">bool write_higher_order_cells</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l00944">data_out_base.h:944</a></div></div>
<div class="ttc" id="classDataOutInterface_html_a93c780f93105e0daaa76c6c43694b4ae"><div class="ttname"><a href="classDataOutInterface.html#a93c780f93105e0daaa76c6c43694b4ae">DataOutInterface::write_vtu</a></div><div class="ttdeci">void write_vtu(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07232">data_out_base.cc:7232</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_a676190d2c897ac5da68a9c460fa95832"><div class="ttname"><a href="namespaceVectorTools.html#a676190d2c897ac5da68a9c460fa95832">VectorTools::integrate_difference</a></div><div class="ttdeci">void integrate_difference(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const InVector &amp;fe_function, const Function&lt; spacedim, typename InVector::value_type &gt; &amp;exact_solution, OutVector &amp;difference, const Quadrature&lt; dim &gt; &amp;q, const NormType &amp;norm, const Function&lt; spacedim, double &gt; *weight=nullptr, const double exponent=2.)</div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1L2_html_a0a7d7409a5f53485a841a33fda68d916"><div class="ttname"><a href="namespaceLocalIntegrators_1_1L2.html#a0a7d7409a5f53485a841a33fda68d916">LocalIntegrators::L2::L2</a></div><div class="ttdeci">void L2(Vector&lt; number &gt; &amp;result, const FEValuesBase&lt; dim &gt; &amp;fe, const std::vector&lt; double &gt; &amp;input, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="l2_8h_source.html#l00153">l2.h:153</a></div></div>
<div class="ttc" id="classTimerOutput_1_1Scope_html"><div class="ttname"><a href="classTimerOutput_1_1Scope.html">TimerOutput::Scope</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00519">timer.h:519</a></div></div>
<div class="ttc" id="classSphericalManifold_html"><div class="ttname"><a href="classSphericalManifold.html">SphericalManifold</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2manifold__lib_8h_source.html#l00165">manifold_lib.h:165</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a1cf30058b31ce7f9b389e8310bb9fc54"><div class="ttname"><a href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">GridRefinement::refine</a></div><div class="ttdeci">void refine(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold, const unsigned int max_to_mark=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00168">grid_refinement.cc:168</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="group__constraints_html_ga3b4ea7dfd313e388d868c4e4aa685799"><div class="ttname"><a href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a></div><div class="ttdeci">void make_hanging_node_constraints(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, AffineConstraints&lt; number &gt; &amp;constraints)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__constraints_8cc_source.html#l01787">dof_tools_constraints.cc:1787</a></div></div>
<div class="ttc" id="vectorization_8h_html_a303f564e3c189251976da401ee2e44fa"><div class="ttname"><a href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05442">vectorization.h:5442</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_a69967cb7a148a7169963126249213db1a6a4df2311989608627aa7bff3898fd3c"><div class="ttname"><a href="namespaceVectorTools.html#a69967cb7a148a7169963126249213db1a6a4df2311989608627aa7bff3898fd3c">VectorTools::H1_norm</a></div><div class="ttdef"><b>Definition:</b> <a href="vector__tools__common_8h_source.html#l00148">vector_tools_common.h:148</a></div></div>
<div class="ttc" id="classFEEvaluation_html"><div class="ttname"><a href="classFEEvaluation.html">FEEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00071">fe_evaluation.h:71</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
