<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-24_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-24.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-24.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-24_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;  = 0) <span class="keyword">const</span> <span class="keyword">override</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;     {</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;       <span class="keyword">static</span> <span class="keyword">const</span> std::array&lt;Source, 5&gt; sources{</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;         {Source(<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(0, 0), 0.025),</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          Source(<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(-0.135, 0), 0.05),</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;          Source(<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(0.17, 0), 0.03),</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          Source(<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(-0.25, 0), 0.02),</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;          Source(<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>(-0.05,</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;* </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;-0.15), 0.015)}};</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;* </div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;source : sources)</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;         <span class="keywordflow">if</span> (p.distance(source.location) &lt; source.radius)</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;           <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;* </div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;       <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;     }</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;* </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;     <span class="keyword">struct </span>Source</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;     {</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;       Source(<span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> &amp;<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> r)</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;         : location(l)</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;         , radius(r)</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;       {}</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;* </div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;       <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> location;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;       <span class="keyword">const</span> <span class="keywordtype">double</span>     radius;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;     };</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;   };</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;* </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;* </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ImplementationofthecodeTATForwardProblemcodeclass&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Implementation of the &lt;code&gt;TATForwardProblem&lt;/code&gt; <span class="keyword">class</span>&lt;/h3&gt;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;* </div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;* </div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;*  Let<span class="stringliteral">&#39;s start again with the constructor. Setting the member variables is straightforward. We use the acoustic wave speed of mineral oil (in millimeters per microsecond, a common unit in experimental biomedical imaging) since this is where many of the experiments we want to compare the output with are made in. The Crank-Nicolson scheme is used again, i.e. theta is set to 0.5. The time step is later selected to satisfy   @f$k =</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="stringliteral"> \frac hc@f$  : here we initialize it to an invalid number.</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;<span class="stringliteral">   TATForwardProblem&lt;dim&gt;::TATForwardProblem()</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;<span class="stringliteral">     : fe(1)</span></div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;<span class="stringliteral">     , dof_handler(triangulation)</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;<span class="stringliteral">     , time_step(std::numeric_limits&lt;double&gt;::quiet_NaN())</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="stringliteral">     , time(time_step)</span></div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;<span class="stringliteral">     , timestep_number(1)</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="stringliteral">     , theta(0.5)</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;<span class="stringliteral">     , wave_speed(1.437)</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="stringliteral">*  The second task in the constructor is to initialize the array that holds the detector locations. The results of this program were compared with experiments in which the step size of the detector spacing is 2.25 degree, corresponding to 160 detector locations. The radius of the scanning circle is selected to be half way between the center and the boundary to avoid that the remaining reflections from the imperfect boundary condition spoils our numerical results.     </span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;<span class="stringliteral">*   The locations of the detectors are then calculated in clockwise order. Note that the following of course only works if we are computing in 2d, a condition that we guard with an assertion. If we later wanted to run the same program in 3d, we would have to add code here for the initialization of detector locations in 3d. Due to the assertion, there is no way we can forget to do this.</span></div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;<span class="stringliteral">     Assert(dim == 2, ExcNotImplemented());</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;<span class="stringliteral">     const double detector_step_angle = 2.25;</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;<span class="stringliteral">     const double detector_radius     = 0.5;</span></div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;<span class="stringliteral">     for (double detector_angle = 2 numbers::PI; detector_angle &gt;= 0;</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;<span class="stringliteral">          detector_angle</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;<span class="stringliteral">-= detector_step_angle / 360 2 numbers::PI)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="stringliteral">       detector_locations.push_back(</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;<span class="stringliteral">         Point&lt;dim&gt;(std::cos(detector_angle), std::sin(detector_angle))</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="stringliteral">         detector_radius);</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;TATForwardProblemsetup_system&quot;&gt;&lt;/a&gt;  &lt;h4&gt;TATForwardProblem::setup_system&lt;/h4&gt;</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="stringliteral">*  The following system is pretty much what we&#39;</span>ve already done in   @ref step_23 <span class="stringliteral">&quot;step-23&quot;</span>  , but with two important differences. First, we have to create a circular (or spherical) mesh around the origin, with a radius of 1. This <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">nothing</a> <span class="keyword">new</span>: we<span class="stringliteral">&#39;ve done so before in   @ref step_6 &quot;step-6&quot;   and   @ref step_10 &quot;step-10&quot;  , where we also explain how the PolarManifold or SphericalManifold object places new points on concentric circles when a cell is refined, which we will use here as well.   </span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="stringliteral">*   One thing we had to make sure is that the time step satisfies the CFL condition discussed in the introduction of   @ref step_23 &quot;step-23&quot;  . Back in that program, we ensured this by hand by setting a timestep that matches the mesh width, but that was error prone because if we refined the mesh once more we would also have to make sure the time step is changed. Here, we do that automatically: we ask a library function for the minimal diameter of any cell. Then we set   @f$k=\frac h{c_0}@f$  . The only problem is: what exactly is   @f$h@f$  ? The point is that there is really no good theory on this question for the wave equation. It is known that for uniformly refined meshes consisting of rectangles,   @f$h@f$   is the minimal edge length. But for meshes on general quadrilaterals, the exact relationship appears to be unknown, i.e. it is unknown what properties of cells are relevant for the CFL condition. The problem is that the CFL condition follows from knowledge of the smallest eigenvalue of the Laplace matrix, and that can only be computed analytically for simply structured meshes.   </span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="stringliteral">*   The upshot of all this is that we&#39;</span>re not quite sure what exactly we should take <span class="keywordflow">for</span>   @f$h@f$  . The <span class="keyword">function</span>   <a class="code" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a>   computes the minimal <a class="code" href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">diameter</a> of all cells. If the cells were all squares or cubes, then the minimal edge length would be the minimal <a class="code" href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">diameter</a> divided by   &lt;code&gt;<a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(dim)&lt;/code&gt;  . We simply generalize <span class="keyword">this</span>, without theoretical justification, to the <span class="keywordflow">case</span> of non-uniform meshes.   </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;*   The only other significant change is that we need to build the boundary mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>. We will comment on <span class="keyword">this</span> further down below.</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;* </div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;* </div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;* @code</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;   <span class="keywordtype">void</span> TATForwardProblem&lt;dim&gt;::setup_system()</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;   {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;     <span class="keyword">const</span> <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> <a class="code" href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a>;</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;     <a class="code" href="namespaceGridGenerator.html#a533c4778cbc9bcbed365dcab42ca4418">GridGenerator::hyper_ball</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, center, 1.);</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(7);</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;* </div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;     time_step = <a class="code" href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>) / wave_speed /</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                 <a class="code" href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a>(1. dim);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;* </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Number of active cells: &quot;</span> &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells()</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;* </div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;     dof_handler.distribute_dofs(fe);</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;* </div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     std::cout &lt;&lt; <span class="stringliteral">&quot;Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;               &lt;&lt; std::endl</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;               &lt;&lt; std::endl;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;* </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;     <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(), dof_handler.n_dofs());</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;     <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;     sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;* </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;     system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;     <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.reinit(sparsity_pattern);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;     laplace_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;* </div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;     <a class="code" href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">MatrixCreator::create_mass_matrix</a>(dof_handler,</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                                       <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                                       <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;     <a class="code" href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a>(dof_handler,</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                          <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                                          laplace_matrix);</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;* </div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;* </div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;*  The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> difference, as mentioned, to   @ref step_23 <span class="stringliteral">&quot;step-23&quot;</span>   is that we need to build the boundary mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> that grew out of the absorbing boundary conditions.     </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;*   <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> observation would be that <span class="keyword">this</span> <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> is much sparser than the regular mass <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, since <a class="code" href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1aa6f1f99c613aeb81b8d8e598b5567ce1">none</a> of the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> with purely interior support contribute to <span class="keyword">this</span> matrix. We could therefore optimize the storage pattern to <span class="keyword">this</span> situation and build up a <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> sparsity pattern that only contains the <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> entries that we need. There is a trade-off to make here: <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a>, we would have to have a <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> sparsity pattern object, so that costs memory. Secondly, the matrix attached to <span class="keyword">this</span> sparsity pattern is going to be smaller and therefore requires less memory; it would also be faster to perform matrix-vector multiplications with it. The <span class="keyword">final</span> argument, however, is the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> that tips the <a class="code" href="namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">scale</a>: we are not primarily interested in performing matrix-vector with the boundary matrix alone (though we need to <span class="keywordflow">do</span> that <span class="keywordflow">for</span> the right hand side vector once per time step), but mostly wish to add it up to the other matrices used in the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> of the two equations since <span class="keyword">this</span> is the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> that is going to be multiplied with once per iteration of the CG method, i.e. significantly more often. It is now the <span class="keywordflow">case</span> that the   <a class="code" href="classSparseMatrix.html#acabf7629046afdd9077f77f7746a7a3f">SparseMatrix::add</a>   <span class="keyword">class </span>allows to add <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> matrix to another, but only if they use the same sparsity pattern (the reason being that we can&#39;t add <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> entries to a matrix after the sparsity pattern has been created, so we simply require that the two matrices have the same sparsity pattern).     </div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;*   So let<span class="stringliteral">&#39;s go with that:</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;<span class="stringliteral">     boundary_matrix.reinit(sparsity_pattern);</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;<span class="stringliteral">*  The second thing to do is to actually build the matrix. Here, we need to integrate over faces of cells, so first we need a quadrature object that works on   &lt;code&gt;dim-1&lt;/code&gt;   dimensional objects. Secondly, the FEFaceValues variant of FEValues that works on faces, as its name suggest. And finally, the other variables that are part of the assembly machinery. All of this we put between curly braces to limit the scope of these variables to where we actually need them.     </span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="stringliteral">*   The actual act of assembling the matrix is then fairly straightforward: we loop over all cells, over all faces of each of these cells, and then do something only if that particular face is at the boundary of the domain. Like this:</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="stringliteral">       const QGauss&lt;dim</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="stringliteral">- 1&gt; quadrature_formula(fe.degree + 1);</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="stringliteral">       FEFaceValues&lt;dim&gt;     fe_values(fe,</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="stringliteral">                                   quadrature_formula,</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="stringliteral">                                   update_values | update_JxW_values);</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="stringliteral">       const unsigned int dofs_per_cell = fe.n_dofs_per_cell();</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="stringliteral">       const unsigned int n_q_points    = quadrature_formula.size();</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="stringliteral">       FullMatrix&lt;double&gt; cell_matrix(dofs_per_cell, dofs_per_cell);</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="stringliteral">       std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="stringliteral">       for (const auto &amp;cell : dof_handler.active_cell_iterators())</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;<span class="stringliteral">         for (const auto &amp;face : cell-&gt;face_iterators())</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;<span class="stringliteral">           if (face-&gt;at_boundary())</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="stringliteral">             {</span></div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="stringliteral">               cell_matrix = 0;</span></div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;<span class="stringliteral">               fe_values.reinit(cell, face);</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;<span class="stringliteral">               for (unsigned int q_point = 0; q_point &lt; n_q_points; ++q_point)</span></div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="stringliteral">                 for (unsigned int i = 0; i &lt; dofs_per_cell; ++i)</span></div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;<span class="stringliteral">                   for (unsigned int j = 0; j &lt; dofs_per_cell; ++j)</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;<span class="stringliteral">                     cell_matrix(i, j) += (fe_values.shape_value(i, q_point)</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;<span class="stringliteral">                                           fe_values.shape_value(j, q_point)</span></div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;<span class="stringliteral">                                           fe_values.JxW(q_point));</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="stringliteral">               cell-&gt;get_dof_indices(local_dof_indices);</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;<span class="stringliteral">               for (unsigned int i = 0; i &lt; dofs_per_cell; ++i)</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;<span class="stringliteral">                 for (unsigned int j = 0; j &lt; dofs_per_cell; ++j)</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="stringliteral">                   boundary_matrix.add(local_dof_indices[i],</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;<span class="stringliteral">                                       local_dof_indices[j],</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;<span class="stringliteral">                                       cell_matrix(i, j));</span></div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="stringliteral">             }</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="stringliteral">     system_matrix.copy_from(mass_matrix);</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;<span class="stringliteral">     system_matrix.add(time_step time_step theta theta wave_speed</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;<span class="stringliteral">                         wave_speed,</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;<span class="stringliteral">                       laplace_matrix);</span></div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;<span class="stringliteral">     system_matrix.add(wave_speed theta time_step, boundary_matrix);</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="stringliteral">     solution_p.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="stringliteral">     old_solution_p.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">     system_rhs_p.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral">     solution_v.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral">     old_solution_v.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">     system_rhs_v.reinit(dof_handler.n_dofs());</span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="stringliteral">     constraints.close();</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;TATForwardProblemsolve_pandTATForwardProblemsolve_v&quot;&gt;&lt;/a&gt;  &lt;h4&gt;TATForwardProblem::solve_p and TATForwardProblem::solve_v&lt;/h4&gt;</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="stringliteral">*  The following two functions, solving the linear systems for the pressure and the velocity variable, are taken pretty much verbatim (with the exception of the change of name from   @f$u@f$   to   @f$p@f$   of the primary variable) from   @ref step_23 &quot;step-23&quot;  :</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral">   void TATForwardProblem&lt;dim&gt;::solve_p()</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral">     SolverControl solver_control(1000, 1e-8 system_rhs_p.l2_norm());</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral">     SolverCG&lt;Vector&lt;double&gt;&gt; cg(solver_control);</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">     cg.solve(system_matrix, solution_p, system_rhs_p, PreconditionIdentity());</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="stringliteral">     std::cout &lt;&lt; &quot;   p-equation: &quot; &lt;&lt; solver_control.last_step()</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="stringliteral">               &lt;&lt; &quot; CG iterations.&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">   void TATForwardProblem&lt;dim&gt;::solve_v()</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral">     SolverControl solver_control(1000, 1e-8 system_rhs_v.l2_norm());</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">     SolverCG&lt;Vector&lt;double&gt;&gt; cg(solver_control);</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">     cg.solve(mass_matrix, solution_v, system_rhs_v, PreconditionIdentity());</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral">     std::cout &lt;&lt; &quot;   v-equation: &quot; &lt;&lt; solver_control.last_step()</span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral">               &lt;&lt; &quot; CG iterations.&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;TATForwardProblemoutput_results&quot;&gt;&lt;/a&gt;  &lt;h4&gt;TATForwardProblem::output_results&lt;/h4&gt;</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">*  The same holds here: the function is from   @ref step_23 &quot;step-23&quot;  .</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral">   void TATForwardProblem&lt;dim&gt;::output_results() const</span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral">     DataOut&lt;dim&gt; data_out;</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="stringliteral">     data_out.attach_dof_handler(dof_handler);</span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="stringliteral">     data_out.add_data_vector(solution_p, &quot;P&quot;);</span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="stringliteral">     data_out.add_data_vector(solution_v, &quot;V&quot;);</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="stringliteral">     data_out.build_patches();</span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="stringliteral">     const std::string filename =</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral">       &quot;solution-&quot; + Utilities::int_to_string(timestep_number, 3) + &quot;.vtu&quot;;</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral">     DataOutBase::VtkFlags vtk_flags;</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral">     vtk_flags.compression_level =</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">       DataOutBase::VtkFlags::ZlibCompressionLevel::best_speed;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral">     std::ofstream output(filename);</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">     data_out.write_vtu(output);</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;TATForwardProblemrun&quot;&gt;&lt;/a&gt;  &lt;h4&gt;TATForwardProblem::run&lt;/h4&gt;</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral">*  This function that does most of the work is pretty much again like in   @ref step_23 &quot;step-23&quot;  , though we make things a bit clearer by using the vectors G1 and G2 mentioned in the introduction. Compared to the overall memory consumption of the program, the introduction of a few temporary vectors isn&#39;</span>t doing much harm.   </div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;*   The only changes to <span class="keyword">this</span> <span class="keyword">function</span> are: <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a>, that we <span class="keywordflow">do</span> not have to <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">project</a> <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="keywordflow">for</span> the velocity   @f$v@f$  , since we know that it is <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>. And <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> that we evaluate the solution at the detector locations computed in the constructor. This is done <span class="keyword">using</span> the   <a class="code" href="namespaceVectorTools.html#acd358e9b110ccbf4a7f76796d206b9c7">VectorTools::point_value</a>   <span class="keyword">function</span>. These <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> are then written to a file that we open at the beginning of the <span class="keyword">function</span>.</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;* </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;* </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;* @code</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">TATForwardProblem&lt;dim&gt;::run</a>()</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;   {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;     setup_system();</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;* </div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;     <a class="code" href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a>(dof_handler,</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                          constraints,</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;                          <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(fe.degree + 1),</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;                          InitialValuesP&lt;dim&gt;(),</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;                          old_solution_p);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;     old_solution_v = 0;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;* </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;     std::ofstream detector_data(<span class="stringliteral">&quot;detectors.dat&quot;</span>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;* </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> tmp(solution_p.size());</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> G1(solution_p.size());</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> G2(solution_v.size());</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;* </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> end_time = 0.7;</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;     <span class="keywordflow">for</span> (time = time_step; time &lt;= end_time;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          time += time_step, ++timestep_number)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;       {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;         std::cout &lt;&lt; std::endl;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;time_step &quot;</span> &lt;&lt; timestep_number &lt;&lt; <span class="stringliteral">&quot; @ t=&quot;</span> &lt;&lt; time</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                   &lt;&lt; std::endl;</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;* </div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;         <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(G1, old_solution_p);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;         <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(tmp, old_solution_v);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;         G1.add(time_step (1</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;* </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;- theta), tmp);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;* </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;         <a class="code" href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">mass_matrix</a>.vmult(G2, old_solution_v);</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;         laplace_matrix.vmult(tmp, old_solution_p);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;         G2.add(-wave_speed wave_speed time_step (1</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;* </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;- theta), tmp);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;* </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;         boundary_matrix.vmult(tmp, old_solution_p);</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;         G2.add(wave_speed, tmp);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;* </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;         system_rhs_p = G1;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;         system_rhs_p.add(time_step theta, G2);</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;* </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;         solve_p();</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;* </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;         system_rhs_v = G2;</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;         laplace_matrix.vmult(tmp, solution_p);</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;         system_rhs_v.add(-time_step theta wave_speed wave_speed, tmp);</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;* </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;         boundary_matrix.vmult(tmp, solution_p);</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;         system_rhs_v.add(-wave_speed, tmp);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;* </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;         solve_v();</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;* </div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;         output_results();</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;* </div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;         detector_data &lt;&lt; time;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; detector_locations.size(); ++i)</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;           detector_data &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                         &lt;&lt; <a class="code" href="namespaceVectorTools.html#acd358e9b110ccbf4a7f76796d206b9c7">VectorTools::point_value</a>(dof_handler,</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                                                     solution_p,</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                                                     detector_locations[i])</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                         &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;         detector_data &lt;&lt; std::endl;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;* </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;         old_solution_p = solution_p;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;         old_solution_v = solution_v;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;       }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;   }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; } <span class="comment">// namespace Step24</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;* </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;* </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;* </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Thecodemaincodefunction&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The &lt;code&gt;main&lt;/code&gt; <span class="keyword">function</span>&lt;/h3&gt;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;* </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;* </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;*  What remains is the main <span class="keyword">function</span> of the program. There is <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">nothing</a> here that hasn<span class="stringliteral">&#39;t been shown in several of the previous programs:</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral"> int main()</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">   try</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral">       using namespace Step24;</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral">       TATForwardProblem&lt;2&gt; forward_problem_solver;</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">       forward_problem_solver.run();</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">   catch (std::exception &amp;exc)</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Exception on processing: &quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="stringliteral">                 &lt;&lt; exc.what() &lt;&lt; std::endl</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="stringliteral">   catch (...)</span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Unknown exception!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">   return 0;</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Results&quot;&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral">* The program writes both graphical data for each time step as well as thevalues evaluated at each detector location to disk. We thendraw them in plots. Experimental data were also collected for comparison.Currently our experiments have only been done in two dimensions bycircularly scanning a single detector. The tissue sample here is a thin slicein the   @f$X-Y@f$   plane (  @f$Z=0@f$  ), and we assume that signals from other   @f$Z@f$  directions won&#39;</span>t contribute to the data. Consequently, we only have to compareour experimental data with two dimensional simulated data.</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Oneabsorber&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt; One absorber &lt;/h3&gt;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;* </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;* This movie shows the thermoacoustic waves generated by a single small absorberpropagating in the medium (in our simulation, we assume the medium is mineraloil, which has a acoustic speed of 1.437   @f$\frac{mm}{\mu s}@f$  ):</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;*   &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-24.one_movie.gif&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;  </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;* For a single absorber, we of course have to change the  &lt;code&gt;InitialValuesP&lt;/code&gt;   <span class="keyword">class</span> accordingly.</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;* Next, let us compare experimental and computational results. The visualizationuses a technique <span class="keywordtype">long</span> used in seismology, where the data of each detector isplotted all in <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> graph. The way <span class="keyword">this</span> is done is by offsetting eachdetector<span class="stringliteral">&#39;s signal a bit compared to the previous one. For example, here is aplot of the first four detectors (from bottom to top, with time inmicroseconds running from left to right) using the source setup used in theprogram, to make things a bit more interesting compared to the present case ofonly a single source:</span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">*   &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.traces.png&quot; alt=&quot;&quot;&gt;  </span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral">* One thing that can be seen, for example, is that the arrival of the second andfourth signals shifts to earlier times for greater detector numbers (i.e. thetopmost ones), but not the first and the third; this can be interpreted tomean that the origin of these signals must be closer to the latter detectorsthan to the former ones.</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">* If we stack not only 4, but all 160 detectors in one graph, the individuallines blur, but where they run together they create a pattern of darker orlighter grayscales.  The following two figures show the results obtained atthe detector locations stacked in that way. The left figure is obtained fromexperiments, and the right is the simulated data.In the experiment, a single small strong absorber was embedded inweaker absorbing tissue:</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral">*   &lt;table width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">&lt;tr&gt;</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral">&lt;td&gt;</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral">&lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.one.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">&lt;/td&gt;</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">&lt;td&gt;</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral">&lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.one_s.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">&lt;/td&gt;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">&lt;/tr&gt;</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral">* It is obvious that the source location is closer to the detectors at angle  @f$180^\circ@f$  . All the other signals that can be seen in the experimental dataresult from the fact that there are weak absorbers also in the rest of thetissue, which surrounds the signals generated by the small strong absorber inthe center. On the other hand, in the simulated data, we only simulate thesmall strong absorber.</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral">* In reality, detectors have limited bandwidth. The thermoacoustic waves passingthrough the detector will therefore be filtered. By using a high-pass filter(implemented in MATLAB and run against the data file produced by this program),the simulated results can be made to look closer to the experimentaldata:</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">*   &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.one_sf.png&quot; alt=&quot;&quot;&gt;  </span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral">* In our simulations, we see spurious signals behind the main wave thatresult from numerical artifacts. This problem can be alleviated by using finermesh, resulting in the following plot:</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral">*   &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.one_s2.png&quot; alt=&quot;&quot;&gt;  </span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Multipleabsorbers&quot;&gt;&lt;/a&gt;&lt;h3&gt;Multiple absorbers&lt;/h3&gt;</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">* To further verify the program, we will also show simulation results formultiple absorbers. This corresponds to the case that is actually implementedin the program. The following movie shows the propagation of the generatedthermoacoustic waves in the medium by multiple absorbers:</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="stringliteral">*   &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.multi_movie.gif&quot; alt=&quot;&quot;&gt;  </span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="stringliteral">* Experimental data and our simulated data are compared in the following twofigures:  &lt;table width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="stringliteral">&lt;tr&gt;</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="stringliteral">&lt;td&gt;</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="stringliteral">&lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.multi.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">&lt;/td&gt;</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral">&lt;td&gt;</span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral">&lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.multi_s.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral">&lt;/td&gt;</span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="stringliteral">&lt;/tr&gt;</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">* Note that in the experimental data, the first signal (i.e. the left-most darkline) results from absorption at the tissue boundary, and therefore reachesthe detectors first and before any of the signals from the interior. Thissignal is also faintly visible at the end of the traces, around 30   @f$\mu s@f$  ,which indicates that the signal traveled through the entire tissue to reachdetectors at the other side, after all the signals originating from theinterior have reached them.</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">* As before, the numerical result better matches experimental ones by applying abandwidth filter that matches the actual behavior of detectors (left) and bychoosing a finer mesh (right):</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral">*   &lt;table width=&quot;100%&quot;&gt;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral">&lt;tr&gt;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="stringliteral">&lt;td&gt;</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="stringliteral">&lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.multi_sf.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="stringliteral">&lt;/td&gt;</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="stringliteral">&lt;td&gt;</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="stringliteral">&lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-24.multi_s2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="stringliteral">&lt;/td&gt;</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="stringliteral">&lt;/tr&gt;</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="stringliteral">* One of the important differences between the left and the right figure is thatthe curves look much less &quot;angular&quot; at the right. The angularity comes fromthe fact that while waves in the continuous equation travel equally fast inall directions, this isn&#39;</span>t the <span class="keywordflow">case</span> after discretization: there, waves thattravel <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">diagonal</a> to cells move at slightly different speeds to those that moveparallel to mesh lines. This anisotropy leads to wave fronts that aren<span class="stringliteral">&#39;tperfectly circular (and would produce sinusoidal signals in the stackedplots), but are bulged out in certain directions. To make things worse, thecircular mesh we use (see for example   @ref step_6 &quot;step-6&quot;   for a view of thecoarse mesh) is not isotropic either. The net result is that the signal frontsare not sinusoidal unless the mesh is sufficiently fine. The right image is alot better in this respect, though artifacts in the form of trailing spuriouswaves can still be seen.</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="stringliteral">* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-24.cc&quot;  </span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="stringliteral">*</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral">*/</span></div><div class="ttc" id="namespaceMatrixCreator_html_a7b8157122064151d414dc34a22a3ca9c"><div class="ttname"><a href="namespaceMatrixCreator.html#a7b8157122064151d414dc34a22a3ca9c">MatrixCreator::create_laplace_matrix</a></div><div class="ttdeci">void create_laplace_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; double &gt; &amp;matrix, const Function&lt; spacedim &gt; *const a=nullptr, const AffineConstraints&lt; double &gt; &amp;constraints=AffineConstraints&lt; double &gt;())</div></div>
<div class="ttc" id="namespaceGridTools_html_acd5ccc543d561cfb086b571d1f7818cb"><div class="ttname"><a href="namespaceGridTools.html#acd5ccc543d561cfb086b571d1f7818cb">GridTools::diameter</a></div><div class="ttdeci">double diameter(const Triangulation&lt; dim, spacedim &gt; &amp;tria)</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l00081">grid_tools.cc:81</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="classDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00296">dynamic_sparsity_pattern.h:296</a></div></div>
<div class="ttc" id="namespaceDataOutBase_html_aa3cbced9f1d4ae661f13018f4c980aa1aa6f1f99c613aeb81b8d8e598b5567ce1"><div class="ttname"><a href="namespaceDataOutBase.html#aa3cbced9f1d4ae661f13018f4c980aa1aa6f1f99c613aeb81b8d8e598b5567ce1">DataOutBase::none</a></div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8h_source.html#l01319">data_out_base.h:1319</a></div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="namespaceGridTools_html_a0967563badadd81f77f62622dd8bc2cd"><div class="ttname"><a href="namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">GridTools::scale</a></div><div class="ttdeci">void scale(const double scaling_factor, Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l02042">grid_tools.cc:2042</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">DoFTools::nonzero</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00161">dof_tools.h:161</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00049">evaluation_flags.h:49</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">LAPACKSupport::diagonal</a></div><div class="ttdoc">Matrix is diagonal. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00122">lapack_support.h:122</a></div></div>
<div class="ttc" id="namespaceGridTools_html_a47c293eff2ec7ce4b90ba08b35d1f2e2"><div class="ttname"><a href="namespaceGridTools.html#a47c293eff2ec7ce4b90ba08b35d1f2e2">GridTools::minimal_cell_diameter</a></div><div class="ttdeci">double minimal_cell_diameter(const Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Mapping&lt; dim, spacedim &gt; &amp;mapping=(ReferenceCells::get_hypercube&lt; dim &gt;() .template get_default_linear_mapping&lt; dim, spacedim &gt;()))</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l04309">grid_tools.cc:4309</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1L2_html_a1c15243765304a803037988b5561627d"><div class="ttname"><a href="namespaceLocalIntegrators_1_1L2.html#a1c15243765304a803037988b5561627d">LocalIntegrators::L2::mass_matrix</a></div><div class="ttdeci">void mass_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="l2_8h_source.html#l00057">l2.h:57</a></div></div>
<div class="ttc" id="namespaceMatrixCreator_html_aab6397f114af66efd781f7f4daba22be"><div class="ttname"><a href="namespaceMatrixCreator.html#aab6397f114af66efd781f7f4daba22be">MatrixCreator::create_mass_matrix</a></div><div class="ttdeci">void create_mass_matrix(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim &gt; &amp;q, SparseMatrix&lt; number &gt; &amp;matrix, const Function&lt; spacedim, number &gt; *const a=nullptr, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;())</div></div>
<div class="ttc" id="classSparseMatrix_html_acabf7629046afdd9077f77f7746a7a3f"><div class="ttname"><a href="classSparseMatrix.html#acabf7629046afdd9077f77f7746a7a3f">SparseMatrix::add</a></div><div class="ttdeci">void add(const size_type i, const size_type j, const number value)</div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00158">lapack_support.h:158</a></div></div>
<div class="ttc" id="group__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_acd358e9b110ccbf4a7f76796d206b9c7"><div class="ttname"><a href="namespaceVectorTools.html#acd358e9b110ccbf4a7f76796d206b9c7">VectorTools::point_value</a></div><div class="ttdeci">void point_value(const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const VectorType &amp;fe_function, const Point&lt; spacedim, double &gt; &amp;point, Vector&lt; typename VectorType::value_type &gt; &amp;value)</div></div>
<div class="ttc" id="data__out__base_8cc_html_a8188ef4709fc9a4cc076d37447783ba1"><div class="ttname"><a href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a></div><div class="ttdeci">Point&lt; 3 &gt; center</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00170">data_out_base.cc:170</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_a533c4778cbc9bcbed365dcab42ca4418"><div class="ttname"><a href="namespaceGridGenerator.html#a533c4778cbc9bcbed365dcab42ca4418">GridGenerator::hyper_ball</a></div><div class="ttdeci">void hyper_ball(Triangulation&lt; dim &gt; &amp;tria, const Point&lt; dim &gt; &amp;center=Point&lt; dim &gt;(), const double radius=1., const bool attach_spherical_manifold_on_boundary_cells=false)</div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_ac6b404bf03cb2a742b290421cc2789fe"><div class="ttname"><a href="namespaceVectorTools.html#ac6b404bf03cb2a742b290421cc2789fe">VectorTools::project</a></div><div class="ttdeci">void project(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const AffineConstraints&lt; typename VectorType::value_type &gt; &amp;constraints, const Quadrature&lt; dim &gt; &amp;quadrature, const Function&lt; spacedim, typename VectorType::value_type &gt; &amp;function, VectorType &amp;vec, const bool enforce_zero_boundary=false, const Quadrature&lt; dim - 1 &gt; &amp;q_boundary=(dim &gt; 1 ? QGauss&lt; dim - 1 &gt;(2) :Quadrature&lt; dim - 1 &gt;(0)), const bool project_to_boundary_first=false)</div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="vectorization_8h_html_a303f564e3c189251976da401ee2e44fa"><div class="ttname"><a href="vectorization_8h.html#a303f564e3c189251976da401ee2e44fa">std::sqrt</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; sqrt(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05442">vectorization.h:5442</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_adb1b44ad6f1741fbbbecc43f95d26baf"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">Physics::Elasticity::Kinematics::l</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; l(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
