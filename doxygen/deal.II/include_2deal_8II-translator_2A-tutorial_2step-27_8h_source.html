<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-27_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-27.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-27.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-27_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; ) <span class="keyword">const</span></div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;   {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;     <span class="keywordtype">double</span> product = 1;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> &lt; dim; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>)</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;       product= (p[<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>] + 1);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;     <span class="keywordflow">return</span> product;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;   }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;* </div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;* </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;* </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Implementationofthemainclass&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Implementation of the main <span class="keyword">class</span>&lt;/h3&gt;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;* </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;* </div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblemLaplaceProblemconstructor&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::LaplaceProblem constructor&lt;/h4&gt;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;* </div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;* </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;*  The constructor of <span class="keyword">this</span> <span class="keyword">class </span>is fairly straightforward. It associates the <a class="code" href="classDoFHandler.html">DoFHandler</a> object with the <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>, and then sets the maximal polynomial degree to 7 (in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> and 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) or 5 (in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> and higher). We do so because using higher order polynomial degrees becomes prohibitively expensive, especially in higher space dimensions.   </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;*   Following <span class="keyword">this</span>, we fill the collections of finite element, and cell and face quadrature objects. We start with quadratic elements, and each quadrature formula is chosen so that it is appropriate <span class="keywordflow">for</span> the matching finite element in the   <a class="code" href="classhp_1_1FECollection.html">hp::FECollection</a>   <span class="keywordtype">object</span>.</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;* </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;* </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;* @code</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;   LaplaceProblem&lt;dim&gt;::LaplaceProblem()</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;     : dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;     , max_degree(dim &lt;= 2 ? 7 : 5)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;   {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree = 2; degree &lt;= max_degree; ++degree)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;       {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;         fe_collection.push_back(<a class="code" href="classFE__Q.html">FE_Q&lt;dim&gt;</a>(degree));</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;         quadrature_collection.push_back(<a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>(degree + 1));</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;         face_quadrature_collection.push_back(<a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;* </div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;- 1&gt;(degree + 1));</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;       }</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;   }</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;* </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160; </div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;* </div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblemLaplaceProblemdestructor&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::~LaplaceProblem destructor&lt;/h4&gt;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;* </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;* </div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;*  The destructor is unchanged from what we already did in   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>  :</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;* </div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;* </div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;* @code</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;   LaplaceProblem&lt;dim&gt;::~LaplaceProblem()</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;   {</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;     dof_handler.clear();</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;   }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;* </div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;* </div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblemsetup_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::setup_system&lt;/h4&gt;   </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;*   This <span class="keyword">function</span> is again a verbatim <a class="code" href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">copy</a> of what we already did in   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>  . Despite <span class="keyword">function</span> calls with exactly the same names and arguments, the algorithms used internally are different in some aspect since the dof_handler variable here is in   @f$hp@f$  -mode.</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;* </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;* </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;* @code</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;   <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::setup_system()</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;   {</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;     dof_handler.distribute_dofs(fe_collection);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;* </div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;     solution.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;     system_rhs.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;* </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;     constraints.clear();</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     <a class="code" href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a>(dof_handler, constraints);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;     <a class="code" href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a>(dof_handler,</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                                              0,</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                              <a class="code" href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction&lt;dim&gt;</a>(),</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                              constraints);</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;     constraints.close();</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;* </div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;     <a class="code" href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a> dsp(dof_handler.n_dofs(), dof_handler.n_dofs());</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;     <a class="code" href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a>(dof_handler, dsp, constraints, <span class="keyword">false</span>);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;* </div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;     system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;   }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;* </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;* </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;* </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblemassemble_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::assemble_system&lt;/h4&gt;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;* </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;* </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;*  This is the <span class="keyword">function</span> that assembles the global <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and right hand side vector from the local contributions of each cell. Its main working is as has been described in many of the tutorial programs before. The significant deviations are the ones necessary for &lt;i&gt;<a class="code" href="namespacehp.html">hp</a>&lt;/i&gt; finite element methods. In particular, that we need to use a collection of <a class="code" href="classFEValues.html">FEValues</a> object (implemented through the   <a class="code" href="classhp_1_1FEValues.html">hp::FEValues</a>   <span class="keyword">class</span>), and that we have to eliminate constrained degrees of freedom already when copying local contributions into global objects. Both of these are explained in detail in the introduction of <span class="keyword">this</span> program.   </div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;*   One other slight complication is the fact that because we use different polynomial degrees on different cells, the matrices and vectors holding local contributions <span class="keywordflow">do</span> not have the same size on all cells. At the beginning of the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all cells, we therefore each time have to resize them to the correct size (given by   &lt;code&gt;dofs_per_cell&lt;/code&gt;  ). Because these classes are implemented in such a way that reducing the size of a <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> or vector does not release the currently allocated memory (unless the <span class="keyword">new</span> size is <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>), the process of resizing at the beginning of the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> will only require re-allocation of memory during the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> few iterations. Once we have found in a cell with the maximal finite element degree, no more re-allocations will happen because all subsequent   &lt;code&gt;<a class="code" href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">reinit</a>&lt;/code&gt;   calls will only <span class="keyword">set</span> the size to something that fits the currently allocated memory. This is important since allocating memory is expensive, and doing so every time we visit a <span class="keyword">new</span> cell would take significant compute time.</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;* </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;* </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;* @code</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::assemble_system()</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   {</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;     <a class="code" href="classhp_1_1FEValues.html">hp::FEValues&lt;dim&gt;</a> hp_fe_values(fe_collection,</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;                                    quadrature_collection,</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;                                    <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;                                      <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;                                      <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;* </div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;     RightHandSide&lt;dim&gt; rhs_function;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;* </div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     cell_rhs;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;* </div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;     std::vector&lt;types::global_dof_index&gt; local_dof_indices;</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;* </div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;       {</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = cell-&gt;get_fe().n_dofs_per_cell();</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;* </div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;         cell_matrix.reinit(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         cell_matrix = 0;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;* </div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;         cell_rhs.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(dofs_per_cell);</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;         cell_rhs = 0;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;* </div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;         hp_fe_values.<a class="code" href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">reinit</a>(cell);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;* </div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;         <span class="keyword">const</span> <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> &amp;fe_values = hp_fe_values.<a class="code" href="classFEValues.html#a902429920d32c81c9c279d9a15faa263">get_present_fe_values</a>();</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;* </div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;         std::vector&lt;double&gt; rhs_values(fe_values.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;         rhs_function.value_list(fe_values.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), rhs_values);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;* </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point = 0; q_point &lt; fe_values.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              ++q_point)</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;             {</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                 <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(i, j) +=</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                   (fe_values.<a class="code" href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">shape_grad</a>(i, q_point) <span class="comment">// grad phi_i(x_q)</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                    fe_values.<a class="code" href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">shape_grad</a>(j, q_point) <span class="comment">// grad phi_j(x_q)</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                    fe_values.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q_point));           <span class="comment">// dx</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;* </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;               cell_rhs(i) += (fe_values.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, q_point) <span class="comment">// phi_i(x_q)</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;                               rhs_values[q_point]               <span class="comment">// f(x_q)</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                               fe_values.<a class="code" href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">JxW</a>(q_point));            <span class="comment">// dx</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;             }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;* </div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;         local_dof_indices.resize(dofs_per_cell);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;         cell-&gt;get_dof_indices(local_dof_indices);</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;* </div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;         constraints.distribute_local_to_global(</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;           cell_matrix, cell_rhs, local_dof_indices, system_matrix, system_rhs);</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;       }</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   }</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;* </div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160; </div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;* </div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;* </div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblemsolve&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::solve&lt;/h4&gt;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;* </div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;* </div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;*  The <span class="keyword">function</span> solving the linear system is entirely unchanged from previous examples. We simply <span class="keywordflow">try</span> to <a class="code" href="namespaceUtilities_1_1MPI.html#a9e963546bd81b0cdd88e1840cfa8f227">reduce</a> the <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> residual (which equals the   @f$l_2@f$   <a class="code" href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">norm</a> of the right hand side) by a certain factor:</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;* </div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;* </div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;* @code</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::solve()</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;   {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(system_rhs.size(),</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                                  1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12 system_rhs.l2_norm());</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;     <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; cg(solver_control);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;* </div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;     <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;     preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;* </div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;     cg.solve(system_matrix, solution, system_rhs, preconditioner);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;* </div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;     constraints.distribute(solution);</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;* </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160; </div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;* </div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;* </div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblempostprocess&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::postprocess&lt;/h4&gt;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;* </div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;* </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;*  After solving the linear system, we will want to postprocess the solution. Here, all we <span class="keywordflow">do</span> is to estimate the error, estimate the local smoothness of the solution as described in the introduction, then write graphical output, and <span class="keywordflow">finally</span> <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh in both   @f$h@f$   and   @f$p@f$   according to the indicators computed before. We <span class="keywordflow">do</span> all <span class="keyword">this</span> in the same <span class="keyword">function</span> because we want the estimated error and smoothness indicators not only <span class="keywordflow">for</span> refinement, but also include them in the graphical output.</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;* </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;* </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;* @code</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::postprocess(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle)</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   {</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;* </div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;*  Let us start with computing estimated error and smoothness indicators, which each are <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> number <span class="keywordflow">for each</span> active cell of our <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>. For the error indicator, we use the <a class="code" href="classKellyErrorEstimator.html">KellyErrorEstimator</a> <span class="keyword">class </span>as <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a>.</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;* </div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;* </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;* @code</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;     <a class="code" href="classVector.html">Vector&lt;float&gt;</a> estimated_error_per_cell(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     <a class="code" href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator&lt;dim&gt;::estimate</a>(</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;       dof_handler,</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;       face_quadrature_collection,</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;       std::map&lt;<a class="code" href="classunsigned_01int.html">types::boundary_id</a>, <span class="keyword">const</span> <a class="code" href="classFunction.html">Function&lt;dim&gt;</a>&gt;(),</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;       solution,</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;       estimated_error_per_cell);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;* </div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;* </div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;*  Estimating the smoothness is performed with the method of decaying expansion coefficients as outlined in the introduction. We will <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> need to create an <span class="keywordtype">object</span> capable of transforming the finite element solution on every single cell into a sequence of Fourier series coefficients. The <a class="code" href="namespaceSmoothnessEstimator.html">SmoothnessEstimator</a> <span class="keyword">namespace </span>offers a factory function for such a   <a class="code" href="namespaceFESeries.html">FESeries</a>::Fourier   object that is optimized for the process of estimating smoothness. The actual determination of the decay of Fourier coefficients on every individual cell then happens in the last function.</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;* </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;* </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;* @code</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;     <a class="code" href="classVector.html">Vector</a>&lt;float&gt; smoothness_indicators(triangulation.n_active_cells());</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;     <a class="code" href="classFESeries_1_1Fourier.html">FESeries::Fourier</a>&lt;dim&gt; fourier =</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;       <a class="code" href="namespaceSmoothnessEstimator_1_1Fourier.html#a748faa704c9dfb67a074d11316e777b4">SmoothnessEstimator::Fourier::default_fe_series</a>(fe_collection);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;     <a class="code" href="namespaceSmoothnessEstimator_1_1Fourier.html#aae63069820e030e1f012e3e84d28e6f8">SmoothnessEstimator::Fourier::coefficient_decay</a>(fourier,</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                                                     dof_handler,</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                                                     solution,</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                                                     smoothness_indicators);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;* </div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;* </div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;*  Next we want to generate graphical output. In addition to the two estimated quantities derived above, we would also like to output the polynomial degree of the finite elements used on each of the elements on the mesh.     </div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;*   The way to <span class="keywordflow">do</span> that requires that we <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all cells and poll the active finite element index of them using   &lt;code&gt;cell-@&gt;active_fe_index()&lt;/code&gt;  . We then use the result of <span class="keyword">this</span> operation and query the finite element collection <span class="keywordflow">for</span> the finite element with that index, and <span class="keywordflow">finally</span> determine the polynomial degree of that element. The result we put into a vector with <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> element per cell. The <a class="code" href="classDataOut.html">DataOut</a> <span class="keyword">class </span>requires this to be a vector of   &lt;code&gt;float&lt;/code&gt; or &lt;code&gt;<a class="code" href="classdouble.html">double</a>&lt;/code&gt;  , even though our <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> are all integers, so that is what we use:</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;* </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;* </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;* @code</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;     {</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;       <a class="code" href="classVector.html">Vector&lt;float&gt;</a> fe_degrees(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;         fe_degrees(cell-&gt;active_cell_index()) =</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;           fe_collection[cell-&gt;active_fe_index()].degree;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;* </div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;* </div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;*  With now all data vectors available</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;* </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;*  -  solution, estimated errors and smoothness indicators, and finite element degrees</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;* </div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;*  - , we create a <a class="code" href="classDataOut.html">DataOut</a> <span class="keywordtype">object</span> <span class="keywordflow">for</span> graphical output and attach all data:</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;* </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;* </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;* @code</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;       <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;* </div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;       data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;       data_out.add_data_vector(solution, <span class="stringliteral">&quot;solution&quot;</span>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;       data_out.add_data_vector(estimated_error_per_cell, <span class="stringliteral">&quot;error&quot;</span>);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;       data_out.add_data_vector(smoothness_indicators, <span class="stringliteral">&quot;smoothness&quot;</span>);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;       data_out.add_data_vector(fe_degrees, <span class="stringliteral">&quot;fe_degree&quot;</span>);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;       data_out.build_patches();</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;* </div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;* </div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;*  The <span class="keyword">final</span> step in generating output is to determine a file name, open the file, and write the data into it (here, we use VTK format):</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;* </div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;* </div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;* @code</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;       const <a class="code" href="namespacestd.html">std</a>::string filename =</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;         <span class="stringliteral">&quot;solution-&quot;</span> + <a class="code" href="namespaceUtilities.html">Utilities</a>::<a class="code" href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">int_to_string</a>(cycle, 2) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;       std::ofstream output(filename);</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;       data_out.write_vtk(output);</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;     }</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;* </div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;* </div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;*  After <span class="keyword">this</span>, we would like to actually <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh, in both   @f$h@f$   and   @f$p@f$  . The way we are going to <span class="keywordflow">do</span> <span class="keyword">this</span> is as follows: <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a>, we use the estimated error to flag those cells <span class="keywordflow">for</span> refinement that have the largest error. This is what we have <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> done:</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;* </div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;* </div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;* @code</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;     {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;       <a class="code" href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;                                                       estimated_error_per_cell,</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;                                                       0.3,</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;                                                       0.03);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;* </div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;* </div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;*  Next we would like to figure out which of the cells that have been flagged <span class="keywordflow">for</span> refinement should actually have   @f$p@f$   increased instead of   @f$h@f$   decreased. The strategy we choose here is that we look at the smoothness indicators of those cells that are flagged <span class="keywordflow">for</span> refinement, and increase   @f$p@f$   <span class="keywordflow">for</span> those with a smoothness larger than a certain relative threshold. In other words, <span class="keywordflow">for</span> every cell <span class="keywordflow">for</span> which (i) the refinement flag is <span class="keyword">set</span>, (ii) the smoothness indicator is larger than the threshold, and (iii) we still have a finite element with a polynomial degree higher than the current <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> in the finite element collection, we will assign a future FE index that corresponds to a polynomial with degree <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> higher than it currently is. The following <span class="keyword">function</span> is capable of doing exactly this. Absent any better strategies, we will <span class="keyword">set</span> the threshold via interpolation between the minimal and maximal smoothness indicators on cells flagged <span class="keywordflow">for</span> refinement. Since the corner singularities are strongly localized, we will favor   @f$p@f$  - over   @f$h@f$  -refinement quantitatively. We achieve <span class="keyword">this</span> with a low threshold by setting a small interpolation factor of 0.2. In the same way, we deal with cells that are going to be coarsened and decrease their polynomial degree when their smoothness indicator is below the corresponding threshold determined on cells to be coarsened.</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;* </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;* </div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;* @code</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;       <a class="code" href="namespacehp_1_1Refinement.html#a54156dbe64e8eda42b2e964c9b1c0963">hp::Refinement::p_adaptivity_from_relative_threshold</a>(</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;         dof_handler, smoothness_indicators, 0.2, 0.2);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;* </div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;* </div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;*  The above <span class="keyword">function</span> only determines whether the polynomial degree will change via future FE indices, but does not manipulate the   @f$h@f$  -refinement flags. So <span class="keywordflow">for</span> cells that are flagged <span class="keywordflow">for</span> both refinement categories, we prefer   @f$p@f$  - over   @f$h@f$  -refinement. The following <span class="keyword">function</span> <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> ensures that only <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> of   @f$p@f$  - or   @f$h@f$  -refinement is imposed, and not both at once.</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;* </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;* </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;* @code</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;       <a class="code" href="namespacehp_1_1Refinement.html#a4890d9eae896d749b103c8eec9c2029d">hp::Refinement::choose_p_over_h</a>(dof_handler);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;* </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;* </div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;*  For grid adaptive refinement, we ensure a 2:1 mesh balance by limiting the difference of refinement levels of neighboring cells to <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> by calling   <a class="code" href="classTriangulation.html#ab9fa3177e0e43ab0cf243215d284a35a">Triangulation::prepare_coarsening_and_refinement</a>().   We would like to achieve something similar <span class="keywordflow">for</span> the p-levels of neighboring cells: levels of future finite elements are not allowed to differ by more than a specified difference. With its <span class="keywordflow">default</span> parameters, a <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> of   <a class="code" href="namespacehp_1_1Refinement.html#a33d9d552f696d578da30dc9a83048670">hp::Refinement::limit_p_level_difference</a>()   ensures that their <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> difference is limited to <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>. This will not necessarily decrease the number of hanging nodes in the domain, but makes sure that high order polynomials are not constrained to much lower polynomials on faces, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>.g., fifth order to <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> order polynomials.</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;* </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;* </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;* @code</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;       <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.prepare_coarsening_and_refinement();</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;       <a class="code" href="namespacehp.html">hp</a>::Refinement::<a class="code" href="namespacehp_1_1Refinement.html#a33d9d552f696d578da30dc9a83048670">limit_p_level_difference</a>(dof_handler);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;* </div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; @endcode</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;* </div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;*  At the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of this procedure, we then <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh. During this process, children of cells undergoing bisection inherit their mother cell&#39;s finite element index. Further, future finite element indices will turn into active ones, so that the new finite elements will be assigned to cells after the next <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> of   <a class="code" href="classDoFHandler.html">DoFHandler</a>::distribute_dofs().  </div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;* </div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;* </div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;* @code</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;       <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.execute_coarsening_and_refinement();</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;     }</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;   }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;* </div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160; </div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; @endcode</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;* </div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;*   &lt;a name=&quot;LaplaceProblemcreate_coarse_grid&quot;&gt;&lt;/a&gt;  &lt;h4&gt;LaplaceProblem::create_coarse_grid&lt;/h4&gt;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;* </div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;* </div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;*  The following function is used when creating the <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> grid. The grid we would like to create is actually similar to the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> from   @ref step_14 &quot;step-14&quot;  , i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., the square domain with the square hole in the middle. It can be generated by exactly the same function. However, since its implementation is only a specialization of the 2<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> case, we will present a different way of creating this domain which is dimension independent.   </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;*   We <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> create a hypercube <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> with enough cells so that it already holds our desired domain   @f$[-1,1]^<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$  , subdivided into   @f$4^<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$   cells. We then remove those cells in the <a class="code" href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a> of the domain by testing the coordinate <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the <a class="code" href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a> on each cell. In the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a>, we <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the so created grid globally as usual.</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;* </div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;* </div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;* @code</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;   <span class="keywordtype">void</span> LaplaceProblem&lt;dim&gt;::create_coarse_grid()</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;   {</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a> cube;</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;     <a class="code" href="namespaceGridGenerator.html#a358d5bd545bc115c8645d93fa79b64bc">GridGenerator::subdivided_hyper_cube</a>(cube, 4,</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;* </div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;-1., 1.);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;* </div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;     std::set&lt;typename Triangulation&lt;dim&gt;::active_cell_iterator&gt; cells_to_remove;</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : cube.<a class="code" href="group__CPP11.html#ga4288670ae5bd80367e24918d542cb2d8">active_cell_iterators</a>())</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> v = 0; v &lt; GeometryInfo&lt;dim&gt;::vertices_per_cell; ++v)</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;         <span class="keywordflow">if</span> (cell-&gt;vertex(v).square() &lt; .1)</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;           cells_to_remove.insert(cell);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;* </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;     <a class="code" href="namespaceGridGenerator.html#ada140ece81bf38a23e738e0e57f89e97">GridGenerator::create_triangulation_with_removed_cells</a>(cube,</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;                                                            cells_to_remove,</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;                                                            <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>);</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;* </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.refine_global(3);</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;   }</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;* </div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;* </div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;* </div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;LaplaceProblemrun&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">LaplaceProblem::run</a>&lt;/h4&gt;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;* </div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;* </div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;*  This <span class="keyword">function</span> implements the logic of the program, as did the respective <span class="keyword">function</span> in most of the previous programs already, see <span class="keywordflow">for</span> example   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>  .   </div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;*   Basically, it contains the adaptive <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>: in the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> iteration create a coarse grid, and then <span class="keyword">set</span> up the linear system, <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> it, solve, and postprocess the solution including mesh refinement. Then start over again. In the meantime, also output some information <span class="keywordflow">for</span> those staring at the screen trying to figure out what the program does:</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;* </div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;* </div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;* @code</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;   <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">LaplaceProblem&lt;dim&gt;::run</a>()</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;   {</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle = 0; cycle &lt; 6; ++cycle)</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;       {</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; cycle &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;* </div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;         <span class="keywordflow">if</span> (cycle == 0)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;           create_coarse_grid();</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;* </div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;         setup_system();</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;* </div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells      : &quot;</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                   &lt;&lt; <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells() &lt;&lt; std::endl</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                   &lt;&lt; std::endl</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                   &lt;&lt; <span class="stringliteral">&quot;   Number of constraints       : &quot;</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;                   &lt;&lt; constraints.n_constraints() &lt;&lt; std::endl;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;* </div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;         assemble_system();</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;         solve();</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;         postprocess(cycle);</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;       }</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;   }</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; } <span class="comment">// namespace Step27</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;* </div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;* </div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Themainfunction&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The main <span class="keyword">function</span>&lt;/h3&gt;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;* </div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;* </div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;*  The main <span class="keyword">function</span> is again verbatim what we had before: wrap creating and running an <span class="keywordtype">object</span> of the main <span class="keyword">class </span>into a   &lt;code&gt;try&lt;/code&gt;   block and catch whatever exceptions are thrown, thereby producing meaningful output if anything should go wrong:</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;* </div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;* </div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;* @code</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160; <a class="code" href="classint.html">int</a> main()</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; {</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;   <span class="keywordflow">try</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;     {</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;       <span class="keyword">using namespace </span>Step27;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;* </div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;       LaplaceProblem&lt;2&gt; laplace_problem;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;       laplace_problem.run();</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;     }</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;   <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;     {</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                 &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;* </div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;     }</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;   <span class="keywordflow">catch</span> (...)</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;     {</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;     }</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;* </div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; }</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;* </div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;* In <span class="keyword">this</span> section, we discuss a few results produced from running thecurrent tutorial program. More results, in particular the extension to3d calculations and determining how much compute time the individualcomponents of the program take, are given in the   @ref hp_paper   <span class="stringliteral">&quot;hp-paper&quot;</span>.</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;* When <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>, <span class="keyword">this</span> is what the program produces:</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;* @code</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;&gt; make run</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;[ 66%] Built target @ref step_27 <span class="stringliteral">&quot;step-27&quot;</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;[100%] Run @ref step_27 <span class="stringliteral">&quot;step-27&quot;</span> with Release configuration</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;Cycle 0:</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;   Number of active cells      : 768</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;   Number of degrees of freedom: 3264</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;   Number of constraints       : 384</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;Cycle 1:</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;   Number of active cells      : 807</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;   Number of degrees of freedom: 4764</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;   Number of constraints       : 756</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;Cycle 2:</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;   Number of active cells      : 927</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;   Number of degrees of freedom: 8226</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;   Number of constraints       : 1856</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;Cycle 3:</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;   Number of active cells      : 978</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;   Number of degrees of freedom: 12146</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;   Number of constraints       : 2944</div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;Cycle 4:</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;   Number of active cells      : 1104</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;   Number of degrees of freedom: 16892</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;   Number of constraints       : 3998</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;Cycle 5:</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;   Number of active cells      : 1149</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;   Number of degrees of freedom: 22078</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;   Number of constraints       : 5230</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;* </div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;* The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> thing we learn from <span class="keyword">this</span> is that the number of constrained degreesof freedom is on the order of 20-25% of the total number of degrees offreedom, at least on the later grids when we have elements of relativelyhigh order (in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, the fraction of constrained degrees of freedom can be upto 30%). This is, in fact, on the same order of magnitude as fornon-  @f$hp@f$  -discretizations. For example, in the last step of the   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>  program, we have 18353 degrees of freedom, 4432 of which areconstrained. The difference is that in the latter program, each constrainedhanging node is constrained against only the two adjacent degrees offreedom, whereas in the   @f$hp@f$  -<span class="keywordflow">case</span>, constrained nodes are constrained againstmany more degrees of freedom. Note also that the current program alsoincludes nodes subject to Dirichlet boundary conditions in the list ofconstraints. In cycle 0, all the constraints are actually because ofboundary conditions.</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;* Of maybe more interest is to look at the graphical output. First, here is thesolution of the problem:</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;* &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/  step-27  -solution.png&quot;</span>     alt=<span class="stringliteral">&quot;Elevation plot of the solution, showing the lack of regularity near          the interior (reentrant) corners.&quot;</span>     width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;* Secondly, let us look at the sequence of meshes generated:</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;*   &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;threecolumn&quot;</span> style=<span class="stringliteral">&quot;width: 80%&quot;</span>&gt;</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.mesh-00.svg&quot;</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;         alt=<span class="stringliteral">&quot;Triangulation containing reentrant corners without adaptive refinement.&quot;</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.mesh-01.svg&quot;</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;         alt=<span class="stringliteral">&quot;Triangulation containing reentrant corners with one level of</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="stringliteral">         refinement. New cells are placed near the corners.&quot;</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.mesh-02.svg&quot;</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;         alt=<span class="stringliteral">&quot;Triangulation containing reentrant corners with two levels of</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="stringliteral">         refinement. New cells are placed near the corners.&quot;</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.mesh-03.svg&quot;</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;         alt=<span class="stringliteral">&quot;Triangulation containing reentrant corners with three levels of</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="stringliteral">         refinement. New cells are placed near the corners.&quot;</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.mesh-04.svg&quot;</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;         alt=<span class="stringliteral">&quot;Triangulation containing reentrant corners with four levels of</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="stringliteral">         refinement. New cells are placed near the corners.&quot;</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.mesh-05.svg&quot;</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;         alt=<span class="stringliteral">&quot;Triangulation containing reentrant corners with five levels of</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="stringliteral">         refinement. New cells are placed near the corners.&quot;</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;&lt;/div&gt;  </div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;* It is clearly visible how the mesh is refined near the corner singularities,as <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> would expect it. More interestingly, we should be curious to see thedistribution of finite element polynomial degrees to these mesh cells, wherethe lightest color corresponds to degree two and the darkest <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> correspondsto degree seven:</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;*   &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;threecolumn&quot;</span> style=<span class="stringliteral">&quot;width: 80%&quot;</span>&gt;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.fe_degree-00.svg&quot;</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;         alt=<span class="stringliteral">&quot;Initial grid where all cells contain just biquadratic functions.&quot;</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.fe_degree-01.svg&quot;</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of local approximation degrees after one refinement.&quot;</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.fe_degree-02.svg&quot;</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of local approximation degrees after two refinements.&quot;</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.fe_degree-03.svg&quot;</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of local approximation degrees after three refinements.&quot;</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.fe_degree-04.svg&quot;</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of local approximation degrees after four refinements.&quot;</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.fe_degree-05.svg&quot;</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of local approximation degrees after five refinements.&quot;</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;&lt;/div&gt;  </div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;* While <span class="keyword">this</span> is certainly not a perfect arrangement, it does make some sense: weuse low order elements close to boundaries and corners where regularity islow. On the other hand, higher order elements are used where (i) the error wasat <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> fairly large, i.e., mainly in the <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> area around the cornersingularities and in the top right corner where the solution is large, and(ii) where the solution is smooth, i.e., far away from the boundary.</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;* This arrangement of polynomial degrees of course follows from our smoothnessestimator. Here is the estimated smoothness of the solution, with darker colorsindicating least smoothness and lighter indicating the smoothest areas:</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;*   &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;threecolumn&quot;</span> style=<span class="stringliteral">&quot;width: 80%&quot;</span>&gt;</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.smoothness-00.svg&quot;</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;         alt=<span class="stringliteral">&quot;Estimated regularity per cell on the initial grid.&quot;</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.smoothness-01.svg&quot;</span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of the estimated regularity per cell after one refinement.&quot;</span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.smoothness-02.svg&quot;</span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of the estimated regularity per cell after two refinements.&quot;</span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.smoothness-03.svg&quot;</span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of the estimated regularity per cell after three refinements.&quot;</span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.smoothness-04.svg&quot;</span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of the estimated regularity per cell after four refinements.&quot;</span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-27.smoothness-05.svg&quot;</span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;         alt=<span class="stringliteral">&quot;Depiction of the estimated regularity per cell after five refinements.&quot;</span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;         width=<span class="stringliteral">&quot;200&quot;</span> height=<span class="stringliteral">&quot;200&quot;</span>&gt;</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;&lt;/div&gt;  </div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;* The primary conclusion <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> can draw from <span class="keyword">this</span> is that the loss of regularity atthe <span class="keyword">internal</span> corners is a highly localized phenomenon; it only seems to impactthe cells adjacent to the corner itself, so when we <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh the blackcoloring is no longer visible. Besides the corners, <span class="keyword">this</span> sequence of plotsimplies that the smoothness estimates are somewhat independent of the meshrefinement, particularly when we are far away from boundaries.It is also obvious that the smoothness estimates are independent of the actualsize of the solution (see the picture of the solution above), as it should be.A <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> of larger concern, however, is that <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> realizes on closer inspectionthat the estimator we have overestimates the smoothness of the solution oncells with hanging nodes. This in turn leads to higher polynomial degrees inthese areas, skewing the allocation of finite elements onto cells.</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;* We have no good explanation <span class="keywordflow">for</span> <span class="keyword">this</span> effect at the moment. One theory is thatthe numerical solution on cells with hanging nodes is, of course, constrainedand therefore not entirely <a class="code" href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">free</a> to explore the <span class="keyword">function</span> space to <span class="keyword">get</span> close tothe exact solution. This lack of degrees of freedom may manifest itself byyielding numerical solutions on these cells with suppressed oscillation,meaning a higher degree of smoothness. The estimator picks <span class="keyword">this</span> signal up andthe estimated smoothness overestimates the actual <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>. However, a definiteanswer to what is going on currently eludes the authors of <span class="keyword">this</span> program.</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;* The bigger question is, of course, how to avoid <span class="keyword">this</span> problem. Possibilitiesinclude estimating the smoothness not on single cells, but cell assemblies orpatches surrounding each cell. It may also be possible to find simplecorrection factors <span class="keywordflow">for each</span> cell depending on the number of constraineddegrees of freedom it has. In either <span class="keywordflow">case</span>, there are ample opportunities forfurther research on finding good   @f$hp@f$  -refinement criteria. On the other hand,the main <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> of the current program was to demonstrate <span class="keyword">using</span> the  @f$hp@f$  -technology in deal.II, which is unaffected by our use of a possiblesub-optimal refinement criterion.</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;* </div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;* </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;* &lt;a name=<span class="stringliteral">&quot;extensions&quot;</span>&gt;&lt;/a&gt;&lt;a name=<span class="stringliteral">&quot;Possibilitiesforextensions&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Possibilities <span class="keywordflow">for</span> extensions&lt;/h3&gt;</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;* </div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Differenthpdecisionstrategies&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Different <a class="code" href="namespacehp.html">hp</a>-decision strategies&lt;/h4&gt;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;* </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;* This tutorial demonstrates only <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> particular strategy to decide between   @f$h@f$  - and  @f$p@f$  -adaptation. In fact, there are many more ways to automatically decide on theadaptation type, of which a few are already implemented in deal.II:  &lt;ul&gt;      &lt;li&gt;  &lt;i&gt;Fourier coefficient decay:&lt;/i&gt; This is the strategy currently  implemented in <span class="keyword">this</span> tutorial. For more information on <span class="keyword">this</span> strategy, see  the <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> documentation of the   <a class="code" href="namespaceSmoothnessEstimator_1_1Fourier.html">SmoothnessEstimator::Fourier</a>   <span class="keyword">namespace</span>.  &lt;/li&gt;  </div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;*     &lt;li&gt;  &lt;i&gt;Legendre coefficient decay:&lt;/i&gt; This strategy is quite similar  to the current <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>, but uses Legendre series expansion rather than the  Fourier <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>: instead of sinusoids as basis <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>, <span class="keyword">this</span> strategy uses  Legendre polynomials. Of course, since we <a class="code" href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">approximate</a> the solution <span class="keyword">using</span> a  finite-dimensional polynomial on each cell, the expansion of the solution in  Legendre polynomials is also finite and, consequently, when we talk about the  <span class="stringliteral">&quot;decay&quot;</span> of <span class="keyword">this</span> expansion, we can only consider the finitely many <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a>  coefficients of <span class="keyword">this</span> expansion, rather than think about it in asymptotic terms.  But, <span class="keywordflow">if</span> we have enough of these coefficients, we can certainly think of the  decay of these coefficients as characteristic of the decay of the coefficients  of the exact solution (which is, in <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a>, not polynomial and so will have an  infinite Legendre expansion), and considering the coefficients we have should  reveal something about the properties of the exact solution.</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;*   The transition from the Fourier strategy to the Legendre one is quite simple:  You just need to change the series expansion <span class="keyword">class </span>and the corresponding  smoothness estimation function to be part of the proper namespaces    <a class="code" href="namespaceFESeries.html">FESeries</a>::Legendre   and   <a class="code" href="namespaceSmoothnessEstimator_1_1Legendre.html">SmoothnessEstimator::Legendre</a>.   This strategy is used  in   @ref step_75 &quot;step-75&quot;  . For the theoretical background of this strategy, consult the  <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> documentation of the   <a class="code" href="namespaceSmoothnessEstimator_1_1Legendre.html">SmoothnessEstimator::Legendre</a>   namespace, as well  as   @cite mavriplis1994hp   ,   @cite eibner2007hp   and   @cite davydov2017hp   .  &lt;/li&gt;  </div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;*     &lt;li&gt;  &lt;i&gt;Refinement history:&lt;/i&gt; The last strategy is quite different  from the other two. In theory, we know how the error will converge  after changing the discretization of the function space. With    @f$h@f$  -refinement the solution converges algebraically as already pointed  out in   @ref step_7 &quot;step-7&quot;  . If the solution is sufficiently smooth, though, we  expect that the solution will converge exponentially with increasing  polynomial degree of the finite element. We can compare a proper  prediction of the error with the actual error in the following step to  see if our choice of adaptation type was justified.</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;*   The transition to this strategy is a bit more complicated. For this, we need  an initialization step with pure   @f$h@f$  - or   @f$p@f$  -refinement and we need to  transfer the predicted errors over adapted meshes. The extensive  documentation of the   <a class="code" href="namespacehp_1_1Refinement.html#a9c96d6a85b38f120b5d7cf68126cded9">hp::Refinement::predict_error</a>()   function describes not  only the theoretical details of this approach, but also presents a blueprint  on how to implement this strategy in your code. For more information, see    @cite melenk2001hp   .</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;*   Note that with this particular function you cannot predict the error for  the next time step in time-dependent problems. Therefore, this strategy  cannot be applied to this type of problem without further ado. Alternatively,  the following approach could be used, which works for all the other  strategies as well: start each time step with a coarse mesh, keep refining  until happy with the result, and only then move on to the next time step.  &lt;/li&gt;    &lt;/ul&gt;  </div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;* Try implementing one of these strategies into this tutorial and observe thesubtle changes to the results. You will notice that all strategies arecapable of identifying the singularities near the reentrant corners andwill perform   @f$h@f$  -refinement in these regions, while preferring   @f$p@f$  -refinementin the bulk domain. <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> detailed comparison of these strategies is presentedin   @cite fehling2020   .</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;* </div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;* &lt;a name=&quot;Parallelhpadaptivefiniteelements&quot;&gt;&lt;/a&gt;&lt;h4&gt;Parallel <a class="code" href="namespacehp.html">hp</a>-adaptive finite elements&lt;/h4&gt;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;* </div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;* All functionality presented in this tutorial already works for bothsequential and <a class="code" href="namespaceparallel.html">parallel</a> applications. It is possible without too mucheffort to change to either the   <a class="code" href="classparallel_1_1shared_1_1Triangulation.html">parallel::shared::Triangulation</a>   or the  <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a>   classes. If you feel eager to tryit, we recommend reading   @ref step_18 &quot;step-18&quot;   for the former and   @ref step_40 &quot;step-40&quot;   for thelatter case <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> for further background information on the topic, andthen come back to this tutorial to try out your newly acquired skills.</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;* We go one step further in   @ref step_75 &quot;step-75&quot;  : Here, we combine <a class="code" href="namespacehp.html">hp</a>-adapative andMatrixFree methods in combination with  <a class="code" href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a>   objects.</div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;* </div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-27.cc&quot;  </div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;*</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;*/</div><div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="classunsigned_01int_html"><div class="ttname"><a href="classunsigned_01int.html">unsigned int</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="namespaceSmoothnessEstimator_1_1Fourier_html_a748faa704c9dfb67a074d11316e777b4"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Fourier.html#a748faa704c9dfb67a074d11316e777b4">SmoothnessEstimator::Fourier::default_fe_series</a></div><div class="ttdeci">FESeries::Fourier&lt; dim, spacedim &gt; default_fe_series(const hp::FECollection&lt; dim, spacedim &gt; &amp;fe_collection, const unsigned int component=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00579">smoothness_estimator.cc:579</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="namespaceinternal_html_a38181f4582ff69679bda7d8e31c37291"><div class="ttname"><a href="namespaceinternal.html#a38181f4582ff69679bda7d8e31c37291">internal::reinit</a></div><div class="ttdeci">void reinit(MatrixBlock&lt; MatrixType &gt; &amp;v, const BlockSparsityPattern &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="matrix__block_8h_source.html#l00575">matrix_block.h:575</a></div></div>
<div class="ttc" id="classFunction_html"><div class="ttname"><a href="classFunction.html">Function&lt; dim &gt;</a></div></div>
<div class="ttc" id="classhp_1_1FECollection_html"><div class="ttname"><a href="classhp_1_1FECollection.html">hp::FECollection</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__collection_8h_source.html#l00045">fe_collection.h:45</a></div></div>
<div class="ttc" id="classPreconditionSSOR_html_a7a3d66b17bb0ea1b16606e222474c2ea"><div class="ttname"><a href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">PreconditionSSOR::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const typename BaseClass::AdditionalData &amp;parameters=typename BaseClass::AdditionalData())</div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="classDynamicSparsityPattern_html"><div class="ttname"><a href="classDynamicSparsityPattern.html">DynamicSparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="dynamic__sparsity__pattern_8h_source.html#l00296">dynamic_sparsity_pattern.h:296</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="group__CPP11_html_ga4288670ae5bd80367e24918d542cb2d8"><div class="ttname"><a href="group__CPP11.html#ga4288670ae5bd80367e24918d542cb2d8">Triangulation::active_cell_iterators</a></div><div class="ttdeci">IteratorRange&lt; active_cell_iterator &gt; active_cell_iterators() const</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l12155">tria.cc:12155</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="namespaceSmoothnessEstimator_1_1Fourier_html_aae63069820e030e1f012e3e84d28e6f8"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Fourier.html#aae63069820e030e1f012e3e84d28e6f8">SmoothnessEstimator::Fourier::coefficient_decay</a></div><div class="ttdeci">void coefficient_decay(FESeries::Fourier&lt; dim, spacedim &gt; &amp;fe_fourier, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const VectorType &amp;solution, Vector&lt; float &gt; &amp;smoothness_indicators, const VectorTools::NormType regression_strategy=VectorTools::Linfty_norm, const double smallest_abs_coefficient=1e-10, const bool only_flagged_cells=false)</div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8cc_source.html#l00370">smoothness_estimator.cc:370</a></div></div>
<div class="ttc" id="classparallel_1_1shared_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1shared_1_1Triangulation.html">parallel::shared::Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="shared__tria_8h_source.html#l00070">shared_tria.h:70</a></div></div>
<div class="ttc" id="namespaceSmoothnessEstimator_1_1Fourier_html"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Fourier.html">SmoothnessEstimator::Fourier</a></div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8h_source.html#l00250">smoothness_estimator.h:250</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_a358d5bd545bc115c8645d93fa79b64bc"><div class="ttname"><a href="namespaceGridGenerator.html#a358d5bd545bc115c8645d93fa79b64bc">GridGenerator::subdivided_hyper_cube</a></div><div class="ttdeci">void subdivided_hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const unsigned int repetitions, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Divergence_html_a8bcfc37d2a2be8faa18628a601ecf112"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Divergence.html#a8bcfc37d2a2be8faa18628a601ecf112">LocalIntegrators::Divergence::norm</a></div><div class="ttdeci">double norm(const FEValuesBase&lt; dim &gt; &amp;fe, const ArrayView&lt; const std::vector&lt; Tensor&lt; 1, dim &gt;&gt;&gt; &amp;Du)</div><div class="ttdef"><b>Definition:</b> <a href="divergence_8h_source.html#l00462">divergence.h:462</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="classdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Advection_html_a8bc7b8136646134f73a4193adefe15f8"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">LocalIntegrators::Advection::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="advection_8h_source.html#l00063">advection.h:63</a></div></div>
<div class="ttc" id="namespaceSmoothnessEstimator_html"><div class="ttname"><a href="namespaceSmoothnessEstimator.html">SmoothnessEstimator</a></div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8h_source.html#l00065">smoothness_estimator.h:65</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="namespacehp_1_1Refinement_html_a4890d9eae896d749b103c8eec9c2029d"><div class="ttname"><a href="namespacehp_1_1Refinement.html#a4890d9eae896d749b103c8eec9c2029d">hp::Refinement::choose_p_over_h</a></div><div class="ttdeci">void choose_p_over_h(const ::DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler)</div><div class="ttdef"><b>Definition:</b> <a href="refinement_8cc_source.html#l00690">refinement.cc:690</a></div></div>
<div class="ttc" id="namespaceparallel_html"><div class="ttname"><a href="namespaceparallel.html">parallel</a></div><div class="ttdef"><b>Definition:</b> <a href="doc_2doxygen_2headers_2distributed_8h_source.html#l00150">distributed.h:150</a></div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">DoFTools::nonzero</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00161">dof_tools.h:161</a></div></div>
<div class="ttc" id="classFEValuesBase_html_ae41b67cfd48e02f6035e39c84f0fb47a"><div class="ttname"><a href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">FEValuesBase::get_quadrature_points</a></div><div class="ttdeci">const std::vector&lt; Point&lt; spacedim &gt; &gt; &amp; get_quadrature_points() const</div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classhp_1_1FEValues_html"><div class="ttname"><a href="classhp_1_1FEValues.html">hp::FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="hp_2fe__values_8h_source.html#l00274">fe_values.h:274</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="classTriangulation_html_ab9fa3177e0e43ab0cf243215d284a35a"><div class="ttname"><a href="classTriangulation.html#ab9fa3177e0e43ab0cf243215d284a35a">Triangulation::prepare_coarsening_and_refinement</a></div><div class="ttdeci">virtual bool prepare_coarsening_and_refinement()</div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8cc_source.html#l14102">tria.cc:14102</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="classFE__Q_html"><div class="ttname"><a href="classFE__Q.html">FE_Q</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__q_8h_source.html#l00554">fe_q.h:554</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html"><div class="ttname"><a href="classKellyErrorEstimator.html">KellyErrorEstimator</a></div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00131">error_estimator.h:131</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a1dd48cb744013c448d57f8f77640c08d"><div class="ttname"><a href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">FEValuesBase::shape_value</a></div><div class="ttdeci">const double &amp; shape_value(const unsigned int function_no, const unsigned int point_no) const</div></div>
<div class="ttc" id="classFEValues_html_a902429920d32c81c9c279d9a15faa263"><div class="ttname"><a href="classFEValues.html#a902429920d32c81c9c279d9a15faa263">FEValues::get_present_fe_values</a></div><div class="ttdeci">const FEValues&lt; dim, spacedim &gt; &amp; get_present_fe_values() const</div></div>
<div class="ttc" id="namespacehp_1_1Refinement_html_a9c96d6a85b38f120b5d7cf68126cded9"><div class="ttname"><a href="namespacehp_1_1Refinement.html#a9c96d6a85b38f120b5d7cf68126cded9">hp::Refinement::predict_error</a></div><div class="ttdeci">void predict_error(const ::DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const Vector&lt; Number &gt; &amp;error_indicators, Vector&lt; Number &gt; &amp;predicted_errors, const double gamma_p=std::sqrt(0.4), const double gamma_h=2., const double gamma_n=1.)</div><div class="ttdef"><b>Definition:</b> <a href="refinement_8cc_source.html#l00549">refinement.cc:549</a></div></div>
<div class="ttc" id="classPreconditionSSOR_html"><div class="ttname"><a href="classPreconditionSSOR.html">PreconditionSSOR</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00667">precondition.h:667</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a9082f945c1d289684d0bcd51ee08e11e"><div class="ttname"><a href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a></div><div class="ttdeci">unsigned int level</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04590">grid_out.cc:4590</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_ada140ece81bf38a23e738e0e57f89e97"><div class="ttname"><a href="namespaceGridGenerator.html#ada140ece81bf38a23e738e0e57f89e97">GridGenerator::create_triangulation_with_removed_cells</a></div><div class="ttdeci">void create_triangulation_with_removed_cells(const Triangulation&lt; dim, spacedim &gt; &amp;input_triangulation, const std::set&lt; typename Triangulation&lt; dim, spacedim &gt;::active_cell_iterator &gt; &amp;cells_to_remove, Triangulation&lt; dim, spacedim &gt; &amp;result)</div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="data__out__base_8cc_html_accc45da40beb7ae1b485306984e904a2"><div class="ttname"><a href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a></div><div class="ttdeci">Point&lt; 3 &gt; vertices[4]</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00175">data_out_base.cc:175</a></div></div>
<div class="ttc" id="classTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00092">data_out.h:92</a></div></div>
<div class="ttc" id="namespaceUtilities_html_a6195c5f009ea8c7c536c6ffdf108c32f"><div class="ttname"><a href="namespaceUtilities.html#a6195c5f009ea8c7c536c6ffdf108c32f">Utilities::int_to_string</a></div><div class="ttdeci">std::string int_to_string(const unsigned int value, const unsigned int digits=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="base_2utilities_8cc_source.html#l00473">utilities.cc:473</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceinternal_html_a2b3d48efdf7c94da455dc6a3553bab79"><div class="ttname"><a href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">internal::assemble</a></div><div class="ttdeci">void assemble(const MeshWorker::DoFInfoBox&lt; dim, DOFINFO &gt; &amp;dinfo, A *assembler)</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00073">loop.h:73</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="namespacehp_html"><div class="ttname"><a href="namespacehp.html">hp</a></div><div class="ttdef"><b>Definition:</b> <a href="doc_2doxygen_2headers_2hp_8h_source.html#l00075">hp.h:75</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html_ae2269e1c9903e9d863b7abd54948af00"><div class="ttname"><a href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator::estimate</a></div><div class="ttdeci">static void estimate(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim - 1 &gt; &amp;quadrature, const std::map&lt; types::boundary_id, const Function&lt; spacedim, typename InputVector::value_type &gt; *&gt; &amp;neumann_bc, const InputVector &amp;solution, Vector&lt; float &gt; &amp;error, const ComponentMask &amp;component_mask=ComponentMask(), const Function&lt; spacedim &gt; *coefficients=nullptr, const unsigned int n_threads=numbers::invalid_unsigned_int, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id, const types::material_id material_id=numbers::invalid_material_id, const Strategy strategy=cell_diameter_over_24)</div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a807c3049bfe81743fc0f237dfc2fbdea"><div class="ttname"><a href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">FEValuesBase::n_quadrature_points</a></div><div class="ttdeci">const unsigned int n_quadrature_points</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02027">fe_values.h:2027</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00158">lapack_support.h:158</a></div></div>
<div class="ttc" id="namespaceUtilities_html"><div class="ttname"><a href="namespaceUtilities.html">Utilities</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2communication__pattern__base_8h_source.html#l00031">communication_pattern_base.h:31</a></div></div>
<div class="ttc" id="namespaceSmoothnessEstimator_1_1Legendre_html"><div class="ttname"><a href="namespaceSmoothnessEstimator_1_1Legendre.html">SmoothnessEstimator::Legendre</a></div><div class="ttdef"><b>Definition:</b> <a href="smoothness__estimator_8h_source.html#l00084">smoothness_estimator.h:84</a></div></div>
<div class="ttc" id="namespaceVectorTools_html_af27ac28c698a9ed0199faed50a204538"><div class="ttname"><a href="namespaceVectorTools.html#af27ac28c698a9ed0199faed50a204538">VectorTools::interpolate_boundary_values</a></div><div class="ttdeci">void interpolate_boundary_values(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const std::map&lt; types::boundary_id, const Function&lt; spacedim, number &gt; *&gt; &amp;function_map, std::map&lt; types::global_dof_index, number &gt; &amp;boundary_values, const ComponentMask &amp;component_mask=ComponentMask())</div></div>
<div class="ttc" id="namespacehp_1_1Refinement_html_a54156dbe64e8eda42b2e964c9b1c0963"><div class="ttname"><a href="namespacehp_1_1Refinement.html#a54156dbe64e8eda42b2e964c9b1c0963">hp::Refinement::p_adaptivity_from_relative_threshold</a></div><div class="ttdeci">void p_adaptivity_from_relative_threshold(const ::DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const Vector&lt; Number &gt; &amp;criteria, const double p_refine_fraction=0.5, const double p_coarsen_fraction=0.5, const ComparisonFunction&lt; typename identity&lt; Number &gt;::type &gt; &amp;compare_refine=std::greater_equal&lt; Number &gt;(), const ComparisonFunction&lt; typename identity&lt; Number &gt;::type &gt; &amp;compare_coarsen=std::less_equal&lt; Number &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="refinement_8cc_source.html#l00150">refinement.cc:150</a></div></div>
<div class="ttc" id="classFEValuesBase_html_abade89efb068b71b7ced7082012a2441"><div class="ttname"><a href="classFEValuesBase.html#abade89efb068b71b7ced7082012a2441">FEValuesBase::JxW</a></div><div class="ttdeci">double JxW(const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="classDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="namespaceFESeries_html"><div class="ttname"><a href="namespaceFESeries.html">FESeries</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__series_8h_source.html#l00055">fe_series.h:55</a></div></div>
<div class="ttc" id="classFunctions_1_1ZeroFunction_html"><div class="ttname"><a href="classFunctions_1_1ZeroFunction.html">Functions::ZeroFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00444">function.h:444</a></div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00184">dof_handler.h:184</a></div></div>
<div class="ttc" id="classVector_html_ac4a4dbef7dd65ef8ad35ae56b57d7c05"><div class="ttname"><a href="classVector.html#ac4a4dbef7dd65ef8ad35ae56b57d7c05">Vector::reinit</a></div><div class="ttdeci">virtual void reinit(const size_type N, const bool omit_zeroing_entries=false)</div></div>
<div class="ttc" id="group__constraints_html_gaf78e864edbfba7e0a7477457bfb96b26"><div class="ttname"><a href="group__constraints.html#gaf78e864edbfba7e0a7477457bfb96b26">DoFTools::make_sparsity_pattern</a></div><div class="ttdeci">void make_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern, const AffineConstraints&lt; number &gt; &amp;constraints=AffineConstraints&lt; number &gt;(), const bool keep_constrained_dofs=true, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00064">dof_tools_sparsity.cc:64</a></div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00039">fe.h:39</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">LAPACKSupport::general</a></div><div class="ttdoc">No special properties. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00114">lapack_support.h:114</a></div></div>
<div class="ttc" id="data__out__base_8cc_html_a8188ef4709fc9a4cc076d37447783ba1"><div class="ttname"><a href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a></div><div class="ttdeci">Point&lt; 3 &gt; center</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00170">data_out_base.cc:170</a></div></div>
<div class="ttc" id="classFESeries_1_1Fourier_html"><div class="ttname"><a href="classFESeries_1_1Fourier.html">FESeries::Fourier</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__series_8h_source.html#l00073">fe_series.h:73</a></div></div>
<div class="ttc" id="classparallel_1_1distributed_1_1Triangulation_html"><div class="ttname"><a href="classparallel_1_1distributed_1_1Triangulation.html">parallel::distributed::Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="distributed_2tria_8h_source.html#l00180">tria.h:180</a></div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a46aefdb527125dafb59dcba92a0f256e"><div class="ttname"><a href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">FEValuesBase::shape_grad</a></div><div class="ttdeci">const Tensor&lt; 1, spacedim &gt; &amp; shape_grad(const unsigned int function_no, const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_a9e963546bd81b0cdd88e1840cfa8f227"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9e963546bd81b0cdd88e1840cfa8f227">Utilities::MPI::reduce</a></div><div class="ttdeci">T reduce(const T &amp;local_value, const MPI_Comm &amp;comm, const std::function&lt; T(const T &amp;, const T &amp;)&gt; &amp;combiner, const unsigned int root_process=0)</div></div>
<div class="ttc" id="namespacehp_1_1Refinement_html_a33d9d552f696d578da30dc9a83048670"><div class="ttname"><a href="namespacehp_1_1Refinement.html#a33d9d552f696d578da30dc9a83048670">hp::Refinement::limit_p_level_difference</a></div><div class="ttdeci">bool limit_p_level_difference(const ::DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const unsigned int max_difference=1, const unsigned int contains_fe_index=0)</div><div class="ttdef"><b>Definition:</b> <a href="refinement_8cc_source.html#l00804">refinement.cc:804</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1CUDA_html_afc505a095cc4c7600f65ecb99851312e"><div class="ttname"><a href="namespaceUtilities_1_1CUDA.html#afc505a095cc4c7600f65ecb99851312e">Utilities::CUDA::free</a></div><div class="ttdeci">void free(T *&amp;pointer)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2cuda_8h_source.html#l00107">cuda.h:107</a></div></div>
<div class="ttc" id="classint_html"><div class="ttname"><a href="classint.html">int</a></div></div>
<div class="ttc" id="namespaceinternal_1_1VectorOperations_html_a40c8daa0881cff0123fbaeb08929f5cb"><div class="ttname"><a href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">internal::VectorOperations::copy</a></div><div class="ttdeci">void copy(const T *begin, const T *end, U *dest)</div><div class="ttdef"><b>Definition:</b> <a href="vector__operations__internal_8h_source.html#l00069">vector_operations_internal.h:69</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a48e5395381ed87155942a61a1edd134d"><div class="ttname"><a href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a></div><div class="ttdeci">void refine_and_coarsen_fixed_number(Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Vector&lt; Number &gt; &amp;criteria, const double top_fraction_of_cells, const double bottom_fraction_of_cells, const unsigned int max_n_cells=std::numeric_limits&lt; unsigned int &gt;::max())</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00322">grid_refinement.cc:322</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a1cf30058b31ce7f9b389e8310bb9fc54"><div class="ttname"><a href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">GridRefinement::refine</a></div><div class="ttdeci">void refine(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold, const unsigned int max_to_mark=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00168">grid_refinement.cc:168</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="group__constraints_html_ga3b4ea7dfd313e388d868c4e4aa685799"><div class="ttname"><a href="group__constraints.html#ga3b4ea7dfd313e388d868c4e4aa685799">DoFTools::make_hanging_node_constraints</a></div><div class="ttdeci">void make_hanging_node_constraints(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, AffineConstraints&lt; number &gt; &amp;constraints)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__constraints_8cc_source.html#l01787">dof_tools_constraints.cc:1787</a></div></div>
<div class="ttc" id="namespaceDerivativeApproximation_1_1internal_html_a4bea05d5ab84ca1e802db9a0217d1d6c"><div class="ttname"><a href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">DerivativeApproximation::internal::approximate</a></div><div class="ttdeci">void approximate(SynchronousIterators&lt; std::tuple&lt; typename DoFHandler&lt; dim, spacedim &gt;::active_cell_iterator, Vector&lt; float &gt;::iterator &gt;&gt; const &amp;cell, const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const InputVector &amp;solution, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__approximation_8cc_source.html#l00918">derivative_approximation.cc:918</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
