<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-59_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-59.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-59.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-59_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; <span class="keyword">true</span>,</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, number&gt;::DataAccessOnFaces::gradients</a>,</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, number&gt;::DataAccessOnFaces::gradients</a>);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;   }</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;* </div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160; </div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;* </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;* </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;*  Since the Laplacian is <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">symmetric</a>, the `Tvmult()` (needed by the multigrid smoother interfaces) operation is simply forwarded to the `vmult()` <span class="keywordflow">case</span>.</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;* </div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;* </div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;*  </div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;* </div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;* @code</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> fe_degree, <span class="keyword">typename</span> number&gt;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;   <span class="keywordtype">void</span> LaplaceOperator&lt;dim, fe_degree, number&gt;::Tvmult(</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;number&gt;</a> &amp;      dst,</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;number&gt;</a> &amp;src)<span class="keyword"> const</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;     vmult(dst, src);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   }</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;* </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;* </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;* </div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;*  The cell operation is very similar to   @ref step_37 <span class="stringliteral">&quot;step-37&quot;</span>  . We <span class="keywordflow">do</span> not use a coefficient here, though. The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> difference is that we replaced the two steps of   <a class="code" href="classFEEvaluationBase.html#a5c3bf28ebceb0271addfba5b92f475ce">FEEvaluation::read_dof_values</a>()   followed by   <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::evaluate()   by a single function <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a>   <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::gather_evaluate()   which internally calls the sequence of the two individual methods. Likewise,   <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::integrate_scatter()   implements the sequence of   <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::integrate()   followed by   <a class="code" href="classFEEvaluation.html">FEEvaluation</a>::distribute_local_to_global().   In this case, these new <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> merely save two lines of code. However, we use them for the analogy with <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> where they are more important as explained below.</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;* </div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;* </div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;*  </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;* </div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;* @code</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;   template &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> fe_degree, typename number&gt;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;   <span class="keywordtype">void</span> LaplaceOperator&lt;dim, fe_degree, number&gt;::apply_cell(</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;     const <a class="code" href="classMatrixFree.html">MatrixFree</a>&lt;dim, number&gt; &amp;                   data,</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;     <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;number&gt; &amp;      dst,</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;     const <a class="code" href="namespaceLinearAlgebra.html">LinearAlgebra</a>::distributed::<a class="code" href="classVector.html">Vector</a>&lt;number&gt; &amp;src,</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;     const <a class="code" href="namespacestd.html">std</a>::pair&lt;<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>&gt; &amp;     cell_range)<span class="keyword"> const</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;     <a class="code" href="classFEEvaluation.html">FEEvaluation&lt;dim, fe_degree, fe_degree + 1, 1, number&gt;</a> phi(data);</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> = cell_range.first; <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> &lt; cell_range.second; ++<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>)</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;       {</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;         phi.reinit(<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>);</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;         phi.gather_evaluate(src, <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>);</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi.n_q_points; ++q)</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;           phi.submit_gradient(phi.get_gradient(q), q);</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         phi.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>, dst);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;       }</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;   }</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;* </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160; </div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;* </div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;* </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;*  The face operation implements the terms of the interior penalty method in analogy to   @ref step_39 <span class="stringliteral">&quot;step-39&quot;</span>  , as explained in the introduction. We need two evaluator objects <span class="keywordflow">for</span> <span class="keyword">this</span> task, <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keywordflow">for</span> handling the solution that comes from the <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> on <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> of the two sides of an interior face, and <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keywordflow">for</span> handling the solution from the other side. The evaluators <span class="keywordflow">for</span> face integrals are called <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> and take a <span class="keywordtype">boolean</span> argument in the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> slot of the constructor to indicate which of the two sides the evaluator should belong two. In <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> and <a class="code" href="classMatrixFree.html">MatrixFree</a>, we <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> of the two sides the `interior` <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> and the other the `exterior` <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>. The name `exterior` refers to the fact that the evaluator from both sides will <span class="keywordflow">return</span> the same normal vector. For the `interior` side, the normal vector points outwards, whereas it points inwards on the other side, and is opposed to the outer normal vector of that <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>. Apart from the <span class="keyword">new</span> <span class="keyword">class </span>name, we again get a range of items to work with in analogy to what was discussed in   @ref step_37 &quot;step-37&quot;  , but for the interior faces in this case. Note that the data structure of MatrixFree forms batches of faces that are analogous to the batches of cells for the <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> integrals. All faces within a batch involve different <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> <a class="code" href="namespacenumbers.html">numbers</a> but have the face number within the reference <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>, have the same refinement configuration (no refinement or the same subface), and the same orientation, to keep SIMD operations simple and efficient.   </div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;*   Note that there is no implied meaning in interior versus exterior except the logic decision of the orientation of the normal, which is pretty <a class="code" href="namespaceDoFRenumbering.html#abbd608826acd7c01f91db401a3728e25">random</a> internally. One can in no way rely on a certain pattern of assigning interior versus exterior flags, as the decision is made <span class="keywordflow">for</span> the sake of access regularity and uniformity in the MatrixFree setup routines. Since most sane DG methods are conservative, i.e., fluxes look the same from both sides of an interface, the mathematics are unaltered <span class="keywordflow">if</span> the interior/exterior flags are switched and normal vectors <span class="keyword">get</span> the opposite <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a>.</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;* </div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;* </div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;*  </div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;* </div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;* @code</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> fe_degree, <span class="keyword">typename</span> number&gt;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   <span class="keywordtype">void</span> LaplaceOperator&lt;dim, fe_degree, number&gt;::apply_face(</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, number&gt;</a> &amp;                   data,</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;number&gt;</a> &amp;      dst,</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;number&gt;</a> &amp;src,</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, fe_degree, fe_degree + 1, 1, number&gt;</a> phi_inner(data,</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                                                          <span class="keyword">true</span>);</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, fe_degree, fe_degree + 1, 1, number&gt;</a> phi_outer(data,</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;                                                                          <span class="keyword">false</span>);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = face_range.first; face &lt; face_range.second; ++face)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;       {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;* </div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;*  On a given batch of faces, we <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> update the pointers to the current face and then access the vector. As mentioned above, we combine the vector access with the evaluation. In the <span class="keywordflow">case</span> of face integrals, the data access into the vector can be reduced <span class="keywordflow">for</span> the special <span class="keywordflow">case</span> of an <a class="code" href="classFE__DGQHermite.html">FE_DGQHermite</a> basis as explained <span class="keywordflow">for</span> the data exchange above: Since only   @f$2(k+1)^{<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>-1}@f$   out of the   @f$(k+1)^<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>@f$   <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> degrees of freedom <span class="keyword">get</span> multiplied by a non-<a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> value or derivative of a shape <span class="keyword">function</span>, <span class="keyword">this</span> structure can be utilized <span class="keywordflow">for</span> the evaluation, significantly reducing the data access. The <a class="code" href="group__CUDAWrappers.html#ga63ba304711678353aa10eb65caed2967">reduction</a> of the data access is not only beneficial because it reduces the data in flight and thus helps caching, but also because the data access to faces is often more irregular than <span class="keywordflow">for</span> <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> integrals when gathering <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> from cells that are farther apart in the index list of cells.</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;* </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;* </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;* @code</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;         phi_inner.reinit(face);</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;         phi_inner.gather_evaluate(src,</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                   <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> |</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                                     <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;         phi_outer.reinit(face);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;         phi_outer.gather_evaluate(src,</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                   <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> |</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                                     <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;* </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;* </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;*  The next two statements compute the penalty parameter <span class="keywordflow">for</span> the interior penalty method. As explained in the introduction, we would like to have a scaling like   @f$\frac{1}{h_\text{i}}@f$   of the length   @f$h_\text{i}@f$   normal to the face. For a <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> non-Cartesian mesh, <span class="keyword">this</span> length must be computed by the product of the inverse Jacobian times the normal vector in real coordinates. From <span class="keyword">this</span> vector of `dim` components, we must <span class="keywordflow">finally</span> pick the component that is oriented normal to the reference <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a>. In the geometry data stored in MatrixFree, a permutation of the components in the Jacobian is applied such that <span class="keyword">this</span> latter direction is <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> the last component `dim-1` (<span class="keyword">this</span> is beneficial because reference-<a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> derivative sorting can be made agnostic of the direction of the face). This means that we can simply access the last entry `dim-1` and must not look up the local face number in `data.<a class="code" href="classMatrixFree.html#aa13157af74893593d4af73a30b01a74b">get_face_info</a>(face).interior_face_no` and `data.<a class="code" href="classMatrixFree.html#aa13157af74893593d4af73a30b01a74b">get_face_info</a>(face).exterior_face_no`. Finally, we must also take the absolute <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> of these factors as the normal could <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> into either positive or negative direction.</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;* </div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;* </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;* @code</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;         <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> inverse_length_normal_to_face =</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;           0.5 (<a class="code" href="vectorization_8h.html#aafbdfdd72b6cfe4eae5fa7a16385582f">std::abs</a>((phi_inner.get_normal_vector(0)</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                            phi_inner.inverse_jacobian(0))[dim</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;* </div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;- 1]) +</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                  <a class="code" href="vectorization_8h.html#aafbdfdd72b6cfe4eae5fa7a16385582f">std::abs</a>((phi_outer.get_normal_vector(0)</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                            phi_outer.inverse_jacobian(0))[dim</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;* </div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;- 1]));</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;         <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> sigma =</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;           inverse_length_normal_to_face get_penalty_factor();</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;* </div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;* </div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;*  In the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over the quadrature points, we eventually compute all contributions to the interior penalty scheme. According to the formulas in the introduction, the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> of the test <span class="keyword">function</span> gets multiplied by the difference of the jump in the solution times the penalty parameter and the average of the normal derivative in real space. Since the two evaluators <span class="keywordflow">for</span> interior and exterior sides <span class="keyword">get</span> different signs due to the jump, we pass the result with a different <a class="code" href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">sign</a> here. The normal derivative of the test <span class="keyword">function</span> gets multiplied by the negative jump in the solution between the interior and exterior side. This term, coined adjoint consistency term, must also include the factor of   @f$\frac{1}{2}@f$   in the code in accordance with its relation to the primal consistency term that gets the factor of <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> half due to the average in the test <span class="keyword">function</span> slot.</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;* </div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;* </div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;* @code</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_inner.n_q_points; ++q)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;           {</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> solution_jump =</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;               (phi_inner.get_value(q)</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;* </div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;- phi_outer.get_value(q));</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> average_normal_derivative =</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;               (phi_inner.get_normal_derivative(q) +</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                phi_outer.get_normal_derivative(q))</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;               number(0.5);</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> test_by_value =</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;               solution_jump sigma</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;* </div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;- average_normal_derivative;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;* </div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;             phi_inner.submit_value(test_by_value, q);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;             phi_outer.submit_value(-test_by_value, q);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;* </div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;             phi_inner.submit_normal_derivative(-solution_jump number(0.5), q);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;             phi_outer.submit_normal_derivative(-solution_jump number(0.5), q);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;           }</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;* </div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;* </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;*  Once we are done with the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over quadrature points, we can <span class="keywordflow">do</span> the <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">sum</a> factorization operations <span class="keywordflow">for</span> the integration loops on faces and <a class="code" href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">sum</a> the results into the result vector, <span class="keyword">using</span> the `<a class="code" href="classFEEvaluation.html#a491779be7bd032d277e41f1dda8dc584">integrate_scatter</a>` <span class="keyword">function</span>. The name `scatter` reflects the distribution of the vector data into scattered positions in the vector <span class="keyword">using</span> the same pattern as in `<a class="code" href="classFEEvaluation.html#ab53d5c08f460cfe6c9830ac14a427115">gather_evaluate</a>`. Like before, the combined <a class="code" href="classFEEvaluation.html#ad61cbe0d7d6138be040d46ae06a268f1">integrate</a> + write operation allows us to <a class="code" href="namespaceUtilities_1_1MPI.html#a9e963546bd81b0cdd88e1840cfa8f227">reduce</a> the data access.</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;* </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;* </div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;* @code</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         phi_inner.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> |</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                       <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>,</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                                     dst);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;         phi_outer.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> |</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                       <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                     dst);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;       }</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;   }</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;* </div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;* </div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;* </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;*  The boundary face <span class="keyword">function</span> follows by and large the interior face <span class="keyword">function</span>. The only difference is the fact that we <span class="keywordflow">do</span> not have a separate <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation</a> <span class="keywordtype">object</span> that provides us with exterior <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>   @f$u^+@f$  , but we must define them from the boundary conditions and interior <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>   @f$u^-@f$  . As explained in the introduction, we use   @f$u^+ =</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;* </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;-u^- + 2</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; g_\text{D}@f$   and   @f$\mathbf{n}^-\cdot \nabla u^+ = \mathbf{n}^-\cdot \nabla</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; u^-@f$   on Dirichlet boundaries and   @f$u^+=u^-@f$   and   @f$\mathbf{n}^-\cdot \nabla</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160; u^+ =</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;* </div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;-\mathbf{n}^-\cdot \nabla u^- + 2 g_\text{<a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>}@f$   on Neumann boundaries. Since <span class="keyword">this</span> operation implements the homogeneous part, i.e., the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>-vector product, we must neglect the boundary <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a>   @f$g_\text{D}@f$   and   @f$g_\text{<a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>}@f$   here, and added them to the right hand side in   `LaplaceProblem::compute_rhs()`.   Note that due to extension of the solution   @f$u^-@f$   to the exterior via   @f$u^+@f$  , we can keep all factors   @f$0.5@f$   the same as in the inner face <span class="keyword">function</span>, see also the discussion in   @ref step_39 <span class="stringliteral">&quot;step-39&quot;</span>  .   </div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;*   There is <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> <span class="keywordflow">catch</span> at <span class="keyword">this</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>: The implementation below uses a <span class="keywordtype">boolean</span> variable `is_dirichlet` to <span class="keywordflow">switch</span> between the Dirichlet and the Neumann cases. However, we solve a problem where we also want to impose periodic boundary conditions on some boundaries, namely along those in the   @f$x@f$   direction. One might wonder how those conditions should be handled here. The answer is that MatrixFree automatically treats periodic boundaries as what they are technically, namely an inner face where the solution <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of two adjacent cells meet and must be treated by proper numerical fluxes. Thus, all the faces on the periodic boundaries will appear in the `apply_face()` <span class="keyword">function</span> and not in <span class="keyword">this</span> <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>.</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;* </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;* </div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;*  </div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;* </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;* @code</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim, <span class="keywordtype">int</span> fe_degree, <span class="keyword">typename</span> number&gt;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;   <span class="keywordtype">void</span> LaplaceOperator&lt;dim, fe_degree, number&gt;::apply_boundary(</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     <span class="keyword">const</span> <a class="code" href="classMatrixFree.html">MatrixFree&lt;dim, number&gt;</a> &amp;                   data,</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;number&gt;</a> &amp;      dst,</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;     <span class="keyword">const</span> <a class="code" href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector&lt;number&gt;</a> &amp;src,</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     <span class="keyword">const</span> std::pair&lt;unsigned int, unsigned int&gt; &amp;     face_range)<span class="keyword"> const</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;     <a class="code" href="classFEFaceEvaluation.html">FEFaceEvaluation&lt;dim, fe_degree, fe_degree + 1, 1, number&gt;</a> phi_inner(data,</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                                          <span class="keyword">true</span>);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = face_range.first; face &lt; face_range.second; ++face)</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;       {</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;         phi_inner.reinit(face);</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;         phi_inner.gather_evaluate(src,</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                                   <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> |</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                                     <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;* </div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;         <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> inverse_length_normal_to_face =</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;           <a class="code" href="vectorization_8h.html#aafbdfdd72b6cfe4eae5fa7a16385582f">std::abs</a>((phi_inner.get_normal_vector(0)</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                     phi_inner.inverse_jacobian(0))[dim</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;* </div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;- 1]);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;         <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> sigma =</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;           inverse_length_normal_to_face get_penalty_factor();</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;* </div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">bool</span> is_dirichlet = (data.<a class="code" href="classMatrixFree.html#a94c875be0229e4872a3e087a55410625">get_boundary_id</a>(face) == 0);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;* </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q = 0; q &lt; phi_inner.n_q_points; ++q)</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;           {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> u_inner = phi_inner.get_value(q);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> u_outer =</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;               is_dirichlet ?</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;* </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;-u_inner : u_inner;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> normal_derivative_inner =</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;               phi_inner.get_normal_derivative(q);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> normal_derivative_outer =</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;               is_dirichlet ? normal_derivative_inner :</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;* </div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;-normal_derivative_inner;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> solution_jump = (u_inner</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;* </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;- u_outer);</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> average_normal_derivative =</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;               (normal_derivative_inner + normal_derivative_outer) number(0.5);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;             <span class="keyword">const</span> <a class="code" href="classVectorizedArray.html">VectorizedArray&lt;number&gt;</a> test_by_value =</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;               solution_jump sigma</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;* </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;- average_normal_derivative;</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;             phi_inner.submit_normal_derivative(-solution_jump number(0.5), q);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;             phi_inner.submit_value(test_by_value, q);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;           }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;         phi_inner.integrate_scatter(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a> |</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                                       <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a>,</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;                                     dst);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;       }</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;   }</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;* </div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;* </div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;* </div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;*  Next we turn to the preconditioner initialization. As explained in the introduction, we want to construct an (<a class="code" href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">approximate</a>) inverse of the <a class="code" href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">cell</a> matrices from a product of 1D mass and Laplace matrices. Our <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> task is to compute the 1D matrices, which we <span class="keywordflow">do</span> by <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> creating a 1D finite element. Instead of anticipating <a class="code" href="classFE__DGQHermite.html">FE_DGQHermite&lt;1&gt;</a> here, we <span class="keyword">get</span> the finite element<span class="stringliteral">&#39;s name from DoFHandler, replace the   @p dim   argument (2 or 3) by 1 to create a 1D name, and construct the 1D element by using FETools.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree, typename number&gt;</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral">   void PreconditionBlockJacobi&lt;dim, fe_degree, number&gt;::initialize(</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral">     const LaplaceOperator&lt;dim, fe_degree, number&gt; &amp;op)</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">     data = op.get_matrix_free();</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral">     std::string name = data-&gt;get_dof_handler().get_fe().get_name();</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">     name.replace(name.find(&#39;</span>&lt;<span class="stringliteral">&#39;) + 1, 1, &quot;1&quot;);</span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">     std::unique_ptr&lt;FiniteElement&lt;1&gt;&gt; fe_1d = FETools::get_fe_by_name&lt;1&gt;(name);</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">*  As for computing the 1D matrices on the unit element, we simply write down what a typical assembly procedure over rows and columns of the matrix as well as the quadrature points would do. We select the same Laplace matrices once and for all using the coefficients 0.5 for interior faces (but possibly scaled differently in different directions as a result of the mesh). Thus, we make a slight mistake at the Dirichlet boundary (where the correct factor would be 1 for the derivative terms and 2 for the penalty term, see   @ref step_39 &quot;step-39&quot;  ) or at the Neumann boundary where the factor should be zero. Since we only use this class as a smoother inside a multigrid scheme, this error is not going to have any significant effect and merely affects smoothing quality.</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="stringliteral">     const unsigned int                                 N = fe_degree + 1;</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="stringliteral">     FullMatrix&lt;double&gt;                                 laplace_unscaled(N, N);</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="stringliteral">     std::array&lt;Table&lt;2, VectorizedArray&lt;number&gt;&gt;, dim&gt; mass_matrices;</span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="stringliteral">     std::array&lt;Table&lt;2, VectorizedArray&lt;number&gt;&gt;, dim&gt; laplace_matrices;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="stringliteral">     for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="stringliteral">         mass_matrices[d].reinit(N, N);</span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="stringliteral">         laplace_matrices[d].reinit(N, N);</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="stringliteral">     QGauss&lt;1&gt; quadrature(N);</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="stringliteral">     for (unsigned int i = 0; i &lt; N; ++i)</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="stringliteral">       for (unsigned int j = 0; j &lt; N; ++j)</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral">         {</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral">           double sum_mass = 0, sum_laplace = 0;</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="stringliteral">           for (unsigned int q = 0; q &lt; quadrature.size(); ++q)</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="stringliteral">             {</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="stringliteral">               sum_mass += (fe_1d-&gt;shape_value(i, quadrature.point(q))</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="stringliteral">                            fe_1d-&gt;shape_value(j, quadrature.point(q)))</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="stringliteral">                           quadrature.weight(q);</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="stringliteral">               sum_laplace += (fe_1d-&gt;shape_grad(i, quadrature.point(q))[0]</span></div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="stringliteral">                               fe_1d-&gt;shape_grad(j, quadrature.point(q))[0])</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="stringliteral">                              quadrature.weight(q);</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="stringliteral">             }</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="stringliteral">           for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="stringliteral">             mass_matrices[d](i, j) = sum_mass;</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="stringliteral">*  The left and right boundary terms assembled by the next two statements appear to have somewhat arbitrary signs, but those are correct as can be verified by looking at   @ref step_39 &quot;step-39&quot;   and inserting the value</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="stringliteral">*  -  and 1 for the normal vector in the 1D case.</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="stringliteral">           sum_laplace +=</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="stringliteral">             (1. fe_1d-&gt;shape_value(i, Point&lt;1&gt;())</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="stringliteral">                fe_1d-&gt;shape_value(j, Point&lt;1&gt;()) op.get_penalty_factor() +</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="stringliteral">              0.5 fe_1d-&gt;shape_grad(i, Point&lt;1&gt;())[0]</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="stringliteral">                fe_1d-&gt;shape_value(j, Point&lt;1&gt;()) +</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="stringliteral">              0.5 fe_1d-&gt;shape_grad(j, Point&lt;1&gt;())[0]</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="stringliteral">                fe_1d-&gt;shape_value(i, Point&lt;1&gt;()));</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="stringliteral">           sum_laplace +=</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">             (1. fe_1d-&gt;shape_value(i, Point&lt;1&gt;(1.0))</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="stringliteral">                fe_1d-&gt;shape_value(j, Point&lt;1&gt;(1.0)) op.get_penalty_factor()</span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="stringliteral">-</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="stringliteral">              0.5 fe_1d-&gt;shape_grad(i, Point&lt;1&gt;(1.0))[0]</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="stringliteral">                fe_1d-&gt;shape_value(j, Point&lt;1&gt;(1.0))</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;<span class="stringliteral">-</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="stringliteral">              0.5 fe_1d-&gt;shape_grad(j, Point&lt;1&gt;(1.0))[0]</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;<span class="stringliteral">                fe_1d-&gt;shape_value(i, Point&lt;1&gt;(1.0)));</span></div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="stringliteral">           laplace_unscaled(i, j) = sum_laplace;</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="stringliteral">*  Next, we go through the cells and pass the scaled matrices to TensorProductMatrixSymmetricSum to actually compute the generalized eigenvalue problem for representing the inverse: Since the matrix approximation is constructed as   @f$A\otimes M + M\otimes A@f$   and the weights are constant for each element, we can apply all weights on the Laplace matrix and simply keep the mass matrices unscaled. In the loop over cells, we want to make use of the geometry compression provided by the MatrixFree class and check if the current geometry is the same as on the last cell batch, in which case there is nothing to do. This compression can be accessed by   FEEvaluation::get_mapping_data_index_offset()   once `reinit()` has been called.     </span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;<span class="stringliteral">*   Once we have accessed the inverse Jacobian through the FEEvaluation access function (we take the one for the zeroth quadrature point as they should be the same on all quadrature points for a Cartesian cell), we check that it is diagonal and then extract the determinant of the original Jacobian, i.e., the inverse of the determinant of the inverse Jacobian, and set the weight as   @f$\text{det}(J) / h_d^2@f$   according to the 1D Laplacian times   @f$d-1@f$   copies of the mass matrix.</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;<span class="stringliteral">     cell_matrices.clear();</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;<span class="stringliteral">     FEEvaluation&lt;dim, fe_degree, fe_degree + 1, 1, number&gt; phi(*data);</span></div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;<span class="stringliteral">     unsigned int old_mapping_data_index = numbers::invalid_unsigned_int;</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="stringliteral">     for (unsigned int cell = 0; cell &lt; data-&gt;n_cell_batches(); ++cell)</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="stringliteral">         phi.reinit(cell);</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;<span class="stringliteral">         if (phi.get_mapping_data_index_offset() == old_mapping_data_index)</span></div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="stringliteral">           continue;</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;<span class="stringliteral">         Tensor&lt;2, dim, VectorizedArray&lt;number&gt;&gt; inverse_jacobian =</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;<span class="stringliteral">           phi.inverse_jacobian(0);</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;<span class="stringliteral">         for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="stringliteral">           for (unsigned int e = 0; e &lt; dim; ++e)</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;<span class="stringliteral">             if (d != e)</span></div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="stringliteral">               for (unsigned int v = 0; v &lt; VectorizedArray&lt;number&gt;::size(); ++v)</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;<span class="stringliteral">                 AssertThrow(inverse_jacobian[d][e][v] == 0.,</span></div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;<span class="stringliteral">                             ExcNotImplemented());</span></div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;<span class="stringliteral">         VectorizedArray&lt;number&gt; jacobian_determinant = inverse_jacobian[0][0];</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;<span class="stringliteral">         for (unsigned int e = 1; e &lt; dim; ++e)</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;<span class="stringliteral">           jacobian_determinant= inverse_jacobian[e][e];</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;<span class="stringliteral">         jacobian_determinant = 1. / jacobian_determinant;</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;<span class="stringliteral">         for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;<span class="stringliteral">             const VectorizedArray&lt;number&gt; scaling_factor =</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="stringliteral">               inverse_jacobian[d][d] inverse_jacobian[d][d]</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="stringliteral">               jacobian_determinant;</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;<span class="stringliteral">*  Once we know the factor by which we should scale the Laplace matrix, we apply this weight to the unscaled DG Laplace matrix and send the array to the class TensorProductMatrixSymmetricSum for computing the generalized eigenvalue problem mentioned in the introduction.</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;<span class="stringliteral">             for (unsigned int i = 0; i &lt; N; ++i)</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="stringliteral">               for (unsigned int j = 0; j &lt; N; ++j)</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;<span class="stringliteral">                 laplace_matrices[d](i, j) =</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;<span class="stringliteral">                   scaling_factor laplace_unscaled(i, j);</span></div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;<span class="stringliteral">         if (cell_matrices.size() &lt;= phi.get_mapping_data_index_offset())</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="stringliteral">           cell_matrices.resize(phi.get_mapping_data_index_offset() + 1);</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;<span class="stringliteral">         cell_matrices[phi.get_mapping_data_index_offset()].reinit(</span></div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="stringliteral">           mass_matrices, laplace_matrices);</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;<span class="stringliteral">*  The vmult function for the approximate block-Jacobi preconditioner is very simple in the DG context: We simply need to read the values of the current cell batch, apply the inverse for the given entry in the array of tensor product matrix, and write the result back. In this loop, we overwrite the content in `dst` rather than first setting the entries to zero. This is legitimate for a DG method because every cell has independent degrees of freedom. Furthermore, we manually write out the loop over all cell batches, rather than going through   MatrixFree::cell_loop().   We do this because we know that we are not going to need data exchange over the MPI network here as all computations are done on the cells held locally on each processor.</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree, typename number&gt;</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;<span class="stringliteral">   void PreconditionBlockJacobi&lt;dim, fe_degree, number&gt;::vmult(</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;<span class="stringliteral">     LinearAlgebra::distributed::Vector&lt;number&gt; &amp;      dst,</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;<span class="stringliteral">     const LinearAlgebra::distributed::Vector&lt;number&gt; &amp;src) const</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;<span class="stringliteral">     adjust_ghost_range_if_necessary(*data, dst);</span></div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;<span class="stringliteral">     adjust_ghost_range_if_necessary(*data, src);</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">     FEEvaluation&lt;dim, fe_degree, fe_degree + 1, 1, number&gt; phi(*data);</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;<span class="stringliteral">     for (unsigned int cell = 0; cell &lt; data-&gt;n_cell_batches(); ++cell)</span></div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="stringliteral">         phi.reinit(cell);</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;<span class="stringliteral">         phi.read_dof_values(src);</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;<span class="stringliteral">         cell_matrices[phi.get_mapping_data_index_offset()].apply_inverse(</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">           ArrayView&lt;VectorizedArray&lt;number&gt;&gt;(phi.begin_dof_values(),</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;<span class="stringliteral">                                              phi.dofs_per_cell),</span></div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;<span class="stringliteral">           ArrayView&lt;const VectorizedArray&lt;number&gt;&gt;(phi.begin_dof_values(),</span></div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;<span class="stringliteral">                                                    phi.dofs_per_cell));</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;<span class="stringliteral">         phi.set_dof_values(dst);</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">*  The definition of the LaplaceProblem class is very similar to   @ref step_37 &quot;step-37&quot;  . One difference is the fact that we add the element degree as a template argument to the class, which would allow us to more easily include more than one degree in the same program by creating different instances in the `main()` function. The second difference is the selection of the element, FE_DGQHermite, which is specialized for this kind of equations.</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="stringliteral">   class LaplaceProblem</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;<span class="stringliteral">   public:</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="stringliteral">     LaplaceProblem();</span></div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="stringliteral">     void run();</span></div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;<span class="stringliteral">   private:</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;<span class="stringliteral">     void setup_system();</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;<span class="stringliteral">     void compute_rhs();</span></div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;<span class="stringliteral">     void solve();</span></div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;<span class="stringliteral">     void analyze_results() const;</span></div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;<span class="stringliteral"> #ifdef DEAL_II_WITH_P4EST</span></div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;<span class="stringliteral">     parallel::distributed::Triangulation&lt;dim&gt; triangulation;</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;<span class="stringliteral"> #else</span></div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;<span class="stringliteral">     Triangulation&lt;dim&gt; triangulation;</span></div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="stringliteral"> #endif</span></div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;<span class="stringliteral">     FE_DGQHermite&lt;dim&gt; fe;</span></div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="stringliteral">     DoFHandler&lt;dim&gt;    dof_handler;</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;<span class="stringliteral">     MappingQ1&lt;dim&gt; mapping;</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="stringliteral">     using SystemMatrixType = LaplaceOperator&lt;dim, fe_degree, double&gt;;</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="stringliteral">     SystemMatrixType system_matrix;</span></div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;<span class="stringliteral">     using LevelMatrixType = LaplaceOperator&lt;dim, fe_degree, float&gt;;</span></div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;<span class="stringliteral">     MGLevelObject&lt;LevelMatrixType&gt; mg_matrices;</span></div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="stringliteral">     LinearAlgebra::distributed::Vector&lt;double&gt; solution;</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;<span class="stringliteral">     LinearAlgebra::distributed::Vector&lt;double&gt; system_rhs;</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;<span class="stringliteral">     double             setup_time;</span></div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;<span class="stringliteral">     ConditionalOStream pcout;</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="stringliteral">     ConditionalOStream time_details;</span></div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;<span class="stringliteral">   };</span></div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;<span class="stringliteral">   LaplaceProblem&lt;dim, fe_degree&gt;::LaplaceProblem()</span></div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;<span class="stringliteral">     :</span></div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;<span class="stringliteral"> #ifdef DEAL_II_WITH_P4EST</span></div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;<span class="stringliteral">     triangulation(</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;<span class="stringliteral">       MPI_COMM_WORLD,</span></div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;<span class="stringliteral">       Triangulation&lt;dim&gt;::limit_level_difference_at_vertices,</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;<span class="stringliteral">       parallel::distributed::Triangulation&lt;dim&gt;::construct_multigrid_hierarchy)</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;<span class="stringliteral">     ,</span></div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<span class="stringliteral"> #else</span></div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<span class="stringliteral">     triangulation(Triangulation&lt;dim&gt;::limit_level_difference_at_vertices)</span></div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<span class="stringliteral">     ,</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="stringliteral"> #endif</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="stringliteral">     fe(fe_degree)</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="stringliteral">     , dof_handler(triangulation)</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="stringliteral">     , setup_time(0.)</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="stringliteral">     , pcout(std::cout, Utilities::MPI::this_mpi_process(MPI_COMM_WORLD) == 0)</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="stringliteral">     , time_details(std::cout,</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="stringliteral">                    false &amp;&amp;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">                      Utilities::MPI::this_mpi_process(MPI_COMM_WORLD) == 0)</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="stringliteral">   {}</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="stringliteral">*  The setup function differs in two aspects from   @ref step_37 &quot;step-37&quot;  . The first is that we do not need to interpolate any constraints for the discontinuous ansatz space, and simply pass a dummy AffineConstraints object into   Matrixfree::reinit().   The second change arises because we need to tell MatrixFree to also initialize the data structures for faces. We do this by setting update flags for the inner and boundary faces, respectively. On the boundary faces, we need both the function values, their gradients, JxW values (for integration), the normal vectors, and quadrature points (for the evaluation of the boundary conditions), whereas we only need shape function values, gradients, JxW values, and normal vectors for interior faces. The face data structures in MatrixFree are always built as soon as one of `mapping_update_flags_inner_faces` or `mapping_update_flags_boundary_faces` are different from the default value `update_default` of UpdateFlags.</span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="stringliteral">   void LaplaceProblem&lt;dim, fe_degree&gt;::setup_system()</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="stringliteral">     Timer time;</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="stringliteral">     setup_time = 0;</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="stringliteral">     system_matrix.clear();</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="stringliteral">     mg_matrices.clear_elements();</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="stringliteral">     dof_handler.distribute_dofs(fe);</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral">     dof_handler.distribute_mg_dofs();</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral">     pcout &lt;&lt; &quot;Number of degrees of freedom: &quot; &lt;&lt; dof_handler.n_dofs()</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="stringliteral">           &lt;&lt; std::endl;</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="stringliteral">     setup_time += time.wall_time();</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="stringliteral">     time_details &lt;&lt; &quot;Distribute DoFs               &quot; &lt;&lt; time.wall_time() &lt;&lt; &quot; s&quot;</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="stringliteral">                  &lt;&lt; std::endl;</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="stringliteral">     time.restart();</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="stringliteral">     AffineConstraints&lt;double&gt; dummy;</span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="stringliteral">     dummy.close();</span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="stringliteral">       typename MatrixFree&lt;dim, double&gt;::AdditionalData additional_data;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="stringliteral">       additional_data.tasks_parallel_scheme =</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="stringliteral">         MatrixFree&lt;dim, double&gt;::AdditionalData::none;</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="stringliteral">       additional_data.mapping_update_flags =</span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="stringliteral">         (update_gradients | update_JxW_values | update_quadrature_points);</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="stringliteral">       additional_data.mapping_update_flags_inner_faces =</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="stringliteral">         (update_gradients | update_JxW_values | update_normal_vectors);</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="stringliteral">       additional_data.mapping_update_flags_boundary_faces =</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="stringliteral">         (update_gradients | update_JxW_values | update_normal_vectors |</span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="stringliteral">          update_quadrature_points);</span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral">       const auto system_mf_storage =</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral">         std::make_shared&lt;MatrixFree&lt;dim, double&gt;&gt;();</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="stringliteral">       system_mf_storage-&gt;reinit(</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="stringliteral">         mapping, dof_handler, dummy, QGauss&lt;1&gt;(fe.degree + 1), additional_data);</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="stringliteral">       system_matrix.initialize(system_mf_storage);</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="stringliteral">     system_matrix.initialize_dof_vector(solution);</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="stringliteral">     system_matrix.initialize_dof_vector(system_rhs);</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral">     setup_time += time.wall_time();</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral">     time_details &lt;&lt; &quot;Setup matrix-free system      &quot; &lt;&lt; time.wall_time() &lt;&lt; &quot; s&quot;</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="stringliteral">                  &lt;&lt; std::endl;</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">     time.restart();</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="stringliteral">     const unsigned int nlevels = triangulation.n_global_levels();</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="stringliteral">     mg_matrices.resize(0, nlevels</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="stringliteral">- 1);</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="stringliteral">     for (unsigned int level = 0; level &lt; nlevels; ++level)</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">         typename MatrixFree&lt;dim, float&gt;::AdditionalData additional_data;</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral">         additional_data.tasks_parallel_scheme =</span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral">           MatrixFree&lt;dim, float&gt;::AdditionalData::none;</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="stringliteral">         additional_data.mapping_update_flags =</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="stringliteral">           (update_gradients | update_JxW_values);</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="stringliteral">         additional_data.mapping_update_flags_inner_faces =</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral">           (update_gradients | update_JxW_values);</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral">         additional_data.mapping_update_flags_boundary_faces =</span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="stringliteral">           (update_gradients | update_JxW_values);</span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="stringliteral">         additional_data.mg_level = level;</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="stringliteral">         const auto mg_mf_storage_level =</span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="stringliteral">           std::make_shared&lt;MatrixFree&lt;dim, float&gt;&gt;();</span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="stringliteral">         mg_mf_storage_level-&gt;reinit(mapping,</span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="stringliteral">                                     dof_handler,</span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="stringliteral">                                     dummy,</span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="stringliteral">                                     QGauss&lt;1&gt;(fe.degree + 1),</span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="stringliteral">                                     additional_data);</span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="stringliteral">         mg_matrices[level].initialize(mg_mf_storage_level);</span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="stringliteral">     setup_time += time.wall_time();</span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="stringliteral">     time_details &lt;&lt; &quot;Setup matrix-free levels      &quot; &lt;&lt; time.wall_time() &lt;&lt; &quot; s&quot;</span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="stringliteral">                  &lt;&lt; std::endl;</span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">*  The computation of the right hand side is a bit more complicated than in   @ref step_37 &quot;step-37&quot;  . The cell term now consists of the negative Laplacian of the analytical solution, `RightHandSide`, for which we need to first split up the Point of VectorizedArray fields, i.e., a batch of points, into a single point by evaluating all lanes in the VectorizedArray separately. Remember that the number of lanes depends on the hardware; it could be 1 for systems that do not offer vectorization (or where deal.II does not have intrinsics), but it could also be 8 or 16 on AVX-512 of recent Intel architectures.</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="stringliteral">   void LaplaceProblem&lt;dim, fe_degree&gt;::compute_rhs()</span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral">     Timer time;</span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="stringliteral">     system_rhs                          = 0;</span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="stringliteral">     const MatrixFree&lt;dim, double&gt; &amp;data =system_matrix.get_matrix_free();</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="stringliteral">     FEEvaluation&lt;dim, fe_degree&gt;   phi(data);</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="stringliteral">     RightHandSide&lt;dim&gt;             rhs_func;</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">     Solution&lt;dim&gt;                  exact_solution;</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">     for (unsigned int cell = 0; cell &lt; data.n_cell_batches(); ++cell)</span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral">         phi.reinit(cell);</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral">         for (unsigned int q = 0; q &lt; phi.n_q_points; ++q)</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="stringliteral">             VectorizedArray&lt;double&gt; rhs_val = VectorizedArray&lt;double&gt;();</span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral">             Point&lt;dim, VectorizedArray&lt;double&gt;&gt; point_batch =</span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="stringliteral">               phi.quadrature_point(q);</span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="stringliteral">             for (unsigned int v = 0; v &lt; VectorizedArray&lt;double&gt;::size(); ++v)</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="stringliteral">               {</span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="stringliteral">                 Point&lt;dim&gt; single_point;</span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="stringliteral">                 for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral">                   single_point[d] = point_batch[d][v];</span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral">                 rhs_val[v] = rhs_func.value(single_point);</span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="stringliteral">               }</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="stringliteral">             phi.submit_value(rhs_val, q);</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="stringliteral">         phi.integrate_scatter(EvaluationFlags::values, system_rhs);</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="stringliteral">*  Secondly, we also need to apply the Dirichlet and Neumann boundary conditions. This function is the missing part of to the function   `LaplaceOperator::apply_boundary()`   function once the exterior solution values   @f$u^+ =</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="stringliteral">-u^- + 2 g_\text{D}@f$   and   @f$\mathbf{n}^-\cdot \nabla u^+ =</span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="stringliteral"> \mathbf{n}^-\cdot \nabla u^-@f$   on Dirichlet boundaries and   @f$u^+=u^-@f$   and   @f$\mathbf{n}^-\cdot \nabla u^+ =</span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="stringliteral">-\mathbf{n}^-\cdot \nabla u^- + 2</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="stringliteral"> g_\text{N}@f$   on Neumann boundaries are inserted and expanded in terms of the boundary functions   @f$g_\text{D}@f$   and   @f$g_\text{N}@f$  . One thing to remember is that we move the boundary conditions to the right hand side, so the sign is the opposite from what we imposed on the solution part.     </span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="stringliteral">*   We could have issued both the cell and the boundary part through a   MatrixFree::loop   part, but we choose to manually write the full loop over all faces to learn how the index layout of face indices is set up in MatrixFree: Both the inner faces and the boundary faces share the index range, and all batches of inner faces have lower numbers than the batches of boundary cells. A single index for both variants allows us to easily use the same data structure FEFaceEvaluation for both cases that attaches to the same data field, just at different positions. The number of inner face batches (where a batch is due to the combination of several faces into one for vectorization) is given by   MatrixFree::n_inner_face_batches(),   whereas the number of boundary face batches is given by   MatrixFree::n_boundary_face_batches().  </span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="stringliteral">     FEFaceEvaluation&lt;dim, fe_degree&gt; phi_face(data, true);</span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="stringliteral">     for (unsigned int face = data.n_inner_face_batches();</span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="stringliteral">          face &lt; data.n_inner_face_batches() + data.n_boundary_face_batches();</span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="stringliteral">          ++face)</span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="stringliteral">         phi_face.reinit(face);</span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="stringliteral">         const VectorizedArray&lt;double&gt; inverse_length_normal_to_face =</span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="stringliteral">           std::abs((phi_face.get_normal_vector(0)</span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="stringliteral">                     phi_face.inverse_jacobian(0))[dim</span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="stringliteral">- 1]);</span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral">         const VectorizedArray&lt;double&gt; sigma =</span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="stringliteral">           inverse_length_normal_to_face system_matrix.get_penalty_factor();</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="stringliteral">         for (unsigned int q = 0; q &lt; phi_face.n_q_points; ++q)</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="stringliteral">             VectorizedArray&lt;double&gt; test_value = VectorizedArray&lt;double&gt;(),</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="stringliteral">                                     test_normal_derivative =</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="stringliteral">                                       VectorizedArray&lt;double&gt;();</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="stringliteral">             Point&lt;dim, VectorizedArray&lt;double&gt;&gt; point_batch =</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="stringliteral">               phi_face.quadrature_point(q);</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="stringliteral">             for (unsigned int v = 0; v &lt; VectorizedArray&lt;double&gt;::size(); ++v)</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="stringliteral">               {</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="stringliteral">                 Point&lt;dim&gt; single_point;</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="stringliteral">                 for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="stringliteral">                   single_point[d] = point_batch[d][v];</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="stringliteral">*  The MatrixFree class lets us query the boundary_id of the current face batch. Remember that MatrixFree sets up the batches for vectorization such that all faces within a batch have the same properties, which includes their `boundary_id`. Thus, we can query that id here for the current face index `face` and either impose the Dirichlet case (where we add something to the function value) or the Neumann case (where we add something to the normal derivative).</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="stringliteral">                 if (data.get_boundary_id(face) == 0)</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="stringliteral">                   test_value[v] = 2.0 exact_solution.value(single_point);</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="stringliteral">                 else</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="stringliteral">                   {</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="stringliteral">                     Tensor&lt;1, dim&gt; normal;</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="stringliteral">                     for (unsigned int d = 0; d &lt; dim; ++d)</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="stringliteral">                       normal[d] = phi_face.get_normal_vector(q)[d][v];</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="stringliteral">                     test_normal_derivative[v] =</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;<span class="stringliteral">-normal exact_solution.gradient(single_point);</span></div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;<span class="stringliteral">                   }</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="stringliteral">               }</span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="stringliteral">             phi_face.submit_value(test_value sigma</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="stringliteral">- test_normal_derivative,</span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="stringliteral">                                   q);</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="stringliteral">             phi_face.submit_normal_derivative(-0.5 test_value, q);</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="stringliteral">         phi_face.integrate_scatter(EvaluationFlags::values |</span></div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;<span class="stringliteral">                                      EvaluationFlags::gradients,</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;<span class="stringliteral">                                    system_rhs);</span></div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;<span class="stringliteral">*  Since we have manually run the loop over cells rather than using   MatrixFree::loop(),   we must not forget to perform the data exchange with MPI</span></div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;<span class="stringliteral">*  - or actually, we would not need that for DG elements here because each cell carries its own degrees of freedom and cell and boundary integrals only evaluate quantities on the locally owned cells. The coupling to neighboring subdomain only comes in by the inner face integrals, which we have not done here. That said, it does not hurt to call this function here, so we do it as a reminder of what happens inside   MatrixFree::loop().  </span></div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="stringliteral">     system_rhs.compress(VectorOperation::add);</span></div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;<span class="stringliteral">     setup_time += time.wall_time();</span></div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;<span class="stringliteral">     time_details &lt;&lt; &quot;Compute right hand side       &quot; &lt;&lt; time.wall_time()</span></div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;<span class="stringliteral">                  &lt;&lt; &quot; s\n&quot;;</span></div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="stringliteral">*  The `solve()` function is copied almost verbatim from   @ref step_37 &quot;step-37&quot;  . We set up the same multigrid ingredients, namely the level transfer, a smoother, and a coarse grid solver. The only difference is the fact that we do not use the diagonal of the Laplacian for the preconditioner of the Chebyshev iteration used for smoothing, but instead our newly resolved class `%PreconditionBlockJacobi`. The mechanisms are the same, though.</span></div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;<span class="stringliteral">   void LaplaceProblem&lt;dim, fe_degree&gt;::solve()</span></div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;<span class="stringliteral">     Timer                            time;</span></div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;<span class="stringliteral">     MGTransferMatrixFree&lt;dim, float&gt; mg_transfer;</span></div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;<span class="stringliteral">     mg_transfer.build(dof_handler);</span></div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;<span class="stringliteral">     setup_time += time.wall_time();</span></div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;<span class="stringliteral">     time_details &lt;&lt; &quot;MG build transfer time        &quot; &lt;&lt; time.wall_time()</span></div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;<span class="stringliteral">                  &lt;&lt; &quot; s\n&quot;;</span></div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;<span class="stringliteral">     time.restart();</span></div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;<span class="stringliteral">     using SmootherType =</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;<span class="stringliteral">       PreconditionChebyshev&lt;LevelMatrixType,</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;<span class="stringliteral">                             LinearAlgebra::distributed::Vector&lt;float&gt;,</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;<span class="stringliteral">                             PreconditionBlockJacobi&lt;dim, fe_degree, float&gt;&gt;;</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;<span class="stringliteral">     mg::SmootherRelaxation&lt;SmootherType,</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;<span class="stringliteral">                            LinearAlgebra::distributed::Vector&lt;float&gt;&gt;</span></div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="stringliteral">                                                          mg_smoother;</span></div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="stringliteral">     MGLevelObject&lt;typename SmootherType::AdditionalData&gt; smoother_data;</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;<span class="stringliteral">     smoother_data.resize(0, triangulation.n_global_levels()</span></div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;<span class="stringliteral">- 1);</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;<span class="stringliteral">     for (unsigned int level = 0; level &lt; triangulation.n_global_levels();</span></div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;<span class="stringliteral">          ++level)</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;<span class="stringliteral">         if (level &gt; 0)</span></div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;<span class="stringliteral">             smoother_data[level].smoothing_range     = 15.;</span></div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;<span class="stringliteral">             smoother_data[level].degree              = 3;</span></div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;<span class="stringliteral">             smoother_data[level].eig_cg_n_iterations = 10;</span></div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;<span class="stringliteral">         else</span></div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;<span class="stringliteral">             smoother_data[0].smoothing_range = 2e-2;</span></div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;<span class="stringliteral">             smoother_data[0].degree          = numbers::invalid_unsigned_int;</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;<span class="stringliteral">             smoother_data[0].eig_cg_n_iterations = mg_matrices[0].m();</span></div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;<span class="stringliteral">         smoother_data[level].preconditioner =</span></div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;<span class="stringliteral">           std::make_shared&lt;PreconditionBlockJacobi&lt;dim, fe_degree, float&gt;&gt;();</span></div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;<span class="stringliteral">         smoother_data[level].preconditioner-&gt;initialize(mg_matrices[level]);</span></div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;<span class="stringliteral">     mg_smoother.initialize(mg_matrices, smoother_data);</span></div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;<span class="stringliteral">     MGCoarseGridApplySmoother&lt;LinearAlgebra::distributed::Vector&lt;float&gt;&gt;</span></div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;<span class="stringliteral">       mg_coarse;</span></div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;<span class="stringliteral">     mg_coarse.initialize(mg_smoother);</span></div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;<span class="stringliteral">     mg::Matrix&lt;LinearAlgebra::distributed::Vector&lt;float&gt;&gt; mg_matrix(</span></div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;<span class="stringliteral">       mg_matrices);</span></div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;<span class="stringliteral">     Multigrid&lt;LinearAlgebra::distributed::Vector&lt;float&gt;&gt; mg(</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;<span class="stringliteral">       mg_matrix, mg_coarse, mg_transfer, mg_smoother, mg_smoother);</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;<span class="stringliteral">     PreconditionMG&lt;dim,</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;<span class="stringliteral">                    LinearAlgebra::distributed::Vector&lt;float&gt;,</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;<span class="stringliteral">                    MGTransferMatrixFree&lt;dim, float&gt;&gt;</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;<span class="stringliteral">       preconditioner(dof_handler, mg, mg_transfer);</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;<span class="stringliteral">     SolverControl solver_control(10000, 1e-12 system_rhs.l2_norm());</span></div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="stringliteral">     SolverCG&lt;LinearAlgebra::distributed::Vector&lt;double&gt;&gt; cg(solver_control);</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;<span class="stringliteral">     setup_time += time.wall_time();</span></div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;<span class="stringliteral">     time_details &lt;&lt; &quot;MG build smoother time        &quot; &lt;&lt; time.wall_time()</span></div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;<span class="stringliteral">                  &lt;&lt; &quot;s\n&quot;;</span></div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;<span class="stringliteral">     pcout &lt;&lt; &quot;Total setup time              &quot; &lt;&lt; setup_time &lt;&lt; &quot; s\n&quot;;</span></div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="stringliteral">     time.reset();</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;<span class="stringliteral">     time.start();</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;<span class="stringliteral">     cg.solve(system_matrix, solution, system_rhs, preconditioner);</span></div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;<span class="stringliteral">     pcout &lt;&lt; &quot;Time solve (&quot; &lt;&lt; solver_control.last_step() &lt;&lt; &quot; iterations)    &quot;</span></div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;<span class="stringliteral">           &lt;&lt; time.wall_time() &lt;&lt; &quot; s&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="stringliteral">*  Since we have solved a problem with analytic solution, we want to verify the correctness of our implementation by computing the L2 error of the numerical result against the analytic solution.</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;<span class="stringliteral">   void LaplaceProblem&lt;dim, fe_degree&gt;::analyze_results() const</span></div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;<span class="stringliteral">     Vector&lt;float&gt; error_per_cell(triangulation.n_active_cells());</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;<span class="stringliteral">     VectorTools::integrate_difference(mapping,</span></div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;<span class="stringliteral">                                       dof_handler,</span></div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;<span class="stringliteral">                                       solution,</span></div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;<span class="stringliteral">                                       Solution&lt;dim&gt;(),</span></div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="stringliteral">                                       error_per_cell,</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="stringliteral">                                       QGauss&lt;dim&gt;(fe.degree + 2),</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;<span class="stringliteral">                                       VectorTools::L2_norm);</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;<span class="stringliteral">     pcout &lt;&lt; &quot;Verification via L2 error:    &quot;</span></div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;<span class="stringliteral">           &lt;&lt; std::sqrt(</span></div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;<span class="stringliteral">                Utilities::MPI::sum(error_per_cell.norm_sqr(), MPI_COMM_WORLD))</span></div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;<span class="stringliteral">           &lt;&lt; std::endl;</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;<span class="stringliteral">*  The `run()` function sets up the initial grid and then runs the multigrid program in the usual way. As a domain, we choose a rectangle with periodic boundary conditions in the   @f$x@f$  -direction, a Dirichlet condition on the front face in   @f$y@f$   direction (i.e., the face with index number 2, with boundary id equal to 0), and Neumann conditions on the back face as well as the two faces in   @f$z@f$   direction for the 3D case (with boundary id equal to 1). The extent of the domain is a bit different in the   @f$x@f$   direction (where we want to achieve a periodic solution given the definition of `Solution`) as compared to the   @f$y@f$   and   @f$z@f$   directions.</span></div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;<span class="stringliteral">   template &lt;int dim, int fe_degree&gt;</span></div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;<span class="stringliteral">   void LaplaceProblem&lt;dim, fe_degree&gt;::run()</span></div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;<span class="stringliteral">     const unsigned int n_ranks =</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;<span class="stringliteral">       Utilities::MPI::n_mpi_processes(MPI_COMM_WORLD);</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;<span class="stringliteral">     pcout &lt;&lt; &quot;Running with &quot; &lt;&lt; n_ranks &lt;&lt; &quot; MPI process&quot;</span></div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;<span class="stringliteral">           &lt;&lt; (n_ranks &gt; 1 ? &quot;es&quot; : &quot;&quot;) &lt;&lt; &quot;, element &quot; &lt;&lt; fe.get_name()</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;<span class="stringliteral">           &lt;&lt; std::endl</span></div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;<span class="stringliteral">           &lt;&lt; std::endl;</span></div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;<span class="stringliteral">     for (unsigned int cycle = 0; cycle &lt; 9</span></div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;<span class="stringliteral">- dim; ++cycle)</span></div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;<span class="stringliteral">         pcout &lt;&lt; &quot;Cycle &quot; &lt;&lt; cycle &lt;&lt; std::endl;</span></div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;<span class="stringliteral">         if (cycle == 0)</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;<span class="stringliteral">             Point&lt;dim&gt; upper_right;</span></div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;<span class="stringliteral">             upper_right[0] = 2.5;</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;<span class="stringliteral">             for (unsigned int d = 1; d &lt; dim; ++d)</span></div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;<span class="stringliteral">               upper_right[d] = 2.8;</span></div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;<span class="stringliteral">             GridGenerator::hyper_rectangle(triangulation,</span></div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="stringliteral">                                            Point&lt;dim&gt;(),</span></div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;<span class="stringliteral">                                            upper_right);</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;<span class="stringliteral">             triangulation.begin_active()-&gt;face(0)-&gt;set_boundary_id(10);</span></div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;<span class="stringliteral">             triangulation.begin_active()-&gt;face(1)-&gt;set_boundary_id(11);</span></div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;<span class="stringliteral">             triangulation.begin_active()-&gt;face(2)-&gt;set_boundary_id(0);</span></div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;<span class="stringliteral">             for (unsigned int f = 3;</span></div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;<span class="stringliteral">                  f &lt; triangulation.begin_active()-&gt;n_faces();</span></div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;<span class="stringliteral">                  ++f)</span></div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;<span class="stringliteral">               triangulation.begin_active()-&gt;face(f)-&gt;set_boundary_id(1);</span></div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;<span class="stringliteral">             std::vector&lt;GridTools::PeriodicFacePair&lt;</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;<span class="stringliteral">               typename Triangulation&lt;dim&gt;::cell_iterator&gt;&gt;</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;<span class="stringliteral">               periodic_faces;</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;<span class="stringliteral">             GridTools::collect_periodic_faces(</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;<span class="stringliteral">               triangulation, 10, 11, 0, periodic_faces);</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;<span class="stringliteral">             triangulation.add_periodicity(periodic_faces);</span></div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;<span class="stringliteral">             triangulation.refine_global(6</span></div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;<span class="stringliteral">- 2 dim);</span></div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;<span class="stringliteral">         triangulation.refine_global(1);</span></div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;<span class="stringliteral">         setup_system();</span></div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;<span class="stringliteral">         compute_rhs();</span></div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;<span class="stringliteral">         solve();</span></div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;<span class="stringliteral">         analyze_results();</span></div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;<span class="stringliteral">         pcout &lt;&lt; std::endl;</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;<span class="stringliteral">       };</span></div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;<span class="stringliteral"> } // namespace Step59</span></div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;<span class="stringliteral">*  There is nothing unexpected in the `main()` function. We call `MPI_Init()` through the `MPI_InitFinalize` class, pass on the two parameters on the dimension and the degree set at the top of the file, and run the Laplace problem.</span></div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="stringliteral">*  </span></div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;<span class="stringliteral"> int main(int argc, charargv[])</span></div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;<span class="stringliteral">   try</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;<span class="stringliteral">       using namespace Step59;</span></div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;<span class="stringliteral">       Utilities::MPI::MPI_InitFinalize mpi_init(argc, argv, 1);</span></div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;<span class="stringliteral">       LaplaceProblem&lt;dimension, degree_finite_element&gt; laplace_problem;</span></div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;<span class="stringliteral">       laplace_problem.run();</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;<span class="stringliteral">   catch (std::exception &amp;exc)</span></div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Exception on processing: &quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;<span class="stringliteral">                 &lt;&lt; exc.what() &lt;&lt; std::endl</span></div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;<span class="stringliteral">   catch (...)</span></div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Unknown exception!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;<span class="stringliteral">   return 0;</span></div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Results&quot;&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</span></div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Programoutput&quot;&gt;&lt;/a&gt;&lt;h3&gt;Program output&lt;/h3&gt;</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;<span class="stringliteral">* Like in   @ref step_37 &quot;step-37&quot;  , we evaluate the multigrid solver in terms of run time.  Intwo space dimensions with elements of degree 8, a possible output could lookas follows:</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="stringliteral">Running with 12 MPI processes, element FE_DGQHermite&lt;2&gt;(8)</span></div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;<span class="stringliteral">Cycle 0</span></div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;<span class="stringliteral">Number of degrees of freedom: 5184</span></div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;<span class="stringliteral">Total setup time              0.0282445 s</span></div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;<span class="stringliteral">Time solve (14 iterations)    0.0110712 s</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="stringliteral">Verification via L2 error:    1.66232e-07</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="stringliteral">Cycle 1</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;<span class="stringliteral">Number of degrees of freedom: 20736</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;<span class="stringliteral">Total setup time              0.0126282 s</span></div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="stringliteral">Time solve (14 iterations)    0.0157021 s</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;<span class="stringliteral">Verification via L2 error:    2.91505e-10</span></div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="stringliteral">Cycle 2</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;<span class="stringliteral">Number of degrees of freedom: 82944</span></div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;<span class="stringliteral">Total setup time              0.0227573 s</span></div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;<span class="stringliteral">Time solve (14 iterations)    0.026568 s</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;<span class="stringliteral">Verification via L2 error:    6.64514e-13</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;<span class="stringliteral">Cycle 3</span></div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="stringliteral">Number of degrees of freedom: 331776</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;<span class="stringliteral">Total setup time              0.0604685 s</span></div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="stringliteral">Time solve (14 iterations)    0.0628356 s</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;<span class="stringliteral">Verification via L2 error:    5.57513e-13</span></div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="stringliteral">Cycle 4</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="stringliteral">Number of degrees of freedom: 1327104</span></div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="stringliteral">Total setup time              0.154359 s</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="stringliteral">Time solve (13 iterations)    0.219555 s</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="stringliteral">Verification via L2 error:    3.08139e-12</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;<span class="stringliteral">Cycle 5</span></div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;<span class="stringliteral">Number of degrees of freedom: 5308416</span></div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;<span class="stringliteral">Total setup time              0.467764 s</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;<span class="stringliteral">Time solve (13 iterations)    1.1821 s</span></div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;<span class="stringliteral">Verification via L2 error:    3.90334e-12</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;<span class="stringliteral">Cycle 6</span></div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;<span class="stringliteral">Number of degrees of freedom: 21233664</span></div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;<span class="stringliteral">Total setup time              1.73263 s</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;<span class="stringliteral">Time solve (13 iterations)    5.21054 s</span></div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;<span class="stringliteral">Verification via L2 error:    4.94543e-12</span></div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;<span class="stringliteral">@endcode</span></div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;<span class="stringliteral">* Like in   @ref step_37 &quot;step-37&quot;  , the number of CG iterations remains constant with increasingproblem size. The iteration counts are a bit higher, which is because we use alower degree of the Chebyshev polynomial (2 vs 5 in   @ref step_37 &quot;step-37&quot;  ) and because theinterior penalty discretization has a somewhat larger spread ineigenvalues. Nonetheless, 13 iterations to reduce the residual by 12 orders ofmagnitude, or almost a factor of 9 per iteration, indicates an overall veryefficient method. In particular, we can solve a system with 21 million degreesof freedom in 5 seconds when using 12 cores, which is a very goodefficiency. Of course, in 2D we are well inside the regime of roundoff for apolynomial degree of 8 &amp;ndash; as a matter of fact, around 83k DoFs or 0.025swould have been enough to fully converge this (simple) analytic solutionhere.</span></div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;<span class="stringliteral">* Not much changes if we run the program in three spatial dimensions, except forthe fact that we now use do something more useful with the higher polynomialdegree and increasing mesh sizes, as the roundoff errors are only obtained atthe finest mesh. Still, it is remarkable that we can solve a 3D Laplaceproblem with a wave of three periods to roundoff accuracy on a twelve-coremachine pretty easily</span></div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;<span class="stringliteral">*  - using about 3.5 GB of memory in total for the secondto largest case with 24m DoFs, taking not more than eight seconds. The largestcase uses 30GB of memory with 191m DoFs.</span></div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;<span class="stringliteral">Running with 12 MPI processes, element FE_DGQHermite&lt;3&gt;(8)</span></div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;<span class="stringliteral">Cycle 0</span></div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;<span class="stringliteral">Number of degrees of freedom: 5832</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;<span class="stringliteral">Total setup time              0.0210681 s</span></div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="stringliteral">Time solve (15 iterations)    0.0956945 s</span></div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;<span class="stringliteral">Verification via L2 error:    0.0297194</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;<span class="stringliteral">Cycle 1</span></div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;<span class="stringliteral">Number of degrees of freedom: 46656</span></div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;<span class="stringliteral">Total setup time              0.0452428 s</span></div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="stringliteral">Time solve (15 iterations)    0.113827 s</span></div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;<span class="stringliteral">Verification via L2 error:    9.55733e-05</span></div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;<span class="stringliteral">Cycle 2</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="stringliteral">Number of degrees of freedom: 373248</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;<span class="stringliteral">Total setup time              0.190423 s</span></div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;<span class="stringliteral">Time solve (15 iterations)    0.218309 s</span></div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;<span class="stringliteral">Verification via L2 error:    2.6868e-07</span></div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;<span class="stringliteral">Cycle 3</span></div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;<span class="stringliteral">Number of degrees of freedom: 2985984</span></div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;<span class="stringliteral">Total setup time              0.627914 s</span></div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;<span class="stringliteral">Time solve (15 iterations)    1.0595 s</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="stringliteral">Verification via L2 error:    4.6918e-10</span></div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="stringliteral">Cycle 4</span></div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;<span class="stringliteral">Number of degrees of freedom: 23887872</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;<span class="stringliteral">Total setup time              2.85215 s</span></div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;<span class="stringliteral">Time solve (15 iterations)    8.30576 s</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;<span class="stringliteral">Verification via L2 error:    9.38583e-13</span></div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;<span class="stringliteral">Cycle 5</span></div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;<span class="stringliteral">Number of degrees of freedom: 191102976</span></div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;<span class="stringliteral">Total setup time              16.1324 s</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;<span class="stringliteral">Time solve (15 iterations)    65.57 s</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;<span class="stringliteral">Verification via L2 error:    3.17875e-13</span></div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;<span class="stringliteral">@endcode</span></div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Comparisonofefficiencyatdifferentpolynomialdegrees&quot;&gt;&lt;/a&gt;&lt;h3&gt;Comparison of efficiency at different polynomial degrees&lt;/h3&gt;</span></div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;<span class="stringliteral">* In the introduction and in-code comments, it was mentioned several times thathigh orders are treated very efficiently with the FEEvaluation andFEFaceEvaluation evaluators. Now, we want to substantiate these claims bylooking at the throughput of the 3D multigrid solver for various polynomialdegrees. We collect the times as follows: We first run a solver at problemsize close to ten million, indicated in the first four table rows, and recordthe timings. Then, we normalize the throughput by recording the number ofmillion degrees of freedom solved per second (MDoFs/s) to be able to comparethe efficiency of the different degrees, which is computed by dividing thenumber of degrees of freedom by the solver time.</span></div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;<span class="stringliteral">*   &lt;table align=&quot;center&quot; class=&quot;doxtable&quot;&gt;</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;<span class="stringliteral">   &lt;th&gt;degree&lt;/th&gt;</span></div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;<span class="stringliteral">   &lt;th&gt;1&lt;/th&gt;</span></div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;<span class="stringliteral">   &lt;th&gt;2&lt;/th&gt;</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;<span class="stringliteral">   &lt;th&gt;3&lt;/th&gt;</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="stringliteral">   &lt;th&gt;4&lt;/th&gt;</span></div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;<span class="stringliteral">   &lt;th&gt;5&lt;/th&gt;</span></div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="stringliteral">   &lt;th&gt;6&lt;/th&gt;</span></div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;<span class="stringliteral">   &lt;th&gt;7&lt;/th&gt;</span></div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="stringliteral">   &lt;th&gt;8&lt;/th&gt;</span></div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;<span class="stringliteral">   &lt;th&gt;9&lt;/th&gt;</span></div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;<span class="stringliteral">   &lt;th&gt;10&lt;/th&gt;</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="stringliteral">   &lt;th&gt;11&lt;/th&gt;</span></div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;<span class="stringliteral">   &lt;th&gt;12&lt;/th&gt;</span></div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;<span class="stringliteral">   &lt;th&gt;Number of DoFs&lt;/th&gt;</span></div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;<span class="stringliteral">   &lt;td&gt;2097152&lt;/td&gt;</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="stringliteral">   &lt;td&gt;7077888&lt;/td&gt;</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="stringliteral">   &lt;td&gt;16777216&lt;/td&gt;</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="stringliteral">   &lt;td&gt;32768000&lt;/td&gt;</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="stringliteral">   &lt;td&gt;7077888&lt;/td&gt;</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="stringliteral">   &lt;td&gt;11239424&lt;/td&gt;</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="stringliteral">   &lt;td&gt;16777216&lt;/td&gt;</span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="stringliteral">   &lt;td&gt;23887872&lt;/td&gt;</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="stringliteral">   &lt;td&gt;32768000&lt;/td&gt;</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="stringliteral">   &lt;td&gt;43614208&lt;/td&gt;</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="stringliteral">   &lt;td&gt;7077888&lt;/td&gt;</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;<span class="stringliteral">   &lt;td&gt;8998912&lt;/td&gt;</span></div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;<span class="stringliteral">   &lt;th&gt;Number of iterations&lt;/th&gt;</span></div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="stringliteral">   &lt;td&gt;13&lt;/td&gt;</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;<span class="stringliteral">   &lt;td&gt;12&lt;/td&gt;</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;<span class="stringliteral">   &lt;td&gt;12&lt;/td&gt;</span></div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;<span class="stringliteral">   &lt;td&gt;12&lt;/td&gt;</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;<span class="stringliteral">   &lt;td&gt;13&lt;/td&gt;</span></div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;<span class="stringliteral">   &lt;td&gt;13&lt;/td&gt;</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;<span class="stringliteral">   &lt;td&gt;15&lt;/td&gt;</span></div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;<span class="stringliteral">   &lt;td&gt;15&lt;/td&gt;</span></div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="stringliteral">   &lt;td&gt;17&lt;/td&gt;</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;<span class="stringliteral">   &lt;td&gt;19&lt;/td&gt;</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;<span class="stringliteral">   &lt;td&gt;18&lt;/td&gt;</span></div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="stringliteral">   &lt;td&gt;18&lt;/td&gt;</span></div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;<span class="stringliteral">   &lt;th&gt;Solver time [s]&lt;/th&gt;</span></div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;<span class="stringliteral">   &lt;td&gt;0.713&lt;/td&gt;</span></div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;<span class="stringliteral">   &lt;td&gt;2.150&lt;/td&gt;</span></div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;<span class="stringliteral">   &lt;td&gt;4.638&lt;/td&gt;</span></div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;<span class="stringliteral">   &lt;td&gt;8.803&lt;/td&gt;</span></div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;<span class="stringliteral">   &lt;td&gt;2.041&lt;/td&gt;</span></div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;<span class="stringliteral">   &lt;td&gt;3.295&lt;/td&gt;</span></div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="stringliteral">   &lt;td&gt;5.723&lt;/td&gt;</span></div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="stringliteral">   &lt;td&gt;8.306&lt;/td&gt;</span></div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="stringliteral">   &lt;td&gt;12.75&lt;/td&gt;</span></div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="stringliteral">   &lt;td&gt;19.25&lt;/td&gt;</span></div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;<span class="stringliteral">   &lt;td&gt;3.530&lt;/td&gt;</span></div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="stringliteral">   &lt;td&gt;4.814&lt;/td&gt;</span></div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;<span class="stringliteral">   &lt;th&gt;MDoFs/s&lt;/th&gt;</span></div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;<span class="stringliteral">   &lt;td&gt;2.94&lt;/td&gt;</span></div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;<span class="stringliteral">   &lt;td&gt;3.29&lt;/td&gt;</span></div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;<span class="stringliteral">   &lt;td&gt;3.62&lt;/td&gt;</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;<span class="stringliteral">   &lt;td&gt;3.72&lt;/td&gt;</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;<span class="stringliteral">   &lt;td&gt;3.47&lt;/td&gt;</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;<span class="stringliteral">   &lt;td&gt;3.41&lt;/td&gt;</span></div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;<span class="stringliteral">   &lt;td&gt;2.93&lt;/td&gt;</span></div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;<span class="stringliteral">   &lt;td&gt;2.88&lt;/td&gt;</span></div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;<span class="stringliteral">   &lt;td&gt;2.57&lt;/td&gt;</span></div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;<span class="stringliteral">   &lt;td&gt;2.27&lt;/td&gt;</span></div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;<span class="stringliteral">   &lt;td&gt;2.01&lt;/td&gt;</span></div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;<span class="stringliteral">   &lt;td&gt;1.87&lt;/td&gt;</span></div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;<span class="stringliteral">* We clearly see how the efficiency per DoF initially improves until it reachesa maximum for the polynomial degree   @f$k=4@f$  . This effect is surprising, not onlybecause higher polynomial degrees often yield a vastly better solution, butespecially also when having matrix-based schemes in mind where the densercoupling at higher degree leads to a monotonously decreasing throughput (and adrastic one in 3D, with   @f$k=4@f$   being more than ten times slower than  @f$k=1@f$  !). For higher degrees, the throughput decreases a bit, which is both dueto an increase in the number of iterations (going from 12 at   @f$k=2,3,4@f$   to 19at   @f$k=10@f$  ) and due to the   @f$\mathcal O(k)@f$   complexity of operatorevaluation. Nonetheless, efficiency as the time to solution would be stillbetter for higher polynomial degrees because they have better convergence rates (at leastfor problems as simple as this one): For   @f$k=12@f$  , we reach roundoff accuracyalready with 1 million DoFs (solver time less than a second), whereas for   @f$k=8@f$  we need 24 million DoFs and 8 seconds. For   @f$k=5@f$  , the error is around  @f$10^{-9}@f$   with 57m DoFs and thus still far away from roundoff, despite taking 16seconds.</span></div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;<span class="stringliteral">* Note that the above numbers are a bit pessimistic because they include thetime it takes the Chebyshev smoother to compute an eigenvalue estimate, whichis around 10 percent of the solver time. If the system is solved several times(as e.g. common in fluid dynamics), this eigenvalue cost is only paid once andfaster times become available.</span></div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Evaluationofefficiencyofingredients&quot;&gt;&lt;/a&gt;&lt;h3&gt;Evaluation of efficiency of ingredients&lt;/h3&gt;</span></div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;<span class="stringliteral">* Finally, we take a look at some of the special ingredients presented in thistutorial program, namely the FE_DGQHermite basis in particular and thespecification of   MatrixFree::DataAccessOnFaces.   In the following table, thethird row shows the optimized solver above, the fourth row shows the timingswith only the   MatrixFree::DataAccessOnFaces   set to `unspecified` rather thanthe optimal `gradients`, and the last one with replacing FE_DGQHermite by thebasic FE_DGQ elements where both the MPI exchange are more expensive and theoperations done by   FEFaceEvaluation::gather_evaluate()   and  FEFaceEvaluation::integrate_scatter().  </span></div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;<span class="stringliteral">*   &lt;table align=&quot;center&quot; class=&quot;doxtable&quot;&gt;</span></div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;<span class="stringliteral">   &lt;th&gt;degree&lt;/th&gt;</span></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="stringliteral">   &lt;th&gt;1&lt;/th&gt;</span></div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;<span class="stringliteral">   &lt;th&gt;2&lt;/th&gt;</span></div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;<span class="stringliteral">   &lt;th&gt;3&lt;/th&gt;</span></div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;<span class="stringliteral">   &lt;th&gt;4&lt;/th&gt;</span></div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;<span class="stringliteral">   &lt;th&gt;5&lt;/th&gt;</span></div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;<span class="stringliteral">   &lt;th&gt;6&lt;/th&gt;</span></div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;<span class="stringliteral">   &lt;th&gt;7&lt;/th&gt;</span></div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;<span class="stringliteral">   &lt;th&gt;8&lt;/th&gt;</span></div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;<span class="stringliteral">   &lt;th&gt;9&lt;/th&gt;</span></div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;<span class="stringliteral">   &lt;th&gt;10&lt;/th&gt;</span></div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;<span class="stringliteral">   &lt;th&gt;11&lt;/th&gt;</span></div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;<span class="stringliteral">   &lt;th&gt;12&lt;/th&gt;</span></div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;<span class="stringliteral">   &lt;th&gt;Number of DoFs&lt;/th&gt;</span></div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;<span class="stringliteral">   &lt;td&gt;2097152&lt;/td&gt;</span></div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;<span class="stringliteral">   &lt;td&gt;7077888&lt;/td&gt;</span></div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;<span class="stringliteral">   &lt;td&gt;16777216&lt;/td&gt;</span></div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;<span class="stringliteral">   &lt;td&gt;32768000&lt;/td&gt;</span></div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;<span class="stringliteral">   &lt;td&gt;7077888&lt;/td&gt;</span></div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;<span class="stringliteral">   &lt;td&gt;11239424&lt;/td&gt;</span></div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="stringliteral">   &lt;td&gt;16777216&lt;/td&gt;</span></div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;<span class="stringliteral">   &lt;td&gt;23887872&lt;/td&gt;</span></div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;<span class="stringliteral">   &lt;td&gt;32768000&lt;/td&gt;</span></div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;<span class="stringliteral">   &lt;td&gt;43614208&lt;/td&gt;</span></div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;<span class="stringliteral">   &lt;td&gt;7077888&lt;/td&gt;</span></div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="stringliteral">   &lt;td&gt;8998912&lt;/td&gt;</span></div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;<span class="stringliteral">   &lt;th&gt;Solver time optimized as in tutorial [s]&lt;/th&gt;</span></div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;<span class="stringliteral">   &lt;td&gt;0.713&lt;/td&gt;</span></div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;<span class="stringliteral">   &lt;td&gt;2.150&lt;/td&gt;</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;<span class="stringliteral">   &lt;td&gt;4.638&lt;/td&gt;</span></div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;<span class="stringliteral">   &lt;td&gt;8.803&lt;/td&gt;</span></div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;<span class="stringliteral">   &lt;td&gt;2.041&lt;/td&gt;</span></div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;<span class="stringliteral">   &lt;td&gt;3.295&lt;/td&gt;</span></div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;<span class="stringliteral">   &lt;td&gt;5.723&lt;/td&gt;</span></div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;<span class="stringliteral">   &lt;td&gt;8.306&lt;/td&gt;</span></div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;<span class="stringliteral">   &lt;td&gt;12.75&lt;/td&gt;</span></div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;<span class="stringliteral">   &lt;td&gt;19.25&lt;/td&gt;</span></div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;<span class="stringliteral">   &lt;td&gt;3.530&lt;/td&gt;</span></div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;<span class="stringliteral">   &lt;td&gt;4.814&lt;/td&gt;</span></div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;<span class="stringliteral">   &lt;th&gt;Solver time MatrixFree::DataAccessOnFaces::unspecified [s]&lt;/th&gt;</span></div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;<span class="stringliteral">   &lt;td&gt;0.711&lt;/td&gt;</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;<span class="stringliteral">   &lt;td&gt;2.151&lt;/td&gt;</span></div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;<span class="stringliteral">   &lt;td&gt;4.675&lt;/td&gt;</span></div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;<span class="stringliteral">   &lt;td&gt;8.968&lt;/td&gt;</span></div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;<span class="stringliteral">   &lt;td&gt;2.243&lt;/td&gt;</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;<span class="stringliteral">   &lt;td&gt;3.655&lt;/td&gt;</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;<span class="stringliteral">   &lt;td&gt;6.277&lt;/td&gt;</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;<span class="stringliteral">   &lt;td&gt;9.082&lt;/td&gt;</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;<span class="stringliteral">   &lt;td&gt;13.50&lt;/td&gt;</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;<span class="stringliteral">   &lt;td&gt;20.05&lt;/td&gt;</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="stringliteral">   &lt;td&gt;3.817&lt;/td&gt;</span></div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;<span class="stringliteral">   &lt;td&gt;5.178&lt;/td&gt;</span></div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;<span class="stringliteral">   &lt;th&gt;Solver time FE_DGQ [s]&lt;/th&gt;</span></div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;<span class="stringliteral">   &lt;td&gt;0.712&lt;/td&gt;</span></div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;<span class="stringliteral">   &lt;td&gt;2.041&lt;/td&gt;</span></div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;<span class="stringliteral">   &lt;td&gt;5.066&lt;/td&gt;</span></div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="stringliteral">   &lt;td&gt;9.335&lt;/td&gt;</span></div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="stringliteral">   &lt;td&gt;2.379&lt;/td&gt;</span></div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;<span class="stringliteral">   &lt;td&gt;3.802&lt;/td&gt;</span></div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;<span class="stringliteral">   &lt;td&gt;6.564&lt;/td&gt;</span></div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;<span class="stringliteral">   &lt;td&gt;9.714&lt;/td&gt;</span></div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;<span class="stringliteral">   &lt;td&gt;14.54&lt;/td&gt;</span></div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;<span class="stringliteral">   &lt;td&gt;22.76&lt;/td&gt;</span></div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;<span class="stringliteral">   &lt;td&gt;4.148&lt;/td&gt;</span></div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="stringliteral">   &lt;td&gt;5.857&lt;/td&gt;</span></div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="stringliteral">* The data in the table shows that not using   MatrixFree::DataAccessOnFaces  increases costs by around 10% for higher polynomial degrees. For lowerdegrees, the difference is obviously less pronounced because thevolume-to-surface ratio is more beneficial and less data needs to beexchanged. The difference is larger when looking at the matrix-vector productonly, rather than the full multigrid solver shown here, with around 20% worsetimings just because of the MPI communication.</span></div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="stringliteral">* For   @f$k=1@f$   and   @f$k=2@f$  , the Hermite-like basis functions do obviously not reallypay off (indeed, for   @f$k=1@f$   the polynomials are exactly the same as for FE_DGQ)and the results are similar as with the FE_DGQ basis. However, for degreesstarting at three, we see an increasing advantage for FE_DGQHermite, showingthe effectiveness of these basis functions.</span></div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Possibilitiesforextension&quot;&gt;&lt;/a&gt;&lt;h3&gt;Possibilities for extension&lt;/h3&gt;</span></div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;<span class="stringliteral">* As mentioned in the introduction, the fast diagonalization method is tied to aCartesian mesh with constant coefficients. If we wanted to solvevariable-coefficient problems, we would need to invest a bit more time in thedesign of the smoother parameters by selecting proper generalizations (e.g.,approximating the inverse on the nearest box-shaped element).</span></div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;<span class="stringliteral">* Another way of extending the program would be to include support for adaptivemeshes, for which interface operations at edges of different refinementlevel become necessary, as discussed in   @ref step_39 &quot;step-39&quot;  .</span></div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;<span class="stringliteral">* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-59.cc&quot;  </span></div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;<span class="stringliteral">*</span></div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;<span class="stringliteral">*/</span></div><div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">LAPACKSupport::symmetric</a></div><div class="ttdoc">Matrix is symmetric. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00116">lapack_support.h:116</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="namespaceDifferentiation_1_1SD_html_aa55d50a1ffa79c27f9bd9ea104f15158"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#aa55d50a1ffa79c27f9bd9ea104f15158">Differentiation::SD::sign</a></div><div class="ttdeci">Expression sign(const Expression &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="symengine__math_8cc_source.html#l00280">symengine_math.cc:280</a></div></div>
<div class="ttc" id="group__CUDAWrappers_html_ga63ba304711678353aa10eb65caed2967"><div class="ttname"><a href="group__CUDAWrappers.html#ga63ba304711678353aa10eb65caed2967">LinearAlgebra::CUDAWrappers::kernel::reduction</a></div><div class="ttdeci">__global__ void reduction(Number *result, const Number *v, const size_type N)</div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="classVectorizedArray_html"><div class="ttname"><a href="classVectorizedArray.html">VectorizedArray</a></div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00409">vectorization.h:409</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="classFEEvaluationBase_html_a5c3bf28ebceb0271addfba5b92f475ce"><div class="ttname"><a href="classFEEvaluationBase.html#a5c3bf28ebceb0271addfba5b92f475ce">FEEvaluationBase::read_dof_values</a></div><div class="ttdeci">void read_dof_values(const VectorType &amp;src, const unsigned int first_index=0)</div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="classFEEvaluationBaseData_html_aba2db8170a4e834313fa1775d50c26a2"><div class="ttname"><a href="classFEEvaluationBaseData.html#aba2db8170a4e834313fa1775d50c26a2">FEEvaluationBaseData::cell</a></div><div class="ttdeci">unsigned int cell</div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00432">fe_evaluation.h:432</a></div></div>
<div class="ttc" id="classMatrixFree_html"><div class="ttname"><a href="classMatrixFree.html">MatrixFree</a></div><div class="ttdef"><b>Definition:</b> <a href="matrix__free_8h_source.html#l00093">matrix_free.h:93</a></div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classFEFaceEvaluation_html"><div class="ttname"><a href="classFEFaceEvaluation.html">FEFaceEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l02547">fe_evaluation.h:2547</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00059">evaluation_flags.h:59</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_ab544a3bf3301a6dd3e705ee352c5551b"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#ab544a3bf3301a6dd3e705ee352c5551b">Utilities::MPI::sum</a></div><div class="ttdeci">T sum(const T &amp;t, const MPI_Comm &amp;mpi_communicator)</div></div>
<div class="ttc" id="classLinearAlgebra_1_1distributed_1_1Vector_html"><div class="ttname"><a href="classLinearAlgebra_1_1distributed_1_1Vector.html">LinearAlgebra::distributed::Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="la__parallel__vector_8h_source.html#l00121">la_parallel_vector.h:121</a></div></div>
<div class="ttc" id="classMatrixFree_html_aa13157af74893593d4af73a30b01a74b"><div class="ttname"><a href="classMatrixFree.html#aa13157af74893593d4af73a30b01a74b">MatrixFree::get_face_info</a></div><div class="ttdeci">const internal::MatrixFreeFunctions::FaceToCellTopology&lt; VectorizedArrayType::size()&gt; &amp; get_face_info(const unsigned int face_batch_index) const</div></div>
<div class="ttc" id="namespaceLinearAlgebra_html"><div class="ttname"><a href="namespaceLinearAlgebra.html">LinearAlgebra</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2communication__pattern__base_8h_source.html#l00027">communication_pattern_base.h:27</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceDoFRenumbering_html_abbd608826acd7c01f91db401a3728e25"><div class="ttname"><a href="namespaceDoFRenumbering.html#abbd608826acd7c01f91db401a3728e25">DoFRenumbering::random</a></div><div class="ttdeci">void random(DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler)</div><div class="ttdef"><b>Definition:</b> <a href="dof__renumbering_8cc_source.html#l02088">dof_renumbering.cc:2088</a></div></div>
<div class="ttc" id="classMatrixFree_html_a94c875be0229e4872a3e087a55410625"><div class="ttname"><a href="classMatrixFree.html#a94c875be0229e4872a3e087a55410625">MatrixFree::get_boundary_id</a></div><div class="ttdeci">types::boundary_id get_boundary_id(const unsigned int macro_face) const</div></div>
<div class="ttc" id="classFEEvaluation_html_ab53d5c08f460cfe6c9830ac14a427115"><div class="ttname"><a href="classFEEvaluation.html#ab53d5c08f460cfe6c9830ac14a427115">FEEvaluation::gather_evaluate</a></div><div class="ttdeci">void gather_evaluate(const VectorType &amp;input_vector, const EvaluationFlags::EvaluationFlags evaluation_flag)</div></div>
<div class="ttc" id="classFE__DGQHermite_html"><div class="ttname"><a href="classFE__DGQHermite.html">FE_DGQHermite</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__dgq_8h_source.html#l00395">fe_dgq.h:395</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a8edacd69ab93285f82b7f63c733a86b7"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">LAPACKSupport::N</a></div><div class="ttdeci">static const char N</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00163">lapack_support.h:163</a></div></div>
<div class="ttc" id="namespacenumbers_html"><div class="ttname"><a href="namespacenumbers.html">numbers</a></div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00187">numbers.h:187</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">LAPACKSupport::general</a></div><div class="ttdoc">No special properties. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00114">lapack_support.h:114</a></div></div>
<div class="ttc" id="classFEEvaluation_html_a491779be7bd032d277e41f1dda8dc584"><div class="ttname"><a href="classFEEvaluation.html#a491779be7bd032d277e41f1dda8dc584">FEEvaluation::integrate_scatter</a></div><div class="ttdeci">void integrate_scatter(const EvaluationFlags::EvaluationFlags evaluation_flag, VectorType &amp;output_vector)</div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="namespaceUtilities_1_1MPI_html_a9e963546bd81b0cdd88e1840cfa8f227"><div class="ttname"><a href="namespaceUtilities_1_1MPI.html#a9e963546bd81b0cdd88e1840cfa8f227">Utilities::MPI::reduce</a></div><div class="ttdeci">T reduce(const T &amp;local_value, const MPI_Comm &amp;comm, const std::function&lt; T(const T &amp;, const T &amp;)&gt; &amp;combiner, const unsigned int root_process=0)</div></div>
<div class="ttc" id="vectorization_8h_html_aafbdfdd72b6cfe4eae5fa7a16385582f"><div class="ttname"><a href="vectorization_8h.html#aafbdfdd72b6cfe4eae5fa7a16385582f">std::abs</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; abs(const ::VectorizedArray&lt; Number, width &gt; &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05502">vectorization.h:5502</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceDerivativeApproximation_1_1internal_html_a4bea05d5ab84ca1e802db9a0217d1d6c"><div class="ttname"><a href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">DerivativeApproximation::internal::approximate</a></div><div class="ttdeci">void approximate(SynchronousIterators&lt; std::tuple&lt; typename DoFHandler&lt; dim, spacedim &gt;::active_cell_iterator, Vector&lt; float &gt;::iterator &gt;&gt; const &amp;cell, const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const InputVector &amp;solution, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__approximation_8cc_source.html#l00918">derivative_approximation.cc:918</a></div></div>
<div class="ttc" id="classFEEvaluation_html"><div class="ttname"><a href="classFEEvaluation.html">FEEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__evaluation_8h_source.html#l00071">fe_evaluation.h:71</a></div></div>
<div class="ttc" id="classFEEvaluation_html_ad61cbe0d7d6138be040d46ae06a268f1"><div class="ttname"><a href="classFEEvaluation.html#ad61cbe0d7d6138be040d46ae06a268f1">FEEvaluation::integrate</a></div><div class="ttdeci">void integrate(const EvaluationFlags::EvaluationFlags integration_flag)</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
