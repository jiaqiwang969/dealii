<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/origin_2base_2graph__coloring_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-origin/base/graph_coloring.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_1627ce85bc33b76c4cb222dfe9aeffd7.html">deal.II-origin</a></li><li class="navelem"><a class="el" href="dir_44197ca9d3d2f23a5e88b57427341144.html">base</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">graph_coloring.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="origin_2base_2graph__coloring_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">// Copyright (C) 2013 - 2020 by the deal.II authors</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment">// This file is part of the deal.II library.</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment">// The deal.II library is free software; you can use it, redistribute</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">// it, and/or modify it under the terms of the GNU Lesser General</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// Public License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment">// version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment">// The full text of the license can be found in the file LICENSE.md at</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment">// the top level directory of deal.II.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">//</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">// ---------------------------------------------------------------------</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#ifndef dealii_graph_coloring_h</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#  define dealii_graph_coloring_h</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="config_8h.html">deal.II/base/config.h</a>&gt;</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="base_2thread__management_8h.html">deal.II/base/thread_management.h</a>&gt;</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#  include &lt;<a class="code" href="lac_2sparsity__tools_8h.html">deal.II/lac/sparsity_tools.h</a>&gt;</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#  include &lt;functional&gt;</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#  include &lt;set&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#  include &lt;unordered_map&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#  include &lt;unordered_set&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#  include &lt;vector&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160; </div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<a class="code" href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceGraphColoring.html">GraphColoring</a></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;{</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <span class="keyword">namespace </span><a class="code" href="namespaceinternal.html">internal</a></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keyword">inline</span> <span class="keywordtype">bool</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="namespaceGraphColoring_1_1internal.html#a882325d218296e70ed19ce77e8bf9f41">have_nonempty_intersection</a>(</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;      <span class="keyword">const</span> std::vector&lt;types::global_dof_index&gt; &amp;indices1,</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <span class="keyword">const</span> std::vector&lt;types::global_dof_index&gt; &amp;indices2)</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="comment">// we assume that both arrays are sorted, so we can walk</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      <span class="comment">// them in lockstep and see if we encounter an index that&#39;s</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      <span class="comment">// in both arrays. once we reach the end of either array,</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="comment">// we know that there is no intersection</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;      std::vector&lt;types::global_dof_index&gt;::const_iterator <a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a> = indices1.begin(),</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                                                           q = indices2.begin();</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;      <span class="keywordflow">while</span> ((<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a> != indices1.end()) &amp;&amp; (q != indices2.end()))</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;          <span class="keywordflow">if</span> (*<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a> &lt; *q)</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            ++<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a>;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (*<a class="code" href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a> &gt; *q)</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;            ++q;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="comment">// conflict found!</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="comment">// no conflict found!</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iterator&gt;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    std::vector&lt;std::vector&lt;Iterator&gt;&gt;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="namespaceGraphColoring_1_1internal.html#aca3050dffaa5fc5ab2d768104f7e5e1c">create_partitioning</a>(</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;      <span class="keyword">const</span> Iterator &amp;                         <a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structidentity.html#af719060789239a0a2ba383c2697bd820">identity&lt;Iterator&gt;::type</a> &amp;<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>,</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;      <span class="keyword">const</span> <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;std::vector&lt;types::global_dof_index&gt;(</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keyword">const</span> Iterator &amp;)&gt; &amp;                   get_conflict_indices)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    {</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;      <span class="comment">// Number of iterators.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_iterators = 0;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <span class="comment">// Create a map from conflict indices to iterators</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      std::unordered_map&lt;types::global_dof_index, std::vector&lt;Iterator&gt;&gt;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        indices_to_iterators;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      <span class="keywordflow">for</span> (Iterator <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> = <a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> != <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>; ++<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>)</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;          <span class="keyword">const</span> std::vector&lt;types::global_dof_index&gt; conflict_indices =</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            get_conflict_indices(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_conflict_indices = conflict_indices.size();</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; n_conflict_indices; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            indices_to_iterators[conflict_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]].<a class="code" href="q__collection__0_8txt.html#a98a6b91a750cdd7301bb66162fa71e80">push_back</a>(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;          ++n_iterators;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;      <span class="comment">// create the very first zone which contains only the first</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      <span class="comment">// iterator. then create the other zones. keep track of all the</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;      <span class="comment">// iterators that have already been assigned to a zone</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      std::vector&lt;std::vector&lt;Iterator&gt;&gt; zones(1,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                               std::vector&lt;Iterator&gt;(1, <a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>));</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      std::set&lt;Iterator&gt;                 used_it;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      used_it.insert(<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="keywordflow">while</span> (used_it.size() != n_iterators)</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;          <span class="comment">// loop over the elements of the previous zone. for each element of</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;          <span class="comment">// the previous zone, get the conflict indices and from there get</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;          <span class="comment">// those iterators that are conflicting with the current element</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;          <span class="keyword">typename</span> <a class="code" href="iterators__0_8txt.html#af097ebed8c9801249bc4d7d46222930b">std::vector&lt;Iterator&gt;::iterator</a> previous_zone_it(</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            zones.back().begin());</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;          <span class="keyword">typename</span> <a class="code" href="iterators__0_8txt.html#af097ebed8c9801249bc4d7d46222930b">std::vector&lt;Iterator&gt;::iterator</a> previous_zone_end(</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            zones.back().end());</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;          std::vector&lt;Iterator&gt; new_zone;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;          <span class="keywordflow">for</span> (; previous_zone_it != previous_zone_end; ++previous_zone_it)</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;              <span class="keyword">const</span> std::vector&lt;types::global_dof_index&gt; conflict_indices =</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                get_conflict_indices(*previous_zone_it);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_conflict_indices(conflict_indices.size());</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; n_conflict_indices; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                  <span class="keyword">const</span> std::vector&lt;Iterator&gt; &amp;conflicting_elements =</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    indices_to_iterators[conflict_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]];</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; conflicting_elements.size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                      <span class="comment">// check that the iterator conflicting with the current</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                      <span class="comment">// one is not associated to a zone yet and if so, assign</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                      <span class="comment">// it to the current zone. mark it as used</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                      <span class="comment">//</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                      <span class="comment">// we can shortcut this test if the conflicting iterator</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                      <span class="comment">// is the current iterator</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                      <span class="keywordflow">if</span> ((conflicting_elements[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] != *previous_zone_it) &amp;&amp;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                          (used_it.count(conflicting_elements[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]) == 0))</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                        {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                          new_zone.push_back(conflicting_elements[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                          used_it.insert(conflicting_elements[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                        }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;                    }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;          <span class="comment">// If there are iterators in the new zone, then the zone is added to</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;          <span class="comment">// the partition. Otherwise, the graph is disconnected and we need to</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;          <span class="comment">// find an iterator on the other part of the graph. start the whole</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;          <span class="comment">// process again with the first iterator that hasn&#39;t been assigned to</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;          <span class="comment">// a zone yet</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;          <span class="keywordflow">if</span> (new_zone.size() != 0)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            zones.push_back(new_zone);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;            <span class="keywordflow">for</span> (Iterator <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> = <a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>; <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> != <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>; ++<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>)</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;              <span class="keywordflow">if</span> (used_it.count(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>) == 0)</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                  zones.push_back(std::vector&lt;Iterator&gt;(1, <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>));</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                  used_it.insert(<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        }</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">return</span> zones;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iterator&gt;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordtype">void</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <a class="code" href="namespaceGraphColoring_1_1internal.html#abaf2ce58eca7c18a4d7ecd6e2747d690">make_dsatur_coloring</a>(</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      std::vector&lt;Iterator&gt; &amp;             <a class="code" href="repartitioning__policy__tools__0_8txt.html#ad72b731ec4910675337cb83132a0f916">partition</a>,</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      <span class="keyword">const</span> <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;std::vector&lt;types::global_dof_index&gt;(</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        <span class="keyword">const</span> Iterator &amp;)&gt; &amp;              get_conflict_indices,</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;std::vector&lt;Iterator&gt;&gt; &amp;partition_coloring)</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      partition_coloring.clear();</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="comment">// Number of zones composing the partitioning.</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>        partition_size(<a class="code" href="repartitioning__policy__tools__0_8txt.html#ad72b731ec4910675337cb83132a0f916">partition</a>.size());</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      std::vector&lt;unsigned int&gt; sorted_vertices(partition_size);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      std::vector&lt;int&gt;          <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a>(partition_size);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      std::vector&lt;std::vector&lt;types::global_dof_index&gt;&gt; conflict_indices(</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        partition_size);</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      std::vector&lt;std::vector&lt;unsigned int&gt;&gt; <a class="code" href="matrixfree__0_8txt.html#a0e885fb208d1ce6459d5c961d3ca0b54">graph</a>(partition_size);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">// Get the conflict indices associated to each iterator. The</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="comment">// conflict_indices have to be sorted so we can more easily find conflicts</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <span class="comment">// later on</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;          conflict_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = get_conflict_indices(<a class="code" href="repartitioning__policy__tools__0_8txt.html#ad72b731ec4910675337cb83132a0f916">partition</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;          std::sort(conflict_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>(), conflict_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>());</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="comment">// Compute the degree of each vertex of the graph using the</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="comment">// intersection of the conflict indices.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> + 1; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; partition_size; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;          <span class="comment">// If the two iterators share indices then we increase the degree of</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;          <span class="comment">// the vertices and create an &#39;&#39;edge&#39;&#39; in the graph.</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="namespaceGraphColoring_1_1internal.html#a882325d218296e70ed19ce77e8bf9f41">have_nonempty_intersection</a>(conflict_indices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                         conflict_indices[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>]))</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;              ++<a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>];</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;              ++<a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>];</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;              <a class="code" href="matrixfree__0_8txt.html#a0e885fb208d1ce6459d5c961d3ca0b54">graph</a>[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].push_back(<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;              <a class="code" href="matrixfree__0_8txt.html#a0e885fb208d1ce6459d5c961d3ca0b54">graph</a>[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].push_back(<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;            }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <span class="comment">// Sort the vertices by decreasing degree.</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="iterators__0_8txt.html#af097ebed8c9801249bc4d7d46222930b">std::vector&lt;int&gt;::iterator</a> degrees_it;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;          <span class="comment">// Find the largest element.</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;          degrees_it         = std::max_element(<a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a>.begin(), <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a>.end());</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;          sorted_vertices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>] = degrees_it - <a class="code" href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a>.begin();</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;          <span class="comment">// Put the largest element to -1 so it cannot be chosen again.</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;          *degrees_it = -1;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="comment">// Color the graph.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      std::vector&lt;std::unordered_set&lt;unsigned int&gt;&gt; colors_used;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> current_vertex(sorted_vertices[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;          <span class="keywordtype">bool</span>               new_color(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;          <span class="comment">// Try to use an existing color, i.e., try to find a color which is</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;          <span class="comment">// not associated to one of the vertices linked to current_vertex.</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;          <span class="comment">// Loop over the color.</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; partition_coloring.size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              <span class="comment">// Loop on the vertices linked to current_vertex. If one vertex</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;              <span class="comment">// linked to current_vertex is already using the color j, this</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;              <span class="comment">// color cannot be used anymore.</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;              <span class="keywordtype">bool</span> unused_color(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> adjacent_vertex : <a class="code" href="matrixfree__0_8txt.html#a0e885fb208d1ce6459d5c961d3ca0b54">graph</a>[current_vertex])</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                <span class="keywordflow">if</span> (colors_used[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].<a class="code" href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a>(adjacent_vertex) == 1)</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                  {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                    unused_color = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                  }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;              <span class="keywordflow">if</span> (unused_color)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                  partition_coloring[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].push_back(<a class="code" href="repartitioning__policy__tools__0_8txt.html#ad72b731ec4910675337cb83132a0f916">partition</a>[current_vertex]);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                  colors_used[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].insert(current_vertex);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                  new_color = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                  <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;          <span class="comment">// Add a new color.</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;          <span class="keywordflow">if</span> (new_color)</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              partition_coloring.push_back(</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                std::vector&lt;Iterator&gt;(1, <a class="code" href="repartitioning__policy__tools__0_8txt.html#ad72b731ec4910675337cb83132a0f916">partition</a>[current_vertex]));</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;              std::unordered_set&lt;unsigned int&gt; tmp;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;              tmp.insert(current_vertex);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;              colors_used.push_back(tmp);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            }</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160; </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iterator&gt;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    std::vector&lt;std::vector&lt;Iterator&gt;&gt;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <a class="code" href="namespaceGraphColoring_1_1internal.html#a16d4209d0fe429cd85ba1fc360d19205">gather_colors</a>(</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      <span class="keyword">const</span> <a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;<a class="code" href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">std::vector</a>&lt;std::vector&lt;Iterator&gt;&gt;&gt; &amp;partition_coloring)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      std::vector&lt;std::vector&lt;Iterator&gt;&gt; coloring;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      <span class="comment">// Count the number of iterators in each color.</span></div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> partition_size(partition_coloring.size());</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      std::vector&lt;std::vector&lt;unsigned int&gt;&gt; colors_counter(partition_size);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_colors(partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>());</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;          colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].resize(n_colors);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; n_colors; ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>][<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] = partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>][<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>();</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <span class="comment">// Find the partition with the largest number of colors for the even</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      <span class="comment">// partition.</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>       i_color(0);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>       max_even_n_colors(0);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> colors_size(colors_counter.size());</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; colors_size; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> += 2)</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;          <span class="keywordflow">if</span> (max_even_n_colors &lt; colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>())</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            {</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;              max_even_n_colors = colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].size();</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;              i_color           = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;        }</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      coloring.resize(max_even_n_colors);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; colors_counter[i_color].size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        coloring[<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] = partition_coloring[i_color][<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>];</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160; </div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> += 2)</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        {</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> != i_color)</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;              std::unordered_set&lt;unsigned int&gt; used_k;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                  <span class="comment">// Find the color in the current partition with the largest</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                  <span class="comment">// number of iterators.</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                  <a class="code" href="iterators__0_8txt.html#af097ebed8c9801249bc4d7d46222930b">std::vector&lt;unsigned int&gt;::iterator</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                  <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> = std::max_element(colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>(),</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                        colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>());</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> min_iterators(<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(-1));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos(0);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                  <span class="comment">// Find the color of coloring with the least number of colors</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                  <span class="comment">// among the colors that have not been used yet.</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a> = 0; <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a> &lt; max_even_n_colors; ++<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>)</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                    <span class="keywordflow">if</span> (used_k.count(<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>) == 0)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                      <span class="keywordflow">if</span> (colors_counter[i_color][<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>] &lt; min_iterators)</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                        {</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                          min_iterators = colors_counter[i_color][<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>];</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                          pos           = <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                  colors_counter[i_color][pos] += *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                  <span class="comment">// Concatenate the current color with the existing coloring.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                  coloring[pos].insert(</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    coloring[pos].<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>(),</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>][<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> - colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>()]</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                      .<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>(),</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>][<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> - colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>()]</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                      .<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>());</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                  used_k.insert(pos);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                  <span class="comment">// Put the number of iterators to the current color to zero.</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                  *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> = 0;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      <span class="comment">// If there is more than one partition, do the same thing that we did for</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <span class="comment">// the even partitions to the odd partitions</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      <span class="keywordflow">if</span> (partition_size &gt; 1)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_odd_n_colors(0);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 1; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> += 2)</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;              <span class="keywordflow">if</span> (max_odd_n_colors &lt; colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a>())</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                  max_odd_n_colors = colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].size();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                  i_color          = <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;            }</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          coloring.resize(max_even_n_colors + max_odd_n_colors);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; colors_counter[i_color].size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;            coloring[max_even_n_colors + <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>] = partition_coloring[i_color][<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>];</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 1; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partition_size; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> += 2)</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;            {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> != i_color)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                  std::unordered_set&lt;unsigned int&gt; used_k;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> = 0; <a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a> &lt; colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].size(); ++<a class="code" href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a>)</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                    {</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                      <span class="comment">// Find the color in the current partition with the</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                      <span class="comment">// largest number of iterators.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                      <a class="code" href="iterators__0_8txt.html#af097ebed8c9801249bc4d7d46222930b">std::vector&lt;unsigned int&gt;::iterator</a> <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                      <a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> = std::max_element(colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>(),</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                            colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>());</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> min_iterators(<span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span>(-1));</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> pos(0);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                      <span class="comment">// Find the color of coloring with the least number of</span></div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                      <span class="comment">// colors among the colors that have not been used yet.</span></div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a> = 0; <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a> &lt; max_odd_n_colors; ++<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>)</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                        <span class="keywordflow">if</span> (used_k.count(<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>) == 0)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                          <span class="keywordflow">if</span> (colors_counter[i_color][<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>] &lt; min_iterators)</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                            {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                              min_iterators = colors_counter[i_color][<a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>];</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                              pos           = <a class="code" href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a>;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                            }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;                      colors_counter[i_color][pos] += *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                      <span class="comment">// Concatenate the current color with the existing</span></div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                      <span class="comment">// coloring.</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;                      coloring[max_even_n_colors + pos].insert(</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                        coloring[max_even_n_colors + pos].<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>(),</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;                        partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>][<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> - colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>()]</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;                          .<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>(),</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;                        partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>][<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> - colors_counter[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>].<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>()]</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                          .<a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>());</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                      used_k.insert(pos);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;                      <span class="comment">// Put the number of iterators to the current color to</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                      <span class="comment">// zero.</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                      *<a class="code" href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a> = 0;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                    }</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;                }</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        }</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      <span class="keywordflow">return</span> coloring;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    }</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  } <span class="comment">// namespace internal</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> Iterator&gt;</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  std::vector&lt;std::vector&lt;Iterator&gt;&gt;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;  <a class="code" href="namespaceGraphColoring.html#aaf3752a89e5216b3b34ddaa57cb312ee">make_graph_coloring</a>(</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keyword">const</span> Iterator &amp;                               <a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>,</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structidentity.html#af719060789239a0a2ba383c2697bd820">identity&lt;Iterator&gt;::type</a> &amp;      <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>,</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;    <span class="keyword">const</span> <a class="code" href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">std::function</a>&lt;std::vector&lt;types::global_dof_index&gt;(</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="keyword">const</span> <span class="keyword">typename</span> <a class="code" href="structidentity.html#af719060789239a0a2ba383c2697bd820">identity&lt;Iterator&gt;::type</a> &amp;)&gt; &amp;get_conflict_indices)</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a> != <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;           <a class="code" href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">ExcMessage</a>(</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;             <span class="stringliteral">&quot;GraphColoring is not prepared to deal with empty ranges!&quot;</span>));</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160; </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    <span class="comment">// Create the partitioning.</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    std::vector&lt;std::vector&lt;Iterator&gt;&gt; partitioning =</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;      <a class="code" href="namespaceGraphColoring_1_1internal.html#aca3050dffaa5fc5ab2d768104f7e5e1c">internal::create_partitioning</a>(<a class="code" href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a>, <a class="code" href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a>, get_conflict_indices);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="comment">// Color the iterators within each partition.</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="comment">// Run the coloring algorithm on each zone in parallel</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> partitioning_size(partitioning.size());</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    std::vector&lt;std::vector&lt;std::vector&lt;Iterator&gt;&gt;&gt; partition_coloring(</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      partitioning_size);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="classThreads_1_1TaskGroup.html">Threads::TaskGroup&lt;&gt;</a> <a class="code" href="multithreading__0_8txt.html#a3eb2ad97e22e5edf45cbc97570908143">tasks</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> = 0; <a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a> &lt; partitioning_size; ++<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      <a class="code" href="multithreading__0_8txt.html#a3eb2ad97e22e5edf45cbc97570908143">tasks</a> += <a class="code" href="group__threads.html#ga664740f5d3f738649ac2811f8d656d11">Threads::new_task</a>(&amp;internal::make_dsatur_coloring&lt;Iterator&gt;,</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                                 partitioning[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>],</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                                 get_conflict_indices,</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                 partition_coloring[<a class="code" href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a>]);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="multithreading__0_8txt.html#a3eb2ad97e22e5edf45cbc97570908143">tasks</a>.join_all();</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// Gather the colors together.</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceGraphColoring_1_1internal.html#a16d4209d0fe429cd85ba1fc360d19205">internal::gather_colors</a>(partition_coloring);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;  }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  <a class="code" href="namespaceGraphColoring.html#a1c424612216550c5940c6526a2f17fcc">color_sparsity_pattern</a>(<span class="keyword">const</span> <a class="code" href="classSparsityPattern.html">SparsityPattern</a> &amp;    <a class="code" href="trilinos__sparse__matrix__0_8txt.html#ab4e34663c28496ee1b07f40fd5d00fa1">sparsity_pattern</a>,</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                         std::vector&lt;unsigned int&gt; &amp;color_indices);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160; </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;} <span class="comment">// namespace GraphColoring</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<a class="code" href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; </div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment">//----------------------------   graph_coloring.h ---------------------------</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;<span class="comment">// end of #ifndef dealii_graph_coloring_h</span></div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;<span class="comment">//----------------------------   graph_coloring.h ---------------------------</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructidentity_html_af719060789239a0a2ba383c2697bd820"><div class="ttname"><a href="structidentity.html#af719060789239a0a2ba383c2697bd820">identity::type</a></div><div class="ttdeci">T type</div><div class="ttdef"><b>Definition:</b> <a href="base_2template__constraints_8h_source.html#l00193">template_constraints.h:193</a></div></div>
<div class="ttc" id="apolynomial__0_8txt_html_af1258c87f1d73d29bd17331843ac1d25"><div class="ttname"><a href="polynomial__0_8txt.html#af1258c87f1d73d29bd17331843ac1d25">i</a></div><div class="ttdeci">namespace in which classes relating to the description of d polynomial spaces are declared ***Base class for all D polynomials A polynomial is represented in this class by its coefficients which are set through the constructor or by derived classes There are two paths for evaluation of polynomials One is based on the coefficients which are evaluated through the Horner scheme which is a robust general purpose scheme An alternative and more stable evaluation of high degree polynomials with roots in the unit interval is provided by a product in terms of the roots This form is available for special polynomials such as Lagrange polynomials or Legendre polynomials and used with the respective constructor To obtain this more stable evaluation form the constructor with the roots in form of a Lagrange polynomial must be used In case a manipulation is done that changes the roots the representation is switched to the coefficient form This class is a typical example of a possible template argument for the TensorProductPolynomials class **Constructor The coefficients of the polynomial are passed as and denote the i e the first element of the array denotes the constant the second the linear and so on The degree of the polynomial represented by this object is thus the number of elements in the&lt; tt &gt; coefficient&lt;/tt &gt; array minus one **Constructor creating a zero polynomial of degree *[2.x.3] *Constructor for a Lagrange polynomial and its point of evaluation The idea is to where j is the evaluation point specified as argument and the support points contain all the evaluation is based on products of the whereas the Horner scheme is used for polynomials in the coefficient form **Return the values and the derivatives of the Polynomial at point&lt; tt &gt; x&lt;/tt &gt;&lt; tt &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__0_8txt_source.html#l00024">polynomial_0.txt:24</a></div></div>
<div class="ttc" id="agroup__threads_html_ga664740f5d3f738649ac2811f8d656d11"><div class="ttname"><a href="group__threads.html#ga664740f5d3f738649ac2811f8d656d11">Threads::new_task</a></div><div class="ttdeci">Task&lt; RT &gt; new_task(const std::function&lt; RT()&gt; &amp;function)</div><div class="ttdef"><b>Definition:</b> <a href="base_2thread__management_8h_source.html#l01316">thread_management.h:1316</a></div></div>
<div class="ttc" id="alac_2sparsity__tools_8h_html"><div class="ttname"><a href="lac_2sparsity__tools_8h.html">sparsity_tools.h</a></div></div>
<div class="ttc" id="anamespaceGraphColoring_html_aaf3752a89e5216b3b34ddaa57cb312ee"><div class="ttname"><a href="namespaceGraphColoring.html#aaf3752a89e5216b3b34ddaa57cb312ee">GraphColoring::make_graph_coloring</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Iterator &gt; &gt; make_graph_coloring(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, const std::function&lt; std::vector&lt; types::global_dof_index &gt;(const typename identity&lt; Iterator &gt;::type &amp;)&gt; &amp;get_conflict_indices)</div><div class="ttdef"><b>Definition:</b> <a href="base_2graph__coloring_8h_source.html#l00572">graph_coloring.h:572</a></div></div>
<div class="ttc" id="anamespaceGraphColoring_1_1internal_html_a882325d218296e70ed19ce77e8bf9f41"><div class="ttname"><a href="namespaceGraphColoring_1_1internal.html#a882325d218296e70ed19ce77e8bf9f41">GraphColoring::internal::have_nonempty_intersection</a></div><div class="ttdeci">bool have_nonempty_intersection(const std::vector&lt; types::global_dof_index &gt; &amp;indices1, const std::vector&lt; types::global_dof_index &gt; &amp;indices2)</div><div class="ttdef"><b>Definition:</b> <a href="base_2graph__coloring_8h_source.html#l00055">graph_coloring.h:55</a></div></div>
<div class="ttc" id="abase_2thread__management_8h_html"><div class="ttname"><a href="base_2thread__management_8h.html">thread_management.h</a></div></div>
<div class="ttc" id="anamespaceGraphColoring_1_1internal_html_aca3050dffaa5fc5ab2d768104f7e5e1c"><div class="ttname"><a href="namespaceGraphColoring_1_1internal.html#aca3050dffaa5fc5ab2d768104f7e5e1c">GraphColoring::internal::create_partitioning</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Iterator &gt; &gt; create_partitioning(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, const std::function&lt; std::vector&lt; types::global_dof_index &gt;(const Iterator &amp;)&gt; &amp;get_conflict_indices)</div><div class="ttdef"><b>Definition:</b> <a href="base_2graph__coloring_8h_source.html#l00110">graph_coloring.h:110</a></div></div>
<div class="ttc" id="anamespaceGraphColoring_html"><div class="ttname"><a href="namespaceGraphColoring.html">GraphColoring</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2graph__coloring_8h_source.html#l00041">graph_coloring.h:41</a></div></div>
<div class="ttc" id="apolynomials__abf__0_8txt_html_a7a716deb19e461cf8ba2a26e01c6a908"><div class="ttname"><a href="polynomials__abf__0_8txt.html#a7a716deb19e461cf8ba2a26e01c6a908">k</a></div><div class="ttdeci">*This class implements the[1.x.0] vector valued Arnold Boffi Falk polynomials as described in the article by Arnold Boffi SIAM J Numer Anal pp **The ABF polynomials are constructed such that the divergence is in the tensor product polynomial space[1.x.1] the polynomial order of each component must be two orders higher in the corresponding yielding the polynomial spaces[1.x.2] and[1.x.3] in resp ******Constructor Creates all basis functions for Raviart Thomas polynomials of given degree[2.x.1] k</div><div class="ttdef"><b>Definition:</b> <a href="polynomials__abf__0_8txt_source.html#l00013">polynomials_abf_0.txt:13</a></div></div>
<div class="ttc" id="anumerical__algorithms__0_8txt_html_a852a1e245dd2de4943eeb66beeaf65b1"><div class="ttname"><a href="numerical__algorithms__0_8txt.html#a852a1e245dd2de4943eeb66beeaf65b1">vector</a></div><div class="ttdeci">****This module groups a diverse set of classes that generally implement some sort of numerical algorithm on top all the basic and finite element classes in the library They are generally unconnected to each other *Some of the like KellyErrorEstimator and act on solutions already and compute derived quantities in the first two or help transferring a set of vectors from one mesh to another *The namespaces and VectorTools provide an assortment of such as creating a Laplace projecting or interpolating a function onto the present finite element etc The difference to the functions in the DoFTools and FETools functions is that they work on the DoFTools functions only act on a given DoFHandler object without reference to a data vector</div><div class="ttdef"><b>Definition:</b> <a href="numerical__algorithms__0_8txt_source.html#l00008">numerical_algorithms_0.txt:8</a></div></div>
<div class="ttc" id="aiterators__0_8txt_html_af097ebed8c9801249bc4d7d46222930b"><div class="ttname"><a href="iterators__0_8txt.html#af097ebed8c9801249bc4d7d46222930b">iterator</a></div><div class="ttdeci">lt iterator(or omitted, For example,[1.x.2] exampleall cells, have children,[1.x.3] have children, act on, For completeness, the triangulation, use rawiterators, For instance)</div></div>
<div class="ttc" id="amatrixfree__0_8txt_html_a0e885fb208d1ce6459d5c961d3ca0b54"><div class="ttname"><a href="matrixfree__0_8txt.html#a0e885fb208d1ce6459d5c961d3ca0b54">graph</a></div><div class="ttdeci">****This module describes the matrix free infrastructure in deal II An outline of how the primary groups of classes in deal II interact with the matrix free infrastructure is given by the following clickable graph</div><div class="ttdef"><b>Definition:</b> <a href="matrixfree__0_8txt_source.html#l00006">matrixfree_0.txt:6</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_gae9a45f517af1401c50811a11083f9114"><div class="ttname"><a href="group__Exceptions.html#gae9a45f517af1401c50811a11083f9114">StandardExceptions::ExcMessage</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcMessage(std::string arg1)</div></div>
<div class="ttc" id="aconfig_8h_html_a37029dc5bac94f70ea13386b692956b6"><div class="ttname"><a href="config_8h.html#a37029dc5bac94f70ea13386b692956b6">DEAL_II_NAMESPACE_OPEN</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_OPEN</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00398">config.h:398</a></div></div>
<div class="ttc" id="atria__accessor_8templates__0_8txt_html_a456453dd94fbd82cfc84e80f1bb9b520"><div class="ttname"><a href="tria__accessor_8templates__0_8txt.html#a456453dd94fbd82cfc84e80f1bb9b520">count</a></div><div class="ttdeci">*Compute the diameter for a given set of vertices The vertices are depending on their count</div><div class="ttdef"><b>Definition:</b> <a href="tria__accessor_8templates__0_8txt_source.html#l00002">tria_accessor.templates_0.txt:2</a></div></div>
<div class="ttc" id="aindex__set__0_8txt_html_a06c4d20c91ab07a0e74210eb580db6d1"><div class="ttname"><a href="index__set__0_8txt.html#a06c4d20c91ab07a0e74210eb580db6d1">begin</a></div><div class="ttdeci">*A class that represents a subset of indices among a larger set For example it can be used to denote the set of degrees of freedom within the range[2.x.0] that belongs to a particular or those among all degrees of freedom that are stored on a particular processor in a distributed parallel computation *This class can represent a collection of half open ranges of indices as well as individual elements For practical purposes it also stores the overall range these indices can assume In other words you need to specify the size of the index space[2.x.1] of which objects of this class are a subset *There are two ways to iterate over the begin() and end() allow iteration over individual indices in the set. Second</div></div>
<div class="ttc" id="anamespaceGraphColoring_html_a1c424612216550c5940c6526a2f17fcc"><div class="ttname"><a href="namespaceGraphColoring.html#a1c424612216550c5940c6526a2f17fcc">GraphColoring::color_sparsity_pattern</a></div><div class="ttdeci">unsigned int color_sparsity_pattern(const SparsityPattern &amp;sparsity_pattern, std::vector&lt; unsigned int &gt; &amp;color_indices)</div><div class="ttdef"><b>Definition:</b> <a href="graph__coloring_8cc_source.html#l00024">graph_coloring.cc:24</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a7a17f790f94a4539645c427e98239a81"><div class="ttname"><a href="coding__conventions__0_8txt.html#a7a17f790f94a4539645c427e98239a81">function</a></div><div class="ttdeci">functions which clear bits or flags should be named[2.x.15] use[2.x.18] instead of *[2.x.19] In the implementation after each function</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00021">coding_conventions_0.txt:21</a></div></div>
<div class="ttc" id="atrilinos__sparse__matrix__0_8txt_html_ab4e34663c28496ee1b07f40fd5d00fa1"><div class="ttname"><a href="trilinos__sparse__matrix__0_8txt.html#ab4e34663c28496ee1b07f40fd5d00fa1">sparsity_pattern</a></div><div class="ttdeci">all column elements of a row are stored on the same processor in any case The vector&lt; tt &gt; n_entries_per_row&lt;/tt &gt; specifies the number of entries in each row of the newly generated matrix **This function is initializes the Trilinos Epetra matrix according to the specified sparsity_pattern</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix__0_8txt_source.html#l00162">trilinos_sparse_matrix_0.txt:162</a></div></div>
<div class="ttc" id="aclassSparsityPattern_html"><div class="ttname"><a href="classSparsityPattern.html">SparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="lac_2sparsity__pattern_8h_source.html#l00900">sparsity_pattern.h:900</a></div></div>
<div class="ttc" id="aautomatic__and__symbolic__differentiation__0_8txt_html_ac5d1c63883bb2a85710935e76a7dedd4"><div class="ttname"><a href="automatic__and__symbolic__differentiation__0_8txt.html#ac5d1c63883bb2a85710935e76a7dedd4">it</a></div><div class="ttdeci">******to automatic and symbolic differentiation *Below we provide a very brief introduction as to what automatic and symbolic differentiation what variations of these computational numerical schemes and how they are integrated within deal II s framework The purpose of all of these schemes is to automatically compute the derivative of or approximations of it</div><div class="ttdef"><b>Definition:</b> <a href="automatic__and__symbolic__differentiation__0_8txt_source.html#l00010">automatic_and_symbolic_differentiation_0.txt:10</a></div></div>
<div class="ttc" id="anamespaceGraphColoring_1_1internal_html_abaf2ce58eca7c18a4d7ecd6e2747d690"><div class="ttname"><a href="namespaceGraphColoring_1_1internal.html#abaf2ce58eca7c18a4d7ecd6e2747d690">GraphColoring::internal::make_dsatur_coloring</a></div><div class="ttdeci">void make_dsatur_coloring(std::vector&lt; Iterator &gt; &amp;partition, const std::function&lt; std::vector&lt; types::global_dof_index &gt;(const Iterator &amp;)&gt; &amp;get_conflict_indices, std::vector&lt; std::vector&lt; Iterator &gt;&gt; &amp;partition_coloring)</div><div class="ttdef"><b>Definition:</b> <a href="base_2graph__coloring_8h_source.html#l00266">graph_coloring.h:266</a></div></div>
<div class="ttc" id="anamespaceGraphColoring_1_1internal_html_a16d4209d0fe429cd85ba1fc360d19205"><div class="ttname"><a href="namespaceGraphColoring_1_1internal.html#a16d4209d0fe429cd85ba1fc360d19205">GraphColoring::internal::gather_colors</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; Iterator &gt; &gt; gather_colors(const std::vector&lt; std::vector&lt; std::vector&lt; Iterator &gt;&gt;&gt; &amp;partition_coloring)</div><div class="ttdef"><b>Definition:</b> <a href="base_2graph__coloring_8h_source.html#l00372">graph_coloring.h:372</a></div></div>
<div class="ttc" id="aq__collection__0_8txt_html_a98a6b91a750cdd7301bb66162fa71e80"><div class="ttname"><a href="q__collection__0_8txt.html#a98a6b91a750cdd7301bb66162fa71e80">push_back</a></div><div class="ttdeci">they need not even be of the same size in this case The same arguments about the order of elements of collections by the also be made about the elements of[2.x.13] objects This class creates a copy of the given quadrature object i e you can do things like&lt; tt &gt; push_back(QGauss&lt; dim &gt;(3))</div></div>
<div class="ttc" id="arepartitioning__policy__tools__0_8txt_html_ad72b731ec4910675337cb83132a0f916"><div class="ttname"><a href="repartitioning__policy__tools__0_8txt.html#ad72b731ec4910675337cb83132a0f916">partition</a></div><div class="ttdeci">namespace with repartitioning policies These classes return vectors of of the new owners of the active locally owned and ghost cells of a Triangulation object The returned vectors can be used e g in[2.x.0] to create a[2.x.1] based on a given Triangulation and the predescribed partition</div><div class="ttdef"><b>Definition:</b> <a href="repartitioning__policy__tools__0_8txt_source.html#l00002">repartitioning_policy_tools_0.txt:2</a></div></div>
<div class="ttc" id="agroup__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01581">exceptions.h:1581</a></div></div>
<div class="ttc" id="afe__q__0_8txt_html_a1a8eaafa20c4d8c9ab128b62a984738c"><div class="ttname"><a href="fe__q__0_8txt.html#a1a8eaafa20c4d8c9ab128b62a984738c">degrees</a></div><div class="ttdeci">*Implementation of a scalar Lagrange finite element[2.x.0] that yields the finite element space of piecewise polynomials of degree[2.x.1] in each coordinate direction This class is realized using tensor product polynomials based on D Lagrange polynomials with Gauss or given support points *The standard constructor of this class takes the degree[2.x.2] of this finite element it can take a quadrature formula[2.x.3] defining the support points of the Lagrange interpolation in one coordinate direction *For more information about the&lt; tt &gt; spacedim&lt;/tt &gt; template parameter check the documentation of FiniteElement or the one of Triangulation **The constructor creates a TensorProductPolynomials object that includes the tensor product of[2.x.4] polynomials of degree[2.x.5] This[2.x.6] object provides all values and derivatives of the shape functions In case a quadrature rule is the constructor creates a TensorProductPolynomials object that includes the tensor product of[2.x.7] polynomials with the support points from *[2.x.8] Furthermore the constructor fills the[2.x.9] the[2.x.10] equidistant support points at i where one polynomial is one and all the others are zero For higher polynomial degrees</div><div class="ttdef"><b>Definition:</b> <a href="fe__q__0_8txt_source.html#l00009">fe_q_0.txt:9</a></div></div>
<div class="ttc" id="aclassThreads_1_1TaskGroup_html"><div class="ttname"><a href="classThreads_1_1TaskGroup.html">Threads::TaskGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2thread__management_8h_source.html#l01472">thread_management.h:1472</a></div></div>
<div class="ttc" id="acoding__conventions__0_8txt_html_a177c697348e3052c514824563807ea3b"><div class="ttname"><a href="coding__conventions__0_8txt.html#a177c697348e3052c514824563807ea3b">end</a></div><div class="ttdeci">**Throughout deal we strive to keep our programming style and the kind ofinterfaces we provide as consistent as possible To this end</div><div class="ttdef"><b>Definition:</b> <a href="coding__conventions__0_8txt_source.html#l00003">coding_conventions_0.txt:3</a></div></div>
<div class="ttc" id="aconfig_8h_html"><div class="ttname"><a href="config_8h.html">config.h</a></div></div>
<div class="ttc" id="anamespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2aligned__vector_8h_source.html#l00471">aligned_vector.h:471</a></div></div>
<div class="ttc" id="amultithreading__0_8txt_html_a3eb2ad97e22e5edf45cbc97570908143"><div class="ttname"><a href="multithreading__0_8txt.html#a3eb2ad97e22e5edf45cbc97570908143">tasks</a></div><div class="ttdeci">if only one is the scheduler would first completely execute task before doing or the other way around This model is able to execute much more efficiently in particular if a large number of tasks is available for see for example the discussion below in section[2.x.20] Abstractions for tasks</div><div class="ttdef"><b>Definition:</b> <a href="multithreading__0_8txt_source.html#l00034">multithreading_0.txt:34</a></div></div>
<div class="ttc" id="apolynomial__space__0_8txt_html_ac00ea19562c135512a6ff275a3cf0d8f"><div class="ttname"><a href="polynomial__space__0_8txt.html#ac00ea19562c135512a6ff275a3cf0d8f">j</a></div><div class="ttdeci">*Representation of the space of polynomials of degree at most n in higher dimensions *Given a vector of[1.x.0] one dimensional polynomials[1.x.1] where[1.x.3] has this class generates all dim dimensional polynomials of the where the sum and[1.x.8] is less than or equal *[1.x.9] The i e for each dim dimensional polynomial in the polynomial space it gives the indices j</div><div class="ttdef"><b>Definition:</b> <a href="polynomial__space__0_8txt_source.html#l00004">polynomial_space_0.txt:4</a></div></div>
<div class="ttc" id="aconfig_8h_html_a998f224639942da0567cbd1ec77913b7"><div class="ttname"><a href="config_8h.html#a998f224639942da0567cbd1ec77913b7">DEAL_II_NAMESPACE_CLOSE</a></div><div class="ttdeci">#define DEAL_II_NAMESPACE_CLOSE</div><div class="ttdef"><b>Definition:</b> <a href="config_8h_source.html#l00399">config.h:399</a></div></div>
<div class="ttc" id="aparsed__convergence__table__0_8txt_html_a8a90f5ba57a42a3fd4c067e00f8b8aea"><div class="ttname"><a href="parsed__convergence__table__0_8txt.html#a8a90f5ba57a42a3fd4c067e00f8b8aea">p</a></div><div class="ttdeci">****This class simplifies the construction of convergence tables reading the options for the generation of the table from a parameter file It provides a series of methods that can be used to compute the error given a reference exact solution or the difference between two numerical solutions or any other custom computation of the error given via[2.x.1] objects *An example usage of this class is given by ****The above code constructs a ParsedConvergenceTable that works for scalar and will produce an error table with and Linfty_norm norms of the error *Whenever a call to the methods the instance of this class inspects its parameters computes all norms specified by the parameter given at construction time possibly modified via a parameter file computes all extra column entries specified using the method and writes one row of the convergence table *Once you have finished with the a call to and to the the same code can be used to estimate the errors of mixed or multi physics e and one component for the pressure field p</div><div class="ttdef"><b>Definition:</b> <a href="parsed__convergence__table__0_8txt_source.html#l00020">parsed_convergence_table_0.txt:20</a></div></div>
<div class="ttc" id="afunction__0_8txt_html_a4f780342f2d5d632f82cf7fd90158a66"><div class="ttname"><a href="function__0_8txt.html#a4f780342f2d5d632f82cf7fd90158a66">size</a></div><div class="ttdeci">it defaults to i e the first component **Return all components of a vector valued function at a given point&lt; tt &gt; values&lt;/tt &gt; shall have the right size i e **Set&lt; tt &gt; values&lt;/tt &gt; to the point values of the specified component of the function at the&lt; tt &gt; points&lt;/tt &gt; It is assumed that&lt; tt &gt; values&lt;/tt &gt; already has the right size</div><div class="ttdef"><b>Definition:</b> <a href="function__0_8txt_source.html#l00052">function_0.txt:52</a></div></div>
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
