<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-30_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-30.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-30.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-30_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;  = 0) <span class="keyword">const</span> <span class="keyword">override</span></div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;     {</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;       (void)points;</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>.size() == points.size(),</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;              <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>.size(), points.size()));</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;* </div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;       std::fill(<a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>.begin(), <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>.end(), 0.);</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;     }</div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;   };</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;* </div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;   <span class="keyword">class </span>BoundaryValues : <span class="keyword">public</span> <a class="code" href="classFunction.html">Function</a>&lt;dim&gt;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;   {</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classFunction.html#a562fc1114e95e702e6696721f71528db">value_list</a>(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>&gt; &amp;points,</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                             std::vector&lt;double&gt; &amp;          <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>,</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  <span class="comment">/*component*/</span>  = 0)<span class="keyword"> const override</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(values.size() == points.size(),</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;              <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(values.size(), points.size()));</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;* </div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; values.size(); ++i)</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;         {</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;           <span class="keywordflow">if</span> (points[i](0) &lt; 0.5)</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;             values[i] = 1.;</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;           <span class="keywordflow">else</span></div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;             values[i] = 0.;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;         }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;     }</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;   };</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;* </div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;   <span class="keyword">class </span>Beta</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;   {</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;* </div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;*  The flow field is chosen to be a quarter circle with counterclockwise flow direction and with the origin as midpoint <span class="keywordflow">for</span> the right half of the domain with positive   @f$x@f$   <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>, whereas the flow simply goes to the left in the left part of the domain at a velocity that matches the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> coming in from the right. In the circular part the magnitude of the flow velocity is proportional to the distance from the origin. This is a difference to   @ref step_12 <span class="stringliteral">&quot;step-12&quot;</span>  , where the magnitude was 1 everywhere. the <span class="keyword">new</span> definition leads to a linear variation of   @f$\beta@f$   along each given face of a cell. On the other hand, the solution   @f$u(x,y)@f$   is exactly the same as before.</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;* </div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;* </div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;* @code</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;     <span class="keywordtype">void</span> value_list(<span class="keyword">const</span> std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>&gt; &amp;points,</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;                     std::vector&lt;<a class="code" href="classPoint.html">Point&lt;dim&gt;</a>&gt; &amp;      values)<span class="keyword"> const</span></div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;<span class="keyword">     </span>{</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;       <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(values.size() == points.size(),</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;              <a class="code" href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">ExcDimensionMismatch</a>(values.size(), points.size()));</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;* </div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; points.size(); ++i)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;         {</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;           <span class="keywordflow">if</span> (points[i](0) &gt; 0)</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;             {</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;               values[i](0) =</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;* </div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;-points[i](1);</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;               values[i](1) = points[i](0);</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;             }</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;           <span class="keywordflow">else</span></div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;             {</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;               values[i]    = <a class="code" href="classPoint.html">Point&lt;dim&gt;</a>();</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;               values[i](0) =</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;* </div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;-points[i](1);</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;             }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;         }</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;     }</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;   };</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;* </div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160; </div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;* </div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;* </div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ClassDGTransportEquation&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Class: DGTransportEquation&lt;/h3&gt;   </div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;*   This declaration of <span class="keyword">this</span> <span class="keyword">class </span>is utterly unaffected by our current changes.</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;* </div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;* </div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;* @code</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;   <span class="keyword">class </span>DGTransportEquation</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;   {</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;     DGTransportEquation();</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;* </div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;     <span class="keywordtype">void</span> assemble_cell_term(<span class="keyword">const</span> <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> &amp;fe_v,</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;                             <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp; ui_vi_matrix,</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;                             <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;     cell_vector) <span class="keyword">const</span>;</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;* </div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;     <span class="keywordtype">void</span> assemble_boundary_term(<span class="keyword">const</span> <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> &amp;fe_v,</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;                                 <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;     ui_vi_matrix,</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;                                 <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;         cell_vector) <span class="keyword">const</span>;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;* </div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;     <span class="keywordtype">void</span> assemble_face_term(<span class="keyword">const</span> <a class="code" href="classFEFaceValuesBase.html">FEFaceValuesBase&lt;dim&gt;</a> &amp;fe_v,</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;                             <span class="keyword">const</span> <a class="code" href="classFEFaceValuesBase.html">FEFaceValuesBase&lt;dim&gt;</a> &amp;fe_v_neighbor,</div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;                             <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ui_vi_matrix,</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;                             <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ue_vi_matrix,</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;                             <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ui_ve_matrix,</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;                             <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ue_ve_matrix) <span class="keyword">const</span>;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;* </div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;     <span class="keyword">const</span> Beta&lt;dim&gt;           beta_function;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;     <span class="keyword">const</span> RHS&lt;dim&gt;            rhs_function;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;     <span class="keyword">const</span> BoundaryValues&lt;dim&gt; boundary_function;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;   };</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;* </div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160; </div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;* </div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;* </div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;*  Likewise, the constructor of the <span class="keyword">class </span>as well as the <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> assembling the terms corresponding to cell interiors and boundary faces are unchanged from before. The function that assembles face terms between cells also did not change because all it does is operate on two objects of type <a class="code" href="classFEFaceValuesBase.html">FEFaceValuesBase</a> (which is the base class of both <a class="code" href="classFEFaceValues.html">FEFaceValues</a> and <a class="code" href="classFESubfaceValues.html">FESubfaceValues</a>). Where these objects come from, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>. how they are initialized, is of no concern to this function: it simply assumes that the quadrature points on faces or subfaces represented by the two objects correspond to the same points in physical space.</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;* </div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;</div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;* </div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;* @code</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;   template &lt;int dim&gt;</div><div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;   DGTransportEquation&lt;dim&gt;::DGTransportEquation()</div><div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;     : beta_function()</div><div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;     , rhs_function()</div><div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;     , boundary_function()</div><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;   {}</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;* </div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;* </div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;   <span class="keywordtype">void</span> DGTransportEquation&lt;dim&gt;::assemble_cell_term(</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;     <span class="keyword">const</span> <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> &amp;fe_v,</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp; ui_vi_matrix,</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;     cell_vector)<span class="keyword"> const</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;     <span class="keyword">const</span> std::vector&lt;double&gt; &amp;JxW = fe_v.<a class="code" href="classFEValuesBase.html#a7371618d5977d28dfe82c81fbac29c0f">get_JxW_values</a>();</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;* </div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;     std::vector&lt;Point&lt;dim&gt;&gt; beta(fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;     std::vector&lt;double&gt;     rhs(fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;* </div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;     beta_function.value_list(fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), beta);</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;     rhs_function.value_list(fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), rhs);</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;* </div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> = 0; <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> &lt; fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;         {</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++j)</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;             ui_vi_matrix(i, j)</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;* </div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;-= beta[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>] fe_v.<a class="code" href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">shape_grad</a>(i, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                                   fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(j, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;* </div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;           cell_vector(i) +=</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;             rhs[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>] fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;         }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;   }</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;* </div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;   <span class="keywordtype">void</span> DGTransportEquation&lt;dim&gt;::assemble_boundary_term(</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;     <span class="keyword">const</span> <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a> &amp;fe_v,</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;     ui_vi_matrix,</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;         cell_vector)<span class="keyword"> const</span></div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;     <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        JxW     = fe_v.<a class="code" href="classFEValuesBase.html#a7371618d5977d28dfe82c81fbac29c0f">get_JxW_values</a>();</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;     <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;normals = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;* </div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;     std::vector&lt;Point&lt;dim&gt;&gt; beta(fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;     std::vector&lt;double&gt;     g(fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;* </div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;     beta_function.value_list(fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), beta);</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;     boundary_function.value_list(fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), g);</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;* </div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> = 0; <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> &lt; fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;       {</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">double</span> beta_n = beta[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>] normals[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;         <span class="keywordflow">if</span> (beta_n &gt; 0)</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++j)</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;               ui_vi_matrix(i, j) += beta_n fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(j, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;                                     fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;             cell_vector(i)</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;* </div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;-=</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;               beta_n g[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>] fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;       }</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;   }</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;* </div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160; </div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;   <span class="keywordtype">void</span> DGTransportEquation&lt;dim&gt;::assemble_face_term(</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;     <span class="keyword">const</span> <a class="code" href="classFEFaceValuesBase.html">FEFaceValuesBase&lt;dim&gt;</a> &amp;fe_v,</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;     <span class="keyword">const</span> <a class="code" href="classFEFaceValuesBase.html">FEFaceValuesBase&lt;dim&gt;</a> &amp;fe_v_neighbor,</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ui_vi_matrix,</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ue_vi_matrix,</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ui_ve_matrix,</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> &amp;         ue_ve_matrix)<span class="keyword"> const</span></div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;     <span class="keyword">const</span> std::vector&lt;double&gt; &amp;        JxW     = fe_v.<a class="code" href="classFEValuesBase.html#a7371618d5977d28dfe82c81fbac29c0f">get_JxW_values</a>();</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;     <span class="keyword">const</span> std::vector&lt;Tensor&lt;1, dim&gt;&gt; &amp;normals = fe_v.<a class="code" href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">get_normal_vectors</a>();</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;* </div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;     std::vector&lt;Point&lt;dim&gt;&gt; beta(fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;* </div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;     beta_function.value_list(fe_v.<a class="code" href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">get_quadrature_points</a>(), beta);</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;* </div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> = 0; <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> &lt; fe_v.<a class="code" href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">n_quadrature_points</a>; ++<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;       {</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;         <span class="keyword">const</span> <span class="keywordtype">double</span> beta_n = beta[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>] normals[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;         <span class="keywordflow">if</span> (beta_n &gt; 0)</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;           {</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++j)</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;                 ui_vi_matrix(i, j) += beta_n fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(j, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                                       fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;* </div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++k)</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++j)</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;                 ui_ve_matrix(k, j)</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;* </div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;-= beta_n fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(j, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;                                       fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(k, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                       JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;           }</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;           {</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; fe_v.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++i)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> &lt; fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>)</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;                 ue_vi_matrix(i, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>) += beta_n</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;                                       fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;                                       fe_v.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(i, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;* </div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;             <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> k = 0; k &lt; fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++k)</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> = 0; <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a> &lt; fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">dofs_per_cell</a>; ++<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>)</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;                 ue_ve_matrix(k, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>)</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;* </div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;-=</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;                   beta_n fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">l</a>, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>)</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;                   fe_v_neighbor.<a class="code" href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">shape_value</a>(k, <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>) JxW[<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>];</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;           }</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;       }</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;   }</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;* </div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;* </div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ClassDGMethod&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Class: DGMethod&lt;/h3&gt;   </div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;*   This declaration is much like that of   @ref step_12 <span class="stringliteral">&quot;step-12&quot;</span>  . However, we introduce a <span class="keyword">new</span> routine (set_anisotropic_flags) and modify another <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> (refine_grid).</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;* </div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;* </div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;* @code</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;   <span class="keyword">class </span>DGMethod</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;   {</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;   <span class="keyword">public</span>:</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;     DGMethod(<span class="keyword">const</span> <span class="keywordtype">bool</span> anisotropic);</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;* </div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;     <span class="keywordtype">void</span> <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>();</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;* </div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;   <span class="keyword">private</span>:</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;     <span class="keywordtype">void</span> setup_system();</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;     <span class="keywordtype">void</span> assemble_system();</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;     <span class="keywordtype">void</span> solve(<a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;solution);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;     <span class="keywordtype">void</span> refine_grid();</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;     <span class="keywordtype">void</span> set_anisotropic_flags();</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;     <span class="keywordtype">void</span> output_results(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle) <span class="keyword">const</span>;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;* </div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;     <a class="code" href="classTriangulation.html">Triangulation&lt;dim&gt;</a>   <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>;</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;     <span class="keyword">const</span> <a class="code" href="classMappingQ1.html">MappingQ1&lt;dim&gt;</a> mapping;</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;* </div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;*  Again we want to use DG elements of degree 1 (but <span class="keyword">this</span> is only specified in the constructor). If you want to use a DG method of a different degree replace 1 in the constructor by the <span class="keyword">new</span> degree.</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;* </div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;* </div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;* @code</div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> degree;</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;     <a class="code" href="classFE__DGQ.html">FE_DGQ&lt;dim&gt;</a>        fe;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;     <a class="code" href="classDoFHandler.html">DoFHandler&lt;dim&gt;</a>    dof_handler;</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;* </div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;     <a class="code" href="classSparsityPattern.html">SparsityPattern</a>      sparsity_pattern;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;     <a class="code" href="classSparseMatrix.html">SparseMatrix&lt;double&gt;</a> system_matrix;</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160; @endcode</div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;* </div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;*  This is <span class="keyword">new</span>, the threshold value used in the evaluation of the anisotropic jump indicator explained in the introduction. Its value is <span class="keyword">set</span> to 3.0 in the constructor, but it can easily be changed to a different value greater than 1.</div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;* </div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;* </div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;* @code</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">double</span> anisotropic_threshold_ratio;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160; @endcode</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;* </div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;*  This is a <span class="keywordtype">bool</span> flag indicating whether anisotropic refinement shall be used or not. It is <span class="keyword">set</span> by the constructor, which takes an argument of the same name.</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;* </div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;* </div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;* @code</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">bool</span> anisotropic;</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;* </div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a>     quadrature;</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;     <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;* </div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;- 1&gt; face_quadrature;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;* </div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> solution2;</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> right_hand_side;</div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;* </div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;     <span class="keyword">const</span> DGTransportEquation&lt;dim&gt; dg;</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;   };</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;* </div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160; </div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;   DGMethod&lt;dim&gt;::DGMethod(<span class="keyword">const</span> <span class="keywordtype">bool</span> anisotropic)</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;     : mapping()</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;     ,</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; @endcode</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;* </div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;*  Change here for DG methods of different degrees.</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;* </div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;* </div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;* @code</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;     degree(1)</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;     , fe(degree)</div><div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;     , dof_handler(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>)</div><div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;     , anisotropic_threshold_ratio(3.)</div><div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;     , anisotropic(anisotropic)</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;     ,</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; @endcode</div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;* </div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;*  As beta is a linear function, we can choose the degree of the quadrature for which the resulting integration is correct. Thus, we choose to use   &lt;code&gt;degree+1&lt;/code&gt;   Gauss points, which enables us to integrate exactly polynomials of degree   &lt;code&gt;2*degree+1&lt;/code&gt;  , enough for all the integrals we will perform in this program.</div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;* </div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;* </div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;* @code</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;     quadrature(degree + 1)</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;     , face_quadrature(degree + 1)</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;     , dg()</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;   {}</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;* </div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;* </div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;   <span class="keywordtype">void</span> DGMethod&lt;dim&gt;::setup_system()</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;   {</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;     dof_handler.distribute_dofs(fe);</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;     sparsity_pattern.reinit(dof_handler.n_dofs(),</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;                             dof_handler.n_dofs(),</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;                             (<a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::faces_per_cell</a></div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;                                <a class="code" href="structGeometryInfo.html">GeometryInfo&lt;dim&gt;::max_children_per_face</a> +</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;                              1)</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;                               fe.n_dofs_per_cell());</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;* </div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;     <a class="code" href="group__constraints.html#ga7b2627e9bde96b98d4fcf95b629e4fd4">DoFTools::make_flux_sparsity_pattern</a>(dof_handler, sparsity_pattern);</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;* </div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;     sparsity_pattern.compress();</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;* </div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;     system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;* </div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;     solution2.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;     right_hand_side.reinit(dof_handler.n_dofs());</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;   }</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;* </div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160; </div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;* </div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Functionassemble_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;<a class="code" href="classFunction.html">Function</a>: assemble_system&lt;/h4&gt;   </div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;*   We proceed with the   &lt;code&gt;assemble_system&lt;/code&gt;   <span class="keyword">function</span> that implements the DG discretization. This <span class="keyword">function</span> does the same thing as the   &lt;code&gt;assemble_system&lt;/code&gt;   <span class="keyword">function</span> from   @ref step_12 <span class="stringliteral">&quot;step-12&quot;</span>   (but without <a class="code" href="namespaceMeshWorker.html">MeshWorker</a>).  The four cases considered <span class="keywordflow">for</span> the neighbor-relations of a cell are the same as the isotropic <span class="keywordflow">case</span>, namely a) cell is at the boundary, <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae880749870e5b45fbb6a441fd96c1a07">b</a>) there are finer neighboring cells, c) the neighbor is neither coarser nor finer and <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>) the neighbor is coarser.  However, the way in which we decide upon which <span class="keywordflow">case</span> we have are modified in the way described in the introduction.</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;* </div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;* </div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;* @code</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;   template &lt;int dim&gt;</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;   <span class="keywordtype">void</span> DGMethod&lt;dim&gt;::assemble_system()</div><div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;   {</div><div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = dof_handler.get_fe().n_dofs_per_cell();</div><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;     std::vector&lt;types::global_dof_index&gt; dofs(dofs_per_cell);</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;     std::vector&lt;types::global_dof_index&gt; dofs_neighbor(dofs_per_cell);</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;* </div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;     <span class="keyword">const</span> <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> update_flags = <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;                                      <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> |</div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;                                      <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>;</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;* </div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;     <span class="keyword">const</span> <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> face_update_flags =</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;       <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a> |</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;       <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a>;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;* </div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;     <span class="keyword">const</span> <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> neighbor_face_update_flags = <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;* </div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a>        fe_v(mapping, fe, quadrature, update_flags);</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a>    fe_v_face(mapping,</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;                                 fe,</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;                                 face_quadrature,</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;                                 face_update_flags);</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;     <a class="code" href="classFESubfaceValues.html">FESubfaceValues&lt;dim&gt;</a> fe_v_subface(mapping,</div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;                                       fe,</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;                                       face_quadrature,</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;                                       face_update_flags);</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a>    fe_v_face_neighbor(mapping,</div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;                                          fe,</div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                                          face_quadrature,</div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;                                          neighbor_face_update_flags);</div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;* </div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> ui_vi_matrix(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> ue_vi_matrix(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;* </div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> ui_ve_matrix(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> ue_ve_matrix(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;* </div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a> cell_vector(dofs_per_cell);</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;* </div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;       {</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;         ui_vi_matrix = 0;</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;         cell_vector  = 0;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;* </div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;         fe_v.reinit(cell);</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;* </div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;         dg.assemble_cell_term(fe_v, ui_vi_matrix, cell_vector);</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;* </div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;         cell-&gt;get_dof_indices(dofs);</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;* </div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> face_no : cell-&gt;face_indices())</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;           {</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;             <span class="keyword">const</span> <span class="keyword">auto</span> face = cell-&gt;face(face_no);</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;* </div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;* </div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;*  Case (a): The face is at the boundary.</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;* </div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;* </div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;* @code</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;             if (face-&gt;at_boundary())</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;               {</div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;                 fe_v_face.reinit(cell, face_no);</div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;* </div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;                 dg.assemble_boundary_term(fe_v_face, ui_vi_matrix, cell_vector);</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;               }</div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;             <span class="keywordflow">else</span></div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;               {</div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;                 <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(cell-&gt;neighbor(face_no).state() == <a class="code" href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">IteratorState::valid</a>,</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;                        <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;                 <span class="keyword">const</span> <span class="keyword">auto</span> neighbor = cell-&gt;neighbor(face_no);</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;* </div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;* </div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;*  Case (<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae880749870e5b45fbb6a441fd96c1a07">b</a>): This is an <a class="code" href="namespaceinternal.html">internal</a> face and the neighbor is refined (which we can test by asking whether the face of the current cell has children). In this case, we will need to integrate over the <span class="stringliteral">&quot;sub-faces&quot;</span>, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., the children of the face of the current cell.                 </div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;*   (There is a slightly confusing corner case: If we are in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a></div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;* </div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;*  -  where admittedly the current program and its demonstration of anisotropic refinement is not particularly relevant</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;* </div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;*  -  then the faces between cells are <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> the same: they are just <a class="code" href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a>. In other words, in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, we do not want to treat faces between cells of different <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> differently. The condition `face-&gt;has_children()` we check here ensures this: in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, this function <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> returns `false`, and consequently in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> we will not ever go into this `if` branch. But we will have to come back to this corner case below in case (c).)</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;* </div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;* </div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;* @code</div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;                 if (face-&gt;has_children())</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;                   {</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;* </div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;*  We need to know, which of the neighbors faces points in the direction of our cell. Using the   @p   neighbor_face_no <span class="keyword">function</span> we <span class="keyword">get</span> <span class="keyword">this</span> information <span class="keywordflow">for</span> both coarser and non-coarser neighbors.</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;* </div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;* </div><div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;* @code</div><div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> neighbor2 =</div><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;                       cell-&gt;neighbor_face_no(face_no);</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;* </div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;* </div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;*  Now we <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all subfaces, i.e. the children and possibly grandchildren of the current face.</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;* </div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;* </div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;* @code</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;                     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> subface_no = 0;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                          subface_no &lt; face-&gt;n_active_descendants();</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;                          ++subface_no)</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;                       {</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;* </div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;*  To <span class="keyword">get</span> the cell behind the current subface we can use the   @p neighbor_child_on_subface   <span class="keyword">function</span>. it takes care of all the complicated situations of anisotropic refinement and non-standard faces.</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;* </div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;* </div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;* @code</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;                         <span class="keyword">const</span> <span class="keyword">auto</span> neighbor_child =</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;                           cell-&gt;neighbor_child_on_subface(face_no, subface_no);</div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;                         <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(!neighbor_child-&gt;has_children(),</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;                                <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;* </div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;* </div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;*  The remaining part of <span class="keyword">this</span> <span class="keywordflow">case</span> is unchanged.</div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;* </div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;</div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;* </div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;* @code</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;                         ue_vi_matrix = 0;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;                         ui_ve_matrix = 0;</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;                         ue_ve_matrix = 0;</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;* </div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;                         fe_v_subface.reinit(cell, face_no, subface_no);</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;                         fe_v_face_neighbor.reinit(neighbor_child, neighbor2);</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;* </div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;                         dg.assemble_face_term(fe_v_subface,</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;                                               fe_v_face_neighbor,</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;                                               ui_vi_matrix,</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;                                               ue_vi_matrix,</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;                                               ui_ve_matrix,</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;                                               ue_ve_matrix);</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;* </div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                         neighbor_child-&gt;get_dof_indices(dofs_neighbor);</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;* </div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;                         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;                           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                             {</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;                               system_matrix.<a class="code" href="classFullMatrix.html#a9f2ea8b35b3d4a53deeabdd6edccea3a">add</a>(dofs[i],</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;                                                 dofs_neighbor[j],</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;                                                 ue_vi_matrix(i, j));</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;                               system_matrix.add(dofs_neighbor[i],</div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;                                                 dofs[j],</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;                                                 ui_ve_matrix(i, j));</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;                               system_matrix.add(dofs_neighbor[i],</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;                                                 dofs_neighbor[j],</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;                                                 ue_ve_matrix(i, j));</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;                             }</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;                       }</div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;                   }</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;                 <span class="keywordflow">else</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;                   {</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;* </div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;*  Case (c). We <span class="keyword">get</span> here <span class="keywordflow">if</span> <span class="keyword">this</span> is an <span class="keyword">internal</span> face and <span class="keywordflow">if</span> the neighbor is not further refined (or, as mentioned above, we are in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a> in which <span class="keywordflow">case</span> we <span class="keyword">get</span> here <span class="keywordflow">for</span> every <span class="keyword">internal</span> face). We then need to decide whether we want to integrate over the current face. If the neighbor is in fact coarser, then we ignore the face and instead handle it when we visit the neighboring cell and look at the current face (except in 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, where as mentioned above <span class="keyword">this</span> is not happening):</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;* </div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;</div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;* </div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;* @code</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;                     if (dim &gt; 1 &amp;&amp; cell-&gt;neighbor_is_coarser(face_no))</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;                       continue;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;* </div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;* </div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;*  On the other hand, <span class="keywordflow">if</span> the neighbor is more refined, then we have already handled the face in <span class="keywordflow">case</span> (<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae880749870e5b45fbb6a441fd96c1a07">b</a>) above (except in 1d). So <span class="keywordflow">for</span> 2d and 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, we just have to decide whether we want to handle a face between cells at the same <a class="code" href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a> from the current side or from the neighboring side.  We <span class="keywordflow">do</span> <span class="keyword">this</span> by introducing a tie-breaker: We<span class="stringliteral">&#39;ll just take the cell with the smaller index (within the current refinement level). In 1d, we take either the coarser cell, or if they are on the same level, the one with the smaller index within that level. This leads to a complicated condition that, hopefully, makes sense given the description above:</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;<span class="stringliteral">                     if (((dim &gt; 1) &amp;&amp; (cell-&gt;index() &lt; neighbor-&gt;index())) ||</span></div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;<span class="stringliteral">                         ((dim == 1) &amp;&amp; ((cell-&gt;level() &lt; neighbor-&gt;level()) ||</span></div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;<span class="stringliteral">                                         ((cell-&gt;level() == neighbor-&gt;level()) &amp;&amp;</span></div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;<span class="stringliteral">                                          (cell-&gt;index() &lt; neighbor-&gt;index())))))</span></div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;<span class="stringliteral">                       {</span></div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;<span class="stringliteral">*  Here we know, that the neighbor is not coarser so we can use the usual   @p neighbor_of_neighbor   function. However, we could also use the more general   @p neighbor_face_no   function.</span></div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;<span class="stringliteral">                         const unsigned int neighbor2 =</span></div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;<span class="stringliteral">                           cell-&gt;neighbor_of_neighbor(face_no);</span></div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;<span class="stringliteral">                         ue_vi_matrix = 0;</span></div><div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;<span class="stringliteral">                         ui_ve_matrix = 0;</span></div><div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;<span class="stringliteral">                         ue_ve_matrix = 0;</span></div><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="stringliteral">                         fe_v_face.reinit(cell, face_no);</span></div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;<span class="stringliteral">                         fe_v_face_neighbor.reinit(neighbor, neighbor2);</span></div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;<span class="stringliteral">                         dg.assemble_face_term(fe_v_face,</span></div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;<span class="stringliteral">                                               fe_v_face_neighbor,</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="stringliteral">                                               ui_vi_matrix,</span></div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;<span class="stringliteral">                                               ue_vi_matrix,</span></div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;<span class="stringliteral">                                               ui_ve_matrix,</span></div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;<span class="stringliteral">                                               ue_ve_matrix);</span></div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;<span class="stringliteral">                         neighbor-&gt;get_dof_indices(dofs_neighbor);</span></div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;<span class="stringliteral">                         for (unsigned int i = 0; i &lt; dofs_per_cell; ++i)</span></div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;<span class="stringliteral">                           for (unsigned int j = 0; j &lt; dofs_per_cell; ++j)</span></div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;<span class="stringliteral">                             {</span></div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="stringliteral">                               system_matrix.add(dofs[i],</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;<span class="stringliteral">                                                 dofs_neighbor[j],</span></div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;<span class="stringliteral">                                                 ue_vi_matrix(i, j));</span></div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;<span class="stringliteral">                               system_matrix.add(dofs_neighbor[i],</span></div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;<span class="stringliteral">                                                 dofs[j],</span></div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="stringliteral">                                                 ui_ve_matrix(i, j));</span></div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;<span class="stringliteral">                               system_matrix.add(dofs_neighbor[i],</span></div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;<span class="stringliteral">                                                 dofs_neighbor[j],</span></div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;<span class="stringliteral">                                                 ue_ve_matrix(i, j));</span></div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;<span class="stringliteral">                             }</span></div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;<span class="stringliteral">                       }</span></div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;<span class="stringliteral">*  We do not need to consider a case (d), as those faces are treated &#39;</span>from the other side within <span class="keywordflow">case</span> (<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae880749870e5b45fbb6a441fd96c1a07">b</a>).</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;* </div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;* </div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;* @code</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                   }</div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;               }</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;           }</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;* </div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j = 0; j &lt; dofs_per_cell; ++j)</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;             system_matrix.add(dofs[i], dofs[j], ui_vi_matrix(i, j));</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;* </div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; dofs_per_cell; ++i)</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;           right_hand_side(dofs[i]) += cell_vector(i);</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;       }</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;   }</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;* </div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;* </div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Solver&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Solver&lt;/h3&gt;   </div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;*   For <span class="keyword">this</span> simple problem we use the simple Richardson iteration again. The solver is completely unaffected by our anisotropic changes.</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;* </div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;* </div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;* @code</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;   <span class="keywordtype">void</span> DGMethod&lt;dim&gt;::solve(<a class="code" href="classVector.html">Vector&lt;double&gt;</a> &amp;solution)</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;   {</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>                    solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12, <span class="keyword">false</span>, <span class="keyword">false</span>);</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;     <a class="code" href="classSolverRichardson.html">SolverRichardson&lt;Vector&lt;double&gt;</a>&gt; solver(solver_control);</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;* </div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;     <a class="code" href="classPreconditionBlockSSOR.html">PreconditionBlockSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;* </div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;     preconditioner.<a class="code" href="classPreconditionBlock.html#a6c61513fe17633b8b4e1dd2d83b72e81">initialize</a>(system_matrix, fe.n_dofs_per_cell());</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;* </div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;     solver.solve(system_matrix, solution, right_hand_side, preconditioner);</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;   }</div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;* </div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;* </div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Refinement&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;Refinement&lt;/h3&gt;   </div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;*   We <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the grid according to the same simple refinement criterion used in   @ref step_12 <span class="stringliteral">&quot;step-12&quot;</span>  , namely an approximation to the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a> of the solution.</div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;* </div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;</div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;* </div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;* @code</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;   <span class="keywordtype">void</span> DGMethod&lt;dim&gt;::refine_grid()</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;   {</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;     <a class="code" href="classVector.html">Vector&lt;float&gt;</a> gradient_indicator(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;* </div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;* </div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;*  We <a class="code" href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">approximate</a> the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a>,</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;* </div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;* </div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;* @code</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;     <a class="code" href="namespaceDerivativeApproximation.html#a98d28e4c1c17164c48719cdfe4a363e6">DerivativeApproximation::approximate_gradient</a>(mapping,</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;                                                   dof_handler,</div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                                   solution2,</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;                                                   gradient_indicator);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;* </div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;* </div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;*  and <a class="code" href="namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">scale</a> it to obtain an error indicator.</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;* </div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;* </div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;* @code</div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.active_cell_iterators())</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;       gradient_indicator[cell-&gt;active_cell_index()]=</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;         <a class="code" href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a>(cell-&gt;diameter(), 1 + 1.0 dim / 2);</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;* </div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;*  Then we use <span class="keyword">this</span> indicator to flag the 30 percent of the cells with highest error indicator to be refined.</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;* </div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;* </div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;* @code</div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;     <a class="code" href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;                                                     gradient_indicator,</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;                                                     0.3,</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                                                     0.1);</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;* </div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;*  Now the refinement flags are <span class="keyword">set</span> <span class="keywordflow">for</span> those cells with a large error indicator. If <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">nothing</a> is done to change <span class="keyword">this</span>, those cells will be refined isotropically. If the   @p anisotropic   flag given to <span class="keyword">this</span> <span class="keyword">function</span> is <span class="keyword">set</span>, we now <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> the set_anisotropic_flags() function, which uses the jump indicator to reset some of the refinement flags to anisotropic refinement.</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;* </div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;* </div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;* @code</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;     if (anisotropic)</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;       set_anisotropic_flags();</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160; @endcode</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;* </div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;*  Now execute the refinement considering anisotropic as well as isotropic refinement flags.</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;* </div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;* </div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;* @code</div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.execute_coarsening_and_refinement();</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;   }</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;* </div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160; @endcode</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;* </div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;*  Once an error indicator has been evaluated and the cells with largest error are flagged for refinement we want to <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over the flagged cells again to decide whether they need isotropic refinement or whether anisotropic refinement is more appropriate. This is the anisotropic jump indicator explained in the introduction.</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;* </div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;* </div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;* @code</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;   <span class="keywordtype">void</span> DGMethod&lt;dim&gt;::set_anisotropic_flags()</div><div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;   {</div><div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;* </div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;*  We want to evaluate the jump over faces of the flagged cells, so we need some objects to evaluate values of the solution on faces.</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;* </div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;* </div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;* @code</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;     <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a> face_update_flags =</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;       <a class="code" href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a>(<a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;* </div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a>    fe_v_face(mapping,</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;                                 fe,</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;                                 face_quadrature,</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;                                 face_update_flags);</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;     <a class="code" href="classFESubfaceValues.html">FESubfaceValues&lt;dim&gt;</a> fe_v_subface(mapping,</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;                                       fe,</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;                                       face_quadrature,</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;                                       face_update_flags);</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;     <a class="code" href="classFEFaceValues.html">FEFaceValues&lt;dim&gt;</a>    fe_v_face_neighbor(mapping,</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;                                          fe,</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;                                          face_quadrature,</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                                          <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a>);</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;* </div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;* </div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;*  Now we need to <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all active cells.</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;* </div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;* </div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;* @code</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160; @endcode</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;* </div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;*  We only need to consider cells which are flagged <span class="keywordflow">for</span> refinement.</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;* </div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;* </div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;* @code</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;       if (cell-&gt;refine_flag_set())</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;         {</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;           <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> jump;</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;           <a class="code" href="classPoint.html">Point&lt;dim&gt;</a> area;</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;* </div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;           <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> face_no : cell-&gt;face_indices())</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;             {</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;               <span class="keyword">const</span> <span class="keyword">auto</span> face = cell-&gt;face(face_no);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;* </div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;               <span class="keywordflow">if</span> (!face-&gt;at_boundary())</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                 {</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;                   <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(cell-&gt;neighbor(face_no).state() ==</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;                            <a class="code" href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">IteratorState::valid</a>,</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;                          <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;                   <span class="keyword">const</span> <span class="keyword">auto</span> neighbor = cell-&gt;neighbor(face_no);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;* </div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;                   std::vector&lt;double&gt; u(fe_v_face.n_quadrature_points);</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;                   std::vector&lt;double&gt; u_neighbor(fe_v_face.n_quadrature_points);</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;* </div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;* </div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;*  The four cases of different neighbor relations seen in the assembly routines are repeated much in the same way here.</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;* </div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;* </div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;* @code</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;                   <span class="keywordflow">if</span> (face-&gt;has_children())</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                     {</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;* </div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;*  The neighbor is refined.  First we store the information, which of the neighbor<span class="stringliteral">&#39;s faces points in the direction of our current cell. This property is inherited to the children.</span></div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="stringliteral">                       unsigned int neighbor2 = cell-&gt;neighbor_face_no(face_no);</span></div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;<span class="stringliteral">*  Now we loop over all subfaces,</span></div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;<span class="stringliteral">                       for (unsigned int subface_no = 0;</span></div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;<span class="stringliteral">                            subface_no &lt; face-&gt;n_active_descendants();</span></div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;<span class="stringliteral">                            ++subface_no)</span></div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;<span class="stringliteral">                         {</span></div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;<span class="stringliteral">*  get an iterator pointing to the cell behind the present subface...</span></div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;<span class="stringliteral">                           const auto neighbor_child =</span></div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;<span class="stringliteral">                             cell-&gt;neighbor_child_on_subface(face_no,</span></div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;<span class="stringliteral">                                                             subface_no);</span></div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;<span class="stringliteral">                           Assert(!neighbor_child-&gt;has_children(),</span></div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;<span class="stringliteral">                                  ExcInternalError());</span></div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;<span class="stringliteral">*  ... and reinit the respective FEFaceValues and FESubFaceValues objects.</span></div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="stringliteral">                           fe_v_subface.reinit(cell, face_no, subface_no);</span></div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;<span class="stringliteral">                           fe_v_face_neighbor.reinit(neighbor_child, neighbor2);</span></div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;<span class="stringliteral">*  We obtain the function values</span></div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;<span class="stringliteral">                           fe_v_subface.get_function_values(solution2, u);</span></div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;<span class="stringliteral">                           fe_v_face_neighbor.get_function_values(solution2,</span></div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;<span class="stringliteral">                                                                  u_neighbor);</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="stringliteral">*  as well as the quadrature weights, multiplied by the Jacobian determinant.</span></div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;<span class="stringliteral">                           const std::vector&lt;double&gt; &amp;JxW =</span></div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;<span class="stringliteral">                             fe_v_subface.get_JxW_values();</span></div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;<span class="stringliteral">*  Now we loop over all quadrature points</span></div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="stringliteral">                           for (unsigned int x = 0;</span></div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;<span class="stringliteral">                                x &lt; fe_v_subface.n_quadrature_points;</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;<span class="stringliteral">                                ++x)</span></div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;<span class="stringliteral">                             {</span></div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;<span class="stringliteral">*  and integrate the absolute value of the jump of the solution, i.e. the absolute value of the difference between the function value seen from the current cell and the neighboring cell, respectively. We know, that the first two faces are orthogonal to the first coordinate direction on the unit cell, the second two faces are orthogonal to the second coordinate direction and so on, so we accumulate these values into vectors with   &lt;code&gt;dim&lt;/code&gt;   components.</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;<span class="stringliteral">                               jump[face_no / 2] +=</span></div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;<span class="stringliteral">                                 std::abs(u[x]</span></div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;<span class="stringliteral">- u_neighbor[x]) JxW[x];</span></div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;<span class="stringliteral">*  We also sum up the scaled weights to obtain the measure of the face.</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;<span class="stringliteral">                               area[face_no / 2] += JxW[x];</span></div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;<span class="stringliteral">                             }</span></div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;<span class="stringliteral">                         }</span></div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;<span class="stringliteral">                     }</span></div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;<span class="stringliteral">                   else</span></div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;<span class="stringliteral">                     {</span></div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;<span class="stringliteral">                       if (!cell-&gt;neighbor_is_coarser(face_no))</span></div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;<span class="stringliteral">                         {</span></div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="stringliteral">*  Our current cell and the neighbor have the same refinement along the face under consideration. Apart from that, we do much the same as with one of the subcells in the above case.</span></div><div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="stringliteral">                           unsigned int neighbor2 =</span></div><div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="stringliteral">                             cell-&gt;neighbor_of_neighbor(face_no);</span></div><div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;<span class="stringliteral">                           fe_v_face.reinit(cell, face_no);</span></div><div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;<span class="stringliteral">                           fe_v_face_neighbor.reinit(neighbor, neighbor2);</span></div><div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;<span class="stringliteral">                           fe_v_face.get_function_values(solution2, u);</span></div><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;<span class="stringliteral">                           fe_v_face_neighbor.get_function_values(solution2,</span></div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;<span class="stringliteral">                                                                  u_neighbor);</span></div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;<span class="stringliteral">                           const std::vector&lt;double&gt; &amp;JxW =</span></div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;<span class="stringliteral">                             fe_v_face.get_JxW_values();</span></div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;<span class="stringliteral">                           for (unsigned int x = 0;</span></div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;<span class="stringliteral">                                x &lt; fe_v_face.n_quadrature_points;</span></div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;<span class="stringliteral">                                ++x)</span></div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;<span class="stringliteral">                             {</span></div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;<span class="stringliteral">                               jump[face_no / 2] +=</span></div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;<span class="stringliteral">                                 std::abs(u[x]</span></div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;<span class="stringliteral">- u_neighbor[x]) JxW[x];</span></div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;<span class="stringliteral">                               area[face_no / 2] += JxW[x];</span></div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="stringliteral">                             }</span></div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="stringliteral">                         }</span></div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;<span class="stringliteral">                       else // i.e. neighbor is coarser than cell</span></div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="stringliteral">                         {</span></div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="stringliteral">*  Now the neighbor is actually coarser. This case is new, in that it did not occur in the assembly routine. Here, we have to consider it, but this is not overly complicated. We simply use the   @p   neighbor_of_coarser_neighbor function, which again takes care of anisotropic refinement and non-standard face orientation by itself.</span></div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;<span class="stringliteral">                           std::pair&lt;unsigned int, unsigned int&gt;</span></div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;<span class="stringliteral">                             neighbor_face_subface =</span></div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;<span class="stringliteral">                               cell-&gt;neighbor_of_coarser_neighbor(face_no);</span></div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;<span class="stringliteral">                           Assert(neighbor_face_subface.first &lt; cell-&gt;n_faces(),</span></div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;<span class="stringliteral">                                  ExcInternalError());</span></div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;<span class="stringliteral">                           Assert(neighbor_face_subface.second &lt;</span></div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;<span class="stringliteral">                                    neighbor-&gt;face(neighbor_face_subface.first)</span></div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;<span class="stringliteral">-&gt;n_active_descendants(),</span></div><div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="stringliteral">                                  ExcInternalError());</span></div><div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;<span class="stringliteral">                           Assert(neighbor-&gt;neighbor_child_on_subface(</span></div><div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;<span class="stringliteral">                                    neighbor_face_subface.first,</span></div><div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;<span class="stringliteral">                                    neighbor_face_subface.second) == cell,</span></div><div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="stringliteral">                                  ExcInternalError());</span></div><div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;<span class="stringliteral">                           fe_v_face.reinit(cell, face_no);</span></div><div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;<span class="stringliteral">                           fe_v_subface.reinit(neighbor,</span></div><div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="stringliteral">                                               neighbor_face_subface.first,</span></div><div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="stringliteral">                                               neighbor_face_subface.second);</span></div><div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="stringliteral">                           fe_v_face.get_function_values(solution2, u);</span></div><div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="stringliteral">                           fe_v_subface.get_function_values(solution2,</span></div><div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="stringliteral">                                                            u_neighbor);</span></div><div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="stringliteral">                           const std::vector&lt;double&gt; &amp;JxW =</span></div><div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="stringliteral">                             fe_v_face.get_JxW_values();</span></div><div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="stringliteral">                           for (unsigned int x = 0;</span></div><div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="stringliteral">                                x &lt; fe_v_face.n_quadrature_points;</span></div><div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="stringliteral">                                ++x)</span></div><div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="stringliteral">                             {</span></div><div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="stringliteral">                               jump[face_no / 2] +=</span></div><div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="stringliteral">                                 std::abs(u[x]</span></div><div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="stringliteral">- u_neighbor[x]) JxW[x];</span></div><div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="stringliteral">                               area[face_no / 2] += JxW[x];</span></div><div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="stringliteral">                             }</span></div><div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="stringliteral">                         }</span></div><div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="stringliteral">                     }</span></div><div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="stringliteral">                 }</span></div><div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="stringliteral">             }</span></div><div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="stringliteral">*  Now we analyze the size of the mean jumps, which we get dividing the jumps by the measure of the respective faces.</span></div><div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="stringliteral">           std::array&lt;double, dim&gt; average_jumps;</span></div><div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="stringliteral">           double                  sum_of_average_jumps = 0.;</span></div><div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="stringliteral">           for (unsigned int i = 0; i &lt; dim; ++i)</span></div><div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="stringliteral">             {</span></div><div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="stringliteral">               average_jumps[i] = jump(i) / area(i);</span></div><div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="stringliteral">               sum_of_average_jumps += average_jumps[i];</span></div><div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="stringliteral">             }</span></div><div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="stringliteral">*  Now we loop over the   &lt;code&gt;dim&lt;/code&gt;   coordinate directions of the unit cell and compare the average jump over the faces orthogonal to that direction with the average jumps over faces orthogonal to the remaining direction(s). If the first is larger than the latter by a given factor, we refine only along hat axis. Otherwise we leave the refinement flag unchanged, resulting in isotropic refinement.</span></div><div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="stringliteral">           for (unsigned int i = 0; i &lt; dim; ++i)</span></div><div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="stringliteral">             if (average_jumps[i] &gt; anisotropic_threshold_ratio</span></div><div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="stringliteral">                                      (sum_of_average_jumps</span></div><div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="stringliteral">- average_jumps[i]))</span></div><div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="stringliteral">               cell-&gt;set_refine_flag(RefinementCase&lt;dim&gt;::cut_axis(i));</span></div><div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;TheRest&quot;&gt;&lt;/a&gt;  &lt;h3&gt;The Rest&lt;/h3&gt;   </span></div><div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;<span class="stringliteral">*   The remaining part of the program very much follows the scheme of previous tutorial programs. We output the mesh in VTU format (just as we did in   @ref step_1 &quot;step-1&quot;  , for example), and the visualization output in VTU format as we almost always do.</span></div><div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;<span class="stringliteral">   void DGMethod&lt;dim&gt;::output_results(const unsigned int cycle) const</span></div><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;<span class="stringliteral">     std::string refine_type;</span></div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;<span class="stringliteral">     if (anisotropic)</span></div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="stringliteral">       refine_type = &quot;.aniso&quot;;</span></div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;<span class="stringliteral">     else</span></div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;<span class="stringliteral">       refine_type = &quot;.iso&quot;;</span></div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;<span class="stringliteral">       const std::string filename =</span></div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;<span class="stringliteral">         &quot;grid-&quot; + std::to_string(cycle) + refine_type + &quot;.svg&quot;;</span></div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;<span class="stringliteral">       std::cout &lt;&lt; &quot;   Writing grid to &lt;&quot; &lt;&lt; filename &lt;&lt; &quot;&gt;...&quot; &lt;&lt; std::endl;</span></div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;<span class="stringliteral">       std::ofstream svg_output(filename);</span></div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;<span class="stringliteral">       GridOut grid_out;</span></div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;<span class="stringliteral">       grid_out.write_svg(triangulation, svg_output);</span></div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;<span class="stringliteral">       const std::string filename =</span></div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="stringliteral">         &quot;sol-&quot; + std::to_string(cycle) + refine_type + &quot;.vtu&quot;;</span></div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="stringliteral">       std::cout &lt;&lt; &quot;   Writing solution to &lt;&quot; &lt;&lt; filename &lt;&lt; &quot;&gt;...&quot;</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;<span class="stringliteral">       std::ofstream gnuplot_output(filename);</span></div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="stringliteral">       DataOut&lt;dim&gt; data_out;</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;<span class="stringliteral">       data_out.attach_dof_handler(dof_handler);</span></div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;<span class="stringliteral">       data_out.add_data_vector(solution2, &quot;u&quot;);</span></div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;<span class="stringliteral">       data_out.build_patches(degree);</span></div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="stringliteral">       data_out.write_vtu(gnuplot_output);</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;<span class="stringliteral">   template &lt;int dim&gt;</span></div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;<span class="stringliteral">   void DGMethod&lt;dim&gt;::run()</span></div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;<span class="stringliteral">     for (unsigned int cycle = 0; cycle &lt; 6; ++cycle)</span></div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;Cycle &quot; &lt;&lt; cycle &lt;&lt; &#39;</span>:<span class="stringliteral">&#39; &lt;&lt; std::endl;</span></div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;<span class="stringliteral">         if (cycle == 0)</span></div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;<span class="stringliteral">           {</span></div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;<span class="stringliteral">*  Create the rectangular domain.</span></div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;<span class="stringliteral">             Point&lt;dim&gt; p1, p2;</span></div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;<span class="stringliteral">             p1(0) = 0;</span></div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;<span class="stringliteral">             p1(0) =</span></div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;<span class="stringliteral">-1;</span></div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;<span class="stringliteral">             for (unsigned int i = 0; i &lt; dim; ++i)</span></div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;<span class="stringliteral">               p2(i) = 1.;</span></div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;<span class="stringliteral">*  Adjust the number of cells in different directions to obtain completely isotropic cells for the original mesh.</span></div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;<span class="stringliteral">             std::vector&lt;unsigned int&gt; repetitions(dim, 1);</span></div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;<span class="stringliteral">             repetitions[0] = 2;</span></div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;<span class="stringliteral">             GridGenerator::subdivided_hyper_rectangle(triangulation,</span></div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;<span class="stringliteral">                                                       repetitions,</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;<span class="stringliteral">                                                       p1,</span></div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;<span class="stringliteral">                                                       p2);</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;<span class="stringliteral">             triangulation.refine_global(5</span></div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="stringliteral">- dim);</span></div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="stringliteral">           }</span></div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;<span class="stringliteral">         else</span></div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;<span class="stringliteral">           refine_grid();</span></div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;   Number of active cells:       &quot;</span></div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;<span class="stringliteral">                   &lt;&lt; triangulation.n_active_cells() &lt;&lt; std::endl;</span></div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="stringliteral">         setup_system();</span></div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;   Number of degrees of freedom: &quot; &lt;&lt; dof_handler.n_dofs()</span></div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;<span class="stringliteral">                   &lt;&lt; std::endl;</span></div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;<span class="stringliteral">         Timer assemble_timer;</span></div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;<span class="stringliteral">         assemble_system();</span></div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;   Time of assemble_system: &quot; &lt;&lt; assemble_timer.cpu_time()</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="stringliteral">                   &lt;&lt; std::endl;</span></div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;<span class="stringliteral">         solve(solution2);</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;<span class="stringliteral">         output_results(cycle);</span></div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; std::endl;</span></div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="stringliteral"> } // namespace Step30</span></div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;<span class="stringliteral"> int main()</span></div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;<span class="stringliteral">   try</span></div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;<span class="stringliteral">       using namespace Step30;</span></div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;<span class="stringliteral">*  If you want to run the program in 3D, simply change the following line to   &lt;code&gt;const unsigned int dim = 3;&lt;/code&gt;  .</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;<span class="stringliteral">       const unsigned int dim = 2;</span></div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="stringliteral">*  First, we perform a run with isotropic refinement.</span></div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; &quot;Performing a &quot; &lt;&lt; dim</span></div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;<span class="stringliteral">                   &lt;&lt; &quot;D run with isotropic refinement...&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="stringliteral">                   &lt;&lt; &quot;------------------------------------------------&quot;</span></div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;<span class="stringliteral">                   &lt;&lt; std::endl;</span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;<span class="stringliteral">         DGMethod&lt;dim&gt; dgmethod_iso(false);</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;<span class="stringliteral">         dgmethod_iso.run();</span></div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;<span class="stringliteral">       {</span></div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;<span class="stringliteral">*  Now we do a second run, this time with anisotropic refinement.</span></div><div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;<span class="stringliteral">         std::cout &lt;&lt; std::endl</span></div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;<span class="stringliteral">                   &lt;&lt; &quot;Performing a &quot; &lt;&lt; dim</span></div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;<span class="stringliteral">                   &lt;&lt; &quot;D run with anisotropic refinement...&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;<span class="stringliteral">                   &lt;&lt; &quot;--------------------------------------------------&quot;</span></div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;<span class="stringliteral">                   &lt;&lt; std::endl;</span></div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;<span class="stringliteral">         DGMethod&lt;dim&gt; dgmethod_aniso(true);</span></div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;<span class="stringliteral">         dgmethod_aniso.run();</span></div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;<span class="stringliteral">       }</span></div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;<span class="stringliteral">   catch (std::exception &amp;exc)</span></div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Exception on processing: &quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;<span class="stringliteral">                 &lt;&lt; exc.what() &lt;&lt; std::endl</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;<span class="stringliteral">   catch (...)</span></div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Unknown exception!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;<span class="stringliteral">     };</span></div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;<span class="stringliteral">   return 0;</span></div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Results&quot;&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</span></div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;<span class="stringliteral">* The output of this program consist of the console output, the SVGfiles containing the grids, and the solutions given in VTU format.</span></div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;<span class="stringliteral">Performing a 2D run with isotropic refinement...</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;<span class="stringliteral">------------------------------------------------</span></div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;<span class="stringliteral">Cycle 0:</span></div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;<span class="stringliteral">   Number of active cells:       128</span></div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 512</span></div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.092049</span></div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-0.iso.svg&gt;...</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-0.iso.vtu&gt;...</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;<span class="stringliteral">Cycle 1:</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="stringliteral">   Number of active cells:       239</span></div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 956</span></div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.109519</span></div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-1.iso.svg&gt;...</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-1.iso.vtu&gt;...</span></div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="stringliteral">Cycle 2:</span></div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;<span class="stringliteral">   Number of active cells:       491</span></div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 1964</span></div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.08303</span></div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-2.iso.svg&gt;...</span></div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-2.iso.vtu&gt;...</span></div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;<span class="stringliteral">Cycle 3:</span></div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;<span class="stringliteral">   Number of active cells:       1031</span></div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 4124</span></div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.278987</span></div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-3.iso.svg&gt;...</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-3.iso.vtu&gt;...</span></div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;<span class="stringliteral">Cycle 4:</span></div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;<span class="stringliteral">   Number of active cells:       2027</span></div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 8108</span></div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.305869</span></div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-4.iso.svg&gt;...</span></div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-4.iso.vtu&gt;...</span></div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="stringliteral">Cycle 5:</span></div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;<span class="stringliteral">   Number of active cells:       4019</span></div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 16076</span></div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.47616</span></div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-5.iso.svg&gt;...</span></div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-5.iso.vtu&gt;...</span></div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;<span class="stringliteral">Performing a 2D run with anisotropic refinement...</span></div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;<span class="stringliteral">--------------------------------------------------</span></div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;<span class="stringliteral">Cycle 0:</span></div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;<span class="stringliteral">   Number of active cells:       128</span></div><div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 512</span></div><div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.052866</span></div><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-0.aniso.svg&gt;...</span></div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-0.aniso.vtu&gt;...</span></div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;<span class="stringliteral">Cycle 1:</span></div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;<span class="stringliteral">   Number of active cells:       171</span></div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 684</span></div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.050917</span></div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-1.aniso.svg&gt;...</span></div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-1.aniso.vtu&gt;...</span></div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;<span class="stringliteral">Cycle 2:</span></div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;<span class="stringliteral">   Number of active cells:       255</span></div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 1020</span></div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.064132</span></div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-2.aniso.svg&gt;...</span></div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-2.aniso.vtu&gt;...</span></div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;<span class="stringliteral">Cycle 3:</span></div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="stringliteral">   Number of active cells:       394</span></div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 1576</span></div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.119849</span></div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-3.aniso.svg&gt;...</span></div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-3.aniso.vtu&gt;...</span></div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="stringliteral">Cycle 4:</span></div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="stringliteral">   Number of active cells:       648</span></div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 2592</span></div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.218244</span></div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-4.aniso.svg&gt;...</span></div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-4.aniso.vtu&gt;...</span></div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="stringliteral">Cycle 5:</span></div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="stringliteral">   Number of active cells:       1030</span></div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="stringliteral">   Number of degrees of freedom: 4120</span></div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="stringliteral">   Time of assemble_system: 0.128121</span></div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="stringliteral">   Writing grid to &lt;grid-5.aniso.svg&gt;...</span></div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="stringliteral">   Writing solution to &lt;sol-5.aniso.vtu&gt;...</span></div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="stringliteral">@endcode</span></div><div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="stringliteral">* This text output shows the reduction in the number of cells which results fromthe successive application of anisotropic refinement. After the last refinementstep the savings have accumulated so much that almost four times as many cellsand thus degrees of freedom are needed in the isotropic case. The time needed for assemblyscales with a similar factor.</span></div><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="stringliteral">* The first interesting part is of course to see how the meshes look like.On the left are the isotropically refined ones, on the right theanisotropic ones (colors indicate the refinement level of cells):</span></div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="stringliteral">*   &lt;table width=&quot;80%&quot; align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-0.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-0.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-1.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-1.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-2.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-2.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-3.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-3.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-4.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-4.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-5.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.grid-5.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;<span class="stringliteral">* The other interesting thing is, of course, to see the solution on thesetwo sequences of meshes. Here they are, on the refinement cycles 1 and 4,clearly showing that the solution is indeed composed of &lt;i&gt;discontinuous&lt;/i&gt; piecewisepolynomials:</span></div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;<span class="stringliteral">*   &lt;table width=&quot;60%&quot; align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.sol-1.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.sol-1.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.sol-4.iso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-30.sol-4.aniso.9.2.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;<span class="stringliteral">* We see, that the solution on the anisotropically refined mesh is very similar tothe solution obtained on the isotropically refined mesh. Thus the anisotropicindicator seems to effectively select the appropriate cells for anisotropicrefinement.</span></div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;<span class="stringliteral">* The pictures also explain why the mesh is refined as it is.In the whole left part of the domain refinement is only performed along the  @f$y@f$  -axis of cells. In the right part of the domain the refinement is dominated byisotropic refinement, as the anisotropic feature of the solution</span></div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;<span class="stringliteral">*  - the jump fromone to zero</span></div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;<span class="stringliteral">*  - is not well aligned with the mesh where the advection directiontakes a turn. However, at the bottom and closest (to the observer) parts of thequarter circle this jumps again becomes more and more alignedwith the mesh and the refinement algorithm reacts by creating anisotropic cellsof increasing aspect ratio.</span></div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;<span class="stringliteral">* It might seem that the necessary alignment of anisotropic features and thecoarse mesh can decrease performance significantly for real worldproblems. That is not wrong in general: If one were, for example, to applyanisotropic refinement to problems in which shocks appear (e.g., theequations solved in   @ref step_69 &quot;step-69&quot;  ), then it many cases the shock is not alignedwith the mesh and anisotropic refinement will help little unless one alsointroduces techniques to move the mesh in alignment with the shocks.On the other hand, many steep features of solutions are due to boundary layers.In those cases, the mesh is already aligned with the anisotropic featuresbecause it is of course aligned with the boundary itself, and anisotropicrefinement will almost always increase the efficiency of computations onadapted grids for these cases.</span></div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;<span class="stringliteral">* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-30.cc&quot;  </span></div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;<span class="stringliteral">*</span></div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;<span class="stringliteral">*/</span></div><div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="classFunction_html"><div class="ttname"><a href="classFunction.html">Function</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00116">function.h:116</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classFEValuesBase_html_a5b264d5b2fb6615f5dea7a21135ed1a5"><div class="ttname"><a href="classFEValuesBase.html#a5b264d5b2fb6615f5dea7a21135ed1a5">FEValuesBase::dofs_per_cell</a></div><div class="ttdeci">const unsigned int dofs_per_cell</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02040">fe_values.h:2040</a></div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="group__constraints_html_ga7b2627e9bde96b98d4fcf95b629e4fd4"><div class="ttname"><a href="group__constraints.html#ga7b2627e9bde96b98d4fcf95b629e4fd4">DoFTools::make_flux_sparsity_pattern</a></div><div class="ttdeci">void make_flux_sparsity_pattern(const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, SparsityPatternType &amp;sparsity_pattern)</div><div class="ttdef"><b>Definition:</b> <a href="dof__tools__sparsity_8cc_source.html#l00699">dof_tools_sparsity.cc:699</a></div></div>
<div class="ttc" id="namespaceGridTools_html_a0967563badadd81f77f62622dd8bc2cd"><div class="ttname"><a href="namespaceGridTools.html#a0967563badadd81f77f62622dd8bc2cd">GridTools::scale</a></div><div class="ttdeci">void scale(const double scaling_factor, Triangulation&lt; dim, spacedim &gt; &amp;triangulation)</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l02042">grid_tools.cc:2042</a></div></div>
<div class="ttc" id="classFE__DGQ_html"><div class="ttname"><a href="classFE__DGQ.html">FE_DGQ</a></div><div class="ttdef"><b>Definition:</b> <a href="fe__dgq_8h_source.html#l00079">fe_dgq.h:79</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="classPreconditionBlock_html_a6c61513fe17633b8b4e1dd2d83b72e81"><div class="ttname"><a href="classPreconditionBlock.html#a6c61513fe17633b8b4e1dd2d83b72e81">PreconditionBlock::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const AdditionalData parameters)</div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point&lt; dim &gt;</a></div></div>
<div class="ttc" id="classPreconditionBlockSSOR_html"><div class="ttname"><a href="classPreconditionBlockSSOR.html">PreconditionBlockSSOR</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition__block_8h_source.html#l00789">precondition_block.h:789</a></div></div>
<div class="ttc" id="namespaceMeshWorker_html"><div class="ttname"><a href="namespaceMeshWorker.html">MeshWorker</a></div><div class="ttdef"><b>Definition:</b> <a href="assemble__flags_8h_source.html#l00031">assemble_flags.h:31</a></div></div>
<div class="ttc" id="classMappingQ1_html"><div class="ttname"><a href="classMappingQ1.html">MappingQ1</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1_8h_source.html#l00046">mapping_q1.h:46</a></div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="structGeometryInfo_html"><div class="ttname"><a href="structGeometryInfo.html">GeometryInfo</a></div><div class="ttdef"><b>Definition:</b> <a href="geometry__info_8h_source.html#l01515">geometry_info.h:1515</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea5f2c95ea073cc4f276c70ae12aceb88c">EvaluationFlags::nothing</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00049">evaluation_flags.h:49</a></div></div>
<div class="ttc" id="classFEValuesBase_html_ae41b67cfd48e02f6035e39c84f0fb47a"><div class="ttname"><a href="classFEValuesBase.html#ae41b67cfd48e02f6035e39c84f0fb47a">FEValuesBase::get_quadrature_points</a></div><div class="ttdeci">const std::vector&lt; Point&lt; spacedim &gt; &gt; &amp; get_quadrature_points() const</div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="classSparsityPattern_html"><div class="ttname"><a href="classSparsityPattern.html">SparsityPattern</a></div><div class="ttdef"><b>Definition:</b> <a href="sparsity__pattern_8h_source.html#l00762">sparsity_pattern.h:762</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a1dd48cb744013c448d57f8f77640c08d"><div class="ttname"><a href="classFEValuesBase.html#a1dd48cb744013c448d57f8f77640c08d">FEValuesBase::shape_value</a></div><div class="ttdeci">const double &amp; shape_value(const unsigned int function_no, const unsigned int point_no) const</div></div>
<div class="ttc" id="group__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01415">exceptions.h:1415</a></div></div>
<div class="ttc" id="group__feaccess_html_gaa94b67d2fdcc390690c523f28019e52f"><div class="ttname"><a href="group__feaccess.html#gaa94b67d2fdcc390690c523f28019e52f">UpdateFlags</a></div><div class="ttdeci">UpdateFlags</div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00053">fe_update_flags.h:53</a></div></div>
<div class="ttc" id="classSolverRichardson_html"><div class="ttname"><a href="classSolverRichardson.html">SolverRichardson</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__richardson_8h_source.html#l00051">solver_richardson.h:51</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga6060b2304b8600f5efa0d31eeda0207d"><div class="ttname"><a href="group__Exceptions.html#ga6060b2304b8600f5efa0d31eeda0207d">StandardExceptions::ExcDimensionMismatch</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcDimensionMismatch(std::size_t arg1, std::size_t arg2)</div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">internal::EvaluatorQuantity::gradient</a></div></div>
<div class="ttc" id="classSparseMatrix_html"><div class="ttname"><a href="classSparseMatrix.html">SparseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse__matrix_8h_source.html#l00479">sparse_matrix.h:479</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a9082f945c1d289684d0bcd51ee08e11e"><div class="ttname"><a href="grid__out_8cc.html#a9082f945c1d289684d0bcd51ee08e11e">level</a></div><div class="ttdeci">unsigned int level</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04590">grid_out.cc:4590</a></div></div>
<div class="ttc" id="data__out__base_8cc_html_accc45da40beb7ae1b485306984e904a2"><div class="ttname"><a href="data__out__base_8cc.html#accc45da40beb7ae1b485306984e904a2">vertices</a></div><div class="ttdeci">Point&lt; 3 &gt; vertices[4]</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00175">data_out_base.cc:175</a></div></div>
<div class="ttc" id="classTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation&lt; dim &gt;</a></div></div>
<div class="ttc" id="classFEFaceValuesBase_html"><div class="ttname"><a href="classFEFaceValuesBase.html">FEFaceValuesBase</a></div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l03362">fe_values.h:3362</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="classFESubfaceValues_html"><div class="ttname"><a href="classFESubfaceValues.html">FESubfaceValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00043">fe.h:43</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_ae880749870e5b45fbb6a441fd96c1a07"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#ae880749870e5b45fbb6a441fd96c1a07">Physics::Elasticity::Kinematics::b</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; b(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classFEValuesBase_html_a807c3049bfe81743fc0f237dfc2fbdea"><div class="ttname"><a href="classFEValuesBase.html#a807c3049bfe81743fc0f237dfc2fbdea">FEValuesBase::n_quadrature_points</a></div><div class="ttdeci">const unsigned int n_quadrature_points</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8h_source.html#l02027">fe_values.h:2027</a></div></div>
<div class="ttc" id="namespaceinternal_html"><div class="ttname"><a href="namespaceinternal.html">internal</a></div><div class="ttdef"><b>Definition:</b> <a href="aligned__vector_8h_source.html#l00418">aligned_vector.h:418</a></div></div>
<div class="ttc" id="vectorization_8h_html_ae5c8b2cd70b2640bab8f1ee4ccb7f4cc"><div class="ttname"><a href="vectorization_8h.html#ae5c8b2cd70b2640bab8f1ee4ccb7f4cc">std::pow</a></div><div class="ttdeci">inline ::VectorizedArray&lt; Number, width &gt; pow(const ::VectorizedArray&lt; Number, width &gt; &amp;x, const ::VectorizedArray&lt; Number, width &gt; &amp;p)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l05480">vectorization.h:5480</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a7371618d5977d28dfe82c81fbac29c0f"><div class="ttname"><a href="classFEValuesBase.html#a7371618d5977d28dfe82c81fbac29c0f">FEValuesBase::get_JxW_values</a></div><div class="ttdeci">const std::vector&lt; double &gt; &amp; get_JxW_values() const</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa5e7366a91c84a50ca4e7dbd43ca6369f">update_normal_vectors</a></div><div class="ttdoc">Normal vectors. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00109">fe_update_flags.h:109</a></div></div>
<div class="ttc" id="classFunction_html_a562fc1114e95e702e6696721f71528db"><div class="ttname"><a href="classFunction.html#a562fc1114e95e702e6696721f71528db">Function::value_list</a></div><div class="ttdeci">virtual void value_list(const std::vector&lt; Point&lt; dim &gt;&gt; &amp;points, std::vector&lt; RangeNumberType &gt; &amp;values, const unsigned int component=0) const</div></div>
<div class="ttc" id="classFullMatrix_html_a9f2ea8b35b3d4a53deeabdd6edccea3a"><div class="ttname"><a href="classFullMatrix.html#a9f2ea8b35b3d4a53deeabdd6edccea3a">FullMatrix::add</a></div><div class="ttdeci">void add(const number a, const FullMatrix&lt; number2 &gt; &amp;A)</div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceDerivativeApproximation_html_a98d28e4c1c17164c48719cdfe4a363e6"><div class="ttname"><a href="namespaceDerivativeApproximation.html#a98d28e4c1c17164c48719cdfe4a363e6">DerivativeApproximation::approximate_gradient</a></div><div class="ttdeci">void approximate_gradient(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const InputVector &amp;solution, Vector&lt; float &gt; &amp;derivative_norm, const unsigned int component=0)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__approximation_8cc_source.html#l01015">derivative_approximation.cc:1015</a></div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceIteratorState_html_a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92"><div class="ttname"><a href="namespaceIteratorState.html#a4e92f4a9d339ff987cc3eb5b0a1ac507a457da025bc5a3a2231a667bd5c6f3c92">IteratorState::valid</a></div><div class="ttdoc">Iterator points to a valid object. </div><div class="ttdef"><b>Definition:</b> <a href="tria__iterator__base_8h_source.html#l00041">tria_iterator_base.h:41</a></div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a46aefdb527125dafb59dcba92a0f256e"><div class="ttname"><a href="classFEValuesBase.html#a46aefdb527125dafb59dcba92a0f256e">FEValuesBase::shape_grad</a></div><div class="ttdeci">const Tensor&lt; 1, spacedim &gt; &amp; shape_grad(const unsigned int function_no, const unsigned int quadrature_point) const</div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="classFEValuesBase_html_a80d39b9aea51af573ded84342b8b330d"><div class="ttname"><a href="classFEValuesBase.html#a80d39b9aea51af573ded84342b8b330d">FEValuesBase::get_normal_vectors</a></div><div class="ttdeci">const std::vector&lt; Tensor&lt; 1, spacedim &gt; &gt; &amp; get_normal_vectors() const</div><div class="ttdef"><b>Definition:</b> <a href="fe_2fe__values_8cc_source.html#l04150">fe_values.cc:4150</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a48e5395381ed87155942a61a1edd134d"><div class="ttname"><a href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a></div><div class="ttdeci">void refine_and_coarsen_fixed_number(Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Vector&lt; Number &gt; &amp;criteria, const double top_fraction_of_cells, const double bottom_fraction_of_cells, const unsigned int max_n_cells=std::numeric_limits&lt; unsigned int &gt;::max())</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00322">grid_refinement.cc:322</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a1cf30058b31ce7f9b389e8310bb9fc54"><div class="ttname"><a href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">GridRefinement::refine</a></div><div class="ttdeci">void refine(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold, const unsigned int max_to_mark=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00168">grid_refinement.cc:168</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="classFEFaceValues_html"><div class="ttname"><a href="classFEFaceValues.html">FEFaceValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00041">fe.h:41</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_adb1b44ad6f1741fbbbecc43f95d26baf"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#adb1b44ad6f1741fbbbecc43f95d26baf">Physics::Elasticity::Kinematics::l</a></div><div class="ttdeci">Tensor&lt; 2, dim, Number &gt; l(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="group__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
<div class="ttc" id="namespaceDerivativeApproximation_1_1internal_html_a4bea05d5ab84ca1e802db9a0217d1d6c"><div class="ttname"><a href="namespaceDerivativeApproximation_1_1internal.html#a4bea05d5ab84ca1e802db9a0217d1d6c">DerivativeApproximation::internal::approximate</a></div><div class="ttdeci">void approximate(SynchronousIterators&lt; std::tuple&lt; typename DoFHandler&lt; dim, spacedim &gt;::active_cell_iterator, Vector&lt; float &gt;::iterator &gt;&gt; const &amp;cell, const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof_handler, const InputVector &amp;solution, const unsigned int component)</div><div class="ttdef"><b>Definition:</b> <a href="derivative__approximation_8cc_source.html#l00918">derivative_approximation.cc:918</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
