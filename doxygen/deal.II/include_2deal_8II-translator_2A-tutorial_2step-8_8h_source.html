<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-8_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-8.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-8.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-8_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;  <span class="keyword">false</span>);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;     sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;* </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;     system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;* </div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;* </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ElasticProblemassemble_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;ElasticProblem::assemble_system&lt;/h4&gt;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;* </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;* </div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;*  The big changes in <span class="keyword">this</span> program are in the creation of <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and right hand side, since they are problem-dependent. We will go through that process   step-  by-step, since it is a bit more complicated than in previous examples.   </div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;*   The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> parts of <span class="keyword">this</span> <span class="keyword">function</span> are the same as before, however: setting up a suitable quadrature formula, initializing an <a class="code" href="classFEValues.html">FEValues</a> <span class="keywordtype">object</span> <span class="keywordflow">for</span> the (vector-valued) finite element we use as well as the quadrature object, and declaring a number of auxiliary arrays. In addition, we declare the ever same two abbreviations:   &lt;code&gt;n_q_points&lt;/code&gt;   and   &lt;code&gt;dofs_per_cell&lt;/code&gt;  . The number of degrees of freedom per cell we now obviously ask from the composed finite element rather than from the underlying scalar Q1 element. Here, it is   &lt;code&gt;dim&lt;/code&gt;   times the number of degrees of freedom per cell of the Q1 element, though <span class="keyword">this</span> is not <span class="keyword">explicit</span> knowledge we need to care about:</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;* </div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;* </div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;* @code</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;   <span class="keywordtype">void</span> ElasticProblem&lt;dim&gt;::assemble_system()</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;   {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;     <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> quadrature_formula(fe.degree + 1);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;* </div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;     <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values(fe,</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                             quadrature_formula,</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                               <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;* </div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_q_points    = quadrature_formula.size();</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;* </div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;     <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;     <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     cell_rhs(dofs_per_cell);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;* </div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;     std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;* </div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;* </div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;*  As was shown in previous examples as well, we need a place where to store the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the coefficients at all the quadrature points on a cell. In the present situation, we have two coefficients, <a class="code" href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a> and <a class="code" href="namespacemu.html">mu</a>.</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;* </div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;* </div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;* @code</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;     std::vector&lt;double&gt; lambda_values(n_q_points);</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;     std::vector&lt;double&gt; mu_values(n_q_points);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;* </div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;* </div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;*  Well, we could as well have omitted the above two arrays since we will use constant coefficients <span class="keywordflow">for</span> both <a class="code" href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a> and <a class="code" href="namespacemu.html">mu</a>, which can be declared like this. They both represent <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> returning the constant <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> 1.0. Although we could omit the respective factors in the assemblage of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, we use them here <span class="keywordflow">for</span> purpose of demonstration.</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;* </div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;* </div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;* @code</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;     <a class="code" href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction&lt;dim&gt;</a> <a class="code" href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a>(1.), mu(1.);</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;* </div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;* </div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;*  Like the two constant <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> above, we will <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> the <span class="keyword">function</span> right_hand_side just once per cell to make things simpler.</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;* </div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;* </div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;* @code</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;     std::vector&lt;Tensor&lt;1, dim&gt;&gt; rhs_values(n_q_points);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;* </div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;* </div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;*  Now we can <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#ad88a9499e01173b35d78413e5945e020">begin</a> with the <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> over all cells:</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;* </div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;* </div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;* @code</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;     <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;       {</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;         <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a> = 0;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;         cell_rhs    = 0;</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;* </div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;         fe_values.reinit(cell);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;* </div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;* </div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;*  Next we <span class="keyword">get</span> the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the coefficients at the quadrature points. Likewise <span class="keywordflow">for</span> the right hand side:</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;* </div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;* </div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;* @code</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;         <a class="code" href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">lambda</a>.value_list(fe_values.get_quadrature_points(), lambda_values);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;         mu.value_list(fe_values.get_quadrature_points(), mu_values);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;         right_hand_side(fe_values.get_quadrature_points(), rhs_values);</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;* </div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;* </div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;*  Then <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> the entries of the local stiffness matrix and right hand side vector. This follows almost <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>-to-<a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> the pattern described in the introduction of <span class="keyword">this</span> example.  One of the few comments in place is that we can compute the number   &lt;code&gt;comp(i)&lt;/code&gt;  , i.e. the index of the only <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> vector component of shape function   &lt;code&gt;i&lt;/code&gt;   <span class="keyword">using</span> the   &lt;code&gt;fe.system_to_component_index(i).first&lt;/code&gt;   <span class="keyword">function</span> <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> below.         </div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;*   (By accessing the   &lt;code&gt;<a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a>&lt;/code&gt;   variable of the <span class="keywordflow">return</span> <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> of the   &lt;code&gt;system_to_component_index&lt;/code&gt;   <span class="keyword">function</span>, you might already have guessed that there is more in it. In fact, the <span class="keyword">function</span> returns a   &lt;code&gt;std::pair@&lt;<span class="keywordtype">unsigned</span>   <a class="code" href="classint.html">int</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>  @&gt;&lt;/code&gt;,   of which the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> element is   &lt;code&gt;comp(i)&lt;/code&gt;   and the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> is the value   &lt;code&gt;base(i)&lt;/code&gt;   also noted in the introduction, i.e.  the index of <span class="keyword">this</span> shape <span class="keyword">function</span> within all the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> that are <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> in <span class="keyword">this</span> component, i.e.   &lt;code&gt;base(i)&lt;/code&gt;   in the diction of the introduction. This is not a number that we are usually interested in, however.)         </div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;*   With <span class="keyword">this</span> knowledge, we can <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> the local matrix contributions:</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;* </div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;* </div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;* @code</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : fe_values.dof_indices())</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;           {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_i =</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;               fe.system_to_component_index(i).first;</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;* </div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;             <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j : fe_values.dof_indices())</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;               {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_j =</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;                   fe.system_to_component_index(j).first;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;* </div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;                 <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point :</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;                      fe_values.quadrature_point_indices())</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;                   {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;                     <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(i, j) +=</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;* </div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;*  The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> term is   @f$\lambda \partial_i u_i, \partial_j</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; v_j) + (\mu \partial_i u_j, \partial_j v_i)@f$  . Note that   &lt;code&gt;shape_grad(i,q_point)&lt;/code&gt;   returns the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a> of the only <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> component of the i-th shape <span class="keyword">function</span> at quadrature <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> q_point. The component   &lt;code&gt;comp(i)&lt;/code&gt;   of the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a>, which is the derivative of <span class="keyword">this</span> only <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> vector component of the i-th shape <span class="keyword">function</span> with respect to the comp(i)th coordinate is accessed by the appended brackets.</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;* </div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;* </div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;* @code</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;                       (                                                  </div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;                         (fe_values.shape_grad(i, q_point)[component_i] </div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;                          fe_values.shape_grad(j, q_point)[component_j] </div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                          lambda_values[q_point])                         </div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                         +                                                </div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;                         (fe_values.shape_grad(i, q_point)[component_j] </div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;                          fe_values.shape_grad(j, q_point)[component_i] </div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;                          mu_values[q_point])                             </div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                         +                                                </div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; @endcode</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;* </div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;*  The <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> term is   @f$(\mu \nabla u_i, \nabla</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; v_j)@f$  . We need not access a specific component of the gradient, since we only have to compute the scalar product of the two <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">gradients</a>, of which an overloaded version of &lt;tt&gt;<span class="keyword">operator</span>*&lt;/tt&gt; takes care, as in previous examples.                         </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;*   Note that by <span class="keyword">using</span> the &lt;tt&gt;?:&lt;/tt&gt; <span class="keyword">operator</span>, we only <span class="keywordflow">do</span> <span class="keyword">this</span> if &lt;tt&gt;component_i&lt;/tt&gt; equals &lt;tt&gt;component_j&lt;/tt&gt;, otherwise a <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> is added (which will be optimized away by the compiler).</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;* </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;* </div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;* @code</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                         ((component_i == component_j) ?        </div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                            (fe_values.shape_grad(i, q_point) </div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                             fe_values.shape_grad(j, q_point) </div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                             mu_values[q_point]) :              </div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                            0)                                  </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                         )                                    </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                       fe_values.JxW(q_point);                  </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                   }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;               }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;           }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;* </div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;* </div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;*  Assembling the right hand side is also just as discussed in the introduction:</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;* </div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;* </div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;* @code</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;         <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : fe_values.dof_indices())</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;           {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> component_i =</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;               fe.system_to_component_index(i).first;</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;* </div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;             <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_point :</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                  fe_values.quadrature_point_indices())</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;               cell_rhs(i) += fe_values.shape_value(i, q_point)</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                              rhs_values[q_point][component_i]</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                              fe_values.JxW(q_point);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;           }</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;* </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;* </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;*  The transfer from local degrees of freedom into the global matrix and right hand side vector does not depend on the equation under consideration, and is thus the same as in all previous examples.</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;* </div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;* </div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;* @code</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;         cell-&gt;get_dof_indices(local_dof_indices);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;         constraints.distribute_local_to_global(</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;           <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>, cell_rhs, local_dof_indices, system_matrix, system_rhs);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;       }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;   }</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;* </div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160; </div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;* </div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;* </div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ElasticProblemsolve&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;ElasticProblem::solve&lt;/h4&gt;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;* </div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;* </div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;*  The solver does not care about where the system of equations comes, as <span class="keywordtype">long</span> as it stays positive definite and <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">symmetric</a> (which are the requirements <span class="keywordflow">for</span> the use of the CG solver), which the system indeed is. Therefore, we need not change anything.</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;* </div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;* </div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;* @code</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;   <span class="keywordtype">void</span> ElasticProblem&lt;dim&gt;::solve()</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;   {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;     <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;     <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; cg(solver_control);</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;* </div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;     <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;     preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;* </div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;     cg.solve(system_matrix, solution, system_rhs, preconditioner);</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;* </div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;     constraints.distribute(solution);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;   }</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;* </div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;* </div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ElasticProblemrefine_grid&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;ElasticProblem::refine_grid&lt;/h4&gt;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;* </div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;* </div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;*  The <span class="keyword">function</span> that does the refinement of the grid is the same as in the   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>   example. The quadrature formula is adapted to the linear elements again. Note that the error estimator by <span class="keywordflow">default</span> adds up the estimated obtained from all components of the finite element solution, i.e., it uses the displacement in all directions with the same weight. If we would like the grid to be adapted to the x-displacement only, we could pass the <span class="keyword">function</span> an additional parameter which tells it to <span class="keywordflow">do</span> so and <span class="keywordflow">do</span> not consider the displacements in all other directions <span class="keywordflow">for</span> the error indicators. However, <span class="keywordflow">for</span> the current problem, it seems appropriate to consider all displacement components with <a class="code" href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">equal</a> weight.</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;* </div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;* </div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;* @code</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;   <span class="keywordtype">void</span> ElasticProblem&lt;dim&gt;::refine_grid()</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;     <a class="code" href="classVector.html">Vector&lt;float&gt;</a> estimated_error_per_cell(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;* </div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;     <a class="code" href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator&lt;dim&gt;::estimate</a>(dof_handler,</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                                        <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;* </div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;- 1&gt;(fe.degree + 1),</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                                        {},</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                                        solution,</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                                        estimated_error_per_cell);</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;* </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;     <a class="code" href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a>(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>,</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                                                     estimated_error_per_cell,</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                                                     0.3,</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                     0.03);</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;* </div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;     <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.execute_coarsening_and_refinement();</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;   }</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;* </div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160; </div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;* </div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ElasticProblemoutput_results&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;ElasticProblem::output_results&lt;/h4&gt;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;* </div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;* </div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;*  The output happens mostly as has been shown in previous examples already. The only difference is that the solution <span class="keyword">function</span> is vector valued. The <a class="code" href="classDataOut.html">DataOut</a> <span class="keyword">class </span>takes care of this automatically, but we have to give each component of the solution vector a different name.   </div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;*   To <span class="keywordflow">do</span> <span class="keyword">this</span>, the   DataOut::add_vector()   function wants a vector of strings. Since the number of components is the same as the number of dimensions we are working in, we use the   &lt;code&gt;switch&lt;/code&gt;   statement below.   </div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;*   We note that some graphics programs have restriction on what characters are allowed in the names of variables. deal.II therefore supports only the minimal subset of these characters that is supported by all programs. Basically, these are letters, <a class="code" href="namespacenumbers.html">numbers</a>, underscores, and some other characters, but in particular no whitespace and minus/hyphen. The library will throw an exception otherwise, at least if in debug mode.   </div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;*   After listing the 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>, 2d, and 3d case, it is good style to let the program die if we <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> upon a case which we did not consider. Remember that the <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a> macro generates an exception if the condition in the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> parameter is not satisfied. Of course, the condition   &lt;code&gt;false&lt;/code&gt;   can never be satisfied, so the program will <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> <a class="code" href="namespacedeal__II__exceptions_1_1internals.html#a600f8f191a6ce368afda0074dd7ea1dc">abort</a> whenever it gets to the default statement:</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;* </div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;* </div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;* @code</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;   template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;   <span class="keywordtype">void</span> ElasticProblem&lt;dim&gt;::output_results(const <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle)<span class="keyword"> const</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;<span class="keyword">   </span>{</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;     <a class="code" href="classDataOut.html">DataOut&lt;dim&gt;</a> data_out;</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;     data_out.<a class="code" href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">attach_dof_handler</a>(dof_handler);</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;* </div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;     std::vector&lt;std::string&gt; solution_names;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;     <span class="keywordflow">switch</span> (dim)</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;       {</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;         <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;           solution_names.emplace_back(<span class="stringliteral">&quot;displacement&quot;</span>);</div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;           <span class="keywordflow">break</span>;</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;           solution_names.emplace_back(<span class="stringliteral">&quot;x_displacement&quot;</span>);</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;           solution_names.emplace_back(<span class="stringliteral">&quot;y_displacement&quot;</span>);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;           <span class="keywordflow">break</span>;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;         <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;           solution_names.emplace_back(<span class="stringliteral">&quot;x_displacement&quot;</span>);</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;           solution_names.emplace_back(<span class="stringliteral">&quot;y_displacement&quot;</span>);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;           solution_names.emplace_back(<span class="stringliteral">&quot;z_displacement&quot;</span>);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;           <span class="keywordflow">break</span>;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;         <span class="keywordflow">default</span>:</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;           <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">ExcNotImplemented</a>());</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;       }</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;* </div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;* </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;*  After setting up the names <span class="keywordflow">for</span> the different components of the solution vector, we can add the solution vector to the list of data vectors scheduled <span class="keywordflow">for</span> output. Note that the following <span class="keyword">function</span> takes a vector of strings as <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> argument, whereas the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> which we have used in all previous examples accepted a <span class="keywordtype">string</span> there. (In fact, the <span class="keyword">function</span> we had used before would convert the single <span class="keywordtype">string</span> into a vector with only <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> element and forwards that to the other <span class="keyword">function</span>.)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;* </div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;* </div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;* @code</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;     data_out.<a class="code" href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">add_data_vector</a>(solution, solution_names);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;     data_out.<a class="code" href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">build_patches</a>();</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;* </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;     std::ofstream output(<span class="stringliteral">&quot;solution-&quot;</span> + <a class="code" href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">std::to_string</a>(cycle) + <span class="stringliteral">&quot;.vtk&quot;</span>);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;     data_out.<a class="code" href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">write_vtk</a>(output);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;   }</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;* </div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;* </div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;* </div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;ElasticProblemrun&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">ElasticProblem::run</a>&lt;/h4&gt;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;* </div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;* </div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;*  The   &lt;code&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>&lt;/code&gt;   <span class="keyword">function</span> does the same things as in   @ref step_6 <span class="stringliteral">&quot;step-6&quot;</span>  , <span class="keywordflow">for</span> example. This time, we use the square [-1,1]^d as domain, and we <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> it globally four times before starting the <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> iteration.   </div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;*   The reason <span class="keywordflow">for</span> refining is a bit accidental: we use the <a class="code" href="classQGauss.html">QGauss</a> quadrature formula with two points in each direction <span class="keywordflow">for</span> integration of the right hand side; that means that there are four quadrature points on each cell (in 2D). If we only <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> grid once globally, then there will be only four quadrature points in each direction on the domain. However, the right hand side <span class="keyword">function</span> was chosen to be rather localized and in that <span class="keywordflow">case</span>, by pure chance, it happens that all quadrature points lie at points where the right hand side <span class="keyword">function</span> is <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> (in mathematical terms, the quadrature points happen to be at points outside the &lt;i&gt;support&lt;/i&gt; of the right hand side <span class="keyword">function</span>). The right hand side vector computed with quadrature will then contain only zeroes (even though it would of course be <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> <span class="keywordflow">if</span> we had computed the right hand side vector exactly <span class="keyword">using</span> the integral) and the solution of the system of equations is the <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> vector, i.e., a finite element <span class="keyword">function</span> that is <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> everywhere. In a sense, we should not be surprised that <span class="keyword">this</span> is happening since we have chosen an <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> grid that is totally unsuitable <span class="keywordflow">for</span> the problem at hand.   </div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;*   The unfortunate thing is that <span class="keywordflow">if</span> the discrete solution is constant, then the error indicators computed by the <a class="code" href="classKellyErrorEstimator.html">KellyErrorEstimator</a> <span class="keyword">class </span>are <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> for each cell as well, and the <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> to   <a class="code" href="classTriangulation.html">Triangulation</a>::<a class="code" href="namespaceparallel_1_1distributed_1_1GridRefinement.html#aa2ffb707a796ae6dedb75036606ef2e6">refine_and_coarsen_fixed_number</a>()   will not flag any cells for refinement (why should it if the indicated error is zero for each cell?). The grid in the next iteration will therefore consist of four cells only as well, and the same problem occurs again.   </div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;*   The conclusion needs to be: while of course we will not choose the <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> grid to be well-suited for the accurate solution of the problem, we must at least choose it such that it has the chance to capture the important features of the solution. In this case, it needs to be able to see the right hand side. Thus, we <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> globally four times. (Any larger number of global refinement steps would of course also work.)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;* </div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;* </div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;* @code</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;   template &lt;int dim&gt;</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;   void ElasticProblem&lt;dim&gt;<a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">::run</a>()</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;   {</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cycle = 0; cycle &lt; 8; ++cycle)</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;       {</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;Cycle &quot;</span> &lt;&lt; cycle &lt;&lt; <span class="charliteral">&#39;:&#39;</span> &lt;&lt; std::endl;</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;* </div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;         <span class="keywordflow">if</span> (cycle == 0)</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;           {</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;             <a class="code" href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a>(<a class="code" href="classDataOut__DoFData.html#ab87e6a1ac30aee2b4a134aeca8b38253">triangulation</a>,</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;* </div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;-1, 1);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;             <a class="code" href="classDataOut__DoFData.html#ab87e6a1ac30aee2b4a134aeca8b38253">triangulation</a>.refine_global(4);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;           }</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;         <span class="keywordflow">else</span></div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;           refine_grid();</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;* </div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of active cells:       &quot;</span></div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                   &lt;&lt; <a class="code" href="classDataOut__DoFData.html#ab87e6a1ac30aee2b4a134aeca8b38253">triangulation</a>.n_active_cells() &lt;&lt; std::endl;</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;* </div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;         setup_system();</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;* </div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;         std::cout &lt;&lt; <span class="stringliteral">&quot;   Number of degrees of freedom: &quot;</span> &lt;&lt; dof_handler.n_dofs()</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                   &lt;&lt; std::endl;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;* </div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;         assemble_system();</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;         solve();</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;         output_results(cycle);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;       }</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;   }</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160; } <span class="comment">// namespace Step8</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;* </div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;* </div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Thecodemaincodefunction&quot;</span>&gt;&lt;/a&gt;  &lt;h3&gt;The &lt;code&gt;main&lt;/code&gt; <span class="keyword">function</span>&lt;/h3&gt;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;* </div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;* </div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;*  After closing the   &lt;code&gt;Step8&lt;/code&gt;   <span class="keyword">namespace </span>in the last line above, the following is the main function of the program and is again exactly like in   @ref step_6 &quot;step-6&quot;   (apart from the changed class names, of course).</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;* </div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;* </div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;* @code</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; <span class="keywordtype">int</span> main()</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160; {</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;   <span class="keywordflow">try</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;     {</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;       Step8::ElasticProblem&lt;2&gt; elastic_problem_2d;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;       elastic_problem_2d.run();</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;     }</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;   <span class="keywordflow">catch</span> (std::exception &amp;exc)</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;     {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Exception on processing: &quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                 &lt;&lt; exc.what() &lt;&lt; std::endl</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;* </div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;     }</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;   <span class="keywordflow">catch</span> (...)</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;     {</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;     }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;* </div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; }</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;* </div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;* </div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;* There is not much to be said about the results of <span class="keyword">this</span> program, other thanthat they look nice. All images were made <span class="keyword">using</span> VisIt from theoutput files that the program wrote to disk. The <a class="code" href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a> two pictures showthe   @f$x@f$  - and   @f$y@f$  -displacements as scalar components:</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;*   &lt;table width=<span class="stringliteral">&quot;100%&quot;</span>&gt;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;&lt;tr&gt;</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;&lt;td&gt;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-8.x.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;&lt;/td&gt;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;&lt;td&gt;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;&lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-8.y.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;&lt;/td&gt;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;&lt;/tr&gt;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;* </div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;* You can clearly see the sources of   @f$x@f$  -displacement around   @f$x=0.5@f$   and  @f$x=-0.5@f$  , and of   @f$y@f$  -displacement at the origin.</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;* What <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> frequently would like to <span class="keywordflow">do</span> is to show the displacement as a vectorfield, i.e., vectors that <span class="keywordflow">for each</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> illustrate the direction and magnitudeof displacement. Unfortunately, that<span class="stringliteral">&#39;s a bit more involved. To understand whythis is so, remember that we have just defined our finite element as acollection of two  components (in   &lt;code&gt;dim=2&lt;/code&gt;   dimensions). Nowhere havewe said that this is not just a pressure and a concentration (two scalarquantities) but that the two components actually are the parts of avector-valued quantity, namely the displacement. Absent this knowledge, theDataOut class assumes that all individual variables we print are separatescalars, and VisIt and Paraview then faithfully assume that this is indeed what it is. Inother words, once we have written the data as scalars, there is nothing inthese programs that allows us to paste these two scalar fields back together as avector field. Where we would have to attack this problem is at the root,namely in   &lt;code&gt;ElasticProblem::output_results()&lt;/code&gt;  . We won&#39;</span>t <span class="keywordflow">do</span> so here butinstead refer the reader to the   @ref step_22 <span class="stringliteral">&quot;step-22&quot;</span>   program where we show how to <span class="keywordflow">do</span> thisfor a more <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> situation. That said, we couldn<span class="stringliteral">&#39;t help generating the dataanyway that would show how this would look if implemented as discussed in  @ref step_22 &quot;step-22&quot;  . The vector field then looks like this (VisIt and Paraviewrandomly select a fewhundred vertices from which to draw the vectors; drawing them from eachindividual vertex would make the picture unreadable):</span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral">*   &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-8.vectors.png&quot; alt=&quot;&quot;&gt;  </span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral">* We note that one may have intuitively expected thesolution to be symmetric about the   @f$x@f$  - and   @f$y@f$  -axes since the   @f$x@f$  - and  @f$y@f$  -forces are symmetric with respect to these axes. However, the forceconsidered as a vector is not symmetric and consequently neither isthe solution.</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="stringliteral">* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-8.cc&quot;  </span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral">*</span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral">*/</span></div><div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">LAPACKSupport::symmetric</a></div><div class="ttdoc">Matrix is symmetric. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00116">lapack_support.h:116</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="classPreconditionSSOR_html_a7a3d66b17bb0ea1b16606e222474c2ea"><div class="ttname"><a href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">PreconditionSSOR::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const typename BaseClass::AdditionalData &amp;parameters=typename BaseClass::AdditionalData())</div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="classDataOut_html_a087f63e22f0614bca326dbdca288c646"><div class="ttname"><a href="classDataOut.html#a087f63e22f0614bca326dbdca288c646">DataOut::build_patches</a></div><div class="ttdeci">virtual void build_patches(const unsigned int n_subdivisions=0)</div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8cc_source.html#l01071">data_out.cc:1071</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Advection_html_a8bc7b8136646134f73a4193adefe15f8"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">LocalIntegrators::Advection::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="advection_8h_source.html#l00063">advection.h:63</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="classDataOutInterface_html_acad99726038e4fca7f605fdffb3317e4"><div class="ttname"><a href="classDataOutInterface.html#acad99726038e4fca7f605fdffb3317e4">DataOutInterface::write_vtk</a></div><div class="ttdeci">void write_vtk(std::ostream &amp;out) const</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l07221">data_out_base.cc:7221</a></div></div>
<div class="ttc" id="namespaceDifferentiation_1_1SD_html_a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c"><div class="ttname"><a href="namespaceDifferentiation_1_1SD.html#a841a7b84dc17bf2ba675522093a97e8ba945f3fc449518a73b9f5f32868db466c">Differentiation::SD::OptimizerType::lambda</a></div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">DoFTools::nonzero</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00161">dof_tools.h:161</a></div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="classFunctions_1_1ConstantFunction_html"><div class="ttname"><a href="classFunctions_1_1ConstantFunction.html">Functions::ConstantFunction</a></div><div class="ttdef"><b>Definition:</b> <a href="function_8h_source.html#l00348">function.h:348</a></div></div>
<div class="ttc" id="vectorization_8h_html_a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f"><div class="ttname"><a href="vectorization_8h.html#a31b02447b71a04a1ec9bdd1358751e45a465289687a70db7aa7217cc240c29f0f">SIMDComparison::equal</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html"><div class="ttname"><a href="classKellyErrorEstimator.html">KellyErrorEstimator</a></div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00131">error_estimator.h:131</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aea91b5f00e4be473005cc331b8644ab2f1">EvaluationFlags::gradients</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00059">evaluation_flags.h:59</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_ab87e6a1ac30aee2b4a134aeca8b38253"><div class="ttname"><a href="classDataOut__DoFData.html#ab87e6a1ac30aee2b4a134aeca8b38253">DataOut_DoFData&lt; dim, dim, spacedim, spacedim &gt;::triangulation</a></div><div class="ttdeci">SmartPointer&lt; const Triangulation&lt; dim, spacedim &gt; &gt; triangulation</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00787">data_out_dof_data.h:787</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01415">exceptions.h:1415</a></div></div>
<div class="ttc" id="namespaceparallel_1_1distributed_1_1GridRefinement_html_aa2ffb707a796ae6dedb75036606ef2e6"><div class="ttname"><a href="namespaceparallel_1_1distributed_1_1GridRefinement.html#aa2ffb707a796ae6dedb75036606ef2e6">parallel::distributed::GridRefinement::refine_and_coarsen_fixed_number</a></div><div class="ttdeci">void refine_and_coarsen_fixed_number(parallel::distributed::Triangulation&lt; dim, spacedim &gt; &amp;tria, const ::Vector&lt; Number &gt; &amp;criteria, const double top_fraction_of_cells, const double bottom_fraction_of_cells, const types::global_cell_index max_n_cells=std::numeric_limits&lt; types::global_cell_index &gt;::max())</div><div class="ttdef"><b>Definition:</b> <a href="distributed_2grid__refinement_8cc_source.html#l00493">grid_refinement.cc:493</a></div></div>
<div class="ttc" id="classPreconditionSSOR_html"><div class="ttname"><a href="classPreconditionSSOR.html">PreconditionSSOR</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00667">precondition.h:667</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">internal::EvaluatorQuantity::gradient</a></div></div>
<div class="ttc" id="namespacedeal__II__exceptions_1_1internals_html_a600f8f191a6ce368afda0074dd7ea1dc"><div class="ttname"><a href="namespacedeal__II__exceptions_1_1internals.html#a600f8f191a6ce368afda0074dd7ea1dc">deal_II_exceptions::internals::abort</a></div><div class="ttdeci">void abort(const ExceptionBase &amp;exc) noexcept</div><div class="ttdef"><b>Definition:</b> <a href="base_2exceptions_8cc_source.html#l00449">exceptions.cc:449</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="namespacePatterns_1_1Tools_html_a72743302dcb1a0fb1f2f8dc5122d299e"><div class="ttname"><a href="namespacePatterns_1_1Tools.html#a72743302dcb1a0fb1f2f8dc5122d299e">Patterns::Tools::to_string</a></div><div class="ttdeci">std::string to_string(const T &amp;t)</div><div class="ttdef"><b>Definition:</b> <a href="patterns_8h_source.html#l02231">patterns.h:2231</a></div></div>
<div class="ttc" id="classTriangulation_html"><div class="ttname"><a href="classTriangulation.html">Triangulation</a></div><div class="ttdef"><b>Definition:</b> <a href="grid_2tria_8h_source.html#l00740">tria.h:740</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a79cbe2f02f8dfb85026c71d783dbb703"><div class="ttname"><a href="classDataOut__DoFData.html#a79cbe2f02f8dfb85026c71d783dbb703">DataOut_DoFData::add_data_vector</a></div><div class="ttdeci">void add_data_vector(const VectorType &amp;data, const std::vector&lt; std::string &gt; &amp;names, const DataVectorType type=type_automatic, const std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt; &amp;data_component_interpretation=std::vector&lt; DataComponentInterpretation::DataComponentInterpretation &gt;())</div><div class="ttdef"><b>Definition:</b> <a href="data__out__dof__data_8h_source.html#l00902">data_out_dof_data.h:902</a></div></div>
<div class="ttc" id="classDataOut_html"><div class="ttname"><a href="classDataOut.html">DataOut</a></div><div class="ttdef"><b>Definition:</b> <a href="numerics_2data__out_8h_source.html#l00092">data_out.h:92</a></div></div>
<div class="ttc" id="namespacemu_html"><div class="ttname"><a href="namespacemu.html">mu</a></div><div class="ttdef"><b>Definition:</b> <a href="function__parser_8h_source.html#l00033">function_parser.h:33</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceinternal_html_a2b3d48efdf7c94da455dc6a3553bab79"><div class="ttname"><a href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">internal::assemble</a></div><div class="ttdeci">void assemble(const MeshWorker::DoFInfoBox&lt; dim, DOFINFO &gt; &amp;dinfo, A *assembler)</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00073">loop.h:73</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html_ae2269e1c9903e9d863b7abd54948af00"><div class="ttname"><a href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator::estimate</a></div><div class="ttdeci">static void estimate(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim - 1 &gt; &amp;quadrature, const std::map&lt; types::boundary_id, const Function&lt; spacedim, typename InputVector::value_type &gt; *&gt; &amp;neumann_bc, const InputVector &amp;solution, Vector&lt; float &gt; &amp;error, const ComponentMask &amp;component_mask=ComponentMask(), const Function&lt; spacedim &gt; *coefficients=nullptr, const unsigned int n_threads=numbers::invalid_unsigned_int, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id, const types::material_id material_id=numbers::invalid_material_id, const Strategy strategy=cell_diameter_over_24)</div></div>
<div class="ttc" id="grid__out_8cc_html_a827a345f29da7caeb588b11013869a01"><div class="ttname"><a href="grid__out_8cc.html#a827a345f29da7caeb588b11013869a01">first</a></div><div class="ttdeci">Point&lt; 2 &gt; first</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04587">grid_out.cc:4587</a></div></div>
<div class="ttc" id="namespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_ad88a9499e01173b35d78413e5945e020"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#ad88a9499e01173b35d78413e5945e020">TrilinosWrappers::internal::begin</a></div><div class="ttdeci">VectorType::value_type * begin(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00053">trilinos_sparse_matrix.cc:53</a></div></div>
<div class="ttc" id="classDataOut__DoFData_html_a6ed7c846331069f406b8c9933c37fda4"><div class="ttname"><a href="classDataOut__DoFData.html#a6ed7c846331069f406b8c9933c37fda4">DataOut_DoFData::attach_dof_handler</a></div><div class="ttdeci">void attach_dof_handler(const DoFHandler&lt; dim, spacedim &gt; &amp;)</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="namespaceGridGenerator_html_acea0cbcd68e52ce8113d1134b87de403"><div class="ttname"><a href="namespaceGridGenerator.html#acea0cbcd68e52ce8113d1134b87de403">GridGenerator::hyper_cube</a></div><div class="ttdeci">void hyper_cube(Triangulation&lt; dim, spacedim &gt; &amp;tria, const double left=0., const double right=1., const bool colorize=false)</div></div>
<div class="ttc" id="namespacenumbers_html"><div class="ttname"><a href="namespacenumbers.html">numbers</a></div><div class="ttdef"><b>Definition:</b> <a href="numbers_8h_source.html#l00187">numbers.h:187</a></div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues</a></div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2fe_2fe_8h_source.html#l00039">fe.h:39</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">LAPACKSupport::general</a></div><div class="ttdoc">No special properties. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00114">lapack_support.h:114</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga7b52b286796c23ef9ff178faf7a4b68f"><div class="ttname"><a href="group__Exceptions.html#ga7b52b286796c23ef9ff178faf7a4b68f">StandardExceptions::ExcNotImplemented</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcNotImplemented()</div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="classint_html"><div class="ttname"><a href="classint.html">int</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a48e5395381ed87155942a61a1edd134d"><div class="ttname"><a href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a></div><div class="ttdeci">void refine_and_coarsen_fixed_number(Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Vector&lt; Number &gt; &amp;criteria, const double top_fraction_of_cells, const double bottom_fraction_of_cells, const unsigned int max_n_cells=std::numeric_limits&lt; unsigned int &gt;::max())</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00322">grid_refinement.cc:322</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a1cf30058b31ce7f9b389e8310bb9fc54"><div class="ttname"><a href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">GridRefinement::refine</a></div><div class="ttdeci">void refine(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold, const unsigned int max_to_mark=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00168">grid_refinement.cc:168</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
