<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<link rel="canonical" href="https://www.dealii.org/current/doxygen/deal.II/include_2deal_8II-translator_2A-tutorial_2step-6_8h_source.html" />
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>The deal.II Library: include/deal.II-translator/A-tutorial/step-6.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="stylesheet.css" rel="stylesheet" type="text/css"/>
<link rel="SHORTCUT ICON" href="deal.ico"></link>
<script type="text/javascript" src="custom.js"></script>
<meta name="author" content="The deal.II Authors <authors@dealii.org>"></meta>
<meta name="copyright" content="Copyright (C) 1998 - 2021 by the deal.II authors"></meta>
<meta name="deal.II-version" content="10.0.0-pre"></meta>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo200.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Reference documentation for deal.II version 10.0.0-pre</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!--Extra macros for MathJax:-->
<div style="display:none">
\(\newcommand{\dealvcentcolon}{\mathrel{\mathop{:}}}\)
\(\newcommand{\dealcoloneq}{\dealvcentcolon\mathrel{\mkern-1.2mu}=}\)
\(\newcommand{\jump}[1]{\left[\!\left[ #1 \right]\!\right]}\)
\(\newcommand{\average}[1]{\left\{\!\left\{ #1 \right\}\!\right\}}\)
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_386d89ad50a3909c2af5a93b48d2c3ff.html">deal.II-translator</a></li><li class="navelem"><a class="el" href="dir_7812fe2bbb6fb6db2d3962cae8700ca0.html">A-tutorial</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">step-6.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="include_2deal_8II-translator_2A-tutorial_2step-6_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;  <span class="keyword">false</span>);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;* </div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;* </div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;*  Now all non-<a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a> entries of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> are known (i.e. those from regularly assembling the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and those that were introduced by eliminating constraints). We may <a class="code" href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">copy</a> our intermediate <span class="keywordtype">object</span> to the sparsity pattern:</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;* </div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;* </div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;* @code</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;   sparsity_pattern.copy_from(dsp);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;* </div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;* </div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;*  We may now, <span class="keywordflow">finally</span>, initialize the sparse <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>:</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;* </div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;* </div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;* @code</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;   system_matrix.reinit(sparsity_pattern);</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; }</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;* </div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160; </div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;* </div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step6assemble_system&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step6::assemble_system&lt;/h4&gt;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;* </div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;* </div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;*  Next, we have to <a class="code" href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">assemble</a> the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>. However, to <a class="code" href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">copy</a> the local <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and vector on each cell into the global system, we are no longer <span class="keyword">using</span> a hand-written <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>. Instead, we use   <a class="code" href="classAffineConstraints.html#a373fbdacd8c486e675b8d2bff8943192">AffineConstraints::distribute_local_to_global</a>()   that internally executes this <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a> while performing Gaussian elimination on rows and columns corresponding to constrained degrees on freedom.</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;* </div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;* </div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;*  The rest of the code that forms the local contributions remains unchanged. It is worth noting, however, that under the hood several things are different than before. First, the variable   &lt;code&gt;dofs_per_cell&lt;/code&gt;   and return value of   &lt;code&gt;quadrature_formula.size()&lt;/code&gt;   now are 9 each, where they were 4 before. Introducing such variables as abbreviations is a good strategy to make code work with different elements without having to change too much code. Secondly, the   &lt;code&gt;fe_values&lt;/code&gt;   <span class="keywordtype">object</span> of course needs to do other things as well, since the shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> are now quadratic, rather than linear, in each coordinate variable. Again, however, this is something that is completely handled by the library.</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;* </div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;* </div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;* @code</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; template &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; <span class="keywordtype">void</span> Step6&lt;dim&gt;::assemble_system()</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; {</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;   <span class="keyword">const</span> <a class="code" href="classQGauss.html">QGauss&lt;dim&gt;</a> quadrature_formula(fe.degree + 1);</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;* </div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;   <a class="code" href="classFEValues.html">FEValues&lt;dim&gt;</a> fe_values(fe,</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                           quadrature_formula,</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                           <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a> |</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                             <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a> | <a class="code" href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a>);</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;* </div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dofs_per_cell = fe.n_dofs_per_cell();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;* </div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;   <a class="code" href="classFullMatrix.html">FullMatrix&lt;double&gt;</a> <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(dofs_per_cell, dofs_per_cell);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;   <a class="code" href="classVector.html">Vector&lt;double&gt;</a>     cell_rhs(dofs_per_cell);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;* </div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;   std::vector&lt;types::global_dof_index&gt; local_dof_indices(dofs_per_cell);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;* </div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;   <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span> &amp;cell : dof_handler.active_cell_iterators())</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;     {</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;       <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a> = 0;</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;       cell_rhs    = 0;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;* </div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;       fe_values.reinit(cell);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;* </div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> q_index : fe_values.quadrature_point_indices())</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;         {</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;           <span class="keyword">const</span> <span class="keywordtype">double</span> current_coefficient =</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;             coefficient(fe_values.quadrature_point(q_index));</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;           <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i : fe_values.dof_indices())</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;             {</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;               <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j : fe_values.dof_indices())</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                 <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>(i, j) +=</div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                   (current_coefficient              <span class="comment">// a(x_q)</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    fe_values.shape_grad(i, q_index) <span class="comment">// grad phi_i(x_q)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    fe_values.shape_grad(j, q_index) <span class="comment">// grad phi_j(x_q)</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    fe_values.JxW(q_index));           <span class="comment">// dx</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;* </div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;               cell_rhs(i) += (1.0                               <span class="comment">// f(x)</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                               fe_values.shape_value(i, q_index) <span class="comment">// phi_i(x_q)</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                               fe_values.JxW(q_index));            <span class="comment">// dx</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;             }</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;         }</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;* </div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;* </div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;*  Finally, transfer the contributions from   @p <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>   and   @p cell_rhs   into the global objects.</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;* </div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;* </div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;* @code</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;       cell-&gt;get_dof_indices(local_dof_indices);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;       constraints.distribute_local_to_global(</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;         <a class="code" href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">cell_matrix</a>, cell_rhs, local_dof_indices, system_matrix, system_rhs);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;     }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;* </div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;*  Now we are done assembling the linear system. The constraint <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> took care of applying the boundary conditions and also eliminated hanging node constraints. The constrained nodes are still in the linear system (there is a <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">nonzero</a> entry, chosen in a way that the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> is well conditioned, on the <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">diagonal</a> of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> and all other entries <span class="keywordflow">for</span> <span class="keyword">this</span> line are <span class="keyword">set</span> to <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>) but the computed <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> are <a class="code" href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">invalid</a> (i.e., the corresponding entries in   &lt;code&gt;system_rhs&lt;/code&gt;   are currently meaningless). We compute the correct <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="keywordflow">for</span> these nodes at the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of the   &lt;code&gt;solve&lt;/code&gt;   <span class="keyword">function</span>.</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;* </div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;* </div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;* @code</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; }</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;* </div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;* </div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step6solve&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step6::solve&lt;/h4&gt;</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;* </div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;* </div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;*  We <span class="keywordflow">continue</span> with gradual improvements. The <span class="keyword">function</span> that solves the linear system again uses the SSOR preconditioner, and is again unchanged except that we have to incorporate hanging node constraints. As mentioned above, the degrees of freedom from the <a class="code" href="classAffineConstraints.html">AffineConstraints</a> <span class="keywordtype">object</span> corresponding to hanging node constraints and boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> have been removed from the linear system by giving the rows and columns of the <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a> a special treatment. This way, the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> <span class="keywordflow">for</span> these degrees of freedom have wrong, but well-defined <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> after solving the linear system. What we then have to <span class="keywordflow">do</span> is to use the constraints to assign to them the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> that they should have. This process, called   &lt;code&gt;distributing&lt;/code&gt;   constraints, computes the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of constrained nodes from the <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the unconstrained ones, and requires only a single additional <span class="keyword">function</span> <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> that you find at the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> of <span class="keyword">this</span> <span class="keyword">function</span>:</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;* </div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;* </div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;*  </div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;* </div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;* @code</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160; <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> dim&gt;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; <span class="keywordtype">void</span> Step6&lt;dim&gt;::solve()</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; {</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <a class="code" href="classSolverControl.html">SolverControl</a>            solver_control(1000, 1<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>-12);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <a class="code" href="classSolverCG.html">SolverCG&lt;Vector&lt;double&gt;</a>&gt; solver(solver_control);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;* </div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;* </div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   solver.solve(system_matrix, solution, system_rhs, preconditioner);</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;* </div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   constraints.distribute(solution);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160; }</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;* </div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160; </div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;* </div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;*   &lt;a name=<span class="stringliteral">&quot;Step6refine_grid&quot;</span>&gt;&lt;/a&gt;  &lt;h4&gt;Step6::refine_grid&lt;/h4&gt;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;* </div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;* </div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;*  We use a sophisticated error estimation scheme to <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> the mesh instead of global refinement. We will use the <a class="code" href="classKellyErrorEstimator.html">KellyErrorEstimator</a> <span class="keyword">class </span>which <span class="keyword">implements</span> an error estimator for the Laplace equation; it can in principle handle variable coefficients, but we will not use these advanced features, but rather use its most simple form since we are not interested in quantitative results but only in a quick way to generate locally refined grids.</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;* </div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;* </div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;*  Although the error estimator derived by Kelly et al. was originally developed for the Laplace equation, we have found that it is also well suited to quickly generate locally refined grids for a wide class of problems. This error estimator uses the solution <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a>&#39;s jump at cell faces (which is a measure for the second derivatives) and scales it by the size of the cell. It is therefore a measure for the local smoothness of the solution at the place of each cell and it is thus understandable that it yields reasonable grids also for hyperbolic transport problems or the wave equation as well, although these grids are certainly suboptimal compared to approaches specially tailored to the problem. This error estimator may therefore be understood as a quick way to test an adaptive program.</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;* </div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;* </div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;*  The way the estimator works is to take a   &lt;code&gt;<a class="code" href="classDoFHandler.html">DoFHandler</a>&lt;/code&gt;   object describing the degrees of freedom and a vector of <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> for each degree of freedom as input and compute a single indicator <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> for each active cell of the <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> (i.e. one value for each of the active cells). To do so, it needs two additional pieces of information: a face quadrature formula, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., a quadrature formula on   &lt;code&gt;dim-1&lt;/code&gt;   dimensional objects. We use a 3-<a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a> Gauss rule again, a choice that is consistent and appropriate with the bi-quadratic finite element shape <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> in this program. (What constitutes a suitable quadrature rule here of course depends on knowledge of the way the error estimator evaluates the solution field. As said above, the jump of the gradient is integrated over each face, which would be a quadratic function on each face for the quadratic elements in use in this example. In fact, however, it is the square of the jump of the gradient, as explained in the documentation of that class, and that is a quartic function, for which a 3 point Gauss formula is sufficient since it integrates polynomials up to order 5 exactly.)</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;* </div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;* </div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;*  Secondly, the function wants a list of boundary indicators for those boundaries where we have imposed Neumann <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> of the kind   @f$\partial_n u(\mathbf x) = h(\mathbf x)@f$  , along with a function   @f$h(\mathbf</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160; x)@f$   for each such boundary. This information is represented by a map from boundary indicators to function objects describing the Neumann boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>. In the present example program, we do not use Neumann boundary <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>, so this map is empty, and in fact constructed using the default constructor of the map in the place where the function <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> expects the respective function argument.</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;* </div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;* </div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;*  The output is a vector of <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a> for all active cells. While it may make sense to compute the &lt;b&gt;<a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a>&lt;/b&gt; of a solution degree of freedom very accurately, it is usually not necessary to compute the &lt;b&gt;error</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160; indicator&lt;/b&gt; corresponding to the solution on a cell particularly accurately. We therefore typically use a vector of floats instead of a vector of doubles to represent error indicators.</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;* </div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;* </div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;* @code</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; template &lt;int dim&gt;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; void Step6&lt;dim&gt;::refine_grid()</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; {</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;   <a class="code" href="classVector.html">Vector&lt;float&gt;</a> estimated_error_per_cell(<a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a>.n_active_cells());</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;* </div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;   <a class="code" href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator&lt;dim&gt;::estimate</a>(dof_handler,</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                      <a class="code" href="classQGauss.html">QGauss</a>&lt;dim</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;* </div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;- 1&gt;(fe.degree + 1),</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                      {},</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                      solution,</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                      estimated_error_per_cell);</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;* </div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;* </div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;*  The above <span class="keyword">function</span> returned <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> error indicator <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> <span class="keywordflow">for each</span> cell in the   &lt;code&gt;estimated_error_per_cell&lt;/code&gt;   array. Refinement is now done as follows: <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> those 30 per cent of the cells with the highest error <a class="code" href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">values</a>, and <a class="code" href="namespaceGridRefinement.html#a5eee186cf23024df6854a9990a786703">coarsen</a> the 3 per cent of cells with the lowest values.   </div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;*   One can easily verify that <span class="keywordflow">if</span> the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> number were <a class="code" href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">zero</a>, <span class="keyword">this</span> would approximately result in a doubling of cells in each step in two space dimensions, since <span class="keywordflow">for each</span> of the 30 per cent of cells, four <span class="keyword">new</span> would be replaced, <span class="keywordflow">while</span> the remaining 70 per cent of cells remain untouched. In practice, some more cells are usually produced since it is disallowed that a cell is refined twice <span class="keywordflow">while</span> the neighbor cell is not refined; in that <span class="keywordflow">case</span>, the neighbor cell would be refined as well.   </div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;*   In many applications, the number of cells to be coarsened would be <span class="keyword">set</span> to something larger than only three per cent. <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> non-zero <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> is useful especially <span class="keywordflow">if</span> <span class="keywordflow">for</span> some reason the <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> (coarse) grid is already rather refined. In that <span class="keywordflow">case</span>, it might be necessary to <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> it in some regions, <span class="keywordflow">while</span> coarsening in some other regions is useful. In our <span class="keywordflow">case</span> here, the <a class="code" href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">initial</a> grid is very coarse, so coarsening is only necessary in a few regions where over-refinement may have taken place. Thus a small, non-zero <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">value</a> is appropriate here.   </div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;*   The following <span class="keyword">function</span> now takes these refinement indicators and flags some cells of the <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> <span class="keywordflow">for</span> refinement or coarsening <span class="keyword">using</span> the method described above. It is from a <span class="keyword">class </span>that <span class="keyword">implements</span> several different algorithms to <a class="code" href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">refine</a> a <a class="code" href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a> based on cell-wise error indicators.</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;* </div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;* </div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;* @code</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;   <a class="code" href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a>(triangulation,</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                                                   estimated_error_per_cell,</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                                   0.3,</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                                                   0.03);</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;* </div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;* </div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;*  After the previous <span class="keyword">function</span> has exited, some cells are flagged <span class="keywordflow">for</span> refinement, and some other <span class="keywordflow">for</span> coarsening. The refinement or coarsening itself is not performed by now, however, since there are cases where further modifications of these flags is useful. Here, we don<span class="stringliteral">&#39;t want to do any such thing, so we can tell the triangulation to perform the actions for which the cells are flagged:</span></div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="stringliteral">   triangulation.execute_coarsening_and_refinement();</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;Step6output_results&quot;&gt;&lt;/a&gt;  &lt;h4&gt;Step6::output_results&lt;/h4&gt;</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="stringliteral">*  At the end of computations on each grid, and just before we continue the next cycle with mesh refinement, we want to output the results from this cycle.</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="stringliteral">*  We have already seen in   @ref step_1 &quot;step-1&quot;   how this can be achieved for the mesh itself. Here, we change a few things:   &lt;ol&gt;     &lt;li&gt;  We use two different formats: gnuplot and VTU.  &lt;/li&gt;     &lt;li&gt;  We embed the cycle number in the output file name.  &lt;/li&gt;     &lt;li&gt;  For gnuplot output, we set up a   GridOutFlags::Gnuplot   object to provide a few extra visualization arguments so that edges appear curved. This is explained in further detail in   @ref step_10 &quot;step-10&quot;  .  &lt;/li&gt;     &lt;/ol&gt;  </span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="stringliteral"> template &lt;int dim&gt;</span></div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;<span class="stringliteral"> void Step6&lt;dim&gt;::output_results(const unsigned int cycle) const</span></div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;<span class="stringliteral">     GridOut               grid_out;</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="stringliteral">     std::ofstream         output(&quot;grid-&quot; + std::to_string(cycle) + &quot;.gnuplot&quot;);</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;<span class="stringliteral">     GridOutFlags::Gnuplot gnuplot_flags(false, 5);</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;<span class="stringliteral">     grid_out.set_flags(gnuplot_flags);</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;<span class="stringliteral">     MappingQGeneric&lt;dim&gt; mapping(3);</span></div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;<span class="stringliteral">     grid_out.write_gnuplot(triangulation, output, &amp;mapping);</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;<span class="stringliteral">   {</span></div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="stringliteral">     DataOut&lt;dim&gt; data_out;</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;<span class="stringliteral">     data_out.attach_dof_handler(dof_handler);</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="stringliteral">     data_out.add_data_vector(solution, &quot;solution&quot;);</span></div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="stringliteral">     data_out.build_patches();</span></div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="stringliteral">     std::ofstream output(&quot;solution-&quot; + std::to_string(cycle) + &quot;.vtu&quot;);</span></div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="stringliteral">     data_out.write_vtu(output);</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="stringliteral">   }</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;Step6run&quot;&gt;&lt;/a&gt;  &lt;h4&gt;Step6::run&lt;/h4&gt;</span></div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="stringliteral">*  The final function before   &lt;code&gt;main()&lt;/code&gt;   is again the main driver of the class,   &lt;code&gt;run()&lt;/code&gt;  . It is similar to the one of   @ref step_5 &quot;step-5&quot;  , except that we generate a file in the program again instead of reading it from disk, in that we adaptively instead of globally refine the mesh, and that we output the solution on the final mesh in the present function.</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="stringliteral">*  The first block in the main loop of the function deals with mesh generation. If this is the first cycle of the program, instead of reading the grid from a file on disk as in the previous example, we now again create it using a library function. The domain is again a circle with center at the origin and a radius of one (these are the two hidden arguments to the function, which have default values).</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;<span class="stringliteral">*  You will notice by looking at the coarse grid that it is of inferior quality than the one which we read from the file in the previous example: the cells are less equally formed. However, using the library function this program works in any space dimension, which was not the case before.</span></div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;<span class="stringliteral">*  In case we find that this is not the first cycle, we want to refine the grid. Unlike the global refinement employed in the last example program, we now use the adaptive procedure described above.</span></div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;<span class="stringliteral">*  The rest of the loop looks as before:</span></div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;<span class="stringliteral"> template &lt;int dim&gt;</span></div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;<span class="stringliteral"> void Step6&lt;dim&gt;::run()</span></div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;<span class="stringliteral">   for (unsigned int cycle = 0; cycle &lt; 8; ++cycle)</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;<span class="stringliteral">       std::cout &lt;&lt; &quot;Cycle &quot; &lt;&lt; cycle &lt;&lt; &#39;</span>:<span class="stringliteral">&#39; &lt;&lt; std::endl;</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="stringliteral">       if (cycle == 0)</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="stringliteral">         {</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="stringliteral">           GridGenerator::hyper_ball(triangulation);</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="stringliteral">           triangulation.refine_global(1);</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="stringliteral">         }</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="stringliteral">       else</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="stringliteral">         refine_grid();</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="stringliteral">       std::cout &lt;&lt; &quot;   Number of active cells:       &quot;</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="stringliteral">                 &lt;&lt; triangulation.n_active_cells() &lt;&lt; std::endl;</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="stringliteral">       setup_system();</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="stringliteral">       std::cout &lt;&lt; &quot;   Number of degrees of freedom: &quot; &lt;&lt; dof_handler.n_dofs()</span></div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;<span class="stringliteral">       assemble_system();</span></div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;<span class="stringliteral">       solve();</span></div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;<span class="stringliteral">       output_results(cycle);</span></div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;<span class="stringliteral"> }</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;<span class="stringliteral"> </span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;<span class="stringliteral">*   &lt;a name=&quot;Thecodemaincodefunction&quot;&gt;&lt;/a&gt;  &lt;h3&gt;The &lt;code&gt;main&lt;/code&gt; function&lt;/h3&gt;</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;<span class="stringliteral">*  The main function is unaltered in its functionality from the previous example, but we have taken a step of additional caution. Sometimes, something goes wrong (such as insufficient disk space upon writing an output file, not enough memory when trying to allocate a vector or a matrix, or if we can&#39;</span>t read from or write to a file <span class="keywordflow">for</span> whatever reason), and in these cases the library will <span class="keywordflow">throw</span> exceptions. Since these are <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a>-time problems, not programming errors that can be fixed once and <span class="keywordflow">for</span> all, <span class="keyword">this</span> kind of exceptions is not switched off in optimized mode, in contrast to the   &lt;code&gt;Assert&lt;/code&gt;   macro which we have used to test against programming errors. If uncaught, these exceptions propagate the <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a> tree up to the   &lt;code&gt;main&lt;/code&gt;   <span class="keyword">function</span>, and <span class="keywordflow">if</span> they are not caught there either, the program is aborted. In many cases, like <span class="keywordflow">if</span> there is not enough memory or disk space, we can<span class="stringliteral">&#39;t do anything but we can at least print some text trying to explain the reason why the program failed. A way to do so is shown in the following. It is certainly useful to write any larger program in this way, and you can do so by more or less copying this function except for the   &lt;code&gt;try&lt;/code&gt;   block that actually encodes the functionality particular to the present application.</span></div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;<span class="stringliteral"> int main()</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;<span class="stringliteral"> {</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="stringliteral">*  The general idea behind the layout of this function is as follows: let&#39;</span>s <span class="keywordflow">try</span> to <a class="code" href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">run</a> the program as we did before...</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;* </div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;* </div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;* @code</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;   <span class="keywordflow">try</span></div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;     {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;       Step6&lt;2&gt; laplace_problem_2d;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;       laplace_problem_2d.run();</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;     }</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;* </div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;*  ...and <span class="keywordflow">if</span> <span class="keyword">this</span> should fail, <span class="keywordflow">try</span> to <a class="code" href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a> as much information as possible. Specifically, <span class="keywordflow">if</span> the exception that was thrown is an <span class="keywordtype">object</span> of a <span class="keyword">class </span>that is derived from the <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>++ standard class   &lt;code&gt;exception&lt;/code&gt;, then we can use the &lt;code&gt;what&lt;/code&gt;   member function to get a string which describes the reason why the exception was thrown.   </div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;*   The deal.II exception classes are all derived from the standard <span class="keyword">class</span>, and in particular, the   &lt;code&gt;exc.what()&lt;/code&gt;   <span class="keyword">function</span> will <span class="keywordflow">return</span> approximately the same <span class="keywordtype">string</span> as would be generated <span class="keywordflow">if</span> the exception was thrown <span class="keyword">using</span> the   &lt;code&gt;<a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>&lt;/code&gt;   macro. You have seen the output of such an exception in the previous example, and you then know that it contains the file and line number of where the exception occurred, and some other information. This is also what the following statements would <a class="code" href="classAffineConstraints.html#adfaa145ec19c37c410ddb0fb75e165f4">print</a>.   </div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;*   Apart from <span class="keyword">this</span>, there isn<span class="stringliteral">&#39;t much that we can do except exiting the program with an error code (this is what the   &lt;code&gt;return 1;&lt;/code&gt;   does):</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;<span class="stringliteral">   catch (std::exception &amp;exc)</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;<span class="stringliteral">     {</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; std::endl</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;<span class="stringliteral">       std::cerr &lt;&lt; &quot;Exception on processing: &quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="stringliteral">                 &lt;&lt; exc.what() &lt;&lt; std::endl</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;Aborting!&quot; &lt;&lt; std::endl</span></div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="stringliteral">                 &lt;&lt; &quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="stringliteral">                 &lt;&lt; std::endl;</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="stringliteral">       return 1;</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;<span class="stringliteral">     }</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;<span class="stringliteral"> @endcode</span></div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;<span class="stringliteral">*  If the exception that was thrown somewhere was not an object of a class derived from the standard   &lt;code&gt;exception&lt;/code&gt;   class, then we can&#39;</span>t <span class="keywordflow">do</span> anything at all. We then simply <a class="code" href="classAffineConstraints.html#adfaa145ec19c37c410ddb0fb75e165f4">print</a> an error message and exit.</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;* </div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;* </div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;* @code</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;   <span class="keywordflow">catch</span> (...)</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;     {</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;       std::cerr &lt;&lt; std::endl</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                 &lt;&lt; std::endl</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;       std::cerr &lt;&lt; <span class="stringliteral">&quot;Unknown exception!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;Aborting!&quot;</span> &lt;&lt; std::endl</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                 &lt;&lt; <span class="stringliteral">&quot;----------------------------------------------------&quot;</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                 &lt;&lt; std::endl;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;       <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;     }</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;* </div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;* </div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;*  If we got to <span class="keyword">this</span> <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a>, there was no exception which propagated up to the main <span class="keyword">function</span> (there may have been exceptions, but they were caught somewhere in the program or the library). Therefore, the program performed as was expected and we can <span class="keywordflow">return</span> without error.</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;* </div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;* </div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;* @code</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;   <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160; }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; <span class="keyword">@end</span>code</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Results&quot;</span>&gt;&lt;/a&gt;&lt;h1&gt;Results&lt;/h1&gt;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;* </div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;* </div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;* The output of the program looks as follows:</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;* @code</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;Cycle 0:</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;   Number of active cells:       20</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   Number of degrees of freedom: 89</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;Cycle 1:</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   Number of active cells:       44</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   Number of degrees of freedom: 209</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;Cycle 2:</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   Number of active cells:       92</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   Number of degrees of freedom: 449</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;Cycle 3:</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   Number of active cells:       200</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   Number of degrees of freedom: 921</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;Cycle 4:</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;   Number of active cells:       440</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   Number of degrees of freedom: 2017</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;Cycle 5:</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   Number of active cells:       956</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;   Number of degrees of freedom: 4425</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;Cycle 6:</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;   Number of active cells:       1916</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;   Number of degrees of freedom: 8993</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;Cycle 7:</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;   Number of active cells:       3860</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;   Number of degrees of freedom: 18353</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;* </div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;* </div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;* </div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;* As intended, the number of cells roughly doubles in each cycle. Thenumber of degrees is slightly more than four times the number ofcells; <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> would expect a factor of exactly four in two spatialdimensions on an infinite grid (since the spacing between the degreesof freedom is half the cell width: <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> additional degree of freedom oneach edge and <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> in the middle of each cell), but it is larger thanthat factor due to the finite size of the mesh and due to additionaldegrees of freedom which are introduced by hanging nodes and localrefinement.</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;* </div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;* </div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;* The program outputs the solution and mesh in each cycle of therefinement <a class="code" href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">loop</a>. The solution looks as follows:</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;*   &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-6.solution.9.2.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;  </div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;* It is interesting to follow how the program arrives at the <span class="keyword">final</span> mesh:</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;*   &lt;div <span class="keyword">class</span>=<span class="stringliteral">&quot;twocolumn&quot;</span> style=<span class="stringliteral">&quot;width: 80%&quot;</span>&gt;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_0.svg&quot;</span></div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;         alt=<span class="stringliteral">&quot;Initial grid: the five-cell circle grid with one global refinement.&quot;</span></div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_1.svg&quot;</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;         alt=<span class="stringliteral">&quot;First grid: the five-cell circle grid with two global refinements.&quot;</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_2.svg&quot;</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;         alt=<span class="stringliteral">&quot;Second grid: the five-cell circle grid with one adaptive refinement.&quot;</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_3.svg&quot;</span></div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;         alt=<span class="stringliteral">&quot;Third grid: the five-cell circle grid with two adaptive</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;<span class="stringliteral">         refinements, showing clustering around the inner circle.&quot;</span></div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_4.svg&quot;</span></div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;         alt=<span class="stringliteral">&quot;Fourth grid: the five-cell circle grid with three adaptive</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;<span class="stringliteral">         refinements, showing clustering around the inner circle.&quot;</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_5.svg&quot;</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;         alt=<span class="stringliteral">&quot;Fifth grid: the five-cell circle grid with four adaptive</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;<span class="stringliteral">         refinements, showing clustering around the inner circle.&quot;</span></div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_6.svg&quot;</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;         alt=<span class="stringliteral">&quot;Sixth grid: the five-cell circle grid with five adaptive</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;<span class="stringliteral">         refinements, showing clustering around the inner circle.&quot;</span></div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  &lt;div&gt;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step_6_grid_7.svg&quot;</span></div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;         alt=<span class="stringliteral">&quot;Last grid: the five-cell circle grid with six adaptive</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;<span class="stringliteral">         refinements, showing that most cells are clustered around the inner circle.&quot;</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;         width=<span class="stringliteral">&quot;300&quot;</span> height=<span class="stringliteral">&quot;300&quot;</span>&gt;</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;  &lt;/div&gt;</div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;&lt;/div&gt;  </div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;* </div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;* It is clearly visible that the region where the solution has a kink,i.e. the circle at radial distance 0.5 from the <a class="code" href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a>, isrefined most. Furthermore, the central region where the solution isvery smooth and almost flat, is almost not refined at all, but thisresults from the fact that we did not take into account that thecoefficient is large there. The region outside is refined ratherarbitrarily, since the <a class="code" href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a> derivative is constant there and refinementis therefore mostly based on the size of the cells and their deviationfrom the optimal square.</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;* </div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;* </div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;* &lt;a name=<span class="stringliteral">&quot;extensions&quot;</span>&gt;&lt;/a&gt;&lt;a name=<span class="stringliteral">&quot;Possibilitiesforextensions&quot;</span>&gt;&lt;/a&gt;&lt;h3&gt;Possibilities <span class="keywordflow">for</span> extensions&lt;/h3&gt;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;* </div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;* &lt;a name=<span class="stringliteral">&quot;Solversandpreconditioners&quot;</span>&gt;&lt;/a&gt;&lt;h4&gt;Solvers and preconditioners&lt;/h4&gt;</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;* </div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;* </div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;* One thing that is <a class="code" href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">always</a> worth playing around with <span class="keywordflow">if</span> <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> solvesproblems of appreciable size (much bigger than the <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> we have here)is to <span class="keywordflow">try</span> different solvers or preconditioners. In the current <span class="keywordflow">case</span>,the linear system is <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">symmetric</a> and positive definite, which makes theCG algorithm pretty much the canonical choice <span class="keywordflow">for</span> solving. However,the SSOR preconditioner we use in the   &lt;code&gt;solve()&lt;/code&gt;   <span class="keyword">function</span> isup <span class="keywordflow">for</span> grabs.</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;* In deal.II, it is relatively simple to change the preconditioner. Forexample, by changing the existing <a class="code" href="classAffineConstraints.html#a87186b21ab5f5cb1e4635d4601ee3f05">lines</a> of code</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;* @code</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.2);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;* into</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;* @code</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  <a class="code" href="classPreconditionSSOR.html">PreconditionSSOR&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  preconditioner.<a class="code" href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">initialize</a>(system_matrix, 1.0);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;* we can <span class="keywordflow">try</span> out different relaxation parameters <span class="keywordflow">for</span> SSOR. By <span class="keyword">using</span></div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;* @code</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;  <a class="code" href="classPreconditionJacobi.html">PreconditionJacobi&lt;SparseMatrix&lt;double&gt;</a>&gt; preconditioner;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;  preconditioner.<a class="code" href="classPreconditionRelaxation.html#a73fb0eab08209d015a20797c19127588">initialize</a>(system_matrix);</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;* we can use Jacobi as a preconditioner. And by <span class="keyword">using</span></div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;* @code</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="classSparseILU.html">SparseILU&lt;double&gt;</a> preconditioner;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  preconditioner.<a class="code" href="classSparseILU.html#ae4b56dfaab3fd8820faa1b21160b1acb">initialize</a>(system_matrix);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;* we can use a simple incomplete LU decomposition without any thresholding orstrengthening of the <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">diagonal</a> (to use <span class="keyword">this</span> preconditioner, you have to alsoadd the header file   &lt;code&gt;deal.II/lac/sparse_ilu.h&lt;/code&gt;   to the include listat the top of the file).</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;* Using these various different preconditioners, we can compare thenumber of CG iterations needed (available through the  &lt;code&gt;solver_control.last_step()&lt;/code&gt;   <a class="code" href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">call</a>, see  @ref step_4 <span class="stringliteral">&quot;step-4&quot;</span>  ) as well as CPU time needed (<span class="keyword">using</span> the <a class="code" href="classTimer.html">Timer</a> <span class="keyword">class</span>,discussed, <span class="keywordflow">for</span> example, in   @ref step_28 <span class="stringliteral">&quot;step-28&quot;</span>  ) and <span class="keyword">get</span> thefollowing results (left: iterations; right: CPU time):</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;*   &lt;table width=<span class="stringliteral">&quot;60%&quot;</span> align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  &lt;tr&gt;</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;      &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-6.q2.dofs_vs_iterations.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    &lt;td align=<span class="stringliteral">&quot;center&quot;</span>&gt;</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;      &lt;img src=<span class="stringliteral">&quot;https://www.dealii.org/images/steps/developer/step-6.q2.dofs_vs_time.png&quot;</span> alt=<span class="stringliteral">&quot;&quot;</span>&gt;</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    &lt;/td&gt;</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;  &lt;/tr&gt;</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;&lt;/table&gt;  </div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;* As we can see, all preconditioners behave pretty much the same on thissimple problem, with the number of iterations growing like   @f${\cal</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;<a class="code" href="namespaceLAPACKSupport.html#ae4c4142bb80d7e6e5214c37fac73e1da">O</a>}(<a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>^{1/2})@f$   and because each iteration requires around   @f${\cal</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;<a class="code" href="namespaceLAPACKSupport.html#ae4c4142bb80d7e6e5214c37fac73e1da">O</a>}(<a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>)@f$   operations the total CPU time grows like   @f${\cal</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;<a class="code" href="namespaceLAPACKSupport.html#ae4c4142bb80d7e6e5214c37fac73e1da">O</a>}(<a class="code" href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">N</a>^{3/2})@f$   (<span class="keywordflow">for</span> the few smallest meshes, the CPU time is so smallthat it doesn<span class="stringliteral">&#39;t record). Note that even though it is the simplestmethod, Jacobi is the fastest for this problem.</span></div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;<span class="stringliteral">* The situation changes slightly when the finite element is not abi-quadratic one as set in the constructor of this program, but abi-linear one. If one makes this change, the results are as follows:</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;<span class="stringliteral">*   &lt;table width=&quot;60%&quot; align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;<span class="stringliteral">  &lt;tr&gt;</span></div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-6.q1.dofs_vs_iterations.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="stringliteral">    &lt;td align=&quot;center&quot;&gt;</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step-6.q1.dofs_vs_time.png&quot; alt=&quot;&quot;&gt;</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="stringliteral">    &lt;/td&gt;</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;<span class="stringliteral">  &lt;/tr&gt;</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;<span class="stringliteral">&lt;/table&gt;  </span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;<span class="stringliteral">* In other words, while the increase in iterations and CPU time is asbefore, Jacobi is now the method that requires the most iterations; itis still the fastest one, however, owing to the simplicity of theoperations it has to perform. This is not to say that Jacobiis actually a good preconditioner</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;<span class="stringliteral">*  -  for problems of appreciable size, it isdefinitely not, and other methods will be substantially better</span></div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;<span class="stringliteral">*  -  but reallyonly that it is fast because its implementation is so simple that it cancompensate for a larger number of iterations.</span></div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="stringliteral">* The message to take away from this is not that simplicity inpreconditioners is always best. While this may be true for the currentproblem, it definitely is not once we move to more complicatedproblems (elasticity or Stokes, for examples   @ref step_8 &quot;step-8&quot;   or  @ref step_22 &quot;step-22&quot;  ). Secondly, all of these preconditioners stilllead to an increase in the number of iterations as the number   @f$N@f$   ofdegrees of freedom grows, for example   @f${\cal O}(N^\alpha)@f$  ; this, inturn, leads to a total growth in effort as   @f${\cal O}(N^{1+\alpha})@f$  since each iteration takes   @f${\cal O}(N)@f$   work. This behavior isundesirable: we would really like to solve linear systems with   @f$N@f$  unknowns in a total of   @f${\cal O}(N)@f$   work; there is a classof preconditioners that can achieve this, namely geometric (  @ref step_16 &quot;step-16&quot;  ,  @ref step_37 &quot;step-37&quot;  ,   @ref step_39 &quot;step-39&quot;  )or algebraic multigrid (  @ref step_31 &quot;step-31&quot;  ,   @ref step_40 &quot;step-40&quot;  , and several others)preconditioners. They are, however, significantly more complex thanthe preconditioners outlined above.</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;<span class="stringliteral">* Finally, the last message to takehome is that when the data shown above was generated (in 2018), linearsystems with 100,000 unknowns areeasily solved on a desktop machine in about a second, makingthe solution of relatively simple 2d problems even to very highaccuracy not that big a task as it used to be even in thepast. At the time, the situation for 3d problems was entirely different,but even that has changed substantially in the intervening time</span></div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="stringliteral">*  -  thoughsolving problems in 3d to high accuracy remains a challenge.</span></div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;<span class="stringliteral">* &lt;a name=&quot;Abettermesh&quot;&gt;&lt;/a&gt;&lt;h4&gt;A better mesh&lt;/h4&gt;</span></div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;<span class="stringliteral">* If you look at the meshes above, you will see even though the domain is theunit disk, and the jump in the coefficient lies along a circle, the cellsthat make up the mesh do not track this geometry well. The reason, already hintedat in   @ref step_1 &quot;step-1&quot;  , is that in the absence of other information,the Triangulation class only sees a bunch ofcoarse grid cells but has, of course, no real idea what kind of geometry theymight represent when looked at together. For this reason, we need to tellthe Triangulation what to do when a cell is refined: where should the newvertices at the edge midpoints and the cell midpoint be located so that thechild cells better represent the desired geometry than the parent cell.</span></div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;<span class="stringliteral">* To visualize what the triangulation actually knows about the geometry,it is not enough to just output the location of vertices and draw astraight line for each edge; instead, we have to output both interiorand boundary lines as multiple segments so that they lookcurved. We can do this by making one change to the gnuplot part of  &lt;code&gt;output_results&lt;/code&gt;  :</span></div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;<span class="stringliteral">{</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="stringliteral">  GridOut       grid_out;</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="stringliteral">  std::ofstream output(&quot;grid-&quot; + std::to_string(cycle) + &quot;.gnuplot&quot;);</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="stringliteral">  GridOutFlags::Gnuplot gnuplot_flags(false, 5,  /*curved_interior_cells*/ true);</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;<span class="stringliteral">  grid_out.set_flags(gnuplot_flags);</span></div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;<span class="stringliteral">  MappingQGeneric&lt;dim&gt; mapping(3);</span></div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="stringliteral">  grid_out.write_gnuplot(triangulation, output, &amp;mapping);</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="stringliteral">}</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="stringliteral">@endcode</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;<span class="stringliteral">* In the code above, we already do this for faces that sit at the boundary: thishappens automatically since we use   GridGenerator::hyper_ball,   which attaches aSphericalManifold to the boundary of the domain. To make the mesh&lt;i&gt;interior&lt;/i&gt; also track a circular domain, we need to work a bit harder,though. First, recall that our coarse mesh consists of a central squarecell and four cells around it. Now first consider what would happen if wealso attached the SphericalManifold object not only to the four exterior facesbut also the four cells at the perimeter as well as all of their faces. We cando this by adding the following snippet (testing that the center of a cell islarger than a small multiple, say one tenth, of the cell diameter away fromcenter of the mesh only fails for the central square of the mesh):</span></div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="stringliteral">* @code</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="stringliteral">GridGenerator::hyper_ball(triangulation);</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;<span class="stringliteral">const Point&lt;dim&gt; mesh_center;</span></div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;<span class="stringliteral">for (const auto &amp;cell : triangulation.active_cell_iterators())</span></div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;<span class="stringliteral">  if (mesh_center.distance (cell-&gt;center()) &gt; cell-&gt;diameter()/10)</span></div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;<span class="stringliteral">    cell-&gt;set_all_manifold_ids(0);</span></div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;<span class="stringliteral">triangulation.refine_global(1);</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;<span class="stringliteral">@endcode</span></div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;<span class="stringliteral">* After a few global refinement steps, this would lead to a mesh of the followingkind:</span></div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;<span class="stringliteral">*     &lt;div class=&quot;onecolumn&quot; style=&quot;width: 80%&quot;&gt;</span></div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;<span class="stringliteral">    &lt;div&gt;</span></div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;<span class="stringliteral">      &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_bad_grid_4.svg&quot;</span></div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;<span class="stringliteral">           alt=&quot;Grid where some central cells are nearly triangular.&quot;</span></div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;<span class="stringliteral">           width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;<span class="stringliteral">    &lt;/div&gt;</span></div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;<span class="stringliteral">This is not a good mesh: the central cell has been refined in such a way that</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;<span class="stringliteral">the children located in the four corners of the original central cell</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;<span class="stringliteral">&lt;i&gt;degenerate&lt;/i&gt;: they all tend towards triangles as mesh refinement</span></div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;<span class="stringliteral">continues. This means that the Jacobian matrix of the transformation from</span></div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;<span class="stringliteral">reference cell to actual cell degenerates for these cells, and because</span></div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;<span class="stringliteral">all error estimates for finite element solutions contain the norm of the</span></div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;<span class="stringliteral">inverse of the Jacobian matrix, you will get very large errors on these</span></div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;<span class="stringliteral">cells and, in the limit as mesh refinement, a loss of convergence order because</span></div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;<span class="stringliteral">the cells in these corners become worse and worse under mesh refinement.</span></div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;<span class="stringliteral">So we need something smarter. To this end, consider the following solution</span></div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="stringliteral">originally developed by Konstantin Ladutenko. We will use the following code:</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;<span class="stringliteral">@code</span></div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;<span class="stringliteral">GridGenerator::hyper_ball(triangulation);</span></div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;<span class="stringliteral">const Point&lt;dim&gt; mesh_center;</span></div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;<span class="stringliteral">const double core_radius  = 1.0/5.0,</span></div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;<span class="stringliteral">             inner_radius = 1.0/3.0;</span></div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;<span class="stringliteral">for (const auto &amp;cell : triangulation.active_cell_iterators())</span></div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;<span class="stringliteral">  if (mesh_center.distance(cell-&gt;center()) &lt; 1e-5)</span></div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;<span class="stringliteral">    {</span></div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;<span class="stringliteral">      for (const auto v : cell-&gt;vertex_indices())</span></div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;<span class="stringliteral">        cell-&gt;vertex(v)= core_radius/mesh_center.distance(cell-&gt;vertex(v));</span></div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;<span class="stringliteral">    }</span></div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;<span class="stringliteral">for (const auto &amp;cell : triangulation.active_cell_iterators())</span></div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;<span class="stringliteral">  if (mesh_center.distance(cell-&gt;center()) &gt;= 1e-5)</span></div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;<span class="stringliteral">    cell-&gt;set_refine_flag();</span></div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;<span class="stringliteral">triangulation.execute_coarsening_and_refinement();</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;<span class="stringliteral">for (const auto &amp;cell : triangulation.active_cell_iterators())</span></div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;<span class="stringliteral">  for (const auto v : cell-&gt;vertex_indices())</span></div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;<span class="stringliteral">    {</span></div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;<span class="stringliteral">      const double dist = mesh_center.distance(cell-&gt;vertex(v));</span></div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;<span class="stringliteral">      if (dist &gt; core_radius*1.0001 &amp;&amp; dist &lt; 0.9999)</span></div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;<span class="stringliteral">        cell-&gt;vertex(v)= inner_radius/dist;</span></div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;<span class="stringliteral">    }</span></div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;<span class="stringliteral">for (const auto &amp;cell : triangulation.active_cell_iterators())</span></div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;<span class="stringliteral">  {</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;<span class="stringliteral">    bool is_in_inner_circle = false;</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;<span class="stringliteral">    for (const auto v : cell-&gt;vertex_indices())</span></div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;<span class="stringliteral">      if (mesh_center.distance(cell-&gt;vertex(v)) &lt; inner_radius)</span></div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;<span class="stringliteral">        {</span></div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="stringliteral">          is_in_inner_circle = true;</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;<span class="stringliteral">          break;</span></div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;<span class="stringliteral">        }</span></div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;<span class="stringliteral">    if (is_in_inner_circle == false)</span></div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;<span class="stringliteral">    // The Triangulation already has a SphericalManifold with</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="stringliteral">    // manifold id 0 (see the documentation of</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;<span class="stringliteral">    // GridGenerator::hyper_ball) so we just attach it to the outer</span></div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;<span class="stringliteral">    // ring here:</span></div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;<span class="stringliteral">      cell-&gt;set_all_manifold_ids(0);</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;<span class="stringliteral">  }</span></div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;<span class="stringliteral">@endcode</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;<span class="stringliteral">This code then generates the following, much better sequence of meshes:</span></div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;<span class="stringliteral">&lt;div class=&quot;twocolumn&quot; style=&quot;width: 80%&quot;&gt;</span></div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;<span class="stringliteral">  &lt;div&gt;</span></div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;<span class="stringliteral">    &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_grid_0_ladutenko.svg&quot;</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;<span class="stringliteral">         alt=&quot;Initial grid: the Ladutenko grid with one global refinement.&quot;</span></div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;<span class="stringliteral">         width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;<span class="stringliteral">  &lt;div&gt;</span></div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;<span class="stringliteral">    &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_grid_1_ladutenko.svg&quot;</span></div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;<span class="stringliteral">         alt=&quot;First adaptively refined Ladutenko grid.&quot;</span></div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;<span class="stringliteral">         width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="stringliteral">  &lt;div&gt;</span></div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;<span class="stringliteral">    &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_grid_2_ladutenko.svg&quot;</span></div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;<span class="stringliteral">         alt=&quot;Second adaptively refined Ladutenko grid.&quot;</span></div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;<span class="stringliteral">         width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;<span class="stringliteral">  &lt;div&gt;</span></div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;<span class="stringliteral">    &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_grid_3_ladutenko.svg&quot;</span></div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;<span class="stringliteral">         alt=&quot;Third adaptively refined Ladutenko grid.&quot;</span></div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;<span class="stringliteral">         width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;<span class="stringliteral">  &lt;div&gt;</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;<span class="stringliteral">    &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_grid_4_ladutenko.svg&quot;</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;<span class="stringliteral">         alt=&quot;Fourth adaptively refined Ladutenko grid. The cells are clustered</span></div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;<span class="stringliteral">         along the inner circle.&quot;</span></div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;<span class="stringliteral">         width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;<span class="stringliteral">  &lt;div&gt;</span></div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;<span class="stringliteral">    &lt;img src=&quot;https://www.dealii.org/images/steps/developer/step_6_grid_5_ladutenko.svg&quot;</span></div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;<span class="stringliteral">         alt=&quot;Fifth adaptively refined Ladutenko grid: the cells are clustered</span></div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;<span class="stringliteral">         along the inner circle.&quot;</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;<span class="stringliteral">         width=&quot;300&quot; height=&quot;300&quot;&gt;</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;<span class="stringliteral">  &lt;/div&gt;</span></div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;<span class="stringliteral">&lt;/div&gt;  </span></div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;<span class="stringliteral">* Creating good meshes, and in particular making them fit the geometry youwant, is a complex topic in itself. You can find much more on this in  @ref step_49 &quot;step-49&quot;  ,   @ref step_53 &quot;step-53&quot;  , and   @ref step_54 &quot;step-54&quot;  , among other tutorial programs that coverthe issue.   @ref step_65 &quot;step-65&quot;   shows another, less manual way to achieve a meshwell fit to the problem here.Information on curved domains can also be found in thedocumentation module on   @ref manifold   &quot;Manifold descriptions&quot;.</span></div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;<span class="stringliteral">* Why does it make sense to choose a mesh that tracks the internalinterface? There are a number of reasons, but the most essential onecomes down to what we actually integrate in our bilinearform. Conceptually, we want to integrate the term   @f$A_{ij}^K=\int_K</span></div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;<span class="stringliteral">a(\mathbf x) \nabla \varphi_i(\mathbf x) \nabla \varphi_j(\mathbf x) ; dx@f$   as thecontribution of cell   @f$K@f$   to the matrix entry   @f$A_{ij}@f$  . We can notcompute it exactly and have to resort to quadrature. We know thatquadrature is accurate if the integrand is smooth. That is becausequadrature in essence computes a polynomial approximation to theintegrand that coincides with the integrand in the quadrature points,and then computes the volume under this polynomial as an approximationto the volume under the original integrand. This polynomialinterpolant is accurate if the integrand is smooth on a cell, but itis usually rather inaccurate if the integrand is discontinuous on acell.</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;<span class="stringliteral">* Consequently, it is worthwhile to align cells in such a way that theinterfaces across which the coefficient is discontinuous are alignedwith cell interfaces. This way, the coefficient is constant on eachcell, following which the integrand will be smooth, and its polynomialapproximation and the quadrature approximation of the integral willboth be accurate. Note that such an alignment is common in manypractical cases, so deal.II provides a number of functions (such as  @ref GlossMaterialId   &quot;material_id&quot;) to help manage such a scenario.Refer to   @ref step_28 &quot;step-28&quot;   and   @ref step_46 &quot;step-46&quot;   for examples of how material ids can beapplied.</span></div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;<span class="stringliteral">* Finally, let us consider the case of a coefficient that has a smoothand non-uniform distribution in space. We can repeat once again all ofthe above discussion on the representation of such a function with thequadrature. So, to simulate it accurately there are a few readilyavailable options: you could reduce the cell size, increase the orderof the polynomial used in the quadrature formula, select a moreappropriate quadrature formula, or perform a combination of thesesteps. The key is that providing the best fit of the coefficient&#39;</span>sspatial dependence with the quadrature polynomial will lead to a moreaccurate finite element solution of the PDE.</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;* As a <span class="keyword">final</span> note: The discussion in the previous paragraphs shows, we herehave a very concrete way of stating what we think of a good mesh</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;* </div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;*  -  it shouldbe aligned with the jump in the coefficient. But <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> could also have askedthis kind of question in a more <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a> setting: Given some equation witha smooth solution and smooth coefficients, can we say what a good meshwould look like? This is a question <span class="keywordflow">for</span> which the answer is easier to statein intuitive terms than mathematically: <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> good mesh has cells that all,by and large, look like squares (or cubes, in 3<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">d</a>). <a class="code" href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">A</a> bad mesh would containcells that are very elongated in some directions or, more generally, <span class="keywordflow">for</span> whichthere are cells that have both <span class="keywordtype">short</span> and <span class="keywordtype">long</span> edges. There are many waysin which <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a> could assign a numerical quality index to each cell that measureswhether the cell is <span class="stringliteral">&quot;good&quot;</span> or <span class="stringliteral">&quot;bad&quot;</span>; some of these are often chosen becausethey are cheap and easy to compute, whereas others are based on what entersinto proofs of convergence. An example of the former would be the ratio ofthe longest to the shortest edge of a cell: In the ideal <span class="keywordflow">case</span>, that ratiowould be <a class="code" href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">one</a>; bad cells have values much larger than one. An example of thelatter kind would consider the <a class="code" href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">gradient</a> (the <span class="stringliteral">&quot;Jacobian&quot;</span>) of the mappingfrom the reference cell   @f$\hat K=[0,1]^d@f$   to the real cell   @f$K@f$  ; thisgradient is a <a class="code" href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">matrix</a>, and a quantity that enters into error estimatesis the maximum over all points on the reference cell of the ratio of thelargest to the smallest eigenvalue of <span class="keyword">this</span> matrix. It is again not difficultto see that <span class="keyword">this</span> ratio is constant <span class="keywordflow">if</span> the cell   @f$K@f$   is an <a class="code" href="group__matrixfree.html#ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0">affine</a> image of  @f$\hat K@f$  , and that it is one <span class="keywordflow">for</span> squares and cubes.</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;* In practice, it might be interesting to visualize such quality measures.The <span class="keyword">function</span>   <a class="code" href="namespaceGridTools.html#a9b0cf2feadb3374ed24f70d99e6e7740">GridTools::compute_aspect_ratio_of_cells</a>()   provides oneway to get this kind of information. Even better, visualization toolssuch as VisIt often allow you to visualize this sort of informationfor a variety of measures from within the visualization softwareitself; in the case of VisIt, just add a &quot;pseudo-color&quot; plot and selectone of the mesh quality measures instead of the solution field.</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;* </div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;* &lt;a name=&quot;Playingwiththeregularityofthesolution&quot;&gt;&lt;/a&gt;&lt;h4&gt;Playing with the regularity of the solution&lt;/h4&gt;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;* </div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;* From a mathematical perspective, solutions of the Laplace equation@f[</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;* </div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;* </div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;* </div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;* </div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;* </div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;-\Delta u = f</div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;@f]on smoothly bounded, convex domains are known to be smooth themselves. The exact degreeof smoothness, i.<a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">e</a>., the function space in which the solution lives, dependson how smooth exactly the boundary of the domain is, and how smooth the righthand side is. Some regularity of the solution may be lost at the boundary, butone generally has that the solution is twice more differentiable incompact subsets of the domain than the right hand side.If, in particular, the right hand side satisfies   @f$f\in <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>^\infty(\Omega)@f$  , then  @f$u \in <a class="code" href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">C</a>^\infty(\Omega_i)@f$   where   @f$\Omega_i@f$   is any compact subset of   @f$\Omega@f$  (  @f$\Omega@f$   is an open domain, so a compact subset needs to keep a positive distancefrom   @f$\partial\Omega@f$  ).</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;* The situation we chose for the current example is different, however: we lookat an equation with a non-constant coefficient   @f$a(\mathbf x)@f$  :@f[</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;* </div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;* </div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;* </div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;* </div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;* </div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;-\nabla \cdot (a \nabla u) = f.</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;@f]Here, if   @f$a@f$   is not smooth, then the solution will not be smooth either,regardless of   @f$f@f$  . In particular, we expect that wherever   @f$a@f$   is discontinuousalong a line (or along a plane in 3d),the solution will have a kink. This is easy to see: if for example   @f$f@f$  is continuous, then   @f$f=-\nabla \cdot (a \nabla u)@f$   needs to becontinuous. This means that   @f$a \nabla u@f$   must be continuously differentiable(not have a kink). Consequently, if   @f$a@f$   has a discontinuity, then   @f$\nabla u@f$  must have an opposite discontinuity so that the two exactly cancel and theirproduct yields a function without a discontinuity. But for   @f$\nabla u@f$   to havea discontinuity,   @f$u@f$   must have a kink. This is of course exactly what ishappening in the current example, and easy to observe in the pictures of thesolution.</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;* In <a class="code" href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">general</a>, if the coefficient   @f$a(\mathbf x)@f$   is discontinuous along a line in 2d,or a plane in 3d, then the solution may have a kink, but the gradient of thesolution will not go to infinity. That means, that the solution is at leaststill in the &lt;a href=&quot;https:<span class="comment">//en.wikipedia.org/wiki/Sobolev_space&quot;&gt;Sobolev space&lt;/a&gt;  @f$W^{1,\infty}@f$   (i.e., roughly speaking, in thespace of functions whose derivatives are bounded). On the other hand,we know that in the mostextreme cases</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;* </div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;*  -  i.e., where the domain has reentrant corners, theright hand side only satisfies   @f$f\in H^{-1}@f$  , or the coefficient   @f$a@f$   is only in  @f$L^\infty@f$  </div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;* </div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;*  -  all we can expect is that   @f$u\in H^1@f$   (i.e., the&lt;a</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;href=<span class="stringliteral">&quot;https://en.wikipedia.org/wiki/Sobolev_space#Sobolev_spaces_with_integer_k&quot;</span>&gt;Sobolev</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;space&lt;/a&gt; of <a class="code" href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">functions</a> whose derivative is square integrable), a much larger space than  @f$W^{1,\infty}@f$  . It is not very difficult to create cases wherethe solution is in a space   @f$H^{1+s}@f$   where we can <span class="keyword">get</span>   @f$s@f$   to become as smallas we want. Such cases are often used to test adaptive finite elementmethods because the mesh will have to resolve the singularity that causesthe solution to not be in   @f$W^{1,\infty}@f$   any more.</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;* The typical example one uses <span class="keywordflow">for</span> <span class="keyword">this</span> is called the &lt;i&gt;Kellogg problem&lt;/i&gt;(referring to   @cite Kel74  ), which in the commonly used form has a coefficient  @f$a(\mathbf x)@f$   that has different values in the four quadrants of the plane(or eight different values in the octants of   @f${\mathbb R}^3@f$  ). The exact degreeof regularity (the   @f$s@f$   in the index of the Sobolev space above) depends on thevalues of   @f$a(\mathbf x)@f$   coming together at the origin, and by choosing thejumps large enough, the regularity of the solution can be made as <a class="code" href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">close</a> asdesired to   @f$H^1@f$  .</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;* To implement something like <span class="keyword">this</span>, one could replace the coefficientfunction by the following (shown here only <span class="keywordflow">for</span> the 2d <span class="keywordflow">case</span>):</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;* @code</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;template &lt;<a class="code" href="classint.html">int</a> dim&gt;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;<a class="code" href="classdouble.html">double</a> coefficient (const <a class="code" href="classPoint.html">Point</a>&lt;dim&gt; &amp;p)</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;{</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;  <span class="keywordflow">if</span> ((p[0] &lt; 0) &amp;&amp; (p[1] &lt; 0))           <span class="comment">// lower left quadrant</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">return</span> 1;</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((p[0] &gt;= 0) &amp;&amp; (p[1] &lt; 0))     <span class="comment">// lower right quadrant</span></div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">return</span> 10;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((p[0] &lt; 0) &amp;&amp; (p[1] &gt;= 0))     <span class="comment">// upper left quadrant</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">return</span> 100;</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((p[0] &gt;= 0) &amp;&amp; (p[1] &gt;= 0))    <span class="comment">// upper right quadrant</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <span class="keywordflow">return</span> 1000;</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;  <span class="keywordflow">else</span></div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    {</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>(<span class="keyword">false</span>, <a class="code" href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">ExcInternalError</a>());</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    }</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;}</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;<span class="keyword">@end</span>code</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;* (Adding the   &lt;code&gt;<a class="code" href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a>&lt;/code&gt;   at the <a class="code" href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">end</a> ensures that either an exceptionis thrown or that the program aborts <span class="keywordflow">if</span> we ever <span class="keyword">get</span> to that <a class="code" href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">point</a></div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;* </div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;*  -  which of course we shouldn<span class="stringliteral">&#39;t,but this is a good way to insure yourself: we all make mistakes bysometimes not thinking of all cases, for example by checkingfor   &lt;code&gt;p[0]&lt;/code&gt;   to be less than and greater than zero,rather than greater-or-equal to zero, and thereby forgettingsome cases that would otherwise lead to bugs that are awkwardto find. The   &lt;code&gt;return 0;&lt;/code&gt;   at the end is only there toavoid compiler warnings that the function does not end in a  &lt;code&gt;return&lt;/code&gt;   statement</span></div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;<span class="stringliteral">*  -  the compiler cannot see that thefunction would never actually get to that point because of thepreceding   &lt;code&gt;Assert&lt;/code&gt;   statement.)</span></div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;<span class="stringliteral">* By playing with such cases where four or more sectors cometogether and on which the coefficient has different values, one canconstruct cases where the solution has singularities at theorigin. One can also see how the meshes are refined in such cases.</span></div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;<span class="stringliteral">* </span></div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;<span class="stringliteral"></span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;<span class="stringliteral">* &lt;a name=&quot;PlainProg&quot;&gt;&lt;/a&gt;&lt;h1&gt; The plain program&lt;/h1&gt;  @include &quot;step-6.cc&quot;  </span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;<span class="stringliteral">*</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;<span class="stringliteral">*/</span></div><div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa714204722e9eeb43aadbd0d5ddc48c85">update_JxW_values</a></div><div class="ttdoc">Transformed quadrature weights. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00103">fe_update_flags.h:103</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fa4057ca2f127aa619c65886a9d3ad4aea">update_values</a></div><div class="ttdoc">Shape function values. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00062">fe_update_flags.h:62</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a1c0655acd718579199c777967de9eea5">LAPACKSupport::symmetric</a></div><div class="ttdoc">Matrix is symmetric. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00116">lapack_support.h:116</a></div></div>
<div class="ttc" id="classAffineConstraints_html_a87186b21ab5f5cb1e4635d4601ee3f05"><div class="ttname"><a href="classAffineConstraints.html#a87186b21ab5f5cb1e4635d4601ee3f05">AffineConstraints::lines</a></div><div class="ttdeci">std::vector&lt; ConstraintLine &gt; lines</div><div class="ttdef"><b>Definition:</b> <a href="affine__constraints_8h_source.html#l01472">affine_constraints.h:1472</a></div></div>
<div class="ttc" id="group__MeshWorker_html_gad10f528ab87f39fbb0531d24f238b2f3"><div class="ttname"><a href="group__MeshWorker.html#gad10f528ab87f39fbb0531d24f238b2f3">MeshWorker::loop</a></div><div class="ttdeci">void loop(ITERATOR begin, typename identity&lt; ITERATOR &gt;::type end, DOFINFO &amp;dinfo, INFOBOX &amp;info, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;cell_worker, const std::function&lt; void(DOFINFO &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;boundary_worker, const std::function&lt; void(DOFINFO &amp;, DOFINFO &amp;, typename INFOBOX::CellInfo &amp;, typename INFOBOX::CellInfo &amp;)&gt; &amp;face_worker, ASSEMBLER &amp;assembler, const LoopControl &amp;lctrl=LoopControl())</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00449">loop.h:449</a></div></div>
<div class="ttc" id="classAffineConstraints_html_adfaa145ec19c37c410ddb0fb75e165f4"><div class="ttname"><a href="classAffineConstraints.html#adfaa145ec19c37c410ddb0fb75e165f4">AffineConstraints::print</a></div><div class="ttdeci">void print(std::ostream &amp;out) const</div></div>
<div class="ttc" id="classPreconditionSSOR_html_a7a3d66b17bb0ea1b16606e222474c2ea"><div class="ttname"><a href="classPreconditionSSOR.html#a7a3d66b17bb0ea1b16606e222474c2ea">PreconditionSSOR::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const typename BaseClass::AdditionalData &amp;parameters=typename BaseClass::AdditionalData())</div></div>
<div class="ttc" id="namespaceGridTools_html_a9b0cf2feadb3374ed24f70d99e6e7740"><div class="ttname"><a href="namespaceGridTools.html#a9b0cf2feadb3374ed24f70d99e6e7740">GridTools::compute_aspect_ratio_of_cells</a></div><div class="ttdeci">Vector&lt; double &gt; compute_aspect_ratio_of_cells(const Mapping&lt; dim &gt; &amp;mapping, const Triangulation&lt; dim &gt; &amp;triangulation, const Quadrature&lt; dim &gt; &amp;quadrature)</div><div class="ttdef"><b>Definition:</b> <a href="grid__tools_8cc_source.html#l00312">grid_tools.cc:312</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003"><div class="ttname"><a href="namespaceLAPACKSupport.html#a1a9009db0d9a77923a7031b549b9b638a5bc7c54a9c20485772672825c6a73003">LAPACKSupport::matrix</a></div><div class="ttdoc">Contents is actually a matrix. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00060">lapack_support.h:60</a></div></div>
<div class="ttc" id="vectorization_8h_html_a078ca5de8d3a59aedc130823be15ad26"><div class="ttname"><a href="vectorization_8h.html#a078ca5de8d3a59aedc130823be15ad26">gather</a></div><div class="ttdeci">void gather(VectorizedArray&lt; Number, width &gt; &amp;out, const std::array&lt; Number *, width &gt; &amp;ptrs, const unsigned int offset)</div><div class="ttdef"><b>Definition:</b> <a href="vectorization_8h_source.html#l00738">vectorization.h:738</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a9587d5229555daa5b1fa1ba2f8a40adb"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a9587d5229555daa5b1fa1ba2f8a40adb">Physics::Elasticity::Kinematics::e</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; e(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classVector_html"><div class="ttname"><a href="classVector.html">Vector</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__q1__eulerian_8h_source.html#l00033">mapping_q1_eulerian.h:33</a></div></div>
<div class="ttc" id="classAffineConstraints_html"><div class="ttname"><a href="classAffineConstraints.html">AffineConstraints</a></div><div class="ttdef"><b>Definition:</b> <a href="affine__constraints_8h_source.html#l00435">affine_constraints.h:435</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaa2063c1608d6e0baf80249c42e2be5804">internal::EvaluatorQuantity::value</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_aceda56512460bbad2f9fdb8a3d0e1e51"><div class="ttname"><a href="namespaceLAPACKSupport.html#aceda56512460bbad2f9fdb8a3d0e1e51">LAPACKSupport::one</a></div><div class="ttdeci">static const types::blas_int one</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00198">lapack_support.h:198</a></div></div>
<div class="ttc" id="classdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="namespaceLocalIntegrators_1_1Advection_html_a8bc7b8136646134f73a4193adefe15f8"><div class="ttname"><a href="namespaceLocalIntegrators_1_1Advection.html#a8bc7b8136646134f73a4193adefe15f8">LocalIntegrators::Advection::cell_matrix</a></div><div class="ttdeci">void cell_matrix(FullMatrix&lt; double &gt; &amp;M, const FEValuesBase&lt; dim &gt; &amp;fe, const FEValuesBase&lt; dim &gt; &amp;fetest, const ArrayView&lt; const std::vector&lt; double &gt;&gt; &amp;velocity, const double factor=1.)</div><div class="ttdef"><b>Definition:</b> <a href="advection_8h_source.html#l00063">advection.h:63</a></div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52fad5c9ff886b9615349a5d04a6c782df4a">update_quadrature_points</a></div><div class="ttdoc">Transformed quadrature points. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00097">fe_update_flags.h:97</a></div></div>
<div class="ttc" id="classAffineConstraints_html_a373fbdacd8c486e675b8d2bff8943192"><div class="ttname"><a href="classAffineConstraints.html#a373fbdacd8c486e675b8d2bff8943192">AffineConstraints::distribute_local_to_global</a></div><div class="ttdeci">void distribute_local_to_global(const InVector &amp;local_vector, const std::vector&lt; size_type &gt; &amp;local_dof_indices, OutVector &amp;global_vector) const</div><div class="ttdef"><b>Definition:</b> <a href="affine__constraints_8h_source.html#l01871">affine_constraints.h:1871</a></div></div>
<div class="ttc" id="grid__out_8cc_html_a2cc229a4f1ffc75e83ed269d5f725729"><div class="ttname"><a href="grid__out_8cc.html#a2cc229a4f1ffc75e83ed269d5f725729">second</a></div><div class="ttdeci">Point&lt; 2 &gt; second</div><div class="ttdef"><b>Definition:</b> <a href="grid__out_8cc_source.html#l04588">grid_out.cc:4588</a></div></div>
<div class="ttc" id="group__matrixfree_html_ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0"><div class="ttname"><a href="group__matrixfree.html#ggae024b29b6819e727d47016c6b6b53d8ca07017cbf652fdcd5e14eb0b160c0a0d0">internal::MatrixFreeFunctions::affine</a></div><div class="ttdef"><b>Definition:</b> <a href="mapping__info_8h_source.html#l00066">mapping_info.h:66</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_ae4c4142bb80d7e6e5214c37fac73e1da"><div class="ttname"><a href="namespaceLAPACKSupport.html#ae4c4142bb80d7e6e5214c37fac73e1da">LAPACKSupport::O</a></div><div class="ttdeci">static const char O</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00168">lapack_support.h:168</a></div></div>
<div class="ttc" id="classPoint_html"><div class="ttname"><a href="classPoint.html">Point</a></div><div class="ttdef"><b>Definition:</b> <a href="base_2point_8h_source.html#l00081">point.h:81</a></div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a09916360abaee5f1fb31994dbc96787b"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a09916360abaee5f1fb31994dbc96787b">Physics::Elasticity::Kinematics::C</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; C(const Tensor&lt; 2, dim, Number &gt; &amp;F)</div></div>
<div class="ttc" id="classSparseILU_html"><div class="ttname"><a href="classSparseILU.html">SparseILU</a></div><div class="ttdef"><b>Definition:</b> <a href="sparse__ilu_8h_source.html#l00054">sparse_ilu.h:54</a></div></div>
<div class="ttc" id="classPreconditionJacobi_html"><div class="ttname"><a href="classPreconditionJacobi.html">PreconditionJacobi</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00513">precondition.h:513</a></div></div>
<div class="ttc" id="classFullMatrix_html"><div class="ttname"><a href="classFullMatrix.html">FullMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a155b9e72113d7008c60732d350bfbb7a">DoFTools::nonzero</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00161">dof_tools.h:161</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98a9f7392eb627119096334bd291f1d1e86">LAPACKSupport::diagonal</a></div><div class="ttdoc">Matrix is diagonal. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00122">lapack_support.h:122</a></div></div>
<div class="ttc" id="namespaceThreads_1_1internal_html_a8d237a30d09b13e0b5adbe0fd1dfb188"><div class="ttname"><a href="namespaceThreads_1_1internal.html#a8d237a30d09b13e0b5adbe0fd1dfb188">Threads::internal::call</a></div><div class="ttdeci">void call(const std::function&lt; RT()&gt; &amp;function, internal::return_value&lt; RT &gt; &amp;ret_val)</div><div class="ttdef"><b>Definition:</b> <a href="thread__management_8h_source.html#l00346">thread_management.h:346</a></div></div>
<div class="ttc" id="classQGauss_html"><div class="ttname"><a href="classQGauss.html">QGauss</a></div><div class="ttdef"><b>Definition:</b> <a href="quadrature__lib_8h_source.html#l00039">quadrature_lib.h:39</a></div></div>
<div class="ttc" id="classSolverControl_html"><div class="ttname"><a href="classSolverControl.html">SolverControl</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__control_8h_source.html#l00047">solver_control.h:47</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html"><div class="ttname"><a href="classKellyErrorEstimator.html">KellyErrorEstimator</a></div><div class="ttdef"><b>Definition:</b> <a href="error__estimator_8h_source.html#l00131">error_estimator.h:131</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga70a0bb353656e704acf927945277bbc6"><div class="ttname"><a href="group__Exceptions.html#ga70a0bb353656e704acf927945277bbc6">Assert</a></div><div class="ttdeci">#define Assert(cond, exc)</div><div class="ttdef"><b>Definition:</b> <a href="include_2deal_8II_2base_2exceptions_8h_source.html#l01415">exceptions.h:1415</a></div></div>
<div class="ttc" id="namespaceTimeStepping_html_abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40"><div class="ttname"><a href="namespaceTimeStepping.html#abff97b5326e452552f108a379dd6cff4ada4f4134184b4c28b2aab01dc3afba40">TimeStepping::invalid</a></div><div class="ttdef"><b>Definition:</b> <a href="time__stepping_8h_source.html#l00222">time_stepping.h:222</a></div></div>
<div class="ttc" id="classPreconditionSSOR_html"><div class="ttname"><a href="classPreconditionSSOR.html">PreconditionSSOR</a></div><div class="ttdef"><b>Definition:</b> <a href="precondition_8h_source.html#l00667">precondition.h:667</a></div></div>
<div class="ttc" id="namespaceinternal_html_aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c"><div class="ttname"><a href="namespaceinternal.html#aa5bef221c94bc6b9c5441c306a72cdbaae2b6dfb8a5c48206992d8310d176c37c">internal::EvaluatorQuantity::gradient</a></div></div>
<div class="ttc" id="classSolverCG_html"><div class="ttname"><a href="classSolverCG.html">SolverCG</a></div><div class="ttdef"><b>Definition:</b> <a href="solver__cg_8h_source.html#l00078">solver_cg.h:78</a></div></div>
<div class="ttc" id="namespaceTrilinosWrappers_1_1internal_html_aee42c8e3004e2e81eac3c3356d3ec46b"><div class="ttname"><a href="namespaceTrilinosWrappers_1_1internal.html#aee42c8e3004e2e81eac3c3356d3ec46b">TrilinosWrappers::internal::end</a></div><div class="ttdeci">VectorType::value_type * end(VectorType &amp;V)</div><div class="ttdef"><b>Definition:</b> <a href="trilinos__sparse__matrix_8cc_source.html#l00067">trilinos_sparse_matrix.cc:67</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a5eee186cf23024df6854a9990a786703"><div class="ttname"><a href="namespaceGridRefinement.html#a5eee186cf23024df6854a9990a786703">GridRefinement::coarsen</a></div><div class="ttdeci">void coarsen(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00218">grid_refinement.cc:218</a></div></div>
<div class="ttc" id="classPreconditionRelaxation_html_a73fb0eab08209d015a20797c19127588"><div class="ttname"><a href="classPreconditionRelaxation.html#a73fb0eab08209d015a20797c19127588">PreconditionRelaxation::initialize</a></div><div class="ttdeci">void initialize(const MatrixType &amp;A, const AdditionalData &amp;parameters=AdditionalData())</div></div>
<div class="ttc" id="namespacePhysics_1_1Elasticity_1_1Kinematics_html_a15728437b942dab0b0042eb06a407d2c"><div class="ttname"><a href="namespacePhysics_1_1Elasticity_1_1Kinematics.html#a15728437b942dab0b0042eb06a407d2c">Physics::Elasticity::Kinematics::d</a></div><div class="ttdeci">SymmetricTensor&lt; 2, dim, Number &gt; d(const Tensor&lt; 2, dim, Number &gt; &amp;F, const Tensor&lt; 2, dim, Number &gt; &amp;dF_dt)</div></div>
<div class="ttc" id="namespaceinternal_html_a2b3d48efdf7c94da455dc6a3553bab79"><div class="ttname"><a href="namespaceinternal.html#a2b3d48efdf7c94da455dc6a3553bab79">internal::assemble</a></div><div class="ttdeci">void assemble(const MeshWorker::DoFInfoBox&lt; dim, DOFINFO &gt; &amp;dinfo, A *assembler)</div><div class="ttdef"><b>Definition:</b> <a href="loop_8h_source.html#l00073">loop.h:73</a></div></div>
<div class="ttc" id="namespaceDoFTools_html_ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec"><div class="ttname"><a href="namespaceDoFTools.html#ad31df71a29dd76de9b4ab241b2527160a6a742e14fbc92a1c202d77d4f319d5ec">DoFTools::always</a></div><div class="ttdef"><b>Definition:</b> <a href="dof__tools_8h_source.html#l00154">dof_tools.h:154</a></div></div>
<div class="ttc" id="classKellyErrorEstimator_html_ae2269e1c9903e9d863b7abd54948af00"><div class="ttname"><a href="classKellyErrorEstimator.html#ae2269e1c9903e9d863b7abd54948af00">KellyErrorEstimator::estimate</a></div><div class="ttdeci">static void estimate(const Mapping&lt; dim, spacedim &gt; &amp;mapping, const DoFHandler&lt; dim, spacedim &gt; &amp;dof, const Quadrature&lt; dim - 1 &gt; &amp;quadrature, const std::map&lt; types::boundary_id, const Function&lt; spacedim, typename InputVector::value_type &gt; *&gt; &amp;neumann_bc, const InputVector &amp;solution, Vector&lt; float &gt; &amp;error, const ComponentMask &amp;component_mask=ComponentMask(), const Function&lt; spacedim &gt; *coefficients=nullptr, const unsigned int n_threads=numbers::invalid_unsigned_int, const types::subdomain_id subdomain_id=numbers::invalid_subdomain_id, const types::material_id material_id=numbers::invalid_material_id, const Strategy strategy=cell_diameter_over_24)</div></div>
<div class="ttc" id="namespaceAlgorithms_1_1Events_html_a15a12dfdadd39a026d192ad96cb6207b"><div class="ttname"><a href="namespaceAlgorithms_1_1Events.html#a15a12dfdadd39a026d192ad96cb6207b">Algorithms::Events::initial</a></div><div class="ttdeci">const Event initial</div><div class="ttdef"><b>Definition:</b> <a href="event_8cc_source.html#l00065">event.cc:65</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a40707d49114d54318c823f3b750e89a4"><div class="ttname"><a href="namespaceLAPACKSupport.html#a40707d49114d54318c823f3b750e89a4">LAPACKSupport::A</a></div><div class="ttdeci">static const char A</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00158">lapack_support.h:158</a></div></div>
<div class="ttc" id="classSparseILU_html_ae4b56dfaab3fd8820faa1b21160b1acb"><div class="ttname"><a href="classSparseILU.html#ae4b56dfaab3fd8820faa1b21160b1acb">SparseILU::initialize</a></div><div class="ttdeci">void initialize(const SparseMatrix&lt; somenumber &gt; &amp;matrix, const AdditionalData &amp;parameters=AdditionalData())</div></div>
<div class="ttc" id="group__feaccess_html_ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20"><div class="ttname"><a href="group__feaccess.html#ggaa94b67d2fdcc390690c523f28019e52facbcc430975fa6af05f75ca786dc6fe20">update_gradients</a></div><div class="ttdoc">Shape function gradients. </div><div class="ttdef"><b>Definition:</b> <a href="fe__update__flags_8h_source.html#l00068">fe_update_flags.h:68</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a8edacd69ab93285f82b7f63c733a86b7"><div class="ttname"><a href="namespaceLAPACKSupport.html#a8edacd69ab93285f82b7f63c733a86b7">LAPACKSupport::N</a></div><div class="ttdeci">static const char N</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00163">lapack_support.h:163</a></div></div>
<div class="ttc" id="classDoFHandler_html"><div class="ttname"><a href="classDoFHandler.html">DoFHandler</a></div><div class="ttdef"><b>Definition:</b> <a href="dofs_2dof__handler_8h_source.html#l00184">dof_handler.h:184</a></div></div>
<div class="ttc" id="classFEValues_html"><div class="ttname"><a href="classFEValues.html">FEValues&lt; dim &gt;</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855"><div class="ttname"><a href="namespaceLAPACKSupport.html#a45557450a3c1ae0e74d7ddf12c43bc98af25b68380698c53fa6da3e05379c0855">LAPACKSupport::general</a></div><div class="ttdoc">No special properties. </div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00114">lapack_support.h:114</a></div></div>
<div class="ttc" id="data__out__base_8cc_html_a8188ef4709fc9a4cc076d37447783ba1"><div class="ttname"><a href="data__out__base_8cc.html#a8188ef4709fc9a4cc076d37447783ba1">center</a></div><div class="ttdeci">Point&lt; 3 &gt; center</div><div class="ttdef"><b>Definition:</b> <a href="data__out__base_8cc_source.html#l00170">data_out_base.cc:170</a></div></div>
<div class="ttc" id="namespaceOpenCASCADE_html_a9509efa83e3b2fa42616fe0623cba696"><div class="ttname"><a href="namespaceOpenCASCADE.html#a9509efa83e3b2fa42616fe0623cba696">OpenCASCADE::point</a></div><div class="ttdeci">Point&lt; spacedim &gt; point(const gp_Pnt &amp;p, const double tolerance=1e-10)</div><div class="ttdef"><b>Definition:</b> <a href="opencascade_2utilities_8cc_source.html#l00188">utilities.cc:188</a></div></div>
<div class="ttc" id="namespaceLAPACKSupport_html_a0d8802698d585eec62a2a54e6387b05b"><div class="ttname"><a href="namespaceLAPACKSupport.html#a0d8802698d585eec62a2a54e6387b05b">LAPACKSupport::zero</a></div><div class="ttdeci">static const types::blas_int zero</div><div class="ttdef"><b>Definition:</b> <a href="lapack__support_8h_source.html#l00193">lapack_support.h:193</a></div></div>
<div class="ttc" id="namespaceEvaluationFlags_html_a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58"><div class="ttname"><a href="namespaceEvaluationFlags.html#a9b7c6d689cb76386839d0d13640f59aeaf9825c682f693a6a200094641a0d6a58">EvaluationFlags::values</a></div><div class="ttdef"><b>Definition:</b> <a href="evaluation__flags_8h_source.html#l00054">evaluation_flags.h:54</a></div></div>
<div class="ttc" id="p4est__wrappers_8cc_html_ace00f2f80d9780ef9aa1007e1c22c6a4"><div class="ttname"><a href="p4est__wrappers_8cc.html#ace00f2f80d9780ef9aa1007e1c22c6a4">triangulation</a></div><div class="ttdeci">const ::parallel::distributed::Triangulation&lt; dim, spacedim &gt; * triangulation</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00069">p4est_wrappers.cc:69</a></div></div>
<div class="ttc" id="classTimer_html"><div class="ttname"><a href="classTimer.html">Timer</a></div><div class="ttdef"><b>Definition:</b> <a href="timer_8h_source.html#l00118">timer.h:118</a></div></div>
<div class="ttc" id="classAffineConstraints_html_a1611aa37f754086388ca76bcd421cce5"><div class="ttname"><a href="classAffineConstraints.html#a1611aa37f754086388ca76bcd421cce5">AffineConstraints::close</a></div><div class="ttdeci">void close()</div></div>
<div class="ttc" id="classint_html"><div class="ttname"><a href="classint.html">int</a></div></div>
<div class="ttc" id="namespaceinternal_1_1VectorOperations_html_a40c8daa0881cff0123fbaeb08929f5cb"><div class="ttname"><a href="namespaceinternal_1_1VectorOperations.html#a40c8daa0881cff0123fbaeb08929f5cb">internal::VectorOperations::copy</a></div><div class="ttdeci">void copy(const T *begin, const T *end, U *dest)</div><div class="ttdef"><b>Definition:</b> <a href="vector__operations__internal_8h_source.html#l00069">vector_operations_internal.h:69</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a48e5395381ed87155942a61a1edd134d"><div class="ttname"><a href="namespaceGridRefinement.html#a48e5395381ed87155942a61a1edd134d">GridRefinement::refine_and_coarsen_fixed_number</a></div><div class="ttdeci">void refine_and_coarsen_fixed_number(Triangulation&lt; dim, spacedim &gt; &amp;triangulation, const Vector&lt; Number &gt; &amp;criteria, const double top_fraction_of_cells, const double bottom_fraction_of_cells, const unsigned int max_n_cells=std::numeric_limits&lt; unsigned int &gt;::max())</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00322">grid_refinement.cc:322</a></div></div>
<div class="ttc" id="namespaceGridRefinement_html_a1cf30058b31ce7f9b389e8310bb9fc54"><div class="ttname"><a href="namespaceGridRefinement.html#a1cf30058b31ce7f9b389e8310bb9fc54">GridRefinement::refine</a></div><div class="ttdeci">void refine(Triangulation&lt; dim, spacedim &gt; &amp;tria, const Vector&lt; Number &gt; &amp;criteria, const double threshold, const unsigned int max_to_mark=numbers::invalid_unsigned_int)</div><div class="ttdef"><b>Definition:</b> <a href="grid_2grid__refinement_8cc_source.html#l00168">grid_refinement.cc:168</a></div></div>
<div class="ttc" id="namespaceinternal_1_1p4est_html_a4b980c7b4b4d9984e93d73c7d30173ea"><div class="ttname"><a href="namespaceinternal_1_1p4est.html#a4b980c7b4b4d9984e93d73c7d30173ea">internal::p4est::functions</a></div><div class="ttdeci">int(&amp;) functions(const void *v1, const void *v2)</div><div class="ttdef"><b>Definition:</b> <a href="p4est__wrappers_8cc_source.html#l00339">p4est_wrappers.cc:339</a></div></div>
<div class="ttc" id="namespaceWorkStream_1_1internal_1_1tbb__no__coloring_html_a8673698a405bf47aa24002aeb6d76d70"><div class="ttname"><a href="namespaceWorkStream_1_1internal_1_1tbb__no__coloring.html#a8673698a405bf47aa24002aeb6d76d70">WorkStream::internal::tbb_no_coloring::run</a></div><div class="ttdeci">void run(const Iterator &amp;begin, const typename identity&lt; Iterator &gt;::type &amp;end, Worker worker, Copier copier, const ScratchData &amp;sample_scratch_data, const CopyData &amp;sample_copy_data, const unsigned int queue_length, const unsigned int chunk_size)</div><div class="ttdef"><b>Definition:</b> <a href="work__stream_8h_source.html#l00562">work_stream.h:562</a></div></div>
<div class="ttc" id="group__Exceptions_html_ga31978c026b8b6b5116df30b8e748f6b7"><div class="ttname"><a href="group__Exceptions.html#ga31978c026b8b6b5116df30b8e748f6b7">StandardExceptions::ExcInternalError</a></div><div class="ttdeci">static ::ExceptionBase &amp; ExcInternalError()</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
